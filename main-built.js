var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(f,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");f!=Array.prototype&&f!=Object.prototype&&(f[b]=c.value)};$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global?global:f};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.iterator;f||(f=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[f]&&$jscomp.defineProperty(Array.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(f){var b=0;return $jscomp.iteratorPrototype(function(){return b<f.length?{done:!1,value:f[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(f){$jscomp.initSymbolIterator();f={next:f};f[$jscomp.global.Symbol.iterator]=function(){return this};return f};$jscomp.makeIterator=function(f){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=f[Symbol.iterator];return b?b.call(f):$jscomp.arrayIterator(f)};
define("myScripts/DataLoader",[],function(){var f=function(b){};f.prototype.getData=function(b,c,a){var d=this,e=0;Papa.parse(b,{worker:!1,download:!0,preview:2E4,fastMode:!0,complete:function(b){if(!e)return e=1,b=f.removeEmpty(b.data),b.bounds=d.getDataBounds(b,a,0),a.heightExtrusion&&(b.bounds1=d.getDataBounds(b,a,1)),c(b),1}})};f.removeEmpty=function(b){""!=b[b.length-1]&&void 0!=b[b.length-1]||b.splice(b.length-1);return b};f.prototype.getDataBounds=function(b,c,a){for(var d=-Infinity,e=Infinity,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   g,h=0;h<b.length;h++)g=b[h],-1!==g[c.data[0]].indexOf(c.separator)&&(d=Math.max(d,g[c.data[a]].split(c.separator).join("")),e=Math.min(e,g[c.data[a]].split(c.separator).join("")));return[d,e]};return f});
define("myScripts/GlobeHelper",[],function(){var f=f||{};f.getCoords=function(b){var c={0:{}};c[0].lat=b._boundaries[0].latitude;c[0].lng=b._boundaries[0].longitude;c[1]={};c[1].lat=b._boundaries[1].latitude;c[1].lng=b._boundaries[1].longitude;c[2]={};c[2].lat=b._boundaries[2].latitude;c[2].lng=b._boundaries[2].longitude;c[3]={};c[3].lat=b._boundaries[3].latitude;c[3].lng=b._boundaries[3].longitude;return c};f.getMaxTile=function(){return Number($("#maxTile").val())};f.clean=function(b,c,a,d){var e;
    a&&d.removeLayer(a);if(b)for(e in b)d.removeLayer(b[e]);if(c)for(e in c)d.removeLayer(c[e])};f.getStatistics=function(b,c,a,d,e,g,h){for(var k=0,l=0,m=0,p=0,q=0,t=-Infinity,r=0;r<b.cubes.length;r++)if(b.cubes[r].heightLayer==c){var p=p+1,f;f=g[h].idSeparator?1/(b.cubes[r].id.split(g[h].idSeparator).length/3):1;l+=f;k+=Number(b.cubes[r].data[h]*f);m+=Number(b.cubes[r].data);t=Math.max(t,Number(b.cubes[r].data[h]));q=Math.min(q,Number(b.cubes[r].data[h]))}switch(d){case 0:b=k/l;break;case 1:b=m/p;break;
    case 2:d=m/p;for(r=g=0;r<b.cubes.length;r++)b.cubes[r].heightLayer==c&&(k=b.cubes[r].data[h],g+=(k-d)*(k-d));b=Math.sqrt(g/(p-1));break;case 3:c=Math.ceil(p/2);b=b.cubes[c].data[h];break;case 4:b=t;break;case 5:b=q;break;default:b=k/l}h=a.bounds[1];return[this.getColor((b-h)/(a.bounds[0]-h)*100,e),b]};f.getRGB=function(b){b="#"==b.charAt(0)?b.substring(1,7):b;var c=parseInt(b.substring(0,2),16),a=parseInt(b.substring(2,4),16);b=parseInt(b.substring(4,6),16);return[c,a,b]};f.getColor=function(b,c){var a,
    d=[];50>b?(d[1]=c[0],d[0]=c[1],a=b/50):(d[1]=c[1],d[0]=c[2],a=(b-50)/50);a=((2*a-1)/1+1)/2;var e=1-a,d=[Math.round(d[0][0]*a+d[1][0]*e),Math.round(d[0][1]*a+d[1][1]*e),Math.round(d[0][2]*a+d[1][2]*e)];return[d[0],d[1],d[2],255]};f.toTime=function(b){var c=new Date(0);try{c.setMilliseconds(Number(b+"000")),b=c.toLocaleDateString()+" "+c.toLocaleTimeString()}catch(a){b=0}return b};return f});
define("myScripts/csvToGrid/CSVReader",[],function(){var f=f||{};f.getData=function(b,c,a){Papa.parse(b,{download:!0,delimiter:a,complete:function(a){a=f.removeEmpty(a.data);c(a)}})};f.removeEmpty=function(b){""!=b[b.length-1]&&void 0!=b[b.length-1]||b.splice(b.length-1);return b};return f});var quad;
define("myScripts/csvToGrid/Converter",["myScripts/csvToGrid/CSVReader"],function(f){var b=b||{};b.loadData=function(b,a,d){f.getData(b,a,d)};b.filterData=function(b,a,d,e){e||(e=4E4);var g=[],h=d._bottom,k=d._top,l=d._left,m=d._right;b.forEach(function(d){Number(d[a.lat])<=k&&Number(d[a.lat])>=h&&Number(d[a.lng])>=l&&Number(d[a.lng])<=m&&g.length<e&&g.push(d)});return g};b.initData=function(b,a,d){return this.parseData(b,a,d)};b.getDataBounds=function(b,a,d){for(var e=-Infinity,g=Infinity,h,k=1;k<
b.length;k++)h=b[k],isNaN(h[a.data[0]])&&-1!==h[a.data[0]].indexOf(a.separator)?isNaN(e)||isNaN(g)||(e=Math.max(e,Number(h[a.data[d]].split(a.separator).join(""))),g=Math.min(g,Number(h[a.data[d]].split(a.separator).join("")))):isNaN(e)||isNaN(g)||(e=Math.max(e,h[a.data[d]]),g=Math.min(g,h[a.data[d]]));return[e,g]};b.initJson=function(b,a,d,e){a=Math.floor(b.positions.length/2);var g=Number(b.positions[a][1]),h=Number(b.positions[a][0]);a=Math.floor((g+180)/6)+1;56<=h&&64>h&&3<=g&&12>g&&(a=32);72<=
h&&84>h&&(0<=g&&9>g?a=31:9<=g&&21>g?a=33:21<=g&&33>g?a=35:33<=g&&42>g&&(a=37));g=this.getCoordinatesBoundaries(b.positions);g=this.convertBounds(g,a,e);b=this.getPoints(b.positions,a,e);minPoint=g[0];maxPoint=g[1];sizeW=maxPoint[0]-minPoint[0];sizeH=maxPoint[1]-minPoint[1];quad=new QuadTree({x:minPoint[0],y:minPoint[1],width:sizeW,height:sizeH},!0,d,1);quad=this.insertData(quad,b);return this.getJson(quad,a,e)};b.setGridtoData=function(b,a,d){b=JSON.parse(b);for(var e in a)for(var g=a[e].length,h=
    0;h<g;h++)for(var k=a[e][h].length,l=0;l<k;l++)for(var m=b.features.length,p=0;p<m;p++){var q=a[e][h][l],t=b.features[p],r=[t.properties.lat,t.properties.lng];if(0!==r[0]&&0!==r[1]){var f=[Number(q[d.data.length+1][0]),Number(q[d.data.length+1][1])];r[0]==f[0]&&r[1]==f[1]&&(q[0]=t.properties.id)}}return a};b.parseData=function(b,a,d){for(var e=[],g={},h=b.length,k=[],l=0;l<h;l++){var m=b[l];-1==e.indexOf(m[a.time])&&e.push(m[a.time]);g[m[a.time]]||(g[m[a.time]]=[]);g[m[a.time]][d]||(g[m[a.time]][d]=
    []);var p=[m[a.lat],m[a.lng]],q=[];q.push(-1);k.push(p);for(var f in a.data)q.push(m[a.data[f]]);q.push(p);g[m[a.time]][d].push(q)}return{allTime:e,positions:k,times:g}};b.insertData=function(b,a){var d,e,g={};e=0;for(n=a.length;e<n;e++){var h=a[e];0!=h[0]&&(g[h[0]+" - "+h[1]]=h)}e=0;for(h in g)e++;for(d in g)b.insert({x:g[d][0],y:g[d][1],width:10,height:10,coords:[g[d].coord[0],g[d].coord[1]]});return b};b.getPoints=function(b,a,d){a=[];for(d=0;d<b.length;d++){var e=b[d][0],g=b[d][1],e=Number(e),
    g=Number(g);a[d]=[g,e];a[d].coord=[e,g]}return a};b.convertBounds=function(b,a,d){return[[b[1],b[0]],[b[3],b[2]]]};b.getJson=function(b,a,d){a={type:"FeatureCollection",features:[]};d=[];0==b.root.children.length&&0<b.root.nodes.length?d=this.explore(b.root,d):d.push([b.root._bounds,[0,0]]);for(var e=b=0;e<d.length;e++){var g=this.newFeature();g.properties.id=e;g.properties.lat=d[e][1][0];g.properties.lng=d[e][1][1];a.features.push(g);var h=d[e][0],g=[];g[0]=g[4]=[h.x,h.y];g[1]=[h.x+h.width,h.y];
    g[2]=[h.x+h.width,h.y+h.height];g[3]=[h.x,h.y+h.height];for(h=0;h<g.length;h++)a.features[b].geometry.coordinates[0].push([g[h][0],g[h][1]]);b++}return a};b.newFeature=function(){return{type:"Feature",properties:{id:"gridBound"},geometry:{type:"Polygon",coordinates:[[]]}}};b.explore=function(b,a){if(0==b.children.length&&0<b.nodes.length)for(var d=0;d<b.nodes.length;d++)a=this.explore(b.nodes[d],a);else 0==b.children.length?a.push([b._bounds,[0,0]]):a.push([b._bounds,b.children[0].coords]);return a};
    b.getCoordinatesBoundaries=function(b,a){for(var d=-Infinity,e=-Infinity,g=Infinity,h=Infinity,k=0;k<b.length;k++){if(a)var l=b[k][a.lat],m=b[k][a.lng];else l=b[k][0],m=b[k][1];l=Number(l);m=Number(m);l&&m&&(g=Math.min(g,l),h=Math.min(h,m),d=Math.max(d,l),e=Math.max(e,m))}return[g,h,d,e]};return b});
define("src/error/AbstractError",[],function(){var f=function(b,c){this.name=b;this.message=c};f.prototype.toString=function(){var b=this.name+": "+this.message;this.stack&&(b+="\n"+this.stack.toString());return b};return f});
define("src/geom/Angle",[],function(){return{DEGREES_TO_RADIANS:Math.PI/180,RADIANS_TO_DEGREES:180/Math.PI,TWO_PI:2*Math.PI,HALF_PI:Math.PI/2,normalizedDegrees:function(f){f%=360;return 180<f?f-360:-180>f?360+f:f},normalizedDegreesLatitude:function(f){f%=180;return 90<f?180-f:-90>f?-180-f:f},normalizedDegreesLongitude:function(f){f%=360;return 180<f?f-360:-180>f?360+f:f},normalizedRadians:function(f){f%=this.TWO_PI;return f>Math.PI?f-this.TWO_PI:f<-Math.PI?this.TWO_PI+f:f},normalizedRadiansLatitude:function(f){f%=
    Math.PI;return f>this.HALF_PI?Math.PI-f:f<-this.HALF_PI?-Math.PI-f:f},normalizedRadiansLongitude:function(f){f%=this.TWO_PI;return f>Math.PI?f-this.TWO_PI:f<-Math.PI?this.TWO_PI+f:f},isValidLatitude:function(f){return-90<=f&&90>=f},isValidLongitude:function(f){return-180<=f&&180>=f},toString:function(f){return f.toString()+"\u00b0"},toDecimalDegreesString:function(f){return f.toString()+"\u00b0"},toDMSString:function(f){var b,c,a;b=0>f?-1:1;c=b*f;f=Math.floor(c);c=60*(c-f);a=Math.floor(c);c=Math.round(60*
    (c-a));60==c&&(a++,c=0);60==a&&(f++,a=0);return(-1==b?"-":"")+f+"\u00b0 "+a+"\u2019 "+c+"\u201d"},toDMString:function(f){var b,c,a;b=0>f?-1:1;c=b*f;f=Math.floor(c);c=60*(c-f);a=Math.floor(c);c=Math.round(60*(c-a));60==c&&(a++,c=0);60==a&&(f++,a=0);return(-1==b?"-":"")+f+"\u00b0 "+(0==c?a:a+c/60)+"\u2019"}}});
define("src/util/Logger",[],function(){var f={LEVEL_NONE:0,LEVEL_SEVERE:1,LEVEL_WARNING:2,LEVEL_INFO:3,setLoggingLevel:function(c){b=c},getLoggingLevel:function(){return b},log:function(c,a){a&&0<c&&c<=b&&(c===f.LEVEL_SEVERE?console.error(a):c===f.LEVEL_WARNING?console.warn(a):c===f.LEVEL_INFO?console.info(a):console.log(a))},makeMessage:function(b,a,d){return b+"."+a+": "+(this.messageTable[d]?this.messageTable[d]:d)},logMessage:function(b,a,d,e){a=this.makeMessage(a,d,e);this.log(b,a);return a},
    messageTable:{abstractInvocation:"The function called is abstract and must be overridden in a subclass.",indexOutOfRange:"The specified index is out of range.",invalidHeight:"The specified height is zero or negative.",invalidWidth:"The specified width is zero or negative.",invalidSize:"The specified size is zero or negative.",missingAltitudeMode:"The specified altitude mode is null or undefined.",missingAttributeName:"The specified DBase attribute file name is null or undefined.",missingArray:"The specified array is null, undefined or of insufficient length.",
        missingBoundaries:"The specified boundaries array is null or undefined.",missingBuffer:"The specified buffer descriptor is null or undefined.",missingColor:"The specified color is null or undefined.",missingDc:"The specified draw context is null or undefined.",missingDomElement:"The specified DOM element is null or undefined.",missingEntry:"The specified entry is null or undefined.",missingFont:"The specified font is null or undefined.",missingFrustum:"The specified frustum is null or undefined.",
        missingFunction:"The specified function is null or undefined.",missingGlContext:"The specified WebGL rendering context is null or undefined.",missingGlobe:"The specified globe is null or undefined.",missingImage:"The specified image is null or undefined.",missingIndices:"The specified indices array is null or undefined.",missingKey:"The specified key is null or undefined.",missingLevel:"The specified level is null or undefined.",missingLine:"The specified line is null or undefined.",missingList:"The specified list is null or undefined.",
        missingListener:"The specified listener is null or undefined",missingLocation:"The specified location is null or undefined.",missingMatrix:"The specified matrix is null or undefined.",missingNavigatorState:"The specified navigator state is null or undefined.",missingOffset:"The specified offset is null or undefined.",missingPath:"The specified path is null or undefined.",missingPlacename:"The specified place name is null or undefined.",missingPlane:"The specified plane is null or undefined.",missingPoint:"The specified point is null or undefined.",
        missingPoints:"The specified points array is null or undefined.",missingPosition:"The specified position is null or undefined.",missingPositions:"The specified positions array is null or undefined.",missingProgram:"The specified program is null or undefined.",missingProjection:"The specified projection is null or undefined.",missingRectangle:"The specified rectangle is null or undefined.",missingRenderable:"The specified renderable is null or undefined.",missingResource:"The specified resource is null or undefined.",
        missingResult:"The specified result variable is null or undefined.",missingResults:"The specified results array is null or undefined.",missingSector:"The specified sector is null or undefined.",missingShapeType:"The specified shape type is null or undefined.",missingSize:"The specified size is null or undefined.",missingText:"The specified text is null or undefined.",missingTexture:"The specified texture is null or undefined.",missingTile:"The specified tile is null or undefined.",missingType:"The specified type is null or undefined.",
        missingUrl:"The specified URL is null or undefined",missingVector:"The specified vector is null or undefined.",missingVertex:"The specified vertex is null or undefined.",missingViewport:"The specified viewport is null or undefined.",missingWorldWindow:"The specified World Window is null or undefined.",notYetImplemented:"This function is not yet implemented"}},b=1;return f});
define("src/util/Color",["../util/Logger"],function(f){var b=function(b,a,d,e){this.red=b;this.green=a;this.blue=d;this.alpha=e};b.WHITE=new b(1,1,1,1);b.BLACK=new b(0,0,0,1);b.RED=new b(1,0,0,1);b.GREEN=new b(0,1,0,1);b.BLUE=new b(0,0,1,1);b.CYAN=new b(0,1,1,1);b.YELLOW=new b(1,1,0,1);b.MAGENTA=new b(1,0,1,1);b.LIGHT_GRAY=new b(.75,.75,.75,1);b.MEDIUM_GRAY=new b(.5,.5,.5,1);b.DARK_GRAY=new b(.25,.25,.25,1);b.TRANSPARENT=new b(0,0,0,0);b.prototype.set=function(b,a,d,e){this.red=b;this.green=a;this.blue=
    d;this.alpha=e;return this};b.prototype.copy=function(b){if(!b)throw new ArgumentError(f.logMessage(f.LEVEL_SEVERE,"Color","copy","missingColor"));this.red=b.red;this.green=b.green;this.blue=b.blue;this.alpha=b.alpha;return this};b.prototype.clone=function(){return new b(this.red,this.green,this.blue,this.alpha)};b.prototype.premultipliedComponents=function(b){var a=this.alpha;b[0]=this.red*a;b[1]=this.green*a;b[2]=this.blue*a;b[3]=a;return b};b.colorFromByteArray=function(c){return new b(c[0]/255,
    c[1]/255,c[2]/255,c[3]/255)};b.colorFromBytes=function(c,a,d,e){return new b(c/255,a/255,d/255,e/255)};b.colorFromHex=function(c){var a=parseInt(c.substring(0,2),16),d=parseInt(c.substring(2,4),16),e=parseInt(c.substring(4,6),16);c=parseInt(c.substring(6,8),16);return b.colorFromBytes(a,d,e,c)};b.colorFromKmlHex=function(c){c=c.split("").reverse().join("");return b.colorFromHex(c)};b.prototype.nextColor=function(){var b=Math.round(255*this.red),a=Math.round(255*this.green),d=Math.round(255*this.blue);
    255>b?this.red=(b+1)/255:255>a?(this.red=0,this.green=(a+1)/255):255>d?(this.green=this.red=0,this.blue=(d+1)/255):(this.red=1/255,this.blue=this.green=0);return this};b.prototype.equals=function(b){var a=Math.round(255*this.green),d=Math.round(255*this.blue),e=Math.round(255*this.alpha),g=Math.round(255*b.green),h=Math.round(255*b.blue),k=Math.round(255*b.alpha);return Math.round(255*this.red)===Math.round(255*b.red)&&a===g&&d===h&&e===k};b.prototype.equalsBytes=function(b){var a=Math.round(255*
    this.green),d=Math.round(255*this.blue),e=Math.round(255*this.alpha);return Math.round(255*this.red)===b[0]&&a===b[1]&&d===b[2]&&e===b[3]};b.prototype.toByteString=function(){return"("+Math.round(255*this.red)+","+Math.round(255*this.green)+","+Math.round(255*this.blue)+","+Math.round(255*this.alpha)+")"};b.prototype.toHexString=function(b){var a=Math.ceil(255*this.red).toString(16),d=Math.ceil(255*this.green).toString(16),e=Math.ceil(255*this.blue).toString(16),g=Math.ceil(255*this.alpha).toString(16),
    a="#"+(2>a.length?"0"+a:a),a=a+(2>d.length?"0"+d:d),a=a+(2>e.length?"0"+e:e);b&&(a+=2>g.length?"0"+g:g);return a};b.prototype.toRGBAString=function(){return"rgba("+Math.floor(255*this.red)+" ,"+Math.floor(255*this.green)+" ,"+Math.floor(255*this.blue)+" ,"+this.alpha+")"};return b});define("src/error/ArgumentError",["../error/AbstractError"],function(f){var b=function(b){f.call(this,"ArgumentError",b);try{throw Error();}catch(a){b=a.stack}this.stack=b};b.prototype=Object.create(f.prototype);return b});
define("src/util/Font",["../error/ArgumentError","../util/Color","../util/Logger"],function(f,b,c){b=function(a,d,b,g,h,k){if(a){if(0>=a)throw new f(c.logMessage(c.LEVEL_SEVERE,"Font","constructor","invalidSize"));this._size=a}else throw new f(c.logMessage(c.LEVEL_SEVERE,"Font","constructor","missingSize"));this.style=d||"normal";this.variant=b||"normal";this.weight=g||"normal";this.family=h||"sans-serif";this.horizontalAlignment=k||"center"};Object.defineProperties(b.prototype,{size:{get:function(){return this._size},
    set:function(a){this._fontString=null;this._size=a}},style:{get:function(){return this._style},set:function(a){this._fontString=null;this._style=a}},variant:{get:function(){return this._variant},set:function(a){this._fontString=null;this._variant=a}},weight:{get:function(){return this._weight},set:function(a){this._fontString=null;this._weight=a}},family:{get:function(){return this._family},set:function(a){this._fontString=null;this._family=a}},horizontalAlignment:{get:function(){return this._horizontalAlignment},
    set:function(a){this._toString=null;this._horizontalAlignment=a}},fontString:{get:function(){this._fontString||(this._fontString=this._style+" "+this.variant+" "+this._weight+" "+this._size.toString()+"px "+this._family);return this._fontString}}});b.prototype.toString=function(){this._toString&&this._fontString||(this._toString=this.fontString+" "+this.horizontalAlignment);return this._toString};return b});
define("src/util/Insets",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a,d,e,g){if(4!==arguments.length)throw new f(b.logMessage(b.LEVEL_SEVERE,"Insets","constructor","invalidArgumentCount"));this._top=a;this._left=d;this._bottom=e;this._right=g};c.prototype.set=function(a,d,b,g){this._top=a;this._left=d;this._bottom=b;this._right=g};c.prototype.clone=function(){return new c(this._top,this._left,this._bottom,this._right)};c.prototype.toString=function(){return this._top+
    " "+this._left+" "+this._bottom+" "+this._right};Object.defineProperties(c.prototype,{top:{get:function(){return this._top},set:function(a){this._top=a}},left:{get:function(){return this._left},set:function(a){this._left=a}},bottom:{get:function(){return this._bottom},set:function(a){this._bottom=a}},right:{get:function(){return this._right},set:function(a){this._right=a}}});return c});
define("src/geom/Vec3",["../util/Logger","../error/ArgumentError"],function(f,b){var c=function(a,d,b){this[0]=a;this[1]=d;this[2]=b};c.prototype=new Float64Array(3);c.ZERO=new c(0,0,0);c.average=function(a,d){if(!a||1>a.length)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","average","missingArray"));if(!d)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","average","missingResult"));var e=a.length,g;d[0]=0;d[1]=0;for(var h=d[2]=0,c=a.length;h<c;h++)g=a[h],d[0]+=g[0]/e,d[1]+=g[1]/e,d[2]+=g[2]/e;return d};
    c.averageOfBuffer=function(a,d){if(!a||1>a.length)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","averageBuffer","missingArray"));if(!d)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","averageBuffer","missingResult"));var e=a.length/3;d[0]=0;d[1]=0;for(var c=d[2]=0;c<e;c++)d[0]+=a[3*c]/e,d[1]+=a[3*c+1]/e,d[2]+=a[3*c+2]/e;return d};c.areColinear=function(a,d,e){if(!a||!d||!e)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","areColinear","missingVector"));a=d.subtract(a).normalize();d=e.subtract(d).normalize();
        return.999<Math.abs(a.dot(d))};c.computeTriangleNormal=function(a,d,e){if(!a||!d||!e)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","areColinear","missingVector"));var g=(d[1]-a[1])*(e[2]-a[2])-(d[2]-a[2])*(e[1]-a[1]),h=(d[2]-a[2])*(e[0]-a[0])-(d[0]-a[0])*(e[2]-a[2]);a=(d[0]-a[0])*(e[1]-a[1])-(d[1]-a[1])*(e[0]-a[0]);d=g*g+h*h+a*a;if(0===d)return new c(g,h,a);d=Math.sqrt(d);return new c(g/d,h/d,a/d)};c.findThreeIndependentVertices=function(a,d){var b=d&&0<d?d:3;if(!a||a.length<3*b)return null;for(var g=
        new c(a[0],a[1],a[2]),h=null,k=null,l=b;l<a.length;l+=b){h=new c(a[l],a[l+1],a[l+2]);if(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2])break;h=null}if(!h)return null;for(l+=b;l<a.length;l+=b){k=new c(a[l],a[l+1],a[l+2]);if(!(k[0]===g[0]&&k[1]===g[1]&&k[2]===g[2]||k[0]===h[0]&&k[1]===h[1]&&k[2]===h[2]||c.areColinear(g,h,k)))break;k=null}return k?[g,h,k]:null};c.computeBufferNormal=function(a,d){var b=c.findThreeIndependentVertices(a,d);return b?c.computeTriangleNormal(b[0],b[1],b[2]):null};c.prototype.set=
        function(a,d,b){this[0]=a;this[1]=d;this[2]=b;return this};c.prototype.copy=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","copy","missingVector"));this[0]=a[0];this[1]=a[1];this[2]=a[2];return this};c.prototype.equals=function(a){return this[0]===a[0]&&this[1]===a[1]&&this[2]===a[2]};c.prototype.add=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","add","missingVector"));this[0]+=a[0];this[1]+=a[1];this[2]+=a[2];return this};c.prototype.subtract=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,
        "Vec3","subtract","missingVector"));this[0]-=a[0];this[1]-=a[1];this[2]-=a[2];return this};c.prototype.multiply=function(a){this[0]*=a;this[1]*=a;this[2]*=a;return this};c.prototype.divide=function(a){this[0]/=a;this[1]/=a;this[2]/=a;return this};c.prototype.multiplyByMatrix=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","multiplyByMatrix","missingMatrix"));var d=a[4]*this[0]+a[5]*this[1]+a[6]*this[2]+a[7],e=a[8]*this[0]+a[9]*this[1]+a[10]*this[2]+a[11],c=a[12]*this[0]+a[13]*this[1]+
        a[14]*this[2]+a[15];this[0]=(a[0]*this[0]+a[1]*this[1]+a[2]*this[2]+a[3])/c;this[1]=d/c;this[2]=e/c;return this};c.prototype.mix=function(a,d){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","mix","missingVector"));var e=1-d;this[0]=this[0]*e+a[0]*d;this[1]=this[1]*e+a[1]*d;this[2]=this[2]*e+a[2]*d;return this};c.prototype.negate=function(){this[0]=-this[0];this[1]=-this[1];this[2]=-this[2];return this};c.prototype.dot=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","dot","missingVector"));
        return this[0]*a[0]+this[1]*a[1]+this[2]*a[2]};c.prototype.cross=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","cross","missingVector"));var d=this[2]*a[0]-this[0]*a[2],e=this[0]*a[1]-this[1]*a[0];this[0]=this[1]*a[2]-this[2]*a[1];this[1]=d;this[2]=e;return this};c.prototype.magnitudeSquared=function(){return this.dot(this)};c.prototype.magnitude=function(){return Math.sqrt(this.magnitudeSquared())};c.prototype.normalize=function(){var a=1/this.magnitude();this[0]*=a;this[1]*=a;
        this[2]*=a;return this};c.prototype.distanceToSquared=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","distanceToSquared","missingVector"));var d=this[0]-a[0],e=this[1]-a[1];a=this[2]-a[2];return d*d+e*e+a*a};c.prototype.distanceTo=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec3","distanceTo","missingVector"));return Math.sqrt(this.distanceToSquared(a))};c.prototype.swap=function(a){var d=this[0];this[0]=a[0];a[0]=d;d=this[1];this[1]=a[1];a[1]=d;d=this[2];this[2]=
        a[2];a[2]=d;return this};c.prototype.toString=function(){return"("+this[0]+", "+this[1]+", "+this[2]+")"};return c});
define("src/geom/Vec2",["../util/Logger","../error/ArgumentError","../geom/Vec3"],function(f,b,c){var a=function(a,b){this[0]=a;this[1]=b};a.prototype=new Float64Array(2);a.prototype.set=function(a,b){this[0]=a;this[1]=b;return this};a.prototype.copy=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec2","copy","missingVector"));this[0]=a[0];this[1]=a[1];return this};a.prototype.equals=function(a){return this[0]===a[0]&&this[1]===a[1]};a.average=function(a,e){if(!a||1>a.length)throw new b(f.logMessage(f.LEVEL_SEVERE,
    "Vec2","average","missingArray"));if(!e)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec2","average","missingResult"));var c=a.length,h;e[0]=0;for(var k=e[1]=0,l=a.length;k<l;k++)h=a[k],e[0]+=h[0]/c,e[1]+=h[1]/c;return e};a.prototype.add=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec2","add","missingVector"));this[0]+=a[0];this[1]+=a[1];return this};a.prototype.subtract=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec2","subtract","missingVector"));this[0]-=a[0];this[1]-=
    a[1];return this};a.prototype.multiply=function(a){this[0]*=a;this[1]*=a;return this};a.prototype.divide=function(a){this[0]/=a;this[1]/=a;return this};a.prototype.mix=function(a,e){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec2","mix","missingVector"));var c=1-e;this[0]=this[0]*c+a[0]*e;this[1]=this[1]*c+a[1]*e;return this};a.prototype.negate=function(){this[0]=-this[0];this[1]=-this[1];return this};a.prototype.dot=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec2","dot","missingVector"));
    return this[0]*a[0]+this[1]*a[1]};a.prototype.magnitudeSquared=function(){return this.dot(this)};a.prototype.magnitude=function(){return Math.sqrt(this.magnitudeSquared())};a.prototype.normalize=function(){var a=1/this.magnitude();this[0]*=a;this[1]*=a;return this};a.prototype.distanceToSquared=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,"Vec2","distanceToSquared","missingVector"));var e=this[0]-a[0];a=this[1]-a[1];return e*e+a*a};a.prototype.distanceTo=function(a){if(!a)throw new b(f.logMessage(f.LEVEL_SEVERE,
    "Vec2","distanceTo","missingVector"));return Math.sqrt(this.distanceToSquared(a))};a.prototype.toVec3=function(){return new c(this[0],this[1],0)};a.prototype.swap=function(a){var b=this[0];this[0]=a[0];a[0]=b;b=this[1];this[1]=a[1];a[1]=b;return this};a.prototype.toString=function(){return"("+this[0]+", "+this[1]+")"};return a});
define("src/util/Offset",["../geom/Vec2"],function(f){var b=function(b,a,d,e){this.x=a;this.y=e;this.xUnits=b;this.yUnits=d};b.prototype.clone=function(){return new b(this.xUnits,this.x,this.yUnits,this.y)};b.prototype.offsetForSize=function(b,a){return new f(this.xUnits==WorldWind.OFFSET_FRACTION?b*this.x:this.xUnits==WorldWind.OFFSET_INSET_PIXELS?b-this.x:this.x,this.yUnits==WorldWind.OFFSET_FRACTION?a*this.y:this.yUnits==WorldWind.OFFSET_INSET_PIXELS?a-this.y:this.y)};b.prototype.toString=function(){return this.xUnits+
    " "+this.x+" "+this.yUnits+" "+this.y};return b});
define("src/shapes/TextAttributes",["../util/Color","../util/Font","../util/Offset"],function(f,b,c){var a=function(a){this._color=a?a._color:new f(1,1,1,1);this._font=a?a._font:new b(14);this._offset=a?a._offset:new c(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0);this._scale=a?a._scale:1;this._depthTest=a?a._depthTest:!1;this.stateKeyInvalid=!0};a.prototype.computeStateKey=function(){return"c "+this._color.toHexString(!0)+" f "+this._font.toString()+" o "+this._offset.toString()+" s "+
    this._scale+" dt "+this._depthTest};Object.defineProperties(a.prototype,{stateKey:{get:function(){this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1);return this._stateKey}},color:{get:function(){return this._color},set:function(a){this._color=a;this.stateKeyInvalid=!0}},font:{get:function(){return this._font},set:function(a){this._font=a;this.stateKeyInvalid=!0}},offset:{get:function(){return this._offset},set:function(a){this._offset=a;this.stateKeyInvalid=!0}},
    scale:{get:function(){return this._scale},set:function(a){this._scale=a;this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(a){this._depthTest=a;this.stateKeyInvalid=!0}}});return a});
define("src/shapes/AnnotationAttributes",["../util/Color","../util/Font","../util/Insets","../shapes/TextAttributes"],function(f,b,c,a){b=function(d){this._cornerRadius=d?d._cornerRadius:0;this._insets=d?d._insets:new c(0,0,0,0);this._backgroundColor=d?d._backgroundColor:f.WHITE;this._leaderGapWidth=d?d._leaderGapWidth:40;this._leaderGapHeight=d?d._leaderGapHeight:30;this._opacity=d?d._opacity:1;this._scale=d?d._scale:1;this._drawLeader=d?d._drawLeader:!0;this._width=d?d._width:200;this._height=d?
    d._height:100;this._textAttributes=d?d._textAttributes:new a(null);this.stateKeyInvalid=!0};b.prototype.computeStateKey=function(){return"wi "+this._width+" he "+this._height+" cr "+this._cornerRadius+" in "+this._insets.toString()+" bg "+this.backgroundColor.toHexString(!0)+" dl "+this.drawLeader+" lgw "+this.leaderGapWidth+" lgh "+this.leaderGapHeight+" op "+this.opacity+" ta "+this._textAttributes.stateKey+" sc "+this.scale};Object.defineProperties(b.prototype,{width:{get:function(){return this._width},
    set:function(a){this._width=a;this.stateKeyInvalid=!0}},height:{get:function(){return this._height},set:function(a){this._height=a;this.stateKeyInvalid=!0}},cornerRadius:{get:function(){return this._cornerRadius},set:function(a){this._cornerRadius=a;this.stateKeyInvalid=!0}},insets:{get:function(){return this._insets},set:function(a){this._insets=a;this.stateKeyInvalid=!0}},backgroundColor:{get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a;this.stateKeyInvalid=!0}},
    textAttributes:{get:function(){return this._textAttributes},set:function(a){this._textAttributes=a;this.stateKeyInvalid=!0}},drawLeader:{get:function(){return this._drawLeader},set:function(a){this._drawLeader=a;this.stateKeyInvalid=!0}},leaderGapWidth:{get:function(){return this._leaderGapWidth},set:function(a){this._leaderGapWidth=a;this.stateKeyInvalid=!0}},leaderGapHeight:{get:function(){return this._leaderGapHeight},set:function(a){this._leaderGapHeight=a;this.stateKeyInvalid=!0}},opacity:{get:function(){return this._opacity},
        set:function(a){this._opacity=a;this.stateKeyInvalid=!0}},scale:{get:function(){return this._scale},set:function(a){this._scale=a;this.stateKeyInvalid=!0}},stateKey:{get:function(){this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1);return this._stateKey}}});return b});
define("src/shaders/GpuShader",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a,d,e){if(d!==a.VERTEX_SHADER&&d!==a.FRAGMENT_SHADER)throw new f(b.logMessage(b.LEVEL_SEVERE,"GpuShader","constructor","The specified shader type is unrecognized."));if(!e)throw new f(b.logMessage(b.LEVEL_SEVERE,"GpuShader","constructor","The specified shader source is null or undefined."));var c=a.createShader(d);if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"GpuShader","constructor","Unable to create shader of type "+
    (d==a.VERTEX_SHADER?"VERTEX_SHADER.":"FRAGMENT_SHADER.")));if(!this.compile(a,c,d,e))throw d=a.getShaderInfoLog(c),a.deleteShader(c),new f(b.logMessage(b.LEVEL_SEVERE,"GpuShader","constructor","Unable to compile shader: "+d));this.shaderId=c};c.prototype.compile=function(a,d,b,c){a.shaderSource(d,c);a.compileShader(d);return a.getShaderParameter(d,a.COMPILE_STATUS)};c.prototype.dispose=function(a){this.shaderId&&(a.deleteShader(this.shaderId),delete this.shaderId)};return c});
define("src/shaders/GpuProgram",["../error/ArgumentError","../util/Color","../shaders/GpuShader","../util/Logger"],function(f,b,c,a){b=function(d,b,g,h){if(!b||!g)throw new f(a.logMessage(a.LEVEL_SEVERE,"GpuProgram","constructor","The specified shader source is null or undefined."));var k,l,m;try{l=new c(d,d.VERTEX_SHADER,b),m=new c(d,d.FRAGMENT_SHADER,g)}catch(t){throw l&&l.dispose(d),m&&m.dispose(d),t;}k=d.createProgram();if(!k)throw new f(a.logMessage(a.LEVEL_SEVERE,"GpuProgram","constructor",
    "Unable to create shader program."));d.attachShader(k,l.shaderId);d.attachShader(k,m.shaderId);if(h)for(var p=0,q=h.length;p<q;p++)d.bindAttribLocation(k,p,h[p]);if(!this.link(d,k))throw b=d.getProgramInfoLog(k),d.detachShader(k,l.shaderId),d.detachShader(k,m.shaderId),d.deleteProgram(k),l.dispose(d),m.dispose(d),new f(a.logMessage(a.LEVEL_SEVERE,"GpuProgram","constructor","Unable to link shader program: "+b));this.programId=k;this.attributeLocations={};this.uniformLocations={};this.vertexShader=
    l;this.fragmentShader=m;this.size=b.length+g.length;this.scratchArray=new Float32Array(16)};b.prototype.dispose=function(a){this.programId&&(this.vertexShader&&a.detachShader(this.programId,this.vertexShader.shaderId),this.fragmentShader&&a.detachShader(this.programId,this.fragmentShader.shaderId),a.deleteProgram(this.programId),delete this.programId);this.vertexShader&&(this.vertexShader.dispose(a),delete this.vertexShader);this.fragmentShader&&(this.fragmentShader.dispose(a),delete this.fragmentShader);
    this.attributeLocations={};this.uniformLocations={}};b.prototype.attributeLocation=function(d,b){if(!b||0==b.length)throw new f(a.logMessage(a.LEVEL_SEVERE,"GpuProgram","attributeLocation","The specified attribute name is null, undefined or empty."));var c=this.attributeLocations[b];c||(c=d.getAttribLocation(this.programId,b),this.attributeLocations[b]=c);return c};b.prototype.uniformLocation=function(d,b){if(!b||0==b.length)throw new f(a.logMessage(a.LEVEL_SEVERE,"GpuProgram","uniformLocation","The specified uniform name is null, undefined or empty."));
    var c=this.uniformLocations[b];c||(c=d.getUniformLocation(this.programId,b),this.uniformLocations[b]=c);return c};b.prototype.link=function(a,b){a.linkProgram(b);return a.getProgramParameter(b,a.LINK_STATUS)};b.prototype.loadUniformMatrix=function(d,b,c){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"GpuProgram","loadUniformMatrix","missingMatrix"));b=b.columnMajorComponents(this.scratchArray);d.uniformMatrix4fv(c,!1,b)};b.prototype.loadUniformColor=function(d,b,c){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,
    "GpuProgram","loadUniformColor","missingColor"));b=b.premultipliedComponents(this.scratchArray);d.uniform4f(c,b[0],b[1],b[2],b[3])};b.prototype.loadUniformColorComponents=function(a,b,c,h,k,l){a.uniform4f(l,b*k,c*k,h*k,k)};return b});
define("src/shaders/BasicTextureProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(f,b,c,a){b=function(a){c.call(this,a,"attribute vec4 vertexPoint;\nattribute vec4 vertexTexCoord;\nattribute vec4 normalVector;\nuniform mat4 mvpMatrix;\nuniform mat4 mvInverseMatrix;\nuniform mat4 texCoordMatrix;\nuniform bool applyLighting;\nvarying vec2 texCoord;\nvarying vec4 normal;\nvoid main() {gl_Position = mvpMatrix * vertexPoint;\ntexCoord = (texCoordMatrix * vertexTexCoord).st;\nif (applyLighting) {normal = mvInverseMatrix * normalVector;}\n}","precision mediump float;\nuniform float opacity;\nuniform vec4 color;\nuniform bool enableTexture;\nuniform bool modulateColor;\nuniform sampler2D textureSampler;\nuniform bool applyLighting;\nvarying vec2 texCoord;\nvarying vec4 normal;\nvoid main() {\nvec4 textureColor = texture2D(textureSampler, texCoord);\nfloat ambient = 0.15; vec4 lightDirection = vec4(0, 0, 1, 0);\nif (enableTexture && !modulateColor)\n    gl_FragColor = textureColor * color * opacity;\nelse if (enableTexture && modulateColor)\n    gl_FragColor = color * floor(textureColor.a + 0.5);\nelse\n    gl_FragColor = color * opacity;\nif (gl_FragColor.a == 0.0) {discard; return;}\nif (applyLighting) {\n    vec4 n = normal * (gl_FrontFacing ? 1.0 : -1.0);\n    gl_FragColor.rgb *= clamp(ambient + dot(lightDirection, n), 0.0, 1.0);\n}\n}",
    ["vertexPoint","normalVector","vertexTexCoord"]);this.vertexPointLocation=this.attributeLocation(a,"vertexPoint");this.normalVectorLocation=this.attributeLocation(a,"normalVector");this.vertexTexCoordLocation=this.attributeLocation(a,"vertexTexCoord");this.mvpMatrixLocation=this.uniformLocation(a,"mvpMatrix");this.mvInverseMatrixLocation=this.uniformLocation(a,"mvInverseMatrix");this.colorLocation=this.uniformLocation(a,"color");this.textureEnabledLocation=this.uniformLocation(a,"enableTexture");
    this.modulateColorLocation=this.uniformLocation(a,"modulateColor");this.textureUnitLocation=this.uniformLocation(a,"textureSampler");this.textureMatrixLocation=this.uniformLocation(a,"texCoordMatrix");this.opacityLocation=this.uniformLocation(a,"opacity");this.applyLightingLocation=this.uniformLocation(a,"applyLighting")};b.key="WorldWindGpuBasicTextureProgram";b.prototype=Object.create(c.prototype);b.prototype.loadModelviewInverse=function(d,b){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"BasicTextureProgram",
    "loadModelviewInverse","missingMatrix"));this.loadUniformMatrix(d,b,this.mvInverseMatrixLocation)};b.prototype.loadModelviewProjection=function(d,b){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"BasicTextureProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(d,b,this.mvpMatrixLocation)};b.prototype.loadColor=function(d,b){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"BasicTextureProgram","loadColor","missingColor"));this.loadUniformColor(d,b,this.colorLocation)};b.prototype.loadTextureEnabled=
    function(a,b){a.uniform1i(this.textureEnabledLocation,b?1:0)};b.prototype.loadModulateColor=function(a,b){a.uniform1i(this.modulateColorLocation,b?1:0)};b.prototype.loadTextureUnit=function(a,b){a.uniform1i(this.textureUnitLocation,b-a.TEXTURE0)};b.prototype.loadTextureMatrix=function(a,b){this.loadUniformMatrix(a,b,this.textureMatrixLocation)};b.prototype.loadOpacity=function(a,b){a.uniform1f(this.opacityLocation,b)};b.prototype.loadApplyLighting=function(a,b){a.uniform1i(this.applyLightingLocation,
    b)};return b});
define("src/geom/Line",["../error/ArgumentError","../util/Logger","../geom/Vec3"],function(f,b,c){var a=function(a,e){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"Line","constructor","Origin is null or undefined."));if(!e)throw new f(b.logMessage(b.LEVEL_SEVERE,"Line","constructor","Direction is null or undefined."));this.origin=a;this.direction=e};a.fromSegment=function(d,e){if(!d||!e)throw new f(b.logMessage(b.LEVEL_SEVERE,"Line","fromSegment","missingPoint"));var g=new c(d[0],d[1],d[2]),h=new c(e[0]-
    d[0],e[1]-d[1],e[2]-d[2]);return new a(g,h)};a.prototype.pointAt=function(a,e){if(!e)throw new f(b.logMessage(b.LEVEL_SEVERE,"Line","pointAt","missingResult."));e[0]=this.origin[0]+this.direction[0]*a;e[1]=this.origin[1]+this.direction[1]*a;e[2]=this.origin[2]+this.direction[2]*a;return e};return a});
define("src/geom/Plane",["../error/ArgumentError","../geom/Line","../util/Logger","../geom/Vec3"],function(f,b,c,a){var d=function(d,b,h,c){this.normal=new a(d,b,h);this.distance=c};d.fromPoints=function(b,g,h){if(!b||!g||!h)throw new f(c.logMessage(c.LEVEL_SEVERE,"Plane","fromPoints","missingVector"));g=new a(g[0],g[1],g[2]);g.subtract(b);h=new a(h[0],h[1],h[2]);h.subtract(b);g.cross(h);g.normalize();b=-g.dot(b);return new d(g[0],g[1],g[2],b)};d.prototype.dot=function(a){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,
    "Plane","dot","missingVector"));return this.normal.dot(a)+this.distance};d.prototype.distanceToPoint=function(a){return this.dot(a)};d.prototype.transformByMatrix=function(a){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"Plane","transformByMatrix","missingMatrix"));var d=a[4]*this.normal[0]+a[5]*this.normal[1]+a[6]*this.normal[2]+a[7]*this.distance,b=a[8]*this.normal[0]+a[9]*this.normal[1]+a[10]*this.normal[2]+a[11]*this.distance,k=a[12]*this.normal[0]+a[13]*this.normal[1]+a[14]*this.normal[2]+a[15]*
    this.distance;this.normal[0]=a[0]*this.normal[0]+a[1]*this.normal[1]+a[2]*this.normal[2]+a[3]*this.distance;this.normal[1]=d;this.normal[2]=b;this.distance=k;return this};d.prototype.normalize=function(){var a=this.normal.magnitude();if(0===a)return this;this.normal.divide(a);this.distance/=a;return this};d.prototype.intersectsSegment=function(a,d){var b=this.dot(a),c=this.dot(d);return 0>=b*c};d.prototype.intersectsSegmentAt=function(a,d,b){var c=this.dot(a),l=this.dot(d);if(0===c&&0===l)return b[0]=
    a[0],b[1]=a[1],b[2]=a[2],!0;if(c===l)return!1;var m=-c/(l-c),p=1-m;b[0]=m*a[0]+p*d[0];b[1]=m*a[1]+p*d[1];b[2]=m*a[2]+p*d[2];return 0>=c*l};d.prototype.onSameSide=function(a,d){if(!a||!d)throw new f(c.logMessage(c.LEVEL_SEVERE,"Plane","onSameSide","missingPoint"));var b=this.distanceToPoint(a),k=this.distanceToPoint(d);return 0>b&&0>k?-1:0<b&&0<k?1:0};d.prototype.clip=function(d,g){if(!d||!g)throw new f(c.logMessage(c.LEVEL_SEVERE,"Plane","clip","missingPoint"));if(d.equals(g))return null;var h=b.fromSegment(d,
    g),k=this.normal.dot(h.direction),l;if(0===k)return k=this.dot(h.origin),0===k?[d,g]:null;l=-this.dot(h.origin)/k;if(0>l||1<l)return null;h=h.pointAt(l,new a(0,0,0));return 0<k?[h,g]:[d,h]};return d});
define("src/geom/Rectangle",["../util/Logger"],function(f){f=function(b,c,a,d){this.x=b;this.y=c;this.width=a;this.height=d};f.prototype.set=function(b,c,a,d){this.x=b;this.y=c;this.width=a;this.height=d};f.prototype.getMinX=function(){return this.x};f.prototype.getMinY=function(){return this.y};f.prototype.getMaxX=function(){return this.x+this.width};f.prototype.getMaxY=function(){return this.y+this.height};f.prototype.containsPoint=function(b){return b[0]>=this.x&&b[0]<=this.x+this.width&&b[1]>=
    this.y&&b[1]<=this.y+this.height};f.prototype.intersects=function(b){return b.x+b.width<this.x||b.x>this.x+this.width||b.y+b.height<this.y||b.y>this.y+this.height?!1:!0};f.prototype.intersectsRectangles=function(b){if(b)for(var c=0;c<b.length;c++)if(this.intersects(b[c]))return!0;return!1};f.prototype.toString=function(){return this.x+", "+this.y+", "+this.width+", "+this.height};return f});
define("src/util/WWMath","../geom/Angle ../error/ArgumentError ../geom/Line ../util/Logger ../geom/Rectangle ../geom/Vec3".split(" "),function(f,b,c,a,d,e){var g={clamp:function(a,d,b){return a<d?d:a>b?b:a},interpolate:function(a,d,b){return(1-a)*d+a*b},cbrt:function(a){return"function"==typeof Math.cbrt?Math.cbrt(a):Math.pow(a,1/3)},computeEllipsoidalGlobeIntersection:function(d,e,c,g){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeEllipsoidalGlobeIntersection","missingLine"));if(!g)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "WWMath","computeEllipsoidalGlobeIntersection","missingResult"));var p=d.direction[0],q=d.direction[1],f=d.direction[2],r=d.origin[0],u=d.origin[1];d=d.origin[2];c=e/c;var w=c*c;c=p*p+w*q*q+f*f;var x=2*(r*p+w*u*q+d*f);e=x*x-4*c*(r*r+w*u*u+d*d-e*e);if(0>e)return!1;e=(-x-Math.sqrt(e))/(2*c);g[0]=r+p*e;g[1]=u+q*e;g[2]=d+f*e;return!0},computeTriangleIntersection:function(d,e,c,g,p){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingLine"));if(!e||!c||!g)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "WWMath","computeTriangleIntersection","missingVertex"));if(!p)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingResult"));var q=d.direction[0],f=d.direction[1],r=d.direction[2],u=d.origin[0],w=d.origin[1];d=d.origin[2];var x=c[0]-e[0],A=c[1]-e[1],B=c[2]-e[2];c=g[0]-e[0];var v=g[1]-e[1];g=g[2]-e[2];var F=f*g-r*v,G=r*c-q*g,D=q*v-f*c,y=x*F+A*G+B*D;if(-1E-5<y&&1E-5>y)return!1;var y=1/y,H=u-e[0],C=w-e[1];e=d-e[2];F=y*(H*F+C*G+e*D);if(-1E-5>F||1.00001<F)return!1;G=
    C*B-e*A;B=e*x-H*B;x=H*A-C*x;A=y*(q*G+f*B+r*x);if(-1E-5>A||1.00001<F+A)return!1;c=y*(c*G+v*B+g*x);if(0>c)return!1;p[0]=u+q*c;p[1]=w+f*c;p[2]=d+r*c;return!0},computeIndexedTrianglesIntersection:function(d,c,l,m){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingLine"));if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingPoints"));if(!l)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection",
    "missingIndices"));if(!m)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingResults"));for(var p=new e(0,0,0),q=new e(0,0,0),f=new e(0,0,0),r=new e(0,0,0),u=0,w=l.length;u<w;u+=3){var x=3*l[u],A=3*l[u+1],B=3*l[u+2];p[0]=c[x];p[1]=c[x+1];p[2]=c[x+2];q[0]=c[A];q[1]=c[A+1];q[2]=c[A+2];f[0]=c[B];f[1]=c[B+1];f[2]=c[B+2];g.computeTriangleIntersection(d,p,q,f,r)&&(m.push(r),r=new e(0,0,0))}return 0<m.length},computeTriStripIntersections:function(d,c,g,m){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "WWMath","computeTriStripIntersections","missingLine"));if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingPoints"));if(!g)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingIndices"));if(!m)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingResults"));var p=d.direction[0],q=d.direction[1],f=d.direction[2],r=d.origin[0],u=d.origin[1];d=d.origin[2];var w,x,A,B,v,F,G,D,y,H,C,z,E,L,M,
    I,K,O,N;y=3*g[0];B=c[y++];v=c[y++];F=c[y];y=3*g[1];G=c[y++];D=c[y++];y=c[y];for(var R=2,S=g.length;R<S;R++)w=B,x=v,A=F,B=G,v=D,F=y,y=3*g[R],G=c[y++],D=c[y++],y=c[y],H=B-w,C=v-x,z=F-A,E=G-w,L=D-x,M=y-A,I=q*M-f*L,K=f*E-p*M,O=p*L-q*E,N=H*I+C*K+z*O,-1E-5<N&&1E-5>N||(N=1/N,w=r-w,x=u-x,A=d-A,K=N*(w*I+x*K+A*O),-1E-5>K||1.00001<K||(I=x*z-A*C,z=A*H-w*z,H=w*C-x*H,C=N*(p*I+q*z+f*H),-1E-5>C||1.00001<K+C||(E=N*(E*I+L*z+M*H),0<=E&&m.push(new e(r+p*E,u+q*E,d+f*E)))))},fabs:function(a){return 0<=a?a:-a},fmod:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               d){return 0===d?0:a-Math.floor(a/d)*d},fract:function(a){return a-Math.floor(a)},mod:function(a,d){return(a%d+d)%d},max:function(a,d){return a>d?a:d},localCoordinateAxesAtPoint:function(d,c,e,g,p){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingVector"));if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingGlobe"));if(!e||!g||!p)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingResult"));
    var q=d[0],f=d[1];d=d[2];c.surfaceNormalAtPoint(q,f,d,p);c.northTangentAtPoint(q,f,d,g);e.set(g[0],g[1],g[2]);e.cross(p);e.normalize();g.set(p[0],p[1],p[2]);g.cross(e);g.normalize()},horizonDistanceForGlobeRadius:function(d,c){if(0>d)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","horizontalDistanceForGlobeRadius","The specified globe radius is negative."));return 0<d&&0<c?Math.sqrt(c*(2*d+c)):0},perspectiveNearDistanceForFarDistance:function(d,c,e){if(0>d)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "WWMath","perspectiveNearDistanceForFarDistance","The specified distance is negative."));if(0>c)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified resolution is negative."));if(1>e)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified depth bits is negative."));e=(1<<e)-1;return d/(e/(1-c/d)-e+1)},perspectiveNearDistance:function(d,c,e){if(0>=d)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectiveNearDistance",
    "invalidWidth"));if(0>=c)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","invalidHeight"));if(0>e)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","The specified distance is negative."));d=c/d;return 2*e/Math.sqrt(d*d+5)},perspectiveFrustumRectangle:function(c,e,g){if(0>=c)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","invalidWidth"));if(0>=e)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle",
    "invalidHeight"));if(0>g)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","The specified distance is negative."));c=g*e/c;return new d(-g/2,-c/2,g,c)},perspectivePixelSize:function(d,c,e){if(0>=d)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectivePixelSize","invalidWidth"));if(0>=c)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectivePixelSize","invalidHeight"));if(0>e)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","perspectivePixelSize","The specified distance is negative."));
    return g.perspectiveFrustumRectangle(d,c,e).height/c},boundingRectForUnitQuad:function(c){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"WWMath","boundingRectForUnitQuad","missingMatrix"));var e=c[3],g=c[7],m=c[0]+c[3],p=c[4]+c[7],q=c[1]+c[3],f=c[5]+c[7],r=c[0]+c[1]+c[3];c=c[4]+c[5]+c[7];var u=Math.min(Math.min(e,m),Math.min(q,r)),w=Math.min(Math.min(g,p),Math.min(f,c));return new d(u,w,Math.max(Math.max(e,m),Math.max(q,r))-u,Math.max(Math.max(g,p),Math.max(f,c))-w)},isPowerOfTwo:function(a){return 0!=
    a&&0===(a&a-1)},signum:function(a){return 0<a?1:0>a?-1:0},gudermannianInverse:function(a){return Math.log(Math.tan(Math.PI/4+a*f.DEGREES_TO_RADIANS/2))/Math.PI},epsg3857ToEpsg4326:function(a,d){var b=a/6378100;return[g.clamp((Math.PI/2-2*Math.atan(Math.exp(-d/6378100)))*f.RADIANS_TO_DEGREES,-90,90),g.clamp(b*f.RADIANS_TO_DEGREES,-180,180)]},powerOfTwoFloor:function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.log(2)))}};return g});
define("src/geom/Location","../geom/Angle ../error/ArgumentError ../util/Logger ../geom/Plane ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e){var g=function(a,d){this.latitude=a;this.longitude=d};g.ZERO=new g(0,0);g.fromRadians=function(a,d){return new g(a*f.RADIANS_TO_DEGREES,d*f.RADIANS_TO_DEGREES)};g.prototype.copy=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","copy","missingLocation"));this.latitude=a.latitude;this.longitude=a.longitude;return this};g.prototype.set=
    function(a,d){this.latitude=a;this.longitude=d;return this};g.prototype.equals=function(a){return a&&a.latitude===this.latitude&&a.longitude===this.longitude};g.interpolateAlongPath=function(a,d,e,g,p){if(!e||!g)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","interpolateAlongPath","missingLocation"));if(!p)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","interpolateAlongPath","missingResult"));return a===WorldWind.GREAT_CIRCLE?this.interpolateGreatCircle(d,e,g,p):a&&a===WorldWind.RHUMB_LINE?
    this.interpolateRhumb(d,e,g,p):this.interpolateLinear(d,e,g,p)};g.interpolateGreatCircle=function(a,d,g,m){if(!d||!g)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","interpolateGreatCircle","missingLocation"));if(!m)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","interpolateGreatCircle","missingResult"));if(d.equals(g))return m.latitude=d.latitude,m.longitude=d.longitude,m;a=e.clamp(a,0,1);var p=this.greatCircleAzimuth(d,g);g=this.greatCircleDistance(d,g);return this.greatCircleLocation(d,
    p,a*g,m)};g.greatCircleAzimuth=function(a,d){if(!a||!d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","greatCircleAzimuth","missingLocation"));var e=a.latitude*f.DEGREES_TO_RADIANS,g=d.latitude*f.DEGREES_TO_RADIANS,p=a.longitude*f.DEGREES_TO_RADIANS,q=d.longitude*f.DEGREES_TO_RADIANS;if(e==g&&p==q)return 0;if(p==q)return e>g?180:0;e=Math.atan2(Math.cos(g)*Math.sin(q-p),Math.cos(e)*Math.sin(g)-Math.sin(e)*Math.cos(g)*Math.cos(q-p));return isNaN(e)?0:e*f.RADIANS_TO_DEGREES};g.greatCircleDistance=
    function(a,d){if(!a||!d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","greatCircleDistance","missingLocation"));var e=a.latitude*f.DEGREES_TO_RADIANS,g=d.latitude*f.DEGREES_TO_RADIANS,p=a.longitude*f.DEGREES_TO_RADIANS,q=d.longitude*f.DEGREES_TO_RADIANS,t;if(e==g&&p==q)return 0;t=Math.sin((g-e)/2);p=Math.sin((q-p)/2);e=2*Math.asin(Math.sqrt(t*t+Math.cos(e)*Math.cos(g)*p*p));return isNaN(e)?0:e};g.greatCircleLocation=function(a,d,e,g){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","greatCircleLocation",
    "missingLocation"));if(!g)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","greatCircleLocation","missingResult"));if(0==e)return g.latitude=a.latitude,g.longitude=a.longitude,g;var p=a.latitude*f.DEGREES_TO_RADIANS,q=a.longitude*f.DEGREES_TO_RADIANS,t=d*f.DEGREES_TO_RADIANS;d=Math.asin(Math.sin(p)*Math.cos(e)+Math.cos(p)*Math.sin(e)*Math.cos(t));e=q+Math.atan2(Math.sin(e)*Math.sin(t),Math.cos(p)*Math.cos(e)-Math.sin(p)*Math.sin(e)*Math.cos(t));isNaN(d)||isNaN(e)?(g.latitude=a.latitude,g.longitude=
    a.longitude):(g.latitude=f.normalizedDegreesLatitude(d*f.RADIANS_TO_DEGREES),g.longitude=f.normalizedDegreesLongitude(e*f.RADIANS_TO_DEGREES));return g};g.interpolateRhumb=function(a,d,g,m){if(!d||!g)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","interpolateRhumb","missingLocation"));if(!m)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","interpolateRhumb","missingResult"));if(d.equals(g))return m.latitude=d.latitude,m.longitude=d.longitude,m;a=e.clamp(a,0,1);var p=this.rhumbAzimuth(d,g);g=
    this.rhumbDistance(d,g);return this.rhumbLocation(d,p,a*g,m)};g.rhumbAzimuth=function(a,d){if(!a||!d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","rhumbAzimuth","missingLocation"));var g=a.latitude*f.DEGREES_TO_RADIANS,m=d.latitude*f.DEGREES_TO_RADIANS,p=a.longitude*f.DEGREES_TO_RADIANS,q=d.longitude*f.DEGREES_TO_RADIANS;if(g==m&&p==q)return 0;p=q-p;g=Math.log(Math.tan(m/2+Math.PI/4)/Math.tan(g/2+Math.PI/4));e.fabs(p)>Math.PI&&(p=0<p?-(2*Math.PI-p):2*Math.PI+p);g=Math.atan2(p,g);return isNaN(g)?
    0:g*f.RADIANS_TO_DEGREES};g.rhumbDistance=function(a,d){if(!a||!d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","rhumbDistance","missingLocation"));var g=a.latitude*f.DEGREES_TO_RADIANS,m=d.latitude*f.DEGREES_TO_RADIANS,p=a.longitude*f.DEGREES_TO_RADIANS,q=d.longitude*f.DEGREES_TO_RADIANS,t;if(g==m&&p==q)return 0;t=m-g;p=q-p;m=Math.log(Math.tan(m/2+Math.PI/4)/Math.tan(g/2+Math.PI/4));q=t/m;if(isNaN(m)||isNaN(q))q=Math.cos(g);e.fabs(p)>Math.PI&&(p=0<p?-(2*Math.PI-p):2*Math.PI+p);g=Math.sqrt(t*
    t+q*q*p*p);return isNaN(g)?0:g};g.rhumbLocation=function(a,d,g,m){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","rhumbLocation","missingLocation"));if(!m)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","rhumbLocation","missingResult"));if(0==g)return m.latitude=a.latitude,m.longitude=a.longitude,m;var p=a.latitude*f.DEGREES_TO_RADIANS,q=a.longitude*f.DEGREES_TO_RADIANS,t=d*f.DEGREES_TO_RADIANS;d=p+g*Math.cos(t);var r=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(p/2+Math.PI/4)),u=(d-p)/
    r;if(isNaN(r)||isNaN(u)||!isFinite(u))u=Math.cos(p);g=g*Math.sin(t)/u;e.fabs(d)>Math.PI/2&&(d=0<d?Math.PI-d:-Math.PI-d);q=e.fmod(q+g+Math.PI,2*Math.PI)-Math.PI;isNaN(d)||isNaN(q)?(m.latitude=a.latitude,m.longitude=a.longitude):(m.latitude=f.normalizedDegreesLatitude(d*f.RADIANS_TO_DEGREES),m.longitude=f.normalizedDegreesLongitude(q*f.RADIANS_TO_DEGREES));return m};g.interpolateLinear=function(a,d,g,m){if(!d||!g)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","interpolateLinear","missingLocation"));
    if(!m)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","interpolateLinear","missingResult"));if(d.equals(g))return m.latitude=d.latitude,m.longitude=d.longitude,m;a=e.clamp(a,0,1);var p=this.linearAzimuth(d,g);g=this.linearDistance(d,g);return this.linearLocation(d,p,a*g,m)};g.linearAzimuth=function(a,d){if(!a||!d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","linearAzimuth","missingLocation"));var g=a.latitude*f.DEGREES_TO_RADIANS,m=d.latitude*f.DEGREES_TO_RADIANS,p=a.longitude*f.DEGREES_TO_RADIANS,
    q=d.longitude*f.DEGREES_TO_RADIANS;if(g==m&&p==q)return 0;p=q-p;g=m-g;e.fabs(p)>Math.PI&&(p=0<p?-(2*Math.PI-p):2*Math.PI+p);g=Math.atan2(p,g);return isNaN(g)?0:g*f.RADIANS_TO_DEGREES};g.linearDistance=function(a,d){if(!a||!d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","linearDistance","missingLocation"));var g=a.latitude*f.DEGREES_TO_RADIANS,m=d.latitude*f.DEGREES_TO_RADIANS,p=a.longitude*f.DEGREES_TO_RADIANS,q=d.longitude*f.DEGREES_TO_RADIANS;if(g==m&&p==q)return 0;g=m-g;p=q-p;e.fabs(p)>Math.PI&&
(p=0<p?-(2*Math.PI-p):2*Math.PI+p);p=Math.sqrt(g*g+p*p);return isNaN(p)?0:p};g.linearLocation=function(a,d,g,m){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","linearLocation","missingLocation"));if(!m)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","linearLocation","missingResult"));if(0==g)return m.latitude=a.latitude,m.longitude=a.longitude,m;var p=a.longitude*f.DEGREES_TO_RADIANS,q=d*f.DEGREES_TO_RADIANS;d=a.latitude*f.DEGREES_TO_RADIANS+g*Math.cos(q);e.fabs(d)>Math.PI/2&&(d=0<d?
Math.PI-d:-Math.PI-d);g=e.fmod(p+g*Math.sin(q)+Math.PI,2*Math.PI)-Math.PI;isNaN(d)||isNaN(g)?(m.latitude=a.latitude,m.longitude=a.longitude):(m.latitude=f.normalizedDegreesLatitude(d*f.RADIANS_TO_DEGREES),m.longitude=f.normalizedDegreesLongitude(g*f.RADIANS_TO_DEGREES));return m};g.locationsCrossDateLine=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","locationsCrossDateline","missingLocation"));for(var d=null,g=0,m=a.length;g<m;g+=1){var p=a[g];if(null!=d&&e.signum(d.longitude)!=
    e.signum(p.longitude)&&(d=Math.abs(d.longitude-p.longitude),180<d&&360>d))return!0;d=p}return!1};g.greatCircleArcExtremeLocations=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","greatCircleArcExtremeLocations","missingLocation"));for(var d=null,e=null,m=null,p=0,q=a.length;p<q;p+=1){var f=a[p];if(null!=m){var r=g.greatCircleArcExtremeForTwoLocations(m,f);if(null==r)continue;if(null==d||d.latitude>r[0].latitude)d=r[0];if(null==e||e.latitude<r[1].latitude)e=r[1]}m=f}return[d,e]};
    g.greatCircleArcExtremeForTwoLocations=function(a,d){if(!a||!d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","greatCircleArcExtremeForTwoLocations","missingLocation"));var l,m,p,q=null,f=null,r=90,u=-90,w=[a,d];l=0;for(m=w.length;l<m;l+=1)p=w[l],r>=p.latitude&&(r=p.latitude,q=p),u<=p.latitude&&(u=p.latitude,f=p);var w=g.greatCircleAzimuth(a,d),x=g.greatCircleDistance(a,d),A=g.greatCircleExtremeLocationsUsingAzimuth(a,w);l=0;for(m=A.length;l<m;l+=1){p=A[l];var B=g.greatCircleAzimuth(a,p),v=g.greatCircleDistance(a,
        p);e.signum(B)==e.signum(w)&&0<=v&&v<=x&&(r>=p.latitude&&(r=p.latitude,q=p),u<=p.latitude&&(u=p.latitude,f=p))}return[q,f]};g.greatCircleExtremeLocationsUsingAzimuth=function(a,d){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Location","greatCircleArcExtremeLocationsUsingAzimuth","missingLocation"));var e=Math.atan(-Math.tan(a.latitude)/Math.cos(d*f.DEGREES_TO_RADIANS)),m=e-Math.PI/2;return[g.greatCircleLocation(a,d,e+Math.PI/2,new g(0,0)),g.greatCircleLocation(a,d,m,new g(0,0))]};g.intersectionWithMeridian=
        function(b,e,c,g){b=g.computePointFromLocation(b.latitude,b.longitude,new d(0,0,0));e=g.computePointFromLocation(e.latitude,e.longitude,new d(0,0,0));var p=g.computePointFromLocation(90,c,new d(0,0,0));c=g.computePointFromLocation(0,c,new d(0,0,0));p=a.fromPoints(p,c,d.ZERO);c=new d(0,0,0);if(!p.intersectsSegmentAt(b,e,c))return null;b=new WorldWind.Position(0,0,0);g.computePositionFromPoint(c[0],c[1],c[2],b);return b.latitude};g.poles={NONE:0,NORTH:1,SOUTH:2};return g});
define("src/geom/Position",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../util/WWMath"],function(f,b,c,a,d){var e=function(a,d,b){this.latitude=a;this.longitude=d;this.altitude=b};e.ZERO=new e(0,0,0);e.fromRadians=function(a,d,b){return new e(a*f.RADIANS_TO_DEGREES,d*f.RADIANS_TO_DEGREES,b)};e.prototype.copy=function(d){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"Position","copy","missingPosition"));this.latitude=d.latitude;this.longitude=d.longitude;this.altitude=
    d.altitude;return this};e.prototype.equals=function(a){return a&&a.latitude===this.latitude&&a.longitude===this.longitude&&a.altitude===this.altitude};e.interpolateGreatCircle=function(e,h,k,l){if(!h||!k)throw new b(a.logMessage(a.LEVEL_SEVERE,"Position","interpolateGreatCircle","missingPosition"));if(!l)throw new b(a.logMessage(a.LEVEL_SEVERE,"Position","interpolateGreatCircle","missingResult"));e=d.clamp(e,0,1);l.altitude=d.interpolate(e,h.altitude,k.altitude);c.interpolateGreatCircle(e,h,k,l);
    return l};e.interpolateRhumb=function(e,h,k,l){if(!h||!k)throw new b(a.logMessage(a.LEVEL_SEVERE,"Position","interpolateRhumb","missingPosition"));if(!l)throw new b(a.logMessage(a.LEVEL_SEVERE,"Position","interpolateRhumb","missingResult"));e=d.clamp(e,0,1);l.altitude=d.interpolate(e,h.altitude,k.altitude);c.interpolateRhumb(e,h,k,l);return l};e.interpolateLinear=function(e,h,k,l){if(!h||!k)throw new b(a.logMessage(a.LEVEL_SEVERE,"Position","interpolateLinear","missingPosition"));if(!l)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "Position","interpolateLinear","missingResult"));e=d.clamp(e,0,1);l.altitude=d.interpolate(e,h.altitude,k.altitude);c.interpolateLinear(e,h,k,l);return l};e.prototype.toString=function(){return"("+this.latitude.toString()+"\u00b0, "+this.longitude.toString()+"\u00b0, "+this.altitude.toString()};return e});
define("src/render/Texture",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(f,b,c){var a=function(a,e,g){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"Texture","constructor","missingGlContext"));if(!e)throw new f(b.logMessage(b.LEVEL_SEVERE,"Texture","constructor","missingImage"));g||(g=a.CLAMP_TO_EDGE);var h=a.createTexture(),k=c.isPowerOfTwo(e.width)&&c.isPowerOfTwo(e.height);this.originalImageWidth=e.width;this.originalImageHeight=e.height;g!==a.REPEAT||k||(e=this.resizeImage(e),
    k=!0);this.imageWidth=e.width;this.imageHeight=e.height;this.size=e.width*e.height*4;a.bindTexture(a.TEXTURE_2D,h);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,k?a.LINEAR_MIPMAP_LINEAR:a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,g);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,g);(g=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))&&a.texParameteri(a.TEXTURE_2D,g.TEXTURE_MAX_ANISOTROPY_EXT,
    4);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,e);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0);k&&a.generateMipmap(a.TEXTURE_2D);this.textureId=h;this.creationTime=new Date};a.prototype.dispose=function(a){a.deleteTexture(this.textureId);delete this.textureId};a.prototype.bind=function(a){a.currentGlContext.bindTexture(a.currentGlContext.TEXTURE_2D,this.textureId);a.frameStatistics.incrementTextureLoadCount(1);return!0};a.prototype.resizeImage=
    function(a){var b=document.createElement("canvas");b.width=c.powerOfTwoFloor(a.width);b.height=c.powerOfTwoFloor(a.height);b.getContext("2d").drawImage(a,0,0,b.width,b.height);return b};return a});
define("src/geom/Matrix","../geom/Angle ../error/ArgumentError ../util/Logger ../geom/Plane ../geom/Position ../geom/Rectangle ../render/Texture ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k){var l=function(a,d,b,e,c,g,h,l,k,f,v,F,G,D,y,H){this[0]=a;this[1]=d;this[2]=b;this[3]=e;this[4]=c;this[5]=g;this[6]=h;this[7]=l;this[8]=k;this[9]=f;this[10]=v;this[11]=F;this[12]=G;this[13]=D;this[14]=y;this[15]=H};l.prototype=new Float64Array(16);l.fromIdentity=function(){return new l(1,
    0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)};l.principalAxesFromPoints=function(a,d,e,g){if(!a||1>a.length)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","principalAxesFromPoints","missingPoints"));if(!d||!e||!g)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","principalAxesFromPoints","An axis argument is null or undefined."));var h=l.fromIdentity();h.setToCovarianceOfPoints(a);h.eigensystemFromSymmetricMatrix(d,e,g);d.normalize();e.normalize();g.normalize()};l.prototype.set=function(a,d,b,e,c,g,h,l,k,f,v,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   F,G,D,y,H){this[0]=a;this[1]=d;this[2]=b;this[3]=e;this[4]=c;this[5]=g;this[6]=h;this[7]=l;this[8]=k;this[9]=f;this[10]=v;this[11]=F;this[12]=G;this[13]=D;this[14]=y;this[15]=H;return this};l.prototype.setToIdentity=function(){this[0]=1;this[1]=0;this[2]=0;this[3]=0;this[4]=0;this[5]=1;this[6]=0;this[7]=0;this[8]=0;this[9]=0;this[10]=1;this[11]=0;this[12]=0;this[13]=0;this[14]=0;this[15]=1};l.prototype.copy=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","copy","missingMatrix"));
    this[0]=a[0];this[1]=a[1];this[2]=a[2];this[3]=a[3];this[4]=a[4];this[5]=a[5];this[6]=a[6];this[7]=a[7];this[8]=a[8];this[9]=a[9];this[10]=a[10];this[11]=a[11];this[12]=a[12];this[13]=a[13];this[14]=a[14];this[15]=a[15]};l.prototype.equals=function(a){return a&&this[0]==a[0]&&this[1]==a[1]&&this[2]==a[2]&&this[3]==a[3]&&this[4]==a[4]&&this[5]==a[5]&&this[6]==a[6]&&this[7]==a[7]&&this[8]==a[8]&&this[9]==a[9]&&this[10]==a[10]&&this[11]==a[11]&&this[12]==a[12]&&this[13]==a[13]&&this[14]==a[14]&&this[15]==
    a[15]};l.prototype.columnMajorComponents=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","columnMajorComponents","missingResult"));a[0]=this[0];a[1]=this[4];a[2]=this[8];a[3]=this[12];a[4]=this[1];a[5]=this[5];a[6]=this[9];a[7]=this[13];a[8]=this[2];a[9]=this[6];a[10]=this[10];a[11]=this[14];a[12]=this[3];a[13]=this[7];a[14]=this[11];a[15]=this[15];return a};l.prototype.setToTranslation=function(a,d,b){this[0]=1;this[1]=0;this[2]=0;this[3]=a;this[4]=0;this[5]=1;this[6]=0;this[7]=
    d;this[8]=0;this[9]=0;this[10]=1;this[11]=b;this[12]=0;this[13]=0;this[14]=0;this[15]=1;return this};l.prototype.setTranslation=function(a,d,b){this[3]=a;this[7]=d;this[11]=b;return this};l.prototype.setToScale=function(a,d,b){this[0]=a;this[1]=0;this[2]=0;this[3]=0;this[4]=0;this[5]=d;this[6]=0;this[7]=0;this[8]=0;this[9]=0;this[10]=b;this[11]=0;this[12]=0;this[13]=0;this[14]=0;this[15]=1;return this};l.prototype.setScale=function(a,d,b){this[0]=a;this[5]=d;this[10]=b;return this};l.prototype.setToTransposeOfMatrix=
    function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","setToTransposeOfMatrix","missingMatrix"));this[0]=a[0];this[1]=a[4];this[2]=a[8];this[3]=a[12];this[4]=a[1];this[5]=a[5];this[6]=a[9];this[7]=a[13];this[8]=a[2];this[9]=a[6];this[10]=a[10];this[11]=a[14];this[12]=a[3];this[13]=a[7];this[14]=a[11];this[15]=a[15];return this};l.prototype.setToMultiply=function(a,d){if(!a||!d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","setToMultiply","missingMatrix"));this[0]=a[0]*d[0]+a[1]*d[4]+
    a[2]*d[8]+a[3]*d[12];this[1]=a[0]*d[1]+a[1]*d[5]+a[2]*d[9]+a[3]*d[13];this[2]=a[0]*d[2]+a[1]*d[6]+a[2]*d[10]+a[3]*d[14];this[3]=a[0]*d[3]+a[1]*d[7]+a[2]*d[11]+a[3]*d[15];this[4]=a[4]*d[0]+a[5]*d[4]+a[6]*d[8]+a[7]*d[12];this[5]=a[4]*d[1]+a[5]*d[5]+a[6]*d[9]+a[7]*d[13];this[6]=a[4]*d[2]+a[5]*d[6]+a[6]*d[10]+a[7]*d[14];this[7]=a[4]*d[3]+a[5]*d[7]+a[6]*d[11]+a[7]*d[15];this[8]=a[8]*d[0]+a[9]*d[4]+a[10]*d[8]+a[11]*d[12];this[9]=a[8]*d[1]+a[9]*d[5]+a[10]*d[9]+a[11]*d[13];this[10]=a[8]*d[2]+a[9]*d[6]+a[10]*
    d[10]+a[11]*d[14];this[11]=a[8]*d[3]+a[9]*d[7]+a[10]*d[11]+a[11]*d[15];this[12]=a[12]*d[0]+a[13]*d[4]+a[14]*d[8]+a[15]*d[12];this[13]=a[12]*d[1]+a[13]*d[5]+a[14]*d[9]+a[15]*d[13];this[14]=a[12]*d[2]+a[13]*d[6]+a[14]*d[10]+a[15]*d[14];this[15]=a[12]*d[3]+a[13]*d[7]+a[14]*d[11]+a[15]*d[15];return this};l.prototype.setToCovarianceOfPoints=function(a){if(!a||1>a.length)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","setToCovarianceOfPoints","missingArray"));var d,e,g,l,k=0,f=0,x=0,A=0,B=0,v=0,F=0,G=
    new h(0,0,0);d=h.averageOfBuffer(a,new h(0,0,0));for(var D=0,y=a.length/3;D<y;D++)G[0]=a[3*D],G[1]=a[3*D+1],G[2]=a[3*D+2],e=G[0]-d[0],g=G[1]-d[1],l=G[2]-d[2],++k,f+=e*e,x+=g*g,A+=l*l,B+=e*g,v+=e*l,F+=g*l;this[0]=f/k;this[1]=B/k;this[2]=v/k;this[3]=0;this[4]=B/k;this[5]=x/k;this[6]=F/k;this[7]=0;this[8]=v/k;this[9]=F/k;this[10]=A/k;this[11]=0;this[12]=0;this[13]=0;this[14]=0;this[15]=0;return this};l.prototype.multiplyByTranslation=function(a,d,b){this.multiply(1,0,0,a,0,1,0,d,0,0,1,b,0,0,0,1);return this};
    l.prototype.multiplyByRotation=function(a,d,b,e){var c=Math.cos(e*f.DEGREES_TO_RADIANS);e=Math.sin(e*f.DEGREES_TO_RADIANS);this.multiply(c+(1-c)*a*a,(1-c)*a*d-e*b,(1-c)*a*b+e*d,0,(1-c)*a*d+e*b,c+(1-c)*d*d,(1-c)*d*b-e*a,0,(1-c)*a*b-e*d,(1-c)*d*b+e*a,c+(1-c)*b*b,0,0,0,0,1);return this};l.prototype.multiplyByScale=function(a,d,b){this.multiply(a,0,0,0,0,d,0,0,0,0,b,0,0,0,0,1);return this};l.prototype.setToUnitYFlip=function(){this[0]=1;this[1]=0;this[2]=0;this[3]=0;this[4]=0;this[5]=-1;this[6]=0;this[7]=
        1;this[8]=0;this[9]=0;this[10]=1;this[11]=0;this[12]=0;this[13]=0;this[14]=0;this[15]=1;return this};l.prototype.multiplyByLocalCoordinateTransform=function(a,d){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","multiplyByLocalCoordinateTransform","Origin vector is null or undefined"));if(!d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","multiplyByLocalCoordinateTransform","missingGlobe"));var e=new h(0,0,0),g=new h(0,0,0),l=new h(0,0,0);k.localCoordinateAxesAtPoint(a,d,e,g,l);this.multiply(e[0],
        g[0],l[0],a[0],e[1],g[1],l[1],a[1],e[2],g[2],l[2],a[2],0,0,0,1);return this};l.prototype.multiplyByTextureTransform=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","multiplyByTextureTransform","missingTexture"));var d=a.originalImageHeight/a.imageHeight;this.multiply(a.originalImageWidth/a.imageWidth,0,0,0,0,-d,0,d,0,0,1,0,0,0,0,1);return this};l.prototype.extractTranslation=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","extractTranslation","missingResult"));
        a[0]=this[3];a[1]=this[7];a[2]=this[11];return a};l.prototype.extractRotationAngles=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","extractRotationAngles","missingResult"));var d=Math.atan2(this[6],this[10]),e=Math.atan2(-this[2],Math.sqrt(this[0]*this[0]+this[1]*this[1])),g=Math.cos(d),h=Math.sin(d),g=Math.atan2(h*this[8]-g*this[4],g*this[5]-h*this[9]);a[0]=d*f.RADIANS_TO_DEGREES;a[1]=e*f.RADIANS_TO_DEGREES;a[2]=g*f.RADIANS_TO_DEGREES;return a};l.prototype.multiplyByFirstPersonModelview=
        function(a,d,e,g,l){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","multiplyByFirstPersonModelview","missingPosition"));if(!l)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","multiplyByFirstPersonModelview","missingGlobe"));var u,w,x,A,B,v,F;w=new h(0,0,0);x=new h(0,0,0);A=new h(0,0,0);F=new h(0,0,0);u=Math.cos(g*f.DEGREES_TO_RADIANS);g=Math.sin(g*f.DEGREES_TO_RADIANS);this.multiply(u,g,0,0,-g,u,0,0,0,0,1,0,0,0,0,1);u=Math.cos(e*f.DEGREES_TO_RADIANS);g=Math.sin(e*f.DEGREES_TO_RADIANS);this.multiply(1,
            0,0,0,0,u,g,0,0,-g,u,0,0,0,0,1);u=Math.cos(d*f.DEGREES_TO_RADIANS);g=Math.sin(d*f.DEGREES_TO_RADIANS);this.multiply(u,-g,0,0,g,u,0,0,0,0,1,0,0,0,0,1);l.computePointFromPosition(a.latitude,a.longitude,a.altitude,w);a=w[0];d=w[1];e=w[2];k.localCoordinateAxesAtPoint(w,l,x,A,F);l=x[0];w=x[1];x=x[2];u=A[0];g=A[1];A=A[2];B=F[0];v=F[1];F=F[2];this.multiply(l,w,x,-l*a-w*d-x*e,u,g,A,-u*a-g*d-A*e,B,v,F,-B*a-v*d-F*e,0,0,0,1);return this};l.prototype.multiplyByLookAtModelview=function(a,d,e,g,h,l){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,
        "Matrix","multiplyByLookAtModelview","missingPosition"));if(0>d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","Range is less than zero"));if(!l)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","missingGlobe"));this.multiplyByTranslation(0,0,-d);this.multiplyByFirstPersonModelview(a,e,g,h,l);return this};l.prototype.setToPerspectiveProjection=function(a,d,e,g){if(0>=a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection",
        "invalidWidth"));if(0>=d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","invalidHeight"));if(e===g)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","Near and far distance are the same."));if(0>=e||0>=g)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","Near or far distance is less than or equal to zero."));var h=k.perspectiveFrustumRectangle(a,d,e);a=h.getMinX();d=h.getMaxX();var l=h.getMinY(),h=h.getMaxY();this[0]=
        2*e/(d-a);this[1]=0;this[2]=(d+a)/(d-a);this[3]=0;this[4]=0;this[5]=2*e/(h-l);this[6]=(h+l)/(h-l);this[7]=0;this[8]=0;this[9]=0;this[10]=-(g+e)/(g-e);this[11]=-2*e*g/(g-e);this[12]=0;this[13]=0;this[14]=-1;this[15]=0;return this};l.prototype.setToScreenProjection=function(a,d){if(0>=a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","setToScreenProjection","invalidWidth"));if(0>=d)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","setToScreenProjection","invalidHeight"));this[0]=2/a;this[1]=0;this[2]=
        0;this[3]=-1;this[4]=0;this[5]=2/d;this[6]=0;this[7]=-1;this[8]=0;this[9]=0;this[10]=2;this[11]=-1;this[12]=0;this[13]=0;this[14]=0;this[15]=1;return this};l.prototype.extractEyePoint=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","extractEyePoint","missingResult"));a[0]=-(this[0]*this[3])-this[4]*this[7]-this[8]*this[11];a[1]=-(this[1]*this[3])-this[5]*this[7]-this[9]*this[11];a[2]=-(this[2]*this[3])-this[6]*this[7]-this[10]*this[11];return a};l.prototype.extractForwardVector=
        function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","extractForwardVector","missingResult"));a[0]=-this[8];a[1]=-this[9];a[2]=-this[10];return a};l.prototype.extractViewingParameters=function(a,e,g,h){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","extractViewingParameters","The specified origin is null or undefined."));if(!g)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","extractViewingParameters","missingGlobe"));if(!h)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","extractViewingParameters",
        "missingResult"));var k=new d(0,0,0),u=l.fromIdentity(),w,x;g.computePositionFromPoint(a[0],a[1],a[2],k);u.copy(this);u.multiplyByLocalCoordinateTransform(a,g);a=-u[11];g=Math.atan2(Math.sqrt(u[2]*u[2]+u[6]*u[6]),u[10])*f.RADIANS_TO_DEGREES;w=Math.cos(e*f.DEGREES_TO_RADIANS);x=Math.sin(e*f.DEGREES_TO_RADIANS);u=Math.atan2(x*u[5]-w*u[1],w*u[0]-x*u[4])*f.RADIANS_TO_DEGREES;h.origin=k;h.range=a;h.heading=u;h.tilt=g;h.roll=e;return h};l.prototype.offsetProjectionDepth=function(a){this[10]*=1+a;return this};
    l.prototype.multiplyMatrix=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","multiplyMatrix","missingMatrix"));var d,e,g,h;d=this[0];e=this[1];g=this[2];h=this[3];this[0]=d*a[0]+e*a[4]+g*a[8]+h*a[12];this[1]=d*a[1]+e*a[5]+g*a[9]+h*a[13];this[2]=d*a[2]+e*a[6]+g*a[10]+h*a[14];this[3]=d*a[3]+e*a[7]+g*a[11]+h*a[15];d=this[4];e=this[5];g=this[6];h=this[7];this[4]=d*a[0]+e*a[4]+g*a[8]+h*a[12];this[5]=d*a[1]+e*a[5]+g*a[9]+h*a[13];this[6]=d*a[2]+e*a[6]+g*a[10]+h*a[14];this[7]=d*a[3]+e*a[7]+
        g*a[11]+h*a[15];d=this[8];e=this[9];g=this[10];h=this[11];this[8]=d*a[0]+e*a[4]+g*a[8]+h*a[12];this[9]=d*a[1]+e*a[5]+g*a[9]+h*a[13];this[10]=d*a[2]+e*a[6]+g*a[10]+h*a[14];this[11]=d*a[3]+e*a[7]+g*a[11]+h*a[15];d=this[12];e=this[13];g=this[14];h=this[15];this[12]=d*a[0]+e*a[4]+g*a[8]+h*a[12];this[13]=d*a[1]+e*a[5]+g*a[9]+h*a[13];this[14]=d*a[2]+e*a[6]+g*a[10]+h*a[14];this[15]=d*a[3]+e*a[7]+g*a[11]+h*a[15];return this};l.prototype.multiply=function(a,d,b,e,c,g,h,l,k,f,v,F,G,D,y,H){var C,z,E,L;C=this[0];
        z=this[1];E=this[2];L=this[3];this[0]=C*a+z*c+E*k+L*G;this[1]=C*d+z*g+E*f+L*D;this[2]=C*b+z*h+E*v+L*y;this[3]=C*e+z*l+E*F+L*H;C=this[4];z=this[5];E=this[6];L=this[7];this[4]=C*a+z*c+E*k+L*G;this[5]=C*d+z*g+E*f+L*D;this[6]=C*b+z*h+E*v+L*y;this[7]=C*e+z*l+E*F+L*H;C=this[8];z=this[9];E=this[10];L=this[11];this[8]=C*a+z*c+E*k+L*G;this[9]=C*d+z*g+E*f+L*D;this[10]=C*b+z*h+E*v+L*y;this[11]=C*e+z*l+E*F+L*H;C=this[12];z=this[13];E=this[14];L=this[15];this[12]=C*a+z*c+E*k+L*G;this[13]=C*d+z*g+E*f+L*D;this[14]=
            C*b+z*h+E*v+L*y;this[15]=C*e+z*l+E*F+L*H;return this};l.prototype.invertMatrix=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","invertMatrix","missingMatrix"));var d=[[],[],[],[]];d[0][0]=a[0];d[0][1]=a[1];d[0][2]=a[2];d[0][3]=a[3];d[1][0]=a[4];d[1][1]=a[5];d[1][2]=a[6];d[1][3]=a[7];d[2][0]=a[8];d[2][1]=a[9];d[2][2]=a[10];d[2][3]=a[11];d[3][0]=a[12];d[3][1]=a[13];d[3][2]=a[14];d[3][3]=a[15];a=[];var e=l.ludcmp(d,a),g;for(g=0;4>g;g+=1)e*=d[g][g];if(1E-8>Math.abs(e))return null;for(var h=
        [[],[],[],[]],k=[],e=0;4>e;e+=1){for(g=0;4>g;g+=1)k[g]=0;k[e]=1;l.lubksb(d,a,k);for(g=0;4>g;g+=1)h[g][e]=k[g]}this[0]=h[0][0];this[1]=h[0][1];this[2]=h[0][2];this[3]=h[0][3];this[4]=h[1][0];this[5]=h[1][1];this[6]=h[1][2];this[7]=h[1][3];this[8]=h[2][0];this[9]=h[2][1];this[10]=h[2][2];this[11]=h[2][3];this[12]=h[3][0];this[13]=h[3][1];this[14]=h[3][2];this[15]=h[3][3];return this};l.lubksb=function(a,d,b){var e=-1,c,g,h;for(c=0;4>c;c+=1){g=d[c];h=b[g];b[g]=b[c];if(-1!=e)for(g=e;g<=c-1;g+=1)h-=a[c][g]*
        b[g];else 0!=h&&(e=c);b[c]=h}for(c=3;0<=c;--c){h=b[c];for(g=c+1;4>g;g+=1)h-=a[c][g]*b[g];b[c]=h/a[c][c]}};l.ludcmp=function(a,d){var b=[],e=1,c,g,h,l,k,f;for(g=0;4>g;g+=1){for(h=l=0;4>h;h+=1)(c=Math.abs(a[g][h]))>l&&(l=c);if(0==l)return 0;b[g]=1/l}for(h=0;4>h;h+=1){for(g=0;g<h;g+=1){k=a[g][h];for(c=0;c<g;c+=1)k-=a[g][c]*a[c][h];a[g][h]=k}l=0;f=-1;for(g=h;4>g;g+=1){k=a[g][h];for(c=0;c<h;c++)k-=a[g][c]*a[c][h];a[g][h]=k;(k=b[g]*Math.abs(k))>=l&&(l=k,f=g)}if(h!=f){for(c=0;4>c;c+=1)k=a[f][c],a[f][c]=
        a[h][c],a[h][c]=k;e=-e;b[f]=b[h]}d[h]=f;0==a[h][h]&&(a[h][h]=1E-20);if(3!=h)for(k=1/a[h][h],g=h+1;4>g;g+=1)a[g][h]*=k}return e};l.prototype.invertOrthonormalMatrix=function(a){if(!a)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","invertOrthonormalMatrix","missingMatrix"));this[0]=a[0];this[1]=a[4];this[2]=a[8];this[3]=0-a[0]*a[3]-a[4]*a[7]-a[8]*a[11];this[4]=a[1];this[5]=a[5];this[6]=a[9];this[7]=0-a[1]*a[3]-a[5]*a[7]-a[9]*a[11];this[8]=a[2];this[9]=a[6];this[10]=a[10];this[11]=0-a[2]*a[3]-a[6]*
        a[7]-a[10]*a[11];this[12]=0;this[13]=0;this[14]=0;this[15]=1;return this};l.prototype.eigensystemFromSymmetricMatrix=function(a,d,e){if(!a||!d||!e)throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","eigensystemFromSymmetricMatrix","missingResult"));if(this[1]!=this[4]||this[2]!=this[8]||this[6]!=this[9])throw new b(c.logMessage(c.LEVEL_SEVERE,"Matrix","eigensystemFromSymmetricMatrix","Matrix is not symmetric"));for(var g=this[0],h=this[1],l=this[2],f=this[5],x=this[6],A=this[10],B=[[1,0,0],[0,1,0],
        [0,0,1]],v,F,G,D,y=0;32>y&&!(1E-10>k.fabs(h)&&1E-10>k.fabs(l)&&1E-10>k.fabs(x));y++){if(0!=h)for(v=.5*(f-g)/h,F=v*v,G=F+1,v=G!=F?(0>v?-1:1)*(Math.sqrt(G)-k.fabs(v)):.5/v,F=1/Math.sqrt(v*v+1),G=F*v,g-=v*h,f+=v*h,h=0,v=F*l-G*x,x=G*l+F*x,l=v,D=0;3>D;D++)v=F*B[D][0]-G*B[D][1],B[D][1]=G*B[D][0]+F*B[D][1],B[D][0]=v;if(0!=l)for(v=.5*(A-g)/l,F=v*v,G=F+1,v=G!=F?(0>v?-1:1)*(Math.sqrt(G)-k.fabs(v)):.5/v,F=1/Math.sqrt(v*v+1),G=F*v,g-=v*l,A+=v*l,l=0,v=F*h-G*x,x=G*h+F*x,h=v,D=0;3>D;D++)v=F*B[D][0]-G*B[D][2],B[D][2]=
        G*B[D][0]+F*B[D][2],B[D][0]=v;if(0!=x)for(v=.5*(A-f)/x,F=v*v,G=F+1,v=G!=F?(0>v?-1:1)*(Math.sqrt(G)-k.fabs(v)):.5/v,F=1/Math.sqrt(v*v+1),G=F*v,f-=v*x,A+=v*x,x=0,v=F*h-G*l,l=G*h+F*l,h=v,D=0;3>D;D++)v=F*B[D][1]-G*B[D][2],B[D][2]=G*B[D][1]+F*B[D][2],B[D][1]=v}h=0;l=1;x=2;g<f&&(v=g,g=f,f=v,v=h,h=l,l=v);f<A&&(v=f,f=A,A=v,v=l,l=x,x=v);g<f&&(v=g,g=f,f=v,v=h,h=l,l=v);a[0]=B[0][h];a[1]=B[1][h];a[2]=B[2][h];d[0]=B[0][l];d[1]=B[1][l];d[2]=B[2][l];e[0]=B[0][x];e[1]=B[1][x];e[2]=B[2][x];a.normalize();d.normalize();
        e.normalize();a.multiply(g);d.multiply(f);e.multiply(A)};l.prototype.upper3By3=function(){var a=l.fromIdentity();a[0]=this[0];a[1]=this[1];a[2]=this[2];a[4]=this[4];a[5]=this[5];a[6]=this[6];a[8]=this[8];a[9]=this[9];a[10]=this[10];return a};return l});define("src/pick/PickedObject",[],function(){return function(f,b,c,a,d){this.color=f;this.userObject=b;this.position=c;this.parentLayer=a;this.isTerrain=d;this.isOnTop=!1}});
define("src/error/UnsupportedOperationError",["../error/AbstractError"],function(f){var b=function(b){f.call(this,"UnsupportedOperationError",b);try{throw Error();}catch(a){b=a.stack}this.stack=b};b.prototype=Object.create(f.prototype);return b});
define("src/render/Renderable",["../util/Logger","../error/UnsupportedOperationError"],function(f,b){var c=function(){this.displayName="Renderable";this.enabled=!0;this.pickDelegate=null};c.prototype.render=function(a){throw new b(f.logMessage(f.LEVEL_SEVERE,"Renderable","render","abstractInvocation"));};return c});
define("src/shapes/Annotation","../shapes/AnnotationAttributes ../error/ArgumentError ../shaders/BasicTextureProgram ../util/Color ../util/Font ../util/Insets ../util/Logger ../geom/Matrix ../util/Offset ../pick/PickedObject ../render/Renderable ../shapes/TextAttributes ../geom/Vec2 ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t,r){var u=function(a,d){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Annotation","constructor","missingPosition"));m.call(this);this.position=
    a;this.attributes=d?d:new f(null);this.altitudeMode=WorldWind.ABSOLUTE;this.lastStateKey=this.layer=null;this.calloutTransform=h.fromIdentity();this.calloutOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0);this.label="";this.labelTexture=null;this.labelTransform=h.fromIdentity();this.placePoint=new t(0,0,0);this.depthOffset=-2.05;this.calloutPoints=null};u.matrix=h.fromIdentity();u.screenPoint=new t(0,0,0);u.scratchPoint=new t(0,0,0);u.prototype=Object.create(m.prototype);
    Object.defineProperties(u.prototype,{text:{get:function(){return this.label},set:function(a){this.label=a;this.lastStateKey=null}}});u.prototype.renderOrdered=function(a){this.drawOrderedAnnotation(a);if(a.pickingMode){var d=new l(this.pickColor.clone(),this,this.position,this.layer,!1);a.pickPoint&&this.labelBounds.containsPoint(a.navigatorState.convertPointToViewport(a.pickPoint,u.scratchPoint))&&(d.labelPicked=!0);a.resolvePick(d)}};u.prototype.clone=function(){var a=new u(this.position);a.copy(this);
        a.pickDelegate=this.pickDelegate?this.pickDelegate:this;return a};u.prototype.copy=function(a){this.position=a.position;this.enabled=a.enabled;this.attributes=a.attributes;this.label=a.label;this.altitudeMode=a.altitudeMode;this.pickDelegate=a.pickDelegate;this.depthOffset=a.depthOffset;return this};u.prototype.render=function(a){if(this.enabled&&a.accumulateOrderedRenderables&&(!a.globe.projectionLimits||a.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude))){var d;
        if(d=this.lastFrameTime!==a.timestamp?this.makeOrderedRenderable(a):this.clone().makeOrderedRenderable(a))d.layer=a.currentLayer,this.lastFrameTime=a.timestamp,a.addOrderedRenderable(d)}};u.prototype.drawOrderedAnnotation=function(a){this.beginDrawing(a);try{this.doDrawOrderedAnnotation(a)}finally{this.endDrawing(a)}};u.prototype.makeOrderedRenderable=function(a){var d,b,e,c,g,h,l,k;this.label=a.textSupport.wrap(this.label,this.attributes.width,this.attributes.height,this.attributes.textAttributes.font);
        a.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint);this.eyeDistance=a.navigatorState.eyePoint.distanceTo(this.placePoint);if(!a.navigatorState.projectWithDepth(this.placePoint,this.depthOffset,u.screenPoint))return null;b=this.attributes.textAttributes.font;g=this.label+b.toString();this.labelTexture=a.gpuResourceCache.resourceForKey(g);this.labelTexture||(this.labelTexture=a.textSupport.createTexture(a,this.label,b,!1),a.gpuResourceCache.putResource(g,
            this.labelTexture,this.labelTexture.size));d=this.labelTexture.imageWidth;a=this.labelTexture.imageHeight;b=this.attributes.scale;e=this.attributes.insets.left;c=this.attributes.insets.right;g=this.attributes.insets.top;h=this.attributes.insets.bottom;k=this.attributes.leaderGapHeight;l=this.calloutOffset.offsetForSize((d+e+c)*b,(a+g+h)*b);this.calloutTransform.setTranslation(u.screenPoint[0]-l[0],u.screenPoint[1]+k,u.screenPoint[2]);this.labelTransform.setTranslation(u.screenPoint[0]-l[0]+e*b,u.screenPoint[1]+
            k+h*b,u.screenPoint[2]);this.labelTransform.setScale(d*b,a*b,1);this.labelBounds=r.boundingRectForUnitQuad(this.labelTransform);d=(d+e+c)*b;k=-k;this.attributes.drawLeader||(k=0);this.attributes.stateKey!=this.lastStateKey&&(this.calloutPoints=this.createCallout(d,(a+g+h)*b,d/2,k,this.attributes.leaderGapWidth,this.attributes.cornerRadius));return this};u.prototype.beginDrawing=function(a){var d=a.currentGlContext,b;a.findAndBindProgram(c);b=a.currentProgram;d.enableVertexAttribArray(b.vertexPointLocation);
        d.enableVertexAttribArray(b.vertexTexCoordLocation);b.loadModulateColor(d,a.pickingMode)};u.prototype.endDrawing=function(a){var d=a.currentGlContext,b=a.currentProgram;d.disableVertexAttribArray(b.vertexPointLocation);d.disableVertexAttribArray(b.vertexTexCoordLocation);a.bindProgram(null)};u.prototype.drawCorner=function(a,d,b,e,g,c,h,l){if(1>b)return l;g=(g-e)/(c-1);for(var k=1;k<c-1;k++){var q=e+g*k,m=a+Math.cos(q)*b,q=d+Math.sin(q)*b;h[l++]=m;h[l++]=q}return l};u.prototype.createCallout=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  d,b,e,g,c){var h=new Float32Array(2*(12+(1>c?0:56))),l=0;h[l++]=a/2+g/2;h[l++]=0;h[l++]=a-c;h[l++]=0;l=this.drawCorner(a-c,c,c,-Math.PI/2,0,16,h,l);h[l++]=a;h[l++]=c;h[l++]=a;h[l++]=d-c;l=this.drawCorner(a-c,d-c,c,0,Math.PI/2,16,h,l);h[l++]=a-c;h[l++]=d;h[l++]=c;h[l++]=d;l=this.drawCorner(c,d-c,c,Math.PI/2,Math.PI,16,h,l);h[l++]=0;h[l++]=d-c;h[l++]=0;h[l++]=c;l=this.drawCorner(c,c,c,Math.PI,1.5*Math.PI,16,h,l);h[l++]=c;h[l++]=0;h[l++]=a/2-g/2;h[l++]=0;h[l++]=b;h[l++]=e;h[l++]=a/2+g/2;h[l]=0;return h};
    u.prototype.doDrawOrderedAnnotation=function(a){var d=a.currentGlContext,b=a.currentProgram,e;e=!1;a.pickingMode&&(this.pickColor=a.uniquePickColor());b.loadOpacity(d,this.attributes.opacity);var c=this.attributes.stateKey!=this.lastStateKey;if(!this.calloutCacheKey||c)this.calloutCacheKey=a.gpuResourceCache.generateCacheKey();var g=a.gpuResourceCache.resourceForKey(this.calloutCacheKey);g||(g=d.createBuffer(),a.gpuResourceCache.putResource(this.calloutCacheKey,g,4*this.calloutPoints.length),e=!0);
        c&&this.calloutCacheKey&&a.gpuResourceCache.removeResource(this.calloutCacheKey);this.lastStateKey=this.attributes.stateKey;u.matrix.copy(a.screenProjection);u.matrix.multiplyMatrix(this.calloutTransform);b.loadModelviewProjection(d,u.matrix);d.bindBuffer(d.ARRAY_BUFFER,g);e&&(d.bufferData(d.ARRAY_BUFFER,this.calloutPoints,d.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1));b.loadColor(d,a.pickingMode?this.pickColor:this.attributes.backgroundColor);b.loadTextureEnabled(d,!1);d.vertexAttribPointer(b.vertexPointLocation,
            2,d.FLOAT,!1,0,0);d.vertexAttribPointer(b.vertexTexCoordLocation,2,d.FLOAT,!1,0,0);d.drawArrays(d.TRIANGLE_FAN,0,this.calloutPoints.length/2);u.matrix.copy(a.screenProjection);u.matrix.multiplyMatrix(this.labelTransform);b.loadModelviewProjection(d,u.matrix);b.loadColor(d,a.pickingMode?this.pickColor:this.attributes.textAttributes.color);e=this.labelTexture.bind(a);b.loadTextureEnabled(d,e);d.bindBuffer(d.ARRAY_BUFFER,a.unitQuadBuffer3());d.vertexAttribPointer(b.vertexPointLocation,3,d.FLOAT,!1,0,
            0);d.bindBuffer(d.ARRAY_BUFFER,a.unitQuadBuffer());d.vertexAttribPointer(b.vertexTexCoordLocation,2,d.FLOAT,!1,0,0);d.drawArrays(d.TRIANGLE_STRIP,0,4)};return u});
define("src/shaders/AtmosphereProgram",["../error/ArgumentError","../shaders/GpuProgram","../util/Logger"],function(f,b,c){var a=function(a,e,c,h){b.call(this,a,e,c,h);this.FRAGMODE_SKY=1;this.FRAGMODE_GROUND_PRIMARY=2;this.FRAGMODE_GROUND_SECONDARY=3;this.FRAGMODE_GROUND_PRIMARY_TEX_BLEND=4;this.altitude=16E4;this.rayleighScaleDepth=.25;this.fragModeLocation=this.uniformLocation(a,"fragMode");this.mvpMatrixLocation=this.uniformLocation(a,"mvpMatrix");this.texCoordMatrixLocation=this.uniformLocation(a,
    "texCoordMatrix");this.vertexOriginLocation=this.uniformLocation(a,"vertexOrigin");this.eyePointLocation=this.uniformLocation(a,"eyePoint");this.eyeMagnitudeLocation=this.uniformLocation(a,"eyeMagnitude");this.eyeMagnitude2Location=this.uniformLocation(a,"eyeMagnitude2");this.lightDirectionLocation=this.uniformLocation(a,"lightDirection");this.atmosphereRadiusLocation=this.uniformLocation(a,"atmosphereRadius");this.atmosphereRadius2Location=this.uniformLocation(a,"atmosphereRadius2");this.globeRadiusLocation=
    this.uniformLocation(a,"globeRadius");this.scaleLocation=this.uniformLocation(a,"scale");this.scaleDepthLocation=this.uniformLocation(a,"scaleDepth");this.scaleOverScaleDepthLocation=this.uniformLocation(a,"scaleOverScaleDepth");this.scratchArray9=new Float32Array(9)};a.key="WorldWindGpuAtmosphereProgram";a.prototype=Object.create(b.prototype);a.prototype.getAltitude=function(){return this.altitude};a.prototype.getScaleDepth=function(){return this.rayleighScaleDepth};a.prototype.loadFragMode=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              b){if(!b)throw new f(c.logMessage(c.LEVEL_SEVERE,"AtmosphereProgram","loadFragMode","missingFragMode"));a.uniform1i(this.fragModeLocation,b)};a.prototype.loadModelviewProjection=function(a,b){if(!b)throw new f(c.logMessage(c.LEVEL_SEVERE,"AtmosphereProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(a,b,this.mvpMatrixLocation)};a.prototype.loadVertexOrigin=function(a,b){if(!b)throw new f(c.logMessage(c.LEVEL_SEVERE,"AtmosphereProgram","loadVertexOrigin","missingVector"));a.uniform3fv(this.vertexOriginLocation,
    [b[0],b[1],b[2]])};a.prototype.loadLightDirection=function(a,b){if(!b)throw new f(c.logMessage(c.LEVEL_SEVERE,"AtmosphereProgram","loadLightDirection","missingVector"));a.uniform3fv(this.lightDirectionLocation,[b[0],b[1],b[2]])};a.prototype.loadEyePoint=function(a,b){if(!b)throw new f(c.logMessage(c.LEVEL_SEVERE,"AtmosphereProgram","loadEyePoint","missingVector"));a.uniform3fv(this.eyePointLocation,[b[0],b[1],b[2]]);a.uniform1f(this.eyeMagnitudeLocation,b.magnitude());a.uniform1f(this.eyeMagnitude2Location,
    b.magnitudeSquared())};a.prototype.loadGlobeRadius=function(a,b){if(!b)throw new f(c.logMessage(c.LEVEL_SEVERE,"AtmosphereProgram","loadGlobeRadius","missingGlobeRadius"));var g=b+this.altitude;a.uniform1f(this.globeRadiusLocation,b);a.uniform1f(this.atmosphereRadiusLocation,g);a.uniform1f(this.atmosphereRadius2Location,g*g)};a.prototype.setScale=function(a){a.uniform1f(this.scaleLocation,1/this.getAltitude());a.uniform1f(this.scaleDepthLocation,this.getScaleDepth());a.uniform1f(this.scaleOverScaleDepthLocation,
    1/this.getAltitude()/this.getScaleDepth())};a.prototype.loadTexMatrix=function(a,b){b.columnMajorComponents(this.scratchArray9);a.uniformMatrix3fv(this.texCoordMatrixLocation,!1,this.scratchArray9)};return a});
define("src/shaders/GroundProgram",["../shaders/AtmosphereProgram"],function(f){var b=function(b){f.call(this,b,"precision mediump float;\nprecision mediump int;\nconst int FRAGMODE_SKY = 1;\nconst int FRAGMODE_GROUND_PRIMARY = 2;\nconst int FRAGMODE_GROUND_SECONDARY = 3;\nconst int FRAGMODE_GROUND_PRIMARY_TEX_BLEND = 4;\nconst int SAMPLE_COUNT = 2;\nconst float SAMPLES = 2.0;\nconst float PI = 3.141592653589;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * PI;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * PI;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 invWavelength = vec3(5.60204474633241, 9.473284437923038, 19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nuniform int fragMode;\nuniform mat4 mvpMatrix;\nuniform mat3 texCoordMatrix;\nuniform vec3 vertexOrigin;\nuniform vec3 eyePoint;\nuniform float eyeMagnitude;\nuniform float eyeMagnitude2;\nuniform vec3 lightDirection;\nuniform float atmosphereRadius;\nuniform float atmosphereRadius2;\nuniform float globeRadius;\nuniform float scale;\nuniform float scaleDepth;\nuniform float scaleOverScaleDepth;\nattribute vec4 vertexPoint;\nattribute vec2 vertexTexCoord;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nvarying vec2 texCoord;\nfloat scaleFunc(float cos) {\n    float x = 1.0 - cos;\n    return scaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid sampleGround() {\n    vec3 point = vertexPoint.xyz + vertexOrigin;\n    vec3 ray = point - eyePoint;\n    float far = length(ray);\n    ray /= far;\n    vec3 start;\n    if (eyeMagnitude < atmosphereRadius) {\n        start = eyePoint;\n    } else {\n        float B = 2.0 * dot(eyePoint, ray);\n        float C = eyeMagnitude2 - atmosphereRadius2;\n        float det = max(0.0, B*B - 4.0 * C);\n        float near = 0.5 * (-B - sqrt(det));\n        start = eyePoint + ray * near;\n        far -= near;\n}\n    float depth = exp((globeRadius - atmosphereRadius) / scaleDepth);\n    float eyeAngle = dot(-ray, point) / length(point);\n    float lightAngle = dot(lightDirection, point) / length(point);\n    float eyeScale = scaleFunc(eyeAngle);\n    float lightScale = scaleFunc(lightAngle);\n    float eyeOffset = depth*eyeScale;\n    float temp = (lightScale + eyeScale);\n    float sampleLength = far / SAMPLES;\n    float scaledLength = sampleLength * scale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    vec3 attenuate = vec3(0.0, 0.0, 0.0);\n    for(int i=0; i<SAMPLE_COUNT; i++)\n    {\n        float height = length(samplePoint);\n        float depth = exp(scaleOverScaleDepth * (globeRadius - height));\n        float scatter = depth*temp - eyeOffset;\n        attenuate = exp(-scatter * (invWavelength * Kr4PI + Km4PI));\n        frontColor += attenuate * (depth * scaledLength);\n        samplePoint += sampleRay;\n    }\n    primaryColor = frontColor * (invWavelength * KrESun + KmESun);\n    secondaryColor = attenuate;\n}\nvoid main()\n {\n    sampleGround();\n    gl_Position = mvpMatrix * vertexPoint;\n    if (fragMode == FRAGMODE_GROUND_PRIMARY_TEX_BLEND) {\n        texCoord = (texCoordMatrix * vec3(vertexTexCoord, 1.0)).st;\n    }\n}","precision mediump float;\nprecision mediump int;\nconst int FRAGMODE_SKY = 1;\nconst int FRAGMODE_GROUND_PRIMARY = 2;\nconst int FRAGMODE_GROUND_SECONDARY = 3;\nconst int FRAGMODE_GROUND_PRIMARY_TEX_BLEND = 4;\nconst float g = -0.95;\nconst float g2 = g * g;\nuniform int fragMode;\nuniform sampler2D texSampler;\nuniform vec3 lightDirection;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nvarying vec2 texCoord;\nvoid main (void)\n{\n    if (fragMode == FRAGMODE_SKY) {\n        float cos = dot(lightDirection, direction) / length(direction);\n        float rayleighPhase = 0.75 * (1.0 + cos * cos);\n        float miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cos*cos) / pow(1.0 + g2 - 2.0*g*cos, 1.5);\n        const float exposure = 2.0;\n        vec3 color = primaryColor * rayleighPhase + secondaryColor * miePhase;\n        color = vec3(1.0) - exp(-exposure * color);\n        gl_FragColor = vec4(color, color.b);\n    } else if (fragMode == FRAGMODE_GROUND_PRIMARY) {\n        gl_FragColor = vec4(primaryColor, 1.0);\n    } else if (fragMode == FRAGMODE_GROUND_SECONDARY) {\n        gl_FragColor = vec4(secondaryColor, 1.0);\n    } else if (fragMode == FRAGMODE_GROUND_PRIMARY_TEX_BLEND) {\n        vec4 texColor = texture2D(texSampler, texCoord);\n        gl_FragColor = vec4(primaryColor + texColor.rgb * (1.0 - secondaryColor), 1.0);\n    } else {\n        gl_FragColor = vec4(1.0);\n    }\n}",
    ["vertexPoint"])};b.key="WorldWindGroundProgram";b.prototype=Object.create(f.prototype);return b});define("src/util/ImageSource",["../error/ArgumentError","../util/Color","../util/Logger"],function(f,b,c){var a=function(d){if(!d)throw new f(c.logMessage(c.LEVEL_SEVERE,"ImageSource","constructor","missingImage"));this.image=d;this.key="ImageSource "+ ++a.keyPool};a.keyPool=0;return a});
define("src/layer/Layer",["../util/Logger"],function(f){f=function(b){this.displayName=b?b:"Layer";this.pickEnabled=this.enabled=!0;this.opacity=1;this.minActiveAltitude=-Number.MAX_VALUE;this.maxActiveAltitude=Number.MAX_VALUE;this.inCurrentFrame=!1;this.time=null};f.prototype.refresh=function(){};f.prototype.render=function(b){this.inCurrentFrame=!1;this.enabled&&(!b.pickingMode||this.pickEnabled)&&this.withinActiveAltitudes(b)&&this.isLayerInView(b)&&this.doRender(b)};f.prototype.doRender=function(b){};
    f.prototype.withinActiveAltitudes=function(b){return(b=b.eyePosition)?b.altitude>=this.minActiveAltitude&&b.altitude<=this.maxActiveAltitude:!1};f.prototype.isLayerInView=function(b){return!0};return f});
define("src/geom/Matrix3",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a,d,b,c,h,k,l,m,f){this[0]=a;this[1]=d;this[2]=b;this[3]=c;this[4]=h;this[5]=k;this[6]=l;this[7]=m;this[8]=f};c.prototype=new Float64Array(9);c.fromIdentity=function(){return new c(1,0,0,0,1,0,0,0,1)};c.prototype.setToUnitYFlip=function(){this[0]=1;this[1]=0;this[2]=0;this[3]=0;this[4]=-1;this[5]=1;this[6]=0;this[7]=0;this[8]=1;return this};c.prototype.multiplyMatrix=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,
    "Matrix","multiplyMatrix","missingMatrix"));var d,e,c;d=this[0];e=this[1];c=this[2];this[0]=d*a[0]+e*a[3]+c*a[6];this[1]=d*a[1]+e*a[4]+c*a[7];this[2]=d*a[2]+e*a[5]+c*a[8];d=this[3];e=this[4];c=this[5];this[3]=d*a[0]+e*a[3]+c*a[6];this[4]=d*a[1]+e*a[4]+c*a[7];this[5]=d*a[2]+e*a[5]+c*a[8];d=this[6];e=this[7];c=this[8];this[6]=d*a[0]+e*a[3]+c*a[6];this[7]=d*a[1]+e*a[4]+c*a[7];this[8]=d*a[2]+e*a[5]+c*a[8];return this};c.prototype.multiplyByTileTransform=function(a,d){var b=a.deltaLatitude(),c=a.deltaLongitude(),
    h=d.deltaLatitude(),k=d.deltaLongitude(),c=c/k,b=b/h,k=(a.minLongitude-d.minLongitude)/k,h=(a.minLatitude-d.minLatitude)/h;this[2]+=this[0]*k+this[1]*h;this[5]+=this[3]*k+this[4]*h;this[8]+=this[6]*k+this[6]*h;this[0]*=c;this[1]*=b;this[3]*=c;this[4]*=b;this[6]*=c;this[7]*=b;return this};c.prototype.columnMajorComponents=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"Matrix","columnMajorComponents","missingResult"));a[0]=this[0];a[1]=this[3];a[2]=this[6];a[3]=this[1];a[4]=this[4];a[5]=
    this[7];a[6]=this[2];a[7]=this[5];a[8]=this[8];return a};return c});
define("src/geom/Sector","../geom/Angle ../error/ArgumentError ../geom/Location ../util/Logger ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e){var g=function(a,d,b,c){this.minLatitude=a;this.maxLatitude=d;this.minLongitude=b;this.maxLongitude=c};g.ZERO=new g(0,0,0,0);g.FULL_SPHERE=new g(-90,90,-180,180);g.prototype.copy=function(d){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"Sector","copy","missingSector"));this.minLatitude=d.minLatitude;this.maxLatitude=d.maxLatitude;this.minLongitude=
    d.minLongitude;this.maxLongitude=d.maxLongitude;return this};g.prototype.isEmpty=function(){return this.minLatitude===this.maxLatitude&&this.minLongitude===this.maxLongitude};g.prototype.deltaLatitude=function(){return this.maxLatitude-this.minLatitude};g.prototype.deltaLongitude=function(){return this.maxLongitude-this.minLongitude};g.prototype.centroidLatitude=function(){return.5*(this.minLatitude+this.maxLatitude)};g.prototype.centroidLongitude=function(){return.5*(this.minLongitude+this.maxLongitude)};
    g.prototype.centroid=function(d){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"Sector","centroid","missingResult"));d.latitude=this.centroidLatitude();d.longitude=this.centroidLongitude();return d};g.prototype.minLatitudeRadians=function(){return this.minLatitude*f.DEGREES_TO_RADIANS};g.prototype.maxLatitudeRadians=function(){return this.maxLatitude*f.DEGREES_TO_RADIANS};g.prototype.minLongitudeRadians=function(){return this.minLongitude*f.DEGREES_TO_RADIANS};g.prototype.maxLongitudeRadians=function(){return this.maxLongitude*
        f.DEGREES_TO_RADIANS};g.prototype.setToBoundingSector=function(d){if(!d||2>d.length)throw new b(a.logMessage(a.LEVEL_SEVERE,"Sector","setToBoundingSector","missingArray"));for(var c=90,e=-90,g=180,f=-180,q=0,t=d.length;q<t;q+=1){var r=d[q];r&&(c=Math.min(c,r.latitude),e=Math.max(e,r.latitude),g=Math.min(g,r.longitude),f=Math.max(f,r.longitude))}this.minLatitude=c;this.maxLatitude=e;this.minLongitude=g;this.maxLongitude=f;return this};g.splitBoundingSectors=function(d){if(!d||2>d.length)throw new b(a.logMessage(a.LEVEL_SEVERE,
        "Sector","splitBoundingSectors","missingArray"));for(var c=90,l=180,m=-90,f=-180,q=null,t=0,r=d.length;t<r;t+=1){var u=d[t],w=u.latitude;w<c&&(c=w);w>m&&(m=w);w=u.longitude;0<=w&&w<l&&(l=w);0>=w&&w>f&&(f=w);null!=q&&(q=q.longitude,e.signum(w)!=e.signum(q)&&180>Math.abs(w-q)&&(l=f=0));q=u}return c===m&&l===f?null:[new g(c,m,l,180),new g(c,m,-180,f)]};g.prototype.intersects=function(a){return a&&this.minLongitude<=a.maxLongitude&&this.maxLongitude>=a.minLongitude&&this.minLatitude<=a.maxLatitude&&this.maxLatitude>=
        a.minLatitude};g.prototype.overlaps=function(a){return a&&this.minLongitude<a.maxLongitude&&this.maxLongitude>a.minLongitude&&this.minLatitude<a.maxLatitude&&this.maxLatitude>a.minLatitude};g.prototype.contains=function(a){return a&&this.minLatitude<=a.minLatitude&&this.maxLatitude>=a.maxLatitude&&this.minLongitude<=a.minLongitude&&this.maxLongitude>=a.maxLongitude};g.prototype.containsLocation=function(a,d){return this.minLatitude<=a&&this.maxLatitude>=a&&this.minLongitude<=d&&this.maxLongitude>=
        d};g.prototype.intersection=function(d){if(!d instanceof g)throw new b(a.logMessage(a.LEVEL_SEVERE,"Sector","intersection","missingSector"));this.minLatitude<d.minLatitude&&(this.minLatitude=d.minLatitude);this.maxLatitude>d.maxLatitude&&(this.maxLatitude=d.maxLatitude);this.minLongitude<d.minLongitude&&(this.minLongitude=d.minLongitude);this.maxLongitude>d.maxLongitude&&(this.maxLongitude=d.maxLongitude);this.maxLatitude<this.minLatitude&&(this.maxLatitude=this.minLatitude);this.maxLongitude<this.minLongitude&&
    (this.maxLongitude=this.minLongitude);return this};g.prototype.union=function(d){if(!d instanceof g)throw new b(a.logMessage(a.LEVEL_SEVERE,"Sector","union","missingSector"));this.minLatitude>d.minLatitude&&(this.minLatitude=d.minLatitude);this.maxLatitude<d.maxLatitude&&(this.maxLatitude=d.maxLatitude);this.minLongitude>d.minLongitude&&(this.minLongitude=d.minLongitude);this.maxLongitude<d.maxLongitude&&(this.maxLongitude=d.maxLongitude);return this};return g});
define("src/shaders/SkyProgram",["../shaders/AtmosphereProgram"],function(f){var b=function(b){f.call(this,b,"precision mediump float;\nprecision mediump int;\nconst int SAMPLE_COUNT = 2;\nconst float SAMPLES = 2.0;\nconst float PI = 3.141592653589;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * PI;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * PI;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 invWavelength = vec3(5.60204474633241, 9.473284437923038, 19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nuniform mat4 mvpMatrix;\nuniform vec3 vertexOrigin;\nuniform vec3 eyePoint;\nuniform float eyeMagnitude;\nuniform float eyeMagnitude2;\nuniform vec3 lightDirection;\nuniform float atmosphereRadius;\nuniform float atmosphereRadius2;\nuniform float globeRadius;\nuniform float scale;\nuniform float scaleDepth;\nuniform float scaleOverScaleDepth;\nattribute vec4 vertexPoint;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nfloat scaleFunc(float cos)\n{\n    float x = 1.0 - cos;\n    return scaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid sampleSky() {\n    vec3 point = vertexPoint.xyz + vertexOrigin;\n    vec3 ray = point - eyePoint;\n    float far = length(ray);\n    ray /= far;\n    vec3 start;\n    float startOffset;\n    if (eyeMagnitude < atmosphereRadius) {\n        start = eyePoint;\n        float height = length(start);\n        float depth = exp(scaleOverScaleDepth * (globeRadius - eyeMagnitude));\n        float startAngle = dot(ray, start) / height;\n        startOffset = depth*scaleFunc(startAngle);\n    } else {\n        float B = 2.0 * dot(eyePoint, ray);\n        float C = eyeMagnitude2 - atmosphereRadius2;\n        float det = max(0.0, B*B - 4.0 * C);\n        float near = 0.5 * (-B - sqrt(det));\n        start = eyePoint + ray * near;\n        far -= near;\n        float startAngle = dot(ray, start) / atmosphereRadius;\n        float startDepth = exp(-1.0 / scaleDepth);\n        startOffset = startDepth*scaleFunc(startAngle);\n    }\n    float sampleLength = far / SAMPLES;\n    float scaledLength = sampleLength * scale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    for(int i=0; i<SAMPLE_COUNT; i++)\n    {\n       float height = length(samplePoint);\n       float depth = exp(scaleOverScaleDepth * (globeRadius - height));\n       float lightAngle = dot(lightDirection, samplePoint) / height;\n       float cameraAngle = dot(ray, samplePoint) / height;\n       float scatter = (startOffset + depth*(scaleFunc(lightAngle) - scaleFunc(cameraAngle)));\n       vec3 attenuate = exp(-scatter * (invWavelength * Kr4PI + Km4PI));\n       frontColor += attenuate * (depth * scaledLength);\n       samplePoint += sampleRay;\n    }\n    primaryColor = frontColor * (invWavelength * KrESun);\n    secondaryColor = frontColor * KmESun;\n    direction = eyePoint - point;\n}\nvoid main()\n{\n    sampleSky();\n    gl_Position = mvpMatrix * vertexPoint;\n}",
    "precision mediump float;\nprecision mediump int;\nconst int FRAGMODE_SKY = 1;\nconst int FRAGMODE_GROUND_PRIMARY = 2;\nconst int FRAGMODE_GROUND_SECONDARY = 3;\nconst float g = -0.95;\nconst float g2 = g * g;\nuniform int fragMode;\nuniform vec3 lightDirection;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nvoid main (void)\n{\n    if (fragMode == FRAGMODE_SKY) {\n        float cos = dot(lightDirection, direction) / length(direction);\n        float rayleighPhase = 0.75 * (1.0 + cos * cos);\n        float miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cos*cos) /             pow(1.0 + g2 - 2.0*g*cos, 1.5);\n        const float exposure = 2.0;\n        vec3 color = primaryColor * rayleighPhase + secondaryColor * miePhase;\n        color = vec3(1.0) - exp(-exposure * color);\n        gl_FragColor = vec4(color, color.b);\n    } else if (fragMode == FRAGMODE_GROUND_PRIMARY) {\n        gl_FragColor = vec4(primaryColor, 1.0);\n    } else if (fragMode == FRAGMODE_GROUND_SECONDARY) {\n        gl_FragColor = vec4(secondaryColor, 1.0);\n    } else {\n        gl_FragColor = vec4(1.0);\n    }\n}",
    ["vertexPoint"])};b.key="WorldWindSkyProgram";b.prototype=Object.create(f.prototype);return b});
define("src/util/sun",["../geom/Angle"],function(f){function b(a){return Math.sin(f.DEGREES_TO_RADIANS*a)}function c(a){return Math.cos(f.DEGREES_TO_RADIANS*a)}function a(a){return 360*(a/360-Math.floor(a/360))}return function(d){var e,g,h=d.getUTCFullYear(),k=d.getUTCMonth()+1,l=d.getUTCDate(),m=d.getUTCHours(),p=d.getUTCMinutes();d=d.getUTCSeconds();var q,t,r,u;2>=k&&(--h,k+=12);g=Math.floor(h/100);q=Math.floor(365.25*(h+4716))+Math.floor(30.6001*(k+1))+l+(2-g+Math.floor(g/4))-1524.5+(m+p/60+d/
    3600)/24;h=(q-2451545)/36525;t=h*h;r=h*t;p=(q+68.1577/86400-2451545)/36525;d=p*p;u=p*d;h=.1*p;k=h*h;l=h*k;m=h*l;g=h*m;e=134.962981389+198.867398056*p+a(477E3*p)+.008697222222*d+u/56250;var w=357.527723333+359.05034*p+a(35640*p)-1.602777778E-4*d-u/3E5,x=93.271910277+82.017538055*p+a(483120*p)-.0036825*d+u/327272.7273,A=297.850363055+307.11148*p+a(444960*p)-.001914166667*d+u/189473.6842,B=125.044522222-134.136260833*p-a(1800*p)+.002070833333*d+u/45E4,v=Array(106);v[0]=" 0 0 0 0 1-171996-174.2 92025 8.9 ";
    v[1]=" 0 0 2-2 2 -13187  -1.6  5736-3.1 ";v[2]=" 0 0 2 0 2  -2274  -0.2   977-0.5 ";v[3]=" 0 0 0 0 2   2062   0.2  -895 0.5 ";v[4]=" 0-1 0 0 0  -1426   3.4    54-0.1 ";v[5]=" 1 0 0 0 0    712   0.1    -7 0.0 ";v[6]=" 0 1 2-2 2   -517   1.2   224-0.6 ";v[7]=" 0 0 2 0 1   -386  -0.4   200 0.0 ";v[8]=" 1 0 2 0 2   -301   0.0   129-0.1 ";v[9]=" 0-1 2-2 2    217  -0.5   -95 0.3 ";v[10]="-1 0 0 2 0    158   0.0    -1 0.0 ";v[11]=" 0 0 2-2 1    129   0.1   -70 0.0 ";v[12]="-1 0 2 0 2    123   0.0   -53 0.0 ";
    v[13]=" 1 0 0 0 1     63   0.1   -33 0.0 ";v[14]=" 0 0 0 2 0     63   0.0    -2 0.0 ";v[15]="-1 0 2 2 2    -59   0.0    26 0.0 ";v[16]="-1 0 0 0 1    -58  -0.1    32 0.0 ";v[17]=" 1 0 2 0 1    -51   0.0    27 0.0 ";v[18]="-2 0 0 2 0    -48   0.0     1 0.0 ";v[19]="-2 0 2 0 1     46   0.0   -24 0.0 ";v[20]=" 0 0 2 2 2    -38   0.0    16 0.0 ";v[21]=" 2 0 2 0 2    -31   0.0    13 0.0 ";v[22]=" 2 0 0 0 0     29   0.0    -1 0.0 ";v[23]=" 1 0 2-2 2     29   0.0   -12 0.0 ";v[24]=" 0 0 2 0 0     26   0.0    -1 0.0 ";
    v[25]=" 0 0 2-2 0    -22   0.0     0 0.0 ";v[26]="-1 0 2 0 1     21   0.0   -10 0.0 ";v[27]=" 0 2 0 0 0     17  -0.1     0 0.0 ";v[28]=" 0 2 2-2 2    -16   0.1     7 0.0 ";v[29]="-1 0 0 2 1     16   0.0    -8 0.0 ";v[30]=" 0 1 0 0 1    -15   0.0     9 0.0 ";v[31]=" 1 0 0-2 1    -13   0.0     7 0.0 ";v[32]=" 0-1 0 0 1    -12   0.0     6 0.0 ";v[33]=" 2 0-2 0 0     11   0.0     0 0.0 ";v[34]="-1 0 2 2 1    -10   0.0     5 0.0 ";v[35]=" 1 0 2 2 2     -8   0.0     3 0.0 ";v[36]=" 0-1 2 0 2     -7   0.0     3 0.0 ";
    v[37]=" 0 0 2 2 1     -7   0.0     3 0.0 ";v[38]=" 1 1 0-2 0     -7   0.0     0 0.0 ";v[39]=" 0 1 2 0 2      7   0.0    -3 0.0 ";v[40]="-2 0 0 2 1     -6   0.0     3 0.0 ";v[41]=" 0 0 0 2 1     -6   0.0     3 0.0 ";v[42]=" 2 0 2-2 2      6   0.0    -3 0.0 ";v[43]=" 1 0 0 2 0      6   0.0     0 0.0 ";v[44]=" 1 0 2-2 1      6   0.0    -3 0.0 ";v[45]=" 0 0 0-2 1     -5   0.0     3 0.0 ";v[46]=" 0-1 2-2 1     -5   0.0     3 0.0 ";v[47]=" 2 0 2 0 1     -5   0.0     3 0.0 ";v[48]=" 1-1 0 0 0      5   0.0     0 0.0 ";
    v[49]=" 1 0 0-1 0     -4   0.0     0 0.0 ";v[50]=" 0 0 0 1 0     -4   0.0     0 0.0 ";v[51]=" 0 1 0-2 0     -4   0.0     0 0.0 ";v[52]=" 1 0-2 0 0      4   0.0     0 0.0 ";v[53]=" 2 0 0-2 1      4   0.0    -2 0.0 ";v[54]=" 0 1 2-2 1      4   0.0    -2 0.0 ";v[55]=" 1 1 0 0 0     -3   0.0     0 0.0 ";v[56]=" 1-1 0-1 0     -3   0.0     0 0.0 ";v[57]="-1-1 2 2 2     -3   0.0     1 0.0 ";v[58]=" 0-1 2 2 2     -3   0.0     1 0.0 ";v[59]=" 1-1 2 0 2     -3   0.0     1 0.0 ";v[60]=" 3 0 2 0 2     -3   0.0     1 0.0 ";
    v[61]="-2 0 2 0 2     -3   0.0     1 0.0 ";v[62]=" 1 0 2 0 0      3   0.0     0 0.0 ";v[63]="-1 0 2 4 2     -2   0.0     1 0.0 ";v[64]=" 1 0 0 0 2     -2   0.0     1 0.0 ";v[65]="-1 0 2-2 1     -2   0.0     1 0.0 ";v[66]=" 0-2 2-2 1     -2   0.0     1 0.0 ";v[67]="-2 0 0 0 1     -2   0.0     1 0.0 ";v[68]=" 2 0 0 0 1      2   0.0    -1 0.0 ";v[69]=" 3 0 0 0 0      2   0.0     0 0.0 ";v[70]=" 1 1 2 0 2      2   0.0    -1 0.0 ";v[71]=" 0 0 2 1 2      2   0.0    -1 0.0 ";v[72]=" 1 0 0 2 1     -1   0.0     0 0.0 ";
    v[73]=" 1 0 2 2 1     -1   0.0     1 0.0 ";v[74]=" 1 1 0-2 1     -1   0.0     0 0.0 ";v[75]=" 0 1 0 2 0     -1   0.0     0 0.0 ";v[76]=" 0 1 2-2 0     -1   0.0     0 0.0 ";v[77]=" 0 1-2 2 0     -1   0.0     0 0.0 ";v[78]=" 1 0-2 2 0     -1   0.0     0 0.0 ";v[79]=" 1 0-2-2 0     -1   0.0     0 0.0 ";v[80]=" 1 0 2-2 0     -1   0.0     0 0.0 ";v[81]=" 1 0 0-4 0     -1   0.0     0 0.0 ";v[82]=" 2 0 0-4 0     -1   0.0     0 0.0 ";v[83]=" 0 0 2 4 2     -1   0.0     0 0.0 ";v[84]=" 0 0 2-1 2     -1   0.0     0 0.0 ";
    v[85]="-2 0 2 4 2     -1   0.0     1 0.0 ";v[86]=" 2 0 2 2 2     -1   0.0     0 0.0 ";v[87]=" 0-1 2 0 1     -1   0.0     0 0.0 ";v[88]=" 0 0-2 0 1     -1   0.0     0 0.0 ";v[89]=" 0 0 4-2 2      1   0.0     0 0.0 ";v[90]=" 0 1 0 0 2      1   0.0     0 0.0 ";v[91]=" 1 1 2-2 2      1   0.0    -1 0.0 ";v[92]=" 3 0 2-2 2      1   0.0     0 0.0 ";v[93]="-2 0 2 2 2      1   0.0    -1 0.0 ";v[94]="-1 0 0 0 2      1   0.0    -1 0.0 ";v[95]=" 0 0-2 2 1      1   0.0     0 0.0 ";v[96]=" 0 1 2 0 1      1   0.0     0 0.0 ";
    v[97]="-1 0 4 0 2      1   0.0     0 0.0 ";v[98]=" 2 1 0-2 0      1   0.0     0 0.0 ";v[99]=" 2 0 0 2 0      1   0.0     0 0.0 ";v[100]=" 2 0 2-2 1      1   0.0    -1 0.0 ";v[101]=" 2 0-2 0 1      1   0.0     0 0.0 ";v[102]=" 1-1 0-2 0      1   0.0     0 0.0 ";v[103]="-1 0 0 1 1      1   0.0     0 0.0 ";v[104]="-1-1 0 2 1      1   0.0     0 0.0 ";v[105]=" 0 1 0 1 0      1   0.0     0 0.0 ";for(var F,G,D,y,H,C=0,z=0,E=0;105>E;E++)F=+v[E].substring(0,2),G=+v[E].substring(2,4),D=+v[E].substring(4,6),
        y=+v[E].substring(6,8),H=+v[E].substring(8,10),C+=(+v[E].substring(10,17)+p*+v[E].substring(17,23))*b(y*A+G*w+F*e+D*x+H*B),z+=(+v[E].substring(23,29)+p*+v[E].substring(29,33))*c(y*A+G*w+F*e+D*x+H*B);e=C/36E6;u=(84381.448-46.815*p-5.9E-4*d+.001813*u)/3600+z/36E6;q=a(280.46061837+360.98564736629*(q-2451545)+3.87933E-4*t-r/3871E4);q=a(q+e*c(u));t=f.DEGREES_TO_RADIANS;r=Math.cos;z=175347046+3341656*r(4.6692568+6283.07585*h);z+=34894*r(4.6261+12566.1517*h);z+=3497*r(2.7441+5753.3849*h);z+=3418*r(2.8289+
            3.5231*h);z+=3136*r(3.6277+77713.7715*h);z+=2676*r(4.4181+7860.4194*h);z+=2343*r(6.1352+3930.2097*h);z+=1324*r(.7425+11506.7698*h);z+=1273*r(2.0371+529.691*h);z+=1199*r(1.1096+1577.3435*h);z+=990*r(5.233+5884.927*h);z+=902*r(2.045+26.298*h);z+=857*r(3.508+398.149*h);z+=780*r(1.179+5223.694*h);z+=753*r(2.533+5507.553*h);z+=505*r(4.583+18849.228*h);z+=492*r(4.205+775.523*h);z+=357*r(2.92+.067*h);z+=317*r(5.849+11790.629*h);z+=284*r(1.899+796.298*h);z+=271*r(.315+10977.079*h);z+=243*r(.345+5486.778*
            h);z+=206*r(4.806+2544.314*h);z+=205*r(1.869+5573.143*h);z+=202*r(2.458+6069.777*h);z+=156*r(.833+213.299*h);z+=132*r(3.411+2942.463*h);z+=126*r(1.083+20.775*h);z+=115*r(.645+.98*h);z+=103*r(.636+4694.003*h);z+=102*r(.976+15720.839*h);z+=102*r(4.267+7.114*h);z+=99*r(6.21+2146.17*h);z+=98*r(.68+155.42*h);z+=86*r(5.98+161000.69*h);z+=85*r(1.3+6275.96*h);z+=85*r(3.67+71430.7*h);z+=80*r(1.81+17260.15*h);z+=79*r(3.04+12036.46*h);z+=75*r(1.76+5088.63*h);z+=74*r(3.5+3154.69*h);z+=74*r(4.68+801.82*h);z+=
        70*r(.83+9437.76*h);z+=62*r(3.98+8827.39*h);z+=61*r(1.82+7084.9*h);z+=57*r(2.78+6286.6*h);z+=56*r(4.39+14143.5*h);z+=56*r(3.47+6279.55*h);z+=52*r(.19+12139.55*h);z+=52*r(1.33+1748.02*h);z+=51*r(.28+5856.48*h);z+=49*r(.49+1194.45*h);z+=41*r(5.37+8429.24*h);z+=41*r(2.4+19651.05*h);z+=39*r(6.17+10447.39*h);z+=37*r(6.04+10213.29*h);z+=37*r(2.57+1059.38*h);z+=36*r(1.71+2352.87*h);z+=36*r(1.78+6812.77*h);z+=33*r(.59+17789.85*h);z+=30*r(.44+83996.85*h);z+=30*r(2.74+1349.87*h);z+=25*r(3.16+4690.48*h);w=628331966747+
        206059*r(2.678235+6283.07585*h);w+=4303*r(2.6351+12566.1517*h);w+=425*r(1.59+3.523*h);w+=119*r(5.796+26.298*h);w+=109*r(2.966+1577.344*h);w+=93*r(2.59+18849.23*h);w+=72*r(1.14+529.69*h);w+=68*r(1.87+398.15*h);w+=67*r(4.41+5507.55*h);w+=59*r(2.89+5223.69*h);w+=56*r(2.17+155.42*h);w+=45*r(.4+796.3*h);w+=36*r(.47+775.52*h);w+=29*r(2.65+7.11*h);w+=21*r(5.34+.98*h);w+=19*r(1.85+5486.78*h);w+=19*r(4.97+213.3*h);w+=17*r(2.99+6275.96*h);w+=16*r(.03+2544.31*h);w+=16*r(1.43+2146.17*h);w+=15*r(1.21+10977.08*
            h);w+=12*r(2.83+1748.02*h);w+=12*r(3.26+5088.63*h);w+=12*r(5.27+1194.45*h);w+=12*r(2.08+4694*h);w+=11*r(.77+553.57*h);w+=10*r(1.3+6286.6*h);w+=10*r(4.24+1349.87*h);w+=9*r(2.7+242.73*h);w+=9*r(5.64+951.72*h);w+=8*r(5.3+2352.87*h);w+=6*r(2.65+9437.76*h);w+=6*r(4.67+4690.48*h);x=52919+8720*r(1.0721+6283.0758*h);x+=309*r(.867+12566.152*h);x+=27*r(.05+3.52*h);x+=16*r(5.19+26.3*h);x+=16*r(3.68+155.42*h);x+=10*r(.76+18849.23*h);x+=9*r(2.06+77713.77*h);x+=7*r(.83+775.52*h);x+=5*r(4.66+1577.34*h);x+=4*r(1.03+
            7.11*h);x+=4*r(3.44+5573.14*h);x+=3*r(5.14+796.3*h);x+=3*r(6.05+5507.55*h);x+=3*r(1.19+242.73*h);x+=3*r(6.12+529.69*h);x+=3*r(.31+398.15*h);x+=3*r(2.28+553.57*h);x+=2*r(4.38+5223.69*h);x+=2*r(3.75+.98*h);A=289*r(5.844+6283.076*h);A=A+35+17*r(5.49+12566.15*h);A+=3*r(5.2+155.42*h);A+=r(4.72+3.52*h);A+=r(5.3+18849.23*h);A+=r(5.97+242.73*h);B=114*r(3.142);B+=8*r(4.13+6283.08*h);B+=r(3.84+12566.15*h);v=r(3.14);w=a((z+w*h+x*k+A*l+B*m+v*g)/1E8/t);g=a(w+180-2.5E-5);z=280*r(3.199+84334.662*h);z+=102*r(5.422+
            5507.553*h);z+=80*r(3.88+5223.69*h);z+=44*r(3.7+2352.87*h);z+=32*r(4+1577.34*h);x=9*r(3.9+5507.55*h);x+=6*r(1.73+5223.69*h);z=a(-((z+x*h)/1E8/t));p=a(w+180-1.397*p-3.1E-4*d);z+=1.1E-5*(c(p)-b(p));p=100013989+1670700*r(3.0984635+6283.07585*h);p+=13956*r(3.05525+12566.1517*h);p+=3084*r(5.1985+77713.7715*h);p+=1628*r(1.1739+5753.3849*h);p+=1576*r(2.8469+7860.4194*h);p+=925*r(5.453+11506.77*h);p+=542*r(4.564+3930.21*h);p+=472*r(3.661+5884.927*h);p+=346*r(.964+5507.553*h);p+=329*r(5.9+5223.694*h);p+=307*
        r(.299+5573.143*h);p+=243*r(4.273+11790.629*h);p+=212*r(5.847+1577.344*h);p+=186*r(5.022+10977.079*h);p+=175*r(3.012+18849.228*h);p+=110*r(5.055+5486.778*h);p+=98*r(.89+6069.78*h);p+=86*r(5.69+15720.84*h);p+=86*r(1.27+161000.69*h);p+=65*r(.27+17260.15*h);p+=63*r(.92+529.69*h);p+=57*r(2.01+83996.85*h);p+=56*r(5.24+71430.7*h);p+=49*r(3.25+2544.31*h);p+=47*r(2.58+775.52*h);p+=45*r(5.54+9437.76*h);p+=43*r(6.01+6275.96*h);p+=39*r(5.36+4694*h);p+=38*r(2.39+8827.39*h);p+=37*r(.83+19651.05*h);p+=37*r(4.9+
            12139.55*h);p+=36*r(1.67+12036.46*h);p+=35*r(1.84+2942.46*h);p+=33*r(.24+7084.9*h);p+=32*r(.18+5088.63*h);p+=32*r(1.78+398.15*h);p+=28*r(1.21+6286.6*h);p+=28*r(1.9+6279.55*h);p+=26*r(4.59+10447.39*h);d=103019*r(1.10749+6283.07585*h);d+=1721*r(1.0644+12566.1517*h);d+=702*r(3.142);d+=32*r(1.02+18849.23*h);d+=31*r(2.84+5507.55*h);d+=25*r(1.32+5223.69*h);d+=18*r(1.42+1577.34*h);d+=10*r(5.91+10977.08*h);d+=9*r(1.42+6275.96*h);d+=9*r(.27+5486.78*h);w=4359*r(5.7846+6283.0758*h);w+=124*r(5.579+12566.152*
            h);w+=12*r(3.14);w+=9*r(3.63+77713.77*h);w+=6*r(1.87+5573.14*h);w+=3*r(5.47+18849.23*h);x=145*r(4.273+6283.076*h);x+=7*r(3.92+12566.15*h);r=4*r(2.56+6283.08*h);k=a(g+e-.005691611/((p+d*h+w*k+x*l+r*m)/1E8));h=a(Math.atan2(b(k)*c(u)-Math.tan(f.DEGREES_TO_RADIANS*z)*b(u),c(k))/t);k=Math.asin(b(z)*c(u)+c(z)*b(u)*b(k))/t;h=a(q-h);return{latitude:k,longitude:360-h}}});
define("src/layer/AtmosphereLayer","../error/ArgumentError ../shaders/GroundProgram ../util/ImageSource ../layer/Layer ../util/Logger ../geom/Matrix ../geom/Matrix3 ../geom/Sector ../shaders/SkyProgram ../util/sun ../geom/Vec3".split(" "),function(f,b,c,a,d,e,g,h,k,l,m){f=function(d){a.call(this,"Atmosphere");this._activeTexture=null;this.imageSource=d||"../images/dnb_land_ocean_ice_2012.png";this._lastSunRequest=0;this._lightDirection=new m(0,0,0);this.pickEnabled=!1;this._fullSphereSector=h.FULL_SPHERE;
    this._scratchVector=new m(0,0,0);this.skyData={};this._skyHeight=this._skyWidth=128;this._skyTriStrip=this._skyPoints=null;this._texMatrix=g.fromIdentity();this._mvpMatrix=e.fromIdentity()};f.prototype=Object.create(a.prototype);Object.defineProperties(f.prototype,{skyWidth:{get:function(){return this._skyWidth},set:function(a){this._skyWidth=a}},skyHeight:{get:function(){return this._skyHeight},set:function(a){this._skyHeight=a}},skyPoints:{get:function(){return this._skyPoints},set:function(a){this._skyPoints=
    a}},skyTriStrip:{get:function(){return this._skyTriStrip},set:function(a){this._skyTriStrip=a}}});f.prototype.doRender=function(a){this.computeLightDirection(a);this.drawSky(a);this.drawGround(a)};f.prototype.applySkyVertices=function(a){var d=a.currentGlContext,b=a.currentProgram,c=this.skyData,e;c.verticesVboCacheKey||(c.verticesVboCacheKey=a.gpuResourceCache.generateCacheKey());e=a.gpuResourceCache.resourceForKey(c.verticesVboCacheKey);e||(e=d.createBuffer(),a.gpuResourceCache.putResource(c.verticesVboCacheKey,
    e,4*this.skyPoints.length),c.refreshVertexBuffer=!0);d.bindBuffer(d.ARRAY_BUFFER,e);c.refreshVertexBuffer&&(d.bufferData(d.ARRAY_BUFFER,new Float32Array(this.skyPoints),d.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),c.refreshVertexBuffer=!1);d.vertexAttribPointer(b.vertexPointLocation,3,d.FLOAT,!1,0,0);d.enableVertexAttribArray(b.vertexPointLocation)};f.prototype.applySkyIndices=function(a){var d=a.currentGlContext,b=this.skyData,c;b.indicesVboCacheKey||(b.indicesVboCacheKey=a.gpuResourceCache.generateCacheKey());
    c=a.gpuResourceCache.resourceForKey(b.indicesVboCacheKey);c||(c=d.createBuffer(),a.gpuResourceCache.putResource(b.indicesVboCacheKey,c,2*this._skyTriStrip.length),b.refreshIndicesBuffer=!0);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c);b.refreshIndicesBuffer&&(d.bufferData(d.ELEMENT_ARRAY_BUFFER,new Uint16Array(this._skyTriStrip),d.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),b.refreshIndicesBuffer=!1)};f.prototype.drawSky=function(a){var d=a.currentGlContext,b=a.findAndBindProgram(k);b.loadGlobeRadius(d,
    a.globe.equatorialRadius);b.loadEyePoint(d,a.navigatorState.eyePoint);b.loadVertexOrigin(d,m.ZERO);b.loadModelviewProjection(d,a.navigatorState.modelviewProjection);b.loadFragMode(d,b.FRAGMODE_SKY);b.loadLightDirection(d,this._lightDirection);b.setScale(d);d.depthMask(!1);d.frontFace(d.CW);this.setSkyPoints(a,b.getAltitude());this.setSkyTrianglesIndices();this.applySkyVertices(a);this.applySkyIndices(a);d.drawElements(d.TRIANGLE_STRIP,this._skyTriStrip.length,d.UNSIGNED_SHORT,0);d.depthMask(!0);d.frontFace(d.CCW)};
    f.prototype.drawGround=function(a){var d=a.currentGlContext,c=a.findAndBindProgram(b);c.loadGlobeRadius(d,a.globe.equatorialRadius);c.loadEyePoint(d,a.navigatorState.eyePoint);c.loadLightDirection(d,this._lightDirection);c.setScale(d);var e=a.terrain,g;this.imageSource&&(this._activeTexture=a.gpuResourceCache.resourceForKey(this.imageSource),this._activeTexture||(this._activeTexture=a.gpuResourceCache.retrieveTexture(d,this.imageSource)),g=this._activeTexture&&this._activeTexture.bind(a));for(var h=
        0,l=e.tessellator.currentTiles.length;h<l;h++){var k=e.tessellator.currentTiles.tileArray[h],f=k.referencePoint;c.loadVertexOrigin(d,f);this._mvpMatrix.copy(a.navigatorState.modelviewProjection);this._mvpMatrix.multiplyByTranslation(f[0],f[1],f[2]);c.loadModelviewProjection(d,this._mvpMatrix);g&&(this._texMatrix.setToUnitYFlip(),this._texMatrix.multiplyByTileTransform(k.sector,this._fullSphereSector),c.loadTexMatrix(d,this._texMatrix));d.enableVertexAttribArray(c.vertexPointLocation);c.loadFragMode(d,
        c.FRAGMODE_GROUND_SECONDARY);d.blendFunc(d.DST_COLOR,d.ZERO);e.tessellator.beginRendering(a);e.beginRenderingTile(a,k);e.renderTile(a,k);e.endRenderingTile(a,k);e.tessellator.endRendering(a);c.loadFragMode(d,g?c.FRAGMODE_GROUND_PRIMARY_TEX_BLEND:c.FRAGMODE_GROUND_PRIMARY);d.blendFunc(d.ONE,d.ONE);e.tessellator.beginRendering(a);e.beginRenderingTile(a,k);e.renderTile(a,k);e.endRenderingTile(a,k);e.tessellator.endRendering(a)}d.blendFunc(d.ONE,d.ONE_MINUS_SRC_ALPHA);d.disableVertexAttribArray(c.vertexPointLocation)};
    f.prototype.setSkyPoints=function(a,d){if(null==this._skyPoints){var b=Array(this.skyWidth*this.skyHeight).fill(d);this._skyPoints=new Float64Array(3*b.length);a.globe.computePointsForGrid(this._fullSphereSector,this.skyHeight,this.skyWidth,b,m.ZERO,this._skyPoints)}};f.prototype.setSkyTrianglesIndices=function(){null==this._skyTriStrip&&(this._skyTriStrip=this.assembleTriStripIndices(this.skyWidth,this.skyHeight))};f.prototype.assembleTriStripIndices=function(a,d){for(var b=[],c=[],e=0,g=0;g<a-1;g++){for(var h=
        0;h<d;h++)e=h+g*d,c[0]=e+d,c[1]=e,b.push(c[0]),b.push(c[1]);g<a-2&&(c[0]=e,c[1]=(g+2)*d,b.push(c[0]),b.push(c[1]))}return b};f.prototype.computeLightDirection=function(a){var d=new Date,b=d.getTime();3E5<b-this._lastSunRequest&&(d=l(d),this._lastSunRequest=b,a.globe.computePointFromLocation(d.latitude,d.longitude,this._scratchVector),this._lightDirection=this._scratchVector.normalize())};return f});
define("src/shaders/BasicProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(f,b,c,a){b=function(a){c.call(this,a,"attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nvoid main() {gl_Position = mvpMatrix * vertexPoint;}","precision mediump float;\nuniform vec4 color;\nvoid main() {gl_FragColor = color;}");this.vertexPointLocation=this.attributeLocation(a,"vertexPoint");this.mvpMatrixLocation=this.uniformLocation(a,"mvpMatrix");this.colorLocation=
    this.uniformLocation(a,"color")};b.key="WorldWindGpuBasicProgram";b.prototype=Object.create(c.prototype);b.prototype.loadModelviewProjection=function(d,b){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"BasicProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(d,b,this.mvpMatrixLocation)};b.prototype.loadColor=function(d,b){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"BasicProgram","loadColor","missingColor"));this.loadUniformColor(d,b,this.colorLocation)};b.prototype.loadColorComponents=
    function(a,b,c,h,k){this.loadUniformColorComponents(a,b,c,h,k,this.colorLocation)};return b});
define("src/util/BasicTimeSequence",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a){if(!a&&2>a.length)throw new f(b.logMessage(b.LEVEL_SEVERE,"BasicTimeSequence","constructor","missingDates"));this.dates=a;this.currentIndex=0;this.currentTime=a[0]};Object.defineProperties(c.prototype,{scaleForCurrentTime:{get:function(){return this.currentTime?this.currentIndex/this.dates.length:1}}});c.prototype.next=function(){if(this.currentIndex>=this.dates.length-1)return null;this.currentIndex++;
    return this.currentTime=this.dates[this.currentIndex]};c.prototype.previous=function(){if(0>=this.currentIndex)return null;this.currentIndex--;return this.currentTime=this.dates[this.currentIndex]};c.prototype.reset=function(){this.currentIndex=-1;this.currentTime=null};c.prototype.getTimeForScale=function(a){this.currentIndex=0>=a?0:1<=a?this.dates.length-1:Math.floor(this.dates.length*a);return this.currentTime=this.dates[this.currentIndex]};return c});
define("src/util/AbsentResourceList",[],function(){var f=function(b,c){this.maxTrys=b;this.minCheckInterval=c;this.tryAgainInterval=6E4;this.possiblyAbsent={}};f.prototype.isResourceAbsent=function(b){var c=this.possiblyAbsent[b];if(!c)return!1;if(c.permanent)return!0;var a=Date.now()-c.timeOfLastMark;return a>this.tryAgainInterval?(delete this.possiblyAbsent[b],!1):a<this.minCheckInterval||c.numTrys>this.maxTrys};f.prototype.markResourceAbsent=function(b){var c=this.possiblyAbsent[b];c||(c={timeOfLastMark:Date.now(),
    numTrys:0},this.possiblyAbsent[b]=c);c.numTrys+=1;c.timeOfLastMark=Date.now()};f.prototype.markResourceAbsentPermanently=function(b){var c=this.possiblyAbsent[b];c||(c={timeOfLastMark:Date.now(),numTrys:0},this.possiblyAbsent[b]=c);c.numTrys+=1;c.timeOfLastMark=Date.now();c.permanent=!0};f.prototype.unmarkResourceAbsent=function(b){this.possiblyAbsent[b]&&delete this.possiblyAbsent[b]};return f});
define("src/geom/Frustum",["../error/ArgumentError","../geom/Matrix","../geom/Plane","../util/Logger"],function(f,b,c,a){var d=function(d,b,c,k,l,m){if(!(d&&b&&c&&k&&l&&m))throw new f(a.logMessage(a.LEVEL_SEVERE,"Frustum","constructor","missingPlane"));this._left=d;this._right=b;this._bottom=c;this._top=k;this._near=l;this._far=m;this._planes=[this._left,this._right,this._top,this._bottom,this._near,this._far]};Object.defineProperties(d.prototype,{left:{get:function(){return this._left}},right:{get:function(){return this._right}},
    bottom:{get:function(){return this._bottom}},top:{get:function(){return this._top}},near:{get:function(){return this._near}},far:{get:function(){return this._far}}});d.prototype.transformByMatrix=function(d){if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"Frustum","transformByMatrix","missingMatrix"));this._left.transformByMatrix(d);this._right.transformByMatrix(d);this._bottom.transformByMatrix(d);this._top.transformByMatrix(d);this._near.transformByMatrix(d);this._far.transformByMatrix(d);return this};
    d.prototype.normalize=function(){this._left.normalize();this._right.normalize();this._bottom.normalize();this._top.normalize();this._near.normalize();this._far.normalize();return this};d.unitFrustum=function(){return new d(new c(1,0,0,1),new c(-1,0,0,1),new c(0,1,1,1),new c(0,-1,0,1),new c(0,0,-1,1),new c(0,0,1,1))};d.fromProjectionMatrix=function(b){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"Frustum","fromProjectionMatrix","missingMatrix"));var g,h,k,l,m,p,q,t,r,u;g=b[12]+b[0];h=b[13]+b[1];k=
        b[14]+b[2];l=b[15]+b[3];m=Math.sqrt(g*g+h*h+k*k);p=new c(g/m,h/m,k/m,l/m);g=b[12]-b[0];h=b[13]-b[1];k=b[14]-b[2];l=b[15]-b[3];m=Math.sqrt(g*g+h*h+k*k);q=new c(g/m,h/m,k/m,l/m);g=b[12]+b[4];h=b[13]+b[5];k=b[14]+b[6];l=b[15]+b[7];m=Math.sqrt(g*g+h*h+k*k);r=new c(g/m,h/m,k/m,l/m);g=b[12]-b[4];h=b[13]-b[5];k=b[14]-b[6];l=b[15]-b[7];m=Math.sqrt(g*g+h*h+k*k);t=new c(g/m,h/m,k/m,l/m);g=b[12]+b[8];h=b[13]+b[9];k=b[14]+b[10];l=b[15]+b[11];m=Math.sqrt(g*g+h*h+k*k);u=new c(g/m,h/m,k/m,l/m);g=b[12]-b[8];h=b[13]-
        b[9];k=b[14]-b[10];l=b[15]-b[11];m=Math.sqrt(g*g+h*h+k*k);b=new c(g/m,h/m,k/m,l/m);return new d(p,q,r,t,u,b)};d.prototype.containsPoint=function(d){if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"Frustum","containsPoint","missingPoint"));return 0>=this._far.dot(d)||0>=this._left.dot(d)||0>=this._right.dot(d)||0>=this._top.dot(d)||0>=this._bottom.dot(d)||0>=this._near.dot(d)?!1:!0};d.prototype.intersectsSegment=function(d,b){if(!d||!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"Frustum","containsPoint",
        "missingPoint"));if(this.containsPoint(d)||this.containsPoint(b))return!0;if(d.equals(b))return!1;for(var c=0,k=this._planes.length;c<k&&!(0>this._planes[c].onSameSide(d,b));c++)if(null!=this._planes[c].clip(d,b))return!0;return!1};return d});define("src/error/NotYetImplementedError",["../error/AbstractError"],function(f){var b=function(b){f.call(this,"NotYetImplementedError",b);try{throw Error();}catch(a){b=a.stack}this.stack=b};b.prototype=Object.create(f.prototype);return b});
define("src/util/WWUtil",["../error/ArgumentError","../geom/Line","../util/Logger","../geom/Rectangle","../geom/Vec3"],function(f,b,c,a,d){var e={latLonRegex:/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/,suffixForMimeType:function(a){return"image/png"===a?"png":"image/jpeg"===a?"jpg":"application/bil16"===a||"application/bil32"===a?"bil":null},currentUrlSansFilePart:function(){for(var a=window.location.protocol,d=window.location.host,b=window.location.pathname.split("/"),c="",e=0,f=b.length;e<f-1;e++)0<
b[e].length&&(c=c+"/"+b[e]);return a+"//"+d+c},worldwindlibLocation:function(){for(var a=document.getElementsByTagName("script"),d=0;d<a.length;d++){var b=a[d].src.indexOf("/worldwindlib.");if(0<=b)return a[d].src.substring(0,b)+"/"}return null},urlPath:function(a){if(!a)return"";a=a.split("/");for(var d="",b=0,c=a.length;b<c;b++){var e=a[b];e&&0!==e.length&&-1==e.indexOf(":")&&"."!==e&&".."!==e&&"null"!==e&&"undefined"!==e&&(0!==d.length&&(d+="/"),d+=e)}return d},fillArray:function(a,d){if(a)for(var b=
    0,c=a.length;b<c;b++)a[b]=d},multiplyArray:function(a,d){if(a)for(var b=0,c=a.length;b<c;b++)a[b]*=d},jsonpCounter:0,jsonp:function(a,d,b){var c="gov_nasa_worldwind_jsonp_"+e.jsonpCounter++;window[c]=function(a){delete window[c];b(a)};a+=-1===a.indexOf("?")?"?":"&";a+=d+"="+c;var f=document.createElement("script");f.async=!0;f.src=a;var p=document.getElementsByTagName("head")[0];d=function(){f.onload=void 0;f.onerror=void 0;p.removeChild(f)};f.onload=d;f.onerror=d;p.appendChild(f)},arrayEquals:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                d){return a.length==d.length&&a.every(function(a,b){return a===d[b]||a.equals&&a.equals(d[b])})},transformToBoolean:function(a){return 0==a||"0"==a||"false"==a?!1:!!a},clone:function(a){var d={},b,c=Object.keys(a);for(b=0;b<c.length;b++)d[c[b]]=a[c[b]];return d},guid:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},date:function(a){return new Date(a)}};return e});
define("src/geom/BoundingBox","../error/ArgumentError ../shaders/BasicProgram ../geom/Frustum ../util/Logger ../geom/Matrix ../error/NotYetImplementedError ../geom/Plane ../geom/Sector ../geom/Vec3 ../util/WWMath ../util/WWUtil".split(" "),function(f,b,c,a,d,e,g,h,k,l,m){var p=function(){this.center=new k(0,0,0);this.bottomCenter=new k(-.5,0,0);this.topCenter=new k(.5,0,0);this.r=new k(1,0,0);this.s=new k(0,1,0);this.t=new k(0,0,1);this.radius=Math.sqrt(3);this.tmp1=new k(0,0,0);this.tmp2=new k(0,
    0,0);this.tmp3=new k(0,0,0);this.scratchElevations=new Float64Array(9);this.scratchPoints=new Float64Array(3*this.scratchElevations.length)};p.scratchMatrix=d.fromIdentity();p.prototype.setToPoints=function(b){if(!b||3>b.length)throw new f(a.logMessage(a.LEVEL_SEVERE,"BoundingBox","setToPoints","missingArray"));var c=+Number.MAX_VALUE,e=-Number.MAX_VALUE,g=+Number.MAX_VALUE,h=-Number.MAX_VALUE,l=+Number.MAX_VALUE,m=-Number.MAX_VALUE,p=this.r,v=this.s,F=this.t,G=new k(0,0,0),D,y,H;d.principalAxesFromPoints(b,
    p,v,F);y=0;for(H=b.length/3;y<H;y++)G[0]=b[3*y],G[1]=b[3*y+1],G[2]=b[3*y+2],D=G.dot(p),c>D&&(c=D),e<D&&(e=D),D=G.dot(v),g>D&&(g=D),h<D&&(h=D),D=G.dot(F),l>D&&(l=D),m<D&&(m=D);e===c&&(e=c+1);h===g&&(h=g+1);m===l&&(m=l+1);b=e-c;G=h-g;y=m-l;c=e+c;g=h+g;D=m+l;l=.5*p[0]*b;m=.5*p[1]*b;h=.5*p[2]*b;e=.5*(p[0]*c+v[0]*g+F[0]*D);H=.5*(p[1]*c+v[1]*g+F[1]*D);g=.5*(p[2]*c+v[2]*g+F[2]*D);this.center[0]=e;this.center[1]=H;this.center[2]=g;this.topCenter[0]=e+l;this.topCenter[1]=H+m;this.topCenter[2]=g+h;this.bottomCenter[0]=
    e-l;this.bottomCenter[1]=H-m;this.bottomCenter[2]=g-h;p.multiply(b);v.multiply(G);F.multiply(y);this.radius=.5*Math.sqrt(b*b+G*G+y*y);return this};p.prototype.setToSector=function(d,b,c,e){if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"BoundingBox","setToSector","missingSector"));if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"BoundingBox","setToSector","missingGlobe"));var g=this.scratchElevations,h=this.scratchPoints;m.fillArray(g,e);g[0]=g[2]=g[6]=g[8]=c;b.computePointsForGrid(d,3,3,g,k.ZERO,h);
    this.tmp1.set(h[12],h[13],h[14]);l.localCoordinateAxesAtPoint(this.tmp1,b,this.r,this.s,this.t);g=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];e=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];c=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];d=0;for(b=h.length;d<b;d+=3)this.tmp1.set(h[d],h[d+1],h[d+2]),this.adjustExtremes(this.r,g,this.s,e,this.t,c,this.tmp1);g[1]-g[0]<e[1]-e[0]&&this.swapAxes(this.r,g,this.s,e);e[1]-e[0]<c[1]-c[0]&&this.swapAxes(this.s,e,this.t,c);g[1]-g[0]<e[1]-
    e[0]&&this.swapAxes(this.r,g,this.s,e);h=g[1]-g[0];d=e[1]-e[0];b=c[1]-c[0];var g=g[1]+g[0],p=e[1]+e[0],B=c[1]+c[0];c=.5*(this.r[0]*g+this.s[0]*p+this.t[0]*B);e=.5*(this.r[1]*g+this.s[1]*p+this.t[1]*B);var g=.5*(this.r[2]*g+this.s[2]*p+this.t[2]*B),p=.5*this.r[0]*h,B=.5*this.r[1]*h,v=.5*this.r[2]*h;this.center.set(c,e,g);this.topCenter.set(c+p,e+B,g+v);this.bottomCenter.set(c-p,e-B,g-v);this.r.multiply(h);this.s.multiply(d);this.t.multiply(b);this.radius=.5*Math.sqrt(h*h+d*d+b*b);return this};p.prototype.translate=
    function(d){if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"BoundingBox","translate","missingVector"));this.bottomCenter.add(d);this.topCenter.add(d);this.center.add(d);return this};p.prototype.distanceTo=function(d){if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"BoundingBox","distanceTo","missingPoint"));d=this.center.distanceTo(d)-this.radius;return 0<=d?d:-d};p.prototype.effectiveRadius=function(d){if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"BoundingBox","effectiveRadius","missingPlane"));d=
    d.normal;return.5*(l.fabs(this.r.dot(d))+l.fabs(this.s.dot(d))+l.fabs(this.t.dot(d)))};p.prototype.intersectsFrustum=function(d){if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"BoundingBox","intersectsFrustum","missingFrustum"));this.tmp1.copy(this.bottomCenter);this.tmp2.copy(this.topCenter);return 0>this.intersectionPoint(d.near)||0>this.intersectionPoint(d.far)||0>this.intersectionPoint(d.left)||0>this.intersectionPoint(d.right)||0>this.intersectionPoint(d.top)||0>this.intersectionPoint(d.bottom)?
    !1:!0};p.prototype.intersectionPoint=function(a){var d=a.normal,d=.5*(Math.abs(this.s.dot(d))+Math.abs(this.t.dot(d)));return this.intersectsAt(a,d,this.tmp1,this.tmp2)};p.prototype.intersectsAt=function(a,d,b,c){var e=a.dot(b),g=e<=-d,h=a.dot(c)<=-d;if(g&&h)return-1;if(g==h)return 0;this.tmp3.copy(b);this.tmp3.subtract(c);a=(d+e)/a.normal.dot(this.tmp3);this.tmp3.copy(c);this.tmp3.subtract(b);this.tmp3.multiply(a);this.tmp3.add(b);g?b.copy(this.tmp3):c.copy(this.tmp3);return a};p.prototype.adjustExtremes=
    function(a,d,b,c,e,g,h){a=h.dot(a);d[0]>a&&(d[0]=a);d[1]<a&&(d[1]=a);d=h.dot(b);c[0]>d&&(c[0]=d);c[1]<d&&(c[1]=d);c=h.dot(e);g[0]>c&&(g[0]=c);g[1]<c&&(g[1]=c)};p.prototype.swapAxes=function(a,d,b,c){a.swap(b);a=d[0];d[0]=c[0];c[0]=a;a=d[1];d[1]=c[1];c[1]=a};p.prototype.render=function(a){var d=a.currentGlContext,c=p.scratchMatrix,e=a.findAndBindProgram(b);try{c.copy(a.navigatorState.modelviewProjection),c.multiply(this.r[0],this.s[0],this.t[0],this.center[0],this.r[1],this.s[1],this.t[1],this.center[1],
    this.r[2],this.s[2],this.t[2],this.center[2],0,0,0,1),c.multiplyByTranslation(-.5,-.5,-.5),e.loadModelviewProjection(d,c),d.disable(d.CULL_FACE),d.bindBuffer(d.ARRAY_BUFFER,a.unitCubeBuffer()),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,a.unitCubeElements()),d.enableVertexAttribArray(e.vertexPointLocation),d.vertexAttribPointer(e.vertexPointLocation,3,d.FLOAT,!1,0,0),e.loadColorComponents(d,0,1,0,.6),d.drawElements(d.LINES,24,d.UNSIGNED_SHORT,72),e.loadColorComponents(d,1,1,1,.3),d.drawElements(d.TRIANGLES,
    36,d.UNSIGNED_SHORT,0)}finally{d.enable(d.CULL_FACE),d.bindBuffer(d.ARRAY_BUFFER,null),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,null)}};return p});
define("src/util/Tile","../error/ArgumentError ../geom/BoundingBox ../util/Logger ../geom/Sector ../geom/Vec3 ../util/WWUtil".split(" "),function(f,b,c,a,d,e){var g=function(a,d,b,e){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","constructor","missingSector"));if(!d)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","constructor","The specified level is null or undefined."));if(0>b||0>e)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","constructor","The specified row or column is less than zero."));
    this.sector=a;this.level=d;this.row=b;this.column=e;this.tileWidth=d.tileWidth;this.tileHeight=d.tileHeight;this.texelSize=d.texelSize;this.tileKey=d.levelNumber.toString()+"."+b.toString()+"."+e.toString();this.referencePoint=this.extent=null;this.opacity=1;this.updateGlobeStateKey=this.updateVerticalExaggeration=this.updateTimestamp=this.sampleElevations=this.samplePoints=null};g.prototype.isEqual=function(a){return a&&a.tileKey?this.tileKey==a.tileKey:!1};g.prototype.size=function(){return 828};
    g.prototype.distanceTo=function(a){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","distanceTo","missingVector"));var d=a[0],b=a[1];a=a[2];for(var e,g,q,t=this.samplePoints,r=Number.POSITIVE_INFINITY,u=0,w=t.length;u<w;u+=3)e=d-t[u],g=b-t[u+1],q=a-t[u+2],r=Math.min(r,e*e+g*g+q*q);return Math.sqrt(r)};g.prototype.subdivide=function(d,b){if(!d)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","subdivide","The specified level is null or undefined."));if(!b)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile",
        "subdivide","The specified tile factory is null or undefined."));var e=this.sector.minLatitude,g=this.sector.maxLatitude,p=this.sector.centroidLatitude(),q=this.sector.minLongitude,t=this.sector.maxLongitude,r=this.sector.centroidLongitude(),u,w,x,A=[];u=2*this.row;w=2*this.column;x=new a(e,p,q,r);A.push(b.createTile(x,d,u,w));u=2*this.row;w=2*this.column+1;x=new a(e,p,r,t);A.push(b.createTile(x,d,u,w));u=2*this.row+1;w=2*this.column;x=new a(p,g,q,r);A.push(b.createTile(x,d,u,w));u=2*this.row+1;w=
        2*this.column+1;x=new a(p,g,r,t);A.push(b.createTile(x,d,u,w));return A};g.prototype.subdivideToCache=function(a,d,b){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","subdivideToCache","The specified level is null or undefined."));if(!d)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile factory is null or undefined."));var e=b?b.entryForKey(this.tileKey):null;e||(e=this.subdivide(a,d))&&b&&b.putEntry(this.tileKey,e,4*e[0].size());return e};g.prototype.mustSubdivide=
        function(a,d){var b=a.globe.equatorialRadius*this.texelSize,c=this.distanceTo(a.navigatorState.eyePoint),c=a.navigatorState.pixelSizeAtDistance(c);return b>Math.max(d*c,.5)};g.prototype.update=function(a){var d=a.globe.elevationTimestamp(),b=a.verticalExaggeration,c=a.globeStateKey;if(this.updateTimestamp!=d||this.updateVerticalExaggeration!=b||this.updateGlobeStateKey!=c)this.doUpdate(a),a.frameStatistics.incrementTileUpdateCount(1),this.updateTimestamp=d,this.updateVerticalExaggeration=b,this.updateGlobeStateKey=
        c};g.prototype.doUpdate=function(a){var c=a.globe,g=a.verticalExaggeration,f=c.minAndMaxElevationsForSector(this.sector);a=f?f[0]*g:0;g=f?f[1]*g:0;a==g&&(a=g+10);this.extent||(this.extent=new b);this.extent.setToSector(this.sector,c,a,g);this.samplePoints||(this.sampleElevations=new Float64Array(9),this.samplePoints=new Float64Array(3*this.sampleElevations.length));e.fillArray(this.sampleElevations,.5*(a+g));c.computePointsForGrid(this.sector,3,3,this.sampleElevations,d.ZERO,this.samplePoints);this.referencePoint||
    (this.referencePoint=new d(0,0,0));c.computePointFromPosition(this.sector.centroidLatitude(),this.sector.centroidLongitude(),0,this.referencePoint)};g.computeRow=function(a,d){var b=Math.floor((d+90)/a);90==d&&--b;return b};g.computeColumn=function(a,d){var b=Math.floor((d+180)/a);180==d&&--b;return b};g.computeLastRow=function(a,d){var b=Math.ceil((d+90)/a-1);d+90<a&&(b=0);return b};g.computeLastColumn=function(a,d){var b=Math.ceil((d+180)/a-1);d+180<a&&(b=0);return b};g.computeSector=function(d,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        b,e){if(!d)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","computeSector","missingLevel"));if(0>b||0>e)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","computeSector","The specified row or column is less than zero."));var g=d.tileDelta.latitude;d=d.tileDelta.longitude;b=-90+b*g;e=-180+e*d;return new a(b,b+g,e,e+d)};g.createTilesForLevel=function(d,b,e){if(!d)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","createTilesForLevel","missingLevel"));if(!b)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","createTilesForLevel",
        "The specified tile factory is null or undefined"));if(!e)throw new f(c.logMessage(c.LEVEL_SEVERE,"Tile","createTilesForLevel","missingResult"));for(var m=d.tileDelta.latitude,p=d.tileDelta.longitude,q=d.sector,t=g.computeRow(m,q.minLatitude),r=g.computeRow(m,q.maxLatitude),u=g.computeColumn(p,q.minLongitude),q=g.computeColumn(p,q.maxLongitude),w=-180+u*p,x=-90+t*m,A,B,v=t;v<=r;v+=1){t=x+m;A=w;for(var F=u;F<=q;F+=1)B=A+p,A=new a(x,t,A,B),A=b.createTile(A,d,v,F),e.push(A),A=B;x=t}};return g});
define("src/render/TextureTile",["../error/ArgumentError","../util/Logger","../util/Tile"],function(f,b,c){f=function(a,d,b,g){c.call(this,a,d,b,g);this.gpuCacheKey=null};f.prototype=Object.create(c.prototype);f.prototype.size=function(){return c.prototype.size.call(this)};f.prototype.bind=function(a){var d=a.gpuResourceCache.resourceForKey(this.gpuCacheKey);return d?d.bind(a):!1};f.prototype.applyInternalTransform=function(a,d){};return f});
define("src/render/ImageTile",["../error/ArgumentError","../util/Logger","../render/TextureTile","../util/Tile"],function(f,b,c,a){a=function(a,e,g,h,k){if(!k||1>k.length)throw new f(b.logMessage(b.LEVEL_SEVERE,"ImageTile","constructor","The specified image path is null, undefined or zero length."));c.call(this,a,e,g,h);this.imagePath=k;this.fallbackTile=null;this.gpuCacheKey=k};a.prototype=Object.create(c.prototype);a.prototype.size=function(){return this.__proto__.__proto__.size.call(this)+this.imagePath.length+
    8};a.prototype.bind=function(a){return this.__proto__.__proto__.bind.call(this,a)?!0:this.fallbackTile?this.fallbackTile.bind(a):!1};a.prototype.applyInternalTransform=function(a,b){this.fallbackTile&&!a.gpuResourceCache.resourceForKey(this.imagePath)&&this.applyFallbackTransform(b)};a.prototype.applyFallbackTransform=function(a){if(!(0>=this.level.levelNumber-this.fallbackTile.level.levelNumber)){var b=this.fallbackTile.sector.deltaLatitude(),c=this.fallbackTile.sector.deltaLongitude(),h=this.sector.deltaLongitude()/
    c,k=this.sector.deltaLatitude()/b;a.multiply(h,0,0,(this.sector.minLongitude-this.fallbackTile.sector.minLongitude)/c,0,k,0,(this.sector.minLatitude-this.fallbackTile.sector.minLatitude)/b,0,0,1,0,0,0,0,1)}};return a});
define("src/util/Level",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger"],function(f,b,c,a){c=function(d,c,g){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"Level","constructor","The specified tile delta is null or undefined"));if(!g)throw new b(a.logMessage(a.LEVEL_SEVERE,"Level","constructor","The specified parent level set is null or undefined"));this.levelNumber=d;this.tileDelta=c;this.parent=g;this.texelSize=c.latitude*f.DEGREES_TO_RADIANS/g.tileHeight;this.tileWidth=
    g.tileWidth;this.tileHeight=g.tileHeight;this.sector=g.sector};c.prototype.isFirstLevel=function(){return this.parent.firstLevel()==this};c.prototype.isLastLevel=function(){return this.parent.lastLevel()==this};c.prototype.previousLevel=function(){return this.parent.level(this.levelNumber-1)};c.prototype.nextLevel=function(){return this.parent.level(this.levelNumber+1)};c.prototype.compare=function(d){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"Level","compare","The specified level is null or undefined"));
    return this.levelNumber<d.levelNumber?-1:this.levelNumber>d.levelNumber?1:0};return c});
define("src/util/LevelSet",["../error/ArgumentError","../util/Level","../geom/Location","../util/Logger"],function(f,b,c,a){var d=function(d,g,h,k,l){if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"LevelSet","constructor","missingSector"));if(!g)throw new f(a.logMessage(a.LEVEL_SEVERE,"LevelSet","constructor","The specified level zero delta is null or undefined"));if(0>=g.latitude||0>=g.longitude)throw new f(a.logMessage(a.LEVEL_SEVERE,"LevelSet","constructor","The specified level zero delta is less than or equal to zero."));
    if(1>h)throw new f(a.logMessage(a.LEVEL_SEVERE,"LevelSet","constructor","The specified number of levels is less than one."));if(1>k||1>l)throw new f(a.logMessage(a.LEVEL_SEVERE,"LevelSet","constructor","The specified tile width or tile height is less than one."));this.sector=d;this.levelZeroDelta=g;this.numLevels=h;this.tileWidth=k;this.tileHeight=l;this.levels=[];for(d=0;d<h;d+=1)k=Math.pow(2,d),k=new c(g.latitude/k,g.longitude/k),k=new b(d,k,this),this.levels[d]=k};d.prototype.level=function(a){return 0>
a||a>=this.levels.length?null:this.levels[a]};d.prototype.levelForTexelSize=function(a){var d=this.lastLevel();if(d.texelSize>=a)return d;for(var b=0,c=this.levels.length;b<c;b+=1){var l=this.levels[b];if(l.texelSize<=a)return l}return d};d.prototype.firstLevel=function(){return this.levels[0]};d.prototype.lastLevel=function(){return this.levels[this.levels.length-1]};return d});
define("src/cache/MemoryCache",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a,d){if(!a||1>a)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","constructor","The specified capacity is undefined, zero or negative"));if(!d||d>=a||0>d)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","constructor","The specified low-water value is undefined, greater than or equal to the capacity, or less than 1"));this._capacity=a;this._lowWater=d;this.usedCapacity=0;this.freeCapacity=
    a;this.entries={};this.listeners=[]};Object.defineProperties(c.prototype,{capacity:{get:function(){return this._capacity},set:function(a){if(!a||1>a)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","capacity","Specified cache capacity is undefined, 0 or negative."));var d=this._capacity;this._capacity=a;this._capacity<=this.lowWater&&(this._lowWater=.85*this._capacity);this._capacity<d&&this.makeSpace(0)}},lowWater:{get:function(){return this._lowWater},set:function(a){if(!a||a>=this._capacity||
    0>a)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","lowWater","Specified cache low-water value is undefined, negative or not less than the current capacity."));this._lowWater=a}}});c.prototype.entryForKey=function(a){if(!a)return null;a=this.entries[a];if(!a)return null;a.lastUsed=Date.now();return a.entry};c.prototype.putEntry=function(a,d,c){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","putEntry","missingKey."));if(!d)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","putEntry",
    "missingEntry."));if(1>c)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","putEntry","The specified entry size is less than 1."));this.entries[a]&&this.removeEntry(a);this.usedCapacity+c>this._capacity&&this.makeSpace(c);this.usedCapacity+=c;this.freeCapacity=this._capacity-this.usedCapacity;d={key:a,entry:d,size:c,lastUsed:Date.now()};this.entries[a]=d};c.prototype.clear=function(a){if(a)for(var d in this.entries)this.entries.hasOwnProperty(d)&&this.removeCacheEntry(d);this.entries={};this.freeCapacity=
    this._capacity;this.usedCapacity=0};c.prototype.removeEntry=function(a){a&&(a=this.entries[a])&&this.removeCacheEntry(a)};c.prototype.removeCacheEntry=function(a){delete this.entries[a.key];this.usedCapacity-=a.size;this.freeCapacity=this._capacity-this.usedCapacity;for(var d=0,b=this.listeners.length;d<b;d++)try{this.listeners[d].entryRemoved(a.key,a.entry)}catch(c){this.listeners[d].removalError(c,a.key,a.entry)}};c.prototype.containsKey=function(a){return a&&this.entries[a]};c.prototype.addCacheListener=
    function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","addCacheListener","missingListener"));if("function"!=typeof a.entryRemoved||"function"!=typeof a.removalError)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","addCacheListener","The specified listener does not implement the required functions."));this.listeners.push(a)};c.prototype.removeCacheListener=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"MemoryCache","removeCacheListener","missingListener"));a=this.listeners.indexOf(a);
    -1<a&&this.listeners.splice(a,1)};c.prototype.makeSpace=function(a){var d=[],b;for(b in this.entries)this.entries.hasOwnProperty(b)&&d.push(this.entries[b]);d.sort(function(a,d){return a.lastUsed-d.lastUsed});b=0;for(var c=d.length;b<c;b++)if(this.usedCapacity>this._lowWater||this.freeCapacity<a)this.removeCacheEntry(d[b]);else break};return c});
define("src/layer/TiledImageLayer","../util/AbsentResourceList ../error/ArgumentError ../render/ImageTile ../layer/Layer ../util/LevelSet ../util/Logger ../cache/MemoryCache ../render/Texture ../util/Tile ../util/WWUtil".split(" "),function(f,b,c,a,d,e,g,h,k,l){var m=function(c,h,l,k,m,w,x){if(!c)throw new b(e.logMessage(e.LEVEL_SEVERE,"TiledImageLayer","constructor","missingSector"));if(!h)throw new b(e.logMessage(e.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified level-zero delta is null or undefined."));
    if(!k)throw new b(e.logMessage(e.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified image format is null or undefined."));if(!m)throw new b(e.logMessage(e.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified cache path is null or undefined."));if(!l||1>l)throw new b(e.logMessage(e.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified number of levels is less than one."));if(!w||!x||1>w||1>x)throw new b(e.logMessage(e.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified tile width or height is less than one."));
    a.call(this,"Tiled Image Layer");this.retrievalImageFormat=k;this.cachePath=m;this.levels=new d(c,h,l,w,x);this.detailControl=1.75;this.expiration=null;this.currentTiles=[];this.currentTilesInvalid=!0;this.tileCache=new g(5E5,4E5);this.currentRetrievals=[];this.absentResourceList=new f(3,5E4);this.pickEnabled=!1};m.prototype=Object.create(a.prototype);m.prototype.refresh=function(){this.expiration=new Date;this.currentTilesInvalid=!0};m.prototype.prePopulate=function(a){if(!a)throw new b(e.logMessage(e.LEVEL_SEVERE,
    "TiledImageLayer","prePopulate","missingWorldWindow"));a=a.drawContext;this.topLevelTiles&&0!==this.topLevelTiles.length||this.createTopLevelTiles(a);for(var d=0;d<this.topLevelTiles.length;d++){var c=this.topLevelTiles[d];this.isTileTextureInMemory(a,c)||this.retrieveTileImage(a,c,!0)}};m.prototype.prePopulateCurrentTiles=function(a){if(!a)throw new b(e.logMessage(e.LEVEL_SEVERE,"TiledImageLayer","prePopulate","missingWorldWindow"));a=a.drawContext;this.assembleTiles(a);for(var d=0,c=this.currentTiles.length;d<
c;d++){var g=this.currentTiles[d];this.isTileTextureInMemory(a,g)||this.retrieveTileImage(a,g,!0)}};m.prototype.isPrePopulated=function(a){if(!a)throw new b(e.logMessage(e.LEVEL_SEVERE,"TiledImageLayer","isPrePopulated","missingWorldWindow"));for(var d=0;d<this.topLevelTiles.length;d++)if(!this.isTileTextureInMemory(a.drawContext,this.topLevelTiles[d]))return!1;return!0};m.prototype.createTile=function(a,d,b,e){var g=this.cachePath+"-layer/"+d.levelNumber+"/"+b+"/"+b+"_"+e+"."+l.suffixForMimeType(this.retrievalImageFormat);
    return new c(a,d,b,e,g)};m.prototype.doRender=function(a){if(a.terrain){if(this.currentTilesInvalid||!this.lasTtMVP||!a.navigatorState.modelviewProjection.equals(this.lasTtMVP)||a.globeStateKey!=this.lastGlobeStateKey)if(this.currentTilesInvalid=!1,1<=a.surfaceOpacity&&1<=this.opacity){this.previousTiles={};for(var d=0;d<this.currentTiles.length;d++)this.previousTiles[this.currentTiles[d].imagePath]=this.currentTiles[d];this.assembleTiles(a);this.fadeOutgoingTiles(a)}else this.assembleTiles(a);this.lasTtMVP=
    a.navigatorState.modelviewProjection;this.lastGlobeStateKey=a.globeStateKey;0<this.currentTiles.length&&(a.surfaceTileRenderer.renderTiles(a,this.currentTiles,this.opacity,1<=a.surfaceOpacity),a.frameStatistics.incrementImageTileCount(this.currentTiles.length),this.inCurrentFrame=!0)}};m.prototype.fadeOutgoingTiles=function(a){for(var d=(a.timestamp-a.previousRedrawTimestamp)/a.fadeTime,b={},c=0;c<this.currentTiles.length;c++){var e=this.currentTiles[c];b[e.imagePath]=e}for(var g in this.previousTiles)this.previousTiles.hasOwnProperty(g)&&
(e=this.previousTiles[g],0<e.opacity&&!b[e.imagePath]&&(e.opacity=Math.max(0,e.opacity-d),0<e.opacity&&(this.currentTiles.push(e),this.currentTilesInvalid=!0,a.redrawRequested=!0)))};m.prototype.isLayerInView=function(a){return a.terrain&&a.terrain.sector&&a.terrain.sector.intersects(this.levels.sector)};m.prototype.createTopLevelTiles=function(a){this.topLevelTiles=[];k.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)};m.prototype.assembleTiles=function(a){this.currentTiles=
    [];this.topLevelTiles&&0!==this.topLevelTiles.length||this.createTopLevelTiles(a);for(var d=0,b=this.topLevelTiles.length;d<b;d++){var c=this.topLevelTiles[d];c.update(a);this.currentAncestorTile=null;this.isTileVisible(a,c)&&this.addTileOrDescendants(a,c)}};m.prototype.addTileOrDescendants=function(a,d){if(this.tileMeetsRenderingCriteria(a,d))this.addTile(a,d);else{var b=null;try{if(this.isTileTextureInMemory(a,d)||0===d.level.levelNumber)b=this.currentAncestorTile,this.currentAncestorTile=d;for(var c=
    this.levels.level(d.level.levelNumber+1),e=d.subdivideToCache(c,this,this.tileCache),c=0,g=e.length;c<g;c++){var h=e[c];h.update(a);this.levels.sector.intersects(h.sector)&&this.isTileVisible(a,h)&&this.addTileOrDescendants(a,h)}}finally{b&&(this.currentAncestorTile=b)}}};m.prototype.addTile=function(a,d){d.fallbackTile=null;var b=a.gpuResourceCache.resourceForKey(d.imagePath);b?(d.opacity=1,this.currentTiles.push(d),this.expiration&&this.isTextureExpired(b)&&this.retrieveTileImage(a,d)):(this.retrieveTileImage(a,
    d),this.currentAncestorTile&&this.isTileTextureInMemory(a,this.currentAncestorTile)&&(d.fallbackTile=this.currentAncestorTile,d.fallbackTile.opacity=1,this.currentTiles.push(d)))};m.prototype.isTileVisible=function(a,d){return a.globe.projectionLimits&&!d.sector.overlaps(a.globe.projectionLimits)?!1:d.extent.intersectsFrustum(a.navigatorState.frustumInModelCoordinates)};m.prototype.tileMeetsRenderingCriteria=function(a,d){var b=this.detailControl;if(75<=d.sector.minLatitude||-75>=d.sector.maxLatitude)b*=
    1.2;return d.level.isLastLevel()||!d.mustSubdivide(a,b)};m.prototype.isTileTextureInMemory=function(a,d){return a.gpuResourceCache.containsResource(d.imagePath)};m.prototype.isTextureExpired=function(a){return this.expiration&&a.creationTime.getTime()<=this.expiration.getTime()};m.prototype.retrieveTileImage=function(a,d,b){if(0>this.currentRetrievals.indexOf(d.imagePath)&&!this.absentResourceList.isResourceAbsent(d.imagePath)){var c=this.resourceUrlForTile(d,this.retrievalImageFormat),g=new Image,
    h=d.imagePath,l=a.gpuResourceCache,k=a.currentGlContext.canvas,f=this;c?(g.onload=function(){e.log(e.LEVEL_INFO,"Image retrieval succeeded: "+c);var m=f.createTexture(a,d,g);f.removeFromCurrentRetrievals(h);m&&(l.putResource(h,m,m.size),f.currentTilesInvalid=!0,f.absentResourceList.unmarkResourceAbsent(h),b||(m=document.createEvent("Event"),m.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),k.dispatchEvent(m)))},g.onerror=function(){f.removeFromCurrentRetrievals(h);f.absentResourceList.markResourceAbsent(h);
    e.log(e.LEVEL_WARNING,"Image retrieval failed: "+c)},this.currentRetrievals.push(h),g.crossOrigin="anonymous",g.src=c):this.currentTilesInvalid=!0}};m.prototype.createTexture=function(a,d,b){return new h(a.currentGlContext,b)};m.prototype.removeFromCurrentRetrievals=function(a){a=this.currentRetrievals.indexOf(a);-1<a&&this.currentRetrievals.splice(a,1)};m.prototype.resourceUrlForTile=function(a,d){return this.urlBuilder?this.urlBuilder.urlForTile(a,d):null};return m});
define("src/layer/MercatorTiledImageLayer",["../util/Color","../geom/Sector","../layer/TiledImageLayer","../geom/Vec2","../util/WWMath"],function(f,b,c,a,d){f=function(d,b,h,k,l,f,p){c.call(this,d,b,h,k,l,f,p);this.detectBlankImages=!1;this.testPixels=[new a(20,20),new a(235,20),new a(20,235),new a(235,235)];this.destCanvas=document.createElement("canvas");this.destContext=this.destCanvas.getContext("2d")};f.prototype=Object.create(c.prototype);f.prototype.createTile=function(a,g,h,k){a=this.mapSizeForLevel(g.levelNumber);
    var l=d.clamp(k*this.imageSize,0,a),f=d.clamp(h*this.imageSize,0,a),p=d.clamp(l+this.imageSize,0,a),q=d.clamp(f+this.imageSize,0,a);a=new b(90-360*Math.atan(Math.exp(2*-(.5-q/a)*Math.PI))/Math.PI,90-360*Math.atan(Math.exp(2*-(.5-f/a)*Math.PI))/Math.PI,360*(l/a-.5),360*(p/a-.5));return c.prototype.createTile.call(this,a,g,h,k)};f.prototype.createTexture=function(a,b,h){var k=a.canvas2D,l=a.ctx2D,f=this.destCanvas,p=this.destContext,q=p.createImageData(h.width,h.height),t=b.sector,r=d.gudermannianInverse(t.minLatitude),
    u=d.gudermannianInverse(t.maxLatitude),w,x,A;k.width=h.width;k.height=h.height;f.width=h.width;f.height=h.height;l.drawImage(h,0,0,h.width,h.height);k=l.getImageData(0,0,h.width,h.height);if(this.detectBlankImages&&this.isBlankImage(h,k))return this.absentResourceList.markResourceAbsentPermanently(b.imagePath),null;for(l=0;1>l;l++)for(var B=0;B<h.height;B++){w=1-B/(h.height-1);w=w*t.deltaLatitude()+t.minLatitude;w=d.gudermannianInverse(w);w=1-(w-r)/(u-r);w=d.clamp(w,0,1);w=Math.floor(w*(h.height-
    1));for(var v=0;v<h.width;v++)x=4*(v+w*h.width),A=4*(v+B*h.width),q.data[A]=k.data[x],q.data[A+1]=k.data[x+1],q.data[A+2]=k.data[x+2],q.data[A+3]=k.data[x+3]}p.putImageData(q,0,0);return c.prototype.createTexture.call(this,a,b,f)};f.prototype.isBlankImage=function(a,d){for(var b,c=null,l=0,f=this.testPixels.length;l<f;l++)if(b=this.testPixels[l],b=4*(b[0]+b[1]*a.width),!c)c=[d.data[b],d.data[b+1],d.data[b+2]];else if(d.data[b]!=c[0]||d.data[b+1]!=c[1]||d.data[b+2]!=c[2])return!1;return!0};return f});
define("src/layer/BingTiledImageLayer",["../geom/Angle","../geom/Location","../geom/Sector","../layer/MercatorTiledImageLayer"],function(f,b,c,a){f=function(d){this.imageSize=256;a.call(this,new c(-85.05,85.05,-180,180),new b(85.05,180),23,"image/jpeg",d,this.imageSize,this.imageSize);this.displayName=d;this.pickEnabled=!1;this.detectBlankImages=!0;this.creditImage=WorldWind.configuration.baseUrl+"images/powered-by-bing.png"};f.prototype=Object.create(a.prototype);f.prototype.doRender=function(d){a.prototype.doRender.call(this,
    d);this.inCurrentFrame&&d.screenCreditController.addImageCredit(this.creditImage)};f.prototype.createTopLevelTiles=function(a){this.topLevelTiles=[];this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0));this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1));this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0));this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))};f.prototype.mapSizeForLevel=function(a){return 256<<
    a+1};return f});
define("src/util/BingImageryUrlBuilder",["../error/ArgumentError","../util/Logger","../util/WWUtil"],function(f,b,c){var a=function(d,b){b||(this.bingMapsKey=WorldWind.BingMapsKey,b||(this.bingMapsKey="AkttWCS8p6qzxvx5RH3qUcCPgwG9nRJ7IwlpFGb14B0rBorB5DvmXr2Y_eCUNIxH"),"AkttWCS8p6qzxvx5RH3qUcCPgwG9nRJ7IwlpFGb14B0rBorB5DvmXr2Y_eCUNIxH"===b&&(this.bingMapsKey="AkttWCS8p6qzxvx5RH3qUcCPgwG9nRJ7IwlpFGb14B0rBorB5DvmXr2Y_eCUNIxH",a.showBingMapsKeyWarning()));this.imagerySet=d};a.showBingMapsKeyWarning=function(){a.keyMessagePrinted||
(a.keyMessagePrinted=!0,b.log(b.LEVEL_WARNING,"WARNING: You are using a limited use, non-production Bing Maps key.\nIf you are developing an app or a web page this violates the Bing Terms of Use.\nPlease visit https://www.microsoft.com/maps/choose-your-bing-maps-API.aspx to obtain your own key for your application.\nSpecify that key to World Wind by setting the WorldWind.BingMapsKey property to your key prior to creating any Bing Maps layers.\n"))};a.prototype.requestMetadata=function(){if(!this.metadataRetrievalInProcess){this.metadataRetrievalInProcess=
    !0;var a=this;c.jsonp("http://dev.virtualearth.net/REST/V1/Imagery/Metadata/"+this.imagerySet+"/0,0?zl=1&key="+this.bingMapsKey,"jsonp",function(b){a.imageUrl=b.resourceSets[0].resources[0].imageUrl;b=document.createEvent("Event");b.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0);window.dispatchEvent(b);a.metadataRetrievalInProcess=!1})}};a.prototype.urlForTile=function(a,c){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"BingImageryUrlBuilder","urlForTile","missingTile"));if(!this.imageUrl)return this.requestMetadata(),
    null;var g=this.quadKeyFromLevelRowColumn(a.level.levelNumber,a.row,a.column),h;"Aerial"===this.imagerySet?h=this.imageUrl.replace(/a3/,"a"+g):"AerialWithLabels"===this.imagerySet?h=this.imageUrl.replace(/h3/,"h"+g):"Road"===this.imagerySet&&(h=this.imageUrl.replace(/r3/,"r"+g));return h};a.prototype.quadKeyFromLevelRowColumn=function(a,b,c){for(var h,k="",l=a+1;0<l;l--)a=0,h=1<<l-1,0!=(c&h)&&(a+=1),0!=(b&h)&&(a+=2),k+=a.toString();return k};return a});
define("src/layer/BingAerialLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(f,b,c,a){f=function(d){c.call(this,"Bing Aerial");this.urlBuilder=new a("Aerial",d)};f.prototype=Object.create(c.prototype);return f});
define("src/layer/BingAerialWithLabelsLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(f,b,c,a){f=function(d){c.call(this,"Bing Aerial with Labels");this.urlBuilder=new a("AerialWithLabels",d)};f.prototype=Object.create(c.prototype);return f});
define("src/layer/BingRoadsLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(f,b,c,a){f=function(d){c.call(this,"Bing Roads");this.urlBuilder=new a("Road",d);this.detectBlankImages=!1};f.prototype=Object.create(c.prototype);return f});
define("src/util/WmsUrlBuilder",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a,d,c,g,h){if(!a||0===a.length)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmsUrlBuilder","constructor","The WMS service address is missing."));if(!d||0===d.length)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmsUrlBuilder","constructor","The WMS layer names are not specified."));this.serviceAddress=a;this.layerNames=d;this.styleNames=c?c:"";this.transparent=!0;this.wmsVersion=g&&0<g.length?g:"1.3.0";
    this.isWms130OrGreater="1.3.0"<=this.wmsVersion;this.crs="EPSG:4326";this.timeString=h};c.prototype.urlForTile=function(a,d){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","missingTile"));if(!d)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","The image format is null or undefined."));var e=a.sector,g=c.fixGetMapString(this.serviceAddress);0>g.search(/service=wms/i)&&(g+="service=WMS");g=g+"&request=GetMap&version="+this.wmsVersion;g=g+"&transparent="+
    (this.transparent?"TRUE":"FALSE");g=g+"&layers="+this.layerNames;g=g+"&styles="+this.styleNames;g=g+"&format="+d+"&width="+a.tileWidth;g=g+"&height="+a.tileHeight;this.timeString&&(g=g+"&time="+this.timeString);this.isWms130OrGreater?(g=g+"&crs="+this.crs,g+="&bbox=","CRS:84"===this.crs?(g=g+e.minLongitude+","+e.minLatitude+",",g=g+e.maxLongitude+","+e.maxLatitude):(g=g+e.minLatitude+","+e.minLongitude+",",g=g+e.maxLatitude+","+e.maxLongitude)):(g=g+"&srs="+this.crs,g=g+"&bbox="+e.minLongitude+","+
    e.minLatitude+",",g=g+e.maxLongitude+","+e.maxLatitude);return g=g.replace(" ","%20")};c.fixGetMapString=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmsUrlBuilder","fixGetMapString","The specified service address is null or undefined."));var d=a.indexOf("?");0>d?a+="?":d!==a.length-1&&(d=a.search(/&$/),0>d&&(a+="&"));return a};return c});
define("src/layer/BingWMSLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(f,b,c,a){var d=function(){c.call(this,b.FULL_SPHERE,new f(45,45),16,"image/png","BingWMS",256,256);this.displayName="Bing WMS";this.pickEnabled=!1;this.maxActiveAltitude=1E4;this.urlBuilder=new a(location.protocol+"//worldwind27.arc.nasa.gov/wms/virtualearth","ve","","1.3.0")};d.prototype=Object.create(c.prototype);return d});
define("src/util/PeriodicTimeSequence",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"PeriodicTimeSequence","constructor","missingString"));var d=a.split("/");if(3!==d.length)throw new f(b.logMessage(b.LEVEL_SEVERE,"PeriodicTimeSequence","constructor","The interval string "+a+" does not contain 3 elements."));this.sequenceString=a;this.startTime=new Date(d[0]);this.endTime=new Date(d[1]);this.intervalMilliseconds=this.endTime.getTime()-
    this.startTime.getTime();this._currentTime=this.startTime;this.infiniteInterval=this.startTime.getTime()==this.endTime.getTime();this.period=c.parsePeriodString(d[2],!1)};Object.defineProperties(c.prototype,{currentTime:{get:function(){return this._currentTime},set:function(a){this._currentTime=a}},scaleForCurrentTime:{get:function(){return this.currentTime?(this.currentTime.getTime()-this.startTime.getTime())/this.intervalMilliseconds:1}}});c.prototype.next=function(){this.currentTime?this.currentTime.getTime()>=
this.endTime.getTime()&&!this.infiniteInterval?this.currentTime=null:this.currentTime=c.incrementTime(this.currentTime,this.period):this.currentTime=this.startTime;return this.currentTime};c.prototype.previous=function(){this.currentTime?this.currentTime.getTime()===this.startTime.getTime()?this.currentTime=null:this.currentTime=this.getTimeForScale(.9999*this.scaleForCurrentTime):this.currentTime=this.endTime;return this.currentTime};c.prototype.reset=function(){this.currentTime=null};c.prototype.getTimeForScale=
    function(a){if(0>=a)return this.startTime;if(1<=a)return this.endTime;var d=new Date(this.startTime.getTime()),b=d,g;for(g=0;g<a;g=(d.getTime()-this.startTime.getTime())/this.intervalMilliseconds)b=d,d=c.incrementTime(d,this.period);return b};c.incrementTime=function(a,d){var b=new Date(a.getTime());0!=d[0]&&b.setUTCFullYear(b.getUTCFullYear()+d[0]);0!=d[1]&&c.addMonths(b,d[1]);0!=d[2]&&b.setUTCDate(b.getUTCDate()+7*d[2]);0!=d[3]&&b.setUTCDate(b.getUTCDate()+d[3]);0!=d[4]&&b.setUTCHours(b.getUTCHours()+
    d[4]);0!=d[5]&&b.setUTCMinutes(b.getUTCMinutes()+d[5]);0!=d[6]&&b.setUTCSeconds(b.getUTCSeconds()+d[6]);return b};c.isLeapYear=function(a){return 0===a%4&&0!==a%100||0===a%400};c.getDaysInMonth=function(a,d){return[31,c.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][d]};c.addMonths=function(a,d){var b=a.getUTCDate();a.setUTCDate(1);a.setUTCMonth(a.getUTCMonth()+d);a.setUTCDate(Math.min(b,c.getDaysInMonth(a.getUTCFullYear(),a.getUTCMonth())));return a};c.parsePeriodString=function(a,d){var c=d?
    d:!1,g=[2,3,4,5,7,8,9],h=[0,0,0,0,0,0,0],k=[0,12,4,7,24,60,60],l;a=a.toUpperCase();if(!a)return h;if("string"!==typeof a)throw new f(b.logMessage(b.LEVEL_SEVERE,"PeriodicTimeSequence","parsePeriodString","Invalid ISO8601 period string '"+a+"'"));if(l=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(a))for(var m=0;m<g.length;m++){var p=g[m];h[m]=l[p]?+l[p].replace(/[A-Za-z]+/g,""):0}else throw new f(b.logMessage(b.LEVEL_SEVERE,"PeriodicTimeSequence","parsePeriodString","String '"+
    a+"' is not a valid ISO8601 period."));if(c)for(m=h.length-1;0<m;m--)h[m]>=k[m]&&(h[m-1]+=Math.floor(h[m]/k[m]),h[m]%=k[m]);return h};return c});
define("src/util/LevelRowColumnUrlBuilder",["../error/ArgumentError","../util/Logger","../util/WWUtil"],function(f,b,c){var a=function(a,b){this.serverAddress=a;a&&0!==a.length||(this.serverAddress=c.currentUrlSansFilePart());this.pathToData=b};a.prototype.urlForTile=function(a,e){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","missingTile"));if(!e)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","The image format is null or undefined."));var g=this.serverAddress;
    this.pathToData&&(g=g+"/"+this.pathToData);g=g+"/"+a.level.levelNumber.toString();g=g+"/"+a.row.toString();g=g+"/"+a.row.toString()+"_"+a.column.toString();g=g+"."+c.suffixForMimeType(e);return g=g.replace(" ","%20")};return a});
define("src/layer/RestTiledImageLayer","../error/ArgumentError ../geom/Location ../util/Logger ../geom/Sector ../layer/TiledImageLayer ../util/LevelRowColumnUrlBuilder ../util/WWUtil".split(" "),function(f,b,c,a,d,e,g){f=function(c,k,l,f){var p=g.urlPath(c+"/"+k);d.call(this,f&&f.sector||a.FULL_SPHERE,f&&f.levelZeroTileDelta||new b(45,45),f&&f.numLevels||5,f&&f.imageFormat||"image/jpeg",p,f&&f.tileWidth||256,f&&f.tileHeight||256);this.displayName=l;this.pickEnabled=!1;this.urlBuilder=new e(c,k)};
    f.prototype=Object.create(d.prototype);return f});
define("src/layer/BlueMarbleLayer",["../error/ArgumentError","../layer/Layer","../util/Logger","../util/PeriodicTimeSequence","../layer/RestTiledImageLayer"],function(f,b,c,a,d){var e=function(d,c,k){b.call(this,d||"Blue Marble");this.time=c||new Date("2004-01");this.configuration=k;this.pickEnabled=!1;this.layers={};this.layerNames=[{month:"BlueMarble-200401",time:e.availableTimes[0]},{month:"BlueMarble-200402",time:e.availableTimes[1]},{month:"BlueMarble-200403",time:e.availableTimes[2]},{month:"BlueMarble-200404",
    time:e.availableTimes[3]},{month:"BlueMarble-200405",time:e.availableTimes[4]},{month:"BlueMarble-200406",time:e.availableTimes[5]},{month:"BlueMarble-200407",time:e.availableTimes[6]},{month:"BlueMarble-200408",time:e.availableTimes[7]},{month:"BlueMarble-200409",time:e.availableTimes[8]},{month:"BlueMarble-200410",time:e.availableTimes[9]},{month:"BlueMarble-200411",time:e.availableTimes[10]},{month:"BlueMarble-200412",time:e.availableTimes[11]}];this.timeSequence=new a("2004-01-01/2004-12-01/P1M");
    this.serverAddress=null;this.pathToData="../standalonedata/Earth/BlueMarble256/"};e.prototype=Object.create(b.prototype);e.availableTimes=[new Date("2004-01"),new Date("2004-02"),new Date("2004-03"),new Date("2004-04"),new Date("2004-05"),new Date("2004-06"),new Date("2004-07"),new Date("2004-08"),new Date("2004-09"),new Date("2004-10"),new Date("2004-11"),new Date("2004-12")];e.prototype.prePopulate=function(a){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"BlueMarbleLayer","prePopulate","missingWorldWindow"));
    for(var d=0;d<this.layerNames.length;d++){var b=this.layerNames[d].month;this.layers[b]||this.createSubLayer(b);this.layers[b].prePopulate(a)}};e.prototype.isPrePopulated=function(a){for(var d=0;d<this.layerNames.length;d++){var b=this.layers[this.layerNames[d].month];if(!b||!b.isPrePopulated(a))return!1}return!0};e.prototype.doRender=function(a){var d=this.nearestLayer(this.time);d.opacity=this.opacity;this.detailControl&&(d.detailControl=this.detailControl);d.doRender(a);this.inCurrentFrame=d.inCurrentFrame};
    e.prototype.nearestLayer=function(a){a=this.nearestLayerName(a);this.layers[a]||this.createSubLayer(a);return this.layers[a]};e.prototype.createSubLayer=function(a){this.layers[a]=new d(this.serverAddress,this.pathToData+a,this.displayName,this.configuration)};e.prototype.nearestLayerName=function(a){a=a.getTime();if(a<=this.layerNames[0].time.getTime())return this.layerNames[0].month;if(a>=this.layerNames[11].time.getTime())return this.layerNames[11].month;for(var d=0;d<this.layerNames.length-1;d++){var b=
        this.layerNames[d].time.getTime(),c=this.layerNames[d+1].time.getTime();if(a>=b&&a<=c)return a-b<c-a?this.layerNames[d].month:this.layerNames[d+1].month}};return e});
define("src/layer/BMNGLandsatLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(f,b,c,a){var d=function(){c.call(this,b.FULL_SPHERE,new f(45,45),10,"image/jpeg","BMNGLandsat256",256,256);this.displayName="Blue Marble & Landsat";this.pickEnabled=!1;this.urlBuilder=new a(location.protocol+"//worldwind25.arc.nasa.gov/wms","BlueMarble-200405,esat","","1.3.0")};d.prototype=Object.create(c.prototype);return d});
define("src/layer/BMNGLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(f,b,c,a){var d=function(d){c.call(this,b.FULL_SPHERE,new f(45,45),5,"image/jpeg",d||"BMNG256",256,256);this.displayName="Blue Marble";this.pickEnabled=!1;this.urlBuilder=new a(location.protocol+"//worldwind25.arc.nasa.gov/wms",d||"BlueMarble-200405","","1.3.0")};d.prototype=Object.create(c.prototype);return d});
define("src/layer/RenderableLayer",["../error/ArgumentError","../layer/Layer","../util/Logger"],function(f,b,c){var a=function(a){b.call(this,a);this.renderables=[]};a.prototype=Object.create(b.prototype);a.prototype.addRenderable=function(a){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"RenderableLayer","addRenderable","missingRenderable"));this.renderables.push(a)};a.prototype.addRenderables=function(a){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"RenderableLayer","addRenderables","The renderables array is null or undefined."));
    for(var b=0,g=a.length;b<g;b++)this.addRenderable(a[b])};a.prototype.removeRenderable=function(a){a=this.renderables.indexOf(a);0<=a&&this.renderables.splice(a,1)};a.prototype.removeAllRenderables=function(){this.renderables=[]};a.prototype.doRender=function(a){for(var b=a.orderedRenderables.length,g=0,h=this.renderables.length;g<h;g++)try{this.renderables[g].render(a)}catch(k){c.logMessage(c.LEVEL_SEVERE,"RenderableLayer","doRender","Error while rendering shape "+this.renderables[g].displayName+
    ".\n"+k.toString())}a.orderedRenderables.length>b&&(this.inCurrentFrame=!0)};return a});
define("src/render/SurfaceTile",["../error/ArgumentError","../util/Logger","../geom/Matrix","../geom/Sector","../error/UnsupportedOperationError"],function(f,b,c,a,d){c=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"SurfaceTile","constructor","missingSector"));this.sector=a};c.prototype.bind=function(a){throw new d(b.logMessage(b.LEVEL_SEVERE,"SurfaceTile","bind","abstractInvocation"));};c.prototype.applyInternalTransform=function(a,c){throw new d(b.logMessage(b.LEVEL_SEVERE,"SurfaceTile",
    "applyInternalTransform","abstractInvocation"));};return c});
define("src/shapes/SurfaceImage",["../error/ArgumentError","../util/Logger","../pick/PickedObject","../render/SurfaceTile"],function(f,b,c,a){var d=function(d,c){if(!d)throw new f(b.logMessage(b.LEVEL_SEVERE,"SurfaceImage","constructor","missingSector"));if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"SurfaceImage","constructor","missingImage"));a.call(this,d);this.enabled=!0;this._imageSource=c;this.opacity=1;this.displayName="Surface Image";this.imageSourceWasUpdated=!0};d.prototype=Object.create(a.prototype);
    Object.defineProperties(d.prototype,{imageSource:{get:function(){return this._imageSource},set:function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"SurfaceImage","imageSource","missingImage"));this._imageSource=a;this.imageSourceWasUpdated=!0}}});d.prototype.bind=function(a){var d=a.gpuResourceCache.resourceForKey(this._imageSource);if(d&&!this.imageSourceWasUpdated)return d.bind(a);d=a.gpuResourceCache.retrieveTexture(a.currentGlContext,this._imageSource);this.imageSourceWasUpdated=!1;if(d)return d.bind(a)};
    d.prototype.applyInternalTransform=function(a,d){};d.prototype.render=function(a){if(this.enabled&&this.sector.overlaps(a.terrain.sector)){a.pickingMode&&(this.pickColor=a.uniquePickColor());a.surfaceTileRenderer.renderTiles(a,[this],this.opacity*a.currentLayer.opacity);if(a.pickingMode){var d=new c(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);a.resolvePick(d)}a.currentLayer.inCurrentFrame=!0}};return d});
define("src/layer/BMNGOneImageLayer",["../layer/RenderableLayer","../geom/Sector","../shapes/SurfaceImage","../util/WWUtil"],function(f,b,c,a){a=function(){f.call(this,"Blue Marble Image");var a=new c(b.FULL_SPHERE,WorldWind.configuration.baseUrl+"images/BMNG_world.topo.bathy.200405.3.2048x1024.jpg");this.addRenderable(a);this.pickEnabled=!1;this.minActiveAltitude=3E6};a.prototype=Object.create(f.prototype);return a});
define("src/gesture/Touch",[],function(){var f=function(b,c,a){this.identifier=b;this._clientX=c;this._clientY=a;this._clientStartX=c;this._clientStartY=a};Object.defineProperties(f.prototype,{clientX:{get:function(){return this._clientX},set:function(b){this._clientX=b}},clientY:{get:function(){return this._clientY},set:function(b){this._clientY=b}},translationX:{get:function(){return this._clientX-this._clientStartX},set:function(b){this._clientStartX=this._clientX-b}},translationY:{get:function(){return this._clientY-
    this._clientStartY},set:function(b){this._clientStartY=this._clientY-b}}});return f});
define("src/gesture/GestureRecognizer",["../error/ArgumentError","../util/Logger","../gesture/Touch"],function(f,b,c){var a=function(d,c){function g(a){h.handleEvent(a)}if(!d)throw new f(b.logMessage(b.LEVEL_SEVERE,"GestureRecognizer","constructor","missingTarget"));this.target=d;this.enabled=!0;this._state=WorldWind.POSSIBLE;this._nextState=null;this._translationY=this._translationX=this._clientStartY=this._clientStartX=this._clientY=this._clientX=0;this._translationWeight=.4;this._mouseButtonMask=
    0;this._touches=[];this._touchCentroidShiftY=this._touchCentroidShiftX=0;this._gestureCallbacks=[];this._canRecognizeWith=[];this._requiresFailureOf=[];this._requiredToFailBy=[];c&&this._gestureCallbacks.push(c);a.allRecognizers.push(this);var h=this;window.PointerEvent?(d.addEventListener("pointerdown",g,!1),window.addEventListener("pointermove",g,!1),window.addEventListener("pointercancel",g,!1),window.addEventListener("pointerup",g,!1)):(d.addEventListener("mousedown",g,!1),window.addEventListener("mousemove",
    g,!1),window.addEventListener("mouseup",g,!1),d.addEventListener("touchstart",g,!1),d.addEventListener("touchmove",g,!1),d.addEventListener("touchend",g,!1),d.addEventListener("touchcancel",g,!1))};a.allRecognizers=[];Object.defineProperties(a.prototype,{state:{get:function(){return this._state},set:function(a){this.transitionToState(a)}},clientX:{get:function(){return this._clientX},set:function(a){this._clientX=a}},clientY:{get:function(){return this._clientY},set:function(a){this._clientY=a}},
    translationX:{get:function(){return this._translationX},set:function(a){this._translationX=a;this._clientStartX=this._clientX;this._touchCentroidShiftX=0}},translationY:{get:function(){return this._translationY},set:function(a){this._translationY=a;this._clientStartY=this._clientY;this._touchCentroidShiftY=0}},mouseButtonMask:{get:function(){return this._mouseButtonMask}},touchCount:{get:function(){return this._touches.length}},gestureCallbacks:{get:function(){return this._gestureCallbacks}}});a.prototype.touch=
    function(a){if(0>a||a>=this._touches.length)throw new f(b.logMessage(b.LEVEL_SEVERE,"GestureRecognizer","touch","indexOutOfRange"));return this._touches[a]};a.prototype.recognizeSimultaneouslyWith=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"GestureRecognizer","recognizeSimultaneouslyWith","The specified gesture recognizer is null or undefined."));-1==this._canRecognizeWith.indexOf(a)&&(this._canRecognizeWith.push(a),a._canRecognizeWith.push(this))};a.prototype.canRecognizeSimultaneouslyWith=
    function(a){return-1!=this._canRecognizeWith.indexOf(a)};a.prototype.requireRecognizerToFail=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"GestureRecognizer","requireRecognizerToFail","The specified gesture recognizer is null or undefined"));-1==this._requiresFailureOf.indexOf(a)&&(this._requiresFailureOf.push(a),a._requiredToFailBy.push(this))};a.prototype.requiresRecognizerToFail=function(a){return-1!=this._requiresFailureOf.indexOf(a)};a.prototype.requiredToFailByRecognizer=function(a){return-1!=
    this._requiredToFailBy.indexOf(a)};a.prototype.reset=function(){this._state=WorldWind.POSSIBLE;this._nextState=null;this._mouseButtonMask=this._translationY=this._translationX=this._clientStartY=this._clientStartX=this._clientY=this._clientX=0;this._touches=[];this._touchCentroidShiftY=this._touchCentroidShiftX=0};a.prototype.prepareToRecognize=function(){};a.prototype.mouseDown=function(a){};a.prototype.mouseMove=function(a){};a.prototype.mouseUp=function(a){};a.prototype.touchStart=function(a){};
    a.prototype.touchMove=function(a){};a.prototype.touchCancel=function(a){};a.prototype.touchEnd=function(a){};a.prototype.transitionToState=function(a){this._nextState=null;a==WorldWind.FAILED?(this._state=a,this.updateRecognizersWaitingForFailure(),this.resetIfEventsEnded()):a==WorldWind.RECOGNIZED?(this.tryToRecognize(a),this._state==a&&(this.prepareToRecognize(),this.callGestureCallbacks(),this.resetIfEventsEnded())):a==WorldWind.BEGAN?(this.tryToRecognize(a),this._state==a&&(this.prepareToRecognize(),
        this.callGestureCallbacks())):a==WorldWind.CHANGED?(this._state=a,this.callGestureCallbacks()):a==WorldWind.CANCELLED?(this._state=a,this.callGestureCallbacks(),this.resetIfEventsEnded()):a==WorldWind.ENDED&&(this._state=a,this.callGestureCallbacks(),this.resetIfEventsEnded())};a.prototype.updateRecognizersWaitingForFailure=function(){for(var a=0,b=this._requiredToFailBy.length;a<b;a++){var c=this._requiredToFailBy[a];null!=c._nextState&&c.transitionToState(c._nextState)}};a.prototype.tryToRecognize=
        function(d){if(a.allRecognizers.some(this.canBePreventedByRecognizer,this))this.transitionToState(WorldWind.FAILED);else if(a.allRecognizers.some(this.isWaitingForRecognizerToFail,this))this._nextState=d;else{for(var b=a.allRecognizers.filter(this.canPreventRecognizer,this),c=0,h=b.length;c<h;c++)b[c].transitionToState(WorldWind.FAILED);this._state=d}};a.prototype.canPreventRecognizer=function(a){return this!=a&&this.target==a.target&&a.state==WorldWind.POSSIBLE&&(this.requiredToFailByRecognizer(a)||
        !this.canRecognizeSimultaneouslyWith(a))};a.prototype.canBePreventedByRecognizer=function(a){return this!=a&&this.target==a.target&&a.state==WorldWind.RECOGNIZED&&(this.requiresRecognizerToFail(a)||!this.canRecognizeSimultaneouslyWith(a))};a.prototype.isWaitingForRecognizerToFail=function(a){return this!=a&&this.target==a.target&&a.state==WorldWind.POSSIBLE&&this.requiresRecognizerToFail(a)};a.prototype.callGestureCallbacks=function(){for(var a=0,b=this._gestureCallbacks.length;a<b;a++)this._gestureCallbacks[a](this)};
    a.prototype.handleEvent=function(a){if(this.enabled&&(!a.defaultPrevented||this.state!=WorldWind.POSSIBLE)){var c,g;try{if("mousedown"==a.type)this.handleMouseDown(a);else if("mousemove"==a.type)this.handleMouseMove(a);else if("mouseup"==a.type)this.handleMouseUp(a);else if("touchstart"==a.type)for(c=0,g=a.changedTouches.length;c<g;c++)this.handleTouchStart(a.changedTouches.item(c));else if("touchmove"==a.type)for(c=0,g=a.changedTouches.length;c<g;c++)this.handleTouchMove(a.changedTouches.item(c));
    else if("touchcancel"==a.type)for(c=0,g=a.changedTouches.length;c<g;c++)this.handleTouchCancel(a.changedTouches.item(c));else if("touchend"==a.type)for(c=0,g=a.changedTouches.length;c<g;c++)this.handleTouchEnd(a.changedTouches.item(c));else if("pointerdown"==a.type&&"mouse"==a.pointerType)this.handleMouseDown(a);else if("pointermove"==a.type&&"mouse"==a.pointerType)this.handleMouseMove(a);else if("pointercancel"!=a.type||"mouse"!=a.pointerType)"pointerup"==a.type&&"mouse"==a.pointerType?this.handleMouseUp(a):
        "pointerdown"==a.type&&"touch"==a.pointerType?this.handleTouchStart(a):"pointermove"==a.type&&"touch"==a.pointerType?this.handleTouchMove(a):"pointercancel"==a.type&&"touch"==a.pointerType?this.handleTouchCancel(a):"pointerup"==a.type&&"touch"==a.pointerType?this.handleTouchEnd(a):b.logMessage(b.LEVEL_INFO,"GestureRecognizer","handleEvent","Unrecognized event type: "+a.type)}catch(h){b.logMessage(b.LEVEL_SEVERE,"GestureRecognizer","handleEvent","Error handling event.\n"+h.toString())}}};a.prototype.handleMouseDown=
        function(a){if(!("mousedown"==a.type&&0<this._touches.length)){var b=1<<a.button;b&0!=this._mouseButtonMask||(0==this._mouseButtonMask&&(this._clientX=a.clientX,this._clientY=a.clientY,this._clientStartX=a.clientX,this._clientStartY=a.clientY,this._translationY=this._translationX=0),this._mouseButtonMask|=b,this.mouseDown(a))}};a.prototype.handleMouseMove=function(a){if(0!=this._mouseButtonMask&&(this._clientX!=a.clientX||this._clientY!=a._clientY)){var b=a.clientX-this._clientStartX,c=a.clientY-
        this._clientStartY,h=this._translationWeight;this._clientX=a.clientX;this._clientY=a.clientY;this._translationX=this._translationX*(1-h)+b*h;this._translationY=this._translationY*(1-h)+c*h;this.mouseMove(a)}};a.prototype.handleMouseUp=function(a){var b=1<<a.button;b&0==this._mouseButtonMask||(this._mouseButtonMask&=~b,this.mouseUp(a),0==this._mouseButtonMask&&this.resetIfEventsEnded())};a.prototype.handleTouchStart=function(a){var b=new c(a.identifier||a.pointerId,a.clientX,a.clientY);this._touches.push(b);
        1==this._touches.length?(this._clientX=a.clientX,this._clientY=a.clientY,this._clientStartX=a.clientX,this._clientStartY=a.clientY,this._touchCentroidShiftY=this._touchCentroidShiftX=this._translationY=this._translationX=0):this.touchesAddedOrRemoved();this.touchStart(b)};a.prototype.handleTouchMove=function(a){var b=this.indexOfTouchWithId(a.identifier||a.pointerId);if(-1!=b&&(b=this._touches[b],b.clientX!=a.clientX||b.clientY!=a.clientY)){b.clientX=a.clientX;b.clientY=a.clientY;a=this.touchCentroid();
        var c=a.clientX-this._clientStartX+this._touchCentroidShiftX,h=a.clientY-this._clientStartY+this._touchCentroidShiftY,k=this._translationWeight;this._clientX=a.clientX;this._clientY=a.clientY;this._translationX=this._translationX*(1-k)+c*k;this._translationY=this._translationY*(1-k)+h*k;this.touchMove(b)}};a.prototype.handleTouchCancel=function(a){a=this.indexOfTouchWithId(a.identifier||a.pointerId);if(-1!=a){var b=this._touches[a];this._touches.splice(a,1);this.touchesAddedOrRemoved();this.touchCancel(b);
        this.resetIfEventsEnded()}};a.prototype.handleTouchEnd=function(a){a=this.indexOfTouchWithId(a.identifier||a.pointerId);if(-1!=a){var b=this._touches[a];this._touches.splice(a,1);this.touchesAddedOrRemoved();this.touchEnd(b);this.resetIfEventsEnded()}};a.prototype.resetIfEventsEnded=function(){this._state!=WorldWind.POSSIBLE&&0==this._mouseButtonMask&&0==this._touches.length&&this.reset()};a.prototype.touchesAddedOrRemoved=function(){this._touchCentroidShiftX+=this._clientX;this._touchCentroidShiftY+=
        this._clientY;var a=this.touchCentroid();this._clientX=a.clientX;this._clientY=a.clientY;this._touchCentroidShiftX-=this._clientX;this._touchCentroidShiftY-=this._clientY};a.prototype.touchCentroid=function(){for(var a=0,b=0,c=0,h=this._touches.length;c<h;c++)var k=this._touches[c],a=a+k.clientX/h,b=b+k.clientY/h;return{clientX:a,clientY:b}};a.prototype.indexOfTouchWithId=function(a){for(var b=0,c=this._touches.length;b<c;b++)if(this._touches[b].identifier==a)return b;return-1};return a});
define("src/gesture/ClickRecognizer",["../gesture/GestureRecognizer"],function(f){var b=function(b,a){f.call(this,b,a);this.numberOfClicks=1;this.button=0;this.maxMouseMovement=5;this.maxClickDuration=500;this.maxClickInterval=400;this.clicks=[];this.timeout=null};b.prototype=Object.create(f.prototype);b.prototype.reset=function(){f.prototype.reset.call(this);this.clicks=[];this.cancelFailAfterDelay()};b.prototype.mouseDown=function(b){this.state==WorldWind.POSSIBLE&&(this.button!=b.button?this.state=
    WorldWind.FAILED:(this.clicks.push({clientX:this.clientX,clientY:this.clientY}),this.failAfterDelay(this.maxClickDuration)))};b.prototype.mouseMove=function(b){if(this.state==WorldWind.POSSIBLE){b=this.translationX;var a=this.translationY;Math.sqrt(b*b+a*a)>this.maxMouseMovement&&(this.state=WorldWind.FAILED)}};b.prototype.mouseUp=function(b){this.state==WorldWind.POSSIBLE&&0==this.mouseButtonMask&&(this.clicks.length==this.numberOfClicks?(this.clientX=this.clicks[0].clientX,this.clientY=this.clicks[0].clientY,
    this.state=WorldWind.RECOGNIZED):this.failAfterDelay(this.maxClickInterval))};b.prototype.touchStart=function(b){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)};b.prototype.failAfterDelay=function(b){var a=this;a.timeout&&window.clearTimeout(a.timeout);a.timeout=window.setTimeout(function(){a.timeout=null;a.state==WorldWind.POSSIBLE&&(a.state=WorldWind.FAILED)},b)};b.prototype.cancelFailAfterDelay=function(){this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)};return b});
define("src/formats/collada/ColladaAsset",[],function(){var f=function(b){this.xmlAsset=b.getElementsByTagName("asset")[0];this.asset={daeVersion:b.querySelector("COLLADA").getAttribute("version")}};f.prototype.parse=function(){if(!this.xmlAsset)return null;for(var b=0;b<this.xmlAsset.childNodes.length;b++){var c=this.xmlAsset.childNodes.item(b);if(1===c.nodeType)switch(c.nodeName){case "contributor":if(c=c.querySelector("authoring_tool"))this.asset.authoring_tool=c.textContext;break;case "unit":this.asset.unit=
    c.getAttribute("meter");break;default:this.asset[c.localName]=c.textContent}}this.xmlAsset=null;return this.asset};return f});
define("src/formats/collada/ColladaUtils",["../../util/Logger"],function(f){return{getRawValues:function(b){if(!b)return null;b=b.textContent;b=b.replace(/\n/gi," ");b=b.replace(/\s+/gi," ");b=b.trim();return 0===b.length?null:b.split(" ")},bufferDataFloat32:function(b){b=this.getRawValues(b);if(!b)return null;for(var c=b.length,a=new Float32Array(c),d=0;d<c;d++)a[d]=parseFloat(b[d]);return a},bufferDataUInt32:function(b){b=this.getRawValues(b);if(!b)return null;for(var c=b.length,a=new Uint32Array(c),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           d=0;d<c;d++)a[d]=parseInt(b[d]);return a},getFirstChildElement:function(b,c){for(var a=b.childNodes,d=0;d<a.length;++d){var e=a.item(d);if(1===e.nodeType&&(e.nodeName&&!c||c&&c===e.nodeName))return e}return null},getFilename:function(b){var c=b.lastIndexOf("\\");-1!==c&&(b=b.substr(c+1));c=b.lastIndexOf("/");-1!==c&&(b=b.substr(c+1));return b},replaceSpace:function(b){return b?b.replace(/ /g,"_"):""},querySelectorById:function(b,c){for(var a=0;a<b.length;a++){var d=b.item(a).getAttribute("id");if(d&&
    d.toString()===c)return b.item(a)}return null},getTextureType:function(b){for(var c=!0,a=0,d=b.length;a<d;a++)if(0>b[a]||1<b[a]){c=!1;break}return c},fetchFile:function(b,c){var a=new XMLHttpRequest;a.onload=function(){200<=this.status&&400>this.status?c(this.response):(f.log(f.LEVEL_SEVERE,"sever error: "+this.status),c(null))};a.onerror=function(a){f.log(f.LEVEL_SEVERE,"connection error: "+a);c(null)};a.open("get",b,!0);a.send()}}});
define("src/formats/collada/ColladaImage",["./ColladaUtils"],function(f){var b=function(b,a){this.filename="";this.map=b;this.name=a;this.path=""};b.prototype.parse=function(b){for(var a=0;a<b.childNodes.length;a++){var d=b.childNodes[a];if(1===d.nodeType)switch(d.nodeName){case "init_from":this.filename=f.getFilename(d.textContent),this.path=d.textContent}}return this};return b});
define("src/formats/collada/ColladaMaterial",["./ColladaUtils"],function(f){var b=function(b){this.id=b;this.newParams=[]};b.prototype.parse=function(b){for(var a=0;a<b.childNodes.length;a++){var d=b.childNodes[a];if(1===d.nodeType)switch(d.nodeName){case "profile_COMMON":this.parseProfileCommon(d)}}return this};b.prototype.parseProfileCommon=function(b){for(var a=0;a<b.childNodes.length;a++){var d=b.childNodes[a];if(1===d.nodeType)switch(d.nodeName){case "newparam":this.parseNewparam(d);break;case "technique":this.parseTechnique(d)}}};
    b.prototype.parseNewparam=function(b){for(var a=b.getAttribute("sid"),d=0;d<b.childNodes.length;d++){var e=b.childNodes[d];if(1===e.nodeType)switch(e.nodeName){case "surface":(e=e.querySelector("init_from"))&&this.newParams.push({sid:a,type:"surface",initFrom:e.textContent});break;case "sampler2D":e=e.querySelector("source"),this.newParams.push({sid:a,type:"sampler2D",source:e.textContent})}}};b.prototype.parseTechnique=function(b){for(var a=0;a<b.childNodes.length;a++){var d=b.childNodes[a];if(1===
        d.nodeType)switch(d.nodeName){case "constant":case "lambert":case "blinn":case "phong":this.techniqueType=d.nodeName,this.parseTechniqueType(d)}}};b.prototype.parseTechniqueType=function(b){for(var a=0;a<b.childNodes.length;a++){var d=b.childNodes[a];if(1===d.nodeType&&d.nodeName){var e=d.nodeName;if(d=f.getFirstChildElement(d))switch(d.nodeName){case "color":this[e]=f.bufferDataFloat32(d).subarray(0,4);break;case "float":this[e]=f.bufferDataFloat32(d)[0];break;case "texture":d=d.getAttribute("texture"),
        d=this.newParams.map(function(a){return a.sid}).indexOf(d),d=this.newParams[d].source,d=this.newParams.map(function(a){return a.sid}).indexOf(d),d=this.newParams[d].initFrom,this.textures||(this.textures={}),this.textures[e]={mapId:d}}}}};return b});
define("src/formats/collada/ColladaMesh",["./ColladaUtils"],function(f){var b=function(b){this.filename=b||"";this.name=b||"";this.buffers=[]};b.prototype.parse=function(b){for(var a={},d,e={id:"",inputs:[]},g=0;g<b.childNodes.length;g++)if(d=b.childNodes[g],1===d.nodeType)switch(d.nodeName){case "source":if(!d.querySelector)continue;var h=d.querySelector("float_array");if(!h)continue;var h=f.bufferDataFloat32(h),k=d.querySelector("accessor"),k=parseInt(k.getAttribute("stride"));a[d.getAttribute("id")]=
{stride:k,data:h};break;case "vertices":this.parseVertices(d,e);break;case "triangles":d=this.parsePolygons(d,a,e,3);this.buffers.push(d);break;case "polygons":d=this.parsePolygons(d,a,e,4);this.buffers.push(d);break;case "polylist":d=this.parsePolygons(d,a,e,null),this.buffers.push(d)}return this};b.prototype.parseVertices=function(b,a){a.id=b.getAttribute("id");for(var d=b.querySelectorAll("input"),e=0;e<d.length;e++){var g=d[e],h=g.getAttribute("source").substr(1),g=g.getAttribute("semantic").toUpperCase();
    a.inputs.push({semantic:g,source:h})}};b.prototype.parsePolygons=function(b,a,d,e){var g=[];null==e&&(g=b.querySelector("vcount").textContent.trim().split(" "));var h=parseInt(b.getAttribute("count")),k=b.getAttribute("material");d=this.parseInputs(b,a,d);a=d.inputs;d=d.maxOffset;var l=b.querySelector("p");b=[];l&&(b=l.textContent.trim().split(" "));for(var f=a.length,p=0,q={},l=[],t=0,r=0;r<h;r++)for(var u=g.length?parseInt(g[r]):e,w=-1,x=-1,A,B=0;B<u;B++){var v=b.slice(t,t+d).join(" ");A=x;if(q.hasOwnProperty(v))x=
    q[v];else{for(x=0;x<f;x++)for(var F=a[x],G=parseInt(b[t+F[4]]),D=F[1],y=F[3],G=G*F[2],H=0;H<F[2];H++)D.push(y[G+H]);x=p;p+=1;q[v]=x}3<u&&(0===B&&(w=x),B>2*d&&(l.push(w),l.push(A)));l.push(x);t+=d}e={vertices:new Float32Array(a[0][1]),material:k};this.transformMeshInfo(e,a,l);return e};b.prototype.parseInputs=function(b,a,d){var e=[],g=0;b=b.querySelectorAll("input");for(var h=0;h<b.length;h++){var k=b.item(h);if(k.getAttribute){var l=k.getAttribute("semantic").toUpperCase(),f=k.getAttribute("source").substr(1),
    p=parseInt(k.getAttribute("offset")),g=g<p+1?p+1:g,q=0;k.getAttribute("set")&&(q=parseInt(k.getAttribute("set")));if(d.id===f)for(l=d.inputs,f=0;f<l.length;f++)(k=a[l[f].source])&&e.push([l[f].semantic,[],k.stride,k.data,p,q]);else k=a[f],e.push([l,[],k.stride,k.data,p,q])}}return{inputs:e,maxOffset:g}};b.prototype.transformMeshInfo=function(b,a,d){for(var e={normal:"normals",texcoord:"uvs"},g=1;g<a.length;g++){var h=a[g][0].toLowerCase(),k=a[g][1];k.length&&(e[h]&&(h=e[h]),b[h]&&(h+=a[g][5]),b[h]=
    new Float32Array(k),"uvs"===h&&(b.isClamp=f.getTextureType(k)))}b.indices=new Uint16Array(d);return b};return b});
define("src/formats/collada/ColladaNode",["./ColladaUtils","../../geom/Matrix","../../geom/Vec3"],function(f,b,c){var a=function(){this.sid=this.name=this.id="";this.children=[];this.materials=[];this.mesh="";this.localMatrix=b.fromIdentity();this.worldMatrix=b.fromIdentity()};a.prototype.parse=function(d,c,g){this.id=d.getAttribute("id");this.sid=d.getAttribute("sid");this.name=d.getAttribute("name");this.children=[];this.materials=[];this.mesh="";this.localMatrix=b.fromIdentity();this.worldMatrix=
    b.fromIdentity();this.setNodeTransforms(d,g);for(g=0;g<d.childNodes.length;g++){var h=d.childNodes[g];if(1===h.nodeType)switch(h.nodeName){case "node":this.children.push((new a).parse(h,c,this.worldMatrix));break;case "instance_geometry":this.mesh=h.getAttribute("url").substr(1);for(var h=h.querySelectorAll("instance_material"),f=0;f<h.length;f++){var l=h.item(f);this.materials.push({id:l.getAttribute("target").substr(1),symbol:l.getAttribute("symbol")})}break;case "instance_node":h=h.getAttribute("url").substr(1),
(h=this.getLibraryNode(c,h))&&this.children.push((new a).parse(h,c,this.worldMatrix))}}return this};a.prototype.setNodeTransforms=function(a,e){var g=b.fromIdentity(),h=b.fromIdentity(),k=b.fromIdentity(),l=b.fromIdentity();e||(e=b.fromIdentity());for(var m=[],p=0;p<a.childNodes.length;p++){var q=a.childNodes[p];if(1===q.nodeType)switch(q.nodeName){case "matrix":q=f.bufferDataFloat32(q);g.copy(q);m.push(g);break;case "rotate":q=f.bufferDataFloat32(q);h.multiplyByRotation(q[0],q[1],q[2],q[3]);m.push(h);
    break;case "translate":q=f.bufferDataFloat32(q);k.multiplyByTranslation(q[0],q[1],q[2]);m.push(k);break;case "scale":q=f.bufferDataFloat32(q),l.multiplyByScale(q[0],q[1],q[2]),m.push(l)}}for(p=0;p<m.length;p++)this.localMatrix.multiplyMatrix(m[p]);this.worldMatrix.setToMultiply(e,this.localMatrix);this.normalMatrix=b.fromIdentity();g=new c(0,0,0);this.worldMatrix.extractRotationAngles(g);this.normalMatrix.multiplyByRotation(-1,0,0,g[0]);this.normalMatrix.multiplyByRotation(0,-1,0,g[1]);this.normalMatrix.multiplyByRotation(0,
    0,-1,g[2])};a.prototype.getLibraryNode=function(a,b){for(var c=0;c<a.length;c++){var h=a[c].attributes.getNamedItem("id");if(h&&h.value===b)return a[c]}return null};return a});
define("src/formats/collada/ColladaScene","../../error/ArgumentError ../../shaders/BasicTextureProgram ../../util/Color ../../util/Logger ../../geom/Matrix ../../geom/Position ../../pick/PickedObject ../../render/Renderable ../../geom/Vec3".split(" "),function(f,b,c,a,d,e,g,h,k){e=function(b,c){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"ColladaScene","constructor","missingPosition"));h.call(this);this._position=b;this._nodes=[];this._meshes={};this._materials={};this._images={};this._dirPath=
    this._upAxis="";this._zTranslation=this._yTranslation=this._xTranslation=this._zRotation=this._yRotation=this._xRotation=0;this._scale=1;this._altitudeMode=WorldWind.ABSOLUTE;this._useTexturePaths=this._localTransforms=!0;this._nodesToHide=[];this._hideNodes=!1;this.setSceneData(c);this._placePoint=new k(0,0,0);this._transformationMatrix=d.fromIdentity();this._normalMatrix=d.fromIdentity();this._texCoordMatrix=d.fromIdentity().setToUnitYFlip();this._activeTexture=null};e.prototype=Object.create(h.prototype);
    e.prototype.constructor=e;Object.defineProperties(e.prototype,{position:{get:function(){return this._position},set:function(a){this._position=a}},nodes:{get:function(){return this._nodes},set:function(a){this._nodes=a}},meshes:{get:function(){return this._meshes},set:function(a){this._meshes=a}},materials:{get:function(){return this._materials},set:function(a){this._materials=a}},images:{get:function(){return this._images},set:function(a){this._images=a}},upAxis:{get:function(){return this._upAxis},
        set:function(a){this._upAxis=a}},dirPath:{get:function(){return this._dirPath},set:function(a){this._dirPath=a}},xRotation:{get:function(){return this._xRotation},set:function(a){this._xRotation=a}},yRotation:{get:function(){return this._yRotation},set:function(a){this._yRotation=a}},zRotation:{get:function(){return this._zRotation},set:function(a){this._zRotation=a}},xTranslation:{get:function(){return this._xTranslation},set:function(a){this._xTranslation=a}},yTranslation:{get:function(){return this._yTranslation},
        set:function(a){this._yTranslation=a}},zTranslation:{get:function(){return this._zTranslation},set:function(a){this._zTranslation=a}},scale:{get:function(){return this._scale},set:function(a){this._scale=a}},placePoint:{get:function(){return this._placePoint},set:function(a){this._placePoint=a}},altitudeMode:{get:function(){return this._altitudeMode},set:function(a){this._altitudeMode=a}},transformationMatrix:{get:function(){return this._transformationMatrix},set:function(a){this._transformationMatrix=
        a}},normalMatrix:{get:function(){return this._normalMatrix},set:function(a){this._normalMatrix=a}},localTransforms:{get:function(){return this._localTransforms},set:function(a){this._localTransforms=a}},useTexturePaths:{get:function(){return this._useTexturePaths},set:function(a){this._useTexturePaths=a}},nodesToHide:{get:function(){return this._nodesToHide},set:function(a){this._nodesToHide=a}},hideNodes:{get:function(){return this._hideNodes},set:function(a){this._hideNodes=a}}});e.prototype.setSceneData=
        function(a){a&&(this.nodes=a.root.children,this.meshes=a.meshes,this.materials=a.materials,this.images=a.images,this.upAxis=a.metadata.up_axis,this.dirPath=a.dirPath)};e.prototype.render=function(a){var b;this.enabled&&(this.lastFrameTime!==a.timestamp&&(b=this.makeOrderedRenderable(a)),b&&(b.layer=a.currentLayer,this.lastFrameTime=a.timestamp,a.addOrderedRenderable(b)))};e.prototype.makeOrderedRenderable=function(a){a.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,
        this.altitudeMode,this.placePoint);this.eyeDistance=a.navigatorState.eyePoint.distanceTo(this.placePoint);return this};e.prototype.renderOrdered=function(a){this.drawOrderedScene(a);if(a.pickingMode){var b=new g(this.pickColor.clone(),this,this.position,this.layer,!1);a.resolvePick(b)}};e.prototype.drawOrderedScene=function(a){this.beginDrawing(a);try{this.doDrawOrderedScene(a)}finally{this.endDrawing(a)}};e.prototype.beginDrawing=function(a){var d=a.currentGlContext;a.findAndBindProgram(b);d.enable(d.CULL_FACE);
        d.enable(d.DEPTH_TEST)};e.prototype.doDrawOrderedScene=function(a){a.pickingMode&&(this.pickColor=a.uniquePickColor());this.computeTransformationMatrix(a.globe);for(var b=0,d=this.nodes.length;b<d;b++)this.traverseNodeTree(a,this.nodes[b])};e.prototype.traverseNodeTree=function(a,b){if(this.mustRenderNode(b.id)){if(b.mesh)for(var d=this.meshes[b.mesh].buffers,c=0,g=d.length;c<g;c++){for(var e=d[c].material,h=0;h<b.materials.length;h++)if(e===b.materials[h].symbol){var f=b.materials[h].id;break}this.draw(a,
        d[c],this.materials[f],b.worldMatrix,b.normalMatrix)}for(d=0;d<b.children.length;d++)this.traverseNodeTree(a,b.children[d])}};e.prototype.draw=function(a,b,d,c,g){var e=a.currentGlContext,h=a.currentProgram;this.applyVertices(a,b);h.loadTextureEnabled(e,!1);this.applyColor(a,d);(h=d&&null!=d.textures&&b.uvs&&0<b.uvs.length)&&this.applyTexture(a,b,d);(d=null!=b.normals&&0<b.normals.length)&&this.applyLighting(a,b);this.applyMatrix(a,d,h,c,g);this.applyIndices(a,b);e.drawElements(e.TRIANGLES,b.indices.length,
        e.UNSIGNED_SHORT,0);this.resetDraw(a,d,h)};e.prototype.applyVertices=function(a,b){var d=a.currentGlContext,c=a.currentProgram,g;b.verticesVboCacheKey||(b.verticesVboCacheKey=a.gpuResourceCache.generateCacheKey());g=a.gpuResourceCache.resourceForKey(b.verticesVboCacheKey);g||(g=d.createBuffer(),a.gpuResourceCache.putResource(b.verticesVboCacheKey,g,b.vertices.length),b.refreshVertexBuffer=!0);d.bindBuffer(d.ARRAY_BUFFER,g);b.refreshVertexBuffer&&(d.bufferData(d.ARRAY_BUFFER,b.vertices,d.STATIC_DRAW),
        a.frameStatistics.incrementVboLoadCount(1),b.refreshVertexBuffer=!1);d.enableVertexAttribArray(c.vertexPointLocation);d.vertexAttribPointer(c.vertexPointLocation,3,d.FLOAT,!1,0,0)};e.prototype.applyColor=function(a,b){var d=a.currentGlContext,g=a.currentProgram;if(b)var e="constant"===b.techniqueType?b.reflective:b.diffuse;var h,f=1,k=1,x=1;h=1;e&&(f=e[0],k=e[1],x=e[2],h=null!=e[3]?e[3]:1);e=new c(f,k,x,h);h*=a.currentLayer.opacity;d.depthMask(1<=h||a.pickingMode);g.loadColor(d,a.pickingMode?this.pickColor:
        e);g.loadOpacity(d,a.pickingMode?0<h?1:0:h)};e.prototype.applyTexture=function(a,b,d){var c=a.currentGlContext,g=a.currentProgram;d=d.textures.diffuse?d.textures.diffuse.mapId:d.textures.reflective.mapId;var e=this.useTexturePaths?this.images[d].path:this.images[d].filename;this._activeTexture=a.gpuResourceCache.resourceForKey(this.dirPath+e+"");this._activeTexture||(d=b.isClamp?c.CLAMP_TO_EDGE:c.REPEAT,this._activeTexture=a.gpuResourceCache.retrieveTexture(c,this.dirPath+e+"",d));this._activeTexture&&
    this._activeTexture.bind(a)&&(b.texCoordsVboCacheKey||(b.texCoordsVboCacheKey=a.gpuResourceCache.generateCacheKey()),d=a.gpuResourceCache.resourceForKey(b.texCoordsVboCacheKey),d||(d=c.createBuffer(),a.gpuResourceCache.putResource(b.texCoordsVboCacheKey,d,b.uvs.length),b.refreshTexCoordBuffer=!0),c.bindBuffer(c.ARRAY_BUFFER,d),b.refreshTexCoordBuffer&&(c.bufferData(c.ARRAY_BUFFER,b.uvs,c.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),b.refreshTexCoordBuffer=!1),g.loadTextureEnabled(c,!0),
        c.enableVertexAttribArray(g.vertexTexCoordLocation),c.vertexAttribPointer(g.vertexTexCoordLocation,2,c.FLOAT,!1,0,0),g.loadTextureUnit(c,c.TEXTURE0),g.loadModulateColor(c,a.pickingMode))};e.prototype.applyLighting=function(a,b){var d,c=a.currentGlContext,g=a.currentProgram;g.loadApplyLighting(c,!0);b.normalsVboCacheKey||(b.normalsVboCacheKey=a.gpuResourceCache.generateCacheKey());d=a.gpuResourceCache.resourceForKey(b.normalsVboCacheKey);d||(d=c.createBuffer(),a.gpuResourceCache.putResource(b.normalsVboCacheKey,
        d,b.normals.length),b.refreshNormalBuffer=!0);c.bindBuffer(c.ARRAY_BUFFER,d);b.refreshNormalBuffer&&(c.bufferData(c.ARRAY_BUFFER,b.normals,c.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),b.refreshNormalBuffer=!1);c.enableVertexAttribArray(g.normalVectorLocation);c.vertexAttribPointer(g.normalVectorLocation,3,c.FLOAT,!1,0,0)};e.prototype.applyMatrix=function(a,b,c,g,e){var h=d.fromIdentity();h.copy(a.navigatorState.modelviewProjection);h.multiplyMatrix(this.transformationMatrix);g&&this.localTransforms&&
    h.multiplyMatrix(g);b&&(b=d.fromIdentity(),b.copy(a.navigatorState.modelviewNormalTransform),b.multiplyMatrix(this.normalMatrix),e&&this.localTransforms&&b.multiplyMatrix(e),a.currentProgram.loadModelviewInverse(a.currentGlContext,b));c&&this._activeTexture&&(a.currentProgram.loadTextureMatrix(a.currentGlContext,this._texCoordMatrix),this._activeTexture=null);a.currentProgram.loadModelviewProjection(a.currentGlContext,h)};e.prototype.applyIndices=function(a,b){var d=a.currentGlContext,c;b.indicesVboCacheKey||
    (b.indicesVboCacheKey=a.gpuResourceCache.generateCacheKey());c=a.gpuResourceCache.resourceForKey(b.indicesVboCacheKey);c||(c=d.createBuffer(),a.gpuResourceCache.putResource(b.indicesVboCacheKey,c,b.indices.length),b.refreshIndicesBuffer=!0);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c);b.refreshIndicesBuffer&&(d.bufferData(d.ELEMENT_ARRAY_BUFFER,b.indices,d.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),b.refreshIndicesBuffer=!1)};e.prototype.resetDraw=function(a,b,d){var c=a.currentGlContext;a=
        a.currentProgram;b&&(a.loadApplyLighting(c,!1),c.disableVertexAttribArray(a.normalVectorLocation));d&&c.disableVertexAttribArray(a.vertexTexCoordLocation);c.disableVertexAttribArray(a.vertexPointLocation)};e.prototype.endDrawing=function(a){a.bindProgram(null)};e.prototype.computeTransformationMatrix=function(a){this.transformationMatrix=d.fromIdentity();this.transformationMatrix.multiplyByLocalCoordinateTransform(this.placePoint,a);this.transformationMatrix.multiplyByRotation(1,0,0,this.xRotation);
        this.transformationMatrix.multiplyByRotation(0,1,0,this.yRotation);this.transformationMatrix.multiplyByRotation(0,0,1,this.zRotation);this.transformationMatrix.multiplyByScale(this.scale,this.scale,this.scale);this.transformationMatrix.multiplyByTranslation(this.xTranslation,this.yTranslation,this.zTranslation);this.computeNormalMatrix()};e.prototype.computeNormalMatrix=function(){var a=new k(0,0,0);this.transformationMatrix.extractRotationAngles(a);this.normalMatrix=d.fromIdentity();this.normalMatrix.multiplyByRotation(-1,
        0,0,a[0]);this.normalMatrix.multiplyByRotation(0,-1,0,a[1]);this.normalMatrix.multiplyByRotation(0,0,-1,a[2])};e.prototype.mustRenderNode=function(a){var b=!0;this.hideNodes&&(b=-1===this.nodesToHide.indexOf(a));return b};return e});
define("src/formats/collada/ColladaLoader","../../error/ArgumentError ./ColladaAsset ./ColladaImage ./ColladaMaterial ./ColladaMesh ./ColladaNode ./ColladaScene ./ColladaUtils ../../util/Logger".split(" "),function(f,b,c,a,d,e,g,h,k){var l=function(a,b){if(!a)throw new f(k.logMessage(k.LEVEL_SEVERE,"ColladaLoader","constructor","missingPosition"));this.position=a;this.dirPath="/";this.init(b)};l.prototype.init=function(a){a&&(this.dirPath=a.dirPath||"/");this.scene={type:"SceneTree",dirPath:this.dirPath,
    images:{},metadata:{},materials:{},meshes:{},root:{children:[]}};this.xmlDoc=null};l.prototype.load=function(a,b){-1===a.indexOf("://")&&(a=this.dirPath+a);h.fetchFile(a,function(a){if(a)try{c=this.parse(a)}catch(d){c=null,k.log(k.LEVEL_SEVERE,"error parsing collada file: "+d)}else var c=null;b(c)}.bind(this))};l.prototype.parse=function(a){this.init();this.xmlDoc=(new DOMParser).parseFromString(a,"text/xml");a=this.xmlDoc.querySelectorAll("library_nodes node");var d=this.xmlDoc.querySelectorAll("library_effects effect");
    this.scene.metadata=(new b(this.xmlDoc)).parse();this.parseLib("visual_scene",a);this.parseLib("library_geometries");this.parseLib("library_materials",d);this.parseLib("library_images");this.xmlDoc=null;return new g(this.position,this.scene)};l.prototype.parseLib=function(b,g){var l=this.xmlDoc.getElementsByTagName(b),f=[];l&&l.length&&(f=l[0].childNodes);for(l=0;l<f.length;l++){var k=f[l];if(1===k.nodeType)switch(k.nodeName){case "node":(k=(new e).parse(k,g))&&this.scene.root.children.push(k);break;
    case "geometry":var u=k.getAttribute("id"),k=k.querySelector("mesh");(k=(new d(u)).parse(k))&&(this.scene.meshes[u]=k);break;case "material":u=k.getAttribute("id");k=k.querySelector("instance_effect").getAttribute("url").substr(1);k=h.querySelectorById(g,k);(k=(new a(u)).parse(k))&&(this.scene.materials[u]=k);break;case "image":var u=k.getAttribute("id"),w=k.getAttribute("name");(k=(new c(u,w)).parse(k))&&(this.scene.images[u]=k)}}};return l});
define("src/shapes/ScreenImage","../error/ArgumentError ../shaders/BasicTextureProgram ../util/Color ../util/ImageSource ../util/Logger ../geom/Matrix ../util/Offset ../pick/PickedObject ../render/Renderable ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m){var p=function(a,b){if(!a)throw new f(d.logMessage(d.LEVEL_SEVERE,"ScreenImage","constructor","missingOffset"));if(!b)throw new f(d.logMessage(d.LEVEL_SEVERE,"ScreenImage","constructor","missingImage"));k.call(this);this.screenOffset=
    a;this._imageSource=b;this.imageColor=c.WHITE;this.imageOffset=new g(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5);this.imageScale=1;this.imageTilt=this.imageRotation=0;this.enabled=!0;this.opacity=1;this.activeTexture=this.pickDelegate=null;this.imageTransform=e.fromIdentity();this.texCoordMatrix=e.fromIdentity();this.layer=this.imageBounds=null};p.matrix=e.fromIdentity();p.prototype=Object.create(k.prototype);Object.defineProperties(p.prototype,{imageSource:{get:function(){return this._imageSource},
    set:function(a){if(!a)throw new f(d.logMessage(d.LEVEL_SEVERE,"ScreenImage","imageSource","missingImage"));this._imageSource=a;this.imageSourceWasUpdated=!0}}});p.prototype.render=function(a){if(this.enabled&&a.accumulateOrderedRenderables){var b=null;this.lastFrameTime!==a.timestamp&&(b=this.makeOrderedRenderable(a));b&&b.isVisible(a)&&(b.layer=a.currentLayer,this.lastFrameTime=a.timestamp,a.addOrderedRenderable(b))}};p.prototype.renderOrdered=function(a){this.drawOrderedScreenImage(a);if(a.pickingMode){var b=
    new h(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);a.resolvePick(b)}};p.prototype.makeOrderedRenderable=function(a){var b,d,c,g;this.activeTexture=this.getActiveTexture(a);if(!this.activeTexture||this.imageSourceWasUpdated)if(this.activeTexture=a.gpuResourceCache.retrieveTexture(a.currentGlContext,this._imageSource),!this.activeTexture)return null;this.eyeDistance=0;b=this.activeTexture.imageWidth;d=this.activeTexture.imageHeight;c=this.imageScale;g=this.imageOffset.offsetForSize(b,
    d);a=this.screenOffset.offsetForSize(a.navigatorState.viewport.width,a.navigatorState.viewport.height);this.imageTransform.setTranslation(a[0]-g[0]*c,a[1]-g[1]*c,0);this.imageTransform.setScale(b*c,d*c,1);this.imageBounds=m.boundingRectForUnitQuad(this.imageTransform);return this};p.prototype.getActiveTexture=function(a){return a.gpuResourceCache.resourceForKey(this._imageSource)};p.prototype.isVisible=function(a){return a.pickingMode?a.pickRectangle&&this.imageBounds.intersects(a.pickRectangle):
    this.imageBounds.intersects(a.navigatorState.viewport)};p.prototype.drawOrderedScreenImage=function(a){this.beginDrawing(a);try{this.doDrawOrderedScreenImage(a)}finally{this.endDrawing(a)}};p.prototype.beginDrawing=function(a){var d=a.currentGlContext,c;a.findAndBindProgram(b);c=a.currentProgram;d.bindBuffer(d.ARRAY_BUFFER,a.unitQuadBuffer());d.vertexAttribPointer(c.vertexTexCoordLocation,2,d.FLOAT,!1,0,0);d.enableVertexAttribArray(c.vertexPointLocation);d.enableVertexAttribArray(c.vertexTexCoordLocation);
    c.loadTextureUnit(d,d.TEXTURE0);c.loadModulateColor(d,a.pickingMode)};p.prototype.endDrawing=function(a){var b=a.currentGlContext;a=a.currentProgram;b.disableVertexAttribArray(a.vertexPointLocation);b.disableVertexAttribArray(a.vertexTexCoordLocation);b.bindBuffer(b.ARRAY_BUFFER,null);b.bindTexture(b.TEXTURE_2D,null);b.enable(b.DEPTH_TEST)};p.prototype.doDrawOrderedScreenImage=function(a){var b=a.currentGlContext,d=a.currentProgram;b.bindBuffer(b.ARRAY_BUFFER,a.unitQuadBuffer3());b.vertexAttribPointer(d.vertexPointLocation,
    3,b.FLOAT,!1,0,0);p.matrix.copy(a.screenProjection);p.matrix.multiplyMatrix(this.imageTransform);p.matrix.multiplyByTranslation(.5,.5,.5);p.matrix.multiplyByRotation(1,0,0,this.imageTilt);p.matrix.multiplyByRotation(0,0,1,this.imageRotation);p.matrix.multiplyByTranslation(-.5,-.5,0);d.loadModelviewProjection(b,p.matrix);d.loadTextureEnabled(b,!0);a.pickingMode?(this.pickColor=a.uniquePickColor(),d.loadColor(b,this.pickColor)):(d.loadColor(b,this.imageColor),d.loadOpacity(b,this.opacity*this.layer.opacity));
    this.texCoordMatrix.setToIdentity();this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture);d.loadTextureMatrix(b,this.texCoordMatrix);this.activeTexture.bind(a)&&b.drawArrays(b.TRIANGLE_STRIP,0,4)};return p});
define("src/shapes/Compass",["../error/ArgumentError","../util/Logger","../util/Offset","../shapes/ScreenImage"],function(f,b,c,a){f=function(b,e){var g=b?b:new c(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,1);a.call(this,g,e?e:WorldWind.configuration.baseUrl+"images/notched-compass.png");b||(this.imageOffset=new c(WorldWind.OFFSET_FRACTION,1.1,WorldWind.OFFSET_FRACTION,1.1));this.size=.15};f.prototype=Object.create(a.prototype);f.prototype.render=function(b){this.imageRotation=b.navigatorState.heading;
    this.imageTilt=b.navigatorState.tilt;var c=this.getActiveTexture(b);c&&(this.imageScale=.15*b.currentGlContext.drawingBufferWidth/c.imageWidth);a.prototype.render.call(this,b)};return f});
define("src/layer/CompassLayer",["../shapes/Compass","../layer/RenderableLayer"],function(f,b){var c=function(){b.call(this,"Compass");this._compass=new f(null,null);this.addRenderable(this._compass)};c.prototype=Object.create(b.prototype);Object.defineProperties(c.prototype,{compass:{get:function(){return this._compass},set:function(a){a&&a instanceof f&&(this.removeAllRenderables(),this.addRenderable(a),this._compass=a)}}});return c});
define("src/shapes/Text","../error/ArgumentError ../shaders/BasicTextureProgram ../util/Color ../util/Font ../util/Logger ../geom/Matrix ../pick/PickedObject ../render/Renderable ../shapes/TextAttributes ../error/UnsupportedOperationError ../geom/Vec2 ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q){var t=function(a){if(!a)throw new f(d.logMessage(d.LEVEL_SEVERE,"Text","constructor","missingText"));h.call(this);this.attributes=new k(null);this.highlightAttributes=null;this.highlighted=
    !1;this.enabled=!0;this.text=a;this.altitudeMode=WorldWind.ABSOLUTE;this.pickDelegate=null;this.alwaysOnTop=!1;this.currentVisibility=this.targetVisibility=1;this.declutterGroup=0;this.markerImageSource=WorldWind.configuration.baseUrl+"images/white-dot.png";this.markerImageScale=.1;this.activeTexture=this.activeAttributes=null;this.imageTransform=e.fromIdentity();this.texCoordMatrix=e.fromIdentity();this.layer=this.imageBounds=null;this.depthOffset=-.003;this.screenPoint=new p(0,0,0)};t.matrix=e.fromIdentity();
    t.glPickPoint=new p(0,0,0);t.prototype=Object.create(h.prototype);t.prototype.copy=function(a){this.text=a.text;this.attributes=a.attributes;this.highlightAttributes=a.highlightAttributes;this.highlighted=a.highlighted;this.enabled=a.enabled;this.altitudeMode=a.altitudeMode;this.pickDelegate=a.pickDelegate;this.alwaysOnTop=a.alwaysOnTop;this.depthOffset=a.depthOffset;this.declutterGroup=a.declutterGroup;this.targetVisibility=a.targetVisibility;this.currentVisibility=a.currentVisibility;return this};
    Object.defineProperties(t.prototype,{screenBounds:{get:function(){return this.imageBounds}}});t.prototype.render=function(a){if(this.enabled&&this.text&&0!==this.text.length&&a.accumulateOrderedRenderables){var b;(b=this.lastFrameTime!=a.timestamp?this.makeOrderedRenderable(a):this.clone().makeOrderedRenderable(a))&&b.isVisible(a)&&(b.layer=a.currentLayer,this.lastFrameTime=a.timestamp,a.addOrderedRenderable(b))}};t.prototype.renderOrdered=function(a){if(0!==this.currentVisibility||0!==this.targetVisibility||
        this.markerImageSource)if(this.drawOrderedText(a),a.pickingMode){var b=new g(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,this.position,this.layer,!1);a.resolvePick(b)}};t.prototype.makeOrderedRenderable=function(a){var b,d,c;this.determineActiveAttributes(a);if(!this.activeAttributes||!this.computeScreenPointAndEyeDistance(a))return null;b=this.activeAttributes.font;d=this.text+b.toString();this.activeTexture=a.gpuResourceCache.resourceForKey(d);this.activeTexture||(this.activeTexture=
        a.textSupport.createTexture(a,this.text,b,!0),a.gpuResourceCache.putResource(d,this.activeTexture,this.activeTexture.size));a=this.activeTexture.imageWidth;b=this.activeTexture.imageHeight;d=this.activeAttributes.scale;c=this.activeAttributes.offset.offsetForSize(a,b);this.imageTransform.setTranslation(this.screenPoint[0]-c[0]*d,this.screenPoint[1]-c[1]*d,this.screenPoint[2]);this.imageTransform.setScale(a*d,b*d,1);this.imageBounds=q.boundingRectForUnitQuad(this.imageTransform);return this};t.prototype.computeScreenPointAndEyeDistance=
        function(a){throw new l(d.logMessage(d.LEVEL_SEVERE,"Renderable","render","abstractInvocation"));};t.prototype.determineActiveAttributes=function(a){this.activeAttributes=this.highlighted&&this.highlightAttributes?this.highlightAttributes:this.attributes};t.prototype.isVisible=function(a){return a.pickingMode?a.pickRectangle&&this.imageBounds.intersects(a.pickRectangle):this.imageBounds.intersects(a.navigatorState.viewport)};t.prototype.drawOrderedText=function(a){this.beginDrawing(a);try{this.doDrawOrderedText(a)}finally{this.endDrawing(a)}};
    t.prototype.drawBatchOrderedText=function(a){for(var b;(b=a.peekOrderedRenderable())&&b instanceof t;){a.popOrderedRenderable();try{b.doDrawOrderedText(a)}catch(c){d.logMessage(d.LEVEL_WARNING,"Text","drawBatchOrderedText","Error occurred while rendering text using batching: "+c.message)}}};t.prototype.beginDrawing=function(a){var d=a.currentGlContext,c;a.findAndBindProgram(b);c=a.currentProgram;d.bindBuffer(d.ARRAY_BUFFER,a.unitQuadBuffer3());d.vertexAttribPointer(c.vertexPointLocation,3,d.FLOAT,
        !1,0,0);d.bindBuffer(d.ARRAY_BUFFER,a.unitQuadBuffer());d.vertexAttribPointer(c.vertexTexCoordLocation,2,d.FLOAT,!1,0,0);d.enableVertexAttribArray(c.vertexPointLocation);d.enableVertexAttribArray(c.vertexTexCoordLocation);c.loadTextureUnit(d,d.TEXTURE0);a.pickingMode&&c.loadTextureEnabled(d,!1);c.loadModulateColor(d,!1);d.depthMask(!1);t.currentTexture=null};t.prototype.endDrawing=function(a){var b=a.currentGlContext;a=a.currentProgram;b.disableVertexAttribArray(a.vertexPointLocation);b.disableVertexAttribArray(a.vertexTexCoordLocation);
        b.bindBuffer(b.ARRAY_BUFFER,null);b.bindTexture(b.TEXTURE_2D,null);b.depthMask(!0);t.currentTexture=null};t.prototype.doDrawOrderedText=function(a){var b=a.currentGlContext,d=a.currentProgram,c;a.pickingMode&&(this.pickColor=a.uniquePickColor());if(!a.pickingMode&&this.currentVisibility!=this.targetVisibility){var g=(a.timestamp-a.previousRedrawTimestamp)/a.fadeTime;this.currentVisibility=this.currentVisibility<this.targetVisibility?Math.min(1,this.currentVisibility+g):Math.max(0,this.currentVisibility-
        g);a.redrawRequested=!0}0<this.currentVisibility&&(t.matrix.copy(a.screenProjection),t.matrix.multiplyMatrix(this.imageTransform),d.loadModelviewProjection(b,t.matrix),a.pickingMode?(d.loadColor(b,this.pickColor),d.loadTextureEnabled(b,!1)):(d.loadColor(b,this.activeAttributes.color),d.loadOpacity(b,this.layer.opacity*this.currentVisibility),this.texCoordMatrix.setToIdentity(),this.activeTexture&&this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture),d.loadTextureMatrix(b,this.texCoordMatrix),
    this.activeTexture&&this.activeTexture!=t.currentTexture&&(c=this.activeTexture.bind(a),d.loadTextureEnabled(b,c),t.currentTexture=this.activeTexture)),this.activeAttributes.depthTest||b.disable(b.DEPTH_TEST,!1),b.drawArrays(b.TRIANGLE_STRIP,0,4),this.activeAttributes.depthTest||b.disable(b.DEPTH_TEST,!0));if(1>this.currentVisibility&&this.markerImageSource)if(g=a.gpuResourceCache.resourceForKey(this.markerImageSource)){c=this.markerImageScale;var h=e.fromIdentity();h.setTranslation(this.screenPoint[0]-
        c*g.imageWidth/2,this.screenPoint[1]-c*g.imageWidth/2,this.screenPoint[2]);h.setScale(g.imageWidth*c,g.imageHeight*c,1);t.matrix.copy(a.screenProjection);t.matrix.multiplyMatrix(h);d.loadModelviewProjection(b,t.matrix);a.pickingMode?(d.loadColor(b,this.pickColor),d.loadTextureEnabled(b,!1)):(d.loadColor(b,this.activeAttributes.color),d.loadOpacity(b,this.layer.opacity*(1-this.currentVisibility)),c=e.fromIdentity(),c.multiplyByTextureTransform(g),d.loadTextureMatrix(b,c),g!=t.currentTexture&&(c=g.bind(a),
        d.loadTextureEnabled(b,c),t.currentTexture=g));this.activeAttributes.depthTest||b.disable(b.DEPTH_TEST,!1);b.drawArrays(b.TRIANGLE_STRIP,0,4);this.activeAttributes.depthTest||b.enable(b.DEPTH_TEST,!0)}else a.gpuResourceCache.retrieveTexture(a.currentGlContext,this.markerImageSource)};return t});
define("src/shapes/ScreenText",["../error/ArgumentError","../util/Logger","../util/Offset","../shapes/Text"],function(f,b,c,a){c=function(d,c){if(!d)throw new f(b.logMessage(b.LEVEL_SEVERE,"Text","constructor","missingOffset"));a.call(this,c);this.screenOffset=d;this.altitudeMode=null};c.prototype=Object.create(a.prototype);c.prototype.render=function(b){this.lastFrameTime!=b.timestamp&&a.prototype.render.call(this,b)};c.prototype.computeScreenPointAndEyeDistance=function(a){a=a.currentGlContext;
    a=this.screenOffset.offsetForSize(a.drawingBufferWidth,a.drawingBufferHeight);this.screenPoint[0]=a[0];this.screenPoint[1]=a[1];this.eyeDistance=this.screenPoint[2]=0;return!0};return c});
define("src/layer/CoordinatesDisplayLayer","../error/ArgumentError ../util/Color ../util/Font ../layer/Layer ../util/Logger ../util/Offset ../geom/Position ../shapes/ScreenImage ../shapes/ScreenText ../shapes/TextAttributes ../geom/Vec2".split(" "),function(f,b,c,a,d,e,g,h,k,l,m){c=function(c){function g(a){r.handleUIEvent(a)}if(!c)throw new f(d.logMessage(d.LEVEL_SEVERE,"ViewControlsLayer","constructor","missingWorldWindow"));a.call(this,"Coordinates");this.wwd=c;this.pickEnabled=!1;this.terrainPosition=
    this.clientY=this.clientX=this.eventType=null;this.latText=new k(new e(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," ");this.latText.attributes=new l(null);this.latText.attributes.color=b.YELLOW;this.lonText=new k(new e(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," ");this.lonText.attributes=new l(null);this.lonText.attributes.color=b.YELLOW;this.elevText=new k(new e(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," ");this.elevText.attributes=new l(null);this.elevText.attributes.color=
    b.YELLOW;this.eyeText=new k(new e(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," ");this.eyeText.attributes=new l(null);this.eyeText.attributes.color=b.YELLOW;var m=new e(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5);this.crosshairImage=new h(m,WorldWind.configuration.baseUrl+"images/crosshair.png");var r=this;window.PointerEvent?(c.addEventListener("pointerdown",g),c.addEventListener("pointermove",g),c.addEventListener("pointerleave",g)):(c.addEventListener("mousedown",g),c.addEventListener("mousemove",
    g),c.addEventListener("mouseleave",g),c.addEventListener("touchstart",g),c.addEventListener("touchmove",g));this.wwd.redrawCallbacks.push(function(a,b){r.handleRedraw(b)})};c.prototype=Object.create(a.prototype);c.prototype.doRender=function(a){var b=this.terrainPosition,d=a.eyePosition,c=a.currentGlContext.canvas.clientWidth,g,h,l,k;650<c?(c=c/2-50,g=5,h=WorldWind.OFFSET_PIXELS,l=0):400<c?(c=60,g=5,h=WorldWind.OFFSET_INSET_PIXELS,l=1):(c=60,g=5,h=WorldWind.OFFSET_INSET_PIXELS,l=1,k=!0);this.latText.text=
    b?this.formatLatitude(b.latitude):null;this.latText.screenOffset=new e(WorldWind.OFFSET_PIXELS,c,h,g);this.latText.attributes.offset=new e(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,l);this.latText.render(a);c+=70;this.lonText.text=b?this.formatLongitude(b.longitude):null;this.lonText.screenOffset=new e(WorldWind.OFFSET_PIXELS,c,h,g);this.lonText.attributes.offset=new e(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,l);this.lonText.render(a);a.globe.is2D()||(c+=70,this.elevText.text=
    b?this.formatAltitude(b.altitude,"m"):null,this.elevText.screenOffset=new e(WorldWind.OFFSET_PIXELS,c,h,g),this.elevText.attributes.offset=new e(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,l),this.elevText.render(a));k||(c+=40,this.eyeText.text="Eye  "+this.formatAltitude(d.altitude,1E3>d.altitude?"m":"km"),this.eyeText.screenOffset=new e(WorldWind.OFFSET_PIXELS,c,h,g),this.eyeText.attributes.offset=new e(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,l),this.eyeText.render(a));"touch"==
this.eventType&&this.crosshairImage.render(a);this.inCurrentFrame=!0};c.prototype.handleUIEvent=function(a){-1!=a.type.indexOf("pointer")?this.eventType=a.pointerType:-1!=a.type.indexOf("mouse")?this.eventType="mouse":-1!=a.type.indexOf("touch")&&(this.eventType="touch");-1!=a.type.indexOf("leave")?this.clientY=this.clientX=null:(this.clientX=a.clientX,this.clientY=a.clientY);this.wwd.redraw()};c.prototype.handleRedraw=function(a){if(a==WorldWind.BEFORE_REDRAW){var b;("mouse"==this.eventType||"pen"==
this.eventType)&&this.clientX&&this.clientY?(a=this.wwd.canvasCoordinates(this.clientX,this.clientY),0<=a[0]&&a[0]<this.wwd.canvas.width&&0<=a[1]&&a[1]<this.wwd.canvas.height&&(b=this.wwd.pickTerrain(a).terrainObject())):"touch"==this.eventType&&(a=new m(this.wwd.canvas.width/2,this.wwd.canvas.height/2),b=this.wwd.pickTerrain(a).terrainObject());this.terrainPosition=b?b.position:null}};c.prototype.formatLatitude=function(a){var b=0>a?"\u00b0S":"\u00b0N";return Math.abs(a).toFixed(2)+b};c.prototype.formatLongitude=
    function(a){var b=0>a?"\u00b0W":"\u00b0E";return Math.abs(a).toFixed(2)+b};c.prototype.formatAltitude=function(a,b){"km"===b&&(a/=1E3);return a.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")+" "+b};return c});
define("src/util/Date",[],function(){var f=function(b){this._date=b?new Date(b):new Date};f.prototype=Object.create(Date.prototype);f.prototype.isAfter=function(b){return-1==this.compare(b)};f.prototype.isBefore=function(b){return 1==this.compare(b)};f.prototype.valueOf=function(){return this._date.valueOf()};f.prototype.getTime=function(){return this._date.getTime()};f.prototype.compare=function(b){var c=this._date.valueOf();b=b.valueOf();return c>b?-1:c<b?1:0};return f});
define("src/layer/DigitalGlobeTiledImageLayer","../geom/Angle ../error/ArgumentError ../util/Color ../geom/Location ../util/Logger ../geom/Sector ../layer/MercatorTiledImageLayer".split(" "),function(f,b,c,a,d,e,g){f=function(c,k,l){if(!k)throw new b(d.logMessage(d.LEVEL_SEVERE,"DigitalGlobeTiledImageLayer","constructor","The map ID is null or undefined."));if(!l)throw new b(d.logMessage(d.LEVEL_SEVERE,"DigitalGlobeTiledImageLayer","constructor","The access token is null or undefined."));this.imageSize=
    256;c=c||"Digital Globe";g.call(this,new e(-85.05,85.05,-180,180),new a(85.05,180),19,"image/jpeg",c,this.imageSize,this.imageSize);this.mapId=k;this.accessToken=l;this.displayName=c;this.pickEnabled=!1;this.destCanvas=document.createElement("canvas");this.destContext=this.destCanvas.getContext("2d");this.requestMetadata();var f=this;this.urlBuilder={urlForTile:function(a,b){return f.metadataRetrievalInProcess?null:f.urlTemplate.replace("{z}",a.level.levelNumber+1).replace("{x}",a.column).replace("{y}",
    a.row)}}};f.prototype=Object.create(g.prototype);f.prototype.requestMetadata=function(){if(!this.metadataRetrievalInProcess){this.metadataRetrievalInProcess=!0;var a="https://api.mapbox.com/v4/"+this.mapId+".json?secure&access_token="+this.accessToken,b=new XMLHttpRequest,d=this;b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){var a=JSON.parse(b.responseText);d.urlTemplate=a.tiles[0];a=document.createEvent("Event");a.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0);window.dispatchEvent(a);
    d.metadataRetrievalInProcess=!1}};b.open("GET",a,!0);b.send()}};f.prototype.doRender=function(a){g.prototype.doRender.call(this,a);this.inCurrentFrame&&a.screenCreditController.addStringCredit("\u00a9 Digital Globe",c.DARK_GRAY)};f.prototype.createTopLevelTiles=function(a){this.topLevelTiles=[];this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0));this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1));this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),
    1,0));this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))};f.prototype.mapSizeForLevel=function(a){return 256<<a+1};return f});
define("src/gesture/DragRecognizer",["../gesture/GestureRecognizer"],function(f){var b=function(b,a){f.call(this,b,a);this.button=0;this.interpretDistance=5};b.prototype=Object.create(f.prototype);b.prototype.mouseMove=function(b){if(this.state==WorldWind.POSSIBLE)this.shouldInterpret()&&(this.shouldRecognize()?(this.translationY=this.translationX=0,this.state=WorldWind.BEGAN):this.state=WorldWind.FAILED);else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)this.state=WorldWind.CHANGED};
    b.prototype.mouseUp=function(b){if(0==this.mouseButtonMask)if(this.state==WorldWind.POSSIBLE)this.state=WorldWind.FAILED;else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)this.state=WorldWind.ENDED};b.prototype.touchStart=function(b){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)};b.prototype.shouldInterpret=function(){var b=this.translationX,a=this.translationY;return Math.sqrt(b*b+a*a)>this.interpretDistance};b.prototype.shouldRecognize=function(){return 1<<this.button==
        this.mouseButtonMask};return b});
define("src/util/FrameStatistics",[],function(){var f=function(){this.frameTimeBase=this.frameTimeCumulative=this.frameCount=0;this.frameTimeExtremes=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];this.frameTimeMax=this.frameTimeMin=this.frameRateAverage=this.frameTimeAverage=this.vboLoadCount=this.textureLoadCount=this.tileUpdateCount=this.renderedTileCount=this.imageTileCount=this.terrainTileCount=this.orderedRenderingTime=this.layerRenderingTime=this.tessellationTime=this.frameTime=0};f.prototype.beginFrame=
    function(){this.frameTime=Date.now();this.vboLoadCount=this.textureLoadCount=this.tileUpdateCount=this.renderedTileCount=this.imageTileCount=this.terrainTileCount=this.orderedRenderingTime=this.layerRenderingTime=this.tessellationTime=0;++this.frameCount};f.prototype.endFrame=function(){var b=Date.now();this.frameTime=b-this.frameTime;this.frameTimeCumulative+=this.frameTime;this.frameTimeExtremes[0]=Math.min(this.frameTimeExtremes[0],this.frameTime);this.frameTimeExtremes[1]=Math.max(this.frameTimeExtremes[1],
    this.frameTime);2E3<b-this.frameTimeBase&&(this.frameTimeAverage=this.frameTimeCumulative/this.frameCount,this.frameRateAverage=1E3*this.frameCount/(b-this.frameTimeBase),this.frameTimeMin=this.frameTimeExtremes[0],this.frameTimeMax=this.frameTimeExtremes[1],this.frameTimeCumulative=this.frameCount=0,this.frameTimeBase=b,this.frameTimeExtremes=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY])};f.prototype.incrementRenderedTileCount=function(b){this.renderedTileCount+=b};f.prototype.setTerrainTileCount=
    function(b){this.terrainTileCount=b};f.prototype.incrementImageTileCount=function(b){this.imageTileCount=b};f.prototype.incrementTileUpdateCount=function(b){this.tileUpdateCount+=b};f.prototype.incrementTextureLoadCount=function(b){this.textureLoadCount+=b};f.prototype.incrementVboLoadCount=function(b){this.vboLoadCount+=b};return f});
define("src/render/FramebufferTexture",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(f,b){var c=function(a,d,c,g){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"FramebufferTexture","constructor","missingGlContext"));if(0>d||0>c)throw new f(b.logMessage(b.LEVEL_SEVERE,"FramebufferTexture","constructor","The framebuffer width or height is less than zero."));this.width=d;this.height=c;this.depth=g;this.size=d*c*4+(g?d*c*2:0);this.framebufferId=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,
    this.framebufferId);this.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,d,c,0,a.RGBA,a.UNSIGNED_BYTE,null);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture,0);this.depthBuffer=
    null;g&&(this.depthBuffer=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,this.depthBuffer),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,d,c),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,this.depthBuffer));d=a.checkFramebufferStatus(a.FRAMEBUFFER);d!=a.FRAMEBUFFER_COMPLETE&&(b.logMessage(b.LEVEL_WARNING,"FramebufferTexture","constructor","Error creating framebuffer: "+d),this.depthBuffer=this.texture=this.framebufferId=null);a.bindFramebuffer(a.FRAMEBUFFER,
    null);a.bindRenderbuffer(a.RENDERBUFFER,null);a.bindTexture(a.TEXTURE_2D,null)};c.prototype.bind=function(a){this.texture&&a.currentGlContext.bindTexture(gl.TEXTURE_2D,this.texture);return!!this.texture};return c});
define("src/render/FramebufferTile","../error/ArgumentError ../render/FramebufferTexture ../util/Logger ../geom/Matrix ../geom/Rectangle ../render/TextureTile".split(" "),function(f,b,c,a,d,e){d=function(b,d,k,l,m){if(!m||1>m.length)throw new f(c.logMessage(c.LEVEL_SEVERE,"FramebufferTile","constructor","The specified cache name is null, undefined or zero length."));e.call(this,b,d,k,l);this.gpuCacheKey=m;this.textureTransform=a.fromIdentity().setToUnitYFlip();this.mustClear=!0};d.prototype=Object.create(e.prototype);
    d.prototype.clearFramebuffer=function(a){this.mustClear=!0};d.prototype.bindFramebuffer=function(a){var b=a.gpuResourceCache.resourceForKey(this.gpuCacheKey);b||(b=this.createFramebuffer(a));a.bindFramebuffer(b);this.mustClear&&(this.doClearFramebuffer(a),this.mustClear=!1);return!0};d.prototype.createFramebuffer=function(a){var d=new b(a.currentGlContext,this.tileWidth,this.tileHeight,!1);a.gpuResourceCache.putResource(this.gpuCacheKey,d,d.size);return d};d.prototype.doClearFramebuffer=function(a){a=
        a.currentGlContext;a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT)};d.prototype.applyInternalTransform=function(a,b){b.multiplyMatrix(this.textureTransform)};return d});
define("src/render/FramebufferTileController","../error/ArgumentError ../render/FramebufferTile ../util/LevelSet ../geom/Location ../util/Logger ../cache/MemoryCache ../geom/Sector ../util/Tile".split(" "),function(f,b,c,a,d,e,g,h){var k=function(){this.tileHeight=this.tileWidth=256;this.detailControl=1.75;this.levels=new c(g.FULL_SPHERE,new a(45,45),16,this.tileWidth,this.tileHeight);this.topLevelTiles=[];this.currentTiles=[];this.currentGlobeStateKey=this.currentTimestamp=null;this.tileCache=new e(5E5,
    4E5);this.key="FramebufferTileController "+ ++k.keyPool};k.keyPool=0;k.prototype.selectTiles=function(a,b){if(!b)throw new f(d.logMessage(d.LEVEL_SEVERE,"FramebufferTileController","selectTiles","missingSector"));this.assembleTiles(a);for(var c=[],g=0,e=this.currentTiles.length;g<e;g++){var h=this.currentTiles[g];h.sector.overlaps(b)&&(h.selected=!0,c.push(h))}return c};k.prototype.render=function(a){if(0!=this.currentTiles.length){for(var b=[],d=0,c=this.currentTiles.length;d<c;d++){var g=this.currentTiles[d];
    g.selected&&b.push(g)}a.surfaceTileRenderer.renderTiles(a,b,1);var e=a.currentGlContext,h=a.currentFramebuffer;try{for(e.clearColor(0,0,0,0),d=0,c=b.length;d<c;d++)g=b[d],g.selected=!1,g.bindFramebuffer(a),e.clear(e.COLOR_BUFFER_BIT)}finally{a.bindFramebuffer(h)}}};k.prototype.assembleTiles=function(a){var b=a.timestamp,d=a.globeStateKey;if(this.currentTimestamp!=b||this.currentGlobeStateKey!=d)this.doAssembleTiles(a),this.currentTimestamp=b,this.currentGlobeStateKey=d};k.prototype.doAssembleTiles=
    function(a){this.currentTiles=[];if(a.terrain){0==this.topLevelTiles.length&&this.createTopLevelTiles();for(var b=0,d=this.topLevelTiles.length;b<d;b++){var c=this.topLevelTiles[b];c.update(a);this.isTileVisible(a,c)&&this.addTileOrDescendants(a,c)}}};k.prototype.createTile=function(a,d,c,g){return new b(a,d,c,g,this.key+" "+d.levelNumber+"."+c+"."+g)};k.prototype.createTopLevelTiles=function(){h.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)};k.prototype.addTileOrDescendants=
    function(a,b){if(this.tileMeetsRenderingCriteria(a,b))this.addTile(b);else for(var d=b.subdivideToCache(b.level.nextLevel(),this,this.tileCache),c=0,g=d.length;c<g;c++){var e=d[c];e.update(a);this.isTileVisible(a,e)&&this.addTileOrDescendants(a,e)}};k.prototype.addTile=function(a){this.currentTiles.push(a)};k.prototype.isTileVisible=function(a,b){return a.globe.projectionLimits&&!b.sector.overlaps(a.globe.projectionLimits)?!1:a.pickingMode?b.extent.intersectsFrustum(a.pickFrustum):b.extent.intersectsFrustum(a.navigatorState.frustumInModelCoordinates)};
    k.prototype.tileMeetsRenderingCriteria=function(a,b){var d=this.detailControl;if(75<=b.sector.minLatitude||-75>=b.sector.maxLatitude)d*=1.2;return b.level.isLastLevel()||!b.mustSubdivide(a,d)};return k});
define("src/globe/ElevationImage",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(f,b,c){var a=function(a,c,g,h){if(!a||1>a.length)throw new f(b.logMessage(b.LEVEL_SEVERE,"ElevationImage","constructor","The specified image path is null, undefined or zero length."));if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"ElevationImage","constructor","missingSector"));this.sector=c;this.imagePath=a;this.imageWidth=g;this.imageHeight=h;this.size=this.imageWidth*this.imageHeight};a.prototype.pixel=
    function(a,b){if(0>a||a>=this.imageWidth||0>b||b>=this.imageHeight)return 0;b=this.imageHeight-b-1;return this.imageData[a+b*this.imageWidth]};a.prototype.elevationAtLocation=function(a,b){var g=this.sector.maxLatitude,h=this.sector.minLongitude,f=this.sector.deltaLatitude(),l=this.sector.deltaLongitude(),h=(this.imageWidth-1)*(b-h)/l,m=(this.imageHeight-1)*(g-a)/f,g=Math.floor(c.clamp(h,0,this.imageWidth-1)),f=Math.floor(c.clamp(g+1,0,this.imageWidth-1)),l=Math.floor(c.clamp(m,0,this.imageHeight-
    1)),p=Math.floor(c.clamp(l+1,0,this.imageHeight-1)),q=this.imageData,h=h-g,m=m-l;return(1-h)*(1-m)*q[g+l*this.imageWidth]+h*(1-m)*q[f+l*this.imageWidth]+(1-h)*m*q[g+p*this.imageWidth]+h*m*q[f+p*this.imageWidth]};a.prototype.elevationsForGrid=function(a,e,g,h){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"ElevationImage","elevationsForSector","missingSector"));if(1>e||1>g)throw new f(b.logMessage(b.LEVEL_SEVERE,"ElevationImage","elevationsForSector","The specified number of sample points is less than 1."));
    if(!h)throw new f(b.logMessage(b.LEVEL_SEVERE,"ElevationImage","elevationsForSector","missingResult"));var k=this.sector.minLatitude,l=this.sector.maxLatitude,m=this.sector.minLongitude,p=this.sector.maxLongitude,q=l-k,t=p-m,r=a.minLatitude,u=a.maxLatitude,w=a.minLongitude;a=a.maxLongitude;var x=(u-r)/(1<e?e-1:1),A=(a-w)/(1<g?g-1:1),B,v,F,G=0,D=this.imageData;for(F=0;F<e;F+=1,r+=x)if(F===e-1&&(r=u),r>=k&&r<=l){B=(this.imageHeight-1)*(l-r)/q;var y=Math.floor(c.clamp(B,0,this.imageHeight-1)),H=Math.floor(c.clamp(y+
        1,0,this.imageHeight-1)),C=B-y;v=0;for(B=w;v<g;v+=1,B+=A){v===g-1&&(B=a);if(B>=m&&B<=p){var z=(this.imageWidth-1)*(B-m)/t,E=Math.floor(c.clamp(z,0,this.imageWidth-1)),L=Math.floor(c.clamp(E+1,0,this.imageWidth-1)),z=z-E;h[G]=(1-z)*(1-C)*D[E+y*this.imageWidth]+z*(1-C)*D[L+y*this.imageWidth]+(1-z)*C*D[E+H*this.imageWidth]+z*C*D[L+H*this.imageWidth]}G++}}else G+=g};a.prototype.minAndMaxElevationsForSector=function(a){var b=[];if(a)if(a.contains(this.sector))b[0]>this.minElevation&&(b[0]=this.minElevation),
b[1]<this.maxElevation&&(b[1]=this.maxElevation);else{var g=this.sector.maxLatitude,h=this.sector.minLongitude,f=this.sector.deltaLatitude(),l=this.sector.deltaLongitude(),m=Math.floor((this.imageHeight-1)*(g-a.maxLatitude)/f),g=Math.ceil((this.imageHeight-1)*(g-a.minLatitude)/f),f=Math.floor((this.imageWidth-1)*(a.minLongitude-h)/l);a=Math.ceil((this.imageWidth-1)*(a.maxLongitude-h)/l);m=c.clamp(m,0,this.imageHeight-1);g=c.clamp(g,0,this.imageHeight-1);f=c.clamp(f,0,this.imageWidth-1);a=c.clamp(a,
    0,this.imageWidth-1);for(var h=this.imageData,l=Number.MAX_VALUE,p=-l;m<=g;m++)for(var q=f;q<=a;q++){var t=h[Math.floor(q+m*this.imageWidth)];l>t&&(l=t);p<t&&(p=t)}b[0]>l&&(b[0]=l);b[1]<p&&(b[1]=p)}else b[0]=this.minElevation,b[1]=this.maxElevation;return b};a.prototype.findMinAndMaxElevation=function(){if(this.imageData&&0<this.imageData.length){this.minElevation=Number.MAX_VALUE;this.maxElevation=-this.minElevation;for(var a=this.imageData,b=this.imageWidth*this.imageHeight,c=0;c<b;c++){var h=a[c];
    this.minElevation>h&&(this.minElevation=h);this.maxElevation<h&&(this.maxElevation=h)}}else this.maxElevation=this.minElevation=0};return a});
define("src/globe/ElevationTile",["../error/ArgumentError","../util/Logger","../util/Tile"],function(f,b,c){var a=function(a,e,g,h,k,l){if(!k||1>k.length)throw new f(b.logMessage(b.LEVEL_SEVERE,"ElevationTile","constructor","The specified image path is null, undefined or zero length."));if(!l)throw new f(b.logMessage(b.LEVEL_SEVERE,"ElevationTile","constructor","The specified cache is null or undefined."));c.call(this,a,e,g,h);this.imagePath=k;this.memoryCache=l};a.prototype=Object.create(c.prototype);
    a.prototype.size=function(){return c.prototype.size.call(this)+this.imagePath.length+8};a.prototype.image=function(){return this.memoryCache.entryForKey(this.imagePath)};return a});
define("src/globe/ElevationModel","../util/AbsentResourceList ../geom/Angle ../error/ArgumentError ../globe/ElevationImage ../globe/ElevationTile ../util/LevelSet ../util/Logger ../cache/MemoryCache ../geom/Sector ../util/Tile ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m){var p=function(a,b,d,l,m,x,A){if(!a)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","constructor","missingSector"));if(!b)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","constructor","The specified level-zero delta is null or undefined."));
    if(!l)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","constructor","The specified image format is null or undefined."));if(!m)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","constructor","The specified cache path is null or undefined."));if(!d||1>d)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","constructor","The specified number of levels is not greater than zero."));if(!x||!A||1>x||1>A)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","constructor","The specified tile width or height is not greater than zero."));
    this.coverageSector=a;this.retrievalImageFormat=l;this.cachePath=m;this.displayName="Elevations";this.timestamp=Date.now();this.maxElevation=this.minElevation=0;this.pixelIsPoint=!0;this.levels=new e(this.coverageSector,b,d,x,A);this.currentTiles=[];this.currentSector=new k(0,0,0,0);this.tileCache=new h(1E6,8E5);this.imageCache=new h(1E7,8E6);this.currentRetrievals=[];this.absentResourceList=new f(3,5E3);this.id=++p.idPool;this.stateKey="elevationModel "+this.id.toString()+" "};p.idPool=0;p.prototype.minAndMaxElevationsForSector=
    function(a){if(!a)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","minAndMaxElevationsForSector","missingSector"));var d=this.levels.levelForTexelSize(a.deltaLatitude()*b.DEGREES_TO_RADIANS/64);this.assembleTiles(d,a,!1);if(0==this.currentTiles.length)return null;a=Number.MAX_VALUE;for(var d=-a,e,h,f=[],l=0,k=this.currentTiles.length;l<k;l++)if(e=this.currentTiles[l].image())h=e.minElevation,a>h&&(a=h),e=e.maxElevation,d<e&&(d=e);else return f[0]=this.minElevation,f[1]=this.maxElevation,
        f;f[0]=a;f[1]=d;return f};p.prototype.elevationAtLocation=function(a,b){return this.coverageSector.containsLocation(a,b)?this.pointElevationForLocation(a,b):0};p.prototype.elevationsForGrid=function(a,b,d,e,h){if(!a)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","elevationsForSector","missingSector"));if(!h)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","elevationsForSector","missingResult"));if(!b||!d||1>b||1>d)throw new c(g.logMessage(g.LEVEL_SEVERE,"ElevationModel","constructor",
    "The specified number of latitudinal or longitudinal positions is less than one."));e=this.levels.levelForTexelSize(e);return this.pixelIsPoint?this.pointElevationsForGrid(a,b,d,e,h):this.areaElevationsForGrid(a,b,d,e,h)};p.prototype.pointElevationForLocation=function(a,b){for(var d=this.levels.lastLevel(),c=d.tileDelta.longitude,g=l.computeRow(d.tileDelta.latitude,a),c=l.computeColumn(c,b),e,d=d.levelNumber;0<=d;d--){if(e=this.tileCache.entryForKey(d+"."+g+"."+c))if(e=e.image())return e.elevationAtLocation(a,
    b);g=Math.floor(g/2);c=Math.floor(c/2)}return 0};p.prototype.pointElevationsForGrid=function(a,b,d,c,g){var e=0,h;this.assembleTiles(c,a,!0);if(0===this.currentTiles.length)return 0;this.currentTiles.sort(function(a,b){return a.level.levelNumber-b.level.levelNumber});c=0;for(var f=this.currentTiles.length;c<f;c++){h=this.currentTiles[c];var l=h.image();l?(l.elevationsForGrid(a,b,d,g),h=h.level.texelSize,e<h&&(e=h)):e=Number.MAX_VALUE}return e};p.prototype.areaElevationsForGrid=function(a,b,d,c,g){var e=
    a.minLatitude,h=a.maxLatitude,f=a.minLongitude,l=a.maxLongitude,k=a.deltaLatitude()/(1<b?b-1:1);a=a.deltaLongitude()/(1<d?d-1:1);var m,p,y,H,C,z=0;for(H=0;H<b;H+=1,e+=k)for(H===b-1&&(e=h),C=0,m=f;C<d;C+=1,m+=a)C===d-1&&(m=l),this.coverageSector.containsLocation(e,m)&&(p=(m+180)/360,y=(e+90)/180,this.areaElevationForCoord(p,y,c.levelNumber,g,z)),z++;return c.texelSize};p.prototype.areaElevationForCoord=function(a,b,d,c,g){for(var e,h,f,l,k,p,D,y,H=new Float64Array(4),C=d;0<=C;C--)if(e=this.levels.level(C),
        h=Math.round(360*e.tileWidth/e.tileDelta.longitude),f=Math.round(180*e.tileHeight/e.tileDelta.latitude),l=1/(2*f),k=1-l,p=h*m.fract(a),D=f*m.clamp(b,l,k),f=m.mod(Math.floor(p-.5),h),h=m.mod(f+1,h),l=Math.floor(D-.5),k=l+1,p=m.fract(p-.5),D=m.fract(D-.5),y=C==d||0==C,this.lookupPixels(f,h,l,k,e,y,H)){c[g]=(1-p)*(1-D)*H[0]+p*(1-D)*H[1]+(1-p)*D*H[2]+p*D*H[3];break}};p.prototype.lookupPixels=function(a,b,d,c,g,e,h){var f=g.levelNumber,l=g.tileWidth;g=g.tileHeight;var k=Math.floor(d/g),m=Math.floor(c/
    g),p=Math.floor(a/l),y=Math.floor(b/l),H,C,z;k==m&&k==this.cachedRow&&p==y&&p==this.cachedCol?H=C=z=e=this.cachedImage:k==m&&p==y?(C=z=e=H=this.lookupImage(f,k,p,e),this.cachedRow=k,this.cachedCol=p,this.cachedImage=H):(H=this.lookupImage(f,k,p,e),C=this.lookupImage(f,k,y,e),z=this.lookupImage(f,m,p,e),e=this.lookupImage(f,m,y,e));return H&&C&&z&&e?(h[0]=H.pixel(a%l,d%g),h[1]=C.pixel(b%l,d%g),h[2]=z.pixel(a%l,c%g),h[3]=e.pixel(b%l,c%g),!0):!1};p.prototype.lookupImage=function(a,b,d,c){a=this.tileForLevel(a,
    b,d);b=a.image();null==b&&c&&this.retrieveTileImage(a);return b};p.prototype.createTile=function(a,b,c,g){return new d(a,b,c,g,this.cachePath+"/"+b.levelNumber+"/"+c+"/"+c+"_"+g+".bil",this.imageCache)};p.prototype.assembleTiles=function(a,b,d){this.currentTiles=[];this.currentSector.copy(b);this.currentSector.intersection(this.coverageSector);if(!this.currentSector.isEmpty()){b=a.tileDelta.latitude;var c=a.tileDelta.longitude,g=l.computeRow(b,this.currentSector.minLatitude);b=l.computeLastRow(b,
    this.currentSector.maxLatitude);for(var e=l.computeColumn(c,this.currentSector.minLongitude),c=l.computeLastColumn(c,this.currentSector.maxLongitude);g<=b;g++)for(var h=e;h<=c;h++)this.addTileOrAncestor(a,g,h,d)}};p.prototype.addTileOrAncestor=function(a,b,d,c){var g=this.tileForLevel(a.levelNumber,b,d);this.isTileImageInMemory(g)?this.addToCurrentTiles(g):(c&&this.retrieveTileImage(g),a.isFirstLevel()?this.currentTiles.push(g):this.addAncestor(a,b,d,c))};p.prototype.addAncestor=function(a,b,d,c){var g=
    null;b=Math.floor(b/2);d=Math.floor(d/2);for(a=a.levelNumber-1;0<=a;a--){g=this.tileForLevel(a,b,d);if(this.isTileImageInMemory(g)){this.addToCurrentTiles(g);return}b=Math.floor(b/2);d=Math.floor(d/2)}this.addToCurrentTiles(g);c&&this.retrieveTileImage(g)};p.prototype.addToCurrentTiles=function(a){this.currentTiles.push(a)};p.prototype.tileForLevel=function(a,b,d){var c=a+"."+b+"."+d,g=this.tileCache.entryForKey(c);if(g)return g;a=this.levels.level(a);g=l.computeSector(a,b,d);g=this.createTile(g,
    a,b,d);this.tileCache.putEntry(c,g,g.size());return g};p.prototype.isTileImageInMemory=function(a){return this.imageCache.containsKey(a.imagePath)};p.prototype.resourceUrlForTile=function(a){return this.urlBuilder.urlForTile(a,this.retrievalImageFormat)};p.prototype.retrieveTileImage=function(a){if(0>this.currentRetrievals.indexOf(a.imagePath)){var b=this.resourceUrlForTile(a,this.retrievalImageFormat),d=new XMLHttpRequest,c=this;b&&(d.open("GET",b,!0),d.responseType="arraybuffer",d.onreadystatechange=
    function(){if(4===d.readyState){c.removeFromCurrentRetrievals(a.imagePath);var e=d.getResponseHeader("content-type");200===d.status?e===c.retrievalImageFormat||"text/plain"===e||"application/octet-stream"===e?(g.log(g.LEVEL_INFO,"Elevations retrieval succeeded: "+b),c.loadElevationImage(a,d),c.absentResourceList.unmarkResourceAbsent(a.imagePath),e=document.createEvent("Event"),e.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(e)):"text/xml"===e?(c.absentResourceList.markResourceAbsent(a.imagePath),
        g.log(g.LEVEL_WARNING,"Elevations retrieval failed ("+d.statusText+"): "+b+".\n "+String.fromCharCode.apply(null,new Uint8Array(d.response)))):(c.absentResourceList.markResourceAbsent(a.imagePath),g.log(g.LEVEL_WARNING,"Elevations retrieval failed: "+b+". Unexpected content type "+e)):(c.absentResourceList.markResourceAbsent(a.imagePath),g.log(g.LEVEL_WARNING,"Elevations retrieval failed ("+d.statusText+"): "+b))}},d.onerror=function(){c.removeFromCurrentRetrievals(a.imagePath);c.absentResourceList.markResourceAbsent(a.imagePath);
    g.log(g.LEVEL_WARNING,"Elevations retrieval failed: "+b)},d.ontimeout=function(){c.removeFromCurrentRetrievals(a.imagePath);c.absentResourceList.markResourceAbsent(a.imagePath);g.log(g.LEVEL_WARNING,"Elevations retrieval timed out: "+b)},d.send(null),this.currentRetrievals.push(a.imagePath))}};p.prototype.removeFromCurrentRetrievals=function(a){a=this.currentRetrievals.indexOf(a);-1<a&&this.currentRetrievals.splice(a,1)};p.prototype.loadElevationImage=function(b,d){var c=new a(b.imagePath,b.sector,
    b.tileWidth,b.tileHeight);"application/bil16"==this.retrievalImageFormat?(c.imageData=new Int16Array(d.response),c.size=2*c.imageData.length):"application/bil32"==this.retrievalImageFormat&&(c.imageData=new Float32Array(d.response),c.size=4*c.imageData.length);c.imageData&&(c.findMinAndMaxElevation(),this.imageCache.putEntry(b.imagePath,c,c.size),this.timestamp=Date.now())};return p});
define("src/projections/GeographicProjection",["../error/ArgumentError","../util/Logger","../geom/Sector","../error/UnsupportedOperationError"],function(f,b,c,a){c=function(a,b,c){this.displayName=a||"Geographic Projection";this.continuous=b;this.projectionLimits=c;this.is2D=!0};c.prototype.geographicToCartesian=function(d,c,g,h,f,l){throw new a(b.logMessage(b.LEVEL_SEVERE,"GeographicProjection","geographicToCartesian","abstractInvocation"));};c.prototype.geographicToCartesianGrid=function(d,c,g,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               h,f,l,m,p){throw new a(b.logMessage(b.LEVEL_SEVERE,"GeographicProjection","geographicToCartesianGrid","abstractInvocation"));};c.prototype.cartesianToGeographic=function(d,c,g,h,f,l){throw new a(b.logMessage(b.LEVEL_SEVERE,"GeographicProjection","cartesianToGeographic","abstractInvocation"));};c.prototype.northTangentAtLocation=function(a,c,g,h){if(!h)throw new f(b.logMessage(b.LEVEL_SEVERE,"ProjectionEquirectangular","northTangentAtLocation","missingResult"));h[0]=0;h[1]=1;h[2]=0;return h};c.prototype.northTangentAtPoint=
    function(a,c,g,h,k,l){if(!l)throw new f(b.logMessage(b.LEVEL_SEVERE,"ProjectionEquirectangular","northTangentAtPoint","missingResult"));l[0]=0;l[1]=1;l[2]=0;return l};c.prototype.surfaceNormalAtPoint=function(a,c,g,h,k){if(!k)throw new f(b.logMessage(b.LEVEL_SEVERE,"GeographicProjection","surfaceNormalAtPoint","missingResult"));k[0]=0;k[1]=0;k[2]=1;return k};return c});
define("src/projections/ProjectionWgs84","../geom/Angle ../error/ArgumentError ../projections/GeographicProjection ../util/Logger ../geom/Position ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g){var h=function(){c.call(this,"WGS84",!1,null);this.is2D=!1;this.scratchPosition=new d(0,0,0)};h.prototype=Object.create(c.prototype);Object.defineProperties(h.prototype,{stateKey:{get:function(){return"projection wgs84 "}}});h.prototype.geographicToCartesian=function(d,c,g,e,h,t){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "ProjectionWgs84","geographicToCartesian","missingGlobe"));h=Math.cos(c*f.DEGREES_TO_RADIANS);c=Math.sin(c*f.DEGREES_TO_RADIANS);var r=Math.cos(g*f.DEGREES_TO_RADIANS),u=d.equatorialRadius/Math.sqrt(1-d.eccentricitySquared*c*c);t[0]=(u+e)*h*Math.sin(g*f.DEGREES_TO_RADIANS);t[1]=(u*(1-d.eccentricitySquared)+e)*c;t[2]=(u+e)*h*r;return t};h.prototype.geographicToCartesianGrid=function(d,c,g,h,q,t,r,u){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesianGrid","missingGlobe"));
    var w=c.minLatitude*f.DEGREES_TO_RADIANS;r=c.maxLatitude*f.DEGREES_TO_RADIANS;var x=c.minLongitude*f.DEGREES_TO_RADIANS,A=c.maxLongitude*f.DEGREES_TO_RADIANS;c=(r-w)/(1<g?g-1:1);var B=(A-x)/(1<h?h-1:1);t=t?t:new e(0,0,0);var v,F=0,G=0,D,y,H=new Float64Array(h),C=new Float64Array(h);for(v=0;v<h;v++,x+=B)v===h-1&&(x=A),H[v]=Math.cos(x),C[v]=Math.sin(x);for(x=0;x<g;x++,w+=c)for(x===g-1&&(w=r),D=Math.cos(w),y=Math.sin(w),A=d.equatorialRadius/Math.sqrt(1-d.eccentricitySquared*y*y),v=0;v<h;v++)B=q[F++],
        u[G++]=(A+B)*D*C[v]-t[0],u[G++]=(A*(1-d.eccentricitySquared)+B)*y-t[1],u[G++]=(A+B)*D*H[v]-t[2];return u};h.prototype.cartesianToGeographic=function(d,c,e,h,q,t){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionWgs84","cartesianToGeographic","missingGlobe"));var r=h*h+c*c;q=Math.sqrt(r);var u=d.equatorialRadius,w=1/(u*u);d=d.eccentricitySquared;var x=d*d,r=r*w,w=e*e*(1-d)*w,A=(r+w-x)/6,B=8*A*A*A+x*r*w,v,F;0<B||0!=w?(0<B?(v=Math.sqrt(B),F=Math.sqrt(x*r*w),B>10*d?(u=g.cbrt((v+F)*(v+F)),u=A+
    .5*u+2*A*A/u):u=A+.5*g.cbrt((v+F)*(v+F))+.5*g.cbrt((v-F)*(v-F))):(v=Math.sqrt(-B),F=Math.sqrt(-8*A*A*A),u=Math.sqrt(x*r*w),u=2*Math.atan2(u,v+F)/3,u=-4*A*Math.sin(u)*Math.cos(Math.PI/6+u)),x=Math.sqrt(u*u+x*w),w=d*(u+x-w)/(2*x),w=(u+x)/(Math.sqrt(w*w+u+x)+w),x=w*q/(w+d),u=Math.sqrt(x*x+e*e),d=(w+d-1)*u/w,e=2*Math.atan2(e,u+x)):(v=Math.sqrt(1-d),F=Math.sqrt(d-r),e=Math.sqrt(d),d=-u*v*F/e,e=F/(e*F+v*Math.sqrt(r)));x=Math.sqrt(2);c=(x-1)*c<q+h?2*Math.atan2(c,q+h):q+c<(x+1)*h?.5*-Math.PI+2*Math.atan2(h,
    q-c):.5*Math.PI-2*Math.atan2(h,q+c);t.latitude=f.RADIANS_TO_DEGREES*e;t.longitude=f.RADIANS_TO_DEGREES*c;t.altitude=d;return t};h.prototype.northTangentAtLocation=function(a,b,d,c){a=Math.cos(b*f.DEGREES_TO_RADIANS);var g=Math.cos(d*f.DEGREES_TO_RADIANS);b=Math.sin(b*f.DEGREES_TO_RADIANS);c[0]=-b*Math.sin(d*f.DEGREES_TO_RADIANS);c[1]=a;c[2]=-b*g;return c};h.prototype.northTangentAtPoint=function(a,b,d,c,g,h){this.cartesianToGeographic(a,b,d,c,e.ZERO,this.scratchPosition);return this.northTangentAtLocation(a,
    this.scratchPosition.latitude,this.scratchPosition.longitude,h)};h.prototype.surfaceNormalAtPoint=function(d,c,g,e,h){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionWgs84","surfaceNormalAtPoint","missingGlobe"));var f=d.equatorialRadius*d.equatorialRadius;d=d.polarRadius*d.polarRadius;h[0]=c/f;h[1]=g/d;h[2]=e/f;return h.normalize()};return h});
define("src/navigate/NavigatorState","../error/ArgumentError ../geom/Frustum ../geom/Line ../util/Logger ../geom/Matrix ../geom/Rectangle ../geom/Vec2 ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k){e=function(a,c,g,e,f){this.modelview=a;this.projection=c;this.modelviewProjection=d.fromIdentity();this.modelviewProjection.setToMultiply(c,a);this.viewport=g;this.heading=e;this.tilt=f;this.eyePoint=this.modelview.extractEyePoint(new h(0,0,0));this.frustumInModelCoordinates=null;a=
    d.fromIdentity();a.setToTransposeOfMatrix(this.modelview);this.frustumInModelCoordinates=b.fromProjectionMatrix(this.projection);this.frustumInModelCoordinates.transformByMatrix(a);this.frustumInModelCoordinates.normalize();this.modelviewInv=d.fromIdentity();this.modelviewInv.invertOrthonormalMatrix(this.modelview);this.projectionInv=d.fromIdentity();this.projectionInv.invertMatrix(this.projection);this.modelviewProjectionInv=d.fromIdentity();this.modelviewProjectionInv.invertMatrix(this.modelviewProjection);
    this.modelviewNormalTransform=d.fromIdentity().setToTransposeOfMatrix(this.modelviewInv.upper3By3());e=new h(-1,-1,-1);c=new h(1,1,-1);a=new h(-1,-1,1);f=new h(1,1,1);e.multiplyByMatrix(this.projectionInv);c.multiplyByMatrix(this.projectionInv);a.multiplyByMatrix(this.projectionInv);f.multiplyByMatrix(this.projectionInv);c=k.fabs(c[0]-e[0]);f=k.fabs(f[0]-a[0]);e=-e[2];a=(f-c)/(-a[2]-e);this.pixelSizeScale=a/g.width;this.pixelSizeOffset=(c-a*e)/g.height};e.prototype.project=function(b,d){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,
    "NavigatorState","project","missingPoint"));if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"NavigatorState","project","missingResult"));var c=b[0],g=b[1],e=b[2],h=this.modelviewProjection,k=h[0]*c+h[1]*g+h[2]*e+h[3],w=h[4]*c+h[5]*g+h[6]*e+h[7],x=h[8]*c+h[9]*g+h[10]*e+h[11],c=h[12]*c+h[13]*g+h[14]*e+h[15],g=this.viewport;if(0==c)return!1;x/=c;if(-1>x||1<x)return!1;k=(k/c*.5+.5)*g.width+g.x;w=(w/c*.5+.5)*g.height+g.y;d[0]=k;d[1]=w;d[2]=.5*x+.5;return!0};e.prototype.projectWithDepth=function(b,d,c){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,
    "NavigatorState","projectWithDepth","missingPoint"));if(!c)throw new f(a.logMessage(a.LEVEL_SEVERE,"NavigatorState","projectWithDepth","missingResult"));var g=b[0],e=b[1],h=b[2],u=this.modelview;b=u[0]*g+u[1]*e+u[2]*h+u[3];var w=u[4]*g+u[5]*e+u[6]*h+u[7],x=u[8]*g+u[9]*e+u[10]*h+u[11],g=u[12]*g+u[13]*e+u[14]*h+u[15],e=this.projection,h=e[0]*b+e[1]*w+e[2]*x+e[3]*g,u=e[4]*b+e[5]*w+e[6]*x+e[7]*g,A=e[8]*b+e[9]*w+e[10]*x+e[11]*g,B=e[12]*b+e[13]*w+e[14]*x+e[15]*g,v=this.viewport;if(0===B)return!1;h/=B;u/=
    B;A/=B;if(-1>A||1<A)return!1;A=e[8]*b+e[9]*w+e[10]*x*(1+d)+e[11]*g;A=k.clamp(A/B,-1,1);h=(.5*h+.5)*v.width+v.x;u=(.5*u+.5)*v.height+v.y;c[0]=h;c[1]=u;c[2]=.5*A+.5;return!0};e.prototype.unProject=function(b,d){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"NavigatorState","unProject","missingPoint"));if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"NavigatorState","unProject","missingResult"));var c=b[0],g=b[1],e=b[2],h=this.viewport,c=(c-h.x)/h.width,g=(g-h.y)/h.height,c=2*c-1,g=2*g-1,e=2*e-1;if(-1>
    e||1<e)return!1;var h=this.modelviewProjectionInv,k=h[4]*c+h[5]*g+h[6]*e+h[7],w=h[8]*c+h[9]*g+h[10]*e+h[11],x=h[12]*c+h[13]*g+h[14]*e+h[15];if(0===x)return!1;d[0]=(h[0]*c+h[1]*g+h[2]*e+h[3])/x;d[1]=k/x;d[2]=w/x;return!0};e.prototype.convertPointToWindow=function(b,d){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"NavigatorState","convertPointToWindow","missingPoint"));if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"NavigatorState","convertPointToWindow","missingResult"));d[0]=b[0];d[1]=this.viewport.height-
    b[1];return d};e.prototype.convertPointToViewport=function(b,d){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"NavigatorState","convertPointToViewport","missingPoint"));if(!d)throw new f(a.logMessage(a.LEVEL_SEVERE,"NavigatorState","convertPointToViewport","missingResult"));d[0]=b[0];d[1]=this.viewport.height-b[1];return d};e.prototype.rayFromScreenPoint=function(b){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"NavigatorState","rayFromScreenPoint","missingPoint"));var d=this.convertPointToViewport(b,
    new h(0,0,0));b=new h(0,0,0);var g=new h(0,0,0);if(!this.unProject(d,b))return null;d[2]=1;if(!this.unProject(d,g))return null;d=new h(this.eyePoint[0],this.eyePoint[1],this.eyePoint[2]);g=new h(g[0],g[1],g[2]);g.subtract(b);g.normalize();return new c(d,g)};e.prototype.pixelSizeAtDistance=function(a){return this.pixelSizeScale*a+this.pixelSizeOffset};return e});
define("src/globe/Terrain",["../error/ArgumentError","../util/Logger","../geom/Vec3"],function(f,b,c){var a=function(a,b,c,h){this.globe=a;this.verticalExaggeration=h;this.sector=c.sector;this.tessellator=b;this.surfaceGeometry=c.tileArray;this.stateKey=a.stateKey+" ve "+h.toString()};a.scratchPoint=new c(0,0,0);a.prototype.surfacePoint=function(d,c,g,h){if(!h)throw new f(b.logMessage(b.LEVEL_SEVERE,"Terrain","surfacePoint","missingResult"));for(var k=0,l=this.surfaceGeometry.length;k<l;k++)if(this.surfaceGeometry[k].sector.containsLocation(d,
        c))return this.surfaceGeometry[k].surfacePoint(d,c,h),g&&(d=this.globe.surfaceNormalAtPoint(h[0],h[1],h[2],a.scratchPoint),h[0]+=d[0]*g,h[1]+=d[1]*g,h[2]+=d[2]*g),h;g+=this.globe.elevationAtLocation(d,c)*this.verticalExaggeration;this.globe.computePointFromPosition(d,c,g,h);return h};a.prototype.surfacePointForMode=function(a,c,g,h,k){if(!k)throw new f(b.logMessage(b.LEVEL_SEVERE,"Terrain","surfacePointForMode","missingResult"));h||(h=WorldWind.ABSOLUTE);if(h===WorldWind.CLAMP_TO_GROUND)return this.surfacePoint(a,
    c,0,k);if(h===WorldWind.RELATIVE_TO_GROUND)return this.surfacePoint(a,c,g,k);this.globe.computePointFromPosition(a,c,g*this.verticalExaggeration,k);return k};a.prototype.beginRendering=function(a){this.globe&&this.globe.tessellator&&this.globe.tessellator.beginRendering(a)};a.prototype.endRendering=function(a){this.globe&&this.globe.tessellator&&this.globe.tessellator.endRendering(a)};a.prototype.beginRenderingTile=function(a,c){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"Terrain","beginRenderingTile",
    "missingTile"));this.globe&&this.globe.tessellator&&this.globe.tessellator.beginRenderingTile(a,c)};a.prototype.endRenderingTile=function(a,b){};a.prototype.renderTile=function(a,c){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"Terrain","renderTile","missingTile"));this.globe&&this.globe.tessellator&&this.globe.tessellator.renderTile(a,c)};a.prototype.pick=function(a){this.globe&&this.globe.tessellator&&this.globe.tessellator.pick(a,this.surfaceGeometry,this)};return a});
define("src/globe/TerrainTile",["../error/ArgumentError","../util/Logger","../geom/Matrix","../util/Tile"],function(f,b,c,a){var d=function(b,d,h,f){a.call(this,b,d,h,f);this.transformationMatrix=c.fromIdentity();this.pointsVboStateKey=this.pointsStateKey=this.points=null;this.neighborMap={};this.neighborMap[WorldWind.NORTH]=null;this.neighborMap[WorldWind.SOUTH]=null;this.neighborMap[WorldWind.EAST]=null;this._elevationTimestamp=this._stateKey=this.neighborMap[WorldWind.WEST]=null;this.scratchArray=
    []};d.prototype=Object.create(a.prototype);Object.defineProperties(d.prototype,{stateKey:{get:function(){this._stateKey||(this._stateKey=this.computeStateKey());return this._stateKey}}});d.prototype.neighborLevel=function(a){return this.neighborMap[a]};d.prototype.setNeighborLevel=function(a,b){this.neighborMap[a]=b;this._stateKey=null};d.prototype.surfacePoint=function(a,d,c){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"TerrainTile","surfacePoint","missingResult"));var k=this.sector,l=k.minLatitude,
    m=k.maxLatitude,p=k.minLongitude,q=this.tileWidth,t=this.tileHeight,r,u;d=(d-p)/(k.maxLongitude-p)*q;l=(a-l)/(m-l)*t;p=d<q?Math.floor(d):q-1;r=l<t?Math.floor(l):t-1;u=q+1;m=this.points;a=this.scratchArray;for(var k=3*(p+r*u),w=0;6>w;w++)a[w]=m[k+w];k=3*(p+(r+1)*u);for(p=6;12>p;p++)a[p]=m[k+(p-6)];q=d<q?d-Math.floor(d):1;t=l<t?l-Math.floor(l):1;q>t?(c[0]=a[0]+q*(a[3]-a[0])+t*(a[6]-a[0]),c[1]=a[1]+q*(a[4]-a[1])+t*(a[7]-a[1]),c[2]=a[2]+q*(a[5]-a[2])+t*(a[8]-a[2])):(c[0]=a[9]+(1-q)*(a[6]-a[9])+(1-t)*
    (a[3]-a[9]),c[1]=a[10]+(1-q)*(a[7]-a[10])+(1-t)*(a[4]-a[10]),c[2]=a[11]+(1-q)*(a[8]-a[11])+(1-t)*(a[5]-a[11]));c[0]+=this.referencePoint[0];c[1]+=this.referencePoint[1];c[2]+=this.referencePoint[2];return c};d.prototype.update=function(b){a.prototype.update.call(this,b);b=b.globe.elevationTimestamp();this._elevationTimestamp!=b&&(this._elevationTimestamp=b,this._stateKey=null)};d.prototype.computeStateKey=function(){var a=[];a.push(this._elevationTimestamp);a.push(this.neighborMap[WorldWind.NORTH]?
    this.neighborMap[WorldWind.NORTH].compare(this.level):0);a.push(this.neighborMap[WorldWind.SOUTH]?this.neighborMap[WorldWind.SOUTH].compare(this.level):0);a.push(this.neighborMap[WorldWind.EAST]?this.neighborMap[WorldWind.EAST].compare(this.level):0);a.push(this.neighborMap[WorldWind.WEST]?this.neighborMap[WorldWind.WEST].compare(this.level):0);return a.join(".")};return d});
define("src/globe/TerrainTileList",["../error/ArgumentError","../util/Logger","../geom/Sector"],function(f,b,c){var a=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"TerrainTileList","TerrainTileList","missingTessellator"));this.tessellator=a;this.sector=null;this.tileArray=[]};Object.defineProperties(a.prototype,{length:{get:function(){return this.tileArray.length}}});a.prototype.addTile=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"TerrainTileList","addTile","missingTile"));
    -1==this.tileArray.indexOf(a)&&(this.tileArray.push(a),this.sector?this.sector.union(a.sector):(this.sector=new c(0,0,0,0),this.sector.copy(a.sector)))};a.prototype.removeAllTiles=function(){this.tileArray=[];this.sector=null};return a});
define("src/globe/Tessellator","../error/ArgumentError ../shaders/BasicProgram ../globe/Globe ../shaders/GpuProgram ../util/Level ../util/LevelSet ../geom/Location ../util/Logger ../geom/Matrix ../cache/MemoryCache ../navigate/NavigatorState ../error/NotYetImplementedError ../pick/PickedObject ../geom/Position ../geom/Rectangle ../geom/Sector ../globe/Terrain ../globe/TerrainTile ../globe/TerrainTileList ../util/Tile ../util/WWMath ../util/WWUtil".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t,r,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        u,w,x,A,B,v,F){c=function(){this.numRowsTilesInTopLevel=4;this.numColumnsTilesInTopLevel=8;this.maximumSubdivisionDepth=15;this.tileHeight=this.tileWidth=32;this.detailControl=40;this.levels=new e(u.FULL_SPHERE,new g(180/this.numRowsTilesInTopLevel,360/this.numColumnsTilesInTopLevel),this.maximumSubdivisionDepth,this.tileWidth,this.tileHeight);this.topLevelTiles={};this.currentTiles=new A(this);this.tileCache=new l(5E6,4E6);this.lastModelViewProjection=this.elevationTimestamp=void 0;this.vertexTexCoordLocation=
    this.vertexPointLocation=-1;this.texCoords=null;this.texCoordVboCacheKey="global_tex_coords";this.numIndices=this.indices=null;this.indicesVboCacheKey="global_indices";this.numIndicesNorth=this.indicesNorth=null;this.indicesNorthVboCacheKey="global_north_indices";this.numIndicesSouth=this.indicesSouth=null;this.indicesSouthVboCacheKey="global_south_indices";this.numIndicesWest=this.indicesWest=null;this.indicesWestVboCacheKey="global_west_indices";this.numIndicesEast=this.indicesEast=null;this.indicesEastVboCacheKey=
    "global_east_indices";this.numIndicesLoresNorth=this.indicesLoresNorth=null;this.indicesLoresNorthVboCacheKey="global_lores_north_indices";this.numIndicesLoresSouth=this.indicesLoresSouth=null;this.indicesLoresSouthVboCacheKey="global_lores_south_indices";this.numIndicesLoresWest=this.indicesLoresWest=null;this.indicesLoresWestVboCacheKey="global_lores_west_indices";this.numIndicesLoresEast=this.indicesLoresEast=null;this.indicesLoresEastVboCacheKey="global_lores_east_indices";this.outlineIndices=
    null;this.outlineIndicesVboCacheKey="global_outline_indices";this.wireframeIndices=null;this.wireframeIndicesVboCacheKey="global_wireframe_indices";this.scratchMatrix=k.fromIdentity();this.scratchPrevElevations=this.scratchElevations=null;this.corners={};this.tiles=[]};c.prototype.tessellate=function(a){if(!a)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tessellator","tessellate","missingDC"));var b=a.globe.elevationTimestamp();if(this.lastGlobeStateKey===a.globeStateKey&&this.lastVerticalExaggeration===
    a.verticalExaggeration&&this.elevationTimestamp===b&&this.lastModelViewProjection&&a.navigatorState.modelviewProjection.equals(this.lastModelViewProjection))return this.lastTerrain;this.lastModelViewProjection=a.navigatorState.modelviewProjection;this.lastGlobeStateKey=a.globeStateKey;this.elevationTimestamp=b;this.lastVerticalExaggeration=a.verticalExaggeration;this.currentTiles.removeAllTiles();this.topLevelTiles[a.globeStateKey]&&0!=this.topLevelTiles[a.globeStateKey].length||this.createTopLevelTiles(a);
    this.corners={};this.tiles=[];for(var b=0,d=this.topLevelTiles[a.globeStateKey].length;b<d;b+=1){var c=this.topLevelTiles[a.globeStateKey][b];c.update(a);this.isTileVisible(a,c)&&this.addTileOrDescendants(a,c)}this.refineNeighbors(a);this.finishTessellating(a);return this.lastTerrain=0===this.currentTiles.length?null:new w(a.globe,this,this.currentTiles,a.verticalExaggeration)};c.prototype.createTile=function(a,b,d,c){if(!a)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tile","constructor","missingSector"));
    if(!b)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tile","constructor","The specified level is null or undefined."));if(0>d||0>c)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tile","constructor","The specified row or column is less than zero."));return new x(a,b,d,c)};c.prototype.beginRendering=function(a){var b=a.currentProgram;if(b){this.buildSharedGeometry();this.cacheSharedGeometryVBOs(a);var d=a.currentGlContext;a=a.gpuResourceCache;this.vertexPointLocation=b.attributeLocation(d,"vertexPoint");this.vertexTexCoordLocation=
    b.attributeLocation(d,"vertexTexCoord");d.enableVertexAttribArray(this.vertexPointLocation);0<=this.vertexTexCoordLocation&&(b=a.resourceForKey(this.texCoordVboCacheKey),d.bindBuffer(d.ARRAY_BUFFER,b),d.vertexAttribPointer(this.vertexTexCoordLocation,2,d.FLOAT,!1,0,0),d.enableVertexAttribArray(this.vertexTexCoordLocation))}else h.logMessage(h.LEVEL_INFO,"Tessellator","beginRendering","Current Program is empty")};c.prototype.endRendering=function(a){a=a.currentGlContext;a.bindBuffer(a.ARRAY_BUFFER,
    null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);0<=this.vertexPointLocation&&a.disableVertexAttribArray(this.vertexPointLocation);0<=this.vertexTexCoordLocation&&a.disableVertexAttribArray(this.vertexTexCoordLocation)};c.prototype.beginRenderingTile=function(a,b){if(!b)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tessellator","beginRenderingTile","missingTile"));var d=a.currentGlContext,c=a.gpuResourceCache;this.scratchMatrix.setToMultiply(a.navigatorState.modelviewProjection,b.transformationMatrix);
    a.currentProgram.loadModelviewProjection(d,this.scratchMatrix);var g=a.globeStateKey+b.tileKey,e=c.resourceForKey(g);e?b.pointsVboStateKey!=b.pointsStateKey?(d.bindBuffer(d.ARRAY_BUFFER,e),d.bufferSubData(d.ARRAY_BUFFER,0,b.points),b.pointsVboStateKey=b.pointsStateKey):a.currentGlContext.bindBuffer(d.ARRAY_BUFFER,e):(e=d.createBuffer(),d.bindBuffer(d.ARRAY_BUFFER,e),d.bufferData(d.ARRAY_BUFFER,b.points,d.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),c.putResource(g,e,4*b.points.length),
        b.pointsVboStateKey=b.pointsStateKey);d.vertexAttribPointer(this.vertexPointLocation,3,d.FLOAT,!1,0,0)};c.prototype.endRenderingTile=function(a,b){};c.prototype.renderTile=function(a,b){if(!b)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tessellator","renderTile","missingTile"));var d=a.currentGlContext,c=a.gpuResourceCache,g=d.TRIANGLE_STRIP,e=c.resourceForKey(this.indicesVboCacheKey);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,e);d.drawElements(g,this.numIndices,d.UNSIGNED_SHORT,0);var e=b.level,k;(k=b.neighborLevel(WorldWind.NORTH))&&
0>k.compare(e)?(k=c.resourceForKey(this.indicesLoresNorthVboCacheKey),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k),d.drawElements(g,this.numIndicesLoresNorth,d.UNSIGNED_SHORT,0)):(k=c.resourceForKey(this.indicesNorthVboCacheKey),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k),d.drawElements(g,this.numIndicesNorth,d.UNSIGNED_SHORT,0));(k=b.neighborLevel(WorldWind.SOUTH))&&0>k.compare(e)?(k=c.resourceForKey(this.indicesLoresSouthVboCacheKey),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k),d.drawElements(g,this.numIndicesLoresSouth,
    d.UNSIGNED_SHORT,0)):(k=c.resourceForKey(this.indicesSouthVboCacheKey),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k),d.drawElements(g,this.numIndicesSouth,d.UNSIGNED_SHORT,0));(k=b.neighborLevel(WorldWind.WEST))&&0>k.compare(e)?(k=c.resourceForKey(this.indicesLoresWestVboCacheKey),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k),d.drawElements(g,this.numIndicesLoresWest,d.UNSIGNED_SHORT,0)):(k=c.resourceForKey(this.indicesWestVboCacheKey),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k),d.drawElements(g,this.numIndicesWest,
    d.UNSIGNED_SHORT,0));(k=b.neighborLevel(WorldWind.EAST))&&0>k.compare(e)?(c=c.resourceForKey(this.indicesLoresEastVboCacheKey),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c),d.drawElements(g,this.numIndicesLoresEast,d.UNSIGNED_SHORT,0)):(c=c.resourceForKey(this.indicesEastVboCacheKey),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c),d.drawElements(g,this.numIndicesEast,d.UNSIGNED_SHORT,0))};c.prototype.renderWireframeTile=function(a,b){if(!b)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tessellator","renderWireframeTile",
    "missingTile"));var d=a.currentGlContext,c=a.gpuResourceCache;0<=this.vertexTexCoordLocation&&d.disableVertexAttribArray(this.vertexTexCoordLocation);c=c.resourceForKey(this.wireframeIndicesVboCacheKey);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c);d.drawElements(d.LINES,this.wireframeIndices.length,d.UNSIGNED_SHORT,0)};c.prototype.renderTileOutline=function(a,b){if(!b)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tessellator","renderTileOutline","missingTile"));var d=a.currentGlContext,c=a.gpuResourceCache;
    0<=this.vertexTexCoordLocation&&d.disableVertexAttribArray(this.vertexTexCoordLocation);c=c.resourceForKey(this.outlineIndicesVboCacheKey);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c);d.drawElements(d.LINE_LOOP,this.outlineIndices.length,d.UNSIGNED_SHORT,0)};c.prototype.pick=function(a,b,d){if(!a)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tessellator","pick","missingDc"));if(!b)throw new f(h.logMessage(h.LEVEL_SEVERE,"Tessellator","pick","missingList"));var c=null;d=d||this;for(var g=new t(0,0,0),e=[],k=
    0,l=b.length;k<l;k++){var m=b[k];m.extent.intersectsFrustum(a.pickFrustum)&&e.push(m)}a.pickTerrainOnly||(c=a.uniquePickColor(),this.drawPickTiles(a,e,c));!a.regionPicking&&(b=a.navigatorState.rayFromScreenPoint(a.pickPoint),b=this.computeNearestIntersection(b,e))&&(a.globe.computePositionFromPoint(b[0],b[1],b[2],g),g.altitude=a.globe.elevationAtLocation(g.latitude,g.longitude),a.addPickedObject(new q(c,d,g,null,!0)))};c.prototype.drawPickTiles=function(a,d,c){var g=a.currentGlContext;try{a.findAndBindProgram(b);
    a.currentProgram.loadColor(g,c);this.beginRendering(a);c=0;for(var e=d.length;c<e;c++){var h=d[c];this.beginRenderingTile(a,h);this.renderTile(a,h);this.endRenderingTile(a,h)}}finally{this.endRendering(a)}};c.prototype.computeNearestIntersection=function(a,b){for(var d=[],c=0,g=b.length;c<g;c++)this.computeIntersections(a,b[c],d);if(0==d.length)return null;for(var e=Number.POSITIVE_INFINITY,h,c=0,g=d.length;c<g;c++){var f=a.origin.distanceToSquared(d[c]);e>f&&(e=f,h=c)}return d[h]};c.prototype.computeIntersections=
    function(a,b,d){var c=b.level,g,e=b.points,h=d.length;a.origin.subtract(b.referencePoint);this.buildSharedGeometry(b);g=this.indices;v.computeTriStripIntersections(a,e,g,d);g=(g=b.neighborLevel(WorldWind.SOUTH))&&0>g.compare(c)?this.indicesLoresSouth:this.indicesSouth;v.computeTriStripIntersections(a,e,g,d);g=(g=b.neighborLevel(WorldWind.WEST))&&0>g.compare(c)?this.indicesLoresWest:this.indicesWest;v.computeTriStripIntersections(a,e,g,d);g=(g=b.neighborLevel(WorldWind.EAST))&&0>g.compare(c)?this.indicesLoresEast:
        this.indicesEast;v.computeTriStripIntersections(a,e,g,d);g=(g=b.neighborLevel(WorldWind.NORTH))&&0>g.compare(c)?this.indicesLoresNorth:this.indicesNorth;v.computeTriStripIntersections(a,e,g,d);a.origin.add(b.referencePoint);a=h;for(c=d.length;a<c;a++)d[a].add(b.referencePoint)};c.prototype.createTopLevelTiles=function(a){this.topLevelTiles[a.globeStateKey]=[];B.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles[a.globeStateKey])};c.prototype.addTileOrDescendants=function(a,b){this.tileMeetsRenderCriteria(a,
    b)?this.addTile(a,b):this.addTileDescendants(a,b)};c.prototype.addTileDescendants=function(a,b){for(var d=b.level.nextLevel(),d=b.subdivideToCache(d,this,this.tileCache),c=0;c<d.length;c+=1){var g=d[c];g.update(a);this.levels.sector.intersects(g.sector)&&this.isTileVisible(a,g)&&this.addTileOrDescendants(a,g)}};c.prototype.addTile=function(a,b){var d=this.tiles.length;this.tiles.push(b);var c=b.sector,g=[c.maxLatitude,c.maxLongitude].toString(),e=[c.minLatitude,c.maxLongitude].toString(),h=[c.maxLatitude,
    c.minLongitude].toString(),c=[c.minLatitude,c.minLongitude].toString(),f;(f=this.corners[c])?f.sw=d:this.corners[c]={sw:d};(f=this.corners[h])?f.nw=d:this.corners[h]={nw:d};(f=this.corners[e])?f.se=d:this.corners[e]={se:d};(f=this.corners[g])?f.ne=d:this.corners[g]={ne:d}};c.prototype.refineNeighbors=function(a){for(var b={},d=0,c=this.tiles.length;d<c;d+=1){var g=this.tiles[d],e=g.level.levelNumber,h=g.sector,f,g=[h.minLatitude,h.maxLongitude].toString(),k=[h.maxLatitude,h.minLongitude].toString(),
    l=[h.minLatitude,h.minLongitude].toString(),h=this.corners[[h.maxLatitude,h.maxLongitude].toString()];h.hasOwnProperty("se")&&(f=h.se,this.tiles[f].level.levelNumber<e-1&&(b[f]||(b[f]=!0)));h.hasOwnProperty("nw")&&(f=h.nw,this.tiles[f].level.levelNumber<e-1&&(b[f]||(b[f]=!0)));h=this.corners[g];h.hasOwnProperty("ne")&&(f=h.ne,this.tiles[f].level.levelNumber<e-1&&(b[f]||(b[f]=!0)));h.hasOwnProperty("sw")&&(f=h.sw,this.tiles[f].level.levelNumber<e-1&&(b[f]||(b[f]=!0)));h=this.corners[k];h.hasOwnProperty("ne")&&
(f=h.ne,this.tiles[f].level.levelNumber<e-1&&(b[f]||(b[f]=!0)));h.hasOwnProperty("sw")&&(f=h.sw,this.tiles[f].level.levelNumber<e-1&&(b[f]||(b[f]=!0)));h=this.corners[l];h.hasOwnProperty("se")&&(f=h.se,this.tiles[f].level.levelNumber<e-1&&(b[f]||(b[f]=!0)));h.hasOwnProperty("nw")&&(f=h.nw,this.tiles[f].level.levelNumber<e-1&&(b[f]||(b[f]=!0)))}e=[];k=[];d=0;for(c=this.tiles.length;d<c;d+=1)g=this.tiles[d],b[d]?e.push(g):k.push(g);if(0<e.length){this.tiles=[];this.corners={};d=0;for(c=k.length;d<c;d+=
    1)g=k[d],this.addTile(a,g);d=0;for(c=e.length;d<c;d+=1)g=e[d],this.addTileDescendants(a,g);this.refineNeighbors(a)}};c.prototype.finishTessellating=function(a){for(var b=0,d=this.tiles.length;b<d;b+=1){var c=this.tiles[b];this.setNeighbors(c);this.regenerateTileGeometryIfNeeded(a,c);this.currentTiles.addTile(c)}};c.prototype.setNeighbors=function(a){var b=a.sector,d=this.corners[[b.maxLatitude,b.maxLongitude].toString()],c=this.corners[[b.minLatitude,b.maxLongitude].toString()],g=this.corners[[b.maxLatitude,
    b.minLongitude].toString()],b=this.corners[[b.minLatitude,b.minLongitude].toString()],e=-1,h=-1,f=-1,k=-1;d.hasOwnProperty("se")?e=d.se:g.hasOwnProperty("sw")&&(e=g.sw);c.hasOwnProperty("ne")?h=c.ne:b.hasOwnProperty("nw")&&(h=b.nw);d.hasOwnProperty("nw")?f=d.nw:c.hasOwnProperty("sw")&&(f=c.sw);g.hasOwnProperty("ne")?k=g.ne:b.hasOwnProperty("se")&&(k=b.se);a.setNeighborLevel(WorldWind.NORTH,0<=e?this.tiles[e].level:null);a.setNeighborLevel(WorldWind.SOUTH,0<=h?this.tiles[h].level:null);a.setNeighborLevel(WorldWind.EAST,
    0<=f?this.tiles[f].level:null);a.setNeighborLevel(WorldWind.WEST,0<=k?this.tiles[k].level:null)};c.prototype.isTileVisible=function(a,b){return a.globe.projectionLimits&&!b.sector.overlaps(a.globe.projectionLimits)?!1:b.extent.intersectsFrustum(a.navigatorState.frustumInModelCoordinates)};c.prototype.tileMeetsRenderCriteria=function(a,b){var d=this.detailControl;if(75<=b.sector.minLatitude||-75>=b.sector.maxLatitude)d*=2;return b.level.isLastLevel()||!b.mustSubdivide(a,d)};c.prototype.regenerateTileGeometryIfNeeded=
    function(a,b){var d=a.globeStateKey+b.stateKey+a.verticalExaggeration;b.points&&b.pointsStateKey==d||(this.regenerateTileGeometry(a,b),b.pointsStateKey=d)};c.prototype.regenerateTileGeometry=function(a,b){var d=b.tileHeight+1,c=b.tileWidth+1,g=b.referencePoint,e=this.scratchElevations;e||(this.scratchElevations=e=new Float64Array(d*c));b.points||(b.points=new Float32Array(d*c*3));F.fillArray(e,0);a.globe.elevationsForGrid(b.sector,d,c,b.texelSize,e);this.mustAlignNeighborElevations(a,b)&&this.alignNeighborElevations(a,
    b,e);F.multiplyArray(e,a.verticalExaggeration);a.globe.computePointsForGrid(b.sector,d,c,e,g,b.points);b.transformationMatrix.setTranslation(g[0],g[1],g[2])};c.prototype.mustAlignNeighborElevations=function(a,b){var d=b.level,c=b.neighborLevel(WorldWind.NORTH),g=b.neighborLevel(WorldWind.SOUTH),e=b.neighborLevel(WorldWind.EAST),h=b.neighborLevel(WorldWind.WEST);return c&&0>c.compare(d)||g&&0>g.compare(d)||e&&0>e.compare(d)||h&&0>h.compare(d)};c.prototype.alignNeighborElevations=function(a,b,d){var c=
    b.tileHeight+1,g=b.tileWidth+1,e=b.level,h=Math.floor(c/2)+1,f=Math.floor(g/2)+1,k=e.previousLevel(),l=this.scratchPrevElevations;l||(this.scratchPrevElevations=l=new Float64Array(h*f));F.fillArray(l,0);a.globe.elevationsForGrid(b.sector,h,f,k.texelSize,l);if((a=b.neighborLevel(WorldWind.NORTH))&&0>a.compare(e))for(a=(c-1)*g,k=(h-1)*f,c=0;c<f;c++,a+=2,k+=1)d[a]=l[k],c<f-1&&(d[a+1]=.5*(l[k]+l[k+1]));if((a=b.neighborLevel(WorldWind.SOUTH))&&0>a.compare(e))for(c=k=a=0;c<f;c++,a+=2,k+=1)d[a]=l[k],c<f-
1&&(d[a+1]=.5*(l[k]+l[k+1]));if((a=b.neighborLevel(WorldWind.EAST))&&0>a.compare(e))for(a=g-1,k=f-1,c=0;c<h;c++,a+=2*g,k+=f)d[a]=l[k],c<h-1&&(d[a+g]=.5*(l[k]+l[k+f]));if((a=b.neighborLevel(WorldWind.WEST))&&0>a.compare(e))for(c=k=a=0;c<h;c++,a+=2*g,k+=f)d[a]=l[k],c<h-1&&(d[a+g]=.5*(l[k]+l[k+f]))};c.prototype.buildSharedGeometry=function(){var a=this.levels.tileWidth,b=this.levels.tileHeight;this.texCoords||this.buildTexCoords(a,b);this.indices||this.buildIndices(a,b);this.wireframeIndices||this.buildWireframeIndices(a,
    b);this.outlineIndices||this.buildOutlineIndices(a,b)};c.prototype.buildTexCoords=function(a,b){for(var d=a+1,c=b+1,g=1/a,e=1/b,h=new Float32Array(d*c*2),f=0,k=0,l=0;k<c;k++,l+=e){k==c-1&&(l=1);for(var m=0,p=0;m<d;m++,p+=g)m==d-1&&(p=1),h[f++]=p,h[f++]=l}this.texCoords=h};c.prototype.buildIndices=function(a,b){for(var d,c=b+1,g=a+1,e=2*(c-3)*(g-2)+2*(c-3),h=new Int16Array(e),f=0,k=1;k<g-2;k+=1){for(var l=1;l<c-1;l+=1)d=k+l*g,h[f++]=d,h[f++]=d+1;h[f++]=d+1;d=k+1+1*g;h[f++]=d}this.indices=h;this.numIndices=
    e;e=2*g-2;h=new Int16Array(e);f=0;l=c-1;h[f++]=g-1+l*g;for(k=g-2;0<k;--k)d=k+l*g,h[f++]=d,h[f++]=d-g;h[f++]=0+l*g;this.indicesNorth=h;this.numIndicesNorth=e;e=2*g-2;h=new Int16Array(e);l=f=0;h[f++]=0+l*g;for(k=1;k<g-1;k+=1)d=k+l*g,h[f++]=d,h[f++]=d+g;h[f++]=g-1+l*g;this.indicesSouth=h;this.numIndicesSouth=e;e=2*c-2;h=new Int16Array(e);k=f=0;h[f++]=k+(c-1)*g;for(l=c-2;0<l;--l)d=k+l*g,h[f++]=d,h[f++]=d+1;h[f++]=k+0*g;this.indicesWest=h;this.numIndicesWest=e;e=2*c-2;h=new Int16Array(e);f=0;k=g-1;h[f++]=
    k+0*g;for(l=1;l<c-1;l+=1)d=k+l*g,h[f++]=d,h[f++]=d-1;h[f++]=k+(c-1)*g;this.indicesEast=h;this.numIndicesEast=e;e=2*g-2;h=new Int16Array(e);f=0;l=c-1;h[f++]=g-1+l*g;for(k=g-2;0<k;--k)d=(k+1&-2)+l*g,h[f++]=d,d=k+(l-1)*g,h[f++]=d;h[f++]=0+l*g;this.indicesLoresNorth=h;this.numIndicesLoresNorth=e;e=2*g-2;h=new Int16Array(e);l=f=0;h[f++]=0+l*g;for(k=1;k<g-1;k+=1)d=(k&-2)+l*g,h[f++]=d,d=k+(l+1)*g,h[f++]=d;h[f++]=g-1+l*g;this.indicesLoresSouth=h;this.numIndicesLoresSouth=e;e=2*c-2;h=new Int16Array(e);k=f=
    0;h[f++]=k+(c-1)*g;for(l=c-2;0<l;--l)d=k+(l+1&-2)*g,h[f++]=d,d=k+1+l*g,h[f++]=d;h[f++]=k+0*g;this.indicesLoresWest=h;this.numIndicesLoresWest=e;e=2*c-2;h=new Int16Array(e);f=0;k=g-1;h[f++]=k+0*g;for(l=1;l<c-1;l+=1)d=k+(l&-2)*g,h[f++]=d,d=k-1+l*g,h[f++]=d;h[f++]=k+(c-1)*g;this.indicesLoresEast=h;this.numIndicesLoresEast=e};c.prototype.buildWireframeIndices=function(a,b){var d=b+1,c=a+1,g=new Int16Array(2*a*d+2*b*c),e=0,h,f,k;for(f=0;f<d;f+=1)for(h=0;h<a;h+=1)k=h+f*c,g[e]=k,g[e+1]=k+1,e+=2;for(h=0;h<
c;h+=1)for(f=0;f<b;f+=1)k=h+f*c,g[e]=k,g[e+1]=k+c,e+=2;this.wireframeIndices=g};c.prototype.buildOutlineIndices=function(a,b){var d=b+1,c=a+1,g=new Int16Array(2*(d-2)+2*c+1),e=0,h,f,k;for(h=f=0;h<c;h+=1)k=h+f*c,g[e]=k,e+=1;h=c-1;for(f=1;f<d;f+=1)k=h+f*c,g[e]=k,e+=1;f=d-1;for(h=c-1;0<=h;--h)k=h+f*c,g[e]=k,e+=1;h=0;for(f=d-1;0<=f;--f)k=h+f*c,g[e]=k,e+=1;this.outlineIndices=g};c.prototype.cacheSharedGeometryVBOs=function(a){var b=a.currentGlContext,d=a.gpuResourceCache,c=d.resourceForKey(this.texCoordVboCacheKey);
    c||(c=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,c),b.bufferData(b.ARRAY_BUFFER,this.texCoords,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.texCoordVboCacheKey,c,4*this.texCoords.length/2));c=d.resourceForKey(this.indicesVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.indicesVboCacheKey,c,2*this.indices.length));
    c=d.resourceForKey(this.indicesNorthVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indicesNorth,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.indicesNorthVboCacheKey,c,2*this.indicesNorth.length));c=d.resourceForKey(this.indicesSouthVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indicesSouth,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),
        d.putResource(this.indicesSouthVboCacheKey,c,2*this.indicesSouth.length));c=d.resourceForKey(this.indicesWestVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indicesWest,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.indicesWestVboCacheKey,c,2*this.indicesWest.length));c=d.resourceForKey(this.indicesEastVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,
        this.indicesEast,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.indicesEastVboCacheKey,c,2*this.indicesEast.length));c=d.resourceForKey(this.indicesLoresNorthVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indicesLoresNorth,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.indicesLoresNorthVboCacheKey,c,2*this.indicesLoresNorth.length));c=d.resourceForKey(this.indicesLoresSouthVboCacheKey);
    c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indicesLoresSouth,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.indicesLoresSouthVboCacheKey,c,2*this.indicesLoresSouth.length));c=d.resourceForKey(this.indicesLoresWestVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indicesLoresWest,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.indicesLoresWestVboCacheKey,
        c,2*this.indicesLoresWest.length));c=d.resourceForKey(this.indicesLoresEastVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indicesLoresEast,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.indicesLoresEastVboCacheKey,c,2*this.indicesLoresEast.length));c=d.resourceForKey(this.outlineIndicesVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.outlineIndices,
        b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.outlineIndicesVboCacheKey,c,2*this.outlineIndices.length));c=d.resourceForKey(this.wireframeIndicesVboCacheKey);c||(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.wireframeIndices,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),d.putResource(this.wireframeIndicesVboCacheKey,c,2*this.wireframeIndices.length))};return c});
define("src/globe/Globe","../geom/Angle ../error/ArgumentError ../geom/BoundingBox ../globe/ElevationModel ../geom/Line ../geom/Location ../util/Logger ../geom/Position ../projections/ProjectionWgs84 ../geom/Sector ../globe/Tessellator ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q){var t=function(a,d){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","constructor","Elevation model is null or undefined."));this.elevationModel=a;this.equatorialRadius=6378137;this.polarRadius=
    6356752.3;this.eccentricitySquared=.00669437999013;this.tessellator=new m;this._projection=d||new k;this._offset=0;this.offsetVector=new p(0,0,0);this.id=++t.idPool;this._stateKey="globe "+this.id.toString()+" "};t.idPool=0;Object.defineProperties(t.prototype,{stateKey:{get:function(){return this._stateKey+this.elevationModel.stateKey+"offset "+this.offset.toString()+" "+this.projection.stateKey}},continuous:{get:function(){return this.projection.continuous}},projection:{get:function(){return this._projection},
    set:function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","projection","missingProjection"));this.projection!=a&&(this.tessellator=new m);this._projection=a}},projectionLimits:{get:function(){return this._projection.projectionLimits}},offset:{get:function(){return this._offset},set:function(a){this._offset=a;this.offsetVector[0]=2*a*Math.PI*this.equatorialRadius}}});t.prototype.is2D=function(){return this.projection.is2D};t.prototype.computePointFromPosition=function(a,d,c,e){if(!e)throw new b(g.logMessage(g.LEVEL_SEVERE,
    "Globe","computePointFromPosition","missingResult"));return this.projection.geographicToCartesian(this,a,d,c,this.offsetVector,e)};t.prototype.computePointFromLocation=function(a,d,c){if(!c)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","computePointFromLocation","missingResult"));return this.computePointFromPosition(a,d,0,c)};t.prototype.computePointsForGrid=function(a,d,c,e,h,f){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","computePointsFromPositions","missingSector"));if(1>d||1>c)throw new b(g.logMessage(g.LEVEL_SEVERE,
    "Globe","computePointsFromPositions","Number of latitude or longitude locations is less than one."));var k=d*c;if(!e||e.length<k)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","computePointsFromPositions","Elevations array is null, undefined or insufficient length."));if(!f||f.length<k)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","computePointsFromPositions","Result array is null, undefined or insufficient length."));return this.projection.geographicToCartesianGrid(this,a,d,c,e,h,this.offsetVector,
    f)};t.prototype.computePositionFromPoint=function(a,d,c,e){if(!e)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","computePositionFromPoint","missingResult"));this.projection.cartesianToGeographic(this,a,d,c,this.offsetVector,e);this.continuous&&(-180>e.longitude?e.longitude+=360:180<e.longitude&&(e.longitude-=360));return e};t.prototype.radiusAt=function(a,b){var d=Math.sin(a*f.DEGREES_TO_RADIANS);return this.equatorialRadius/Math.sqrt(1-this.eccentricitySquared*d*d)*Math.sqrt(1+(this.eccentricitySquared*
        this.eccentricitySquared-2*this.eccentricitySquared)*d*d)};t.prototype.surfaceNormalAtLocation=function(a,d,c){if(!c)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","surfaceNormalAtLocation","missingResult"));if(this.is2D())return c[0]=0,c[1]=0,c[2]=1,c;var e=Math.cos(a*f.DEGREES_TO_RADIANS),h=Math.cos(d*f.DEGREES_TO_RADIANS);a=Math.sin(a*f.DEGREES_TO_RADIANS);var k=this.equatorialRadius*this.equatorialRadius,l=this.polarRadius*this.polarRadius;c[0]=e*Math.sin(d*f.DEGREES_TO_RADIANS)/k;c[1]=(1-this.eccentricitySquared)*
    a/l;c[2]=e*h/k;return c.normalize()};t.prototype.surfaceNormalAtPoint=function(a,d,c,e){if(!e)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","surfaceNormalAtPoint","missingResult"));if(this.projection.surfaceNormalAtPoint)return this.projection.surfaceNormalAtPoint(this,a,d,c,e);if(this.is2D())return e[0]=0,e[1]=0,e[2]=1,e;var h=this.equatorialRadius*this.equatorialRadius,f=this.polarRadius*this.polarRadius;e[0]=a/h;e[1]=d/f;e[2]=c/h;return e.normalize()};t.prototype.northTangentAtLocation=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             d,c){if(!c)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","northTangentAtLocation","missingResult"));return this.projection.northTangentAtLocation(this,a,d,c)};t.prototype.northTangentAtPoint=function(a,d,c,e){if(!e)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","northTangentAtPoint","missingResult"));return this.projection.northTangentAtPoint(this,a,d,c,this.offsetVector,e)};t.prototype.intersectsFrustum=function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","intersectsFrustum","missingFrustum"));
    if(this.is2D()){var d=new c;d.setToSector(l.FULL_SPHERE,this,this.elevationModel.minElevation,this.elevationModel.maxElevation);return d.intersectsFrustum(a)}return a.far.distance<=this.equatorialRadius||a.left.distance<=this.equatorialRadius||a.right.distance<=this.equatorialRadius||a.top.distance<=this.equatorialRadius||a.bottom.distance<=this.equatorialRadius||a.near.distance<=this.equatorialRadius?!1:!0};t.prototype.intersectsLine=function(a,d){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe",
    "intersectWithRay","missingLine"));if(!d)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","intersectsLine","missingResult"));if(this.is2D()){var c=a.direction[0],e=a.direction[1],h=a.direction[2],f=a.origin[0],k=a.origin[1],l=a.origin[2],m;if(0==h&&0!=l)return!1;m=-l/h;if(0>m)return!1;d[0]=f+c*m;d[1]=k+e*m;d[2]=l+h*m;return!0}return q.computeEllipsoidalGlobeIntersection(a,this.equatorialRadius,this.polarRadius,d)};t.prototype.elevationTimestamp=function(){return this.elevationModel.timestamp};t.prototype.minElevation=
    function(){return this.elevationModel.minElevation};t.prototype.maxElevation=function(){return this.elevationModel.maxElevation};t.prototype.minAndMaxElevationsForSector=function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","minAndMaxElevationsForSector","missingSector"));return this.elevationModel.minAndMaxElevationsForSector(a)};t.prototype.elevationAtLocation=function(a,b){return this.elevationModel.elevationAtLocation(a,b)};t.prototype.elevationsForGrid=function(a,d,c,e,h){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,
    "Globe","elevationsForSector","missingSector"));if(0>=d||0>=c)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","elevationsForSector","numLat or numLon is less than 1"));if(!h||h.length<d*c)throw new b(g.logMessage(g.LEVEL_SEVERE,"Globe","elevationsForSector","missingArray"));return this.elevationModel.elevationsForGrid(a,d,c,e,h)};return t});
define("src/cache/GpuResourceCache","../util/AbsentResourceList ../error/ArgumentError ../util/ImageSource ../util/Logger ../cache/MemoryCache ../render/Texture".split(" "),function(f,b,c,a,d,e){var g=function(c,g){if(!c||1>c)throw new b(a.logMessage(a.LEVEL_SEVERE,"GpuResourceCache","constructor","Specified cache capacity is undefined, 0 or negative."));if(!g||0>g||g>=c)throw new b(a.logMessage(a.LEVEL_SEVERE,"GpuResourceCache","constructor","Specified cache low-water value is undefined, negative or not less than the capacity."));
    this.entries=new d(c,g);this.cacheKeyPool=0;this.currentRetrievals={};this.absentResourceList=new f(3,6E4)};Object.defineProperties(g.prototype,{capacity:{get:function(){return this.entries.capacity}},lowWater:{get:function(){return this.entries.lowWater}},usedCapacity:{get:function(){return this.entries.usedCapacity}},freeCapacity:{get:function(){return this.entries.freeCapacity}}});g.prototype.generateCacheKey=function(){return"GpuResourceCache "+ ++this.cacheKeyPool};g.prototype.putResource=function(d,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                g,e){if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"GpuResourceCache","putResource","missingKey."));if(!g)throw new b(a.logMessage(a.LEVEL_SEVERE,"GpuResourceCache","putResource","missingResource."));if(!e||1>e)throw new b(a.logMessage(a.LEVEL_SEVERE,"GpuResourceCache","putResource","The specified resource size is undefined or less than 1."));this.entries.putEntry(d instanceof c?d.key:d,{resource:g},e)};g.prototype.resourceForKey=function(a){return(a=a instanceof c?this.entries.entryForKey(a.key):
    this.entries.entryForKey(a))?a.resource:null};g.prototype.containsResource=function(a){return this.entries.containsKey(a instanceof c?a.key:a)};g.prototype.removeResource=function(a){this.entries.removeEntry(a instanceof c?a.key:a)};g.prototype.clear=function(){this.entries.clear(!1)};g.prototype.retrieveTexture=function(b,d,g){if(!d)return null;if(d instanceof c){var f=new e(b,d.image,g);this.putResource(d.key,f,f.size);return f}if(this.currentRetrievals[d]||this.absentResourceList.isResourceAbsent(d))return null;
    var p=this,q=new Image;q.onload=function(){a.log(a.LEVEL_INFO,"Image retrieval succeeded: "+d);var c=new e(b,q,g);p.putResource(d,c,c.size);delete p.currentRetrievals[d];p.absentResourceList.unmarkResourceAbsent(d);c=document.createEvent("Event");c.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0);window.dispatchEvent(c)};q.onerror=function(){delete p.currentRetrievals[d];p.absentResourceList.markResourceAbsent(d);a.log(a.LEVEL_WARNING,"Image retrieval failed: "+d)};this.currentRetrievals[d]=d;q.crossOrigin=
        "anonymous";q.src=d;return null};return g});
define("src/pick/PickedObjectList",[],function(){var f=function(){this.objects=[]};f.prototype.hasNonTerrainObjects=function(){return 1<this.objects.length||1===this.objects.length&&null==this.terrainObject()};f.prototype.terrainObject=function(){for(var b=0,c=this.objects.length;b<c;b++)if(this.objects[b].isTerrain)return this.objects[b];return null};f.prototype.add=function(b){if(b)if(b.isTerrain){for(var c=this.objects.length,a=0,d=this.objects.length;a<d;a++)if(this.objects[a].isTerrain){c=a;
    break}this.objects[c]=b}else this.objects.push(b)};f.prototype.clear=function(){this.objects=[]};f.prototype.topPickedObject=function(){var b=this.objects.length;if(1<b)for(var c=0;c<b;c++)if(this.objects[[c].isOnTop])return this.objects[c];return 0<b?this.objects[0]:null};return f});
define("src/render/ScreenCreditController","../error/ArgumentError ../shaders/BasicTextureProgram ../util/Color ../util/Font ../util/Logger ../geom/Matrix ../util/Offset ../pick/PickedObject ../render/Renderable ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m){var p=function(){this.imageUrls=[];this.stringCredits=[];this.imageCreditSize=64;this.margin=5;this.opacity=.5;this.creditFont=new a(14)};p.scratchMatrix=e.fromIdentity();p.imageTransform=e.fromIdentity();p.texCoordMatrix=
    e.fromIdentity();p.prototype.clear=function(){this.imageUrls=[];this.stringCredits=[]};p.prototype.addImageCredit=function(a){if(!a)throw new f(d.logMessage(d.LEVEL_SEVERE,"ScreenCreditController","addImageCredit","missingUrl"));-1===this.imageUrls.indexOf(a)&&this.imageUrls.push(a)};p.prototype.addStringCredit=function(a,b){if(!a)throw new f(d.logMessage(d.LEVEL_SEVERE,"ScreenCreditController","addStringCredit","missingText"));if(!b)throw new f(d.logMessage(d.LEVEL_SEVERE,"ScreenCreditController",
    "addStringCredit","missingColor"));-1===this.stringCredits.indexOf(a)&&this.stringCredits.push({text:a,color:b||c.WHITE})};p.prototype.drawCredits=function(a){if((0!==this.imageUrls.length||0!==this.stringCredits.length)&&!a.pickingMode&&a.timestamp!=this.lastFrameTimestamp){this.lastFrameTimestamp=a.timestamp;this.beginDrawingCredits(a);for(var b=a.navigatorState.viewport.width-(this.margin+this.imageCreditSize),d,c=0,g=0;g<this.imageUrls.length;g++)d=this.drawImageCredit(a,this.imageUrls[g],b,this.margin),
0<d&&(b-=this.margin+this.imageCreditSize,c=m.max(d,c));b=c+this.margin;for(d=0;d<this.stringCredits.length;d++)this.drawStringCredit(a,this.stringCredits[d],b),b+=this.margin+15;this.endDrawingCredits(a)}};p.prototype.beginDrawingCredits=function(a){var d=a.currentGlContext,c;a.findAndBindProgram(b);c=a.currentProgram;d.bindBuffer(d.ARRAY_BUFFER,a.unitQuadBuffer3());d.vertexAttribPointer(c.vertexPointLocation,3,d.FLOAT,!1,0,0);d.bindBuffer(d.ARRAY_BUFFER,a.unitQuadBuffer());d.vertexAttribPointer(c.vertexTexCoordLocation,
    2,d.FLOAT,!1,0,0);d.enableVertexAttribArray(c.vertexPointLocation);d.enableVertexAttribArray(c.vertexTexCoordLocation);c.loadTextureUnit(d,d.TEXTURE0);c.loadModulateColor(d,!1)};p.prototype.endDrawingCredits=function(a){var b=a.currentGlContext;a=a.currentProgram;b.disableVertexAttribArray(a.vertexPointLocation);b.disableVertexAttribArray(a.vertexTexCoordLocation);b.bindBuffer(b.ARRAY_BUFFER,null);b.bindTexture(b.TEXTURE_2D,null);b.enable(b.DEPTH_TEST)};p.prototype.drawImageCredit=function(a,b,d,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   g){var e,h,f;f=a.gpuResourceCache.resourceForKey(b);if(!f)return a.gpuResourceCache.retrieveTexture(a.currentGlContext,b),0;e=f.imageWidth;b=f.imageHeight;h=e<=this.imageCreditSize&&this.imageHeight<=this.imageCreditSize?1:e>=b?this.imageCreditSize/e:this.imageCreditSize/b;p.imageTransform.setTranslation(d,g,0);p.imageTransform.setScale(h*e,h*b,1);d=a.currentGlContext;g=a.currentProgram;p.scratchMatrix.copy(a.screenProjection);p.scratchMatrix.multiplyMatrix(p.imageTransform);g.loadModelviewProjection(d,
    p.scratchMatrix);g.loadTextureEnabled(d,!0);g.loadColor(d,c.WHITE);g.loadOpacity(d,this.opacity);p.texCoordMatrix.setToIdentity();p.texCoordMatrix.multiplyByTextureTransform(f);g.loadTextureMatrix(d,p.texCoordMatrix);f.bind(a)&&d.drawArrays(d.TRIANGLE_STRIP,0,4);return b};p.prototype.drawStringCredit=function(a,b,d){var c,g,e;c=b.text+this.creditFont.toString();e=a.gpuResourceCache.resourceForKey(c);e||(e=a.textSupport.createTexture(a,b.text,this.creditFont,!1),a.gpuResourceCache.putResource(c,e,
    e.size));c=e.imageWidth;g=e.imageHeight;p.imageTransform.setTranslation(a.navigatorState.viewport.width-(c+this.margin),d,0);p.imageTransform.setScale(c,g,1);d=a.currentGlContext;c=a.currentProgram;p.scratchMatrix.copy(a.screenProjection);p.scratchMatrix.multiplyMatrix(p.imageTransform);c.loadModelviewProjection(d,p.scratchMatrix);c.loadTextureEnabled(d,!0);c.loadColor(d,b.color);c.loadOpacity(d,this.opacity);p.texCoordMatrix.setToIdentity();p.texCoordMatrix.multiplyByTextureTransform(e);c.loadTextureMatrix(d,
    p.texCoordMatrix);e.bind(a)&&d.drawArrays(d.TRIANGLE_STRIP,0,4);return!0};return p});
define("src/shapes/ShapeAttributes",["../util/Color","../util/ImageSource"],function(f,b){var c=function(a){this._drawInterior=a?a._drawInterior:!0;this._drawOutline=a?a._drawOutline:!0;this._enableLighting=a?a._enableLighting:!1;this._interiorColor=a?a._interiorColor:f.WHITE;this._outlineColor=a?a._outlineColor:f.RED;this._outlineWidth=a?a._outlineWidth:1;this._outlineStippleFactor=a?a._outlineStippleFactor:0;this._outlineStipplePattern=a?a._outlineStipplePattern:61680;this._imageSource=a?a._imageSource:
    null;this._depthTest=a?a._depthTest:!0;this._drawVerticals=a?a._drawVerticals:!1;this._applyLighting=a?a._applyLighting:!1;this.stateKeyInvalid=!0};c.prototype.computeStateKey=function(){return"di "+this._drawInterior+" do "+this._drawOutline+" el "+this._enableLighting+" ic "+this._interiorColor.toHexString(!0)+" oc "+this._outlineColor.toHexString(!0)+" ow "+this._outlineWidth+" osf "+this._outlineStippleFactor+" osp "+this._outlineStipplePattern+" is "+(this._imageSource?this.imageSource instanceof
    b?this.imageSource.key:this.imageSource:"null")+" dt "+this._depthTest+" dv "+this._drawVerticals+" li "+this._applyLighting};Object.defineProperties(c.prototype,{stateKey:{get:function(){this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1);return this._stateKey}},drawInterior:{get:function(){return this._drawInterior},set:function(a){this._drawInterior=a;this.stateKeyInvalid=!0}},drawOutline:{get:function(){return this._drawOutline},set:function(a){this._drawOutline=
    a;this.stateKeyInvalid=!0}},enableLighting:{get:function(){return this._enableLighting},set:function(a){this._enableLighting=a;this.stateKeyInvalid=!0}},interiorColor:{get:function(){return this._interiorColor},set:function(a){this._interiorColor=a;this.stateKeyInvalid=!0}},outlineColor:{get:function(){return this._outlineColor},set:function(a){this._outlineColor=a;this.stateKeyInvalid=!0}},outlineWidth:{get:function(){return this._outlineWidth},set:function(a){this._outlineWidth=a;this.stateKeyInvalid=
    !0}},outlineStipplePattern:{get:function(){return this._outlineStipplePattern},set:function(a){this._outlineStipplePattern=a;this.stateKeyInvalid=!0}},outlineStippleFactor:{get:function(){return this._outlineStippleFactor},set:function(a){this._outlineStippleFactor=a;this.stateKeyInvalid=!0}},imageSource:{get:function(){return this._imageSource},set:function(a){this._imageSource=a;this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(a){this._depthTest=a;this.stateKeyInvalid=
    !0}},drawVerticals:{get:function(){return this._drawVerticals},set:function(a){this._drawVerticals=a;this.stateKeyInvalid=!0}},applyLighting:{get:function(){return this._applyLighting},set:function(a){this._applyLighting=a;this.stateKeyInvalid=!0}}});return c});
define("src/shapes/SurfaceShape","../error/AbstractError ../geom/Angle ../error/ArgumentError ../geom/Location ../util/Logger ../error/NotYetImplementedError ../pick/PickedObject ../render/Renderable ../geom/Sector ../shapes/ShapeAttributes ../error/UnsupportedOperationError ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p){var q=function(a){h.call(this);this._displayName="Surface Shape";this._attributes=a?a:new l(null);this._highlightAttributes=null;this._highlighted=!1;this._enabled=
    !0;this._pathType=WorldWind.GREAT_CIRCLE;this._maximumNumEdgeIntervals=q.DEFAULT_NUM_EDGE_INTERVALS;this._polarThrottle=q.DEFAULT_POLAR_THROTTLE;this.pickDelegate=this._sector=null;this._sectors=[];this._outlineGeometry=this._interiorGeometry=this._boundaries=this._locations=null;this._isInteriorInhibited=!1;this.stateKeyInvalid=!0;this._attributesStateKey=null;this.isPrepared=!1;this.pickColor=this.layer=null};q.prototype=Object.create(h.prototype);Object.defineProperties(q.prototype,{stateKey:{get:function(){if(this._attributesStateKey){var a=
    null;this._highlighted?this._highlightAttributes&&(a=this._highlightAttributes.stateKey):this._attributes&&(a=this._attributes.stateKey);a!=this._attributesStateKey&&(this._attributesStateKey=a,this.stateKeyInvalid=!0)}else this._highlighted?this._highlightAttributes&&(this._attributesStateKey=this._highlightAttributes.stateKey):this._attributes&&(this._attributesStateKey=this._attributes.stateKey),this._attributesStateKey&&(this.stateKeyInvalid=!0);this.stateKeyInvalid&&(this._stateKey=this.computeStateKey());
    return this._stateKey}},displayName:{get:function(){return this._displayName},set:function(a){this.stateKeyInvalid=!0;this._displayName=a}},attributes:{get:function(){return this._attributes},set:function(a){this.stateKeyInvalid=!0;this._attributes=a;this._attributesStateKey=a.stateKey}},highlightAttributes:{get:function(){return this._highlightAttributes},set:function(a){this.stateKeyInvalid=!0;this._highlightAttributes=a}},highlighted:{get:function(){return this._highlighted},set:function(a){this.stateKeyInvalid=
    !0;this._highlighted=a}},enabled:{get:function(){return this._enabled},set:function(a){this.stateKeyInvalid=!0;this._enabled=a}},pathType:{get:function(){return this._pathType},set:function(a){this.stateKeyInvalid=!0;this._pathType=a}},maximumNumEdgeIntervals:{get:function(){return this._maximumNumEdgeIntervals},set:function(a){this.stateKeyInvalid=!0;this._maximumNumEdgeIntervals=a}},polarThrottle:{get:function(){return this._polarThrottle},set:function(a){this.stateKeyInvalid=!0;this._polarThrottle=
    a}},sector:{get:function(){return this._sector}}});q.staticStateKey=function(a){a.stateKeyInvalid=!1;a._attributesStateKey=a.highlighted?a._highlightAttributes?a._highlightAttributes.stateKey:a._attributes?a._attributes.stateKey:null:a._attributes?a._attributes.stateKey:null;return"dn "+a.displayName+" at "+(a._attributesStateKey?a._attributesStateKey:"null")+" hi "+a.highlighted+" en "+a.enabled+" pt "+a.pathType+" ne "+a.maximumNumEdgeIntervals+" po "+a.polarThrottle+" se ["+a.sector.minLatitude+
    ","+a.sector.maxLatitude+","+a.sector.minLongitude+","+a.sector.maxLongitude+"]"};q.prototype.computeStateKey=function(){return q.staticStateKey(this)};q.prototype.area=function(a,b){throw new e(d.logMessage(d.LEVEL_SEVERE,"SurfaceShape","area","notYetImplemented"));};q.prototype.computeBoundaries=function(a){throw new f(d.logMessage(d.LEVEL_SEVERE,"SurfaceShape","computeBoundaries","abstractInvocation"));};q.prototype.render=function(a){this.enabled&&(this.layer=a.currentLayer,this.prepareBoundaries(a),
    a.surfaceShapeTileBuilder.insertSurfaceShape(this))};q.prototype.interpolateLocations=function(a){var b=a[0],d=b,c,g=!0,e,h=0,f,k,l;this._locations=[b];k=1;for(l=a.length;k<l;k+=1){c=d;e=g;d=a[k];g=d.latitude==b.latitude&&d.longitude==b.longitude;f=!0;if(g||e)h+=1,2<h&&(f=!1);f&&this.interpolateEdge(c,d,this._locations);this._locations.push(d);c=d}this._isInteriorInhibited||c.latitude==b.latitude&&c.longitude==b.longitude||(this.interpolateEdge(c,b,this._locations),this._locations.push(b))};q.prototype.interpolateEdge=
    function(b,d,c){var g=a.greatCircleDistance(b,d),g=Math.round(this._maximumNumEdgeIntervals*g/Math.PI),e;if(0<g)for(var g=1/g,h=this.throttledStep(g,b);1>h;h+=this.throttledStep(g,e))e=new a(0,0),a.interpolateAlongPath(this._pathType,h,b,d,e),c.push(e)};q.prototype.throttledStep=function(a,d){var c=Math.cos(d.latitude*b.DEGREES_TO_RADIANS),g=this._polarThrottle/(1+this._polarThrottle);return a*(1-g+g*c*c)};q.prototype.prepareBoundaries=function(a){this.isPrepared||(this._boundaries||this.computeBoundaries(a),
this._locations||this.interpolateLocations(this._boundaries),this.prepareGeometry(a),this.prepareSectors(),this.isPrepared=!0)};q.prototype.computeSectors=function(a){if(this._sectors&&0<this._sectors.length)return this._sectors;this.prepareBoundaries(a);return this._sectors};q.prototype.prepareSectors=function(){var b=this._boundaries;if(b){this._sector=new k(-90,90,-180,180);this._sector.setToBoundingSector(b);var d=this.containsPole(b);d!=a.poles.NONE?(this._sector=d==a.poles.NORTH?new k(this._sector.minLatitude,
    90,-180,180):new k(-90,this._sector.maxLatitude,-180,180),this._sectors=[this._sector]):a.locationsCrossDateLine(b)?this._sectors=k.splitBoundingSectors(b):this._sector.isEmpty()||(this._sectors=[this._sector]);if(this._sectors&&this._pathType===WorldWind.GREAT_CIRCLE)for(var d=0,c=this._sectors.length;d<c;d+=1){var g=this._sectors[d],e=a.greatCircleArcExtremeLocations(b);this._sectors[d]=new k(Math.min(g.minLatitude,e[0].latitude),Math.max(g.maxLatitude,e[1].latitude),g.minLongitude,g.maxLongitude)}}};
    q.prototype.prepareGeometry=function(b){var d;this._interiorGeometry=[];this._outlineGeometry=[];d=this._locations;var c=this.containsPole(d);c!=a.poles.NONE?(b=this.cutAlongDateLine(d,c,b.globe),this._interiorGeometry.push(b),d=this.repeatAroundDateline(d),this._outlineGeometry.push(d[0]),1<d.length&&this._outlineGeometry.push(d[1])):a.locationsCrossDateLine(d)?(d=this.repeatAroundDateline(d),this._interiorGeometry.push(d[0]),this._interiorGeometry.push(d[1]),this._outlineGeometry.push(d[0]),this._outlineGeometry.push(d[1])):
        (this._interiorGeometry.push(d),this._outlineGeometry.push(d))};q.prototype.containsPole=function(b){for(var d=!1,c=90,g=-90,e=b[0],h=1,f=b.length;h<f;h+=1){var k=b[h];a.locationsCrossDateLine([e,k])&&(d=!d);c=Math.min(c,k.latitude);g=Math.max(g,k.latitude);e=k}a.locationsCrossDateLine([b[0],e])&&(d=!d);return d?0<c?a.poles.NORTH:0>g?a.poles.SOUTH:Math.abs(g)>=Math.abs(c)?a.poles.NORTH:a.poles.SOUTH:a.poles.NONE};q.prototype.cutAlongDateLine=function(b,d,c){if(d==a.poles.NONE)return b;var g=[];d=
        d==a.poles.NORTH?90:-90;for(var e=b[b.length-1],h=0,f=b.length;h<f;h+=1){var k=b[h];g.push(e);if(a.locationsCrossDateLine([e,k])){var l=a.intersectionWithMeridian(e,k,180,c),e=p.signum(e.longitude),e=180*e,m=-e;g.push(new a(l,e));g.push(new a(d,e));g.push(new a(d,m));g.push(new a(l,m))}e=k}g.push(e);return g};q.prototype.repeatAroundDateline=function(b){var d=0,c=!1,g=[],e=b[0];g.push(e);for(var h=1,f=b.length;h<f;h+=1){var k=b[h];a.locationsCrossDateLine([e,k])&&(0==d&&(d=0>e.longitude?-360:360),
        c=!c);c?g.push(new a(k.latitude,k.longitude+d)):g.push(k);e=k}b=[g];if(0!=d){c=g;g=[];h=0;for(f=c.length;h<f;h+=1)e=c[h],g.push(new a(e.latitude,e.longitude-d));b.push(g)}return b};q.prototype.resetPickColor=function(){this.pickColor=null};q.prototype.renderToTexture=function(a,b,d,c,e,h){var f,k,l=[],m,p,q=a.pickingMode,H=this._highlighted?this._highlightAttributes||this._attributes:this._attributes;q&&!this.pickColor&&(this.pickColor=a.uniquePickColor());if(!this._isInteriorInhibited&&H.drawInterior)for(b.fillStyle=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           q?this.pickColor.toRGBAString():H.interiorColor.toRGBAString(),f=0,k=this._interiorGeometry.length;f<k;f+=1)if(m=0,p=2*this._outlineGeometry[f].length,l.splice(0,l.length),this.transformPath(this._interiorGeometry[f],d,c,e,h,l)){b.beginPath();for(b.moveTo(l[m++],l[m++]);m<p;)b.lineTo(l[m++],l[m++]);b.closePath();b.fill()}if(H.drawOutline&&0<H.outlineWidth)for(b.lineWidth=4*H.outlineWidth,b.strokeStyle=q?this.pickColor.toRGBAString():H.outlineColor.toRGBAString(),f=0,k=this._outlineGeometry.length;f<
    k;f+=1)if(l.splice(0,l.length),this.transformPath(this._outlineGeometry[f],d,c,e,h,l)){var H=l[0],C=l[1],z,E,L=H,M=C,I,K=!0,O=0;m=2;for(p=l.length;m<p;){z=L;E=M;I=K;L=l[m++];M=l[m++];K=L==H&&M==C;if(I||K)if(O+=1,2<O)continue;b.beginPath();b.moveTo(z,E);b.lineTo(L,M);b.stroke()}}q&&(b=new g(this.pickColor.clone(),this._pickDelegate?this._pickDelegate:this,null,this.layer,!1),a.resolvePick(b))};q.prototype.transformPath=function(a,b,d,c,g,e){var h,f,k,l,m,p,q,C,z,E,L,M,I,K,O,N,R,S;N=0;O=a[0];m=O.longitude*
        b+c;p=O.latitude*d+g;z=L=h=k=m;E=M=f=l=p;e[N++]=k;e[N++]=l;R=1;for(S=a.length;R<S;R+=1)if(O=a[R],q=k,C=l,k=O.longitude*b+c,l=O.latitude*d+g,O=k==m&&l==p,I=k-h,K=l-f,I=I*I+K*K,O||4<=I){z=Math.min(z,k);L=Math.max(L,k);E=Math.min(E,l);M=Math.max(M,l);if(e[N-2]!=q||e[N-1]!=C)e[N++]=q,e[N++]=C;e[N++]=k;e[N++]=l;h=k;f=l}return 2<=L-z||2<=M-E};q.DEFAULT_NUM_EDGE_INTERVALS=128;q.DEFAULT_POLAR_THROTTLE=10;return q});
define("src/shapes/SurfaceShapeTile","../geom/Angle ../error/ArgumentError ../util/Level ../util/Logger ../geom/Sector ../render/Texture ../render/TextureTile".split(" "),function(f,b,c,a,d,e,g){var h=function(a,b,d,c){g.call(this,a,b,d,c);this.surfaceShapes=[];this.sector=a;this.cacheKey=null;this.pickSequence=0;this.surfaceShapeStateKeys=[];this.prevSurfaceShapes=[];this.createCtx2D()};h.prototype=Object.create(g.prototype);h.prototype.clearShapes=function(){var a=this.prevSurfaceShapes;this.prevSurfaceShapes=
    this.surfaceShapes;this.surfaceShapes=a;this.surfaceShapes.splice(0,this.surfaceShapes.length)};h.prototype.hasShapes=function(){return 0<this.surfaceShapes.length};h.prototype.getShapes=function(){return this.surfaceShapes};h.prototype.setShapes=function(a){this.surfaceShapes=a};h.prototype.getSector=function(){return this.sector};h.prototype.addSurfaceShape=function(a){this.surfaceShapes.push(a);this.surfaceShapeStateKeys.push(a.stateKey)};h.prototype.addAllSurfaceShapes=function(a){for(var b=0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      d=a.length;b<d;b+=1)this.addAllSurfaceShapes(a[b])};h.prototype.needsUpdate=function(a){var b,d,c,g;if(this.prevSurfaceShapes.length!=this.surfaceShapes.length)return!0;b=0;for(d=this.prevSurfaceShapes;b<d;b+=1)if(c=this.prevSurfaceShapes[b],0>this.surfaceShapes.indexOf(c))return!0;b=0;for(d=this.surfaceShapes;b<d;b+=1)if(c=this.surfaceShapes[b],0>this.prevSurfaceShapes.indexOf(c))return!0;b=0;for(d=this.surfaceShapes.length;b<d;b+=1)if(c=this.surfaceShapes[b],g=this.surfaceShapeStateKeys[b],g!=c.stateKey)return!0;
    return this.hasTexture(a)?!1:!0};h.prototype.hasTexture=function(a){if(a.pickingMode)return!1;a=a.gpuResourceCache;this.gpuCacheKey||(this.gpuCacheKey=this.getCacheKey());return!!a.resourceForKey(this.gpuCacheKey)};h.prototype.updateTexture=function(a){var b=a.currentGlContext,d=h.canvas;d.width=this.tileWidth;d.height=this.tileHeight;for(var c=h.ctx2D,g=this.tileWidth/this.sector.deltaLongitude(),f=-this.tileHeight/this.sector.deltaLatitude(),r=-this.sector.minLongitude*g,u=-this.sector.maxLatitude*
    f,w=0,x=this.surfaceShapes.length;w<x;w+=1){var A=this.surfaceShapes[w];this.surfaceShapeStateKeys[w]=A.stateKey;A.renderToTexture(a,c,g,f,r,u)}b=new e(b,d);a=a.gpuResourceCache;this.gpuCacheKey=this.getCacheKey();a.putResource(this.gpuCacheKey,b,b.size);return b};h.prototype.getCacheKey=function(){this.cacheKey||(this.cacheKey="SurfaceShapeTile:"+this.tileKey+","+this.pickSequence.toString());return this.cacheKey};h.prototype.createCtx2D=function(){h.ctx2D||(h.canvas=document.createElement("canvas"),
    h.ctx2D=h.canvas.getContext("2d"))};h.canvas=null;h.ctx2D=null;return h});
define("src/shapes/SurfaceShapeTileBuilder","../error/ArgumentError ../render/DrawContext ../globe/Globe ../shaders/GpuProgram ../util/Level ../util/LevelSet ../geom/Location ../util/Logger ../geom/Matrix ../cache/MemoryCache ../navigate/NavigatorState ../error/NotYetImplementedError ../pick/PickedObject ../geom/Rectangle ../geom/Sector ../shapes/SurfaceShape ../shapes/SurfaceShapeTile ../globe/Terrain ../globe/TerrainTile ../globe/TerrainTileList ../render/TextureTile ../util/Tile".split(" "),function(f,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b,c,a,d,e,g,h,k,l,m,p,q,t,r,u,w,x,A,B,v,F){var G=function(){this.numRowsTilesInTopLevel=4;this.numColumnsTilesInTopLevel=8;this.maximumSubdivisionDepth=15;this.tileHeight=this.tileWidth=256;this.levels=new e(r.FULL_SPHERE,new g(180/this.numRowsTilesInTopLevel,360/this.numColumnsTilesInTopLevel),this.maximumSubdivisionDepth,this.tileWidth,this.tileHeight);this.surfaceShapes=[];this.surfaceShapeTiles=[];this.topLevelTiles=[];this.sector=new r(-90,90,-180,180);this.detailControl=1.25;this.tileCache=
    new l(5E5,4E5)};G.prototype.clear=function(){this.surfaceShapeTiles.splice(0,this.surfaceShapeTiles.length);this.surfaceShapes.splice(0,this.surfaceShapes.length)};G.prototype.insertSurfaceShape=function(a){this.surfaceShapes.push(a)};G.prototype.doRender=function(a){if(a.pickingMode){for(var b=0,d=this.surfaceShapes.length;b<d;b+=1)this.surfaceShapes[b].resetPickColor();G.pickSequence+=1;b=this.surfaceShapeTiles;d=this.topLevelTiles;this.surfaceShapeTiles=[];this.topLevelTiles=[];this.buildTiles(a);
    a.deepPicking?this.doDeepPickingRender(a):a.surfaceTileRenderer.renderTiles(a,this.surfaceShapeTiles,1);this.surfaceShapeTiles=b;this.topLevelTiles=d}else this.buildTiles(a),a.surfaceTileRenderer.renderTiles(a,this.surfaceShapeTiles,1)};G.prototype.doDeepPickingRender=function(a){var b,d,c,g,e,h,f=[];c=0;for(g=a.objectsAtPickPoint.objects.length;c<g;c+=1)e=a.objectsAtPickPoint.objects[c],e.userObject instanceof u&&(e=e.userObject,0>f.indexOf(e)&&(f.push(e),a.objectsAtPickPoint.objects.splice(c,1),
    --c,--g));if(!(0>=f.length)){var k=[];c=0;for(g=f.length;c<g;c+=1){e=f[c];b=0;for(d=this.surfaceShapeTiles.length;b<d;b+=1)h=this.surfaceShapeTiles[b],h.setShapes([e]),h.updateTexture(a);a.surfaceTileRenderer.renderTiles(a,this.surfaceShapeTiles,1);(b=a.readPickColor(a.pickPoint))&&e.pickColor.equals(b)&&(e=new q(e.pickColor.clone(),e._pickDelegate?e._pickDelegate:e,null,e.layer,!1),k.push(e))}c=0;for(g=a.objectsAtPickPoint.objects.length;c<g;c+=1)e=a.objectsAtPickPoint.objects[c],e.userObject instanceof
u&&(a.objectsAtPickPoint.objects.splice(c,1),--c,--g);c=0;for(g=k.length;c<g;c+=1)e=k[c],a.objectsAtPickPoint.objects.push(e)}};G.prototype.buildTiles=function(a){if(!a)throw new f(h.logMessage(h.LEVEL_SEVERE,"SurfaceShapeTileBuilder","buildTiles","missingDc"));if(this.surfaceShapes&&!(1>this.surfaceShapes.length)){this.assembleTiles(a);this.surfaceShapes.splice(0,this.surfaceShapes.length);a=0;for(var b=this.surfaceShapeTiles.length;a<b;a+=1)this.surfaceShapeTiles[a].clearShapes()}};G.prototype.assembleTiles=
    function(a){var b,d,c,g,e,h,f;1>this.topLevelTiles.length&&this.createTopLevelTiles();var k={};d=0;for(c=this.surfaceShapes.length;d<c;d+=1){var l=this.surfaceShapes[d],m=l.computeSectors(a);if(m)for(h=0,f=m.length;h<f;h+=1){var p=m[h];g=0;for(e=this.topLevelTiles.length;g<e;g+=1)b=this.topLevelTiles[g],b.sector.intersects(p)&&(k[b.tileKey]=b,b.addSurfaceShape(l))}}for(var q in k)k.hasOwnProperty(q)&&(b=k[q],this.addTileOrDescendants(a,this.levels,null,b))};G.prototype.addTileOrDescendants=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b,d,c){if(this.intersectsFrustum(a,c)){if(null!=d&&this.addIntersectingShapes(a,d,c),c.hasShapes())if(this.meetsRenderCriteria(a,b,c))this.addTile(a,c);else{d=b.level(c.level.levelNumber+1);d=a.pickingMode?c.subdivide(d,this):c.subdivideToCache(d,this,this.tileCache);for(var g=0,e=d.length;g<e;g+=1)this.addTileOrDescendants(a,b,c,d[g]);c.clearShapes()}}else c.clearShapes()};G.prototype.addIntersectingShapes=function(a,b,d){if(b.hasShapes()&&d.sector.intersects(b.sector))if(d.getSector().contains(b.sector))d.addAllSurfaceShapes(b.getShapes());
else{b=b.getShapes();for(var c=0,g=b.length;c<g;c+=1){var e=b[c],h=e.computeSectors(a);if(h)for(var f=0,k=h.length;f<k;f+=1){var l=h[f];if(d.getSector().intersects(l)){d.addSurfaceShape(e);break}}}}};G.prototype.addTile=function(a,b){a.pickingMode&&(b.pickSequence=G.pickSequence);b.needsUpdate(a)&&b.updateTexture(a);this.surfaceShapeTiles.push(b)};G.prototype.createTile=function(a,b,d,c){return new w(a,b,d,c)};G.prototype.createTopLevelTiles=function(){F.createTilesForLevel(this.levels.firstLevel(),
    this,this.topLevelTiles)};G.prototype.intersectsFrustum=function(a,b){if(a.globe.projectionLimits&&!b.sector.overlaps(a.globe.projectionLimits))return!1;b.update(a);return b.extent.intersectsFrustum(a.pickingMode?a.pickFrustum:a.navigatorState.frustumInModelCoordinates)};G.prototype.meetsRenderCriteria=function(a,b,d){return d.level.levelNumber==b.lastLevel().levelNumber||!d.mustSubdivide(a,this.detailControl)};G.pickSequence=0;return G});
define("src/shaders/SurfaceTileRendererProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(f,b,c,a){b=function(a){c.call(this,a,"attribute vec4 vertexPoint;\nattribute vec4 vertexTexCoord;\nuniform mat4 mvpMatrix;\nuniform mat4 texSamplerMatrix;\nuniform mat4 texMaskMatrix;\nvarying vec2 texSamplerCoord;\nvarying vec2 texMaskCoord;\nvoid main() {\ngl_Position = mvpMatrix * vertexPoint;\ntexSamplerCoord = (texSamplerMatrix * vertexTexCoord).st;\ntexMaskCoord = (texMaskMatrix * vertexTexCoord).st;\n}",
    "precision mediump float;\nuniform sampler2D texSampler;\nuniform float opacity;\nuniform vec4 color;\nuniform bool modulateColor;\nvarying vec2 texSamplerCoord;\nvarying vec2 texMaskCoord;\nbool isInsideTextureImage(const vec2 coord) {\n    return coord.x >= 0.0 && coord.x <= 1.0 && coord.y >= 0.0 && coord.y <= 1.0;\n}\nvoid main(void) {\nfloat mask = float(isInsideTextureImage(texMaskCoord));if (modulateColor) {\n    gl_FragColor = color * mask * floor(texture2D(texSampler, texSamplerCoord).a + 0.5);\n} else {\n    gl_FragColor = texture2D(texSampler, texSamplerCoord) * mask * opacity;\n}\n}");
    this.vertexPointLocation=this.attributeLocation(a,"vertexPoint");this.vertexTexCoordLocation=this.attributeLocation(a,"vertexTexCoord");this.mvpMatrixLocation=this.uniformLocation(a,"mvpMatrix");this.colorLocation=this.uniformLocation(a,"color");this.modulateColorLocation=this.uniformLocation(a,"modulateColor");this.texSamplerMatrixLocation=this.uniformLocation(a,"texSamplerMatrix");this.texMaskMatrixLocation=this.uniformLocation(a,"texMaskMatrix");this.texSamplerLocation=this.uniformLocation(a,"texSampler");
    this.opacityLocation=this.uniformLocation(a,"opacity");this.vertexPointLocation=-1};b.key="WorldWindGpuSurfaceTileRenderingProgram";b.prototype=Object.create(c.prototype);b.prototype.loadModelviewProjection=function(b,c){if(!c)throw new f(a.logMessage(a.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(b,c,this.mvpMatrixLocation)};b.prototype.loadTexSamplerMatrix=function(b,c){if(!c)throw new f(a.logMessage(a.LEVEL_SEVERE,"SurfaceTileRendererProgram",
    "loadTexSamplerMatrix","missingMatrix"));this.loadUniformMatrix(b,c,this.texSamplerMatrixLocation)};b.prototype.loadTexMaskMatrix=function(b,c){if(!c)throw new f(a.logMessage(a.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadTexMaskMatrix","missingMatrix"));this.loadUniformMatrix(b,c,this.texMaskMatrixLocation)};b.prototype.loadTexSampler=function(a,b){a.uniform1i(this.texSamplerLocation,b-WebGLRenderingContext.TEXTURE0)};b.prototype.loadOpacity=function(a,b){a.uniform1f(this.opacityLocation,b)};b.prototype.loadColor=
    function(b,c){if(!c)throw new f(a.logMessage(a.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadColor","missingColor"));this.loadUniformColor(b,c,this.colorLocation)};b.prototype.loadModulateColor=function(a,b){a.uniform1i(this.modulateColorLocation,b?1:0)};return b});
define("src/render/SurfaceTileRenderer",["../error/ArgumentError","../util/Logger","../geom/Matrix","../shapes/SurfaceShapeTile","../shaders/SurfaceTileRendererProgram"],function(f,b,c,a,d){var e=function(){this.texMaskMatrix=c.fromIdentity();this.texSamplerMatrix=c.fromIdentity();this.isSurfaceShapeTileRendering=!1};e.prototype.renderTiles=function(d,c,e,l){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"SurfaceTileRenderer","renderTiles","Specified surface tiles array is null or undefined."));if(!(1>
    c.length)){var m=d.terrain,p=d.currentGlContext,q=0,t,r,u,w,x=1;if(m){this.isSurfaceShapeTileRendering=c[0]instanceof a;e*=d.surfaceOpacity;t=this.beginRendering(d,e);m.beginRendering(d);try{for(var A=0,B=m.surfaceGeometry.length;A<B;A++){r=m.surfaceGeometry[A];u=r.sector;m.beginRenderingTile(d,r);try{for(var v=0,F=c.length;v<F;v++)w=c[v],w.sector.overlaps(u)&&w.bind(d)&&(d.pickingMode?w.pickColor&&t.loadColor(p,w.pickColor):l&&w.opacity!=x&&(t.loadOpacity(p,e*w.opacity),x=w.opacity),this.applyTileState(d,
    r,w),m.renderTile(d,r),++q)}catch(G){console.log(G)}finally{m.endRenderingTile(d,r)}}}catch(G){console.log(G)}finally{m.endRendering(d),this.endRendering(d),d.frameStatistics.incrementRenderedTileCount(q)}}}};e.prototype.beginRendering=function(a,b){var c=a.currentGlContext,e=a.findAndBindProgram(d);e.loadTexSampler(c,c.TEXTURE0);a.pickingMode&&!this.isSurfaceShapeTileRendering?e.loadModulateColor(c,!0):(e.loadModulateColor(c,!1),e.loadOpacity(c,b));return e};e.prototype.endRendering=function(a){a=
    a.currentGlContext;a.bindTexture(a.TEXTURE_2D,null)};e.prototype.applyTileState=function(a,b,d){var c=a.currentGlContext,e=a.currentProgram;b=b.sector;var f=b.deltaLatitude(),q=b.deltaLongitude(),t=d.sector,r=t.deltaLatitude(),u=t.deltaLongitude(),r=0<r?r:1,u=0<u?u:1;this.texMaskMatrix.set(q/u,0,0,-(t.minLongitude-b.minLongitude)/u,0,f/r,0,-(t.minLatitude-b.minLatitude)/r,0,0,1,0,0,0,0,1);this.texSamplerMatrix.setToUnitYFlip();d.applyInternalTransform(a,this.texSamplerMatrix);this.texSamplerMatrix.multiplyMatrix(this.texMaskMatrix);
    e.loadTexSamplerMatrix(c,this.texSamplerMatrix);e.loadTexMaskMatrix(c,this.texMaskMatrix)};return e});
define("src/render/TextSupport","../error/ArgumentError ../shaders/BasicTextureProgram ../util/Color ../util/Logger ../geom/Matrix ../render/Texture ../geom/Vec2".split(" "),function(f,b,c,a,d,e,g){b=function(){this.canvas2D=document.createElement("canvas");this.ctx2D=this.canvas2D.getContext("2d");this.lineSpacing=.15;this.strokeStyle="rgba(0, 0, 0, 0.5)";this.strokeWidth=4};b.prototype.textSize=function(a,b,d){if(0===a.length)return new g(0,0);this.ctx2D.font=b.fontString;a=a.split("\n");b=a.length*
    b.size*(1+this.lineSpacing);for(var c=0,e=0;e<a.length;e++)c=Math.max(c,this.ctx2D.measureText(a[e]).width);d&&(c+=this.strokeWidth,b+=this.strokeWidth);return new g(c,b)};b.prototype.createTexture=function(a,b,d,g){var f=a.currentGlContext,q=this.ctx2D,t=this.canvas2D,r=this.textSize(b,d,g);b=b.split("\n");var u=g?this.strokeWidth/2:0;a=a.pixelScale;t.width=Math.ceil(r[0])*a;t.height=Math.ceil(r[1])*a;q.scale(a,a);q.font=d.fontString;q.textBaseline="top";q.textAlign=d.horizontalAlignment;q.fillStyle=
    c.WHITE.toHexString(!1);q.strokeStyle=this.strokeStyle;q.lineWidth=this.strokeWidth;q.lineCap="round";q.lineJoin="round";"left"===d.horizontalAlignment?q.translate(u,0):"right"===d.horizontalAlignment?q.translate(r[0]-u,0):q.translate(r[0]/2,0);for(r=0;r<b.length;r++)g&&q.strokeText(b[r],0,0),q.fillText(b[r],0,0),q.translate(0,d.size*(1+this.lineSpacing)+u);return new e(f,t)};b.prototype.getMaxLineHeight=function(a){return this.textSize("_\u00c9",a,0)[1]};b.prototype.wrap=function(b,d,c,g){if(!b)throw new f(a.logMessage(a.WARNING,
    "TextSupport","wrap","missing text"));var e=b.split("\n"),q="";for(b=0;b<e.length;b++)e[b]=this.wrapLine(e[b],d,g);d=0;var t=!1;g=this.getMaxLineHeight(g);for(b=0;b<e.length&&!t;b++){for(var r=e[b].split("\n"),u=0;u<r.length&&!t;u++)0>=c||d+g<=c?(q+=r[u],d+=g+this.lineSpacing,u<r.length-1&&(q+="\n")):t=!0;b<e.length-1&&!t&&(q+="\n")}t&&(0<q.length&&(q=q.substring(0,q.length-1)),q+="...");return q};b.prototype.wrapLine=function(a,b,d){var c="";a=a.trim();if(this.textSize(a,d,0)[0]>b){for(var g="",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    e=0,f=a.indexOf(" ",e+1);e<a.length;)-1==f&&(f=a.length),e=a.substring(e,f),this.textSize(g+e,d,0)[0]<=b?g+=e:(0!=g.length&&(c+=g,c+="\n",g=""),g+=e.trim()),e=f,e<a.length-1&&(f=a.indexOf(" ",e+1));c+=g}else c+=a;return c};return b});
define("src/render/DrawContext","../error/ArgumentError ../util/Color ../util/FrameStatistics ../render/FramebufferTexture ../render/FramebufferTileController ../geom/Frustum ../globe/Globe ../shaders/GpuProgram ../cache/GpuResourceCache ../layer/Layer ../util/Logger ../geom/Matrix ../navigate/NavigatorState ../pick/PickedObjectList ../geom/Plane ../geom/Position ../geom/Rectangle ../render/ScreenCreditController ../geom/Sector ../shapes/SurfaceShape ../shapes/SurfaceShapeTileBuilder ../render/SurfaceTileRenderer ../render/TextSupport ../geom/Vec2 ../geom/Vec3 ../util/WWMath".split(" "),function(f,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           b,c,a,d,e,g,h,k,l,m,p,q,t,r,u,w,x,A,B,v,F,G,D,y,H){var C=function(a){if(!a)throw new f(m.logMessage(m.LEVEL_SEVERE,"Texture","constructor","missingGlContext"));this.currentGlContext=a;this.canvas2D=document.createElement("canvas");this.ctx2D=this.canvas2D.getContext("2d");this.clearColor=b.TRANSPARENT;this.gpuResourceCache=new k(WorldWind.configuration.gpuCacheSize,.8*WorldWind.configuration.gpuCacheSize);this.surfaceTileRenderer=new F;this.surfaceShapeTileBuilder=new v;this.surfaceShapeTileController=
    new d;this.screenCreditController=new x;this.textSupport=new G;this.currentProgram=this.currentFramebuffer=null;this.surfaceRenderables=[];this.orderedRenderingMode=!1;this.orderedRenderables=[];this.screeRenderables=[];this.orderedRenderablesCounter=0;this.previousRedrawTimestamp=this.timestamp=Date.now();this.redrawRequested=!1;this.navigatorState=this.currentLayer=this.layers=this.globeStateKey=this.globe=null;this.eyePosition=new u(0,0,0);this.screenProjection=p.fromIdentity();this.terrain=null;
    this.verticalExaggeration=1;this.fadeTime=500;this.surfaceOpacity=1;this.frameStatistics=null;this.regionPicking=this.deepPicking=this.pickTerrainOnly=this.pickingMode=!1;this.pickFrustum=this.pickFramebuffer=this.pickRectangle=this.pickPoint=null;this.pickColor=new b(0,0,0,1);this.objectsAtPickPoint=new t;this.pixelScale=1};C.unitCubeKey="DrawContextUnitCubeKey";C.unitCubeElementsKey="DrawContextUnitCubeElementsKey";C.unitQuadKey="DrawContextUnitQuadKey";C.unitQuadKey3="DrawContextUnitQuadKey3";
    C.prototype.reset=function(){this.screenCreditController.clear();this.surfaceRenderables=[];this.orderedRenderingMode=!1;this.orderedRenderables=[];this.screenRenderables=[];this.orderedRenderablesCounter=0;var a=this.timestamp;this.timestamp=Date.now();this.timestamp===a&&++this.timestamp;this.redrawRequested=!1;this.terrain=this.navigatorState=this.currentLayer=this.layers=this.globeStateKey=this.globe=null;this.verticalExaggeration=1;this.frameStatistics=null;this.accumulateOrderedRenderables=
        !0;this.regionPicking=this.deepPicking=this.pickTerrainOnly=this.pickingMode=!1;this.pickFrustum=this.pickRectangle=this.pickPoint=null;this.pickColor=new b(0,0,0,1);this.objectsAtPickPoint.clear()};C.prototype.update=function(){var a=this.currentGlContext,b=this.navigatorState.eyePoint;this.globeStateKey=this.globe.stateKey;this.globe.computePositionFromPoint(b[0],b[1],b[2],this.eyePosition);this.screenProjection.setToScreenProjection(a.drawingBufferWidth,a.drawingBufferHeight)};C.prototype.contextLost=
        function(){this.gpuResourceCache.clear();this.currentProgram=this.currentFramebuffer=this.pickFramebuffer=null};C.prototype.contextRestored=function(){this.gpuResourceCache.clear()};C.prototype.bindFramebuffer=function(a){this.currentFramebuffer!=a&&(this.currentGlContext.bindFramebuffer(this.currentGlContext.FRAMEBUFFER,a?a.framebufferId:null),this.currentFramebuffer=a)};C.prototype.bindProgram=function(a){this.currentProgram!=a&&(this.currentGlContext.useProgram(a?a.programId:null),this.currentProgram=
        a)};C.prototype.findAndBindProgram=function(a){if(!a)throw new f(m.logMessage(m.LEVEL_SEVERE,"DrawContext","findAndBindProgram","The specified program constructor is null or undefined."));var b=this.gpuResourceCache.resourceForKey(a.key);if(b)this.bindProgram(b);else try{b=new a(this.currentGlContext),this.bindProgram(b),this.gpuResourceCache.putResource(a.key,b,b.size)}catch(d){m.log(m.LEVEL_SEVERE,"Error attempting to create GPU program.")}return b};C.prototype.addSurfaceRenderable=function(a){a&&
    this.surfaceRenderables.push(a)};C.prototype.peekSurfaceRenderable=function(){return 0<this.surfaceRenderables.length?this.surfaceRenderables[this.surfaceRenderables.length-1]:null};C.prototype.popSurfaceRenderable=function(){return 0<this.surfaceRenderables.length?this.surfaceRenderables.pop():null};C.prototype.reverseSurfaceRenderables=function(){this.surfaceRenderables.reverse()};C.prototype.addOrderedRenderable=function(a,b){if(a){var d={orderedRenderable:a,insertionOrder:this.orderedRenderablesCounter++,
        eyeDistance:b||a.eyeDistance,globeStateKey:this.globeStateKey};this.globe.continuous&&(d.globeOffset=this.globe.offset);0===d.eyeDistance?this.screenRenderables.push(d):this.orderedRenderables.push(d)}};C.prototype.addOrderedRenderableToBack=function(a){a&&(a={orderedRenderable:a,insertionOrder:this.orderedRenderablesCounter++,eyeDistance:Number.MAX_VALUE,globeStateKey:this.globeStateKey},this.globe.continuous&&(a.globeOffset=this.globe.offset),this.orderedRenderables.push(a))};C.prototype.peekOrderedRenderable=
        function(){return 0<this.orderedRenderables.length?this.orderedRenderables[this.orderedRenderables.length-1].orderedRenderable:null};C.prototype.popOrderedRenderable=function(){if(0<this.orderedRenderables.length){var a=this.orderedRenderables.pop();this.globeStateKey=a.globeStateKey;this.globe.continuous&&(this.globe.offset=a.globeOffset);return a.orderedRenderable}return null};C.prototype.nextScreenRenderable=function(){if(0<this.screenRenderables.length){var a=this.screenRenderables.shift();this.globeStateKey=
        a.globeStateKey;this.globe.continuous&&(this.globe.offset=a.globeOffset);return a.orderedRenderable}return null};C.prototype.sortOrderedRenderables=function(){this.orderedRenderables.sort(function(a,b){var d=a.eyeDistance,c=b.eyeDistance;if(d<c)return-1;if(d>c)return 1;d=a.insertionOrder;c=b.insertionOrder;return d>c?-1:d<c?1:0})};C.prototype.readPickColor=function(a){a=this.navigatorState.convertPointToViewport(a,new D(0,0));var d=new Uint8Array(4);this.currentGlContext.readPixels(a[0],a[1],1,1,
        this.currentGlContext.RGBA,this.currentGlContext.UNSIGNED_BYTE,d);return this.clearColor.equalsBytes(d)?null:b.colorFromByteArray(d)};C.prototype.readPickColors=function(a){var d=this.currentGlContext,c=new Uint8Array(a.width*a.height*4),g={},e,h=new b(0,0,0,0);e=d.getParameter(d.PACK_ALIGNMENT);d.pixelStorei(d.PACK_ALIGNMENT,1);this.currentGlContext.readPixels(a.x,a.y,a.width,a.height,d.RGBA,d.UNSIGNED_BYTE,c);d.pixelStorei(d.PACK_ALIGNMENT,e);d=0;for(a=a.width*a.height;d<a;d++)e=4*d,e=b.colorFromBytes(c[e],
        c[e+1],c[e+2],c[e+3]),e.equals(this.clearColor)||e.equals(h)||(g[e.toByteString()]=e);return g};C.prototype.resolvePick=function(a){if(a.userObject instanceof B||!this.deepPicking||this.regionPicking)this.addPickedObject(a);else{var b=this.readPickColor(this.pickPoint);if(!b)return null;a.color.equals(b)&&this.addPickedObject(a)}};C.prototype.addPickedObject=function(a){a&&this.objectsAtPickPoint.add(a)};C.prototype.uniquePickColor=function(){var a=this.pickColor.nextColor().clone();return a.equals(this.clearColor)?
        a.nextColor():a};C.prototype.makePickFramebuffer=function(){var b=this.currentGlContext,d=b.drawingBufferWidth,c=b.drawingBufferHeight;this.pickFramebuffer&&this.pickFramebuffer.width==d&&this.pickFramebuffer.height==c||(this.pickFramebuffer=new a(b,d,c,!0));return this.pickFramebuffer};C.prototype.makePickFrustum=function(){if(!this.pickPoint&&!this.pickRectangle)return!1;var a,b,d,c,g,h,f,k,l,m,p,q,t,u;t=new y(0,0,0);l=new y(0,0,0);k=this.pickRectangle;b=this.navigatorState.viewport;k||(c=this.navigatorState.convertPointToViewport(this.pickPoint,
        new D(0,0)),k=new w(c[0]-2,c[1]-2,4,4));c=k.x;h=k.x+k.width;a=k.y;d=k.y+k.height;if(0>h||0>d||c>b.x+b.width||a>b.y+b.height)return!1;k.x=H.clamp(c,b.x,b.x+b.width);k.y=H.clamp(a,b.y,b.y+b.height);k.width=H.clamp(h,b.x,b.x+b.width)-k.x;k.height=H.clamp(d,b.y,b.y+b.height)-k.y;this.pickRectangle=k;l[0]=k.x;l[1]=k.y;l[2]=0;this.navigatorState.unProject(l,a=new y(0,0,0));l[0]=k.x;l[1]=k.y;l[2]=1;this.navigatorState.unProject(l,b=new y(0,0,0));l[0]=k.x+k.width;l[1]=k.y;l[2]=0;this.navigatorState.unProject(l,
        d=new y(0,0,0));l[0]=k.x+k.width;l[1]=k.y;l[2]=1;this.navigatorState.unProject(l,c=new y(0,0,0));l[0]=k.x;l[1]=k.y+k.height;l[2]=0;this.navigatorState.unProject(l,g=new y(0,0,0));l[0]=k.x;l[1]=k.y+k.height;l[2]=1;this.navigatorState.unProject(l,h=new y(0,0,0));l[0]=k.x+k.width;l[1]=k.y+k.height;l[2]=0;this.navigatorState.unProject(l,f=new y(0,0,0));l[0]=k.x+k.width;l[1]=k.y+k.height;l[2]=1;this.navigatorState.unProject(l,k=new y(0,0,0));u=new y(h[0]-a[0],h[1]-a[1],h[2]-a[2]);t.set(g[0]-b[0],g[1]-
        b[1],g[2]-b[2]);l=u.cross(t);l=new r(l[0],l[1],l[2],-l.dot(a));l.normalize();u=new y(f[0]-c[0],f[1]-c[1],f[2]-c[2]);t.set(k[0]-d[0],k[1]-d[1],k[2]-d[2]);m=u.cross(t);m=new r(m[0],m[1],m[2],-m.dot(d));m.normalize();u=new y(h[0]-f[0],h[1]-f[1],h[2]-f[2]);t.set(k[0]-g[0],k[1]-g[1],k[2]-g[2]);p=u.cross(t);p=new r(p[0],p[1],p[2],-p.dot(g));p.normalize();u=new y(c[0]-a[0],c[1]-a[1],c[2]-a[2]);t.set(b[0]-d[0],b[1]-d[1],b[2]-d[2]);q=u.cross(t);q=new r(q[0],q[1],q[2],-q.dot(d));q.normalize();u=new y(g[0]-
        d[0],g[1]-d[1],g[2]-d[2]);t.set(f[0]-a[0],f[1]-a[1],f[2]-a[2]);d=u.cross(t);a=new r(d[0],d[1],d[2],-d.dot(a));a.normalize();u=new y(k[0]-b[0],k[1]-b[1],k[2]-b[2]);t.set(h[0]-c[0],h[1]-c[1],h[2]-c[2]);t=u.cross(t);t=new r(t[0],t[1],t[2],-t.dot(b));t.normalize();this.pickFrustum=new e(l,m,q,p,a,t);return!0};C.prototype.isSmall=function(a,b){if(!a)return!1;var d=this.navigatorState.eyePoint.distanceTo(a.center),d=this.navigatorState.pixelSizeAtDistance(d);return 2*a.radius<b*d};C.prototype.unitCubeBuffer=
        function(){var a=this.gpuResourceCache.resourceForKey(C.unitCubeKey);if(!a){var b=this.currentGlContext,d=new Float32Array(24),a=0;d[a++]=0;d[a++]=1;d[a++]=0;d[a++]=0;d[a++]=0;d[a++]=0;d[a++]=1;d[a++]=1;d[a++]=0;d[a++]=1;d[a++]=0;d[a++]=0;d[a++]=0;d[a++]=1;d[a++]=1;d[a++]=0;d[a++]=0;d[a++]=1;d[a++]=1;d[a++]=1;d[a++]=1;d[a++]=1;d[a++]=0;d[a]=1;a=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a);b.bufferData(b.ARRAY_BUFFER,d,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,null);this.frameStatistics.incrementVboLoadCount(1);
            this.gpuResourceCache.putResource(C.unitCubeKey,a,4*d.length)}return a};C.prototype.unitCubeElements=function(){var a=this.gpuResourceCache.resourceForKey(C.unitCubeElementsKey);if(!a){var b=this.currentGlContext,d=new Int16Array(60),a=0;d[a++]=1;d[a++]=0;d[a++]=3;d[a++]=3;d[a++]=0;d[a++]=2;d[a++]=4;d[a++]=5;d[a++]=6;d[a++]=6;d[a++]=5;d[a++]=7;d[a++]=5;d[a++]=1;d[a++]=7;d[a++]=7;d[a++]=1;d[a++]=3;d[a++]=6;d[a++]=2;d[a++]=4;d[a++]=4;d[a++]=2;d[a++]=0;d[a++]=4;d[a++]=0;d[a++]=5;d[a++]=5;d[a++]=0;d[a++]=
        1;d[a++]=7;d[a++]=3;d[a++]=6;d[a++]=6;d[a++]=3;d[a++]=2;d[a++]=0;d[a++]=1;d[a++]=1;d[a++]=3;d[a++]=3;d[a++]=2;d[a++]=2;d[a++]=0;d[a++]=4;d[a++]=5;d[a++]=5;d[a++]=7;d[a++]=7;d[a++]=6;d[a++]=6;d[a++]=4;d[a++]=0;d[a++]=4;d[a++]=5;d[a++]=1;d[a++]=2;d[a++]=6;d[a++]=7;d[a]=3;a=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a);b.bufferData(b.ELEMENT_ARRAY_BUFFER,d,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,null);this.frameStatistics.incrementVboLoadCount(1);this.gpuResourceCache.putResource(C.unitCubeElementsKey,
        a,2*d.length)}return a};C.prototype.unitQuadBuffer=function(){var a=this.gpuResourceCache.resourceForKey(C.unitQuadKey);if(!a){var b=this.currentGlContext,d=new Float32Array(8);d[0]=0;d[1]=1;d[2]=0;d[3]=0;d[4]=1;d[5]=1;d[6]=1;d[7]=0;a=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a);b.bufferData(b.ARRAY_BUFFER,d,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,null);this.frameStatistics.incrementVboLoadCount(1);this.gpuResourceCache.putResource(C.unitQuadKey,a,4*d.length)}return a};C.prototype.unitQuadBuffer3=
        function(){var a=this.gpuResourceCache.resourceForKey(C.unitQuadKey3);if(!a){var b=this.currentGlContext,d=new Float32Array(12);d[0]=0;d[1]=1;d[2]=0;d[3]=0;d[4]=0;d[5]=0;d[6]=1;d[7]=1;d[8]=0;d[9]=1;d[10]=0;d[11]=0;a=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a);b.bufferData(b.ARRAY_BUFFER,d,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,null);this.frameStatistics.incrementVboLoadCount(1);this.gpuResourceCache.putResource(C.unitQuadKey3,a,4*d.length)}return a};C.prototype.surfacePointForMode=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               b,d,c,g){if(!g)throw new f(m.logMessage(m.LEVEL_SEVERE,"DrawContext","surfacePointForMode","missingResult"));this.terrain?this.terrain.surfacePointForMode(a,b,d,c,g):(d+=this.globe.elevationAtLocation(a,b)*this.verticalExaggeration,this.globe.computePointFromPosition(a,b,d,g));return g};return C});
define("src/globe/EarthElevationModel",["../geom/Location","../geom/Sector","../globe/ElevationModel","../util/WmsUrlBuilder"],function(f,b,c,a){var d=function(){c.call(this,b.FULL_SPHERE,new f(45,45),12,"application/bil16","EarthElevations256",256,256);this.displayName="Earth Elevation Model";this.minElevation=-11E3;this.maxElevation=8850;this.pixelIsPoint=!1;this.urlBuilder=new a("http://worldwind26.arc.nasa.gov/elev","GEBCO,aster_v2,USGS-NED","","1.3.0")};d.prototype=Object.create(c.prototype);
    return d});define("src/globe/EarthRestElevationModel",["../geom/Location","../geom/Sector","../globe/ElevationModel","../util/LevelRowColumnUrlBuilder"],function(f,b,c,a){var d=function(d,g,h){c.call(this,b.FULL_SPHERE,new f(60,60),5,"application/bil16","EarthElevations",512,512);this.displayName=h;this.minElevation=-11E3;this.maxElevation=8850;this.urlBuilder=new a(d,g)};d.prototype=Object.create(c.prototype);return d});
define("src/layer/FrameStatisticsLayer","../error/ArgumentError ../util/Color ../util/Font ../layer/Layer ../util/Logger ../util/Offset ../shapes/ScreenText ../shapes/TextAttributes".split(" "),function(f,b,c,a,d,e,g,h){var k=function(k){if(!k)throw new f(d.logMessage(d.LEVEL_SEVERE,"FrameStatisticsLayer","constructor","missingWorldWindow"));a.call(this,"Frame Statistics");this.pickEnabled=!1;var m=new h(null);m.color=b.GREEN;m.font=new c(12);m.offset=new e(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,
    1);this.frameTime=new g(new e(WorldWind.OFFSET_PIXELS,5,WorldWind.OFFSET_INSET_PIXELS,5)," ");this.frameTime.attributes=m;this.frameRate=new g(new e(WorldWind.OFFSET_PIXELS,5,WorldWind.OFFSET_INSET_PIXELS,25)," ");this.frameRate.attributes=m;var p=this;k.redrawCallbacks.push(function(a,b){p.handleRedraw(a,b)})};k.prototype=Object.create(a.prototype);k.prototype.doRender=function(a){this.frameRate.render(a);this.frameTime.render(a);this.inCurrentFrame=!0};k.prototype.handleRedraw=function(a,b){if(b==
    WorldWind.BEFORE_REDRAW){var d=a.frameStatistics;this.frameTime.text="Frame time  "+d.frameTimeAverage.toFixed(0)+" ms  ("+d.frameTimeMin.toFixed(0)+" - "+d.frameTimeMax.toFixed(0)+")";this.frameRate.text="Frame rate  "+d.frameRateAverage.toFixed(0)+" fps"}};return k});
define("src/shapes/AbstractShape","../error/ArgumentError ../util/Logger ../geom/Matrix ../cache/MemoryCache ../render/Renderable ../shapes/ShapeAttributes ../error/UnsupportedOperationError ../geom/Vec3".split(" "),function(f,b,c,a,d,e,g,h){var k=function(b){d.call(this);this._attributes=b?b:new e(null);this._highlightAttributes=null;this.highlighted=!1;this._altitudeMode=WorldWind.ABSOLUTE;this.referencePosition=null;this.shapeDataCache=new a(3,2);this.activeAttributes=this.currentData=null;this.expirationInterval=
    2E3;this.useSurfaceShapeFor2D=!1;this.scratchMatrix=c.fromIdentity()};k.prototype=Object.create(d.prototype);Object.defineProperties(k.prototype,{attributes:{get:function(){return this._attributes},set:function(a){this._attributes=a;this.surfaceShape&&(this.surfaceShape.attributes=this._attributes)}},highlightAttributes:{get:function(){return this._highlightAttributes},set:function(a){this._highlightAttributes=a;this.surfaceShape&&(this.surfaceShape.highlightAttributes=this._highlightAttributes)}},
    altitudeMode:{get:function(){return this._altitudeMode},set:function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"AbstractShape","altitudeMode","missingAltitudeMode"));this._altitudeMode=a;this.reset()}}});k.prototype.reset=function(){this.shapeDataCache.clear(!1);this.surfaceShape=null};k.prototype.updateSurfaceShape=function(){this.surfaceShape.displayName=this.displayName;this.surfaceShape.highlighted=this.highlighted;this.surfaceShape.enabled=this.enabled;this.surfaceShape.pathType=this.pathType;
    this.surfaceShape.pickDelegate=this.pickDelegate?this.pickDelegate:this};k.prototype.createSurfaceShape=function(){return null};k.prototype.render=function(a){if(this.enabled&&a.accumulateOrderedRenderables){if(a.globe.is2D()&&this.useSurfaceShapeFor2D&&(!this.surfaceShape&&(this.surfaceShape=this.createSurfaceShape())&&(this.surfaceShape.attributes=this._attributes,this.surfaceShape.highlightAttributes=this._highlightAttributes),this.surfaceShape)){this.updateSurfaceShape();this.surfaceShape.render(a);
    return}if(a.terrain||this.altitudeMode==WorldWind.ABSOLUTE)if(this.establishCurrentData(a),!a.globe.projectionLimits||this.isWithinProjectionLimits(a))if(!this.currentData.extent||this.intersectsFrustum(a))if(this.determineActiveAttributes(a),this.activeAttributes){var b=this.makeOrderedRenderable(a);b&&this.intersectsFrustum(a)&&!a.isSmall(this.currentData.extent,1)&&(b.layer=a.currentLayer,a.addOrderedRenderable(b,this.currentData.eyeDistance))}}};k.prototype.renderOrdered=function(a){this.currentData=
    this.shapeDataCache.entryForKey(a.globeStateKey);this.beginDrawing(a);try{this.doRenderOrdered(a)}finally{this.endDrawing(a)}};k.prototype.makeOrderedRenderable=function(a){var b=this.doMakeOrderedRenderable(a);this.currentData.verticalExaggeration=a.verticalExaggeration;return b};k.prototype.doMakeOrderedRenderable=function(a){throw new g(b.logMessage(b.LEVEL_SEVERE,"AbstractShape","makeOrderedRenderable","abstractInvocation"));};k.prototype.doRenderOrdered=function(a){throw new g(b.logMessage(b.LEVEL_SEVERE,
    "AbstractShape","doRenderOrdered","abstractInvocation"));};k.prototype.beginDrawing=function(a){};k.prototype.endDrawing=function(a){};k.prototype.intersectsFrustum=function(a){return this.currentData&&this.currentData.extent?a.pickingMode?this.currentData.extent.intersectsFrustum(a.pickFrustum):this.currentData.extent.intersectsFrustum(a.navigatorState.frustumInModelCoordinates):!0};k.prototype.establishCurrentData=function(a){this.currentData=this.shapeDataCache.entryForKey(a.globeStateKey);this.currentData||
(this.currentData=this.createShapeDataObject(),this.resetExpiration(this.currentData),this.shapeDataCache.putEntry(a.globeStateKey,this.currentData,1));this.currentData.isExpired=!this.isShapeDataCurrent(a,this.currentData)};k.prototype.createShapeDataObject=function(){return{transformationMatrix:c.fromIdentity(),referencePoint:new h(0,0,0)}};k.prototype.resetExpiration=function(a){a.expiryTime=Date.now()+this.expirationInterval+1E3*Math.random()};k.prototype.isShapeDataCurrent=function(a,b){return b.verticalExaggeration===
    a.verticalExaggeration&&b.expiryTime>Date.now()};k.prototype.determineActiveAttributes=function(a){this.activeAttributes=this.highlighted&&this._highlightAttributes?this.highlightAttributes:this._attributes};k.prototype.isWithinProjectionLimits=function(a){return!0};k.prototype.applyMvpMatrix=function(a){this.scratchMatrix.copy(a.navigatorState.modelviewProjection);this.scratchMatrix.multiplyMatrix(this.currentData.transformationMatrix);a.currentProgram.loadModelviewProjection(a.currentGlContext,
    this.scratchMatrix)};k.prototype.applyMvpMatrixForOutline=function(a){this.scratchMatrix.copy(a.navigatorState.projection);this.scratchMatrix.offsetProjectionDepth(-.001);this.scratchMatrix.multiplyMatrix(a.navigatorState.modelview);this.scratchMatrix.multiplyMatrix(this.currentData.transformationMatrix);a.currentProgram.loadModelviewProjection(a.currentGlContext,this.scratchMatrix)};return k});
define("src/shapes/AbstractMesh","../shapes/AbstractShape ../error/ArgumentError ../shaders/BasicTextureProgram ../geom/BoundingBox ../util/Color ../util/ImageSource ../geom/Line ../geom/Location ../util/Logger ../geom/Matrix ../pick/PickedObject ../geom/Position ../shapes/ShapeAttributes ../geom/Vec2 ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t,r,u){b=function(a){f.call(this,a);this.pickTransparentImagePixels=!0;this._altitudeScale=1};b.prototype=Object.create(f.prototype);
    Object.defineProperties(b.prototype,{altitudeScale:{get:function(){return this._altitudeScale},set:function(a){this._altitudeScale=a;this.reset()}}});b.prototype.mustGenerateGeometry=function(a){return!this.currentData.meshPoints||this.currentData.drawInterior!==this.activeAttributes.drawInterior||this.activeAttributes.applyLighting&&!this.currentData.normals?!0:this.altitudeMode===WorldWind.ABSOLUTE?!1:this.currentData.isExpired};b.prototype.doMakeOrderedRenderable=function(b){if(!this.activeAttributes.drawInterior&&
        !this.activeAttributes.drawOutline)return null;if(!this.mustGenerateGeometry(b))return this;var d=this.currentData,c=d.referencePoint;b.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude*this._altitudeScale,this._altitudeMode,c);d.transformationMatrix.setToTranslation(c[0],c[1],c[2]);d.meshPoints=this.computeMeshPoints(b,d);d.refreshVertexBuffer=!0;this.activeAttributes.imageSource&&!this.texCoords&&(this.texCoords=this.computeTexCoords())&&
    (d.refreshTexCoordBuffer=!0);this.meshIndices||(this.meshIndices=this.computeMeshIndices(),d.refreshMeshIndices=!0);!this.meshOutlineIndices&&(this.meshOutlineIndices=this.computeOutlineIndices())&&(d.refreshOutlineIndices=!0);this.activeAttributes.applyLighting&&this.computeNormals(d);d.drawInterior=this.activeAttributes.drawInterior;this.resetExpiration(d);d.extent||(d.extent=new a);d.extent.setToPoints(d.meshPoints);d.extent.translate(d.referencePoint);return this};b.prototype.computeMeshPoints=
        function(a,b){throw new UnsupportedOperationError(k.logMessage(k.LEVEL_SEVERE,"AbstractMesh","computeMeshPoints","abstractInvocation"));};b.prototype.computeTexCoords=function(){return null};b.prototype.computeMeshIndices=function(a){throw new UnsupportedOperationError(k.logMessage(k.LEVEL_SEVERE,"AbstractMesh","computeMeshIndices","abstractInvocation"));};b.prototype.computeOutlineIndices=function(a){};b.prototype.computeNormals=function(a){for(var b=new Float32Array(a.meshPoints.length),d=this.meshIndices,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              c=a.meshPoints,g=[],e=[new r(0,0,0),new r(0,0,0),new r(0,0,0)],h,f=0;f<d.length;f+=3){for(var k=0;3>k;k++)h=d[f+k],e[k].set(c[3*h],c[3*h+1],c[3*h+2]);for(var l=r.computeTriangleNormal(e[0],e[1],e[2]),k=0;3>k;k++)h=d[f+k],g[h]||(g[h]=[]),g[h].push(l)}l=new r(0,0,0);for(f=0;f<g.length;f++)g[f]?(r.average(g[f],l),l.normalize(),b[3*f]=l[0],b[3*f+1]=l[1],b[3*f+2]=l[2]):(b[3*f]=0,b[3*f+1]=0,b[3*f+2]=0);a.normals=b;a.refreshNormalsBuffer=!0};b.prototype.doRenderOrdered=function(a){var b=a.currentGlContext,
        d=a.currentProgram,c=this.currentData,g=this.texCoords&&!!this.activeAttributes.imageSource,e,h,f;a.pickingMode&&(f=a.uniquePickColor());c.pointsVboCacheKey||(c.pointsVboCacheKey=a.gpuResourceCache.generateCacheKey());e=a.gpuResourceCache.resourceForKey(c.pointsVboCacheKey);e||(e=b.createBuffer(),a.gpuResourceCache.putResource(c.pointsVboCacheKey,e,4*c.meshPoints.length),c.refreshVertexBuffer=!0);b.bindBuffer(b.ARRAY_BUFFER,e);c.refreshVertexBuffer&&(b.bufferData(b.ARRAY_BUFFER,c.meshPoints,b.STATIC_DRAW),
        a.frameStatistics.incrementVboLoadCount(1),c.refreshVertexBuffer=!1);b.vertexAttribPointer(d.vertexPointLocation,3,b.FLOAT,!1,0,0);d.loadTextureEnabled(b,!1);if(this.activeAttributes.drawInterior){var k=!a.pickingMode&&c.normals&&this.activeAttributes.applyLighting;this.applyMvpMatrix(a);c.meshIndicesVboCacheKey||(c.meshIndicesVboCacheKey=a.gpuResourceCache.generateCacheKey());e=a.gpuResourceCache.resourceForKey(c.meshIndicesVboCacheKey);e||(e=b.createBuffer(),a.gpuResourceCache.putResource(c.meshIndicesVboCacheKey,
        e,2*this.meshIndices.length),c.refreshMeshIndices=!0);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e);c.refreshMeshIndices&&(b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.meshIndices,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),c.refreshMeshIndices=!1);h=this.activeAttributes.interiorColor;e=h.alpha*a.currentLayer.opacity;b.depthMask(1<=e||a.pickingMode);d.loadColor(b,a.pickingMode?f:h);d.loadOpacity(b,a.pickingMode?0<e?1:0:e);g&&(!a.pickingMode||!this.pickTransparentImagePixels)&&(this.activeTexture=
        a.gpuResourceCache.resourceForKey(this.activeAttributes.imageSource),this.activeTexture||(this.activeTexture=a.gpuResourceCache.retrieveTexture(a.currentGlContext,this.activeAttributes.imageSource)),e=this.activeTexture&&this.activeTexture.bind(a))&&(c.texCoordsVboCacheKey||(c.texCoordsVboCacheKey=a.gpuResourceCache.generateCacheKey()),e=a.gpuResourceCache.resourceForKey(c.texCoordsVboCacheKey),e||(e=b.createBuffer(),a.gpuResourceCache.putResource(c.texCoordsVboCacheKey,e,4*this.texCoords.length),
        c.refreshTexCoordBuffer=!0),b.bindBuffer(b.ARRAY_BUFFER,e),c.refreshTexCoordBuffer&&(b.bufferData(b.ARRAY_BUFFER,this.texCoords,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),c.refreshTexCoordBuffer=!1),d.loadTextureEnabled(b,!0),b.enableVertexAttribArray(d.vertexTexCoordLocation),b.vertexAttribPointer(d.vertexTexCoordLocation,2,b.FLOAT,!1,0,0),d.loadTextureUnit(b,b.TEXTURE0),d.loadModulateColor(b,a.pickingMode));k&&(d.loadApplyLighting(b,!0),c.normalsVboCacheKey||(c.normalsVboCacheKey=
        a.gpuResourceCache.generateCacheKey()),e=a.gpuResourceCache.resourceForKey(c.normalsVboCacheKey),e||(e=b.createBuffer(),a.gpuResourceCache.putResource(c.normalsVboCacheKey,e,4*c.normals.length),c.refreshNormalsBuffer=!0),b.bindBuffer(b.ARRAY_BUFFER,e),c.refreshNormalsBuffer&&(b.bufferData(b.ARRAY_BUFFER,c.normals,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),c.refreshNormalsBuffer=!1),b.enableVertexAttribArray(d.normalVectorLocation),b.vertexAttribPointer(d.normalVectorLocation,3,b.FLOAT,
        !1,0,0));b.drawElements(b.TRIANGLES,this.meshIndices.length,b.UNSIGNED_SHORT,0);g&&b.disableVertexAttribArray(d.vertexTexCoordLocation);k&&(d.loadApplyLighting(b,!1),b.disableVertexAttribArray(d.normalVectorLocation))}this.activeAttributes.drawOutline&&this.meshOutlineIndices&&(d.loadTextureEnabled(b,!1),b.disableVertexAttribArray(d.vertexTexCoordLocation),this.applyMvpMatrixForOutline(a),h=this.activeAttributes.outlineColor,e=h.alpha*a.currentLayer.opacity,b.depthMask(1<=e||a.pickingMode),d.loadColor(b,
        a.pickingMode?f:h),d.loadOpacity(b,a.pickingMode?1:e),b.lineWidth(this.activeAttributes.outlineWidth),c.outlineIndicesVboCacheKey||(c.outlineIndicesVboCacheKey=a.gpuResourceCache.generateCacheKey()),e=a.gpuResourceCache.resourceForKey(c.outlineIndicesVboCacheKey),e||(e=b.createBuffer(),a.gpuResourceCache.putResource(c.outlineIndicesVboCacheKey,e,2*this.meshOutlineIndices.length),c.refreshOutlineIndices=!0),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e),c.refreshOutlineIndices&&(b.bufferData(b.ELEMENT_ARRAY_BUFFER,
        this.meshOutlineIndices,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),c.refreshOutlineIndices=!1),b.drawElements(b.LINE_STRIP,this.meshOutlineIndices.length,b.UNSIGNED_SHORT,0));a.pickingMode&&(b=this.computePickPosition(a),f=new m(f,this.pickDelegate?this.pickDelegate:this,b,a.currentLayer,!1),a.resolvePick(f))};b.prototype.computePickPosition=function(a){var b=this.currentData,d=a.navigatorState.rayFromScreenPoint(a.pickPoint),c=(new r(d.origin[0],d.origin[1],d.origin[2])).subtract(b.referencePoint),
        c=new g(c,d.direction),d=[];if(u.computeIndexedTrianglesIntersection(c,b.meshPoints,this.meshIndices,d)){c=d[0];if(1<d.length)for(var e=c.distanceToSquared(a.navigatorState.eyePoint),h=1;h<d.length;h++){var f=d[h].distanceToSquared(a.navigatorState.eyePoint);f<e&&(e=f,c=d[h])}d=new p(0,0,0);a.globe.computePositionFromPoint(c[0]+b.referencePoint[0],c[1]+b.referencePoint[1],c[2]+b.referencePoint[2],d);d.altitude/=this._altitudeScale;return d}return null};b.prototype.beginDrawing=function(a){var b=a.currentGlContext;
        this.activeAttributes.drawInterior&&(b.disable(b.CULL_FACE),a.findAndBindProgram(c),!a.pickMode&&this.currentData.normals&&this.activeAttributes.applyLighting&&a.currentProgram.loadModelviewInverse(b,a.navigatorState.modelviewNormalTransform));b.enableVertexAttribArray(a.currentProgram.vertexPointLocation)};b.prototype.endDrawing=function(a){var b=a.currentGlContext;b.disableVertexAttribArray(a.currentProgram.vertexPointLocation);b.depthMask(!0);b.lineWidth(1);b.enable(b.CULL_FACE)};return b});
define("src/shapes/SurfacePolygon",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(f,b,c,a){var d=function(d,c){if(!d)throw new f(b.logMessage(b.LEVEL_SEVERE,"SurfacePolygon","constructor","The specified boundary array is null or undefined."));a.call(this,c);var h=null;if(0<d.length&&d[0].latitude)h=d.slice(0),h.push(d[0]),this._boundariesSpecifiedSimply=!0;else if(1<d.length)for(var k=null,h=[],l=0;l<d.length;l++){for(var m=d[l][0],p=0;p<
d[l].length;p++)h.push(d[l][p]);h.push(m);k?h.push(k):k=h[h.length-1]}else 1===d.length&&(h=d[0].slice(0),h.push(d[0][0]));this._boundaries=h};d.prototype=Object.create(a.prototype);d.staticStateKey=function(b){return a.staticStateKey(b)};d.prototype.computeStateKey=function(){return d.staticStateKey(this)};return d});
define("src/shapes/GeographicMesh","../shapes/AbstractMesh ../error/ArgumentError ../shaders/BasicTextureProgram ../geom/BoundingBox ../util/Color ../util/ImageSource ../geom/Location ../util/Logger ../geom/Matrix ../pick/PickedObject ../geom/Position ../shapes/ShapeAttributes ../shapes/SurfacePolygon ../geom/Vec2 ../geom/Vec3".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t,r){c=function(a,d){if(!a)throw new b(h.logMessage(h.LEVEL_SEVERE,"GeographicMesh","constructor","missingPositions"));if(2>a.length||
    2>a[0].length)throw new b(h.logMessage(h.LEVEL_SEVERE,"GeographicMesh","constructor","Number of positions is insufficient."));if(65536<a.length*a[0].length)throw new b(h.logMessage(h.LEVEL_SEVERE,"GeographicMesh","constructor","Too many positions. Must be fewer than 65536. Try using multiple meshes."));for(var c=a[0].length,g=1;g<a.length;g++)if(a[g].length!==c)throw new b(h.logMessage(h.LEVEL_SEVERE,"GeographicMesh","constructor","Array lengths are inconsistent."));c=a.length;g=a[0].length;f.call(this,
    d);this.pickTransparentImagePixels=!0;this._positions=a;this._altitudeScale=1;this.numRows=c;this.numColumns=g;this._textureCoordinates=null;this.referencePosition=this.determineReferencePosition(this._positions)};c.prototype=Object.create(f.prototype);Object.defineProperties(c.prototype,{positions:{get:function(){return this._positions},set:function(a){if(!a)throw new b(h.logMessage(h.LEVEL_SEVERE,"GeographicMesh","positions","missingPositions"));if(2>a.length||2>a[0].length)throw new b(h.logMessage(h.LEVEL_SEVERE,
    "GeographicMesh","positions","Number of positions is insufficient."));for(var d=a[0].length,c=1;c<a.length;c++)if(a[c].length!==d)throw new b(h.logMessage(h.LEVEL_SEVERE,"GeographicMesh","positions","Array lengths are inconsistent."));this.numRows=a.length;this.numColumns=a[0].length;this._positions=a;this.referencePosition=this.determineReferencePosition(this._positions);this.reset();this.outlineIndices=this.meshIndices=null}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(a){if(a&&
    a.length!=this.numRows)throw new b(h.logMessage(h.LEVEL_SEVERE,"GeographicMesh","textureCoordinates","Number of texture coordinate rows is inconsistent with the currently specified positions."));for(var d=0;d<this.numRows;d++)if(a[d].length!==this.numColumns)throw new b(h.logMessage(h.LEVEL_SEVERE,"GeographicMesh","textureCoordinates","Texture coordinate row lengths are inconsistent with the currently specified positions."));this._textureCoordinates=a;this.reset();this.texCoords=null}}});c.makeGridIndices=
    function(a,b){for(var d=[],c=0,g=0;g<a-1;g++)for(var e=0;e<b-1;e++){var h=g*b+e;d[c++]=h;d[c++]=h+1;d[c++]=h+b;d[c++]=h+1;d[c++]=h+1+b;d[c++]=h+b}return d};c.prototype.determineReferencePosition=function(a){return a[0][0]};c.prototype.createSurfaceShape=function(){for(var a=[],b=0;b<this.numColumns;b++)a.push(this._positions[0][b]);for(b=1;b<this.numRows;b++)a.push(this._positions[b][this.numColumns-1]);for(b=this.numColumns-2;0<=b;b--)a.push(this._positions[this.numRows-1][b]);for(b=this.numRows-
    2;0<b;b--)a.push(this._positions[b][0]);return new q(a,null)};c.prototype.computeMeshPoints=function(a,b){for(var d=Number.MAX_VALUE,c=a.navigatorState.eyePoint,g=new Float32Array(this.numRows*this.numColumns*3),e=new r(0,0,0),h=0,f,k=0;k<this._positions.length;k++)for(var l=0,m=this._positions[k].length;l<m;l++)f=this._positions[k][l],a.surfacePointForMode(f.latitude,f.longitude,f.altitude*this._altitudeScale,this.altitudeMode,e),f=e.distanceToSquared(c),f<d&&(d=f),e.subtract(this.currentData.referencePoint),
    g[h++]=e[0],g[h++]=e[1],g[h++]=e[2];b.eyeDistance=Math.sqrt(d);return g};c.prototype.computeTexCoords=function(){return this._textureCoordinates?this.computeExplicitTexCoords():this.computeImplicitTexCoords()};c.prototype.computeExplicitTexCoords=function(){for(var a=new Float32Array(2*this.numRows*this.numColumns),b=0,d=0;d<this._textureCoordinates.length;d++)for(var c=0,g=this._textureCoordinates[d].length;c<g;c++){var e=this._textureCoordinates[d][c];a[b++]=e[0];a[b++]=e[1]}return a};c.prototype.computeImplicitTexCoords=
    function(){for(var a=new Float32Array(2*this.numRows*this.numColumns),b=1/(this.numRows-1),d=1/(this.numColumns-1),c=0,g=0;g<this._positions.length;g++)for(var e=g===this.numRows-1?1:g*b,h=0,f=this._positions[g].length;h<f;h++)a[c++]=h===this.numColumns-1?1:h*d,a[c++]=e;return a};c.prototype.computeMeshIndices=function(){for(var a=new Uint16Array((this.numRows-1)*(this.numColumns-1)*6),b=0,d=0;d<this.numRows-1;d++)for(var c=0;c<this.numColumns-1;c++){var g=d*this.numColumns+c;a[b++]=g;a[b++]=g+1;
    a[b++]=g+this.numColumns;a[b++]=g+1;a[b++]=g+1+this.numColumns;a[b++]=g+this.numColumns}return a};c.prototype.computeOutlineIndices=function(){for(var a=new Uint16Array(2*this.numRows+2*this.numColumns),b=0,d=0;d<this.numColumns;d++)a[b++]=d;for(d=1;d<this.numRows;d++)a[b++]=(d+1)*this.numColumns-1;for(d=this.numRows*this.numColumns-2;d>=(this.numRows-1)*this.numColumns;d--)a[b++]=d;for(d=this.numRows-2;0<=d;d--)a[b++]=d*this.numColumns;return a};return c});
define("src/shapes/GeographicText",["../error/ArgumentError","../util/Logger","../shapes/Text","../geom/Vec3"],function(f,b,c,a){var d=function(a,d){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"Text","constructor","missingPosition"));c.call(this,d);this.position=a;this.declutterGroup=1};d.placePoint=new a(0,0,0);d.prototype=Object.create(c.prototype);d.prototype.clone=function(){var a=new d(this.position,this.text);a.copy(this);a.pickDelegate=this.pickDelegate?this.pickDelegate:this;return a};d.prototype.render=
    function(a){a.globe.projectionLimits&&!a.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude)||c.prototype.render.call(this,a)};d.prototype.computeScreenPointAndEyeDistance=function(a){a.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,d.placePoint);if(!a.navigatorState.frustumInModelCoordinates.containsPoint(d.placePoint))return!1;this.eyeDistance=this.alwaysOnTop?0:a.navigatorState.eyePoint.distanceTo(d.placePoint);
    return a.navigatorState.projectWithDepth(d.placePoint,this.depthOffset,this.screenPoint)?!0:!1};return d});
define("src/formats/geojson/GeoJSONConstants",[],function(){var f=function(){};f.FIELD_TYPE="type";f.FIELD_CRS="crs";f.FIELD_NAME="name";f.FIELD_BBOX="bbox";f.FIELD_COORDINATES="coordinates";f.FIELD_GEOMETRIES="geometries";f.FIELD_GEOMETRY="geometry";f.FIELD_PROPERTIES="properties";f.FIELD_FEATURES="features";f.FIELD_ID="id";f.TYPE_POINT="Point";f.TYPE_MULTI_POINT="MultiPoint";f.TYPE_LINE_STRING="LineString";f.TYPE_MULTI_LINE_STRING="MultiLineString";f.TYPE_POLYGON="Polygon";f.TYPE_MULTI_POLYGON=
    "MultiPolygon";f.TYPE_GEOMETRY_COLLECTION="GeometryCollection";f.TYPE_FEATURE="Feature";f.TYPE_FEATURE_COLLECTION="FeatureCollection";f.FIELD_CRS_NAME="name";f.FIELD_CRS_LINK="link";f.WGS84_CRS="urn:ogc:def:crs:OGC:1.3:CRS84";f.EPSG4326_CRS="EPSG:4326";return f});
!function(f){if("object"==typeof exports)module.exports=f();else if("function"==typeof define&&define.amd)define("src/util/proj4-src",f);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self);b.proj4=f()}}(function(){return function b(c,a,d){function e(h,l){if(!a[h]){if(!c[h]){var m="function"==typeof require&&require;if(!l&&m)return m(h,!0);if(g)return g(h,!0);throw Error("Cannot find module '"+h+"'");}m=a[h]={exports:{}};c[h][0].call(m.exports,
    function(a){var b=c[h][1][a];return e(b?b:a)},m,m.exports,b,c,a,d)}return a[h].exports}for(var g="function"==typeof require&&require,h=0;h<d.length;h++)e(d[h]);return e}({1:[function(b,c,a){function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);Array.isArray(a)?(this.x=a[0],this.y=a[1],this.z=a[2]||0):"object"===typeof a?(this.x=a.x,this.y=a.y,this.z=a.z||0):"string"===typeof a&&"undefined"===typeof b?(a=a.split(","),this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],
        10)||0):(this.x=a,this.y=b,this.z=c||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var e=b("mgrs");d.fromMGRS=function(a){return new d(e.toPoint(a))};d.prototype.toMGRS=function(a){return e.forward([this.x,this.y],a)};c.exports=d},{mgrs:66}],2:[function(b,c,a){function d(a,b){if(!(this instanceof d))return new d(a);b=b||function(a){if(a)throw a;};var c=e(a);if("object"!==typeof c)b(a);else{var c=h(c),p=d.projections.get(c.projName);p?(g(this,c),g(this,p),this.init(),
    b(null,this)):b(a)}}var e=b("./parseCode"),g=b("./extend");a=b("./projections");var h=b("./deriveConstants");d.projections=a;d.projections.start();c.exports=d},{"./deriveConstants":32,"./extend":33,"./parseCode":36,"./projections":38}],3:[function(b,c,a){c.exports=function(a,b,c){var h=c.x,k=c.y,l=c.z||0,m,p,q;for(q=0;3>q;q++)if(!b||2!==q||void 0!==c.z)switch(0===q?(m=h,p="x"):1===q?(m=k,p="y"):(m=l,p="z"),a.axis[q]){case "e":c[p]=m;break;case "w":c[p]=-m;break;case "n":c[p]=m;break;case "s":c[p]=
    -m;break;case "u":void 0!==c[p]&&(c.z=m);break;case "d":void 0!==c[p]&&(c.z=-m);break;default:return null}return c}},{}],4:[function(b,c,a){var d=Math.PI/2,e=b("./sign");c.exports=function(a){return Math.abs(a)<d?a:a-e(a)*Math.PI}},{"./sign":21}],5:[function(b,c,a){var d=2*Math.PI,e=b("./sign");c.exports=function(a){return 3.14159265359>=Math.abs(a)?a:a-e(a)*d}},{"./sign":21}],6:[function(b,c,a){c.exports=function(a){1<Math.abs(a)&&(a=1<a?1:-1);return Math.asin(a)}},{}],7:[function(b,c,a){c.exports=
    function(a){return 1-.25*a*(1+a/16*(3+1.25*a))}},{}],8:[function(b,c,a){c.exports=function(a){return.375*a*(1+.25*a*(1+.46875*a))}},{}],9:[function(b,c,a){c.exports=function(a){return.05859375*a*a*(1+.75*a)}},{}],10:[function(b,c,a){c.exports=function(a){return 35/3072*a*a*a}},{}],11:[function(b,c,a){c.exports=function(a,b,c){b*=c;return a/Math.sqrt(1-b*b)}},{}],12:[function(b,c,a){c.exports=function(a,b,c,h,k){var l,m;l=a/b;for(var p=0;15>p;p++)if(m=(a-(b*l-c*Math.sin(2*l)+h*Math.sin(4*l)-k*Math.sin(6*
            l)))/(b-2*c*Math.cos(2*l)+4*h*Math.cos(4*l)-6*k*Math.cos(6*l)),l+=m,1E-10>=Math.abs(m))return l;return NaN}},{}],13:[function(b,c,a){var d=Math.PI/2;c.exports=function(a,b){if(1E-6>Math.abs(Math.abs(b)-(1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a)))))return 0>b?-1*d:d;for(var c=Math.asin(.5*b),k,l,m,p=0;30>p;p++)if(k=Math.sin(c),l=Math.cos(c),m=a*k,k=Math.pow(1-m*m,2)/(2*l)*(b/(1-a*a)-k/(1-m*m)+.5/a*Math.log((1-m)/(1+m))),c+=k,1E-10>=Math.abs(k))return c;return NaN}},{}],14:[function(b,c,a){c.exports=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       b,c,h,k){return a*k-b*Math.sin(2*k)+c*Math.sin(4*k)-h*Math.sin(6*k)}},{}],15:[function(b,c,a){c.exports=function(a,b,c){a*=b;return c/Math.sqrt(1-a*a)}},{}],16:[function(b,c,a){var d=Math.PI/2;c.exports=function(a,b){for(var c=.5*a,k,l=d-2*Math.atan(b),m=0;15>=m;m++)if(k=a*Math.sin(l),k=d-2*Math.atan(b*Math.pow((1-k)/(1+k),c))-l,l+=k,1E-10>=Math.abs(k))return l;return-9999}},{}],17:[function(b,c,a){c.exports=function(a){var b=[];b[0]=1-a*(.25+a*(.046875+a*(.01953125+.01068115234375*a)));b[1]=a*(.75-
    a*(.046875+a*(.01953125+.01068115234375*a)));var c=a*a;b[2]=c*(.46875-a*(.013020833333333334+.007120768229166667*a));c*=a;b[3]=c*(.3645833333333333-.005696614583333333*a);b[4]=c*a*.3076171875;return b}},{}],18:[function(b,c,a){var d=b("./pj_mlfn");c.exports=function(a,b,c){for(var k=1/(1-b),l=a,m=20;m;--m){var p=Math.sin(l),q=1-b*p*p,q=(d(l,p,Math.cos(l),c)-a)*q*Math.sqrt(q)*k,l=l-q;if(1E-10>Math.abs(q))break}return l}},{"./pj_mlfn":19}],19:[function(b,c,a){c.exports=function(a,b,c,h){c*=b;b*=b;return h[0]*
    a-c*(h[1]+b*(h[2]+b*(h[3]+b*h[4])))}},{}],20:[function(b,c,a){c.exports=function(a,b){var c;return 1E-7<a?(c=a*b,(1-a*a)*(b/(1-c*c)-.5/a*Math.log((1-c)/(1+c)))):2*b}},{}],21:[function(b,c,a){c.exports=function(a){return 0>a?-1:1}},{}],22:[function(b,c,a){c.exports=function(a,b){return Math.pow((1-a)/(1+a),b)}},{}],23:[function(b,c,a){c.exports=function(a){var b={x:a[0],y:a[1]};2<a.length&&(b.z=a[2]);3<a.length&&(b.m=a[3]);return b}},{}],24:[function(b,c,a){var d=Math.PI/2;c.exports=function(a,b,c){c*=
    a;c=Math.pow((1-c)/(1+c),.5*a);return Math.tan(.5*(d-b))/c}},{}],25:[function(b,c,a){a.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};a.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};a.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};a.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};a.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};
    a.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};a.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};a.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"};a.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};a.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};a.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",
        ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};a.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};a.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};a.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};a.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};a.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",
        datumName:"Reseau National Belge 1972"}},{}],26:[function(b,c,a){a.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};a.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};a.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};a.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};a.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"};a.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};a.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};
    a.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"};a.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};a.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};a.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};a.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"};a.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};a.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"};a.clrk80=
    {a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."};a.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"};a.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};a.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};a.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"};a.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"};a.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"};a.evrst56={a:6377301.243,rf:300.8017,
        ellipseName:"Everest 1956"};a.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"};a.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};a.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};a.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};a.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};a.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};a.hough={a:6378270,rf:297,ellipseName:"Hough"};a.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};
    a.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};a.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};a.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};a.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"};a.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};a.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};a.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"};a.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"};a.WGS60=
    {a:6378165,rf:298.3,ellipseName:"WGS 60"};a.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};a.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};a.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};a.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(b,c,a){a.greenwich=0;a.lisbon=-9.131906111111;a.paris=2.337229166667;a.bogota=-74.080916666667;a.madrid=-3.687938888889;a.rome=12.452333333333;a.bern=7.439583333333;a.jakarta=106.807719444444;a.ferro=-17.666666666667;
    a.brussels=4.367975;a.stockholm=18.058277777778;a.athens=23.7163375;a.oslo=10.722916666667},{}],28:[function(b,c,a){function d(a,b,d){return Array.isArray(d)?(a=h(a,b,d),3===d.length?[a.x,a.y,a.z]:[a.x,a.y]):h(a,b,d)}function e(a){return a instanceof g?a:a.oProj?a.oProj:g(a)}var g=b("./Proj"),h=b("./transform"),k=g("WGS84");c.exports=function(a,b,c){a=e(a);var g=!1;if("undefined"===typeof b)b=a,a=k,g=!0;else if("undefined"!==typeof b.x||Array.isArray(b))c=b,b=a,a=k,g=!0;b=e(b);if(c)return d(a,b,c);
    c={forward:function(c){return d(a,b,c)},inverse:function(c){return d(b,a,c)}};g&&(c.oProj=b);return c}},{"./Proj":2,"./transform":64}],29:[function(b,c,a){var d=Math.PI/2,e=function(a){if(!(this instanceof e))return new e(a);this.datum_type=4;if(a){a.datumCode&&"none"===a.datumCode&&(this.datum_type=5);if(a.datum_params){for(var b=0;b<a.datum_params.length;b++)a.datum_params[b]=parseFloat(a.datum_params[b]);if(0!==a.datum_params[0]||0!==a.datum_params[1]||0!==a.datum_params[2])this.datum_type=1;3<
a.datum_params.length&&(0!==a.datum_params[3]||0!==a.datum_params[4]||0!==a.datum_params[5]||0!==a.datum_params[6])&&(this.datum_type=2,a.datum_params[3]*=4.84813681109536E-6,a.datum_params[4]*=4.84813681109536E-6,a.datum_params[5]*=4.84813681109536E-6,a.datum_params[6]=a.datum_params[6]/1E6+1)}this.datum_type=a.grids?3:this.datum_type;this.a=a.a;this.b=a.b;this.es=a.es;this.ep2=a.ep2;this.datum_params=a.datum_params;3===this.datum_type&&(this.grids=a.grids)}};e.prototype={compare_datums:function(a){return this.datum_type!==
a.datum_type?!1:this.a!==a.a||5E-11<Math.abs(this.es-a.es)?!1:1===this.datum_type?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]:2===this.datum_type?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]&&this.datum_params[3]===a.datum_params[3]&&this.datum_params[4]===a.datum_params[4]&&this.datum_params[5]===a.datum_params[5]&&this.datum_params[6]===
a.datum_params[6]:3===this.datum_type||3===a.datum_type?this.nadgrids===a.nadgrids:!0},geodetic_to_geocentric:function(a){var b=a.x,c=a.y,e=a.z?a.z:0,m,p,q;if(c<-d&&c>-1.001*d)c=-d;else if(c>d&&c<1.001*d)c=d;else if(c<-d||c>d)return null;b>Math.PI&&(b-=2*Math.PI);p=Math.sin(c);q=Math.cos(c);m=this.a/Math.sqrt(1-this.es*p*p);c=(m+e)*q*Math.cos(b);b=(m+e)*q*Math.sin(b);e=(m*(1-this.es)+e)*p;a.x=c;a.y=b;a.z=e;return 0},geocentric_to_geodetic:function(a){var b,d,c,e,p,q,t,r,u,w,x=a.x;c=a.y;var A=a.z?
    a.z:0;b=Math.sqrt(x*x+c*c);d=Math.sqrt(x*x+c*c+A*A);if(1E-12>b/this.a){if(x=0,1E-12>d/this.a)return}else x=Math.atan2(c,x);c=A/d;e=b/d;p=1/Math.sqrt(1-this.es*(2-this.es)*e*e);t=e*(1-this.es)*p;r=c*p;w=0;do w++,q=this.a/Math.sqrt(1-this.es*r*r),d=b*t+A*r-q*(1-this.es*r*r),q=this.es*q/(q+d),p=1/Math.sqrt(1-q*(2-q)*e*e),q=e*(1-q)*p,p*=c,u=p*t-q*r,t=q,r=p;while(1E-24<u*u&&30>w);b=Math.atan(p/Math.abs(q));a.x=x;a.y=b;a.z=d;return a},geocentric_to_geodetic_noniter:function(a){var b=a.x,c=a.y,e=a.z?a.z:
    0,m,p,q,t,r,b=parseFloat(b),c=parseFloat(c),e=parseFloat(e);r=!1;if(0!==b)m=Math.atan2(c,b);else if(0<c)m=d;else if(0>c)m=-d;else if(r=!0,m=0,0<e)p=d;else if(0>e)p=-d;else return;q=b*b+c*c;b=Math.sqrt(q);c=1.0026*e;q=Math.sqrt(c*c+q);c/=q;q=b/q;c=e+this.b*this.ep2*c*c*c;t=b-this.a*this.es*q*q*q;q=Math.sqrt(c*c+t*t);c/=q;q=t/q;t=this.a/Math.sqrt(1-this.es*c*c);e=.3826834323650898<=q?b/q-t:-.3826834323650898>=q?b/-q-t:e/c+t*(this.es-1);!1===r&&(p=Math.atan(c/q));a.x=m;a.y=p;a.z=e;return a},geocentric_to_wgs84:function(a){if(1===
    this.datum_type)a.x+=this.datum_params[0],a.y+=this.datum_params[1],a.z+=this.datum_params[2];else if(2===this.datum_type){var b=this.datum_params[3],d=this.datum_params[4],c=this.datum_params[5],e=this.datum_params[6],p=e*(c*a.x+a.y-b*a.z)+this.datum_params[1],b=e*(-d*a.x+b*a.y+a.z)+this.datum_params[2];a.x=e*(a.x-c*a.y+d*a.z)+this.datum_params[0];a.y=p;a.z=b}},geocentric_from_wgs84:function(a){if(1===this.datum_type)a.x-=this.datum_params[0],a.y-=this.datum_params[1],a.z-=this.datum_params[2];else if(2===
    this.datum_type){var b=this.datum_params[3],d=this.datum_params[4],c=this.datum_params[5],e=this.datum_params[6],p=(a.x-this.datum_params[0])/e,q=(a.y-this.datum_params[1])/e,e=(a.z-this.datum_params[2])/e;a.x=p+c*q-d*e;a.y=-c*p+q+b*e;a.z=d*p-b*q+e}}};c.exports=e},{}],30:[function(b,c,a){c.exports=function(a,b,c){function h(a){return 1===a||2===a}var k,l,m;if(a.compare_datums(b)||5===a.datum_type||5===b.datum_type)return c;var p=a.a,q=a.es,t=b.a,r=b.es;k=a.datum_type;if(3===k)if(0===this.apply_gridshift(a,
        0,c))a.a=6378137,a.es=.006694379990141316;else{if(!a.datum_params)return a.a=p,a.es=a.es,c;k=1;l=0;for(m=a.datum_params.length;l<m;l++)k*=a.datum_params[l];if(0===k)return a.a=p,a.es=a.es,c;k=3<a.datum_params.length?2:1}3===b.datum_type&&(b.a=6378137,b.es=.006694379990141316);if(a.es!==b.es||a.a!==b.a||h(k)||h(b.datum_type))a.geodetic_to_geocentric(c),h(a.datum_type)&&a.geocentric_to_wgs84(c),h(b.datum_type)&&b.geocentric_from_wgs84(c),b.geocentric_to_geodetic(c);3===b.datum_type&&this.apply_gridshift(b,
    1,c);a.a=p;a.es=q;b.a=t;b.es=r;return c}},{}],31:[function(b,c,a){function d(a){var b=this;if(2===arguments.length){var c=arguments[1];"string"===typeof c?"+"===c.charAt(0)?d[a]=e(arguments[1]):d[a]=g(arguments[1]):d[a]=c}else if(1===arguments.length){if(Array.isArray(a))return a.map(function(a){Array.isArray(a)?d.apply(b,a):d(a)});if("string"===typeof a){if(a in d)return d[a]}else"EPSG"in a?d["EPSG:"+a.EPSG]=a:"ESRI"in a?d["ESRI:"+a.ESRI]=a:"IAU2000"in a?d["IAU2000:"+a.IAU2000]=a:console.log(a)}}
    a=b("./global");var e=b("./projString"),g=b("./wkt");a(d);c.exports=d},{"./global":34,"./projString":37,"./wkt":65}],32:[function(b,c,a){var d=b("./constants/Datum"),e=b("./constants/Ellipsoid"),g=b("./extend"),h=b("./datum");c.exports=function(a){if(a.datumCode&&"none"!==a.datumCode){var b=d[a.datumCode];b&&(a.datum_params=b.towgs84?b.towgs84.split(","):null,a.ellps=b.ellipse,a.datumName=b.datumName?b.datumName:a.datumCode)}a.a||g(a,e[a.ellps]?e[a.ellps]:e.WGS84);a.rf&&!a.b&&(a.b=(1-1/a.rf)*a.a);
    if(0===a.rf||1E-10>Math.abs(a.a-a.b))a.sphere=!0,a.b=a.a;a.a2=a.a*a.a;a.b2=a.b*a.b;a.es=(a.a2-a.b2)/a.a2;a.e=Math.sqrt(a.es);a.R_A&&(a.a*=1-a.es*(.16666666666666666+a.es*(.04722222222222222+.022156084656084655*a.es)),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=0);a.ep2=(a.a2-a.b2)/a.b2;a.k0||(a.k0=1);a.axis||(a.axis="enu");a.datum||(a.datum=h(a));return a}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":29,"./extend":33}],33:[function(b,c,a){c.exports=function(a,b){a=a||{};var c,h;if(!b)return a;
    for(h in b)c=b[h],void 0!==c&&(a[h]=c);return a}},{}],34:[function(b,c,a){c.exports=function(a){a("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees");a("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees");a("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");a.WGS84=a["EPSG:4326"];
    a["EPSG:3785"]=a["EPSG:3857"];a.GOOGLE=a["EPSG:3857"];a["EPSG:900913"]=a["EPSG:3857"];a["EPSG:102113"]=a["EPSG:3857"]}},{}],35:[function(b,c,a){a=b("./core");a.defaultDatum="WGS84";a.Proj=b("./Proj");a.WGS84=new a.Proj("WGS84");a.Point=b("./Point");a.toPoint=b("./common/toPoint");a.defs=b("./defs");a.transform=b("./transform");a.mgrs=b("mgrs");a.version=b("../package.json").version;b("./includedProjections")(a);c.exports=a},{"../package.json":67,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":28,
    "./defs":31,"./includedProjections":"gWUPNW","./transform":64,mgrs:66}],36:[function(b,c,a){function d(a){return["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"].reduce(function(b,d){return b+1+a.indexOf(d)},0)}var e=b("./defs"),g=b("./wkt"),h=b("./projString");c.exports=function(a){if("string"===typeof a){if(a in e)return e[a];if(d(a))return g(a);if("+"===a[0])return h(a)}else return a}},{"./defs":31,"./projString":37,"./wkt":65}],37:[function(b,c,a){var d=b("./constants/PrimeMeridian");c.exports=function(a){var b=
{},c={};a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).forEach(function(a){a=a.split("=");a.push(!0);c[a[0].toLowerCase()]=a[1]});var k,l,m={proj:"projName",datum:"datumCode",rf:function(a){b.rf=parseFloat(a)},lat_0:function(a){b.lat0=.017453292519943295*a},lat_1:function(a){b.lat1=.017453292519943295*a},lat_2:function(a){b.lat2=.017453292519943295*a},lat_ts:function(a){b.lat_ts=.017453292519943295*a},lon_0:function(a){b.long0=.017453292519943295*a},lon_1:function(a){b.long1=
    .017453292519943295*a},lon_2:function(a){b.long2=.017453292519943295*a},alpha:function(a){b.alpha=.017453292519943295*parseFloat(a)},lonc:function(a){b.longc=.017453292519943295*a},x_0:function(a){b.x0=parseFloat(a)},y_0:function(a){b.y0=parseFloat(a)},k_0:function(a){b.k0=parseFloat(a)},k:function(a){b.k0=parseFloat(a)},a:function(a){b.a=parseFloat(a)},b:function(a){b.b=parseFloat(a)},r_a:function(){b.R_A=!0},zone:function(a){b.zone=parseInt(a,10)},south:function(){b.utmSouth=!0},towgs84:function(a){b.datum_params=
    a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){b.to_meter=parseFloat(a)},from_greenwich:function(a){b.from_greenwich=.017453292519943295*a},pm:function(a){b.from_greenwich=.017453292519943295*(d[a]?d[a]:parseFloat(a))},nadgrids:function(a){"@null"===a?b.datumCode="none":b.nadgrids=a},axis:function(a){3===a.length&&-1!=="ewnsud".indexOf(a.substr(0,1))&&-1!=="ewnsud".indexOf(a.substr(1,1))&&-1!=="ewnsud".indexOf(a.substr(2,1))&&(b.axis=a)}};for(k in c)a=c[k],k in m?(l=m[k],
    "function"===typeof l?l(a):b[l]=a):b[k]=a;"string"===typeof b.datumCode&&"WGS84"!==b.datumCode&&(b.datumCode=b.datumCode.toLowerCase());return b}},{"./constants/PrimeMeridian":27}],38:[function(b,c,a){function d(a,b){var d=h.length;if(!a.names)return console.log(b),!0;h[d]=a;a.names.forEach(function(a){g[a.toLowerCase()]=d});return this}var e=[b("./projections/merc"),b("./projections/longlat")],g={},h=[];a.add=d;a.get=function(a){if(!a)return!1;a=a.toLowerCase();if("undefined"!==typeof g[a]&&h[g[a]])return h[g[a]]};
    a.start=function(){e.forEach(d)}},{"./projections/longlat":50,"./projections/merc":51}],39:[function(b,c,a){var d=b("../common/msfnz"),e=b("../common/qsfnz"),g=b("../common/adjust_lon"),h=b("../common/asinz");a.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.con=this.t1=this.sin_po,this.ms1=d(this.e3,this.sin_po,this.cos_po),this.qs1=e(this.e3,
    this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=d(this.e3,this.sin_po,this.cos_po),this.qs2=e(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=e(this.e3,this.sin_po,this.cos_po),this.ns0=1E-10<Math.abs(this.lat1-this.lat2)?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-
        this.ns0*this.qs0)/this.ns0)};a.forward=function(a){var b=a.x,d=a.y;this.sin_phi=Math.sin(d);this.cos_phi=Math.cos(d);var d=e(this.e3,this.sin_phi,this.cos_phi),d=this.a*Math.sqrt(this.c-this.ns0*d)/this.ns0,b=this.ns0*g(b-this.long0),c=this.rh-d*Math.cos(b)+this.y0;a.x=d*Math.sin(b)+this.x0;a.y=c;return a};a.inverse=function(a){var b,d,c;a.x-=this.x0;a.y=this.rh-a.y+this.y0;0<=this.ns0?(b=Math.sqrt(a.x*a.x+a.y*a.y),d=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),d=-1);c=0;0!==b&&(c=Math.atan2(d*a.x,d*a.y));
    d=b*this.ns0/this.a;this.sphere?b=Math.asin((this.c-d*d)/(2*this.ns0)):(b=(this.c-d*d)/this.ns0,b=this.phi1z(this.e3,b));c=g(c/this.ns0+this.long0);a.x=c;a.y=b;return a};a.phi1z=function(a,b){var d,c,e,g,r=h(.5*b);if(1E-10>a)return r;for(var u=a*a,w=1;25>=w;w++)if(d=Math.sin(r),c=Math.cos(r),e=a*d,g=1-e*e,d=.5*g*g/c*(b/(1-u)-d/g+.5/a*Math.log((1-e)/(1+e))),r+=d,1E-7>=Math.abs(d))return r;return null};a.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,
    "../common/msfnz":15,"../common/qsfnz":20}],40:[function(b,c,a){var d=b("../common/adjust_lon"),e=Math.PI/2,g=b("../common/mlfn"),h=b("../common/e0fn"),k=b("../common/e1fn"),l=b("../common/e2fn"),m=b("../common/e3fn"),p=b("../common/gN"),q=b("../common/asinz"),t=b("../common/imlfn");a.init=function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)};a.forward=function(a){var b=a.y,c=Math.sin(a.y),q=Math.cos(a.y),t=d(a.x-this.long0),B,v,F,G,D;this.sphere?1E-10>=Math.abs(this.sin_p12-
    1)?(a.x=this.x0+this.a*(e-b)*Math.sin(t),a.y=this.y0-this.a*(e-b)*Math.cos(t)):1E-10>=Math.abs(this.sin_p12+1)?(a.x=this.x0+this.a*(e+b)*Math.sin(t),a.y=this.y0+this.a*(e+b)*Math.cos(t)):(b=this.sin_p12*c+this.cos_p12*q*Math.cos(t),b=Math.acos(b),b/=Math.sin(b),a.x=this.x0+this.a*b*q*Math.sin(t),a.y=this.y0+this.a*b*(this.cos_p12*c-this.sin_p12*q*Math.cos(t))):(B=h(this.es),v=k(this.es),F=l(this.es),G=m(this.es),1E-10>=Math.abs(this.sin_p12-1)?(q=this.a*g(B,v,F,G,e),b=this.a*g(B,v,F,G,b),a.x=this.x0+
    (q-b)*Math.sin(t),a.y=this.y0-(q-b)*Math.cos(t)):1E-10>=Math.abs(this.sin_p12+1)?(q=this.a*g(B,v,F,G,e),b=this.a*g(B,v,F,G,b),a.x=this.x0+(q+b)*Math.sin(t),a.y=this.y0+(q+b)*Math.cos(t)):(B=c/q,b=p(this.a,this.e,this.sin_p12),c=p(this.a,this.e,c),c=Math.atan((1-this.es)*B+this.es*b*this.sin_p12/(c*q)),q=Math.atan2(Math.sin(t),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(t)),B=0===q?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):1E-10>=Math.abs(Math.abs(q)-Math.PI)?-Math.asin(this.cos_p12*
    Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(t)*Math.cos(c)/Math.sin(q)),t=this.e*this.sin_p12/Math.sqrt(1-this.es),v=this.e*this.cos_p12*Math.cos(q)/Math.sqrt(1-this.es),c=t*v,v*=v,F=B*B,G=F*B,D=G*B,b=b*B*(1-F*v*(1-v)/6+G/8*c*(1-2*v)+D/120*(v*(4-7*v)-3*t*t*(1-7*v))-D*B/48*c),a.x=this.x0+b*Math.sin(q),a.y=this.y0+b*Math.cos(q)));return a};a.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b,c,x,A,B,v;if(this.sphere){if(b=Math.sqrt(a.x*a.x+a.y*a.y),!(b>2*e*this.a))return c=b/this.a,x=
    Math.sin(c),A=Math.cos(c),c=this.long0,1E-10>=Math.abs(b)?B=this.lat0:(B=q(A*this.sin_p12+a.y*x*this.cos_p12/b),c=Math.abs(this.lat0)-e,c=1E-10>=Math.abs(c)?0<=this.lat0?d(this.long0+Math.atan2(a.x,-a.y)):d(this.long0-Math.atan2(-a.x,a.y)):d(this.long0+Math.atan2(a.x*x,b*this.cos_p12*A-a.y*this.sin_p12*x))),a.x=c,a.y=B,a}else return x=h(this.es),c=k(this.es),A=l(this.es),B=m(this.es),1E-10>=Math.abs(this.sin_p12-1)?(v=this.a*g(x,c,A,B,e),b=Math.sqrt(a.x*a.x+a.y*a.y),B=t((v-b)/this.a,x,c,A,B),c=d(this.long0+
    Math.atan2(a.x,-1*a.y))):1E-10>=Math.abs(this.sin_p12+1)?(v=this.a*g(x,c,A,B,e),b=Math.sqrt(a.x*a.x+a.y*a.y),B=t((b-v)/this.a,x,c,A,B),c=d(this.long0+Math.atan2(a.x,a.y))):(b=Math.sqrt(a.x*a.x+a.y*a.y),x=Math.atan2(a.x,a.y),B=p(this.a,this.e,this.sin_p12),c=Math.cos(x),A=this.e*this.cos_p12*c,A=-A*A/(1-this.es),v=3*this.es*(1-A)*this.sin_p12*this.cos_p12*c/(1-this.es),B=b/B,b=B-A*(1+A)*Math.pow(B,3)/6-v*(1+3*A)*Math.pow(B,4)/24,A=1-A*b*b/2-B*b*b*b/6,B=Math.asin(this.sin_p12*Math.cos(b)+this.cos_p12*
    Math.sin(b)*c),c=d(this.long0+Math.asin(Math.sin(x)*Math.sin(b)/Math.cos(B))),B=Math.atan((1-this.es*A*this.sin_p12/Math.sin(B))*Math.tan(B)/(1-this.es))),a.x=c,a.y=B,a};a.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],41:[function(b,c,a){var d=b("../common/mlfn"),e=b("../common/e0fn"),g=b("../common/e1fn"),h=b("../common/e2fn"),
    k=b("../common/e3fn"),l=b("../common/gN"),m=b("../common/adjust_lon"),p=b("../common/adjust_lat"),q=b("../common/imlfn"),t=Math.PI/2;a.init=function(){this.sphere||(this.e0=e(this.es),this.e1=g(this.es),this.e2=h(this.es),this.e3=k(this.es),this.ml0=this.a*d(this.e0,this.e1,this.e2,this.e3,this.lat0))};a.forward=function(a){var b,c,e=a.x,g=a.y,e=m(e-this.long0);if(this.sphere)b=this.a*Math.asin(Math.cos(g)*Math.sin(e)),c=this.a*(Math.atan2(Math.tan(g),Math.cos(e))-this.lat0);else{c=Math.sin(g);var h=
    Math.cos(g),k=l(this.a,this.e,c),p=Math.tan(g)*Math.tan(g);b=e*Math.cos(g);var e=b*b,q=this.es*h*h/(1-this.es),g=this.a*d(this.e0,this.e1,this.e2,this.e3,g);b=k*b*(1-e*p*(1/6-(8-p+8*q)*e/120));c=g-this.ml0+k*c/h*e*(.5+(5-p+6*q)*e/24)}a.x=b+this.x0;a.y=c+this.y0;return a};a.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b=a.x/this.a,d=a.y/this.a,c;if(this.sphere)c=d+this.lat0,d=Math.asin(Math.sin(c)*Math.cos(b)),c=Math.atan2(Math.tan(b),Math.cos(c));else{c=q(this.ml0/this.a+d,this.e0,this.e1,this.e2,
    this.e3);if(1E-10>=Math.abs(Math.abs(c)-t))return a.x=this.long0,a.y=t,0>d&&(a.y*=-1),a;var d=l(this.a,this.e,Math.sin(c)),e=Math.pow(Math.tan(c),2),b=b*this.a/d,g=b*b,d=c-d*Math.tan(c)/(d*d*d/this.a/this.a*(1-this.es))*b*b*(.5-(1+3*e)*b*b/24);c=b*(1-g*(e/3+(1+3*e)*e*g/15))/Math.cos(c)}a.x=m(c+this.long0);a.y=p(d);return a};a.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,
    "../common/imlfn":12,"../common/mlfn":14}],42:[function(b,c,a){var d=b("../common/adjust_lon"),e=b("../common/qsfnz"),g=b("../common/msfnz"),h=b("../common/iqsfnz");a.init=function(){this.sphere||(this.k0=g(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))};a.forward=function(a){var b=a.y,c;c=d(a.x-this.long0);this.sphere?(c=this.x0+this.a*c*Math.cos(this.lat_ts),b=this.y0+this.a*Math.sin(b)/Math.cos(this.lat_ts)):(b=e(this.e,Math.sin(b)),c=this.x0+this.a*this.k0*c,b=this.y0+this.a*b*.5/this.k0);
    a.x=c;a.y=b;return a};a.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b,c;this.sphere?(b=d(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(c=h(this.e,2*a.y*this.k0/this.a),b=d(this.long0+a.x/(this.a*this.k0)));a.x=b;a.y=c;return a};a.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],43:[function(b,c,a){var d=b("../common/adjust_lon"),e=b("../common/adjust_lat");a.init=function(){this.x0=this.x0||
    0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)};a.forward=function(a){var b=a.y,c=d(a.x-this.long0),b=e(b-this.lat0);a.x=this.x0+this.a*c*this.rc;a.y=this.y0+this.a*b;return a};a.inverse=function(a){var b=a.y;a.x=d(this.long0+(a.x-this.x0)/(this.a*this.rc));a.y=e(this.lat0+(b-this.y0)/this.a);return a};a.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},
    {"../common/adjust_lat":4,"../common/adjust_lon":5}],44:[function(b,c,a){var d=b("../common/e0fn"),e=b("../common/e1fn"),g=b("../common/e2fn"),h=b("../common/e3fn"),k=b("../common/msfnz"),l=b("../common/mlfn"),m=b("../common/adjust_lon"),p=b("../common/adjust_lat"),q=b("../common/imlfn");a.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=d(this.es),this.e1=e(this.es),this.e2=
    g(this.es),this.e3=h(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=k(this.e,this.sinphi,this.cosphi),this.ml1=l(this.e0,this.e1,this.e2,this.e3,this.lat1),1E-10>Math.abs(this.lat1-this.lat2)?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=k(this.e,this.sinphi,this.cosphi),this.ml2=l(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=l(this.e0,
    this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))};a.forward=function(a){var b=a.x,d=a.y;this.sphere||(d=l(this.e0,this.e1,this.e2,this.e3,d));var d=this.a*(this.g-d),b=this.ns*m(b-this.long0),c=this.y0+this.rh-d*Math.cos(b);a.x=this.x0+d*Math.sin(b);a.y=c;return a};a.inverse=function(a){a.x-=this.x0;a.y=this.rh-a.y+this.y0;var b,d,c;0<=this.ns?(d=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(d=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);c=0;0!==d&&(c=Math.atan2(b*a.x,b*a.y));this.sphere?(c=m(this.long0+
    c/this.ns),d=p(this.g-d/this.a)):(d=q(this.g-d/this.a,this.e0,this.e1,this.e2,this.e3),c=m(this.long0+c/this.ns));a.x=c;a.y=d;return a};a.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],45:[function(b,c,a){var d=Math.PI/4,e=b("../common/srat"),g=Math.PI/2;a.init=function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0),
    b=b*b;this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a);this.C=Math.sqrt(1+this.es*b*b/(1-this.es));this.phic0=Math.asin(a/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+d)/(Math.pow(Math.tan(.5*this.lat0+d),this.C)*e(this.e*a,this.ratexp))};a.forward=function(a){var b=a.x,c=a.y;a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*c+d),this.C)*e(this.e*Math.sin(c),this.ratexp))-g;a.x=this.C*b;return a};a.inverse=function(a){for(var b=a.x/this.C,c=a.y,m=Math.pow(Math.tan(.5*c+d)/this.K,1/this.C),
                                                                                                                                                                                                                                                                                                                                                                                                                                                              p=20;0<p;--p){c=2*Math.atan(m*e(this.e*Math.sin(a.y),-.5*this.e))-g;if(1E-14>Math.abs(c-a.y))break;a.y=c}if(!p)return null;a.x=b;a.y=c;return a};a.names=["gauss"]},{"../common/srat":22}],46:[function(b,c,a){var d=b("../common/adjust_lon"),e=b("../common/asinz");a.init=function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1};a.forward=function(a){var b,c,e,m,p;c=a.y;e=d(a.x-this.long0);b=Math.sin(c);c=Math.cos(c);m=Math.cos(e);p=this.sin_p14*
    b+this.cos_p14*c*m;0<p||1E-10>=Math.abs(p)?(e=this.x0+1*this.a*c*Math.sin(e)/p,b=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*c*m)/p):(e=this.x0+this.infinity_dist*c*Math.sin(e),b=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*c*m));a.x=e;a.y=b;return a};a.inverse=function(a){var b,c,l,m;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(b=Math.sqrt(a.x*a.x+a.y*a.y))?(m=Math.atan2(b,this.rc),c=Math.sin(m),l=Math.cos(m),m=e(l*this.sin_p14+a.y*c*this.cos_p14/b),b=
    Math.atan2(a.x*c,b*this.cos_p14*l-a.y*this.sin_p14*c),b=d(this.long0+b)):(m=this.phic0,b=0);a.x=b;a.y=m;return a};a.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],47:[function(b,c,a){var d=b("../common/adjust_lon");a.init=function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=.863937979737193);this.long0||(this.long0=.4334234309119251);this.k0||(this.k0=.9999);this.s45=.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=
    this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);
    this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq};a.forward=function(a){var b,c,k;b=a.y;k=d(a.x-this.long0);b=2*(Math.atan(this.k*Math.pow(Math.tan(b/2+this.s45),this.alfa)/Math.pow((1+this.e*Math.sin(b))/(1-this.e*Math.sin(b)),this.alfa*this.e/2))-this.s45);c=-k*this.alfa;k=Math.asin(Math.cos(this.ad)*Math.sin(b)+Math.sin(this.ad)*Math.cos(b)*Math.cos(c));b=this.n*Math.asin(Math.cos(b)*Math.sin(c)/Math.cos(k));k=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(k/
        2+this.s45),this.n);a.y=k*Math.cos(b)/1;a.x=k*Math.sin(b)/1;this.czech||(a.y*=-1,a.x*=-1);return a};a.inverse=function(a){var b,d,c;b=a.x;a.x=a.y;a.y=b;this.czech||(a.y*=-1,a.x*=-1);b=Math.sqrt(a.x*a.x+a.y*a.y);c=Math.atan2(a.y,a.x)/Math.sin(this.s0);d=2*(Math.atan(Math.pow(this.ro0/b,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);b=Math.asin(Math.cos(this.ad)*Math.sin(d)-Math.sin(this.ad)*Math.cos(d)*Math.cos(c));a.x=this.long0-Math.asin(Math.cos(d)*Math.sin(c)/Math.cos(b))/this.alfa;c=b;var l=
    d=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.e/2))-this.s45),1E-10>Math.abs(c-a.y)&&(d=1),c=a.y,l+=1;while(0===d&&15>l);return 15<=l?null:a};a.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],48:[function(b,c,a){var d=Math.PI/2,e=Math.PI/4,g=b("../common/qsfnz"),h=b("../common/adjust_lon");a.S_POLE=1;a.N_POLE=2;a.EQUIT=3;a.OBLIQ=4;a.init=function(){var a=Math.abs(this.lat0);this.mode=
    1E-10>Math.abs(a-d)?0>this.lat0?this.S_POLE:this.N_POLE:1E-10>Math.abs(a)?this.EQUIT:this.OBLIQ;if(0<this.es)switch(this.qp=g(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),a=Math.sin(this.lat0),this.sinb1=g(this.e,a)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*
    this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*a*a)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))};a.forward=function(a){var b,c,p,q,t,r,u,w;q=a.x;var x=a.y;q=h(q-this.long0);if(this.sphere)if(t=Math.sin(x),r=Math.cos(x),p=Math.cos(q),this.mode===this.OBLIQ||this.mode===this.EQUIT){c=this.mode===this.EQUIT?1+r*p:1+this.sinph0*t+this.cosph0*r*p;if(1E-10>=c)return null;
    c=Math.sqrt(2/c);b=c*r*Math.sin(q);c*=this.mode===this.EQUIT?t:this.cosph0*t-this.sinph0*r*p}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&(p=-p);if(1E-10>Math.abs(x+this.phi0))return null;c=e-.5*x;c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c));b=c*Math.sin(q);c*=p}}else{w=u=r=0;p=Math.cos(q);q=Math.sin(q);t=Math.sin(x);t=g(this.e,t);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)r=t/this.qp,u=Math.sqrt(1-r*r);switch(this.mode){case this.OBLIQ:w=1+this.sinb1*
    r+this.cosb1*u*p;break;case this.EQUIT:w=1+u*p;break;case this.N_POLE:w=d+x;t=this.qp-t;break;case this.S_POLE:w=x-d,t=this.qp+t}if(1E-10>Math.abs(w))return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:w=Math.sqrt(2/w);c=this.mode===this.OBLIQ?this.ymf*w*(this.cosb1*r-this.sinb1*u*p):(w=Math.sqrt(2/(1+u*p)))*r*this.ymf;b=this.xmf*w*u*q;break;case this.N_POLE:case this.S_POLE:0<=t?(b=(w=Math.sqrt(t))*q,c=p*(this.mode===this.S_POLE?w:-w)):b=c=0}}a.x=this.a*b+this.x0;a.y=this.a*c+this.y0;return a};
    a.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b=a.x/this.a,c=a.y/this.a,e,g,t,r;if(this.sphere){r=g=0;t=Math.sqrt(b*b+c*c);e=.5*t;if(1<e)return null;e=2*Math.asin(e);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)r=Math.sin(e),g=Math.cos(e);switch(this.mode){case this.EQUIT:e=1E-10>=Math.abs(t)?0:Math.asin(c*r/t);b*=r;c=g*t;break;case this.OBLIQ:e=1E-10>=Math.abs(t)?this.phi0:Math.asin(g*this.sinph0+c*r*this.cosph0/t);b*=r*this.cosph0;c=(g-Math.sin(e)*this.sinph0)*t;break;case this.N_POLE:c=
        -c;e=d-e;break;case this.S_POLE:e-=d}b=0!==c||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(b,c):0}else{e=0;if(this.mode===this.OBLIQ||this.mode===this.EQUIT){b/=this.dd;c*=this.dd;r=Math.sqrt(b*b+c*c);if(1E-10>r)return a.x=0,a.y=this.phi0,a;t=2*Math.asin(.5*r/this.rq);g=Math.cos(t);b*=t=Math.sin(t);this.mode===this.OBLIQ?(e=g*this.sinb1+c*t*this.cosb1/r,c=r*this.cosb1*g-c*this.sinb1*t):(e=c*t/r,c=r*g)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&
    (c=-c);e=b*b+c*c;if(!e)return a.x=0,a.y=this.phi0,a;e=1-e/this.qp;this.mode===this.S_POLE&&(e=-e)}b=Math.atan2(b,c);e=this.authlat(Math.asin(e),this.apa)}a.x=h(this.long0+b);a.y=e;return a};a.P00=.3333333333333333;a.P01=.17222222222222222;a.P02=.10257936507936508;a.P10=.06388888888888888;a.P11=.0664021164021164;a.P20=.016415012942191543;a.authset=function(a){var b,d=[];d[0]=a*this.P00;b=a*a;d[0]+=b*this.P01;d[1]=b*this.P10;b*=a;d[0]+=b*this.P02;d[1]+=b*this.P11;d[2]=b*this.P20;return d};a.authlat=
        function(a,b){var d=a+a;return a+b[0]*Math.sin(d)+b[1]*Math.sin(d+d)+b[2]*Math.sin(d+d+d)};a.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],49:[function(b,c,a){var d=b("../common/msfnz"),e=b("../common/tsfnz"),g=Math.PI/2,h=b("../common/sign"),k=b("../common/adjust_lon"),l=b("../common/phi2z");a.init=function(){this.lat2||(this.lat2=this.lat1);this.k0||(this.k0=1);this.x0=this.x0||0;this.y0=this.y0||0;if(!(1E-10>Math.abs(this.lat1+
        this.lat2))){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var a=Math.sin(this.lat1),b=d(this.e,a,Math.cos(this.lat1)),c=e(this.e,this.lat1,a),g=Math.sin(this.lat2),h=d(this.e,g,Math.cos(this.lat2)),g=e(this.e,this.lat2,g),k=e(this.e,this.lat0,Math.sin(this.lat0));this.ns=1E-10<Math.abs(this.lat1-this.lat2)?Math.log(b/h)/Math.log(c/g):a;isNaN(this.ns)&&(this.ns=a);this.f0=b/(this.ns*Math.pow(c,this.ns));this.rh=this.a*this.f0*Math.pow(k,this.ns);this.title||(this.title="Lambert Conformal Conic")}};
    a.forward=function(a){var b=a.x,d=a.y;1E-10>=Math.abs(2*Math.abs(d)-Math.PI)&&(d=h(d)*(g-2E-10));var c=Math.abs(Math.abs(d)-g);if(1E-10<c)d=e(this.e,d,Math.sin(d)),d=this.a*this.f0*Math.pow(d,this.ns);else{c=d*this.ns;if(0>=c)return null;d=0}b=this.ns*k(b-this.long0);a.x=this.k0*d*Math.sin(b)+this.x0;a.y=this.k0*(this.rh-d*Math.cos(b))+this.y0;return a};a.inverse=function(a){var b,d,c,e=(a.x-this.x0)/this.k0,h=this.rh-(a.y-this.y0)/this.k0;0<this.ns?(b=Math.sqrt(e*e+h*h),d=1):(b=-Math.sqrt(e*e+h*
        h),d=-1);c=0;0!==b&&(c=Math.atan2(d*e,d*h));if(0!==b||0<this.ns){if(d=1/this.ns,b=Math.pow(b/(this.a*this.f0),d),b=l(this.e,b),-9999===b)return null}else b=-g;c=k(c/this.ns+this.long0);a.x=c;a.y=b;return a};a.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],50:[function(b,c,a){function d(a){return a}a.init=function(){};
    a.forward=d;a.inverse=d;a.names=["longlat","identity"]},{}],51:[function(b,c,a){var d=b("../common/msfnz"),e=Math.PI/2,g=b("../common/adjust_lon"),h=Math.PI/4,k=b("../common/tsfnz"),l=b("../common/phi2z");a.init=function(){var a=this.b/this.a;this.es=1-a*a;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):d(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)};a.forward=function(a){var b=
    a.x,d=a.y;if(90<57.29577951308232*d&&-90>57.29577951308232*d&&180<57.29577951308232*b&&-180>57.29577951308232*b||1E-10>=Math.abs(Math.abs(d)-e))return null;this.sphere?(b=this.x0+this.a*this.k0*g(b-this.long0),d=this.y0+this.a*this.k0*Math.log(Math.tan(h+.5*d))):(d=k(this.e,d,Math.sin(d)),b=this.x0+this.a*this.k0*g(b-this.long0),d=this.y0-this.a*this.k0*Math.log(d));a.x=b;a.y=d;return a};a.inverse=function(a){var b=a.x-this.x0,d=a.y-this.y0;if(this.sphere)d=e-2*Math.atan(Math.exp(-d/(this.a*this.k0)));
else if(d=l(this.e,Math.exp(-d/(this.a*this.k0))),-9999===d)return null;b=g(this.long0+b/(this.a*this.k0));a.x=b;a.y=d;return a};a.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],52:[function(b,c,a){var d=b("../common/adjust_lon");a.init=function(){};a.forward=function(a){var b=a.y,c=d(a.x-this.long0),b=this.y0+this.a*Math.log(Math.tan(Math.PI/4+
        b/2.5))*1.25;a.x=this.x0+this.a*c;a.y=b;return a};a.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b=d(this.long0+a.x/this.a),c=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);a.x=b;a.y=c;return a};a.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],53:[function(b,c,a){var d=b("../common/adjust_lon");a.init=function(){};a.forward=function(a){for(var b=a.y,c=d(a.x-this.long0),k=b,l=Math.PI*Math.sin(b),m=0;;m++){var p=-(k+Math.sin(k)-l)/(1+Math.cos(k)),k=k+p;if(1E-10>Math.abs(p))break}k/=
    2;1E-10>Math.PI/2-Math.abs(b)&&(c=0);b=1.4142135623731*this.a*Math.sin(k)+this.y0;a.x=.900316316158*this.a*c*Math.cos(k)+this.x0;a.y=b;return a};a.inverse=function(a){var b;a.x-=this.x0;a.y-=this.y0;b=a.y/(1.4142135623731*this.a);.999999999999<Math.abs(b)&&(b=.999999999999);b=Math.asin(b);var c=d(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));c<-Math.PI&&(c=-Math.PI);c>Math.PI&&(c=Math.PI);b=(2*b+Math.sin(2*b))/Math.PI;1<Math.abs(b)&&(b=1);b=Math.asin(b);a.x=c;a.y=b;return a};a.names=["Mollweide",
    "moll"]},{"../common/adjust_lon":5}],54:[function(b,c,a){a.iterations=1;a.init=function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;
    this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=
        -.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013};a.forward=function(a){var b,c=a.x-this.long0,h=(a.y-this.lat0)/4.84813681109536E-6*1E-5,k=1,l=0;for(b=1;10>=b;b++)k*=h,l+=this.A[b]*k;var h=l,k=1,m=0,p=0,q=0;for(b=1;6>=b;b++)l=k*h-m*c,m=m*h+k*c,k=l,p=p+this.B_re[b]*k-this.B_im[b]*m,q=q+this.B_im[b]*k+this.B_re[b]*m;a.x=q*this.a+this.x0;a.y=p*this.a+this.y0;return a};a.inverse=function(a){var b,c=(a.y-this.y0)/this.a,h=(a.x-this.x0)/this.a,k=1,l=0,m,p=0,q=0;for(b=1;6>=
b;b++)m=k*c-l*h,l=l*c+k*h,k=m,p=p+this.C_re[b]*k-this.C_im[b]*l,q=q+this.C_im[b]*k+this.C_re[b]*l;for(k=0;k<this.iterations;k++){var t=p,r=q,u;m=c;l=h;for(b=2;6>=b;b++)u=t*p-r*q,r=r*p+t*q,t=u,m+=(b-1)*(this.B_re[b]*t-this.B_im[b]*r),l+=(b-1)*(this.B_im[b]*t+this.B_re[b]*r);var t=1,r=0,w=this.B_re[1],x=this.B_im[1];for(b=2;6>=b;b++)u=t*p-r*q,r=r*p+t*q,t=u,w+=b*(this.B_re[b]*t-this.B_im[b]*r),x+=b*(this.B_im[b]*t+this.B_re[b]*r);q=w*w+x*x;p=(m*w+l*x)/q;q=(l*w-m*x)/q}c=p;h=1;p=0;for(b=1;9>=b;b++)h*=
    c,p+=this.D[b]*h;b=this.lat0+.484813681109536*p;a.x=this.long0+q;a.y=b;return a};a.names=["New_Zealand_Map_Grid","nzmg"]},{}],55:[function(b,c,a){var d=b("../common/tsfnz"),e=b("../common/adjust_lon"),g=b("../common/phi2z"),h=Math.PI/2,k=Math.PI/4;a.init=function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),c=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-
        this.es)/(1-c*c);a=d(this.e,this.lat0,a);b=this.bl/b*Math.sqrt((1-this.es)/(1-c*c));1>b*b&&(b=1);var g;if(isNaN(this.longc)){c=d(this.e,this.lat1,Math.sin(this.lat1));g=d(this.e,this.lat2,Math.sin(this.lat2));this.el=0<=this.lat0?(b+Math.sqrt(b*b-1))*Math.pow(a,this.bl):(b-Math.sqrt(b*b-1))*Math.pow(a,this.bl);var c=Math.pow(c,this.bl),h=Math.pow(g,this.bl);g=this.el/c;a=.5*(g-1/g);g=(this.el*this.el-h*c)/(this.el*this.el+h*c);c=(h-c)/(h+c);h=e(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-
    Math.atan(g*Math.tan(.5*this.bl*h)/c)/this.bl;this.long0=e(this.long0);c=e(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*c)/a);this.alpha=Math.asin(b*Math.sin(this.gamma0))}else g=0<=this.lat0?b+Math.sqrt(b*b-1):b-Math.sqrt(b*b-1),this.el=g*Math.pow(a,this.bl),this.gamma0=Math.asin(Math.sin(this.alpha)/b),this.long0=this.longc-Math.asin(.5*(g-1/g)*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:0<=this.lat0?this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha)):-1*
this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha))};a.forward=function(a){var b=a.y,c=e(a.x-this.long0);if(1E-10>=Math.abs(Math.abs(b)-h))c=0<b?-1:1,b=this.al/this.bl*Math.log(Math.tan(k+c*this.gamma0*.5)),c=-1*c*h*this.al/this.bl;else var b=d(this.e,b,Math.sin(b)),b=this.el/Math.pow(b,this.bl),g=.5*(b-1/b),t=Math.sin(this.bl*c),b=(g*Math.sin(this.gamma0)-t*Math.cos(this.gamma0))/(.5*(b+1/b)),b=1E-10>=Math.abs(Math.abs(b)-1)?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-b)/(1+b))/
this.bl,c=1E-10>=Math.abs(Math.cos(this.bl*c))?this.al*this.bl*c:this.al*Math.atan2(g*Math.cos(this.gamma0)+t*Math.sin(this.gamma0),Math.cos(this.bl*c))/this.bl;this.no_rot?(a.x=this.x0+c,a.y=this.y0+b):(c-=this.uc,a.x=this.x0+b*Math.cos(this.alpha)+c*Math.sin(this.alpha),a.y=this.y0+c*Math.cos(this.alpha)-b*Math.sin(this.alpha));return a};a.inverse=function(a){var b,d;this.no_rot?(d=a.y-this.y0,b=a.x-this.x0):(d=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*
    Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var c=Math.exp(-1*this.bl*d/this.al);d=.5*(c-1/c);var k=Math.sin(this.bl*b/this.al),c=(k*Math.cos(this.gamma0)+d*Math.sin(this.gamma0))/(.5*(c+1/c)),r=Math.pow(this.el/Math.sqrt((1+c)/(1-c)),1/this.bl);1E-10>Math.abs(c-1)?(a.x=this.long0,a.y=h):1E-10>Math.abs(c+1)?(a.x=this.long0,a.y=-1*h):(a.y=g(this.e,r),a.x=e(this.long0-Math.atan2(d*Math.cos(this.gamma0)-k*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl));return a};
    a.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],56:[function(b,c,a){var d=b("../common/e0fn"),e=b("../common/e1fn"),g=b("../common/e2fn"),h=b("../common/e3fn"),k=b("../common/adjust_lon"),l=b("../common/adjust_lat"),m=b("../common/mlfn"),p=b("../common/gN");a.init=function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,
        2);this.e=Math.sqrt(this.es);this.e0=d(this.es);this.e1=e(this.es);this.e2=g(this.es);this.e3=h(this.es);this.ml0=this.a*m(this.e0,this.e1,this.e2,this.e3,this.lat0)};a.forward=function(a){var b=a.y,d,c;d=k(a.x-this.long0);c=d*Math.sin(b);if(this.sphere)1E-10>=Math.abs(b)?(d*=this.a,b=-1*this.a*this.lat0):(d=this.a*Math.sin(c)/Math.tan(b),b=this.a*(l(b-this.lat0)+(1-Math.cos(c))/Math.tan(b)));else if(1E-10>=Math.abs(b))d*=this.a,b=-1*this.ml0;else{var e=p(this.a,this.e,Math.sin(b))/Math.tan(b);d=
    e*Math.sin(c);b=this.a*m(this.e0,this.e1,this.e2,this.e3,b)-this.ml0+e*(1-Math.cos(c))}a.x=d+this.x0;a.y=b+this.y0;return a};a.inverse=function(a){var b,d,c,e,g,h,l;b=a.x-this.x0;c=a.y-this.y0;if(this.sphere)if(1E-10>=Math.abs(c+this.a*this.lat0))b=k(b/this.a+this.long0),d=0;else{e=this.lat0+c/this.a;g=b*b/this.a/this.a+e*e;h=e;for(c=20;c;--c)if(l=Math.tan(h),l=-1*(e*(h*l+1)-h-.5*(h*h+g)*l)/((h-e)/l-1),h+=l,1E-10>=Math.abs(l)){d=h;break}b=k(this.long0+Math.asin(b*Math.tan(h)/this.a)/Math.sin(d))}else if(1E-10>=
    Math.abs(c+this.ml0))d=0,b=k(this.long0+b/this.a);else{e=(this.ml0+c)/this.a;g=b*b/this.a/this.a+e*e;h=e;var p,F;for(c=20;c;--c)if(l=this.e*Math.sin(h),l=Math.sqrt(1-l*l)*Math.tan(h),p=this.a*m(this.e0,this.e1,this.e2,this.e3,h),F=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),p/=this.a,l=(e*(l*p+1)-p-.5*l*(p*p+g))/(this.es*Math.sin(2*h)*(p*p+g-2*e*p)/(4*l)+(e-p)*(l*F-2/Math.sin(2*h))-F),h-=l,1E-10>=Math.abs(l)){d=h;break}l=Math.sqrt(1-this.es*Math.pow(Math.sin(d),
            2))*Math.tan(d);b=k(this.long0+Math.asin(b*l/this.a)/Math.sin(d))}a.x=b;a.y=d;return a};a.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],57:[function(b,c,a){var d=b("../common/adjust_lon"),e=b("../common/adjust_lat"),g=b("../common/pj_enfn"),h=b("../common/pj_mlfn"),k=b("../common/pj_inv_mlfn"),l=Math.PI/2,m=b("../common/asinz");a.init=function(){this.sphere?
    (this.n=1,this.es=this.m=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=g(this.es)};a.forward=function(a){var b,c;b=a.x;c=a.y;b=d(b-this.long0);if(this.sphere){if(this.m)for(var e=this.n*Math.sin(c),g=20;g;--g){var k=(this.m*c+Math.sin(c)-e)/(this.m+Math.cos(c));c-=k;if(1E-10>Math.abs(k))break}else c=1!==this.n?Math.asin(this.n*Math.sin(c)):c;b=this.a*this.C_x*b*(this.m+Math.cos(c));c*=this.a*this.C_y}else e=Math.sin(c),g=Math.cos(c),c=this.a*h(c,e,g,this.en),b=this.a*
    b*g/Math.sqrt(1-this.es*e*e);a.x=b;a.y=c;return a};a.inverse=function(a){var b,c,g;a.x-=this.x0;c=a.x/this.a;a.y-=this.y0;b=a.y/this.a;this.sphere?(b/=this.C_y,c/=this.C_x*(this.m+Math.cos(b)),this.m?b=m((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=m(Math.sin(b)/this.n)),c=d(c+this.long0),b=e(b)):(b=k(a.y/this.a,this.es,this.en),g=Math.abs(b),g<l?(g=Math.sin(b),c=this.long0+a.x*Math.sqrt(1-this.es*g*g)/(this.a*Math.cos(b)),c=d(c)):g-1E-10<l&&(c=this.long0));a.x=c;a.y=b;return a};a.names=["Sinusoidal",
    "sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],58:[function(b,c,a){a.init=function(){var a=this.lat0;this.lambda0=this.long0;var b=Math.sin(a),c=this.a,h=1/this.rf,h=2*h-Math.pow(h,2),k=this.e=Math.sqrt(h);this.R=this.k0*c*Math.sqrt(1-h)/(1-h*Math.pow(b,2));this.alpha=Math.sqrt(1+h/(1-h)*Math.pow(Math.cos(a),4));this.b0=Math.asin(b/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-
    this.alpha*Math.log(Math.tan(Math.PI/4+a/2))+this.alpha*k/2*Math.log((1+k*b)/(1-k*b))};a.forward=function(a){var b=2*(Math.atan(Math.exp(-this.alpha*(Math.log(Math.tan(Math.PI/4-a.y/2))+this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))))+this.K))-Math.PI/4),c=this.alpha*(a.x-this.lambda0),h=Math.atan(Math.sin(c)/(Math.sin(this.b0)*Math.tan(b)+Math.cos(this.b0)*Math.cos(c))),b=Math.asin(Math.cos(this.b0)*Math.sin(b)-Math.sin(this.b0)*Math.cos(b)*Math.cos(c));a.y=this.R/2*Math.log((1+
        Math.sin(b))/(1-Math.sin(b)))+this.y0;a.x=this.R*h+this.x0;return a};a.inverse=function(a){for(var b=(a.x-this.x0)/this.R,c=2*(Math.atan(Math.exp((a.y-this.y0)/this.R))-Math.PI/4),h=Math.asin(Math.cos(this.b0)*Math.sin(c)+Math.sin(this.b0)*Math.cos(c)*Math.cos(b)),b=this.lambda0+Math.atan(Math.sin(b)/(Math.cos(this.b0)*Math.cos(b)-Math.sin(this.b0)*Math.tan(c)))/this.alpha,k=h,l=-1E3,m=0;1E-7<Math.abs(k-l);){if(20<++m)return;c=1/this.alpha*(Math.log(Math.tan(Math.PI/4+h/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/
        4+Math.asin(this.e*Math.sin(k))/2));l=k;k=2*Math.atan(Math.exp(c))-Math.PI/2}a.x=b;a.y=k;return a};a.names=["somerc"]},{}],59:[function(b,c,a){var d=Math.PI/2,e=b("../common/sign"),g=b("../common/msfnz"),h=b("../common/tsfnz"),k=b("../common/phi2z"),l=b("../common/adjust_lon");a.ssfn_=function(a,b,c){b*=c;return Math.tan(.5*(d+a))*Math.pow((1-b)/(1+b),.5*c)};a.init=function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&
(this.k0=.5*(1+e(this.lat0)*Math.sin(this.lat_ts))):(1E-10>=Math.abs(this.coslat0)&&(this.con=0<this.lat0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&(this.k0=.5*this.cons*g(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/h(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=g(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-
    d,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))};a.forward=function(a){var b=a.x,c=a.y,e=Math.sin(c),g=Math.cos(c),k,w=l(b-this.long0);if(1E-10>=Math.abs(Math.abs(b-this.long0)-Math.PI)&&1E-10>=Math.abs(c+this.lat0))return a.x=NaN,a.y=NaN,a;if(this.sphere)b=2*this.k0/(1+this.sinlat0*e+this.coslat0*g*Math.cos(w)),a.x=this.a*b*g*Math.sin(w)+this.x0,a.y=this.a*b*(this.coslat0*e-this.sinlat0*g*Math.cos(w))+this.y0;else{k=2*Math.atan(this.ssfn_(c,e,this.e))-d;g=Math.cos(k);k=Math.sin(k);if(1E-10>=
    Math.abs(this.coslat0))return e=h(this.e,c*this.con,this.con*e),e=2*this.a*this.k0*e/this.cons,a.x=this.x0+e*Math.sin(b-this.long0),a.y=this.y0-this.con*e*Math.cos(b-this.long0),a;1E-10>Math.abs(this.sinlat0)?(b=2*this.a*this.k0/(1+g*Math.cos(w)),a.y=b*k):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*k+this.cosX0*g*Math.cos(w))),a.y=b*(this.cosX0*k-this.sinX0*g*Math.cos(w))+this.y0);a.x=b*g*Math.sin(w)+this.x0}return a};a.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b,c,e,g=Math.sqrt(a.x*
    a.x+a.y*a.y);if(this.sphere){e=2*Math.atan(g/(.5*this.a*this.k0));b=this.long0;c=this.lat0;if(1E-10>=g)return a.x=b,a.y=c,a;c=Math.asin(Math.cos(e)*this.sinlat0+a.y*Math.sin(e)*this.coslat0/g);b=1E-10>Math.abs(this.coslat0)?0<this.lat0?l(this.long0+Math.atan2(a.x,-1*a.y)):l(this.long0+Math.atan2(a.x,a.y)):l(this.long0+Math.atan2(a.x*Math.sin(e),g*this.coslat0*Math.cos(e)-a.y*this.sinlat0*Math.sin(e)));a.x=b;a.y=c;return a}if(1E-10>=Math.abs(this.coslat0)){if(1E-10>=g)return c=this.lat0,b=this.long0,
    a.x=b,a.y=c,a;a.x*=this.con;a.y*=this.con;b=g*this.cons/(2*this.a*this.k0);c=this.con*k(this.e,b);b=this.con*l(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else c=2*Math.atan(g*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,1E-10>=g?e=this.X0:(e=Math.asin(Math.cos(c)*this.sinX0+a.y*Math.sin(c)*this.cosX0/g),b=l(this.long0+Math.atan2(a.x*Math.sin(c),g*this.cosX0*Math.cos(c)-a.y*this.sinX0*Math.sin(c)))),c=-1*k(this.e,Math.tan(.5*(d+e)));a.x=b;a.y=c;return a};a.names=["stere"]},{"../common/adjust_lon":5,
    "../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],60:[function(b,c,a){var d=b("./gauss"),e=b("../common/adjust_lon");a.init=function(){d.init.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))};a.forward=function(a){var b,c,l,m;a.x=e(a.x-this.long0);d.forward.apply(this,[a]);b=Math.sin(a.y);c=Math.cos(a.y);l=Math.cos(a.x);m=this.k0*this.R2/(1+this.sinc0*
    b+this.cosc0*c*l);a.x=m*c*Math.sin(a.x);a.y=m*(this.cosc0*b-this.sinc0*c*l);a.x=this.a*a.x+this.x0;a.y=this.a*a.y+this.y0;return a};a.inverse=function(a){var b,c,l,m;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(m=Math.sqrt(a.x*a.x+a.y*a.y))?(l=2*Math.atan2(m,this.R2),b=Math.sin(l),c=Math.cos(l),l=Math.asin(c*this.sinc0+a.y*b*this.cosc0/m),b=Math.atan2(a.x*b,m*this.cosc0*c-a.y*this.sinc0*b)):(l=this.phic0,b=0);a.x=b;a.y=l;d.inverse.apply(this,[a]);a.x=e(a.x+this.long0);
    return a};a.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":45}],61:[function(b,c,a){var d=b("../common/e0fn"),e=b("../common/e1fn"),g=b("../common/e2fn"),h=b("../common/e3fn"),k=b("../common/mlfn"),l=b("../common/adjust_lon"),m=Math.PI/2,p=b("../common/sign"),q=b("../common/asinz");a.init=function(){this.e0=d(this.es);this.e1=e(this.es);this.e2=g(this.es);this.e3=h(this.es);this.ml0=
    this.a*k(this.e0,this.e1,this.e2,this.e3,this.lat0)};a.forward=function(a){var b=a.y,d=l(a.x-this.long0),c,e;c=Math.sin(b);var g=Math.cos(b);if(this.sphere){var h=g*Math.sin(d);if(1E-10>Math.abs(Math.abs(h)-1))return 93;e=.5*this.a*this.k0*Math.log((1+h)/(1-h));c=Math.acos(g*Math.cos(d)/Math.sqrt(1-h*h));0>b&&(c=-c);b=this.a*this.k0*(c-this.lat0)}else{e=g*d;var d=Math.pow(e,2),g=this.ep2*Math.pow(g,2),h=Math.tan(b),m=Math.pow(h,2);c=1-this.es*Math.pow(c,2);c=this.a/Math.sqrt(c);b=this.a*k(this.e0,
        this.e1,this.e2,this.e3,b);e=this.k0*c*e*(1+d/6*(1-m+g+d/20*(5-18*m+Math.pow(m,2)+72*g-58*this.ep2)))+this.x0;b=this.k0*(b-this.ml0+c*h*d*(.5+d/24*(5-m+9*g+4*Math.pow(g,2)+d/30*(61-58*m+Math.pow(m,2)+600*g-330*this.ep2))))+this.y0}a.x=e;a.y=b;return a};a.inverse=function(a){var b,d,c,e;if(this.sphere){b=Math.exp(a.x/(this.a*this.k0));d=.5*(b-1/b);var g=this.lat0+a.y/(this.a*this.k0);c=Math.cos(g);b=Math.sqrt((1-c*c)/(1+d*d));b=q(b);0>g&&(b=-b);d=0===d&&0===c?this.long0:l(Math.atan2(d,c)+this.long0)}else{var g=
    a.x-this.x0,h=a.y-this.y0;d=b=(this.ml0+h/this.k0)/this.a;for(e=0;;e++){c=(b+this.e1*Math.sin(2*d)-this.e2*Math.sin(4*d)+this.e3*Math.sin(6*d))/this.e0-d;d+=c;if(1E-10>=Math.abs(c))break;if(6<=e)return 95}if(Math.abs(d)<m){c=Math.cos(d);var k=Math.tan(d);e=this.ep2*Math.pow(c,2);var h=Math.pow(e,2),F=Math.pow(k,2),G=Math.pow(F,2);b=1-this.es*Math.pow(Math.sin(d),2);var D=this.a/Math.sqrt(b),g=g/(D*this.k0),y=Math.pow(g,2);b=d-D*k*y/(D*(1-this.es)/b)*(.5-y/24*(5+3*F+10*e-4*h-9*this.ep2-y/30*(61+90*
    F+298*e+45*G-252*this.ep2-3*h)));d=l(this.long0+g*(1-y/6*(1+2*F+e-y/20*(5-2*e+28*F-3*h+8*this.ep2+24*G)))/c)}else b=m*p(h),d=this.long0}a.x=d;a.y=b;return a};a.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],62:[function(b,c,a){var d=b("./tmerc");a.dependsOn="tmerc";a.init=function(){this.zone&&(this.lat0=0,this.long0=.017453292519943295*
    (6*Math.abs(this.zone)-183),this.x0=5E5,this.y0=this.utmSouth?1E7:0,this.k0=.9996,d.init.apply(this),this.forward=d.forward,this.inverse=d.inverse)};a.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":61}],63:[function(b,c,a){var d=b("../common/adjust_lon"),e=b("../common/asinz");a.init=function(){this.R=this.a};a.forward=function(a){var b=a.y,c=d(a.x-this.long0),l=e(2*Math.abs(b/Math.PI)),m=.5*Math.abs(Math.PI/c-c/Math.PI),p=m*m,q=Math.sin(l),l=Math.cos(l),l=l/(q+l-1),q=l*(2/q-1),
    t=q*q,r=Math.PI*this.R*(m*(l-t)+Math.sqrt(p*(l-t)*(l-t)-(t+p)*(l*l-t)))/(t+p);0>c&&(r=-r);c=this.x0+r;l=p+l;r=Math.PI*this.R*(q*l-m*Math.sqrt((t+p)*(p+1)-l*l))/(t+p);b=0<=b?this.y0+r:this.y0-r;a.x=c;a.y=b;return a};a.inverse=function(a){var b,c,e,m,p,q,t,r;a.x-=this.x0;a.y-=this.y0;p=Math.PI*this.R;b=a.x/p;e=a.y/p;m=b*b+e*e;p=-Math.abs(e)*(1+m);c=p-2*e*e+b*b;q=-2*p+1+2*e*e+m*m;t=(p-c*c/3/q)/q;r=2*Math.sqrt(-t/3);p=3*(e*e/q+(2*c*c*c/q/q/q-9*p*c/q/q)/27)/t/r;1<Math.abs(p)&&(p=0<=p?1:-1);p=Math.acos(p)/
    3;c=0<=a.y?(-r*Math.cos(p+Math.PI/3)-c/3/q)*Math.PI:-(-r*Math.cos(p+Math.PI/3)-c/3/q)*Math.PI;b=1E-10>Math.abs(b)?this.long0:d(this.long0+Math.PI*(m-1+Math.sqrt(1+2*(b*b-e*e)+m*m))/2/b);a.x=b;a.y=c;return a};a.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],64:[function(b,c,a){var d=b("./datum_transform"),e=b("./adjust_axis"),g=b("./Proj"),h=b("./common/toPoint");c.exports=function l(a,b,c){var t;Array.isArray(c)&&(c=h(c));a.datum&&b.datum&&((1===
a.datum.datum_type||2===a.datum.datum_type)&&"WGS84"!==b.datumCode||(1===b.datum.datum_type||2===b.datum.datum_type)&&"WGS84"!==a.datumCode)&&(t=new g("WGS84"),l(a,t,c),a=t);"enu"!==a.axis&&e(a,!1,c);"longlat"===a.projName?(c.x*=.017453292519943295,c.y*=.017453292519943295):(a.to_meter&&(c.x*=a.to_meter,c.y*=a.to_meter),a.inverse(c));a.from_greenwich&&(c.x+=a.from_greenwich);c=d(a.datum,b.datum,c);b.from_greenwich&&(c.x-=b.from_greenwich);"longlat"===b.projName?(c.x*=57.29577951308232,c.y*=57.29577951308232):
    (b.forward(c),b.to_meter&&(c.x/=b.to_meter,c.y/=b.to_meter));"enu"!==b.axis&&e(b,!0,c);return c}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":30}],65:[function(b,c,a){function d(a,b,d){a[b]=d.map(function(a){var b={};e(a,b);return b}).reduce(function(a,b){return k(a,b)},{})}function e(a,b){var c;Array.isArray(a)?(c=a.shift(),"PARAMETER"===c&&(c=a.shift()),1===a.length?Array.isArray(a[0])?(b[c]={},e(a[0],b[c])):b[c]=a[0]:a.length?"TOWGS84"===c?b[c]=a:(b[c]={},-1<["UNIT",
    "PRIMEM","VERT_DATUM"].indexOf(c)?(b[c]={name:a[0].toLowerCase(),convert:a[1]},3===a.length&&(b[c].auth=a[2])):"SPHEROID"===c?(b[c]={name:a[0],a:a[1],rf:a[2]},4===a.length&&(b[c].auth=a[3])):-1<"GEOGCS GEOCCS DATUM VERT_CS COMPD_CS LOCAL_CS FITTED_CS LOCAL_DATUM".split(" ").indexOf(c)?(a[0]=["name",a[0]],d(b,c,a)):a.every(function(a){return Array.isArray(a)})?d(b,c,a):e(a,b[c])):b[c]=!0):b[a]=!0}function g(a){return.017453292519943295*a}function h(a){function b(d){var c=a.to_meter||1;return parseFloat(d,
        10)*c}"GEOGCS"===a.type?a.projName="longlat":"LOCAL_CS"===a.type?(a.projName="identity",a.local=!0):a.projName="object"===typeof a.PROJECTION?Object.keys(a.PROJECTION)[0]:a.PROJECTION;a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&(a.to_meter=parseFloat(a.UNIT.convert,10)));if(a.GEOGCS){a.datumCode=a.GEOGCS.DATUM?a.GEOGCS.DATUM.name.toLowerCase():a.GEOGCS.name.toLowerCase();"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2));if("new_zealand_geodetic_datum_1949"===
    a.datumCode||"new_zealand_1949"===a.datumCode)a.datumCode="nzgd49";"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84");"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6));"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8));~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72");a.GEOGCS.DATUM&&a.GEOGCS.DATUM.SPHEROID&&(a.ellps=a.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),
"international"===a.ellps.toLowerCase().slice(0,13)&&(a.ellps="intl"),a.a=a.GEOGCS.DATUM.SPHEROID.a,a.rf=parseFloat(a.GEOGCS.DATUM.SPHEROID.rf,10));~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36")}a.b&&!isFinite(a.b)&&(a.b=a.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin",
    "Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",g],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",g],["x0","false_easting",b],["y0","false_northing",b],["long0","central_meridian",g],["lat0","latitude_of_origin",g],["lat0","standard_parallel_1",g],["lat1","standard_parallel_1",g],["lat2","standard_parallel_2",g],["alpha","azimuth",g],["srsCode","name"]].forEach(function(b){var d=
    b[0],c=b[1];!(d in a)&&c in a&&(a[d]=a[c],3===b.length&&(a[d]=b[2](a[d])))});a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.PROJECTION&&"Lambert_Azimuthal_Equal_Area"!==a.PROJECTION||(a.long0=a.longc)}var k=b("./extend");c.exports=function(a,b){var d=JSON.parse((","+a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),c=d.shift(),g=d.shift();d.unshift(["name",g]);d.unshift(["type",c]);d.unshift("output");c={};e(d,c);
    h(c.output);return k(b,c.output)}},{"./extend":33}],66:[function(b,c,a){function d(a){var b=a.easting,c=a.zoneNumber;if(0>c||60<c)return null;var e=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),g,q,t,r;q=a.northing;"N">a.zoneLetter&&(q-=1E7);q=q/.9996/6367449.145945056;r=q+(3*e/2-27*e*e*e/32)*Math.sin(2*q)+(21*e*e/16-55*e*e*e*e/32)*Math.sin(4*q)+151*e*e*e/96*Math.sin(6*q);g=6378137/Math.sqrt(1-.00669438*Math.sin(r)*Math.sin(r));e=Math.tan(r)*Math.tan(r);q=.006739496752268451*Math.cos(r)*Math.cos(r);
    t=6335439.32722994/Math.pow(1-.00669438*Math.sin(r)*Math.sin(r),1.5);b=(b-5E5)/(.9996*g);g=r-g*Math.tan(r)/t*(b*b/2-(5+3*e+10*q-4*q*q-.06065547077041606)*b*b*b*b/24+(61+90*e+298*q+45*e*e-1.6983531815716497-3*q*q)*b*b*b*b*b*b/720);g=g/Math.PI*180;b=(b-(1+2*e+q)*b*b*b/6+(5-2*q+28*e-3*q*q+.05391597401814761+24*e*e)*b*b*b*b*b/120)/Math.cos(r);b=6*(c-1)-180+3+b/Math.PI*180;a.accuracy?(a=d({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber}),a={top:a.lat,
        right:a.lon,bottom:g,left:b}):a={lat:g,lon:b};return a}function e(a){a%=6;0===a&&(a=6);return a}function g(a){var b;switch(a){case "C":b=11E5;break;case "D":b=2E6;break;case "E":b=28E5;break;case "F":b=37E5;break;case "G":b=46E5;break;case "H":b=55E5;break;case "J":b=64E5;break;case "K":b=73E5;break;case "L":b=82E5;break;case "M":b=91E5;break;case "N":b=0;break;case "P":b=8E5;break;case "Q":b=17E5;break;case "R":b=26E5;break;case "S":b=35E5;break;case "T":b=44E5;break;case "U":b=53E5;break;case "V":b=
    62E5;break;case "W":b=7E6;break;case "X":b=79E5;break;default:b=-1}if(0<=b)return b;throw"Invalid zone letter: "+a;}a.forward=function(a,b){var d,c,g,q=a[1],t=a[0],r;d=Math.PI/180*q;g=Math.PI/180*t;var u,w;w=Math.floor((t+180)/6)+1;180===t&&(w=60);56<=q&&64>q&&3<=t&&12>t&&(w=32);72<=q&&84>q&&(0<=t&&9>t?w=31:9<=t&&21>t?w=33:21<=t&&33>t?w=35:33<=t&&42>t&&(w=37));u=Math.PI/180*(6*(w-1)-180+3);t=6378137/Math.sqrt(1-.00669438*Math.sin(d)*Math.sin(d));r=Math.tan(d)*Math.tan(d);c=.006739496752268451*Math.cos(d)*
    Math.cos(d);g=Math.cos(d)*(g-u);d=.9996*(6378137*(.9983242984503243*d-.002514607064228144*Math.sin(2*d)+2.639046602129982E-6*Math.sin(4*d)-3.4180461016968582E-9*Math.sin(6*d))+t*Math.tan(d)*(g*g/2+(5-r+9*c+4*c*c)*g*g*g*g/24+(61-58*r+r*r+600*c-2.2240339282485886)*g*g*g*g*g*g/720));0>q&&(d+=1E7);d=Math.round(d);c=Math.round(.9996*t*(g+(1-r+c)*g*g*g/6+(5-18*r+r*r+72*c-.39089081163157013)*g*g*g*g*g/120)+5E5);g=w;r="Z";84>=q&&72<=q?r="X":72>q&&64<=q?r="W":64>q&&56<=q?r="V":56>q&&48<=q?r="U":48>q&&40<=
q?r="T":40>q&&32<=q?r="S":32>q&&24<=q?r="R":24>q&&16<=q?r="Q":16>q&&8<=q?r="P":8>q&&0<=q?r="N":0>q&&-8<=q?r="M":-8>q&&-16<=q?r="L":-16>q&&-24<=q?r="K":-24>q&&-32<=q?r="J":-32>q&&-40<=q?r="H":-40>q&&-48<=q?r="G":-48>q&&-56<=q?r="F":-56>q&&-64<=q?r="E":-64>q&&-72<=q?r="D":-72>q&&-80<=q&&(r="C");q=b||5;w=""+c;t=""+d;r=g+r;u=e(g);c=Math.floor(c/1E5);g=Math.floor(d/1E5)%20;--u;d="AJSAJS".charCodeAt(u);u="AFAFAF".charCodeAt(u);c=d+c-1;g=u+g;var x=!1;90<c&&(c=c-90+65-1,x=!0);(73===c||73>d&&73<c||(73<c||
73>d)&&x)&&c++;if(79===c||79>d&&79<c||(79<c||79>d)&&x)c++,73===c&&c++;90<c&&(c=c-90+65-1);86<g?(g=g-86+65-1,x=!0):x=!1;(73===g||73>u&&73<g||(73<g||73>u)&&x)&&g++;if(79===g||79>u&&79<g||(79<g||79>u)&&x)g++,73===g&&g++;86<g&&(g=g-86+65-1);d=String.fromCharCode(c)+String.fromCharCode(g);return r+d+w.substr(w.length-5,q)+t.substr(t.length-5,q)};a.inverse=function(a){if((a=a.toUpperCase())&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b=a.length,c,m="",p,q=0;!/[A-Z]/.test(p=a.charAt(q));){if(2<=
    q)throw"MGRSPoint bad conversion from: "+a;m+=p;q++}m=parseInt(m,10);if(0===q||q+3>b)throw"MGRSPoint bad conversion from: "+a;p=a.charAt(q++);if("A">=p||"B"===p||"Y"===p||"Z"<=p||"I"===p||"O"===p)throw"MGRSPoint zone letter "+p+" not handled: "+a;c=a.substring(q,q+=2);var t=e(m),r;r=c.charAt(0);for(var u="AJSAJS".charCodeAt(t-1),w=1E5,x=!1;u!==r.charCodeAt(0);){u++;73===u&&u++;79===u&&u++;if(90<u){if(x)throw"Bad character: "+r;u=65;x=!0}w+=1E5}r=w;c=c.charAt(1);if("V"<c)throw"MGRSPoint given invalid Northing "+
c;t="AFAFAF".charCodeAt(t-1);u=0;for(w=!1;t!==c.charCodeAt(0);){t++;73===t&&t++;79===t&&t++;if(86<t){if(w)throw"Bad character: "+c;t=65;w=!0}u+=1E5}for(t=u;t<g(p);)t+=2E6;b-=q;if(0!==b%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var b=b/2,u=c=0,A;0<b&&(A=1E5/Math.pow(10,b),c=a.substring(q,q+b),c=parseFloat(c)*A,a=a.substring(q+b),u=parseFloat(a)*A);A=d({easting:c+r,northing:u+
t,zoneLetter:p,zoneNumber:m,accuracy:A});return[A.left,A.bottom,A.right,A.top]};a.toPoint=function(b){b=a.inverse(b);return[(b[2]+b[0])/2,(b[3]+b[1])/2]}},{}],67:[function(b,c,a){c.exports={name:"proj4",version:"2.3.3",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},
    repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},
    dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(b,c,a){c.exports=b("gWUPNW")},{}],gWUPNW:[function(b,c,a){var d=[b("./lib/projections/tmerc"),b("./lib/projections/utm"),b("./lib/projections/sterea"),b("./lib/projections/stere"),b("./lib/projections/somerc"),b("./lib/projections/omerc"),b("./lib/projections/lcc"),b("./lib/projections/krovak"),b("./lib/projections/cass"),b("./lib/projections/laea"),b("./lib/projections/aea"),b("./lib/projections/gnom"),b("./lib/projections/cea"),
    b("./lib/projections/eqc"),b("./lib/projections/poly"),b("./lib/projections/nzmg"),b("./lib/projections/mill"),b("./lib/projections/sinu"),b("./lib/projections/moll"),b("./lib/projections/eqdc"),b("./lib/projections/vandg"),b("./lib/projections/aeqd")];c.exports=function(a){d.forEach(function(b){a.Proj.projections.add(b)})}},{"./lib/projections/aea":39,"./lib/projections/aeqd":40,"./lib/projections/cass":41,"./lib/projections/cea":42,"./lib/projections/eqc":43,"./lib/projections/eqdc":44,"./lib/projections/gnom":46,
    "./lib/projections/krovak":47,"./lib/projections/laea":48,"./lib/projections/lcc":49,"./lib/projections/mill":52,"./lib/projections/moll":53,"./lib/projections/nzmg":54,"./lib/projections/omerc":55,"./lib/projections/poly":56,"./lib/projections/sinu":57,"./lib/projections/somerc":58,"./lib/projections/stere":59,"./lib/projections/sterea":60,"./lib/projections/tmerc":61,"./lib/projections/utm":62,"./lib/projections/vandg":63}]},{},[35])(35)});
define("src/formats/geojson/GeoJSONCRS",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger","../../util/proj4-src"],function(f,b,c,a){var d=function(a,b){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONCRS","constructor","missingType"));if(!b)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONCRS","constructor","missingProperties"));this._type=a;this._properties=b;this._projectionString=null};Object.defineProperties(d.prototype,{type:{get:function(){return this._type}},properties:{get:function(){return this._properties}},
    projectionString:{get:function(){return this._projectionString}}});d.prototype.isDefault=function(){return!this.isNamed()||this._projectionString!==b.EPSG4326_CRS&&this._projectionString!==b.WGS84_CRS?!1:!0};d.prototype.isNamed=function(){return this._type===b.FIELD_CRS_NAME};d.prototype.isLinked=function(){return this._type===b.FIELD_CRS_LINK};d.prototype.isCRSSupported=function(){try{a(this._projectionString,b.EPSG4326_CRS)}catch(d){return c.log(c.LEVEL_WARNING,"Unknown GeoJSON coordinate reference system ("+
    d+"): "+this._properties.name),!1}return!0};d.prototype.getLinkedCRSString=function(a,b){var d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="text";d.onreadystatechange=function(){4===d.readyState&&(200===d.status?(this._projectionString=d.response,b()):c.log(c.LEVEL_WARNING,"GeoJSON Linked CRS retrieval failed ("+d.statusText+"): "+a))}.bind(this);d.onerror=function(){c.log(c.LEVEL_WARNING,"GeoJSON Linked CRS retrieval failed: "+a)};d.ontimeout=function(){c.log(c.LEVEL_WARNING,"GeoJSON Linked CRS retrieval timed out: "+
    a)};d.send(null)};d.prototype.setCRSString=function(a){this.isNamed()?(this._projectionString=this._properties.name,a()):this.isLinked()&&this.getLinkedCRSString(this._properties.href,a)};return d});
define("src/formats/geojson/GeoJSONFeature",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(f,b,c){var a=function(a,e,g,h){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingGeometry"));if(!a[b.FIELD_TYPE])throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingFeatureGeometryType"));if(!e)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingProperties"));this._geometry=a;this._properties=
    e;this._id=g;this._bbox=h};Object.defineProperties(a.prototype,{geometry:{get:function(){return this._geometry}},properties:{get:function(){return this._properties}},id:{get:function(){return this._id}},bbox:{get:function(){return this._bbox}}});return a});
define("src/formats/geojson/GeoJSONFeatureCollection",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(f,b,c){b=function(a,b){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONFeatureCollection","constructor","missingFeatures"));if("[object Array]"!==Object.prototype.toString.call(a))throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONFeatureCollection","constructor","invalidFeatures"));this._features=a;this._bbox=b};Object.defineProperties(b.prototype,{features:{get:function(){return this._features}},
    bbox:{get:function(){return this._bbox}}});return b});
define("src/formats/geojson/GeoJSONGeometry",["./GeoJSONConstants"],function(f){var b=function(b,a,d){if(!b)throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE,"GeoJSONGeometry","constructor","missingCoordinates"));if(!a)throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE,"GeoJSONGeometry","constructor","missingType"));this._coordinates=b;this._type=a;this._bbox=d?d:null};Object.defineProperties(b.prototype,{coordinates:{get:function(){return this._coordinates}},type:{get:function(){return this._type}},
    bbox:{get:function(){return this._bbox}}});b.prototype.isPointType=function(){return this.type===f.TYPE_POINT};b.prototype.isMultiPointType=function(){return this.type===f.TYPE_MULTI_POINT};b.prototype.isLineStringType=function(){return this.type===f.TYPE_LINE_STRING};b.prototype.isMultiLineStringType=function(){return this.type===f.TYPE_MULTI_LINE_STRING};b.prototype.isPolygonType=function(){return this.type===f.TYPE_POLYGON};b.prototype.isMultiPolygonType=function(){return this.type===f.TYPE_MULTI_POLYGON};
    return b});
define("src/formats/geojson/GeoJSONGeometryCollection",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(f,b,c){b=function(a,b){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryCollection","constructor","missingGeometries"));if("[object Array]"!==Object.prototype.toString.call(a))throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryCollection","constructor","invalidGeometries"));this._geometries=a;this._bbox=b};Object.defineProperties(b.prototype,{geometries:{get:function(){return this._geometries}},
    bbox:{get:function(){return this._bbox}}});return b});
define("src/formats/geojson/GeoJSONGeometryLineString",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(f,b,c){var a=function(a,e,g){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingCoordinates"));if(2>a.length||2>a[0].length)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(a[0])||"[object Number]"!==Object.prototype.toString.call(a[0][0]))throw new f(c.logMessage(c.LEVEL_SEVERE,
    "GeoJSONGeometryLineString","constructor","invalidCoordinatesType"));if(!e)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingType"));b.call(this,a,e,g)};a.prototype=Object.create(b.prototype);return a});
define("src/formats/geojson/GeoJSONGeometryMultiLineString",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(f,b,c){var a=function(a,e,g){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","missingCoordinates"));if(2>a[0].length||2>a[0][0].length)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(a[0])||"[object Array]"!==
    Object.prototype.toString.call(a[0][0])||"[object Number]"!==Object.prototype.toString.call(a[0][0][0]))throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","invalidCoordinatesType"));if(!e)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingType"));b.call(this,a,e,g)};a.prototype=Object.create(b.prototype);return a});
define("src/formats/geojson/GeoJSONGeometryMultiPoint",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(f,b,c){var a=function(a,e,g){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","missingCoordinates"));if(2>a[0].length)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(a[0])||"[object Number]"!==Object.prototype.toString.call(a[0][0]))throw new f(c.logMessage(c.LEVEL_SEVERE,
    "GeoJSONGeometryMultiPoint","constructor","invalidCoordinatesType"));if(!e)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingType"));b.call(this,a,e,g)};a.prototype=Object.create(b.prototype);return a});
define("src/formats/geojson/GeoJSONGeometryMultiPolygon",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(f,b,c){var a=function(a,e,g){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryMultiPolygon","constructor","missingCoordinates"));if("[object Array]"!==Object.prototype.toString.call(a[0])||"[object Array]"!==Object.prototype.toString.call(a[0][0])||"[object Array]"!==Object.prototype.toString.call(a[0][0][0])||"[object Number]"!==Object.prototype.toString.call(a[0][0][0][0]))throw new f(c.logMessage(c.LEVEL_SEVERE,
    "GeoJSONGeometryPolygon","constructor","invalidCoordinatesType"));if(!e)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingType"));b.call(this,a,e,g)};a.prototype=Object.create(b.prototype);return a});
define("src/formats/geojson/GeoJSONGeometryPoint",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(f,b,c){var a=function(a,e,g){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingCoordinates"));if(2>a.length)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(a)||"[object Number]"!==Object.prototype.toString.call(a[0]))throw new f(c.logMessage(c.LEVEL_SEVERE,
    "GeoJSONGeometryPoint","constructor","invalidCoordinatesType"));if(!e)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingType"));b.call(this,a,e,g)};a.prototype=Object.create(b.prototype);return a});
define("src/formats/geojson/GeoJSONGeometryPolygon",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(f,b,c){var a=function(a,e,g){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingCoordinates"));if(2>a[0].length||2>a[0][0].length)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(a[0])||"[object Array]"!==Object.prototype.toString.call(a[0][0])||
    "[object Number]"!==Object.prototype.toString.call(a[0][0][0]))throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidCoordinatesType"));if(a[0][0]!==a[0][a.length-1])throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidLinearRing"));if(!e)throw new f(c.logMessage(c.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingType"));b.call(this,a,e,g)};a.prototype=Object.create(b.prototype);return a});
define("src/shapes/PlacemarkAttributes",["../util/Color","../util/Font","../util/Offset","../shapes/ShapeAttributes","../shapes/TextAttributes"],function(f,b,c,a,d){b=function(b){this._imageColor=b?b._imageColor:new f(1,1,1,1);this._imageOffset=b?b._imageOffset:new c(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5);this._imageScale=b?b._imageScale:1;this._imageSource=b?b._imageSource:null;this._depthTest=b?b._depthTest:!0;this._labelAttributes=b?b._labelAttributes:new d(null);this._drawLeaderLine=
    b?b._drawLeaderLine:!1;this._leaderLineAttributes=b?b._leaderLineAttributes:new a(null);this.stateKeyInvalid=!0};b.prototype.computeStateKey=function(){return"ic "+this._imageColor.toHexString(!0)+" io "+this._imageOffset.toString()+" is "+this._imageScale+" ip "+this._imageSource+" dt "+this._depthTest+" la "+this._labelAttributes.stateKey+" dll "+this._drawLeaderLine+" lla "+this._leaderLineAttributes.stateKey};Object.defineProperties(b.prototype,{stateKey:{get:function(){this.stateKeyInvalid&&
(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1);return this._stateKey}},imageColor:{get:function(){return this._imageColor},set:function(a){this._imageColor=a;this.stateKeyInvalid=!0}},imageOffset:{get:function(){return this._imageOffset},set:function(a){this._imageOffset=a;this.stateKeyInvalid=!0}},imageScale:{get:function(){return this._imageScale},set:function(a){this._imageScale=a;this.stateKeyInvalid=!0}},imageSource:{get:function(){return this._imageSource},set:function(a){this._imageSource=
    a;this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(a){this._depthTest=a;this.stateKeyInvalid=!0}},labelAttributes:{get:function(){return this._labelAttributes},set:function(a){this._labelAttributes=a;this.stateKeyInvalid=!0}},drawLeaderLine:{get:function(){return this._drawLeaderLine},set:function(a){this._drawLeaderLine=a;this.stateKeyInvalid=!0}},leaderLineAttributes:{get:function(){return this._leaderLineAttributes},set:function(a){this._leaderLineAttributes=
    a;this.stateKeyInvalid=!0}}});return b});
define("src/shapes/Placemark","../error/ArgumentError ../shaders/BasicTextureProgram ../util/Color ../util/Font ../util/Logger ../geom/Matrix ../pick/PickedObject ../shapes/PlacemarkAttributes ../render/Renderable ../geom/Vec2 ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p){var q=function(a,b,c){if(!a)throw new f(d.logMessage(d.LEVEL_SEVERE,"Placemark","constructor","missingPosition"));k.call(this);this.attributes=c?c:new h(null);this.highlightAttributes=null;this.highlighted=
    !1;this.position=a;this.eyeDistanceScaling=b;this.eyeDistanceScalingThreshold=1E6;this.eyeDistanceScalingLabelThreshold=1.5*this.eyeDistanceScalingThreshold;this.label=null;this.altitudeMode=WorldWind.ABSOLUTE;this.enableLeaderLinePicking=this.alwaysOnTop=!1;this.updateImage=!0;this.declutterGroup=2;this.currentVisibility=this.targetVisibility=1;this.imageTilt=this.imageRotation=0;this.imageTiltReference=this.imageRotationReference=WorldWind.RELATIVE_TO_SCREEN;this.labelTexture=this.activeTexture=
    this.activeAttributes=null;this.placePoint=new m(0,0,0);this.groundPoint=new m(0,0,0);this.imageTransform=e.fromIdentity();this.labelTransform=e.fromIdentity();this.texCoordMatrix=e.fromIdentity();this.layer=this.imageBounds=null;this.depthOffset=-.003};q.screenPoint=new m(0,0,0);q.matrix=e.fromIdentity();q.scratchPoint=new m(0,0,0);q.prototype=Object.create(k.prototype);Object.defineProperties(q.prototype,{screenBounds:{get:function(){return this.labelBounds}}});q.prototype.copy=function(a){this.position=
    a.position;this.attributes=a.attributes;this.highlightAttributes=a.highlightAttributes;this.highlighted=a.highlighted;this.enabled=a.enabled;this.label=a.label;this.altitudeMode=a.altitudeMode;this.pickDelegate=a.pickDelegate;this.alwaysOnTop=a.alwaysOnTop;this.depthOffset=a.depthOffset;this.targetVisibility=a.targetVisibility;this.currentVisibility=a.currentVisibility;this.imageRotation=a.imageRotation;this.imageTilt=a.imageTilt;this.imageRotationReference=a.imageRotationReference;this.imageTiltReference=
    a.imageTiltReference;return this};q.prototype.clone=function(){var a=new q(this.position);a.copy(this);a.pickDelegate=this.pickDelegate?this.pickDelegate:this;return a};q.prototype.render=function(a){if(this.enabled&&a.accumulateOrderedRenderables&&(!a.globe.projectionLimits||a.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude))){var b;(b=this.lastFrameTime!==a.timestamp?this.makeOrderedRenderable(a):this.clone().makeOrderedRenderable(a))&&b.isVisible(a)&&(b.layer=
    a.currentLayer,this.lastFrameTime=a.timestamp,a.addOrderedRenderable(b))}};q.prototype.renderOrdered=function(a){this.drawOrderedPlacemark(a);if(a.pickingMode){var b=new g(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,this.position,this.layer,!1);a.pickPoint&&this.mustDrawLabel()&&this.labelBounds.containsPoint(a.navigatorState.convertPointToViewport(a.pickPoint,q.scratchPoint))&&(b.labelPicked=!0);a.resolvePick(b)}};q.prototype.makeOrderedRenderable=function(a){var b,d,c,e;this.determineActiveAttributes(a);
    if(!this.activeAttributes)return null;a.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint);this.eyeDistance=this.alwaysOnTop?0:a.navigatorState.eyePoint.distanceTo(this.placePoint);this.mustDrawLeaderLine(a)&&a.surfacePointForMode(this.position.latitude,this.position.longitude,0,this.altitudeMode,this.groundPoint);if(!a.navigatorState.projectWithDepth(this.placePoint,this.depthOffset,q.screenPoint))return null;var g=this.eyeDistanceScaling?
        Math.max(0,Math.min(1,this.eyeDistanceScalingThreshold/this.eyeDistance)):1;this.activeTexture?(b=this.activeTexture.originalImageWidth,d=this.activeTexture.originalImageHeight,c=this.activeAttributes.imageScale*g,e=this.activeAttributes.imageOffset.offsetForSize(b,d),this.imageTransform.setTranslation(q.screenPoint[0]-e[0]*c,q.screenPoint[1]-e[1]*c,q.screenPoint[2]),this.imageTransform.setScale(b*c,d*c,1)):(c=this.activeAttributes.imageScale*g,e=this.activeAttributes.imageOffset.offsetForSize(c,
        c),this.imageTransform.setTranslation(q.screenPoint[0]-e[0],q.screenPoint[1]-e[1],q.screenPoint[2]),this.imageTransform.setScale(c,c,1));this.imageBounds=p.boundingRectForUnitQuad(this.imageTransform);this.mustDrawLabel()&&(b=this.activeAttributes.labelAttributes.font,d=this.label+b.toString(),this.labelTexture=a.gpuResourceCache.resourceForKey(d),this.labelTexture||(this.labelTexture=a.textSupport.createTexture(a,this.label,b,!0),a.gpuResourceCache.putResource(d,this.labelTexture,this.labelTexture.size)),
        b=this.labelTexture.imageWidth,d=this.labelTexture.imageHeight,c=this.activeAttributes.labelAttributes.scale*g,e=this.activeAttributes.labelAttributes.offset.offsetForSize(b,d),this.labelTransform.setTranslation(q.screenPoint[0]-e[0]*c,q.screenPoint[1]-e[1]*c,q.screenPoint[2]),this.labelTransform.setScale(b*c,d*c,1),this.labelBounds=p.boundingRectForUnitQuad(this.labelTransform));return this};q.prototype.determineActiveAttributes=function(a){(this.activeAttributes=this.highlighted&&this.highlightAttributes?
    this.highlightAttributes:this.attributes)&&this.activeAttributes.imageSource&&(this.activeTexture=a.gpuResourceCache.resourceForKey(this.activeAttributes.imageSource),!this.activeTexture||this.updateImage)&&(this.activeTexture=a.gpuResourceCache.retrieveTexture(a.currentGlContext,this.activeAttributes.imageSource),this.updateImage=!1)};q.prototype.isVisible=function(a){return a.pickingMode?a.pickRectangle&&(this.imageBounds.intersects(a.pickRectangle)||this.mustDrawLabel()&&this.labelBounds.intersects(a.pickRectangle)||
this.mustDrawLeaderLine(a)&&a.pickFrustum.intersectsSegment(this.groundPoint,this.placePoint)):this.imageBounds.intersects(a.navigatorState.viewport)||this.mustDrawLabel()&&this.labelBounds.intersects(a.navigatorState.viewport)||this.mustDrawLeaderLine(a)&&a.navigatorState.frustumInModelCoordinates.intersectsSegment(this.groundPoint,this.placePoint)};q.prototype.drawOrderedPlacemark=function(a){this.beginDrawing(a);try{this.doDrawOrderedPlacemark(a),a.pickingMode||this.drawBatchOrderedPlacemarks(a)}finally{this.endDrawing(a)}};
    q.prototype.drawBatchOrderedPlacemarks=function(a){for(var b;(b=a.peekOrderedRenderable())&&b.doDrawOrderedPlacemark;){a.popOrderedRenderable();try{b.doDrawOrderedPlacemark(a)}catch(c){d.logMessage(d.LEVEL_WARNING,"Placemark","drawBatchOrderedPlacemarks","Error occurred while rendering placemark using batching: "+c.message)}}};q.prototype.beginDrawing=function(a){var c=a.currentGlContext,d;a.findAndBindProgram(b);d=a.currentProgram;c.bindBuffer(c.ARRAY_BUFFER,a.unitQuadBuffer());c.vertexAttribPointer(d.vertexTexCoordLocation,
        2,c.FLOAT,!1,0,0);c.enableVertexAttribArray(d.vertexPointLocation);c.enableVertexAttribArray(d.vertexTexCoordLocation);d.loadTextureUnit(c,c.TEXTURE0);d.loadModulateColor(c,a.pickingMode)};q.prototype.endDrawing=function(a){var b=a.currentGlContext;a=a.currentProgram;b.disableVertexAttribArray(a.vertexPointLocation);b.disableVertexAttribArray(a.vertexTexCoordLocation);b.bindBuffer(b.ARRAY_BUFFER,null);b.bindTexture(b.TEXTURE_2D,null)};q.prototype.doDrawOrderedPlacemark=function(a){var b=a.currentGlContext,
        c=a.currentProgram,d=!0,e;a.pickingMode&&(this.pickColor=a.uniquePickColor());this.eyeDistanceScaling&&this.eyeDistance>this.eyeDistanceScalingLabelThreshold&&(this.targetVisibility=0);!a.pickingMode&&this.mustDrawLabel()&&this.currentVisibility!=this.targetVisibility&&(e=(a.timestamp-a.previousRedrawTimestamp)/a.fadeTime,this.currentVisibility=this.currentVisibility<this.targetVisibility?Math.min(1,this.currentVisibility+e):Math.max(0,this.currentVisibility-e),a.redrawRequested=!0);c.loadOpacity(b,
        a.pickingMode?1:this.layer.opacity);this.mustDrawLeaderLine(a)&&(this.leaderLinePoints||(this.leaderLinePoints=new Float32Array(6)),this.leaderLinePoints[0]=this.groundPoint[0],this.leaderLinePoints[1]=this.groundPoint[1],this.leaderLinePoints[2]=this.groundPoint[2],this.leaderLinePoints[3]=this.placePoint[0],this.leaderLinePoints[4]=this.placePoint[1],this.leaderLinePoints[5]=this.placePoint[2],this.leaderLineCacheKey||(this.leaderLineCacheKey=a.gpuResourceCache.generateCacheKey()),e=a.gpuResourceCache.resourceForKey(this.leaderLineCacheKey),
    e||(e=b.createBuffer(),a.gpuResourceCache.putResource(this.leaderLineCacheKey,e,4*this.leaderLinePoints.length)),c.loadTextureEnabled(b,!1),c.loadColor(b,a.pickingMode?this.pickColor:this.activeAttributes.leaderLineAttributes.outlineColor),q.matrix.copy(a.navigatorState.modelviewProjection),c.loadModelviewProjection(b,q.matrix),this.activeAttributes.leaderLineAttributes.depthTest||b.disable(b.DEPTH_TEST),b.lineWidth(this.activeAttributes.leaderLineAttributes.outlineWidth),b.bindBuffer(b.ARRAY_BUFFER,
        e),b.bufferData(b.ARRAY_BUFFER,this.leaderLinePoints,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1),b.vertexAttribPointer(c.vertexPointLocation,3,b.FLOAT,!1,0,0),b.drawArrays(b.LINES,0,2));this.activeAttributes.depthTest||(d=!1,b.disable(b.DEPTH_TEST));b.bindBuffer(b.ARRAY_BUFFER,a.unitQuadBuffer3());b.vertexAttribPointer(c.vertexPointLocation,3,b.FLOAT,!1,0,0);q.matrix.copy(a.screenProjection);q.matrix.multiplyMatrix(this.imageTransform);e=this.imageRotationReference===WorldWind.RELATIVE_TO_GLOBE?
    a.navigatorState.heading-this.imageRotation:-this.imageRotation;q.matrix.multiplyByTranslation(.5,.5,0);q.matrix.multiplyByRotation(0,0,1,e);q.matrix.multiplyByTranslation(-.5,-.5,0);q.matrix.multiplyByRotation(-1,0,0,this.imageTiltReference===WorldWind.RELATIVE_TO_GLOBE?a.navigatorState.tilt+this.imageTilt:this.imageTilt);c.loadModelviewProjection(b,q.matrix);c.loadTextureEnabled(b,!0);a.pickingMode?c.loadColor(b,this.pickColor):c.loadColor(b,this.activeAttributes.imageColor);this.texCoordMatrix.setToIdentity();
        this.activeTexture&&this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture);c.loadTextureMatrix(b,this.texCoordMatrix);this.activeTexture?(e=this.activeTexture.bind(a),c.loadTextureEnabled(b,e)):c.loadTextureEnabled(b,!1);b.drawArrays(b.TRIANGLE_STRIP,0,4);this.mustDrawLabel()&&0<this.currentVisibility&&(c.loadOpacity(b,a.pickingMode?1:this.layer.opacity*this.currentVisibility),q.matrix.copy(a.screenProjection),q.matrix.multiplyMatrix(this.labelTransform),c.loadModelviewProjection(b,q.matrix),
            !a.pickingMode&&this.labelTexture?(this.texCoordMatrix.setToIdentity(),this.texCoordMatrix.multiplyByTextureTransform(this.labelTexture),c.loadTextureMatrix(b,this.texCoordMatrix),c.loadColor(b,this.activeAttributes.labelAttributes.color),e=this.labelTexture.bind(a),c.loadTextureEnabled(b,e)):(c.loadTextureEnabled(b,!1),c.loadColor(b,this.pickColor)),this.activeAttributes.labelAttributes.depthTest?d||(d=!0,b.enable(b.DEPTH_TEST)):(d=!1,b.disable(b.DEPTH_TEST)),b.drawArrays(b.TRIANGLE_STRIP,0,4));
        d||b.enable(b.DEPTH_TEST)};q.prototype.mustDrawLabel=function(){return this.label&&0<this.label.length&&this.activeAttributes.labelAttributes};q.prototype.mustDrawLeaderLine=function(a){return this.activeAttributes.drawLeaderLine&&this.activeAttributes.leaderLineAttributes&&(!a.pickingMode||this.enableLeaderLinePicking)};return q});
var libtess={DEBUG:!1,assert:function(f,b){if(libtess.DEBUG&&!f)throw Error("Assertion failed"+(b?": "+b:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,TESS_MAX_CACHE:100,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,
    GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,
    GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};libtess.geom.vertEq=function(f,b){return f.s===b.s&&f.t===b.t};libtess.geom.vertLeq=function(f,b){return f.s<b.s||f.s===b.s&&f.t<=b.t};libtess.geom.edgeEval=function(f,b,c){var a=b.s-f.s,d=c.s-b.s;return 0<a+d?a<d?b.t-f.t+a/(a+d)*(f.t-c.t):b.t-c.t+d/(a+d)*(c.t-f.t):0};
libtess.geom.edgeSign=function(f,b,c){var a=b.s-f.s,d=c.s-b.s;return 0<a+d?(b.t-c.t)*a+(b.t-f.t)*d:0};libtess.geom.transLeq=function(f,b){return f.t<b.t||f.t===b.t&&f.s<=b.s};libtess.geom.transEval=function(f,b,c){var a=b.t-f.t,d=c.t-b.t;return 0<a+d?a<d?b.s-f.s+a/(a+d)*(f.s-c.s):b.s-c.s+d/(a+d)*(c.s-f.s):0};libtess.geom.transSign=function(f,b,c){var a=b.t-f.t,d=c.t-b.t;return 0<a+d?(b.s-c.s)*a+(b.s-f.s)*d:0};libtess.geom.edgeGoesLeft=function(f){return libtess.geom.vertLeq(f.dst(),f.org)};
libtess.geom.edgeGoesRight=function(f){return libtess.geom.vertLeq(f.org,f.dst())};libtess.geom.vertL1dist=function(f,b){return Math.abs(f.s-b.s)+Math.abs(f.t-b.t)};libtess.geom.vertCCW=function(f,b,c){return 0<=f.s*(b.t-c.t)+b.s*(c.t-f.t)+c.s*(f.t-b.t)};libtess.geom.interpolate_=function(f,b,c,a){f=0>f?0:f;c=0>c?0:c;return f<=c?0===c?(b+a)/2:b+f/(f+c)*(a-b):a+c/(f+c)*(b-a)};
libtess.geom.edgeIntersect=function(f,b,c,a,d){var e,g;libtess.geom.vertLeq(f,b)||(e=f,f=b,b=e);libtess.geom.vertLeq(c,a)||(e=c,c=a,a=e);libtess.geom.vertLeq(f,c)||(e=f,f=c,c=e,e=b,b=a,a=e);libtess.geom.vertLeq(c,b)?libtess.geom.vertLeq(b,a)?(e=libtess.geom.edgeEval(f,c,b),g=libtess.geom.edgeEval(c,b,a),0>e+g&&(e=-e,g=-g),d.s=libtess.geom.interpolate_(e,c.s,g,b.s)):(e=libtess.geom.edgeSign(f,c,b),g=-libtess.geom.edgeSign(f,a,b),0>e+g&&(e=-e,g=-g),d.s=libtess.geom.interpolate_(e,c.s,g,a.s)):d.s=(c.s+
    b.s)/2;libtess.geom.transLeq(f,b)||(e=f,f=b,b=e);libtess.geom.transLeq(c,a)||(e=c,c=a,a=e);libtess.geom.transLeq(f,c)||(e=f,f=c,c=e,e=b,b=a,a=e);libtess.geom.transLeq(c,b)?libtess.geom.transLeq(b,a)?(e=libtess.geom.transEval(f,c,b),g=libtess.geom.transEval(c,b,a),0>e+g&&(e=-e,g=-g),d.t=libtess.geom.interpolate_(e,c.t,g,b.t)):(e=libtess.geom.transSign(f,c,b),g=-libtess.geom.transSign(f,a,b),0>e+g&&(e=-e,g=-g),d.t=libtess.geom.interpolate_(e,c.t,g,a.t)):d.t=(c.t+b.t)/2};libtess.mesh={};
libtess.mesh.makeEdge=function(f){var b=libtess.mesh.makeEdgePair_(f.eHead);libtess.mesh.makeVertex_(b,f.vHead);libtess.mesh.makeVertex_(b.sym,f.vHead);libtess.mesh.makeFace_(b,f.fHead);return b};
libtess.mesh.meshSplice=function(f,b){var c=!1,a=!1;f!==b&&(b.org!==f.org&&(a=!0,libtess.mesh.killVertex_(b.org,f.org)),b.lFace!==f.lFace&&(c=!0,libtess.mesh.killFace_(b.lFace,f.lFace)),libtess.mesh.splice_(b,f),a||(libtess.mesh.makeVertex_(b,f.org),f.org.anEdge=f),c||(libtess.mesh.makeFace_(b,f.lFace),f.lFace.anEdge=f))};
libtess.mesh.deleteEdge=function(f){var b=f.sym,c=!1;f.lFace!==f.rFace()&&(c=!0,libtess.mesh.killFace_(f.lFace,f.rFace()));f.oNext===f?libtess.mesh.killVertex_(f.org,null):(f.rFace().anEdge=f.oPrev(),f.org.anEdge=f.oNext,libtess.mesh.splice_(f,f.oPrev()),c||libtess.mesh.makeFace_(f,f.lFace));b.oNext===b?(libtess.mesh.killVertex_(b.org,null),libtess.mesh.killFace_(b.lFace,null)):(f.lFace.anEdge=b.oPrev(),b.org.anEdge=b.oNext,libtess.mesh.splice_(b,b.oPrev()));libtess.mesh.killEdge_(f)};
libtess.mesh.addEdgeVertex=function(f){var b=libtess.mesh.makeEdgePair_(f),c=b.sym;libtess.mesh.splice_(b,f.lNext);b.org=f.dst();libtess.mesh.makeVertex_(c,b.org);b.lFace=c.lFace=f.lFace;return b};libtess.mesh.splitEdge=function(f){var b=libtess.mesh.addEdgeVertex(f).sym;libtess.mesh.splice_(f.sym,f.sym.oPrev());libtess.mesh.splice_(f.sym,b);f.sym.org=b.org;b.dst().anEdge=b.sym;b.sym.lFace=f.rFace();b.winding=f.winding;b.sym.winding=f.sym.winding;return b};
libtess.mesh.connect=function(f,b){var c=!1,a=libtess.mesh.makeEdgePair_(f),d=a.sym;b.lFace!==f.lFace&&(c=!0,libtess.mesh.killFace_(b.lFace,f.lFace));libtess.mesh.splice_(a,f.lNext);libtess.mesh.splice_(d,b);a.org=f.dst();d.org=b.org;a.lFace=d.lFace=f.lFace;f.lFace.anEdge=d;c||libtess.mesh.makeFace_(a,f.lFace);return a};
libtess.mesh.zapFace=function(f){var b=f.anEdge,c=b.lNext,a;do if(a=c,c=a.lNext,a.lFace=null,null===a.rFace()){a.oNext===a?libtess.mesh.killVertex_(a.org,null):(a.org.anEdge=a.oNext,libtess.mesh.splice_(a,a.oPrev()));var d=a.sym;d.oNext===d?libtess.mesh.killVertex_(d.org,null):(d.org.anEdge=d.oNext,libtess.mesh.splice_(d,d.oPrev()));libtess.mesh.killEdge_(a)}while(a!==b);b=f.prev;f=f.next;f.prev=b;b.next=f};
libtess.mesh.meshUnion=function(f,b){var c=f.fHead,a=f.vHead,d=f.eHead,e=b.fHead,g=b.vHead,h=b.eHead;e.next!==e&&(c.prev.next=e.next,e.next.prev=c.prev,e.prev.next=c,c.prev=e.prev);g.next!==g&&(a.prev.next=g.next,g.next.prev=a.prev,g.prev.next=a,a.prev=g.prev);h.next!==h&&(d.sym.next.sym.next=h.next,h.next.sym.next=d.sym.next,h.sym.next.sym.next=d,d.sym.next=h.sym.next);return f};libtess.mesh.deleteMesh=function(f){};
libtess.mesh.makeEdgePair_=function(f){var b=new libtess.GluHalfEdge,c=new libtess.GluHalfEdge,a=f.sym.next;c.next=a;a.sym.next=b;b.next=f;f.sym.next=c;b.sym=c;b.oNext=b;b.lNext=c;c.sym=b;c.oNext=c;return c.lNext=b};libtess.mesh.splice_=function(f,b){var c=f.oNext,a=b.oNext;c.sym.lNext=b;a.sym.lNext=f;f.oNext=a;b.oNext=c};libtess.mesh.makeVertex_=function(f,b){var c=b.prev,a=new libtess.GluVertex(b,c);c.next=a;b.prev=a;c=a.anEdge=f;do c.org=a,c=c.oNext;while(c!==f)};
libtess.mesh.makeFace_=function(f,b){var c=b.prev,a=new libtess.GluFace(b,c);c.next=a;b.prev=a;a.anEdge=f;a.inside=b.inside;c=f;do c.lFace=a,c=c.lNext;while(c!==f)};libtess.mesh.killEdge_=function(f){var b=f.next;f=f.sym.next;b.sym.next=f;f.sym.next=b};libtess.mesh.killVertex_=function(f,b){var c=f.anEdge,a=c;do a.org=b,a=a.oNext;while(a!==c);c=f.prev;a=f.next;a.prev=c;c.next=a};
libtess.mesh.killFace_=function(f,b){var c=f.anEdge,a=c;do a.lFace=b,a=a.lNext;while(a!==c);c=f.prev;a=f.next;a.prev=c;c.next=a};libtess.normal={};libtess.normal.S_UNIT_X_=1;libtess.normal.S_UNIT_Y_=0;
libtess.normal.projectPolygon=function(f){var b=!1,c=[f.normal[0],f.normal[1],f.normal[2]];0===c[0]&&0===c[1]&&0===c[2]&&(libtess.normal.computeNormal_(f,c),b=!0);var a=f.sUnit,d=f.tUnit,e=libtess.normal.longAxis_(c);libtess.TRUE_PROJECT?(libtess.normal.normalize_(c),a[e]=0,a[(e+1)%3]=libtess.normal.S_UNIT_X_,a[(e+2)%3]=libtess.normal.S_UNIT_Y_,e=libtess.normal.dot_(a,c),a[0]-=e*c[0],a[1]-=e*c[1],a[2]-=e*c[2],libtess.normal.normalize_(a),d[0]=c[1]*a[2]-c[2]*a[1],d[1]=c[2]*a[0]-c[0]*a[2],d[2]=c[0]*
    a[1]-c[1]*a[0],libtess.normal.normalize_(d)):(a[e]=0,a[(e+1)%3]=libtess.normal.S_UNIT_X_,a[(e+2)%3]=libtess.normal.S_UNIT_Y_,d[e]=0,d[(e+1)%3]=0<c[e]?-libtess.normal.S_UNIT_Y_:libtess.normal.S_UNIT_Y_,d[(e+2)%3]=0<c[e]?libtess.normal.S_UNIT_X_:-libtess.normal.S_UNIT_X_);c=f.mesh.vHead;for(e=c.next;e!==c;e=e.next)e.s=libtess.normal.dot_(e.coords,a),e.t=libtess.normal.dot_(e.coords,d);b&&libtess.normal.checkOrientation_(f)};libtess.normal.dot_=function(f,b){return f[0]*b[0]+f[1]*b[1]+f[2]*b[2]};
libtess.normal.normalize_=function(f){var b=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],b=Math.sqrt(b);f[0]/=b;f[1]/=b;f[2]/=b};libtess.normal.longAxis_=function(f){var b=0;Math.abs(f[1])>Math.abs(f[0])&&(b=1);Math.abs(f[2])>Math.abs(f[b])&&(b=2);return b};
libtess.normal.computeNormal_=function(f,b){var c=[-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD],a=[2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD],d=[],e=[],g,h=f.mesh.vHead;for(g=h.next;g!==h;g=g.next)for(var k=0;3>k;++k){var l=g.coords[k];l<a[k]&&(a[k]=l,e[k]=g);l>c[k]&&(c[k]=l,d[k]=g)}g=0;c[1]-a[1]>c[0]-a[0]&&(g=1);c[2]-a[2]>c[g]-a[g]&&(g=2);if(a[g]>=c[g])b[0]=0,b[1]=0,b[2]=1;else{c=0;a=e[g];d=d[g];e=[0,0,0];
    a=[a.coords[0]-d.coords[0],a.coords[1]-d.coords[1],a.coords[2]-d.coords[2]];k=[0,0,0];for(g=h.next;g!==h;g=g.next)k[0]=g.coords[0]-d.coords[0],k[1]=g.coords[1]-d.coords[1],k[2]=g.coords[2]-d.coords[2],e[0]=a[1]*k[2]-a[2]*k[1],e[1]=a[2]*k[0]-a[0]*k[2],e[2]=a[0]*k[1]-a[1]*k[0],l=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],l>c&&(c=l,b[0]=e[0],b[1]=e[1],b[2]=e[2]);0>=c&&(b[0]=b[1]=b[2]=0,b[libtess.normal.longAxis_(a)]=1)}};
libtess.normal.checkOrientation_=function(f){for(var b=0,c=f.mesh.fHead,a=c.next;a!==c;a=a.next){var d=a.anEdge;if(!(0>=d.winding)){do b+=(d.org.s-d.dst().s)*(d.org.t+d.dst().t),d=d.lNext;while(d!==a.anEdge)}}if(0>b){b=f.mesh.vHead;for(c=b.next;c!==b;c=c.next)c.t=-c.t;f.tUnit[0]=-f.tUnit[0];f.tUnit[1]=-f.tUnit[1];f.tUnit[2]=-f.tUnit[2]}};libtess.render={};
libtess.render.renderMesh=function(f,b,c){for(var a=!1,d=-1,e=b.fHead.prev;e!==b.fHead;e=e.prev)if(e.inside){a||(f.callBeginOrBeginData(libtess.primitiveType.GL_TRIANGLES),a=!0);var g=e.anEdge;do{if(c){var h=g.rFace().inside?0:1;d!==h&&(d=h,f.callEdgeFlagOrEdgeFlagData(!!d))}f.callVertexOrVertexData(g.org.data);g=g.lNext}while(g!==e.anEdge)}a&&f.callEndOrEndData()};
libtess.render.renderBoundary=function(f,b){for(var c=b.fHead.next;c!==b.fHead;c=c.next)if(c.inside){f.callBeginOrBeginData(libtess.primitiveType.GL_LINE_LOOP);var a=c.anEdge;do f.callVertexOrVertexData(a.org.data),a=a.lNext;while(a!==c.anEdge);f.callEndOrEndData()}};libtess.sweep={};libtess.sweep.SENTINEL_COORD_=4*libtess.GLU_TESS_MAX_COORD;libtess.sweep.TOLERANCE_NONZERO_=!1;
libtess.sweep.computeInterior=function(f){f.fatalError=!1;libtess.sweep.removeDegenerateEdges_(f);libtess.sweep.initPriorityQ_(f);libtess.sweep.initEdgeDict_(f);for(var b;null!==(b=f.pq.extractMin());){for(;;){var c=f.pq.minimum();if(null===c||!libtess.geom.vertEq(c,b))break;c=f.pq.extractMin();libtess.sweep.spliceMergeVertices_(f,b.anEdge,c.anEdge)}libtess.sweep.sweepEvent_(f,b)}b=f.dict.getMin().getKey();f.event=b.eUp.org;libtess.sweep.doneEdgeDict_(f);libtess.sweep.donePriorityQ_(f);libtess.sweep.removeDegenerateFaces_(f.mesh);
    f.mesh.checkMesh()};libtess.sweep.addWinding_=function(f,b){f.winding+=b.winding;f.sym.winding+=b.sym.winding};
libtess.sweep.edgeLeq_=function(f,b,c){f=f.event;b=b.eUp;c=c.eUp;if(b.dst()===f)return c.dst()===f?libtess.geom.vertLeq(b.org,c.org)?0>=libtess.geom.edgeSign(c.dst(),b.org,c.org):0<=libtess.geom.edgeSign(b.dst(),c.org,b.org):0>=libtess.geom.edgeSign(c.dst(),f,c.org);if(c.dst()===f)return 0<=libtess.geom.edgeSign(b.dst(),f,b.org);b=libtess.geom.edgeEval(b.dst(),f,b.org);f=libtess.geom.edgeEval(c.dst(),f,c.org);return b>=f};
libtess.sweep.deleteRegion_=function(f,b){b.eUp.activeRegion=null;f.dict.deleteNode(b.nodeUp);b.nodeUp=null};libtess.sweep.fixUpperEdge_=function(f,b){libtess.mesh.deleteEdge(f.eUp);f.fixUpperEdge=!1;f.eUp=b;b.activeRegion=f};libtess.sweep.topLeftRegion_=function(f){var b=f.eUp.org;do f=f.regionAbove();while(f.eUp.org===b);f.fixUpperEdge&&(b=libtess.mesh.connect(f.regionBelow().eUp.sym,f.eUp.lNext),libtess.sweep.fixUpperEdge_(f,b),f=f.regionAbove());return f};
libtess.sweep.topRightRegion_=function(f){var b=f.eUp.dst();do f=f.regionAbove();while(f.eUp.dst()===b);return f};libtess.sweep.addRegionBelow_=function(f,b,c){var a=new libtess.ActiveRegion;a.eUp=c;a.nodeUp=f.dict.insertBefore(b.nodeUp,a);return c.activeRegion=a};
libtess.sweep.isWindingInside_=function(f,b){switch(f.windingRule){case libtess.windingRule.GLU_TESS_WINDING_ODD:return 0!==(b&1);case libtess.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==b;case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<b;case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>b;case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=b||-2>=b}return!1};
libtess.sweep.computeWinding_=function(f,b){b.windingNumber=b.regionAbove().windingNumber+b.eUp.winding;b.inside=libtess.sweep.isWindingInside_(f,b.windingNumber)};libtess.sweep.finishRegion_=function(f,b){var c=b.eUp,a=c.lFace;a.inside=b.inside;a.anEdge=c;libtess.sweep.deleteRegion_(f,b)};
libtess.sweep.finishLeftRegions_=function(f,b,c){var a=b;for(b=b.eUp;a!==c;){a.fixUpperEdge=!1;var d=a.regionBelow(),e=d.eUp;if(e.org!==b.org){if(!d.fixUpperEdge){libtess.sweep.finishRegion_(f,a);break}e=libtess.mesh.connect(b.lPrev(),e.sym);libtess.sweep.fixUpperEdge_(d,e)}b.oNext!==e&&(libtess.mesh.meshSplice(e.oPrev(),e),libtess.mesh.meshSplice(b,e));libtess.sweep.finishRegion_(f,a);b=d.eUp;a=d}return b};
libtess.sweep.addRightEdges_=function(f,b,c,a,d,e){var g=!0;do libtess.sweep.addRegionBelow_(f,b,c.sym),c=c.oNext;while(c!==a);for(null===d&&(d=b.regionBelow().eUp.rPrev());;){a=b.regionBelow();c=a.eUp.sym;if(c.org!==d.org)break;c.oNext!==d&&(libtess.mesh.meshSplice(c.oPrev(),c),libtess.mesh.meshSplice(d.oPrev(),c));a.windingNumber=b.windingNumber-c.winding;a.inside=libtess.sweep.isWindingInside_(f,a.windingNumber);b.dirty=!0;!g&&libtess.sweep.checkForRightSplice_(f,b)&&(libtess.sweep.addWinding_(c,
    d),libtess.sweep.deleteRegion_(f,b),libtess.mesh.deleteEdge(d));g=!1;b=a;d=c}b.dirty=!0;e&&libtess.sweep.walkDirtyRegions_(f,b)};libtess.sweep.callCombine_=function(f,b,c,a,d){var e=[b.coords[0],b.coords[1],b.coords[2]];b.data=null;b.data=f.callCombineOrCombineData(e,c,a);null===b.data&&(d?f.fatalError||(f.callErrorOrErrorData(libtess.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),f.fatalError=!0):b.data=c[0])};
libtess.sweep.spliceMergeVertices_=function(f,b,c){var a=[null,null,null,null];a[0]=b.org.data;a[1]=c.org.data;libtess.sweep.callCombine_(f,b.org,a,[.5,.5,0,0],!1);libtess.mesh.meshSplice(b,c)};libtess.sweep.vertexWeights_=function(f,b,c,a,d){var e=libtess.geom.vertL1dist(b,f),g=libtess.geom.vertL1dist(c,f),h=d+1;a[d]=.5*g/(e+g);a[h]=.5*e/(e+g);f.coords[0]+=a[d]*b.coords[0]+a[h]*c.coords[0];f.coords[1]+=a[d]*b.coords[1]+a[h]*c.coords[1];f.coords[2]+=a[d]*b.coords[2]+a[h]*c.coords[2]};
libtess.sweep.getIntersectData_=function(f,b,c,a,d,e){var g=[0,0,0,0],h=[c.data,a.data,d.data,e.data];b.coords[0]=b.coords[1]=b.coords[2]=0;libtess.sweep.vertexWeights_(b,c,a,g,0);libtess.sweep.vertexWeights_(b,d,e,g,2);libtess.sweep.callCombine_(f,b,h,g,!0)};
libtess.sweep.checkForRightSplice_=function(f,b){var c=b.regionBelow(),a=b.eUp,d=c.eUp;if(libtess.geom.vertLeq(a.org,d.org)){if(0<libtess.geom.edgeSign(d.dst(),a.org,d.org))return!1;libtess.geom.vertEq(a.org,d.org)?a.org!==d.org&&(f.pq.remove(a.org.pqHandle),libtess.sweep.spliceMergeVertices_(f,d.oPrev(),a)):(libtess.mesh.splitEdge(d.sym),libtess.mesh.meshSplice(a,d.oPrev()),b.dirty=c.dirty=!0)}else{if(0>libtess.geom.edgeSign(a.dst(),d.org,a.org))return!1;b.regionAbove().dirty=b.dirty=!0;libtess.mesh.splitEdge(a.sym);
    libtess.mesh.meshSplice(d.oPrev(),a)}return!0};
libtess.sweep.checkForLeftSplice_=function(f,b){var c=b.regionBelow(),a=b.eUp,d=c.eUp;if(libtess.geom.vertLeq(a.dst(),d.dst())){if(0>libtess.geom.edgeSign(a.dst(),d.dst(),a.org))return!1;b.regionAbove().dirty=b.dirty=!0;c=libtess.mesh.splitEdge(a);libtess.mesh.meshSplice(d.sym,c);c.lFace.inside=b.inside}else{if(0<libtess.geom.edgeSign(d.dst(),a.dst(),d.org))return!1;b.dirty=c.dirty=!0;c=libtess.mesh.splitEdge(d);libtess.mesh.meshSplice(a.lNext,d.sym);c.rFace().inside=b.inside}return!0};
libtess.sweep.checkForIntersect_=function(f,b){var c=b.regionBelow(),a=b.eUp,d=c.eUp,e=a.org,g=d.org,h=a.dst(),k=d.dst(),l=new libtess.GluVertex;if(e===g||Math.min(e.t,h.t)>Math.max(g.t,k.t))return!1;if(libtess.geom.vertLeq(e,g)){if(0<libtess.geom.edgeSign(k,e,g))return!1}else if(0>libtess.geom.edgeSign(h,g,e))return!1;libtess.geom.edgeIntersect(h,e,k,g,l);libtess.geom.vertLeq(l,f.event)&&(l.s=f.event.s,l.t=f.event.t);var m=libtess.geom.vertLeq(e,g)?e:g;libtess.geom.vertLeq(m,l)&&(l.s=m.s,l.t=m.t);
    if(libtess.geom.vertEq(l,e)||libtess.geom.vertEq(l,g))return libtess.sweep.checkForRightSplice_(f,b),!1;if(!libtess.geom.vertEq(h,f.event)&&0<=libtess.geom.edgeSign(h,f.event,l)||!libtess.geom.vertEq(k,f.event)&&0>=libtess.geom.edgeSign(k,f.event,l)){if(k===f.event)return libtess.mesh.splitEdge(a.sym),libtess.mesh.meshSplice(d.sym,a),b=libtess.sweep.topLeftRegion_(b),a=b.regionBelow().eUp,libtess.sweep.finishLeftRegions_(f,b.regionBelow(),c),libtess.sweep.addRightEdges_(f,b,a.oPrev(),a,a,!0),!0;if(h===
        f.event)return libtess.mesh.splitEdge(d.sym),libtess.mesh.meshSplice(a.lNext,d.oPrev()),c=b,b=libtess.sweep.topRightRegion_(b),e=b.regionBelow().eUp.rPrev(),c.eUp=d.oPrev(),d=libtess.sweep.finishLeftRegions_(f,c,null),libtess.sweep.addRightEdges_(f,b,d.oNext,a.rPrev(),e,!0),!0;0<=libtess.geom.edgeSign(h,f.event,l)&&(b.regionAbove().dirty=b.dirty=!0,libtess.mesh.splitEdge(a.sym),a.org.s=f.event.s,a.org.t=f.event.t);0>=libtess.geom.edgeSign(k,f.event,l)&&(b.dirty=c.dirty=!0,libtess.mesh.splitEdge(d.sym),
        d.org.s=f.event.s,d.org.t=f.event.t);return!1}libtess.mesh.splitEdge(a.sym);libtess.mesh.splitEdge(d.sym);libtess.mesh.meshSplice(d.oPrev(),a);a.org.s=l.s;a.org.t=l.t;a.org.pqHandle=f.pq.insert(a.org);libtess.sweep.getIntersectData_(f,a.org,e,h,g,k);b.regionAbove().dirty=b.dirty=c.dirty=!0;return!1};
libtess.sweep.walkDirtyRegions_=function(f,b){for(var c=b.regionBelow();;){for(;c.dirty;)b=c,c=c.regionBelow();if(!b.dirty&&(c=b,b=b.regionAbove(),null===b||!b.dirty))break;b.dirty=!1;var a=b.eUp,d=c.eUp;a.dst()!==d.dst()&&libtess.sweep.checkForLeftSplice_(f,b)&&(c.fixUpperEdge?(libtess.sweep.deleteRegion_(f,c),libtess.mesh.deleteEdge(d),c=b.regionBelow(),d=c.eUp):b.fixUpperEdge&&(libtess.sweep.deleteRegion_(f,b),libtess.mesh.deleteEdge(a),b=c.regionAbove(),a=b.eUp));if(a.org!==d.org)if(a.dst()===
    d.dst()||b.fixUpperEdge||c.fixUpperEdge||a.dst()!==f.event&&d.dst()!==f.event)libtess.sweep.checkForRightSplice_(f,b);else if(libtess.sweep.checkForIntersect_(f,b))break;a.org===d.org&&a.dst()===d.dst()&&(libtess.sweep.addWinding_(d,a),libtess.sweep.deleteRegion_(f,b),libtess.mesh.deleteEdge(a),b=c.regionAbove())}};
libtess.sweep.connectRightVertex_=function(f,b,c){var a=c.oNext,d=b.regionBelow(),e=b.eUp,g=d.eUp,h=!1;e.dst()!==g.dst()&&libtess.sweep.checkForIntersect_(f,b);libtess.geom.vertEq(e.org,f.event)&&(libtess.mesh.meshSplice(a.oPrev(),e),b=libtess.sweep.topLeftRegion_(b),a=b.regionBelow().eUp,libtess.sweep.finishLeftRegions_(f,b.regionBelow(),d),h=!0);libtess.geom.vertEq(g.org,f.event)&&(libtess.mesh.meshSplice(c,g.oPrev()),c=libtess.sweep.finishLeftRegions_(f,d,null),h=!0);h?libtess.sweep.addRightEdges_(f,
    b,c.oNext,a,a,!0):(a=libtess.geom.vertLeq(g.org,e.org)?g.oPrev():e,a=libtess.mesh.connect(c.lPrev(),a),libtess.sweep.addRightEdges_(f,b,a,a.oNext,a.oNext,!1),a.sym.activeRegion.fixUpperEdge=!0,libtess.sweep.walkDirtyRegions_(f,b))};
libtess.sweep.connectLeftDegenerate_=function(f,b,c){var a=b.eUp;if(libtess.geom.vertEq(a.org,c))libtess.sweep.TOLERANCE_NONZERO_&&libtess.sweep.spliceMergeVertices_(f,a,c.anEdge);else if(!libtess.geom.vertEq(a.dst(),c))libtess.mesh.splitEdge(a.sym),b.fixUpperEdge&&(libtess.mesh.deleteEdge(a.oNext),b.fixUpperEdge=!1),libtess.mesh.meshSplice(c.anEdge,a),libtess.sweep.sweepEvent_(f,c);else if(libtess.sweep.TOLERANCE_NONZERO_){b=libtess.sweep.topRightRegion_(b);var a=b.regionBelow(),d=a.eUp.sym,e=d.oNext,
    g=e;a.fixUpperEdge&&(libtess.sweep.deleteRegion_(f,a),libtess.mesh.deleteEdge(d),d=e.oPrev());libtess.mesh.meshSplice(c.anEdge,d);libtess.geom.edgeGoesLeft(e)||(e=null);libtess.sweep.addRightEdges_(f,b,d.oNext,g,e,!0)}};
libtess.sweep.connectLeftVertex_=function(f,b){var c=new libtess.ActiveRegion;c.eUp=b.anEdge.sym;var c=f.dict.search(c).getKey(),a=c.regionBelow(),d=c.eUp,e=a.eUp;0===libtess.geom.edgeSign(d.dst(),b,d.org)?libtess.sweep.connectLeftDegenerate_(f,c,b):(a=libtess.geom.vertLeq(e.dst(),d.dst())?c:a,c.inside||a.fixUpperEdge?(d=a===c?libtess.mesh.connect(b.anEdge.sym,d.lNext):libtess.mesh.connect(e.dNext(),b.anEdge).sym,a.fixUpperEdge?libtess.sweep.fixUpperEdge_(a,d):libtess.sweep.computeWinding_(f,libtess.sweep.addRegionBelow_(f,
    c,d)),libtess.sweep.sweepEvent_(f,b)):libtess.sweep.addRightEdges_(f,c,b.anEdge,b.anEdge,null,!0))};libtess.sweep.sweepEvent_=function(f,b){f.event=b;for(var c=b.anEdge;null===c.activeRegion;)if(c=c.oNext,c===b.anEdge){libtess.sweep.connectLeftVertex_(f,b);return}var c=libtess.sweep.topLeftRegion_(c.activeRegion),a=c.regionBelow(),d=a.eUp,a=libtess.sweep.finishLeftRegions_(f,a,null);a.oNext===d?libtess.sweep.connectRightVertex_(f,c,a):libtess.sweep.addRightEdges_(f,c,a.oNext,d,d,!0)};
libtess.sweep.addSentinel_=function(f,b){var c=new libtess.ActiveRegion,a=libtess.mesh.makeEdge(f.mesh);a.org.s=libtess.sweep.SENTINEL_COORD_;a.org.t=b;a.dst().s=-libtess.sweep.SENTINEL_COORD_;a.dst().t=b;f.event=a.dst();c.eUp=a;c.windingNumber=0;c.inside=!1;c.fixUpperEdge=!1;c.sentinel=!0;c.dirty=!1;c.nodeUp=f.dict.insert(c)};
libtess.sweep.initEdgeDict_=function(f){f.dict=new libtess.Dict(f,libtess.sweep.edgeLeq_);libtess.sweep.addSentinel_(f,-libtess.sweep.SENTINEL_COORD_);libtess.sweep.addSentinel_(f,libtess.sweep.SENTINEL_COORD_)};libtess.sweep.doneEdgeDict_=function(f){for(var b;null!==(b=f.dict.getMin().getKey());)libtess.sweep.deleteRegion_(f,b);f.dict=null};
libtess.sweep.removeDegenerateEdges_=function(f){for(var b=f.mesh.eHead,c,a=b.next;a!==b;a=c){c=a.next;var d=a.lNext;libtess.geom.vertEq(a.org,a.dst())&&a.lNext.lNext!==a&&(libtess.sweep.spliceMergeVertices_(f,d,a),libtess.mesh.deleteEdge(a),a=d,d=a.lNext);if(d.lNext===a){if(d!==a){if(d===c||d===c.sym)c=c.next;libtess.mesh.deleteEdge(d)}if(a===c||a===c.sym)c=c.next;libtess.mesh.deleteEdge(a)}}};
libtess.sweep.initPriorityQ_=function(f){var b=new libtess.PriorityQ(libtess.geom.vertLeq);f.pq=b;f=f.mesh.vHead;var c;for(c=f.next;c!==f;c=c.next)c.pqHandle=b.insert(c);b.init()};libtess.sweep.donePriorityQ_=function(f){f.pq.deleteQ();f.pq=null};libtess.sweep.removeDegenerateFaces_=function(f){for(var b,c=f.fHead.next;c!==f.fHead;c=b)b=c.next,c=c.anEdge,c.lNext.lNext===c&&(libtess.sweep.addWinding_(c.oNext,c),libtess.mesh.deleteEdge(c))};libtess.tessmono={};
libtess.tessmono.tessellateMonoRegion_=function(f){for(f=f.anEdge;libtess.geom.vertLeq(f.dst(),f.org);f=f.lPrev());for(;libtess.geom.vertLeq(f.org,f.dst());f=f.lNext);for(var b=f.lPrev(),c;f.lNext!==b;)if(libtess.geom.vertLeq(f.dst(),b.org)){for(;b.lNext!==f&&(libtess.geom.edgeGoesLeft(b.lNext)||0>=libtess.geom.edgeSign(b.org,b.dst(),b.lNext.dst()));)c=libtess.mesh.connect(b.lNext,b),b=c.sym;b=b.lPrev()}else{for(;b.lNext!==f&&(libtess.geom.edgeGoesRight(f.lPrev())||0<=libtess.geom.edgeSign(f.dst(),
    f.org,f.lPrev().org));)c=libtess.mesh.connect(f,f.lPrev()),f=c.sym;f=f.lNext}for(;b.lNext.lNext!==f;)c=libtess.mesh.connect(b.lNext,b),b=c.sym};libtess.tessmono.tessellateInterior=function(f){for(var b,c=f.fHead.next;c!==f.fHead;c=b)b=c.next,c.inside&&libtess.tessmono.tessellateMonoRegion_(c)};libtess.tessmono.discardExterior=function(f){for(var b,c=f.fHead.next;c!==f.fHead;c=b)b=c.next,c.inside||libtess.mesh.zapFace(c)};
libtess.tessmono.setWindingNumber=function(f,b,c){for(var a,d=f.eHead.next;d!==f.eHead;d=a)a=d.next,d.rFace().inside!==d.lFace.inside?d.winding=d.lFace.inside?b:-b:c?libtess.mesh.deleteEdge(d):d.winding=0};libtess.Dict=function(f,b){this.head_=new libtess.DictNode;this.frame_=f;this.leq_=b};libtess.Dict.prototype.deleteDict_=function(){};
libtess.Dict.prototype.insertBefore=function(f,b){do f=f.prev;while(null!==f.key&&!this.leq_(this.frame_,f.key,b));var c=new libtess.DictNode(b,f.next,f);f.next.prev=c;return f.next=c};libtess.Dict.prototype.insert=function(f){return this.insertBefore(this.head_,f)};libtess.Dict.prototype.deleteNode=function(f){f.next.prev=f.prev;f.prev.next=f.next};libtess.Dict.prototype.search=function(f){var b=this.head_;do b=b.next;while(null!==b.key&&!this.leq_(this.frame_,f,b.key));return b};
libtess.Dict.prototype.getMin=function(){return this.head_.next};libtess.Dict.prototype.getMax=function(){return this.head_.prev};libtess.DictNode=function(f,b,c){this.key=f||null;this.next=b||this;this.prev=c||this};libtess.DictNode.prototype.getKey=function(){return this.key};libtess.DictNode.prototype.getSuccessor=function(){return this.next};libtess.DictNode.prototype.getPredecessor=function(){return this.prev};libtess.CachedVertex=function(){this.coords=[0,0,0];this.data=null};
libtess.GluTesselator=function(){this.state=libtess.GluTesselator.tessState_.T_DORMANT;this.callError_=this.mesh=this.lastEdge_=null;this.normal=[0,0,0];this.sUnit=[0,0,0];this.tUnit=[0,0,0];this.relTolerance=libtess.GLU_TESS_DEFAULT_TOLERANCE;this.windingRule=libtess.windingRule.GLU_TESS_WINDING_ODD;this.fatalError=!1;this.callCombine_=this.event=this.pq=this.dict=null;this.boundaryOnly=!1;this.polygonData_=this.callCombineData_=this.callErrorData_=this.callEndData_=this.callVertexData_=this.callEdgeFlagData_=
    this.callBeginData_=this.callMesh_=this.callEnd_=this.callVertex_=this.callEdgeFlag_=this.callBegin_=null;this.emptyCache=!1;this.cacheCount=0;this.cache=Array(libtess.TESS_MAX_CACHE);for(var f=0;f<libtess.TESS_MAX_CACHE;f++)this.cache[f]=new libtess.CachedVertex};libtess.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};libtess.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT)};
libtess.GluTesselator.prototype.gluTessProperty=function(f,b){switch(f){case libtess.gluEnum.GLU_TESS_TOLERANCE:if(0>b||1<b)break;this.relTolerance=b;return;case libtess.gluEnum.GLU_TESS_WINDING_RULE:switch(b){case libtess.windingRule.GLU_TESS_WINDING_ODD:case libtess.windingRule.GLU_TESS_WINDING_NONZERO:case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=b;return}break;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly=
    !!b;return;default:this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM);return}this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_VALUE)};libtess.GluTesselator.prototype.gluGetTessProperty=function(f){switch(f){case libtess.gluEnum.GLU_TESS_TOLERANCE:return this.relTolerance;case libtess.gluEnum.GLU_TESS_WINDING_RULE:return this.windingRule;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return this.boundaryOnly;default:this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM)}return!1};
libtess.GluTesselator.prototype.gluTessNormal=function(f,b,c){this.normal[0]=f;this.normal[1]=b;this.normal[2]=c};
libtess.GluTesselator.prototype.gluTessCallback=function(f,b){var c=b?b:null;switch(f){case libtess.gluEnum.GLU_TESS_BEGIN:this.callBegin_=c;break;case libtess.gluEnum.GLU_TESS_BEGIN_DATA:this.callBeginData_=c;break;case libtess.gluEnum.GLU_TESS_EDGE_FLAG:this.callEdgeFlag_=c;break;case libtess.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.callEdgeFlagData_=c;break;case libtess.gluEnum.GLU_TESS_VERTEX:this.callVertex_=c;break;case libtess.gluEnum.GLU_TESS_VERTEX_DATA:this.callVertexData_=c;break;case libtess.gluEnum.GLU_TESS_END:this.callEnd_=
    c;break;case libtess.gluEnum.GLU_TESS_END_DATA:this.callEndData_=c;break;case libtess.gluEnum.GLU_TESS_ERROR:this.callError_=c;break;case libtess.gluEnum.GLU_TESS_ERROR_DATA:this.callErrorData_=c;break;case libtess.gluEnum.GLU_TESS_COMBINE:this.callCombine_=c;break;case libtess.gluEnum.GLU_TESS_COMBINE_DATA:this.callCombineData_=c;break;case libtess.gluEnum.GLU_TESS_MESH:this.callMesh_=c;break;default:this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM)}};
libtess.GluTesselator.prototype.gluTessVertex=function(f,b){var c=!1,a=[0,0,0];this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);this.emptyCache&&(this.emptyCache_(),this.lastEdge_=null);for(var d=0;3>d;++d){var e=f[d];e<-libtess.GLU_TESS_MAX_COORD&&(e=-libtess.GLU_TESS_MAX_COORD,c=!0);e>libtess.GLU_TESS_MAX_COORD&&(e=libtess.GLU_TESS_MAX_COORD,c=!0);a[d]=e}c&&this.callErrorOrErrorData(libtess.errorType.GLU_TESS_COORD_TOO_LARGE);if(null===this.mesh){if(this.cacheCount<libtess.TESS_MAX_CACHE){this.cacheVertex_(a,
    b);return}this.emptyCache_()}this.addVertex_(a,b)};libtess.GluTesselator.prototype.gluTessBeginPolygon=function(f){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT);this.state=libtess.GluTesselator.tessState_.T_IN_POLYGON;this.cacheCount=0;this.emptyCache=!1;this.mesh=null;this.polygonData_=f};
libtess.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON);this.state=libtess.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null;0<this.cacheCount&&(this.emptyCache=!0)};libtess.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);this.state=libtess.GluTesselator.tessState_.T_IN_POLYGON};
libtess.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON);this.state=libtess.GluTesselator.tessState_.T_DORMANT;null===this.mesh&&this.emptyCache_();libtess.normal.projectPolygon(this);libtess.sweep.computeInterior(this);if(!this.fatalError){var f=this.mesh;this.boundaryOnly?libtess.tessmono.setWindingNumber(f,1,!0):libtess.tessmono.tessellateInterior(f);this.mesh.checkMesh();if(this.callBegin_||this.callEnd_||this.callVertex_||
    this.callEdgeFlag_||this.callBeginData_||this.callEndData_||this.callVertexData_||this.callEdgeFlagData_)this.boundaryOnly?libtess.render.renderBoundary(this,this.mesh):libtess.render.renderMesh(this,this.mesh,!(!this.callEdgeFlag_&&!this.callEdgeFlagData_));if(this.callMesh_){libtess.tessmono.discardExterior(this.mesh);this.callMesh_(this.mesh);this.polygonData_=this.mesh=null;return}}libtess.mesh.deleteMesh(this.mesh);this.mesh=this.polygonData_=null};
libtess.GluTesselator.prototype.makeDormant_=function(){this.mesh&&libtess.mesh.deleteMesh(this.mesh);this.state=libtess.GluTesselator.tessState_.T_DORMANT;this.mesh=this.lastEdge_=null};libtess.GluTesselator.prototype.requireState_=function(f){this.state!==f&&this.gotoState_(f)};
libtess.GluTesselator.prototype.gotoState_=function(f){for(;this.state!==f;)if(this.state<f)switch(this.state){case libtess.GluTesselator.tessState_.T_DORMANT:this.callErrorOrErrorData(libtess.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);this.gluTessBeginPolygon(null);break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(libtess.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state){case libtess.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorOrErrorData(libtess.errorType.GLU_TESS_MISSING_END_CONTOUR);
    this.gluTessEndContour();break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(libtess.errorType.GLU_TESS_MISSING_END_POLYGON),this.makeDormant_()}};libtess.GluTesselator.prototype.addVertex_=function(f,b){var c=this.lastEdge_;null===c?(c=libtess.mesh.makeEdge(this.mesh),libtess.mesh.meshSplice(c,c.sym)):(libtess.mesh.splitEdge(c),c=c.lNext);c.org.data=b;c.org.coords[0]=f[0];c.org.coords[1]=f[1];c.org.coords[2]=f[2];c.winding=1;c.sym.winding=-1;this.lastEdge_=c};
libtess.GluTesselator.prototype.cacheVertex_=function(f,b){var c=this.cache[this.cacheCount];c.data=b;c.coords[0]=f[0];c.coords[1]=f[1];c.coords[2]=f[2];++this.cacheCount};libtess.GluTesselator.prototype.emptyCache_=function(){this.mesh=new libtess.GluMesh;for(var f=0;f<this.cacheCount;f++){var b=this.cache[f];this.addVertex_(b.coords,b.data)}this.cacheCount=0;this.emptyCache=!1};
libtess.GluTesselator.prototype.callBeginOrBeginData=function(f){this.callBeginData_?this.callBeginData_(f,this.polygonData_):this.callBegin_&&this.callBegin_(f)};libtess.GluTesselator.prototype.callVertexOrVertexData=function(f){this.callVertexData_?this.callVertexData_(f,this.polygonData_):this.callVertex_&&this.callVertex_(f)};libtess.GluTesselator.prototype.callEdgeFlagOrEdgeFlagData=function(f){this.callEdgeFlagData_?this.callEdgeFlagData_(f,this.polygonData_):this.callEdgeFlag_&&this.callEdgeFlag_(f)};
libtess.GluTesselator.prototype.callEndOrEndData=function(){this.callEndData_?this.callEndData_(this.polygonData_):this.callEnd_&&this.callEnd_()};libtess.GluTesselator.prototype.callCombineOrCombineData=function(f,b,c){var a;this.callCombineData_?a=this.callCombineData_(f,b,c,this.polygonData_):this.callCombine_&&(a=this.callCombine_(f,b,c));void 0===a&&(a=null);return a};
libtess.GluTesselator.prototype.callErrorOrErrorData=function(f){this.callErrorData_?this.callErrorData_(f,this.polygonData_):this.callError_&&this.callError_(f)};libtess.GluFace=function(f,b){this.next=f||this;this.prev=b||this;this.data=this.anEdge=null;this.inside=!1};libtess.GluHalfEdge=function(f){this.next=f||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};libtess.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};
libtess.GluHalfEdge.prototype.dst=function(){return this.sym.org};libtess.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};libtess.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};libtess.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};libtess.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};libtess.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};libtess.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};
libtess.GluMesh=function(){this.vHead=new libtess.GluVertex;this.fHead=new libtess.GluFace;this.eHead=new libtess.GluHalfEdge;this.eHeadSym=new libtess.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};
libtess.GluMesh.prototype.checkMesh=function(){if(libtess.DEBUG){var f=this.fHead,b=this.vHead,c=this.eHead,a,d;for(a=f;(d=a.next)!==f;a=d){a=d.anEdge;do a=a.lNext;while(a!==d.anEdge)}for(f=b;(f=f.next)!==b;){a=f.anEdge;do a=a.oNext;while(a!==f.anEdge)}for(b=c;(a=b.next)!==c;b=a);}};libtess.GluVertex=function(f,b){this.next=f||this;this.prev=b||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.t=this.s=0;this.pqHandle=null};libtess.PQHandleElem=function(){this.key=null;this.node=0};
libtess.PQHandleElem.realloc=function(f,b){var c=Array(b),a=0;if(null!==f)for(;a<f.length;a++)c[a]=f[a];for(;a<b;a++)c[a]=new libtess.PQHandleElem;return c};libtess.PQNode=function(){this.handle=0};libtess.PQNode.realloc=function(f,b){var c=Array(b),a=0;if(null!==f)for(;a<f.length;a++)c[a]=f[a];for(;a<b;a++)c[a]=new libtess.PQNode;return c};
libtess.PriorityQ=function(f){this.keys_=libtess.PriorityQ.prototype.PQKeyRealloc_(null,libtess.PriorityQ.INIT_SIZE_);this.order_=null;this.size_=0;this.max_=libtess.PriorityQ.INIT_SIZE_;this.initialized_=!1;this.leq_=f;this.heap_=new libtess.PriorityQHeap(this.leq_)};libtess.PriorityQ.INIT_SIZE_=32;libtess.PriorityQ.prototype.deleteQ=function(){this.heap_.deleteHeap();this.keys_=this.order_=this.heap_=null};
libtess.PriorityQ.prototype.init=function(){this.order_=[];for(var f=0;f<this.size_;f++)this.order_[f]=f;f=function(b,a){return function(d,e){return a(b[d],b[e])?1:-1}}(this.keys_,this.leq_);this.order_.sort(f);this.max_=this.size_;this.initialized_=!0;this.heap_.init();if(libtess.DEBUG)for(var b=0+this.size_-1,f=0;f<b;++f);};
libtess.PriorityQ.prototype.insert=function(f){if(this.initialized_)return this.heap_.insert(f);var b=this.size_;++this.size_>=this.max_&&(this.max_*=2,this.keys_=libtess.PriorityQ.prototype.PQKeyRealloc_(this.keys_,this.max_));this.keys_[b]=f;return-(b+1)};libtess.PriorityQ.prototype.PQKeyRealloc_=function(f,b){var c=Array(b),a=0;if(null!==f)for(;a<f.length;a++)c[a]=f[a];for(;a<b;a++)c[a]=null;return c};libtess.PriorityQ.prototype.keyLessThan_=function(f,b){return!this.leq_(this.keys_[b],this.keys_[f])};
libtess.PriorityQ.prototype.keyGreaterThan_=function(f,b){return!this.leq_(this.keys_[f],this.keys_[b])};libtess.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var f=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var b=this.heap_.minimum();if(this.leq_(b,f))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&null===this.keys_[this.order_[this.size_-1]]);return f};
libtess.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var f=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var b=this.heap_.minimum();if(this.leq_(b,f))return b}return f};libtess.PriorityQ.prototype.isEmpty_=function(){return 0===this.size_&&this.heap_.isEmpty()};libtess.PriorityQ.prototype.remove=function(f){if(0<=f)this.heap_.remove(f);else for(this.keys_[-(f+1)]=null;0<this.size_&&null===this.keys_[this.order_[this.size_-1]];)--this.size_};
libtess.PriorityQHeap=function(f){this.nodes_=libtess.PQNode.realloc(null,libtess.PriorityQHeap.INIT_SIZE_+1);this.handles_=libtess.PQHandleElem.realloc(null,libtess.PriorityQHeap.INIT_SIZE_+1);this.size_=0;this.max_=libtess.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.leq_=f;this.nodes_[1].handle=1};libtess.PriorityQHeap.INIT_SIZE_=32;libtess.PriorityQHeap.prototype.deleteHeap=function(){this.nodes_=this.handles_=null};
libtess.PriorityQHeap.prototype.init=function(){for(var f=this.size_;1<=f;--f)this.floatDown_(f);this.initialized_=!0};
libtess.PriorityQHeap.prototype.insert=function(f){var b=++this.size_;2*b>this.max_&&(this.max_*=2,this.nodes_=libtess.PQNode.realloc(this.nodes_,this.max_+1),this.handles_=libtess.PQHandleElem.realloc(this.handles_,this.max_+1));var c;0===this.freeList_?c=b:(c=this.freeList_,this.freeList_=this.handles_[c].node);this.nodes_[b].handle=c;this.handles_[c].node=b;this.handles_[c].key=f;this.initialized_&&this.floatUp_(b);return c};libtess.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};
libtess.PriorityQHeap.prototype.minimum=function(){return this.handles_[this.nodes_[1].handle].key};libtess.PriorityQHeap.prototype.extractMin=function(){var f=this.nodes_,b=this.handles_,c=f[1].handle,a=b[c].key;0<this.size_&&(f[1].handle=f[this.size_].handle,b[f[1].handle].node=1,b[c].key=null,b[c].node=this.freeList_,this.freeList_=c,0<--this.size_&&this.floatDown_(1));return a};
libtess.PriorityQHeap.prototype.remove=function(f){var b=this.nodes_,c=this.handles_,a=c[f].node;b[a].handle=b[this.size_].handle;c[b[a].handle].node=a;a<=--this.size_&&(1>=a||this.leq_(c[b[a>>1].handle].key,c[b[a].handle].key)?this.floatDown_(a):this.floatUp_(a));c[f].key=null;c[f].node=this.freeList_;this.freeList_=f};
libtess.PriorityQHeap.prototype.floatDown_=function(f){for(var b=this.nodes_,c=this.handles_,a=b[f].handle;;){var d=f<<1;d<this.size_&&this.leq_(c[b[d+1].handle].key,c[b[d].handle].key)&&++d;var e=b[d].handle;if(d>this.size_||this.leq_(c[a].key,c[e].key)){b[f].handle=a;c[a].node=f;break}b[f].handle=e;c[e].node=f;f=d}};
libtess.PriorityQHeap.prototype.floatUp_=function(f){for(var b=this.nodes_,c=this.handles_,a=b[f].handle;;){var d=f>>1,e=b[d].handle;if(0===d||this.leq_(c[e].key,c[a].key)){b[f].handle=a;c[a].node=f;break}b[f].handle=e;c[e].node=f;f=d}};libtess.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};libtess.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};
libtess.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};"undefined"!==typeof module&&(module.exports=libtess);define("src/util/libtess",function(){});
define("src/shapes/Polygon","../shapes/AbstractShape ../error/ArgumentError ../shaders/BasicTextureProgram ../geom/BoundingBox ../util/Color ../util/ImageSource ../geom/Location ../util/Logger ../geom/Matrix ../pick/PickedObject ../geom/Position ../shapes/ShapeAttributes ../shapes/SurfacePolygon ../geom/Vec2 ../geom/Vec3 ../util/libtess".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t,r,u){d=function(a,c){if(!a)throw new b(h.logMessage(h.LEVEL_SEVERE,"Polygon","constructor","missingBoundaries"));
    f.call(this,c);0<a.length&&a[0].latitude&&(a=[a],this._boundariesSpecifiedSimply=!0);this._boundaries=a;this._textureCoordinates=null;this.referencePosition=this.determineReferencePosition(this._boundaries);this._extrude=!1;this.scratchPoint=new r(0,0,0)};d.prototype=Object.create(f.prototype);Object.defineProperties(d.prototype,{boundaries:{get:function(){return this._boundariesSpecifiedSimply?this._boundaries[0]:this._boundaries},set:function(a){if(!a)throw new b(h.logMessage(h.LEVEL_SEVERE,"Polygon",
    "boundaries","missingBoundaries"));0<a.length&&a[0].latitude&&(a=[a],this._boundariesSpecifiedSimply=!0);this._boundaries=a;this.referencePosition=this.determineReferencePosition(this._boundaries);this.reset()}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(a){this._textureCoordinates=a;this.reset()}},extrude:{get:function(){return this._extrude},set:function(a){this._extrude=a;this.reset()}}});d.prototype.determineReferencePosition=function(a){return 0<a.length&&
2<a[0].length?a[0][0]:null};d.prototype.mustGenerateGeometry=function(a){return this.currentData.boundaryPoints&&this.currentData.drawInterior===this.activeAttributes.drawInterior?this.altitudeMode===WorldWind.ABSOLUTE?!1:this.currentData.isExpired:!0};d.prototype.hasCapTexture=function(){return this.textureCoordinates&&this.capImageSource()};d.prototype.capImageSource=function(){return this.activeAttributes.imageSource?"string"===typeof this.activeAttributes.imageSource||this.activeAttributes.imageSource instanceof
e?this.activeAttributes.imageSource:Array.isArray(this.activeAttributes.imageSource)&&this.activeAttributes.imageSource[0]&&("string"===typeof this.activeAttributes.imageSource[0]||this.activeAttributes.imageSource instanceof e)?this.activeAttributes.imageSource[0]:null:null};d.prototype.hasSideTextures=function(){return this.activeAttributes.imageSource&&Array.isArray(this.activeAttributes.imageSource)&&1<this.activeAttributes.imageSource.length};d.prototype.sideImageSource=function(a){if(0===a||
    2===this.activeAttributes.imageSource.length)return this.activeAttributes.imageSource[1];a=Math.min(a+1,this.activeAttributes.imageSource.length-1);return this.activeAttributes.imageSource[a]};d.prototype.createSurfaceShape=function(){return new q(this.boundaries,null)};d.prototype.doMakeOrderedRenderable=function(b){if(!this.referencePosition||!this.activeAttributes.drawInterior&&!this.activeAttributes.drawOutline)return null;if(!this.mustGenerateGeometry(b))return this;var c=this.currentData,d=
    c.referencePoint;b.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude,this._altitudeMode,d);c.transformationMatrix.setToTranslation(d[0],d[1],d[2]);for(var d=[],e=0;e<this._boundaries.length;e++)d[e]=this._boundaries[e].slice(0),d[e].push(this._boundaries[e][0]);d=this.computeBoundaryPoints(b,d);if(this.activeAttributes.drawInterior&&(e=this.tessellatePolygon(b,d))){c.capTriangles=new Float32Array(e.length);b=0;for(var g=e.length;b<
g;b++)c.capTriangles[b]=e[b]}c.boundaryPoints=d;c.drawInterior=this.activeAttributes.drawInterior;this.resetExpiration(c);c.refreshBuffers=!0;c.extent||(c.extent=new a);if(1===d.length)c.extent.setToPoints(d[0]);else{b=[];for(e=0;e<d.length;e++)for(g=0;g<d[e].length;g++)b.push(d[e][g]);c.extent.setToPoints(b)}c.extent.translate(c.referencePoint);return this};d.prototype.computeBoundaryPoints=function(a,b){for(var c=Number.MAX_VALUE,d=a.navigatorState.eyePoint,e=[],g=this._extrude?6:3,h=new r(0,0,
    0),f,k,l,m=0;m<b.length;m++){f=(this._extrude?2:1)*b[m].length;e[m]=new Float32Array(3*f);for(var q=0,p=b[m].length;q<p;q++)f=b[m][q],a.surfacePointForMode(f.latitude,f.longitude,f.altitude,this.altitudeMode,h),l=h.distanceToSquared(d),l<c&&(c=l),h.subtract(this.currentData.referencePoint),k=g*q,e[m][k]=h[0],e[m][k+1]=h[1],e[m][k+2]=h[2],this._extrude&&(a.surfacePointForMode(f.latitude,f.longitude,0,WorldWind.CLAMP_TO_GROUND,h),l=h.distanceToSquared(d),l<c&&(c=l),h.subtract(this.currentData.referencePoint),
    e[m][k+3]=h[0],e[m][k+4]=h[1],e[m][k+5]=h[2])}this.currentData.eyeDistance=Math.sqrt(c);return e};d.prototype.tessellatePolygon=function(a,b){var c=[],d=0,e=this._extrude?6:3,g=this.hasCapTexture(),f;this.polygonTessellator||(this.polygonTessellator=new libtess.GluTesselator,this.polygonTessellator.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,function(a,b){b[b.length]=a[0];b[b.length]=a[1];b[b.length]=a[2];g&&(b[b.length]=a[3],b[b.length]=a[4])}),this.polygonTessellator.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE,
    function(a,b,c){a=[a[0],a[1],a[2]];if(g)for(var d=3;4>=d;d++){for(var e=0,h=0;4>h;h++)0<c[h]&&(e+=c[h]*b[h][d]);a[d]=e}return a}),this.polygonTessellator.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,function(a){d=a;h.logMessage(h.LEVEL_WARNING,"Polygon","tessellatePolygon","Tessellation error "+a+".")}));f=r.computeBufferNormal(b[0],e);f||(f=new r(0,0,0),a.globe.surfaceNormalAtLocation(this.referencePosition.latitude,this.referencePosition.longitude,f));this.polygonTessellator.gluTessNormal(f[0],
    f[1],f[2]);this.currentData.capNormal=f;this.polygonTessellator.gluTessBeginPolygon(c);for(var k=0;k<b.length;k++){var l=0;this.polygonTessellator.gluTessBeginContour();for(var m=b[k],q=0;q<m.length;q+=e)f=[m[q],m[q+1],m[q+2]],g&&(l<this.textureCoordinates[k].length?(f[3]=this.textureCoordinates[k][l][0],f[4]=this.textureCoordinates[k][l][1]):(f[3]=this.textureCoordinates[k][0][0],f[4]=this.textureCoordinates[k][1][1]),++l),this.polygonTessellator.gluTessVertex(f,f);this.polygonTessellator.gluTessEndContour()}this.polygonTessellator.gluTessEndPolygon();
    return 0===d?c:null};d.prototype.mustDrawVerticals=function(a){return this._extrude&&this.activeAttributes.drawOutline&&this.activeAttributes.drawVerticals&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND};d.prototype.doRenderOrdered=function(a){var b=this.currentData,c;a.pickingMode&&(c=a.uniquePickColor());this.activeAttributes.drawInterior&&b.capTriangles&&0<b.capTriangles.length&&this.drawCap(a,c);this._extrude&&this.activeAttributes.drawInterior&&this.drawSides(a,c);this.activeAttributes.drawOutline&&
this.drawOutline(a,c);b.refreshBuffers=!1;a.pickingMode&&(b=new l(c,this.pickDelegate?this.pickDelegate:this,null,a.currentLayer,!1),a.resolvePick(b))};d.prototype.drawCap=function(a,b){var c=a.currentGlContext,d=a.currentProgram,e=this.currentData,g=e.refreshBuffers,h=!!this.hasCapTexture(),f=this.activeAttributes.applyLighting,k=e.capTriangles.length/(h?5:3),l;d.loadTextureEnabled(c,!1);this.applyMvpMatrix(a);e.capVboCacheKey||(e.capVboCacheKey=a.gpuResourceCache.generateCacheKey());l=a.gpuResourceCache.resourceForKey(e.capVboCacheKey);
    l||(l=c.createBuffer(),a.gpuResourceCache.putResource(e.capVboCacheKey,l,4*e.capTriangles.length),g=!0);c.bindBuffer(c.ARRAY_BUFFER,l);g&&(e=f?this.makeCapBufferWithNormals():e.capTriangles,c.bufferData(c.ARRAY_BUFFER,e,c.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1));g=this.activeAttributes.interiorColor;e=g.alpha*a.currentLayer.opacity;c.depthMask(1<=e||a.pickingMode);d.loadColor(c,a.pickingMode?b:g);d.loadOpacity(c,a.pickingMode?0<e?1:0:e);e=12+(h?8:0)+(f?12:0);h&&!a.pickingMode&&(this.activeTexture=
        a.gpuResourceCache.resourceForKey(this.capImageSource()),this.activeTexture||(this.activeTexture=a.gpuResourceCache.retrieveTexture(a.currentGlContext,this.capImageSource())),h=this.activeTexture&&this.activeTexture.bind(a))&&(d.loadTextureEnabled(c,!0),c.enableVertexAttribArray(d.vertexTexCoordLocation),c.vertexAttribPointer(d.vertexTexCoordLocation,2,c.FLOAT,!1,e,12),d.loadTextureUnit(c,c.TEXTURE0),d.loadModulateColor(c,a.pickingMode));f&&!a.pickingMode&&(d.loadApplyLighting(c,!0),c.enableVertexAttribArray(d.normalVectorLocation),
        c.vertexAttribPointer(d.normalVectorLocation,3,c.FLOAT,!1,e,e-12));c.vertexAttribPointer(d.vertexPointLocation,3,c.FLOAT,!1,e,0);c.drawArrays(c.TRIANGLES,0,k)};d.prototype.makeCapBufferWithNormals=function(){for(var a=this.currentData,b=a.capNormal,c=this.hasCapTexture()?5:3,d=a.capTriangles.length/c,a=a.capTriangles,e=new Float32Array(d*(c+3)),g=0,h=0;h<d;h++){for(var f=0;f<c;f++)e[g++]=a[h*c+f];e[g++]=b[0];e[g++]=b[1];e[g++]=b[2]}return e};d.prototype.drawSides=function(a,b){var c=a.currentGlContext,
    d=a.currentProgram,e=this.currentData,g=e.refreshBuffers,h=this.hasSideTextures(),f=this.activeAttributes.applyLighting,k=3+(h?2:0)+(f?3:0),l=4*k,m,q;for(m=q=0;m<e.boundaryPoints.length;m++)q+=e.boundaryPoints[m].length/6-1;e.sidesVboCacheKey||(e.sidesVboCacheKey=a.gpuResourceCache.generateCacheKey());m=a.gpuResourceCache.resourceForKey(e.sidesVboCacheKey);!m||g?(g=this.makeSidesBuffer(q),e.numSideVertices=g.length/k,m||(m=c.createBuffer()),a.gpuResourceCache.putResource(e.sidesVboCacheKey,m,4*g.length),
    c.bindBuffer(c.ARRAY_BUFFER,m),c.bufferData(c.ARRAY_BUFFER,g,c.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1)):c.bindBuffer(c.ARRAY_BUFFER,m);g=this.activeAttributes.interiorColor;k=g.alpha*a.currentLayer.opacity;c.depthMask(1<=k||a.pickingMode);d.loadColor(c,a.pickingMode?b:g);d.loadOpacity(c,a.pickingMode?0<k?1:0:k);if(h&&!a.pickingMode)for(this.activeTexture=a.gpuResourceCache.resourceForKey(this.capImageSource()),this.activeTexture||(this.activeTexture=a.gpuResourceCache.retrieveTexture(a.currentGlContext,
    this.capImageSource())),f?(d.loadApplyLighting(c,!0),c.enableVertexAttribArray(d.normalVectorLocation)):d.loadApplyLighting(c,!1),e=0;e<q;e++)k=this.sideImageSource(e),g=a.gpuResourceCache.resourceForKey(k),h=6*e*l,k&&!g&&(g=a.gpuResourceCache.retrieveTexture(a.currentGlContext,k)),(k=g&&g.bind(a))?(d.loadTextureEnabled(c,!0),d.loadTextureUnit(c,c.TEXTURE0),c.enableVertexAttribArray(d.vertexTexCoordLocation),c.vertexAttribPointer(d.vertexTexCoordLocation,2,c.FLOAT,!1,l,h+12)):(d.loadTextureEnabled(c,
    !1),c.disableVertexAttribArray(d.vertexTexCoordLocation)),f&&c.vertexAttribPointer(d.normalVectorLocation,3,c.FLOAT,!1,l,h+20),c.vertexAttribPointer(d.vertexPointLocation,3,c.FLOAT,!1,l,h),c.drawArrays(c.TRIANGLES,0,6);else d.loadTextureEnabled(c,!1),f&&!a.pickingMode?(d.loadApplyLighting(c,!0),c.enableVertexAttribArray(d.normalVectorLocation),c.vertexAttribPointer(d.normalVectorLocation,3,c.FLOAT,!1,l,l-12)):d.loadApplyLighting(c,!1),c.vertexAttribPointer(d.vertexPointLocation,3,c.FLOAT,!1,l,0),
    c.drawArrays(c.TRIANGLES,0,e.numSideVertices)};d.prototype.makeSidesBuffer=function(a){var b=this.currentData,c=this.hasSideTextures(),d=this.activeAttributes.applyLighting,e=3+(c?2:0)+(d?3:0),g,h,f,k,l,m,q,p;a=new Float32Array(6*a*e);g=0;h=new r(0,0,0);f=new r(0,0,0);k=new r(0,0,0);l=new r(0,0,0);c?(c=new t(0,1),m=new t(0,0),q=new t(1,1),p=new t(1,0)):c=m=q=p=null;for(var u=0;u<b.boundaryPoints.length;u++)for(var M=b.boundaryPoints[u],I,K=0;K<M.length-6;K+=6)h[0]=M[K],h[1]=M[K+1],h[2]=M[K+2],f[0]=
    M[K+3],f[1]=M[K+4],f[2]=M[K+5],k[0]=M[K+6],k[1]=M[K+7],k[2]=M[K+8],l[0]=M[K+9],l[1]=M[K+10],l[2]=M[K+11],I=d?r.computeTriangleNormal(h,f,k):null,this.addVertexToBuffer(h,c,I,a,g),g+=e,this.addVertexToBuffer(f,m,I,a,g),g+=e,this.addVertexToBuffer(k,q,I,a,g),g+=e,this.addVertexToBuffer(f,m,I,a,g),g+=e,this.addVertexToBuffer(l,p,I,a,g),g+=e,this.addVertexToBuffer(k,q,I,a,g),g+=e;return a};d.prototype.addVertexToBuffer=function(a,b,c,d,e){d[e++]=a[0];d[e++]=a[1];d[e++]=a[2];b&&(d[e++]=b[0],d[e++]=b[1]);
    c&&(d[e++]=c[0],d[e++]=c[1],d[e]=c[2])};d.prototype.drawOutline=function(a,b){var c=a.currentGlContext,d=a.currentProgram,e=this.currentData,g=e.refreshBuffers,h,f,k;d.loadTextureEnabled(c,!1);d.loadApplyLighting(c,!1);this.hasCapTexture()&&c.disableVertexAttribArray(d.vertexTexCoordLocation);this.activeAttributes.applyLighting&&c.disableVertexAttribArray(d.normalVectorLocation);e.boundaryVboCacheKeys||(this.currentData.boundaryVboCacheKeys=[]);this.applyMvpMatrixForOutline(a);d.loadTextureEnabled(c,
    !1);c.disableVertexAttribArray(d.vertexTexCoordLocation);for(var l=0;l<e.boundaryPoints.length;l++)h=e.boundaryPoints[l].length/3,e.boundaryVboCacheKeys[l]||(e.boundaryVboCacheKeys[l]=a.gpuResourceCache.generateCacheKey()),f=a.gpuResourceCache.resourceForKey(e.boundaryVboCacheKeys[l]),f||(f=c.createBuffer(),a.gpuResourceCache.putResource(e.boundaryVboCacheKeys[l],f,12*h),g=!0),c.bindBuffer(c.ARRAY_BUFFER,f),g&&(c.bufferData(c.ARRAY_BUFFER,e.boundaryPoints[l],c.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1)),
    k=this.activeAttributes.outlineColor,f=k.alpha*a.currentLayer.opacity,c.depthMask(1<=f||a.pickingMode),d.loadColor(c,a.pickingMode?b:k),d.loadOpacity(c,a.pickingMode?1:f),c.lineWidth(this.activeAttributes.outlineWidth),this._extrude?(f=24,k=h/2):(f=12,k=h),c.vertexAttribPointer(d.vertexPointLocation,3,c.FLOAT,!1,f,0),c.drawArrays(c.LINE_STRIP,0,k),this.mustDrawVerticals(a)&&(c.vertexAttribPointer(d.vertexPointLocation,3,c.FLOAT,!1,0,0),c.drawArrays(c.LINES,0,h-2))};d.prototype.beginDrawing=function(a){var b=
    a.currentGlContext;this.activeAttributes.drawInterior&&b.disable(b.CULL_FACE);a.findAndBindProgram(c);b.enableVertexAttribArray(a.currentProgram.vertexPointLocation);!a.pickMode&&this.activeAttributes.applyLighting&&a.currentProgram.loadModelviewInverse(b,a.navigatorState.modelviewNormalTransform)};d.prototype.endDrawing=function(a){var b=a.currentGlContext;b.disableVertexAttribArray(a.currentProgram.vertexPointLocation);b.disableVertexAttribArray(a.currentProgram.normalVectorLocation);b.depthMask(!0);
    b.lineWidth(1);b.enable(b.CULL_FACE)};return d});
define("src/shapes/SurfacePolyline",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(f,b,c,a){var d=function(c,d){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"SurfacePolyline","constructor","The specified locations array is null or undefined."));a.call(this,d);this._boundaries=c;this._isInteriorInhibited=!0};d.prototype=Object.create(a.prototype);d.staticStateKey=function(b){return a.staticStateKey(b)};d.prototype.computeStateKey=function(){return d.staticStateKey(this)};
    return d});
define("src/formats/geojson/GeoJSONParser","../../error/ArgumentError ../../util/Color ./GeoJSONConstants ./GeoJSONCRS ./GeoJSONFeature ./GeoJSONFeatureCollection ./GeoJSONGeometry ./GeoJSONGeometryCollection ./GeoJSONGeometryLineString ./GeoJSONGeometryMultiLineString ./GeoJSONGeometryMultiPoint ./GeoJSONGeometryMultiPolygon ./GeoJSONGeometryPoint ./GeoJSONGeometryPolygon ../../geom/Location ../../util/Logger ../../shapes/Placemark ../../shapes/PlacemarkAttributes ../../shapes/Polygon ../../geom/Position ../../util/proj4-src ../../layer/RenderableLayer ../../shapes/ShapeAttributes ../../shapes/SurfacePolygon ../../shapes/SurfacePolyline".split(" "),function(f,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           b,c,a,d,e,g,h,k,l,m,p,q,t,r,u,w,x,A,B,v,F,G,D,y){b=function(a){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","constructor","missingDataSource"));this._dataSource=a;this._parserCompletionCallback=this._layer=this._crs=this._geoJSONType=this._geoJSONObject=null;this._shapeConfigurationCallback=this.defaultShapeConfigurationCallback;this.defaultPlacemarkAttributes=new x(null);this.defaultShapeAttributes=new G(null);this.setProj4jsAliases()};Object.defineProperties(b.prototype,{dataSource:{get:function(){return this._dataSource}},
    geoJSONObject:{get:function(){return this._geoJSONObject}},geoJSONType:{get:function(){return this._geoJSONType}},crs:{get:function(){return this._crs}},layer:{get:function(){return this._layer}},parserCompletionCallback:{get:function(){return this._parserCompletionCallback}},shapeConfigurationCallback:{get:function(){return this._shapeConfigurationCallback}}});b.prototype.load=function(a,b,c){a&&(this._parserCompletionCallback=a);b&&(this._shapeConfigurationCallback=b);this._layer=c||new F;this.isDataSourceJson()?
    this.parse(this.dataSource):this.requestUrl(this.dataSource)};b.prototype.defaultShapeConfigurationCallback=function(a,b){var c={},d=b.name||b.Name||b.NAME;d&&(c.name=d);if(a.isPointType()||a.isMultiPointType())c.attributes=this.defaultPlacemarkAttributes;else if(a.isLineStringType()||a.isMultiLineStringType())c.attributes=this.defaultShapeAttributes;else if(a.isPolygonType()||a.isMultiPolygonType())c.attributes=this.defaultShapeAttributes;return c};b.prototype.requestUrl=function(a){var b=new XMLHttpRequest;
    b.open("GET",a,!0);b.responseType="text";b.onreadystatechange=function(){4===b.readyState&&(200===b.status?this.parse(b.response):u.log(u.LEVEL_WARNING,"GeoJSON retrieval failed ("+b.statusText+"): "+a))}.bind(this);b.onerror=function(){u.log(u.LEVEL_WARNING,"GeoJSON retrieval failed: "+a)};b.ontimeout=function(){u.log(u.LEVEL_WARNING,"GeoJSON retrieval timed out: "+a)};b.send(null)};b.prototype.parse=function(a){try{this._geoJSONObject=JSON.parse(a)}catch(b){u.logMessage(u.LEVEL_SEVERE,"GeoJSON",
    "parse","invalidGeoJSONObject")}finally{if(this.geoJSONObject){if("[object Array]"===Object.prototype.toString.call(this.geoJSONObject))throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","parse","invalidGeoJSONObjectLength"));if(this.geoJSONObject.hasOwnProperty(c.FIELD_TYPE))this.setGeoJSONType(),this.setGeoJSONCRS();else throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","parse","missingGeoJSONType"));this._parserCompletionCallback&&"function"===typeof this._parserCompletionCallback&&this._parserCompletionCallback(this.layer)}}};
    b.prototype.setGeoJSONCRS=function(){if(this.geoJSONObject[c.FIELD_CRS]){this._crs=new a(this.geoJSONObject[c.FIELD_CRS][c.FIELD_TYPE],this.geoJSONObject[c.FIELD_CRS][c.FIELD_PROPERTIES]);var b=function(){this.addRenderablesForGeoJSON(this.layer)}.bind(this);this.crs.setCRSString(b)}else this.addRenderablesForGeoJSON(this.layer)};b.prototype.addRenderablesForGeoJSON=function(a){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeoJSON","missingLayer"));switch(this.geoJSONType){case c.TYPE_FEATURE:var b=
        new d(this.geoJSONObject[c.FIELD_GEOMETRY],this.geoJSONObject[c.FIELD_PROPERTIES],this.geoJSONObject[c.FIELD_ID],this.geoJSONObject[c.FIELD_BBOX]);this.addRenderablesForFeature(a,b);break;case c.TYPE_FEATURE_COLLECTION:b=new e(this.geoJSONObject[c.FIELD_FEATURES],this.geoJSONObject[c.FIELD_BBOX]);this.addRenderablesForFeatureCollection(a,b);break;case c.TYPE_GEOMETRY_COLLECTION:b=new h(this.geoJSONObject[c.FIELD_GEOMETRIES],this.geoJSONObject[c.FIELD_BBOX]);this.addRenderablesForGeometryCollection(a,
        b,null);break;default:this.addRenderablesForGeometry(a,this.geoJSONObject,null)}};b.prototype.addRenderablesForGeometry=function(a,b,d){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometry","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometry","missingGeometry"));switch(b[c.FIELD_TYPE]){case c.TYPE_POINT:b=new q(b[c.FIELD_COORDINATES],b[c.FIELD_TYPE],b[c.FIELD_BBOX]);this.addRenderablesForPoint(a,b,d?d:null);break;case c.TYPE_MULTI_POINT:b=
        new m(b[c.FIELD_COORDINATES],b[c.FIELD_TYPE],b[c.FIELD_BBOX]);this.addRenderablesForMultiPoint(a,b,d?d:null);break;case c.TYPE_LINE_STRING:b=new k(b[c.FIELD_COORDINATES],b[c.FIELD_TYPE],b[c.FIELD_BBOX]);this.addRenderablesForLineString(a,b,d?d:null);break;case c.TYPE_MULTI_LINE_STRING:b=new l(b[c.FIELD_COORDINATES],b[c.FIELD_TYPE],b[c.FIELD_BBOX]);this.addRenderablesForMultiLineString(a,b,d?d:null);break;case c.TYPE_POLYGON:b=new t(b[c.FIELD_COORDINATES],b[c.FIELD_TYPE],b[c.FIELD_BBOX]);this.addRenderablesForPolygon(a,
        b,d?d:null);break;case c.TYPE_MULTI_POLYGON:b=new p(b[c.FIELD_COORDINATES],b[c.FIELD_TYPE],b[c.FIELD_BBOX]),this.addRenderablesForMultiPolygon(a,b,d?d:null)}};b.prototype.addRenderablesForPoint=function(a,b,c){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForPoint","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForPoint","missingGeometry"));c=this.shapeConfigurationCallback(b,c);if(!this.crs||this.crs.isCRSSupported()){var d=b.coordinates[2]?
        b.coordinates[2]:0;b=this.getReprojectedIfRequired(b.coordinates[1],b.coordinates[0],this.crs);b=new B(b[1],b[0],d);b=new w(b,!1,c&&c.attributes?c.attributes:null);b.altitudeMode=WorldWind.RELATIVE_TO_GROUND;c&&c.name&&(b.label=c.name);a.addRenderable(b)}};b.prototype.addRenderablesForMultiPoint=function(a,b,c){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPoint","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPoint",
        "missingGeometry"));c=this.shapeConfigurationCallback(b,c);if(!this.crs||this.crs.isCRSSupported())for(var d=0,e=b.coordinates.length;d<e;d+=1){var g=b.coordinates[d][2]?b.coordinates[d][2]:0,h=this.getReprojectedIfRequired(b.coordinates[d][1],b.coordinates[d][0],this.crs),g=new B(h[1],h[0],g),g=new w(g,!1,c&&c.attributes?c.attributes:null);g.altitudeMode=WorldWind.RELATIVE_TO_GROUND;c&&c.name&&(g.label=c.name);a.addRenderable(g)}};b.prototype.addRenderablesForLineString=function(a,b,c){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,
        "GeoJSON","addRenderablesForLineString","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForLineString","missingGeometry"));c=this.shapeConfigurationCallback(b,c);if(!this.crs||this.crs.isCRSSupported()){var d=[],e=0;for(b=b.coordinates;e<b.length;e++){var g=this.getReprojectedIfRequired(b[e][1],b[e][0],this.crs),g=new r(g[1],g[0]);d.push(g)}c=new y(d,c&&c.attributes?c.attributes:null);a.addRenderable(c)}};b.prototype.addRenderablesForMultiLineString=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               b,c){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiLineString","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiLineString","missingGeometry"));c=this.shapeConfigurationCallback(b,c);if(!this.crs||this.crs.isCRSSupported()){var d=0;for(b=b.coordinates;d<b.length;d++){for(var e=[],g=0,h=b[d];g<h.length;g++){var k=this.getReprojectedIfRequired(h[g][1],h[g][0],this.crs),k=new r(k[1],k[0]);e.push(k)}e=new y(e,c&&c.attributes?
        c.attributes:null);a.addRenderable(e)}}};b.prototype.addRenderablesForPolygon=function(a,b,c){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingGeometry"));c=this.shapeConfigurationCallback(b,c);if(!this.crs||this.crs.isCRSSupported()){var d=0;for(b=b.coordinates;d<b.length;d++){for(var e=[],g=0,h=b[d];g<h.length;g++){var k=this.getReprojectedIfRequired(h[g][1],
        h[g][0],this.crs),k=new r(k[1],k[0]);e.push(k)}e=new D(e,c&&c.attributes?c.attributes:null);a.addRenderable(e)}}};b.prototype.addRenderablesForMultiPolygon=function(a,b,c){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingGeometry"));c=this.shapeConfigurationCallback(b,c);if(!this.crs||this.crs.isCRSSupported()){var d=0;for(b=b.coordinates;d<b.length;d++){for(var e=
        [],g=0;g<b[d].length;g++){for(var h=[],k=0,l=b[d][g];k<l.length;k++){var m=this.getReprojectedIfRequired(l[k][1],l[k][0],this.crs),m=new r(m[1],m[0]);h.push(m)}e.push(h)}e=new D(e,c&&c.attributes?c.attributes:null);a.addRenderable(e)}}};b.prototype.addRenderablesForGeometryCollection=function(a,b,d){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometryCollection","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometryCollection",
        "missingGeometryCollection"));var e=0;for(b=b.geometries;e<b.length;e++)b[e].hasOwnProperty(c.FIELD_TYPE)&&this.addRenderablesForGeometry(a,b[e],d)};b.prototype.addRenderablesForFeature=function(a,b){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeature","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeature","missingFeature"));if(b.geometry.type===c.TYPE_GEOMETRY_COLLECTION){var d=new h(b.geometry.geometries,b.bbox);this.addRenderablesForGeometryCollection(a,
        d,b.properties)}else this.addRenderablesForGeometry(a,b.geometry,b.properties)};b.prototype.addRenderablesForFeatureCollection=function(a,b){if(!a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeatureCollection","missingLayer"));if(!b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeatureCollection","missingFeatureCollection"));if(0<b.features.length)for(var e=0;e<b.features.length;e++){var g=new d(b.features[e][c.FIELD_GEOMETRY],b.features[e][c.FIELD_PROPERTIES],
        b.features[e][c.FIELD_ID],b.features[e][c.FIELD_BBOX]);this.addRenderablesForFeature(a,g)}};b.prototype.setGeoJSONType=function(){switch(this.geoJSONObject[c.FIELD_TYPE]){case c.TYPE_POINT:this._geoJSONType=c.TYPE_POINT;break;case c.TYPE_MULTI_POINT:this._geoJSONType=c.TYPE_MULTI_POINT;break;case c.TYPE_LINE_STRING:this._geoJSONType=c.TYPE_LINE_STRING;break;case c.TYPE_MULTI_LINE_STRING:this._geoJSONType=c.TYPE_MULTI_LINE_STRING;break;case c.TYPE_POLYGON:this._geoJSONType=c.TYPE_POLYGON;break;case c.TYPE_MULTI_POLYGON:this._geoJSONType=
        c.TYPE_MULTI_POLYGON;break;case c.TYPE_GEOMETRY_COLLECTION:this._geoJSONType=c.TYPE_GEOMETRY_COLLECTION;break;case c.TYPE_FEATURE:this._geoJSONType=c.TYPE_FEATURE;break;case c.TYPE_FEATURE_COLLECTION:this._geoJSONType=c.TYPE_FEATURE_COLLECTION;break;default:throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","setGeoJSONType","invalidGeoJSONType"));}};b.prototype.getReprojectedIfRequired=function(a,b,d){if(!a&&0!==a)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","getReprojectedIfRequired","missingLatitude"));
        if(!b&&0!==b)throw new f(u.logMessage(u.LEVEL_SEVERE,"GeoJSON","getReprojectedIfRequired","missingLongitude"));return!d||d.isDefault()?[b,a]:v(d.projectionString,c.EPSG4326_CRS,[b,a])};b.prototype.setProj4jsAliases=function(){v.defs([["urn:ogc:def:crs:OGC:1.3:CRS84",v.defs("EPSG:4326")],["urn:ogc:def:crs:EPSG::3857",v.defs("EPSG:3857")]])};b.prototype.isDataSourceJson=function(){try{JSON.parse(this.dataSource)}catch(a){return!1}return!0};return b});
define("src/formats/geotiff/GeoTiffConstants",[],function(){return{Tag:{MODEL_PIXEL_SCALE:33550,MODEL_TRANSFORMATION:34264,MODEL_TIEPOINT:33922,GEO_KEY_DIRECTORY:34735,GEO_DOUBLE_PARAMS:34736,GEO_ASCII_PARAMS:34737,GDAL_NODATA:42113,GDAL_METADATA:42112},Key:{GTModelTypeGeoKey:1024,GTRasterTypeGeoKey:1025,GTCitationGeoKey:1026,GeographicTypeGeoKey:2048,GeogCitationGeoKey:2049,GeogGeodeticDatumGeoKey:2050,GeogPrimeMeridianGeoKey:2051,GeogLinearUnitsGeoKey:2052,GeogLinearUnitSizeGeoKey:2053,GeogAngularUnitsGeoKey:2054,
    GeogAngularUnitSizeGeoKey:2055,GeogEllipsoidGeoKey:2056,GeogSemiMajorAxisGeoKey:2057,GeogSemiMinorAxisGeoKey:2058,GeogInvFlatteningGeoKey:2059,GeogAzimuthUnitsGeoKey:2060,GeogPrimeMeridianLongGeoKey:2061,GeogTOWGS84GeoKey:2062,ProjectedCSTypeGeoKey:3072,PCSCitationGeoKey:3073,ProjectionGeoKey:3074,ProjCoordTransGeoKey:3075,ProjLinearUnitsGeoKey:3076,ProjLinearUnitSizeGeoKey:3077,ProjStdParallel1GeoKey:3078,ProjStdParallel2GeoKey:3079,ProjNatOriginLongGeoKey:3080,ProjNatOriginLatGeoKey:3081,ProjFalseEastingGeoKey:3082,
    ProjFalseNorthingGeoKey:3083,ProjFalseOriginLongGeoKey:3084,ProjFalseOriginLatGeoKey:3085,ProjFalseOriginEastingGeoKey:3086,ProjFalseOriginNorthingGeoKey:3087,ProjCenterLongGeoKey:3088,ProjCenterLatGeoKey:3089,ProjCenterEastingGeoKey:3090,ProjCenterNorthingGeoKey:3091,ProjScaleAtNatOriginGeoKey:3092,ProjScaleAtCenterGeoKey:3093,ProjAzimuthAngleGeoKey:3094,ProjStraightVertPoleLongGeoKey:3095,VerticalCSTypeGeoKey:4096,VerticalCitationGeoKey:4097,VerticalDatumGeoKey:4098,VerticalUnitsGeoKey:4099}}});
define("src/formats/geotiff/GeoTiffKeyEntry",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffConstants","../../util/Logger"],function(f,b,c,a){f=function(c,e,g,h){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingKeyId"));if(null===e||void 0===e)throw new b(a.logMessage(a.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingTiffTagLocation"));if(!g)throw new b(a.logMessage(a.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingCount"));if(null===
    h||void 0===h)throw new b(a.logMessage(a.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingValueOffset"));this._keyId=c;this._tiffTagLocation=e;this._count=g;this._valueOffset=h};Object.defineProperties(f.prototype,{keyId:{get:function(){return this._keyId}},tiffTagLocation:{get:function(){return this._tiffTagLocation}},count:{get:function(){return this._count}},valueOffset:{get:function(){return this._valueOffset}}});f.prototype.getGeoKeyValue=function(a,b){var g;if(0===this.tiffTagLocation)g=
    this.valueOffset;else if(this.tiffTagLocation===c.Tag.GEO_ASCII_PARAMS){var h="";if(b){for(g=this.valueOffset;g<this.count-1;g++)h+=b[g];"|"!=b[this.count-1]&&(h+=b[this.count-1]);g=h}}else this.tiffTagLocation===c.Tag.GEO_DOUBLE_PARAMS&&a&&(g=a[this.valueOffset]);return g};return f});
define("src/formats/geotiff/GeoTiffMetadata",[],function(){var f=function(){this._minSampleValue=this._maxSampleValue=this._imageWidth=this._imageLength=this._extraSamples=this._compression=this._colorMap=this._bitsPerSample=null;this._orientation=0;this._projectedCSType=this._geogCitationGeoKey=this._geographicTypeGeoKey=this._gtCitationGeoKey=this._gtRasterTypeGeoKey=this._gtModelTypeGeoKey=this._bbox=this._noData=this._modelTransformation=this._modelTiepoint=this._modelPixelScale=this._geoKeyDirectory=
    this._geoDoubleParams=this._geoAsciiParams=this._tileWidth=this._tileLength=this._tileOffsets=this._tileByteCounts=this._stripOffsets=this._stripByteCounts=this._software=this._sampleFormat=this._samplesPerPixel=this._rowsPerStrip=this._planarConfiguration=this._photometricInterpretation=null};Object.defineProperties(f.prototype,{bitsPerSample:{get:function(){return this._bitsPerSample},set:function(b){this._bitsPerSample=b}},colorMap:{get:function(){return this._colorMap},set:function(b){this._colorMap=
    b}},compression:{get:function(){return this._compression},set:function(b){this._compression=b}},extraSamples:{get:function(){return this._extraSamples},set:function(b){this._extraSamples=b}},imageLength:{get:function(){return this._imageLength},set:function(b){this._imageLength=b}},imageWidth:{get:function(){return this._imageWidth},set:function(b){this._imageWidth=b}},maxSampleValue:{get:function(){return this._maxSampleValue},set:function(b){this._maxSampleValue=b}},minSampleValue:{get:function(){return this._minSampleValue},
    set:function(b){this._minSampleValue=b}},orientation:{get:function(){return this._orientation},set:function(b){this._orientation=b}},photometricInterpretation:{get:function(){return this._photometricInterpretation},set:function(b){this._photometricInterpretation=b}},planarConfiguration:{get:function(){return this._planarConfiguration},set:function(b){this._planarConfiguration=b}},rowsPerStrip:{get:function(){return this._rowsPerStrip},set:function(b){this._rowsPerStrip=b}},samplesPerPixel:{get:function(){return this._samplesPerPixel},
    set:function(b){this._samplesPerPixel=b}},sampleFormat:{get:function(){return this._sampleFormat},set:function(b){this._sampleFormat=b}},software:{get:function(){return this._software},set:function(b){this._software=b}},stripByteCounts:{get:function(){return this._stripByteCounts},set:function(b){this._stripByteCounts=b}},stripOffsets:{get:function(){return this._stripOffsets},set:function(b){this._stripOffsets=b}},tileByteCounts:{get:function(){return this._tileByteCounts},set:function(b){this._tileByteCounts=
    b}},tileOffsets:{get:function(){return this._tileOffsets},set:function(b){this._tileOffsets=b}},tileLength:{get:function(){return this._tileLength},set:function(b){this._tileLength=b}},tileWidth:{get:function(){return this._tileWidth},set:function(b){this._tileWidth=b}},geoAsciiParams:{get:function(){return this._geoAsciiParams},set:function(b){this._geoAsciiParams=b}},geoDoubleParams:{get:function(){return this._geoDoubleParams},set:function(b){this._geoDoubleParams=b}},geoKeyDirectory:{get:function(){return this._geoKeyDirectory},
    set:function(b){this._geoKeyDirectory=b}},modelPixelScale:{get:function(){return this._modelPixelScale},set:function(b){this._modelPixelScale=b}},modelTiepoint:{get:function(){return this._modelTiepoint},set:function(b){this._modelTiepoint=b}},modelTransformation:{get:function(){return this._modelTransformation},set:function(b){this._modelTransformation=b}},noData:{get:function(){return this._noData},set:function(b){this._noData=b}},bbox:{get:function(){return this._bbox},set:function(b){this._bbox=
    b}},gtModelTypeGeoKey:{get:function(){return this._gtModelTypeGeoKey},set:function(b){this._gtModelTypeGeoKey=b}},gtRasterTypeGeoKey:{get:function(){return this._gtRasterTypeGeoKey},set:function(b){this._gtRasterTypeGeoKey=b}},gtCitationGeoKey:{get:function(){return this._gtCitationGeoKey},set:function(b){this._gtCitationGeoKey=b}},geographicTypeGeoKey:{get:function(){return this._geographicTypeGeoKey},set:function(b){this._geographicTypeGeoKey=b}},geogCitationGeoKey:{get:function(){return this._geogCitationGeoKey},
    set:function(b){this._geogCitationGeoKey=b}},projectedCSType:{get:function(){return this._projectedCSType},set:function(b){this._projectedCSType=b}}});return f});
define("src/formats/geotiff/TiffConstants",[],function(){return{Tag:{NEW_SUBFILE_TYPE:254,SUBFILE_TYPE:255,IMAGE_WIDTH:256,IMAGE_LENGTH:257,BITS_PER_SAMPLE:258,COMPRESSION:259,PHOTOMETRIC_INTERPRETATION:262,THRESHHOLDING:263,CELL_WIDTH:264,CELL_LENGTH:265,FILL_ORDER:266,DOCUMENT_NAME:269,IMAGE_DESCRIPTION:270,MAKE:271,MODEL:272,STRIP_OFFSETS:273,ORIENTATION:274,SAMPLES_PER_PIXEL:277,ROWS_PER_STRIP:278,STRIP_BYTE_COUNTS:279,MIN_SAMPLE_VALUE:280,MAX_SAMPLE_VALUE:281,X_RESOLUTION:282,Y_RESOLUTION:283,
    PLANAR_CONFIGURATION:284,PAGE_NAME:285,X_POSITION:286,Y_POSITION:287,FREE_OFFSETS:288,FREE_BYTE_COUNTS:289,GRAY_RESPONSE_UNIT:290,GRAY_RESPONSE_CURVE:291,T4_OPTIONS:292,T6_PTIONS:293,RESOLUTION_UNIT:296,PAGE_NUMBER:297,TRANSFER_FUNCTION:301,SOFTWARE:305,DATE_TIME:306,ARTIST:315,HOST_COMPUTER:316,PREDICTOR:317,WHITE_POINT:318,PRIMARY_CHROMATICITIES:319,COLOR_MAP:320,HALFTONE_HINTS:321,TILE_WIDTH:322,TILE_LENGTH:323,TILE_OFFSETS:324,TILE_BYTE_COUNTS:325,INK_SET:332,INK_NAMES:333,NUMBER_OF_INKS:334,
    DOT_RANGE:336,TARGET_PRINTER:337,EXTRA_SAMPLES:338,SAMPLE_FORMAT:339,S_MIN_SAMPLE_VALUE:340,S_MAX_SAMPLE_VALUE:341,TRANSFER_RANGE:342,JPEG_PROC:512,JPEG_INTERCHANGE_FORMAT:513,JPEG_INTERCHANGE_FORMAT_LENGTH:514,JPEG_RESTART_INTERVAL:515,JPEG_LOSSLESS_PREDICTORS:517,JPEG_POINT_TRANSFORMS:518,JPEG_Q_TABLES:519,JPEG_DC_TABLES:520,JPEG_AC_TABLES:521,Y_Cb_Cr_COEFFICIENTS:529,Y_Cb_Cr_SUB_SAMPLING:530,Y_Cb_Cr_POSITIONING:531,REFERENCE_BLACK_WHITE:532,COPYRIGHT:33432},Compression:{UNCOMPRESSED:1,CCITT_1D:2,
    GROUP_3_FAX:3,GROUP_4_FAX:4,LZW:5,JPEG:6,PACK_BITS:32773},Orientation:{Row0_IS_TOP__Col0_IS_LHS:1,Row0_IS_TOP__Col0_IS_RHS:2,Row0_IS_BOTTOM__Col0_IS_RHS:3,Row0_IS_BOTTOM__Col0_IS_LHS:4,Row0_IS_LHS__Col0_IS_TOP:5,Row0_IS_RHS__Col0_IS_TOP:6,Row0_IS_RHS__Col0_IS_BOTTOM:7,Row0_IS_LHS__Col0_IS_BOTTOM:8},PhotometricInterpretation:{WHITE_IS_ZERO:0,BLACK_IS_ZERO:1,RGB:2,RGB_PALETTE:3,TRANSPARENCY_MASK:4,CMYK:5,Y_Cb_Cr:6,CIE_LAB:7},PlanarConfiguration:{CHUNKY:1,PLANAR:2},ResolutionUnit:{NONE:1,INCH:2,CENTIMETER:3},
    SampleFormat:{UNSIGNED:1,SIGNED:2,IEEE_FLOAT:3,UNDEFINED:4,DEFAULT:1},Type:{BYTE:1,ASCII:2,SHORT:3,LONG:4,RATIONAL:5,SBYTE:6,UNDEFINED:7,SSHORT:8,SLONG:9,SRATIONAL:10,FLOAT:11,DOUBLE:12}}});
define("src/formats/geotiff/GeoTiffUtil",["../../error/ArgumentError","../../util/Logger","./TiffConstants"],function(f,b,c){return{getBytes:function(a,c,e,g,h){if(0>=e)throw new f(b.logMessage(b.LEVEL_SEVERE,"GeoTiffReader","getBytes","noBytesRequested"));if(1>=e)return h?a.getInt8(c,g):a.getUint8(c,g);if(2>=e)return h?a.getInt16(c,g):a.getUint16(c,g);if(3>=e)return h?a.getInt32(c,g)>>>8:a.getUint32(c,g)>>>8;if(4>=e)return h?a.getInt32(c,g):a.getUint32(c,g);if(8>=e)return a.getFloat64(c,g);throw new f(b.logMessage(b.LEVEL_SEVERE,
    "GeoTiffReader","getBytes","tooManyBytesRequested"));},getSampleBytes:function(a,d,e,g,h){var f;switch(g){case c.SampleFormat.UNSIGNED:f=this.getBytes(a,d,e,h,!1);break;case c.SampleFormat.SIGNED:f=this.getBytes(a,d,e,h,!0);break;case c.SampleFormat.IEEE_FLOAT:3==e?f=a.getFloat32(d,h)>>>8:4==e?f=a.getFloat32(d,h):8==e?f=a.getFloat64(d,h):b.log(b.LEVEL_WARNING,"Do not attempt to parse the data  not handled: "+e);break;default:f=this.getBytes(a,d,e,h,!1)}return f},canvasToTiffImage:function(a){var b=
    new Image;b.src=a.toDataURL();return b},getRGBAFillValue:function(a,b,c,g){"undefined"===typeof g&&(g=1);return"rgba("+a+", "+b+", "+c+", "+g+")"},getTagValueAsString:function(a,b){for(var c in a)if(a[c]===b)return c},clampColorSample:function(a,b){var c=Math.pow(2,8-b);return Math.floor(a*c+(c-1))},clampColorSampleForElevation:function(a,b,c){return Math.round(255/(c-b)*(a-b))},getMinMaxGeotiffSamples:function(a,b){for(var c=Infinity,g=-Infinity,h=0;h<a.length;h++)for(var f=0;f<a[h].length;f++)for(var l=
    0;l<a[h][f].length;l++)a[h][f][l]!=b&&(a[h][f][l]>g&&(g=a[h][f][l]),a[h][f][l]<c&&(c=a[h][f][l]));return{max:g,min:c}}}});
define("src/formats/geotiff/TiffIFDEntry",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffUtil","../../util/Logger","./TiffConstants"],function(f,b,c,a,d){var e=function(c,d,e,f,m,p){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingTag"));if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingType"));if(!e)throw new b(a.logMessage(a.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingCount"));if(null===f||void 0===f)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "TiffIFDEntry","constructor","missingValueOffset"));if(!m)throw new b(a.logMessage(a.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingGeoTiffData"));if(null===p||void 0===p)throw new b(a.logMessage(a.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingIsLittleEndian"));this._tag=c;this._type=d;this._count=e;this._valueOffset=f;this._geoTiffData=m;this._isLittleEndian=p};Object.defineProperties(e.prototype,{tag:{get:function(){return this._tag}},type:{get:function(){return this._type}},count:{get:function(){return this._count}},
    valueOffset:{get:function(){return this._valueOffset}},geoTiffData:{get:function(){return this._geoTiffData}},isLittleEndian:{get:function(){return this._isLittleEndian}}});e.prototype.getIFDTypeLength=function(){switch(this.type){case d.Type.BYTE:case d.Type.ASCII:case d.Type.SBYTE:case d.Type.UNDEFINED:return 1;case d.Type.SHORT:case d.Type.SSHORT:return 2;case d.Type.LONG:case d.Type.SLONG:case d.Type.FLOAT:return 4;case d.Type.RATIONAL:case d.Type.SRATIONAL:case d.Type.DOUBLE:return 8;default:return-1}};
    e.prototype.getIFDEntryValue=function(){var b=[],e=null,e=this.getIFDTypeLength();if(4>=e*this.count)e=!1===this.isLittleEndian?this.valueOffset>>>8*(4-e):this.valueOffset,b.push(e);else for(var k=0;k<this.count;k++){var l=e*k;if(8<=e)if(this.type===d.Type.RATIONAL||this.type===d.Type.SRATIONAL)b.push(c.getBytes(this.geoTiffData,this.valueOffset+l,4,this.isLittleEndian)),b.push(c.getBytes(this.geoTiffData,this.valueOffset+l+4,4,this.isLittleEndian));else if(this.type===d.Type.DOUBLE)b.push(c.getBytes(this.geoTiffData,
        this.valueOffset+l,8,this.isLittleEndian));else throw new f(a.logMessage(a.LEVEL_SEVERE,"TiffIFDEntry","parse","invalidTypeOfIFD"));else b.push(c.getBytes(this.geoTiffData,this.valueOffset+l,e,this.isLittleEndian))}return this.type===d.Type.ASCII?(b.forEach(function(a,b,c){0===a?c.splice(b,1):c[b]=String.fromCharCode(a)}),b.join("")):b};return e});
define("src/formats/geotiff/GeoTiffReader","../../error/AbstractError ../../error/ArgumentError ./GeoTiffConstants ./GeoTiffKeyEntry ./GeoTiffMetadata ./GeoTiffUtil ../../geom/Location ../../geom/Sector ../../util/Logger ../../util/proj4-src ./TiffConstants ./TiffIFDEntry".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p){var q=function(a){if(!a)throw new b(k.logMessage(k.LEVEL_SEVERE,"GeoTiffReader","constructor","missingUrl"));this._url=a;this._isLittleEndian=!1;this._imageFileDirectories=[];this._geoTiffData=
    null;this._metadata=new d};Object.defineProperties(q.prototype,{url:{get:function(){return this._url}},isLittleEndian:{get:function(){return this._isLittleEndian}},imageFileDirectories:{get:function(){return this._imageFileDirectories}},geoTiffData:{get:function(){return this._geoTiffData}},metadata:{get:function(){return this._metadata}}});q.prototype.requestUrl=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onreadystatechange=function(){if(4===c.readyState)if(200===
    c.status){var d=c.response;d&&(this.parse(d),b())}else k.log(k.LEVEL_WARNING,"GeoTiff retrieval failed ("+c.statusText+"): "+a)}.bind(this);c.onerror=function(){k.log(k.LEVEL_WARNING,"GeoTiff retrieval failed: "+a)};c.ontimeout=function(){k.log(k.LEVEL_WARNING,"GeoTiff retrieval timed out: "+a)};c.send(null)};q.prototype.parse=function(a){this._geoTiffData=new DataView(a);this.getEndianness();if(!this.isTiffFileType())throw new f(k.logMessage(k.LEVEL_SEVERE,"GeoTiffReader","parse","invalidTiffFileType"));
    a=e.getBytes(this.geoTiffData,4,4,this.isLittleEndian);this.parseImageFileDirectory(a);this.getMetadataFromImageFileDirectory();this.parseGeoKeys();this.setBBox()};q.prototype.getEndianness=function(){var a=e.getBytes(this.geoTiffData,0,2,this.isLittleEndian);if(18761===a)this._isLittleEndian=!0;else if(19789===a)this._isLittleEndian=!1;else throw new f(k.logMessage(k.LEVEL_SEVERE,"GeoTiffReader","getEndianness","invalidByteOrderValue"));};q.prototype.isTiffFileType=function(){return 42===e.getBytes(this.geoTiffData,
    2,2,this.isLittleEndian)?!0:!1};q.prototype.isGeoTiff=function(){return this.getIFDByTag(c.Tag.GEO_KEY_DIRECTORY)?!0:!1};q.prototype.readAsImage=function(a){this.requestUrl(this.url,function(){var b=this.metadata.bitsPerSample,c=this.metadata.samplesPerPixel,d=this.metadata.photometricInterpretation,e=this.metadata.imageLength,g=this.metadata.imageWidth;if(this.metadata.colorMap)var h=this.metadata.colorMap,f=Math.pow(2,b[0]);var k=document.createElement("canvas");k.width=g;k.height=e;var l=k.getContext("2d");
    if(this.metadata.stripOffsets)for(var m=this.parseStrips(!1),q=this.metadata.rowsPerStrip?this.metadata.rowsPerStrip:e,p=m.length,C=0,z=q,E=e%q,e=0===E?q:E,L=0;L<p;L++){L+1===p&&(z=e);for(var M=m[L].length,I=C*L,K=C=0;C<z,K<M;C++)for(E=0;E<g;E++,K++){var O=m[L][K];l.fillStyle=this.getFillStyle(O,d,b,c,h,f);l.fillRect(E,I+C,1,1)}C=q}else if(this.metadata.tileOffsets)for(m=this.parseTiles(!1),q=this.metadata.tileWidth,p=this.metadata.tileLength,z=Math.ceil(g/q),C=0;C<e;C++)for(E=0;E<g;E++)O=m[Math.floor(C/
        p)*z+Math.floor(E/q)][C%p*q+E%q],l.fillStyle=this.getFillStyle(O,d,b,c,h,f),l.fillRect(E,C,1,1);this._geoTiffData=null;a(k)}.bind(this))};q.prototype.getFillStyle=function(a,b,c,d,g,h){var f=0,l=0,q=0,p=1;this.metadata.noData&&a[0]==this.metadata.noData&&(p=0);switch(b){case m.PhotometricInterpretation.WHITE_IS_ZERO:a[0]=Math.pow(2,c)-1-a[0];case m.PhotometricInterpretation.BLACK_IS_ZERO:f=l=q=e.clampColorSample(a[0],c[0]);break;case m.PhotometricInterpretation.RGB:f=e.clampColorSample(a[0],c[0]);
    l=e.clampColorSample(a[1],c[1]);q=e.clampColorSample(a[2],c[2]);4===d&&2===this.metadata.extraSamples[0]&&(p=a[3]/Math.pow(2,c[3]));break;case m.PhotometricInterpretation.RGB_PALETTE:g&&(a=a[0],f=e.clampColorSample(g[a],16),l=e.clampColorSample(g[h+a],16),q=e.clampColorSample(g[2*h+a],16));break;case m.PhotometricInterpretation.TRANSPARENCY_MASK:k.log(k.LEVEL_WARNING,"Photometric interpretation not yet implemented: TRANSPARENCY_MASK");break;case m.PhotometricInterpretation.CMYK:k.log(k.LEVEL_WARNING,
    "Photometric interpretation not yet implemented: CMYK");break;case m.PhotometricInterpretation.Y_Cb_Cr:k.log(k.LEVEL_WARNING,"Photometric interpretation not yet implemented: Y_Cb_Cr");break;case m.PhotometricInterpretation.CIE_LAB:k.log(k.LEVEL_WARNING,"Photometric interpretation not yet implemented: CIE_LAB");break;default:k.log("Unknown photometric interpretation: "+b)}return e.getRGBAFillValue(f,l,q,p)};q.prototype.createTypedElevationArray=function(a,b,c){var d;switch(a){case 8:d=b===m.SampleFormat.SIGNED?
    new Int8Array(c):new Uint8Array(c);break;case 16:d=b===m.SampleFormat.SIGNED?new Int16Array(c):new Uint16Array(c);break;case 32:d=b===m.SampleFormat.SIGNED?new Int32Array(c):b===m.SampleFormat.IEEE_FLOAT?new Float32Array(c):new Uint32Array(c);break;case 64:d=new Float64Array(c)}return d};q.prototype.readAsData=function(a){this.requestUrl(this.url,function(){var b=[];if(this.metadata.stripOffsets)for(var c=this.parseStrips(!0),d=0;d<c.length;d++)b=b.concat(c[d]);else if(this.metadata.tileOffsets)for(var c=
    this.parseTiles(!0),d=this.metadata.imageWidth,e=this.metadata.imageLength,g=this.metadata.tileWidth,h=this.metadata.tileLength,f=Math.ceil(d/g),k=0;k<e;k++)for(var l=0;l<d;l++)b.push(c[Math.floor(k/h)*f+Math.floor(l/g)][k%h*g+l%g]);a(this.createTypedElevationArray(this.metadata.bitsPerSample[0],(this.metadata.sampleFormat?this.metadata.sampleFormat:m.SampleFormat.UNSIGNED)[0],b))}.bind(this))};q.prototype.parseStrips=function(a){for(var b=this.metadata.samplesPerPixel,c=this.metadata.bitsPerSample,
                                                                                                                                                                                                                                                                                                                                                                                                                                                              d=this.metadata.stripOffsets,e=this.metadata.stripByteCounts,g=this.metadata.compression,h=this.metadata.sampleFormat?this.metadata.sampleFormat:m.SampleFormat.UNSIGNED,f=b*c[0]/8,k=[],l=0;l<d.length;l++)k[l]=this.parseBlock(a,g,f,e[l],d[l],b,c,h);return k};q.prototype.parseBlock=function(a,b,c,d,g,h,f,l){var q=[];switch(b){case m.Compression.UNCOMPRESSED:for(b=0;b<d;b+=c){for(var p=0,D=[];p<h;p++){var y=f[p]/8,H=p*y;D.push(e.getSampleBytes(this.geoTiffData,g+b+H,y,l[p],this.isLittleEndian))}a?q.push(D[0]):
    q.push(D)}break;case m.Compression.CCITT_1D:k.log(k.LEVEL_WARNING,"Compression type not yet implemented: CCITT_1D");break;case m.Compression.GROUP_3_FAX:k.log(k.LEVEL_WARNING,"Compression type not yet implemented: GROUP_3_FAX");break;case m.Compression.GROUP_4_FAX:k.log(k.LEVEL_WARNING,"Compression type not yet implemented: GROUP_4_FAX");break;case m.Compression.LZW:k.log(k.LEVEL_WARNING,"Compression type not yet implemented: LZW");break;case m.Compression.JPEG:k.log(k.LEVEL_WARNING,"Compression type not yet implemented: JPEG");
    break;case m.Compression.PACK_BITS:var C=this.metadata.tileOffsets?new ArrayBuffer(this.metadata.tileWidth*this.metadata.tileWidth*c):new ArrayBuffer(this.metadata.rowsPerStrip*this.metadata.imageWidth*c),z=new DataView(C),p=!0;for(b=H=y=D=0;b<d;b+=1)if(p){var y=D=1,p=!1,E=this.geoTiffData.getInt8(g+b,this.isLittleEndian);0<=E&&127>=E?D=E+1:-127<=E&&-1>=E?y=-E+1:p=!0}else{for(var E=e.getBytes(this.geoTiffData,g+b,1,this.isLittleEndian),L=0;L<y;L++)z.setInt8(H,E),H++;D--;0===D&&(p=!0)}for(b=0;b<C.byteLength;b+=
    c){p=0;for(D=[];p<h;p++)y=f[p]/8,H=p*y,D.push(e.getSampleBytes(z,b+H,y,l[p],this.isLittleEndian));a?q.push(D[0]):q.push(D)}}return q};q.prototype.parseTiles=function(a){for(var b=this.metadata.samplesPerPixel,c=this.metadata.bitsPerSample,d=this.metadata.compression,e=this.metadata.sampleFormat?this.metadata.sampleFormat:Array(b).fill(m.SampleFormat.UNSIGNED),g=b*c[0]/8,h=this.metadata.tileOffsets,f=this.metadata.tileByteCounts,k=Math.ceil(this.metadata.imageWidth/this.metadata.tileWidth),l=Math.ceil(this.metadata.imageLength/
    this.metadata.tileLength),q=[],p=0;p<l;p++)for(var H=0;H<k;H++){var C=k*p+H;q[C]=this.parseBlock(a,d,g,f[C],h[C],b,c,e)}return q};q.prototype.geoTiffImageToPCS=function(a,c){if(null===a||void 0===a)throw new b(k.logMessage(k.LEVEL_SEVERE,"GeoTiffReader","geoTiffImageToPCS","missingXValue"));if(null===c||void 0===c)throw new b(k.logMessage(k.LEVEL_SEVERE,"GeoTiffReader","geoTiffImageToPCS","missingYValue"));var d=[a,c],e=this.metadata.modelTiepoint,h=this.metadata.modelPixelScale,f=this.metadata.modelTransformation,
    m=e?e.length:0,q=h?h.length:0,p=f?f.length:0;6<m&&0===q||(16===p?(d=a,e=c,a=d*f[0]+e*f[1]+f[3],c=d*f[4]+e*f[5]+f[7]):3>q||6>m||(a=(a-e[0])*h[0]+e[3],c=-1*(c-e[1])*h[1]+e[4]),d=[a,c]);l.defs([["EPSG:26771","+proj=tmerc +lat_0=36.66666666666666 +lon_0=-88.33333333333333 +k=0.9999749999999999 +x_0=152400.3048006096 +y_0=0 +ellps=clrk66 +datum=NAD27 +to_meter=0.3048006096012192 +no_defs "],["EPSG:32633","+proj=utm +zone=33 +datum=WGS84 +units=m +no_defs"]]);this.metadata.projectedCSType&&(d=l("EPSG:"+
    this.metadata.projectedCSType,"EPSG:4326",d));return new g(d[1],d[0])};q.prototype.setBBox=function(){var a=this.geoTiffImageToPCS(0,0),b=this.geoTiffImageToPCS(this.metadata.imageWidth,0),c=this.geoTiffImageToPCS(0,this.metadata.imageLength);this.geoTiffImageToPCS(this.metadata.imageWidth,this.metadata.imageLength);this.metadata.bbox=new h(c.latitude,a.latitude,a.longitude,b.longitude)};q.prototype.getMetadataFromImageFileDirectory=function(){for(var a=0;a<this.imageFileDirectories[0].length;a++)switch(this.imageFileDirectories[0][a].tag){case m.Tag.BITS_PER_SAMPLE:this.metadata.bitsPerSample=
    this.imageFileDirectories[0][a].getIFDEntryValue();break;case m.Tag.COLOR_MAP:this.metadata.colorMap=this.imageFileDirectories[0][a].getIFDEntryValue();break;case m.Tag.COMPRESSION:this.metadata.compression=this.imageFileDirectories[0][a].getIFDEntryValue()[0];break;case m.Tag.EXTRA_SAMPLES:this.metadata.extraSamples=this.imageFileDirectories[0][a].getIFDEntryValue();break;case m.Tag.IMAGE_LENGTH:this.metadata.imageLength=this.imageFileDirectories[0][a].getIFDEntryValue()[0];break;case m.Tag.IMAGE_WIDTH:this.metadata.imageWidth=
    this.imageFileDirectories[0][a].getIFDEntryValue()[0];break;case m.Tag.MAX_SAMPLE_VALUE:this.metadata.maxSampleValue=this.imageFileDirectories[0][a].getIFDEntryValue()[0];break;case m.Tag.MIN_SAMPLE_VALUE:this.metadata.minSampleValue=this.imageFileDirectories[0][a].getIFDEntryValue()[0];break;case m.Tag.ORIENTATION:this.metadata.orientation=this.imageFileDirectories[0][a].getIFDEntryValue()[0];break;case m.Tag.PHOTOMETRIC_INTERPRETATION:this.metadata.photometricInterpretation=this.imageFileDirectories[0][a].getIFDEntryValue()[0];
    break;case m.Tag.PLANAR_CONFIGURATION:this.metadata.planarConfiguration=this.imageFileDirectories[0][a].getIFDEntryValue()[0];break;case m.Tag.ROWS_PER_STRIP:this.metadata.rowsPerStrip=this.imageFileDirectories[0][a].getIFDEntryValue()[0];break;case m.Tag.SAMPLES_PER_PIXEL:this.metadata.samplesPerPixel=this.imageFileDirectories[0][a].getIFDEntryValue()[0];break;case m.Tag.SAMPLE_FORMAT:this.metadata.sampleFormat=this.imageFileDirectories[0][a].getIFDEntryValue();break;case m.Tag.SOFTWARE:this.metadata.software=
    this.imageFileDirectories[0][a].getIFDEntryValue();break;case m.Tag.STRIP_BYTE_COUNTS:this.metadata.stripByteCounts=this.imageFileDirectories[0][a].getIFDEntryValue();break;case m.Tag.STRIP_OFFSETS:this.metadata.stripOffsets=this.imageFileDirectories[0][a].getIFDEntryValue();break;case m.Tag.TILE_BYTE_COUNTS:this.metadata.tileByteCounts=this.imageFileDirectories[0][a].getIFDEntryValue();break;case m.Tag.TILE_OFFSETS:this.metadata.tileOffsets=this.imageFileDirectories[0][a].getIFDEntryValue();break;
    case m.Tag.TILE_LENGTH:this.metadata.tileLength=this.imageFileDirectories[0][a].getIFDEntryValue();break;case m.Tag.TILE_WIDTH:this.metadata.tileWidth=this.imageFileDirectories[0][a].getIFDEntryValue();break;case c.Tag.GEO_ASCII_PARAMS:this.metadata.geoAsciiParams=this.imageFileDirectories[0][a].getIFDEntryValue();break;case c.Tag.GEO_DOUBLE_PARAMS:this.metadata.geoDubleParams=this.imageFileDirectories[0][a].getIFDEntryValue();break;case c.Tag.GEO_KEY_DIRECTORY:this.metadata.geoKeyDirectory=this.imageFileDirectories[0][a].getIFDEntryValue();
        break;case c.Tag.MODEL_PIXEL_SCALE:this.metadata.modelPixelScale=this.imageFileDirectories[0][a].getIFDEntryValue();break;case c.Tag.MODEL_TIEPOINT:this.metadata.modelTiepoint=this.imageFileDirectories[0][a].getIFDEntryValue();break;case c.Tag.GDAL_NODATA:this.metadata.noData=this.imageFileDirectories[0][a].getIFDEntryValue();break;default:k.log(k.LEVEL_WARNING,"Ignored GeoTiff tag: "+this.imageFileDirectories[0][a].tag)}};q.prototype.getMetadataFromGeoKeys=function(){for(var a=0;a<this.geoKeys.length;a++){var b=
    e.getTagValueAsString(c.Key,this.geoKeys[a].keyId);b?this._metadata.geotiff.geoKeys[b]=this.geoKeys[a].getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams):k.log(k.LEVEL_WARNING,"Unknown GeoTiff key: "+this.geoKeys[a].keyId)}};q.prototype.parseGeoKeys=function(){if(!this.isGeoTiff())throw new f(k.logMessage(k.LEVEL_SEVERE,"GeoTiffReader","parse","invalidGeoTiffFile"));var b=this.metadata.geoKeyDirectory;if(b)for(var d=b[3],e=0;e<d;e++){var g=b[4+4*e],h=b[5+4*e],l=b[6+4*e],m=
    b[7+4*e];switch(g){case c.Key.GTModelTypeGeoKey:this.metadata.gtModelTypeGeoKey=(new a(g,h,l,m)).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case c.Key.GTRasterTypeGeoKey:this.metadata.gtRasterTypeGeoKey=(new a(g,h,l,m)).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case c.Key.GTCitationGeoKey:this.metadata.gtCitationGeoKey=(new a(g,h,l,m)).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case c.Key.GeographicTypeGeoKey:this.metadata.geographicTypeGeoKey=
    (new a(g,h,l,m)).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case c.Key.GeogCitationGeoKey:this.metadata.geogCitationGeoKey=(new a(g,h,l,m)).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case c.Key.ProjectedCSTypeGeoKey:this.metadata.projectedCSType=(new a(g,h,l,m)).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;default:k.log(k.LEVEL_WARNING,"Ignored GeoTiff key: "+g)}}else throw new f(k.logMessage(k.LEVEL_SEVERE,
    "GeoTiffReader","parseGeoKeys","missingGeoKeyDirectoryTag"));};q.prototype.parseImageFileDirectory=function(a){if(!a)throw new b(k.logMessage(k.LEVEL_SEVERE,"GeoTiffReader","parseImageFileDirectory","missingOffset"));var c=e.getBytes(this.geoTiffData,a,2,this.isLittleEndian),d=[];a+=2;for(var g=0;g<c;a+=12,g++){var h=e.getBytes(this.geoTiffData,a,2,this.isLittleEndian),f=e.getBytes(this.geoTiffData,a+2,2,this.isLittleEndian),l=e.getBytes(this.geoTiffData,a+4,4,this.isLittleEndian),m=e.getBytes(this.geoTiffData,
    a+8,4,this.isLittleEndian);d.push(new p(h,f,l,m,this.geoTiffData,this.isLittleEndian))}this._imageFileDirectories.push(d);c=e.getBytes(this.geoTiffData,a,4,this.isLittleEndian);0!==c&&this.parseImageFileDirectory(c)};q.prototype.getIFDByTag=function(a){if(!a)throw new b(k.logMessage(k.LEVEL_SEVERE,"GeoTiffReader","getIFDByTag","missingTag"));for(var c=0;c<this.imageFileDirectories[0].length;c++)if(this.imageFileDirectories[0][c].tag===a)return this.imageFileDirectories[0][c];return null};return q});
define("src/projections/ProjectionEquirectangular",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Vec3"],function(f,b,c,a,d){var e=function(){c.call(this,"Equirectangular",!0,null)};e.prototype=Object.create(c.prototype);Object.defineProperties(e.prototype,{stateKey:{get:function(){return"projection equirectangular "}}});e.prototype.geographicToCartesian=function(c,d,e,l,m,p){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionEquirectangular",
    "geographicToCartesian","missingGlobe"));if(!p)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesian","missingResult"));p[0]=c.equatorialRadius*e*f.DEGREES_TO_RADIANS+(m?m[0]:0);p[1]=c.equatorialRadius*d*f.DEGREES_TO_RADIANS;p[2]=l;return p};e.prototype.geographicToCartesianGrid=function(c,e,k,l,m,p,q,t){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingGlobe"));if(!e)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "ProjectionEquirectangular","geographicToCartesianGrid","missingSector"));if(!m||m.length<k*l)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!t)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingResult"));c=c.equatorialRadius;var r=e.minLatitude*f.DEGREES_TO_RADIANS,u=e.maxLatitude*f.DEGREES_TO_RADIANS,w=e.minLongitude*
    f.DEGREES_TO_RADIANS;e=e.maxLongitude*f.DEGREES_TO_RADIANS;var x=(u-r)/(1<k?k-1:1),A=(e-w)/(1<l?l-1:1);p=p?p:new d(0,0,0);q=q?q[0]:0;var B,v=0,F=0,G,D,y;B=0;for(G=r;B<k;B++,G+=x)for(B===k-1&&(G=u),y=c*G-p[1],r=0,D=w;r<l;r++,D+=A)r===l-1&&(D=e),t[F++]=c*D-p[0]+q,t[F++]=y,t[F++]=m[v++]-p[2];return t};e.prototype.cartesianToGeographic=function(c,d,e,l,m,p){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionEquirectangular","cartesianToGeographic","missingGlobe"));if(!p)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "ProjectionEquirectangular","cartesianToGeographic","missingResult"));p.latitude=e/c.equatorialRadius*f.RADIANS_TO_DEGREES;p.longitude=(d-(m?m[0]:0))/c.equatorialRadius*f.RADIANS_TO_DEGREES;p.altitude=l;return p};return e});
define("src/globe/ZeroElevationModel",["../error/ArgumentError","../globe/ElevationModel","../geom/Location","../util/Logger","../geom/Sector"],function(f,b,c,a,d){var e=function(){b.call(this,d.FULL_SPHERE,new c(45,45),1," "," ",150,150);this.displayName="Zero Elevations";this.timestamp=Date.now();this.maxElevation=this.minElevation=0};e.prototype=Object.create(b.prototype);e.prototype.minAndMaxElevationsForSector=function(a){return[0,0]};e.prototype.elevationAtLocation=function(a,b){return 0};e.prototype.elevationsForGrid=
    function(b,c,d,e,m){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"ZeroElevationModel","elevationsForSector","missingSector"));if(0>=c||0>=d)throw new f(a.logMessage(a.LEVEL_SEVERE,"ZeroElevationModel","elevationsForSector","numLat or numLon is less than 1"));if(!m||m.length<c*d)throw new f(a.logMessage(a.LEVEL_SEVERE,"ZeroElevationModel","elevationsForSector","missingArray"));b=0;for(c=m.length;b<c;b++)m[b]=0;return 0};return e});
define("src/globe/Globe2D",["../globe/Globe","../projections/ProjectionEquirectangular","../globe/ZeroElevationModel"],function(f,b,c){var a=function(){f.call(this,new c,new b)};a.prototype=Object.create(f.prototype);return a});
define("src/util/GoToAnimator",["../geom/Location","../util/Logger","../geom/Position","../geom/Vec3"],function(f,b,c,a){var d=function(a){if(!a)throw new ArgumentError(b.logMessage(b.LEVEL_SEVERE,"GoToAnimator","constructor","missingWorldWindow"));this.wwd=a;this.animationFrequency=20;this.travelTime=3E3;this.cancelled=!1};d.prototype.cancel=function(){this.cancelled=!0};d.prototype.goTo=function(d,g){if(!d)throw new ArgumentError(b.logMessage(b.LEVEL_SEVERE,"GoToAnimator","goTo","missingPosition"));
    this.completionCallback=g;this.cancelled=!1;this.targetPosition=new c(d.latitude,d.longitude,d.altitude||this.wwd.navigator.range);this.startPosition=new c(this.wwd.navigator.lookAtLocation.latitude,this.wwd.navigator.lookAtLocation.longitude,this.wwd.navigator.range);this.startTime=Date.now();var h=this.travelTime,k=f.greatCircleDistance(this.startPosition,this.targetPosition),l;l=this.wwd.globe.computePointFromLocation(this.startPosition.latitude,this.startPosition.longitude,new a(0,0,0));var m=
        this.wwd.globe.computePointFromLocation(this.targetPosition.latitude,this.targetPosition.longitude,new a(0,0,0));this.maxAltitude=l.distanceTo(m);m=this.wwd.navigator.currentState().pixelSizeAtDistance(this.startPosition.altitude)*this.wwd.canvas.clientWidth/this.wwd.globe.equatorialRadius;k<=2*m&&(this.maxAltitude=this.startPosition.altitude);this.maxAltitudeReachedTime=this.maxAltitude<=this.wwd.navigator.range?Date.now():null;this.maxAltitude>this.startPosition.altitude?(l=Math.max(0,this.maxAltitude-
        this.startPosition.altitude),l+=Math.abs(this.targetPosition.altitude-this.maxAltitude)):l=Math.abs(this.targetPosition.altitude-this.startPosition.altitude);var p=Math.max(k,l/this.wwd.globe.equatorialRadius);if(0!==p){p<2*m&&(h=Math.min(p/m*this.travelTime,this.travelTime));h=Math.max(1,h);this.panVelocity=k/h;this.rangeVelocity=l/h;var q=this,t=function(){q.cancelled?q.completionCallback&&q.completionCallback(q):q.update()?setTimeout(t,q.animationFrequency):q.completionCallback&&q.completionCallback(q)};
        setTimeout(t,this.animationFrequency)}};d.prototype.update=function(){var a=new c(this.wwd.navigator.lookAtLocation.latitude,this.wwd.navigator.lookAtLocation.longitude,this.wwd.navigator.range),b=this.updateRange(a),b=this.updateLocation(a)||b;this.wwd.redraw();return b};d.prototype.updateRange=function(a){this.maxAltitudeReachedTime?(a=Date.now()-this.maxAltitudeReachedTime,this.maxAltitude>this.targetPosition.altitude?(a=this.maxAltitude-this.rangeVelocity*a,a=Math.max(a,this.targetPosition.altitude)):
    (a=this.maxAltitude+this.rangeVelocity*a,a=Math.min(a,this.targetPosition.altitude)),this.wwd.navigator.range=a,a=1<Math.abs(this.wwd.navigator.range-this.targetPosition.altitude)):(a=Date.now()-this.startTime,a=Math.min(this.startPosition.altitude+this.rangeVelocity*a,this.maxAltitude),1>Math.abs(this.wwd.navigator.range-a)&&(this.maxAltitudeReachedTime=Date.now()),this.wwd.navigator.range=a,a=!0);return a};d.prototype.updateLocation=function(a){var b=Date.now()-this.startTime,c=f.greatCircleDistance(this.startPosition,
    a),d=f.greatCircleDistance(a,this.targetPosition),l=f.greatCircleAzimuth(a,this.targetPosition),b=Math.min(this.panVelocity*b-c,d);a=f.greatCircleLocation(a,l,b,new f(0,0));l=!1;this.wwd.navigator.lookAtLocation.latitude=a.latitude;this.wwd.navigator.lookAtLocation.longitude=a.longitude;b<1/this.wwd.globe.equatorialRadius&&(l=!0);return!l};return d});
define("src/util/HighlightController",["../error/ArgumentError","../util/Logger"],function(f,b){return function(c){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"HighlightController","constructor","missingWorldWindow"));this.worldWindow=c;var a=[],d=function(b){var d=b.clientX,h=b.clientY;b=0<a.length;for(var f=0;f<a.length;f++)a[f].highlighted=!1;a=[];d=c.pick(c.canvasCoordinates(d,h));0<d.objects.length&&(b=!0);if(0<d.objects.length)for(h=0;h<d.objects.length;h++)d.objects[h].isTerrain||(d.objects[h].userObject.highlighted=
    !0,a.push(d.objects[h].userObject));b&&c.redraw()};this.worldWindow.addEventListener("mousemove",d);new WorldWind.TapRecognizer(this.worldWindow,d)}});define("src/formats/kml/KmlElements",[],function(){return{keys:{},addKey:function(f,b){this.keys[f]=b},getKey:function(f){return this.keys[f]}}});
define("src/formats/kml/util/Attribute",[],function(){var f=function(b,c){this.node=b;this.name=c};f.prototype.value=function(){return this.node.attributes&&this.node.attributes.getNamedItem(this.name)&&this.node.attributes.getNamedItem(this.name).value||null};f.prototype.exists=function(){return null!=this.value()};f.prototype.save=function(b){this.node.setAttribute(this.name,b)};return f});
define("src/formats/kml/util/NodeTransformers",["./Attribute","../KmlElements","../../../geom/Position","../../../util/WWUtil"],function(f,b,c,a){function d(a){var b;null!=a&&a.childNodes[0]?b=a.childNodes[0].nodeValue:null!=a&&(b="");return b}var e=function(){};e.string=function(a){return String(d(a))};e.number=function(a){return Number(d(a))};e["boolean"]=function(b){return a.transformToBoolean(d(b))};e.date=function(b){return a.date(d(b))};e.kmlObject=function(a,c,d){var e=b.getKey(a.nodeName);
    return e?new e({objectNode:a,parent:c,controls:d}):null};e.linearRing=function(a,c,d){var e=b.getKey("LinearRing");if(!e)return null;var f=null;Array.prototype.forEach.call(a.childNodes,function(a){"LinearRing"==a.nodeName&&(f=a)});return new e({objectNode:f,parent:c,controls:d})};e.positions=function(a){var b=[];d(a).trim().replace(/\s+/g," ").split(" ").forEach(function(a){a=a.split(",");b.push(new c(Number(a[1]),Number(a[0]),Number(a[2]||0)))});return b};e.attribute=function(a){return function(b){return(new f(b,
    a)).value()}};return e});
define("src/formats/kml/util/KmlElementsFactory",["./NodeTransformers"],function(f){var b=function(a){this.options=a};b.prototype.specific=function(a,b){var c=null,g=this;[].forEach.call(a.node.childNodes,function(h){h.nodeName==b.name&&(c=b.transformer(h,a,g.options.controls))});return c};b.prototype.any=function(a,b){var c=null,g=this;[].forEach.call(a.node.childNodes,function(h){-1!=b.name.indexOf(h.nodeName)&&(c=f.kmlObject(h,a,g.options.controls))});return c};b.prototype.all=function(a){var b=
    [],c=this;[].forEach.call(a.node.childNodes,function(g){(g=f.kmlObject(g,a,c.options.controls))&&b.push(g)});return b};var c=new b;b.applicationWide=function(){return c};return b});
define("src/formats/kml/util/TreeKeyValueCache",[],function(){var f=function(){this.map={}};f.prototype.add=function(b,a,d){this.map[b]||(this.map[b]={});this.map[b][a]=d};f.prototype.value=function(b,a){if(!this.map[b])return null;if(-1==a.indexOf("#")){var d=this.level(b),e;for(e in d)if(d.hasOwnProperty(e)){var g;g=e;var h=a;g=String.prototype.startsWith?g.startsWith(h):g.substr(0,h.length)===h;if(g)return d[e]}}return this.map[b][a]};f.prototype.level=function(b){return this.map[b]};f.prototype.remove=
    function(b,a){delete this.map[b][a]};var b=new f;f.applicationLevelCache=function(){return b};return f});
define("src/formats/kml/util/KmlElementsFactoryCached",["./Attribute","./KmlElementsFactory","./TreeKeyValueCache","../../../util/WWUtil"],function(f,b,c,a){var d=function(a){this.internalFactory=new b(a);this.cache=c.applicationLevelCache()};d.prototype.all=function(a){var b=a.node,c=this.cache.level(this.cacheKey(a.node,"All"));if(c){a=[];for(var d in c)c.hasOwnProperty(d)&&a.push(c[d]);return a}if((c=this.internalFactory.all(a))&&c.length){var e=this;c.forEach(function(a){e.cache.add(e.cacheKey(b,
    "All"),e.cacheKey(a.node),a)})}return c};d.prototype.specific=function(a,b){var c=a.node,d=b.name;b.attribute&&(d=b.attribute+d);var e=this.cache.value(this.cacheKey(c),d);if(e)return e;(e=this.internalFactory.specific(a,b))&&e.node?this.cache.add(this.cacheKey(c),this.cacheKey(e.node),e):e&&this.cache.add(this.cacheKey(c),d,e);return e};d.prototype.any=function(a,b){var c=a.node,d=this,e=null,f;b.name.forEach(function(a){(f=d.cache.value(d.cacheKey(c),a))&&(e=f)});if(e)return e;var q=this.internalFactory.any(a,
    b);q&&this.cache.add(d.cacheKey(c),d.cacheKey(q.node),q);return q};d.prototype.cacheKey=function(b,c){var d=new f(b,"id");d.exists()||d.save(a.guid());d=b.nodeName+"#"+d.value();c&&(d=c+d);return d};var e=new d;d.applicationWide=function(){return e};return d});
(function(){function f(a){return"function"===typeof a}function b(){return function(){process.nextTick(g)}}function c(){return function(){H(g)}}function a(){var a=0,b=new M(g),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=a=++a%2}}function d(){var a=new MessageChannel;a.port1.onmessage=g;return function(){a.port2.postMessage(0)}}function e(){return function(){setTimeout(g,1)}}function g(){for(var a=0;a<y;a+=2)(0,K[a])(K[a+1]),K[a]=void 0,K[a+1]=void 0;y=0}function h(){try{var a=
    require("vertx");H=a.runOnLoop||a.runOnContext;return c()}catch(b){return e()}}function k(){}function l(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function m(a,b,c){z(function(a){var d=!1,e=l(c,b,function(c){d||(d=!0,b!==c?q(a,c):r(a,c))},function(b){d||(d=!0,u(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,u(a,e))},a)}function p(a,b){1===b._state?r(a,b._result):2===b._state?u(a,b._result):w(b,void 0,function(b){q(a,b)},function(b){u(a,b)})}function q(a,b){if(a===b)u(a,new TypeError("You cannot resolve a promise with itself"));
else if("function"===typeof b||"object"===typeof b&&null!==b)if(b.constructor===a.constructor)p(a,b);else{var c;try{c=b.then}catch(d){N.error=d,c=N}c===N?u(a,N.error):void 0===c?r(a,b):f(c)?m(a,b,c):r(a,b)}else r(a,b)}function t(a){a._onerror&&a._onerror(a._result);x(a)}function r(a,b){void 0===a._state&&(a._result=b,a._state=1,0!==a._subscribers.length&&z(x,a))}function u(a,b){void 0===a._state&&(a._state=2,a._result=b,z(t,a))}function w(a,b,c,d){var e=a._subscribers,g=e.length;a._onerror=null;e[g]=
    b;e[g+1]=c;e[g+2]=d;0===g&&a._state&&z(x,a)}function x(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,g=a._result,h=0;h<b.length;h+=3)d=b[h],e=b[h+c],d?B(c,d,e,g):e(g);a._subscribers.length=0}}function A(){this.error=null}function B(a,b,c,d){var e=f(c),g,h,k,l;if(e){try{g=c(d)}catch(m){R.error=m,g=R}g===R?(l=!0,h=g.error,g=null):k=!0;if(b===g){u(b,new TypeError("A promises callback cannot return that same promise."));return}}else g=d,k=!0;void 0===b._state&&(e&&k?q(b,g):l?u(b,h):
    1===a?r(b,g):2===a&&u(b,g))}function v(a,b){try{b(function(b){q(a,b)},function(b){u(a,b)})}catch(c){u(a,c)}}function F(a,b){this._instanceConstructor=a;this.promise=new a(k);this._validateInput(b)?(this._input=b,this._remaining=this.length=b.length,this._init(),0===this.length?r(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&r(this.promise,this._result))):u(this.promise,this._validationError())}function G(a){this._id=S++;this._result=this._state=void 0;
    this._subscribers=[];if(k!==a){if(!f(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof G))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");v(this,a)}}var D=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},y=0,H,C,z=function(a,b){K[y]=a;K[y+1]=b;y+=2;2===y&&(C?C(g):O())},E="undefined"!==
typeof window?window:void 0,L=E||{},M=L.MutationObserver||L.WebKitMutationObserver,L="undefined"!==typeof process&&"[object process]"==={}.toString.call(process),I="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,K=Array(1E3),O;O=L?b():M?a():I?d():void 0===E&&"function"===typeof require?h():e();var N=new A,R=new A;F.prototype._validateInput=function(a){return D(a)};F.prototype._validationError=function(){return Error("Array Methods must be provided an Array")};
    F.prototype._init=function(){this._result=Array(this.length)};F.prototype._enumerate=function(){for(var a=this.length,b=this.promise,c=this._input,d=0;void 0===b._state&&d<a;d++)this._eachEntry(c[d],d)};F.prototype._eachEntry=function(a,b){var c=this._instanceConstructor;"object"===typeof a&&null!==a?a.constructor===c&&void 0!==a._state?(a._onerror=null,this._settledAt(a._state,b,a._result)):this._willSettleAt(c.resolve(a),b):(this._remaining--,this._result[b]=a)};F.prototype._settledAt=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         b,c){var d=this.promise;void 0===d._state&&(this._remaining--,2===a?u(d,c):this._result[b]=c);0===this._remaining&&r(d,this._result)};F.prototype._willSettleAt=function(a,b){var c=this;w(a,void 0,function(a){c._settledAt(1,b,a)},function(a){c._settledAt(2,b,a)})};var S=0;G.all=function(a){return(new F(this,a)).promise};G.race=function(a){function b(a){q(d,a)}function c(a){u(d,a)}var d=new this(k);if(!D(a))return u(d,new TypeError("You must pass an array to race.")),d;for(var e=a.length,g=0;void 0===
    d._state&&g<e;g++)w(this.resolve(a[g]),void 0,b,c);return d};G.resolve=function(a){if(a&&"object"===typeof a&&a.constructor===this)return a;var b=new this(k);q(b,a);return b};G.reject=function(a){var b=new this(k);u(b,a);return b};G._setScheduler=function(a){C=a};G._setAsap=function(a){z=a};G._asap=z;G.prototype={constructor:G,then:function(a,b){var c=this._state;if(1===c&&!a||2===c&&!b)return this;var d=new this.constructor(k),e=this._result;if(c){var g=arguments[c-1];z(function(){B(c,d,g,e)})}else w(this,
        d,a,b);return d},"catch":function(a){return this.then(null,a)}};var E=function(){var a;if("undefined"!==typeof Q)a=Q;else if("undefined"!==typeof self)a=self;else try{a=Function("return this")()}catch(b){throw Error("polyfill failed because global object is unavailable in this environment");}var c=a.Promise;if(!c||"[object Promise]"!==Object.prototype.toString.call(c.resolve())||c.cast)a.Promise=G},P={Promise:G,polyfill:E};"function"===typeof define&&define.amd?define("src/util/es6-promise",[],function(){return P}):
        "undefined"!==typeof module&&module.exports?module.exports=P:"undefined"!==typeof this&&(this.ES6Promise=P);var Q={};E()}).call(this);define("src/util/Promise",["./es6-promise"],function(f){return window.Promise?window.Promise:f.Promise});
define("src/formats/kml/KmlObject","../../error/ArgumentError ./util/Attribute ./KmlElements ./util/KmlElementsFactoryCached ../../util/Logger ../../util/Promise ../../render/Renderable".split(" "),function(f,b,c,a,d,e,g){c=function(b){g.call(this);b=b||{};if(!b.objectNode)throw new f(d.logMessage(d.LEVEL_SEVERE,"KmlObject","constructor","Passed node isn't defined."));this._node=b.objectNode;this._cache={};this._controls=b.controls||[];this._factory=new a({controls:this._controls});this.hook(this._controls,
    b)};c.prototype=Object.create(g.prototype);Object.defineProperties(c.prototype,{id:{get:function(){return(new b(this.node,"id")).value()}},node:{get:function(){return this._node}}});c.prototype.hook=function(a,b){var c=this;a.forEach(function(a){a.hook(c,b)})};c.prototype.render=function(a){};c.prototype.getTagNames=function(){return[]};return c});
define("src/formats/kml/util/ImagePyramid",["../KmlElements","../KmlObject","../util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlTileSize:{get:function(){return this._factory.specific(this,{name:"tileSize",transformer:c.number})}},kmlMaxWidth:{get:function(){return this._factory.specific(this,{name:"maxWidth",transformer:c.number})}},kmlMaxHeight:{get:function(){return this._factory.specific(this,
    {name:"maxHeight",transformer:c.number})}},kmlGridOrigin:{get:function(){return this._factory.specific(this,{name:"gridOrigin",transformer:c.string})}}});a.prototype.getTagNames=function(){return["ImagePyramid"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/util/ItemIcon",["./../KmlElements","../KmlObject","./NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlState:{get:function(){return this._factory.specific(this,{name:"state",transformer:c.string})}},kmlHref:{get:function(){return this._factory.specific(this,{name:"href",transformer:c.string})}}});a.prototype.getTagNames=function(){return["ItemIcon"]};f.addKey(a.prototype.getTagNames()[0],
    a);return a});define("src/formats/kml/KmlTimePrimitive",["./KmlObject"],function(f){var b=function(b){f.call(this,b)};b.prototype=Object.create(f.prototype);b.prototype.timeRange=function(){var b,a;this.kmlBegin&&(a=b=this.kmlBegin.valueOf());this.kmlEnd&&(a=this.kmlEnd.valueOf(),b||(b=a));this.kmlWhen&&(a=b=this.kmlWhen.valueOf());return{from:b,to:a}};b.prototype.getTagNames=function(){return["TimeSpan","TimeStamp"]};return b});
define("src/formats/kml/KmlAbstractView",["./KmlObject","./KmlElements","./KmlTimePrimitive"],function(f,b,c){b=function(a){f.call(this,a)};b.prototype=Object.create(f.prototype);Object.defineProperties(b.prototype,{kmlTimePrimitive:{get:function(){return this._factory.any(this,{name:c.prototype.getTagNames()})}}});b.prototype.getTagNames=function(){return["Camera","LookAt"]};return b});
define("src/formats/kml/styles/KmlSubStyle",["./../KmlObject"],function(f){var b=function(b){f.call(this,b)};b.prototype=Object.create(f.prototype);b.prototype.getTagNames=function(){return"LineStyle PolyStyle IconStyle LabelStyle BalloonStyle ListStyle".split(" ")};return b});
define("src/formats/kml/styles/KmlBalloonStyle",["../KmlElements","./KmlSubStyle","../util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlBgColor:{get:function(){return this._factory.specific(this,{name:"bgColor",transformer:c.string})}},kmlTextColor:{get:function(){return this._factory.specific(this,{name:"textColor",transformer:c.string})}},kmlText:{get:function(){return this._factory.specific(this,
    {name:"text",transformer:c.string})}},kmlDisplayMode:{get:function(){return this._factory.specific(this,{name:"displayMode",transformer:c.string})}}});a.update=function(){};a.prototype.getTagNames=function(){return["BalloonStyle"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/KmlCamera",["./KmlElements","./KmlAbstractView","./util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:c.string})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:c.string})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",
    transformer:c.string})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:c.string})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:c.string})}},kmlRoll:{get:function(){return this._factory.specific(this,{name:"roll",transformer:c.string})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:c.string})}}});a.prototype.getTagNames=function(){return["Camera"]};f.addKey(a.prototype.getTagNames()[0],
    a);return a});
define("src/formats/kml/styles/KmlColorStyle",["./KmlSubStyle","../util/NodeTransformers"],function(f,b){var c=function(a){f.call(this,a)};c.prototype=Object.create(f.prototype);Object.defineProperties(c.prototype,{kmlColor:{get:function(){return this._factory.specific(this,{name:"color",transformer:b.string})}},kmlColorMode:{get:function(){return this._factory.specific(this,{name:"colorMode",transformer:b.string})}}});c.prototype.getTagNames=function(){return["LineStyle","PolyStyle","IconStyle",
    "LabelStyle"]};return c});
!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define("src/util/jszip",[],f);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self);b.JSZip=f()}}(function(){return function b(c,a,d){function e(h,l){if(!a[h]){if(!c[h]){var m="function"==typeof require&&require;if(!l&&m)return m(h,!0);if(g)return g(h,!0);throw Error("Cannot find module '"+h+"'");}m=a[h]=
{exports:{}};c[h][0].call(m.exports,function(a){var b=c[h][1][a];return e(b?b:a)},m,m.exports,b,c,a,d)}return a[h].exports}for(var g="function"==typeof require&&require,h=0;h<d.length;h++)e(d[h]);return e}({1:[function(b,c,a){a.encode=function(a,b){for(var c="",h,k,l,m,p,q,t=0;t<a.length;)h=a.charCodeAt(t++),k=a.charCodeAt(t++),l=a.charCodeAt(t++),m=h>>2,h=(h&3)<<4|k>>4,p=(k&15)<<2|l>>6,q=l&63,isNaN(k)?p=q=64:isNaN(l)&&(q=64),c=c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(p)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(q);return c};a.decode=function(a,b){var c="",h,k,l,m,p,q=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");q<a.length;)h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(q++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(q++)),
    m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(q++)),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(q++)),h=h<<2|k>>4,k=(k&15)<<4|m>>2,l=(m&3)<<6|p,c+=String.fromCharCode(h),64!=m&&(c+=String.fromCharCode(k)),64!=p&&(c+=String.fromCharCode(l));return c}},{}],2:[function(b,c,a){function d(){this.crc32=this.uncompressedSize=this.compressedSize=0;this.compressedContent=this.compressionMethod=null}d.prototype={getContent:function(){return null},
    getCompressedContent:function(){return null}};c.exports=d},{}],3:[function(b,c,a){a.STORE={magic:"\x00\x00",compress:function(a,b){return a},uncompress:function(a){return a},compressInputType:null,uncompressInputType:null};a.DEFLATE=b("./flate")},{"./flate":8}],4:[function(b,c,a){var d=b("./utils"),e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,
    450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,
    4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,
    3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,
    2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,
    2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,
    755167117];c.exports=function(a,b){if("undefined"===typeof a||!a.length)return 0;var c="string"!==d.getTypeOf(a);"undefined"==typeof b&&(b=0);var l;b^=-1;for(var m=0,p=a.length;m<p;m++)l=c?a[m]:a.charCodeAt(m),l=(b^l)&255,l=e[l],b=b>>>8^l;return b^-1}},{"./utils":21}],5:[function(b,c,a){function d(a){this.data=null;this.index=this.length=0}var e=b("./utils");d.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<a||0>a)throw Error("End of data reached (data length = "+
    this.length+", asked index = "+a+"). Corrupted zip ?");},setIndex:function(a){this.checkIndex(a);this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(a){},readInt:function(a){var b=0,c;this.checkOffset(a);for(c=this.index+a-1;c>=this.index;c--)b=(b<<8)+this.byteAt(c);this.index+=a;return b},readString:function(a){return e.transformTo("string",this.readData(a))},readData:function(a){},lastIndexOfSignature:function(a){},readDate:function(){var a=this.readInt(4);return new Date((a>>
    25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1)}};c.exports=d},{"./utils":21}],6:[function(b,c,a){a.base64=!1;a.binary=!1;a.dir=!1;a.createFolders=!1;a.date=null;a.compression=null;a.compressionOptions=null;a.comment=null;a.unixPermissions=null;a.dosPermissions=null},{}],7:[function(b,c,a){var d=b("./utils");a.string2binary=function(a){return d.string2binary(a)};a.string2Uint8Array=function(a){return d.transformTo("uint8array",a)};a.uint8Array2String=function(a){return d.transformTo("string",
    a)};a.string2Blob=function(a){a=d.transformTo("arraybuffer",a);return d.arrayBuffer2Blob(a)};a.arrayBuffer2Blob=function(a){return d.arrayBuffer2Blob(a)};a.transformTo=function(a,b){return d.transformTo(a,b)};a.getTypeOf=function(a){return d.getTypeOf(a)};a.checkSupport=function(a){return d.checkSupport(a)};a.MAX_VALUE_16BITS=d.MAX_VALUE_16BITS;a.MAX_VALUE_32BITS=d.MAX_VALUE_32BITS;a.pretty=function(a){return d.pretty(a)};a.findCompression=function(a){return d.findCompression(a)};a.isRegExp=function(a){return d.isRegExp(a)}},
    {"./utils":21}],8:[function(b,c,a){c="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;var d=b("pako");a.uncompressInputType=c?"uint8array":"array";a.compressInputType=c?"uint8array":"array";a.magic="\b\x00";a.compress=function(a,b){return d.deflateRaw(a,{level:b.level||-1})};a.uncompress=function(a){return d.inflateRaw(a)}},{pako:24}],9:[function(b,c,a){function d(a,b){if(!(this instanceof d))return new d(a,b);this.files={};this.comment=null;this.root=
    "";a&&this.load(a,b);this.clone=function(){var a=new d,b;for(b in this)"function"!==typeof this[b]&&(a[b]=this[b]);return a}}var e=b("./base64");d.prototype=b("./object");d.prototype.load=b("./load");d.support=b("./support");d.defaults=b("./defaults");d.utils=b("./deprecatedPublicUtils");d.base64={encode:function(a){return e.encode(a)},decode:function(a){return e.decode(a)}};d.compressions=b("./compressions");c.exports=d},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,
    "./load":10,"./object":13,"./support":17}],10:[function(b,c,a){var d=b("./base64"),e=b("./zipEntries");c.exports=function(a,b){var c,l,m,p;b=b||{};b.base64&&(a=d.decode(a));l=new e(a,b);c=l.files;for(m=0;m<c.length;m++)p=c[m],this.file(p.fileName,p.decompressed,{binary:!0,optimizedBinaryString:!0,date:p.date,dir:p.dir,comment:p.fileComment.length?p.fileComment:null,unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions,createFolders:b.createFolders});l.zipComment.length&&(this.comment=
    l.zipComment);return this}},{"./base64":1,"./zipEntries":22}],11:[function(b,c,a){(function(a){c.exports=function(b,c){return new a(b,c)};c.exports.test=function(b){return a.isBuffer(b)}}).call(this,"undefined"!==typeof Buffer?Buffer:void 0)},{}],12:[function(b,c,a){function d(a){this.data=a;this.length=this.data.length;this.index=0}b=b("./uint8ArrayReader");d.prototype=new b;d.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.index,this.index+a);this.index+=a;return b};
    c.exports=d},{"./uint8ArrayReader":18}],13:[function(b,c,a){var d=b("./support"),e=b("./utils"),g=b("./crc32"),h=b("./signature"),k=b("./defaults"),l=b("./base64"),m=b("./compressions"),p=b("./compressedObject"),q=b("./nodeBuffer"),t=b("./utf8"),r=b("./stringWriter"),u=b("./uint8ArrayWriter"),w=function(a){if(a._data instanceof p&&(a._data=a._data.getContent(),a.options.binary=!0,a.options.base64=!1,"uint8array"===e.getTypeOf(a._data))){var b=a._data;a._data=new Uint8Array(b.length);0!==b.length&&
a._data.set(b,0)}return a._data},x=function(a){var b=w(a);return"string"===e.getTypeOf(b)?!a.options.binary&&d.nodebuffer?q(b,"utf-8"):a.asBinary():b},A=function(a){var b=w(this);if(null===b||"undefined"===typeof b)return"";this.options.base64&&(b=l.decode(b));b=a&&this.options.binary?H.utf8decode(b):e.transformTo("string",b);a||this.options.binary||(b=e.transformTo("string",H.utf8encode(b)));return b},B=function(a,b,c){this.name=a;this.dir=c.dir;this.date=c.date;this.comment=c.comment;this.unixPermissions=
    c.unixPermissions;this.dosPermissions=c.dosPermissions;this._data=b;this.options=c;this._initialMetadata={dir:c.dir,date:c.date}};B.prototype={asText:function(){return A.call(this,!0)},asBinary:function(){return A.call(this,!1)},asNodeBuffer:function(){var a=x(this);return e.transformTo("nodebuffer",a)},asUint8Array:function(){var a=x(this);return e.transformTo("uint8array",a)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var v=function(a,b){var c="",d;for(d=0;d<b;d++)c+=String.fromCharCode(a&
    255),a>>>=8;return c},F=function(){var a={},b,c;for(b=0;b<arguments.length;b++)for(c in arguments[b])arguments[b].hasOwnProperty(c)&&"undefined"===typeof a[c]&&(a[c]=arguments[b][c]);return a},G=function(a,b,c){var d=e.getTypeOf(b),g;c=c||{};!0!==c.base64||null!==c.binary&&void 0!==c.binary||(c.binary=!0);c=F(c,k);c.date=c.date||new Date;null!==c.compression&&(c.compression=c.compression.toUpperCase());"string"===typeof c.unixPermissions&&(c.unixPermissions=parseInt(c.unixPermissions,8));c.unixPermissions&&
c.unixPermissions&16384&&(c.dir=!0);c.dosPermissions&&c.dosPermissions&16&&(c.dir=!0);c.dir&&(a=D(a));var h;if(h=c.createFolders)g=a,"/"==g.slice(-1)&&(g=g.substring(0,g.length-1)),h=g.lastIndexOf("/"),h=g=0<h?g.substring(0,h):"";h&&y.call(this,g,!0);if(c.dir||null===b||"undefined"===typeof b)c.base64=!1,c.binary=!1,b=null;else if("string"===d)c.binary&&!c.base64&&!0!==c.optimizedBinaryString&&(b=e.string2binary(b));else{c.base64=!1;c.binary=!0;if(!(d||b instanceof p))throw Error("The data of '"+
    a+"' is in an unsupported format !");"arraybuffer"===d&&(b=e.transformTo("uint8array",b))}b=new B(a,b,c);return this.files[a]=b},D=function(a){"/"!=a.slice(-1)&&(a+="/");return a},y=function(a,b){b="undefined"!==typeof b?b:!1;a=D(a);this.files[a]||G.call(this,a,null,{dir:!0,createFolders:b});return this.files[a]},H={load:function(a,b){throw Error("Load method is not defined. Is the file jszip-load.js included ?");},filter:function(a){var b=[],c,d,e;for(c in this.files)this.files.hasOwnProperty(c)&&
(d=this.files[c],e=new B(d.name,d._data,F(d.options)),d=c.slice(this.root.length,c.length),c.slice(0,this.root.length)===this.root&&a(d,e)&&b.push(e));return b},file:function(a,b,c){if(1===arguments.length){if(e.isRegExp(a)){var d=a;return this.filter(function(a,b){return!b.dir&&d.test(a)})}return this.filter(function(b,c){return!c.dir&&b===a})[0]||null}a=this.root+a;G.call(this,a,b,c);return this},folder:function(a){if(!a)return this;if(e.isRegExp(a))return this.filter(function(b,c){return c.dir&&
    a.test(b)});var b=y.call(this,this.root+a),c=this.clone();c.root=b.name;return c},remove:function(a){a=this.root+a;var b=this.files[a];b||("/"!=a.slice(-1)&&(a+="/"),b=this.files[a]);if(b&&!b.dir)delete this.files[a];else for(var b=this.filter(function(b,c){return c.name.slice(0,a.length)===a}),c=0;c<b.length;c++)delete this.files[b[c].name];return this},generate:function(a){a=F(a||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip"});
    e.checkSupport(a.type);if("darwin"===a.platform||"freebsd"===a.platform||"linux"===a.platform||"sunos"===a.platform)a.platform="UNIX";"win32"===a.platform&&(a.platform="DOS");var b=[],c=0,d=0,k=e.transformTo("string",this.utf8encode(a.comment||this.comment||"")),q;for(q in this.files)if(this.files.hasOwnProperty(q)){var A=this.files[q],w=A.options.compression||a.compression.toUpperCase(),B=m[w];if(!B)throw Error(w+" is not a valid compression method !");var w=A,y=A.options.compressionOptions||a.compressionOptions||
        {},H=new p,P;if(w._data instanceof p)H.uncompressedSize=w._data.uncompressedSize,H.crc32=w._data.crc32,0===H.uncompressedSize||w.dir?(B=m.STORE,H.compressedContent="",H.crc32=0):w._data.compressionMethod===B.magic?H.compressedContent=w._data.getCompressedContent():(P=w._data.getContent(),H.compressedContent=B.compress(e.transformTo(B.compressInputType,P),y));else{P=x(w);if(!P||0===P.length||w.dir)B=m.STORE,P="";H.uncompressedSize=P.length;H.crc32=g(P);H.compressedContent=B.compress(e.transformTo(B.compressInputType,
        P),y)}H.compressedSize=H.compressedContent.length;H.compressionMethod=B.magic;var w=H,D=A,A=w,B=c,G=a.platform,y=e.transformTo("string",t.utf8encode(D.name));P=D.comment||"";var H=e.transformTo("string",t.utf8encode(P)),V=y.length!==D.name.length,Y=H.length!==P.length,W=D.options,U;P="";var T;U=D._initialMetadata.dir!==D.dir?D.dir:W.dir;T=D._initialMetadata.date!==D.date?D.date:W.date;W=0;U&&(W|=16);if("UNIX"===G){var G=798,Z=D=D.unixPermissions;D||(Z=U?16893:33204);W|=(Z&65535)<<16}else G=20,W|=
        (D.dosPermissions||0)&63;U=T.getHours();U=U<<6|T.getMinutes();U=U<<5|T.getSeconds()/2;D=T.getFullYear()-1980;D=D<<4|T.getMonth()+1;D=D<<5|T.getDate();V&&(T=v(1,1)+v(g(y),4)+y,P+="up"+v(T.length,2)+T);Y&&(T=v(1,1)+v(this.crc32(H),4)+H,P+="uc"+v(T.length,2)+T);V="\n\x00"+(V||Y?"\x00\b":"\x00\x00")+A.compressionMethod;V+=v(U,2);V+=v(D,2);V+=v(A.crc32,4);V+=v(A.compressedSize,4);V+=v(A.uncompressedSize,4);V+=v(y.length,2);V+=v(P.length,2);Y=h.LOCAL_FILE_HEADER+V+y+P;B=h.CENTRAL_FILE_HEADER+v(G,2)+V+v(H.length,
            2)+"\x00\x00\x00\x00"+v(W,4)+v(B,4)+y+P+H;A={fileRecord:Y,dirRecord:B,compressedObject:A};c+=A.fileRecord.length+w.compressedSize;d+=A.dirRecord.length;b.push(A)}k=h.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+v(b.length,2)+v(b.length,2)+v(d,4)+v(c,4)+v(k.length,2)+k;q=a.type.toLowerCase();c="uint8array"===q||"arraybuffer"===q||"blob"===q||"nodebuffer"===q?new u(c+d+k.length):new r(c+d+k.length);for(d=0;d<b.length;d++)c.append(b[d].fileRecord),c.append(b[d].compressedObject.compressedContent);for(d=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;d<b.length;d++)c.append(b[d].dirRecord);c.append(k);b=c.finalize();switch(a.type.toLowerCase()){case "uint8array":case "arraybuffer":case "nodebuffer":return e.transformTo(a.type.toLowerCase(),b);case "blob":return e.arrayBuffer2Blob(e.transformTo("arraybuffer",b),a.mimeType);case "base64":return a.base64?l.encode(b):b;default:return b}},crc32:function(a,b){return g(a,b)},utf8encode:function(a){return e.transformTo("string",t.utf8encode(a))},utf8decode:function(a){return t.utf8decode(a)}};c.exports=
    H},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(b,c,a){a.LOCAL_FILE_HEADER="PK\u0003\u0004";a.CENTRAL_FILE_HEADER="PK\u0001\u0002";a.CENTRAL_DIRECTORY_END="PK\u0005\u0006";a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\u0006\u0007";a.ZIP64_CENTRAL_DIRECTORY_END="PK\u0006\u0006";a.DATA_DESCRIPTOR="PK\u0007\b"},{}],15:[function(b,c,a){function d(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 b){this.data=a;b||(this.data=e.string2binary(this.data));this.length=this.data.length;this.index=0}a=b("./dataReader");var e=b("./utils");d.prototype=new a;d.prototype.byteAt=function(a){return this.data.charCodeAt(a)};d.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)};d.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.index,this.index+a);this.index+=a;return b};c.exports=d},{"./dataReader":5,"./utils":21}],16:[function(b,c,a){var d=b("./utils");
    b=function(){this.data=[]};b.prototype={append:function(a){a=d.transformTo("string",a);this.data.push(a)},finalize:function(){return this.data.join("")}};c.exports=b},{"./utils":21}],17:[function(b,c,a){b="undefined"!==typeof Buffer?Buffer:void 0;a.base64=!0;a.array=!0;a.string=!0;a.arraybuffer="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8Array;a.nodebuffer="undefined"!==typeof b;a.uint8array="undefined"!==typeof Uint8Array;if("undefined"===typeof ArrayBuffer)a.blob=!1;else{b=new ArrayBuffer(0);
    try{a.blob=0===(new Blob([b],{type:"application/zip"})).size}catch(e){try{var d=new (window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);d.append(b);a.blob=0===d.getBlob("application/zip").size}catch(g){a.blob=!1}}}},{}],18:[function(b,c,a){function d(a){a&&(this.data=a,this.length=this.data.length,this.index=0)}b=b("./dataReader");d.prototype=new b;d.prototype.byteAt=function(a){return this.data[a]};d.prototype.lastIndexOfSignature=function(a){var b=a.charCodeAt(0),
    c=a.charCodeAt(1),d=a.charCodeAt(2);a=a.charCodeAt(3);for(var l=this.length-4;0<=l;--l)if(this.data[l]===b&&this.data[l+1]===c&&this.data[l+2]===d&&this.data[l+3]===a)return l;return-1};d.prototype.readData=function(a){this.checkOffset(a);if(0===a)return new Uint8Array(0);var b=this.data.subarray(this.index,this.index+a);this.index+=a;return b};c.exports=d},{"./dataReader":5}],19:[function(b,c,a){var d=b("./utils");b=function(a){this.data=new Uint8Array(a);this.index=0};b.prototype={append:function(a){0!==
a.length&&(a=d.transformTo("uint8array",a),this.data.set(a,this.index),this.index+=a.length)},finalize:function(){return this.data}};c.exports=b},{"./utils":21}],20:[function(b,c,a){var d=b("./utils"),e=b("./support"),g=b("./nodeBuffer"),h=Array(256);for(b=0;256>b;b++)h[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;h[254]=h[254]=1;var k=function(a){var b,c,e,g,k=a.length,u=Array(2*k);for(b=c=0;b<k;)if(e=a[b++],128>e)u[c++]=e;else if(g=h[e],4<g)u[c++]=65533,b+=g-1;else{for(e&=2===g?31:3===g?15:
    7;1<g&&b<k;)e=e<<6|a[b++]&63,g--;1<g?u[c++]=65533:65536>e?u[c++]=e:(e-=65536,u[c++]=55296|e>>10&1023,u[c++]=56320|e&1023)}u.length!==c&&(u.subarray?u=u.subarray(0,c):u.length=c);return d.applyFromCharCode(u)};a.utf8encode=function(a){if(e.nodebuffer)return g(a,"utf-8");var b,c,d,h,k,u=a.length,w=0;for(h=0;h<u;h++)c=a.charCodeAt(h),55296===(c&64512)&&h+1<u&&(d=a.charCodeAt(h+1),56320===(d&64512)&&(c=65536+(c-55296<<10)+(d-56320),h++)),w+=128>c?1:2048>c?2:65536>c?3:4;b=e.uint8array?new Uint8Array(w):
    Array(w);for(h=k=0;k<w;h++)c=a.charCodeAt(h),55296===(c&64512)&&h+1<u&&(d=a.charCodeAt(h+1),56320===(d&64512)&&(c=65536+(c-55296<<10)+(d-56320),h++)),128>c?b[k++]=c:(2048>c?b[k++]=192|c>>>6:(65536>c?b[k++]=224|c>>>12:(b[k++]=240|c>>>18,b[k++]=128|c>>>12&63),b[k++]=128|c>>>6&63),b[k++]=128|c&63);return b};a.utf8decode=function(a){if(e.nodebuffer)return d.transformTo("nodebuffer",a).toString("utf-8");a=d.transformTo(e.uint8array?"uint8array":"array",a);for(var b=[],c=0,g=a.length;c<g;){var t;t=Math.min(c+
    65536,g);var r;t=t||a.length;t>a.length&&(t=a.length);for(r=t-1;0<=r&&128===(a[r]&192);)r--;t=0>r?t:0===r?t:r+h[a[r]]>t?r:t;e.uint8array?b.push(k(a.subarray(c,t))):b.push(k(a.slice(c,t)));c=t}return b.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(b,c,a){function d(a){return a}function e(a,b){for(var c=0;c<a.length;++c)b[c]=a.charCodeAt(c)&255;return b}function g(b){var c=65536,d=[],e=b.length,g=a.getTypeOf(b),h=0,k=!0;try{switch(g){case "uint8array":String.fromCharCode.apply(null,
    new Uint8Array(0));break;case "nodebuffer":String.fromCharCode.apply(null,m(0))}}catch(l){k=!1}if(!k){c="";for(d=0;d<b.length;d++)c+=String.fromCharCode(b[d]);return c}for(;h<e&&1<c;)try{"array"===g||"nodebuffer"===g?d.push(String.fromCharCode.apply(null,b.slice(h,Math.min(h+c,e)))):d.push(String.fromCharCode.apply(null,b.subarray(h,Math.min(h+c,e)))),h+=c}catch(l){c=Math.floor(c/2)}return d.join("")}function h(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b}var k=b("./support"),l=b("./compressions"),
    m=b("./nodeBuffer");a.string2binary=function(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a.charCodeAt(c)&255);return b};a.arrayBuffer2Blob=function(b,c){a.checkSupport("blob");c=c||"application/zip";try{return new Blob([b],{type:c})}catch(d){try{var e=new (window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);e.append(b);return e.getBlob(c)}catch(g){throw Error("Bug : can't construct the Blob.");}}};a.applyFromCharCode=g;var p={};p.string={string:d,
    array:function(a){return e(a,Array(a.length))},arraybuffer:function(a){return p.string.uint8array(a).buffer},uint8array:function(a){return e(a,new Uint8Array(a.length))},nodebuffer:function(a){return e(a,m(a.length))}};p.array={string:g,array:d,arraybuffer:function(a){return(new Uint8Array(a)).buffer},uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return m(a)}};p.arraybuffer={string:function(a){return g(new Uint8Array(a))},array:function(a){return h(new Uint8Array(a),Array(a.byteLength))},
    arraybuffer:d,uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return m(new Uint8Array(a))}};p.uint8array={string:g,array:function(a){return h(a,Array(a.length))},arraybuffer:function(a){return a.buffer},uint8array:d,nodebuffer:function(a){return m(a)}};p.nodebuffer={string:g,array:function(a){return h(a,Array(a.length))},arraybuffer:function(a){return p.nodebuffer.uint8array(a).buffer},uint8array:function(a){return h(a,new Uint8Array(a.length))},nodebuffer:d};a.transformTo=
    function(b,c){c||(c="");if(!b)return c;a.checkSupport(b);var d=a.getTypeOf(c);return p[d][b](c)};a.getTypeOf=function(a){if("string"===typeof a)return"string";if("[object Array]"===Object.prototype.toString.call(a))return"array";if(k.nodebuffer&&m.test(a))return"nodebuffer";if(k.uint8array&&a instanceof Uint8Array)return"uint8array";if(k.arraybuffer&&a instanceof ArrayBuffer)return"arraybuffer"};a.checkSupport=function(a){if(!k[a.toLowerCase()])throw Error(a+" is not supported by this browser");};
    a.MAX_VALUE_16BITS=65535;a.MAX_VALUE_32BITS=-1;a.pretty=function(a){var b="",c,d;for(d=0;d<(a||"").length;d++)c=a.charCodeAt(d),b+="\\x"+(16>c?"0":"")+c.toString(16).toUpperCase();return b};a.findCompression=function(a){for(var b in l)if(l.hasOwnProperty(b)&&l[b].magic===a)return l[b];return null};a.isRegExp=function(a){return"[object RegExp]"===Object.prototype.toString.call(a)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(b,c,a){function d(a,b){this.files=[];this.loadOptions=
    b;a&&this.load(a)}var e=b("./stringReader"),g=b("./nodeBufferReader"),h=b("./uint8ArrayReader"),k=b("./utils"),l=b("./signature"),m=b("./zipEntry"),p=b("./support"),q=b("./object");d.prototype={checkSignature:function(a){var b=this.reader.readString(4);if(b!==a)throw Error("Corrupted zip or bug : unexpected signature ("+k.pretty(b)+", expected "+k.pretty(a)+")");},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=
    this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength);this.zipComment=q.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=
    this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};for(var a=this.zip64EndOfCentralSize-44,b,c,d;0<a;)b=this.reader.readInt(2),c=this.reader.readInt(4),d=this.reader.readString(c),this.zip64ExtensibleData[b]={id:b,length:c,value:d}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=
    this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(1<this.disksCount)throw Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var a,b;for(a=0;a<this.files.length;a++)b=this.files[a],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var a;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===
l.CENTRAL_FILE_HEADER;)a=new m({zip64:this.zip64},this.loadOptions),a.readCentralPart(this.reader),this.files.push(a)},readEndOfCentral:function(){var a=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(-1===a){a=!0;try{this.reader.setIndex(0),this.checkSignature(l.LOCAL_FILE_HEADER),a=!1}catch(b){}if(a)throw Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html");throw Error("Corrupted zip : can't find end of central directory");
}this.reader.setIndex(a);this.checkSignature(l.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===k.MAX_VALUE_16BITS||this.diskWithCentralDirStart===k.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===k.MAX_VALUE_16BITS||this.centralDirRecords===k.MAX_VALUE_16BITS||this.centralDirSize===k.MAX_VALUE_32BITS||this.centralDirOffset===k.MAX_VALUE_32BITS){this.zip64=!0;a=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(-1===a)throw Error("Corrupted zip : can't find the ZIP64 end of central directory locator");
    this.reader.setIndex(a);this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},prepareReader:function(a){var b=k.getTypeOf(a);this.reader="string"!==b||p.uint8array?"nodebuffer"===b?new g(a):new h(k.transformTo("uint8array",a)):new e(a,this.loadOptions.optimizedBinaryString)},load:function(a){this.prepareReader(a);
    this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};c.exports=d},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(b,c,a){function d(a,b){this.options=a;this.loadOptions=b}var e=b("./stringReader"),g=b("./utils"),h=b("./compressedObject"),k=b("./object");d.prototype={isEncrypted:function(){return 1===(this.bitFlag&1)},useUTF8:function(){return 2048===(this.bitFlag&2048)},
    prepareCompressedContent:function(a,b,c){return function(){var d=a.index;a.setIndex(b);var e=a.readData(c);a.setIndex(d);return e}},prepareContent:function(a,b,c,d,e){return function(){var a=g.transformTo(d.uncompressInputType,this.getCompressedContent()),a=d.uncompress(a);if(a.length!==e)throw Error("Bug : uncompressed data size mismatch");return a}},readLocalPart:function(a){var b;a.skip(22);this.fileNameLength=a.readInt(2);b=a.readInt(2);this.fileName=a.readString(this.fileNameLength);a.skip(b);
        if(-1==this.compressedSize||-1==this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");b=g.findCompression(this.compressionMethod);if(null===b)throw Error("Corrupted zip : compression "+g.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");this.decompressed=new h;this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;
        this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;this.decompressed.getCompressedContent=this.prepareCompressedContent(a,a.index,this.compressedSize,b);this.decompressed.getContent=this.prepareContent(a,a.index,this.compressedSize,b,this.uncompressedSize);if(this.loadOptions.checkCRC32&&(this.decompressed=g.transformTo("string",this.decompressed.getContent()),k.crc32(this.decompressed)!==this.crc32))throw Error("Corrupted zip : CRC32 mismatch");},readCentralPart:function(a){this.versionMadeBy=
        a.readInt(2);this.versionNeeded=a.readInt(2);this.bitFlag=a.readInt(2);this.compressionMethod=a.readString(2);this.date=a.readDate();this.crc32=a.readInt(4);this.compressedSize=a.readInt(4);this.uncompressedSize=a.readInt(4);this.fileNameLength=a.readInt(2);this.extraFieldsLength=a.readInt(2);this.fileCommentLength=a.readInt(2);this.diskNumberStart=a.readInt(2);this.internalFileAttributes=a.readInt(2);this.externalFileAttributes=a.readInt(4);this.localHeaderOffset=a.readInt(4);if(this.isEncrypted())throw Error("Encrypted zip are not supported");
        this.fileName=a.readString(this.fileNameLength);this.readExtraFields(a);this.parseZIP64ExtraField(a);this.fileComment=a.readString(this.fileCommentLength)},processAttributes:function(){this.dosPermissions=this.unixPermissions=null;var a=this.versionMadeBy>>8;this.dir=this.externalFileAttributes&16?!0:!1;0===a&&(this.dosPermissions=this.externalFileAttributes&63);3===a&&(this.unixPermissions=this.externalFileAttributes>>16&65535);this.dir||"/"!==this.fileName.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(a){this.extraFields[1]&&
    (a=new e(this.extraFields[1].value),this.uncompressedSize===g.MAX_VALUE_32BITS&&(this.uncompressedSize=a.readInt(8)),this.compressedSize===g.MAX_VALUE_32BITS&&(this.compressedSize=a.readInt(8)),this.localHeaderOffset===g.MAX_VALUE_32BITS&&(this.localHeaderOffset=a.readInt(8)),this.diskNumberStart===g.MAX_VALUE_32BITS&&(this.diskNumberStart=a.readInt(4)))},readExtraFields:function(a){var b=a.index,c,d,e;for(this.extraFields=this.extraFields||{};a.index<b+this.extraFieldsLength;)c=a.readInt(2),d=a.readInt(2),
        e=a.readString(d),this.extraFields[c]={id:c,length:d,value:e}},handleUTF8:function(){if(this.useUTF8())this.fileName=k.utf8decode(this.fileName),this.fileComment=k.utf8decode(this.fileComment);else{var a=this.findExtraFieldUnicodePath();null!==a&&(this.fileName=a);a=this.findExtraFieldUnicodeComment();null!==a&&(this.fileComment=a)}},findExtraFieldUnicodePath:function(){var a=this.extraFields[28789];if(a){var b=new e(a.value);return 1!==b.readInt(1)||k.crc32(this.fileName)!==b.readInt(4)?null:k.utf8decode(b.readString(a.length-
        5))}return null},findExtraFieldUnicodeComment:function(){var a=this.extraFields[25461];if(a){var b=new e(a.value);return 1!==b.readInt(1)||k.crc32(this.fileComment)!==b.readInt(4)?null:k.utf8decode(b.readString(a.length-5))}return null}};c.exports=d},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(b,c,a){a=b("./lib/utils/common").assign;var d=b("./lib/deflate"),e=b("./lib/inflate");b=b("./lib/zlib/constants");var g={};a(g,d,e,b);c.exports=g},{"./lib/deflate":25,
    "./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(b,c,a){function d(a,b){var c=new m(b);c.push(a,!0);if(c.err)throw c.msg;return c.result}var e=b("./zlib/deflate.js"),g=b("./utils/common"),h=b("./utils/strings"),k=b("./zlib/messages"),l=b("./zlib/zstream"),m=function(a){a=this.options=g.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},a||{});a.raw&&0<a.windowBits?a.windowBits=-a.windowBits:a.gzip&&0<a.windowBits&&16>a.windowBits&&
(a.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new l;this.strm.avail_out=0;var b=e.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(0!==b)throw Error(k[b]);a.header&&e.deflateSetHeader(this.strm,a.header)};m.prototype.push=function(a,b){var c=this.strm,d=this.options.chunkSize,k,l;if(this.ended)return!1;l=b===~~b?b:!0===b?4:0;c.input="string"===typeof a?h.string2buf(a):a;c.next_in=0;c.avail_in=c.input.length;do{0===c.avail_out&&(c.output=
    new g.Buf8(d),c.next_out=0,c.avail_out=d);k=e.deflate(c,l);if(1!==k&&0!==k)return this.onEnd(k),this.ended=!0,!1;if(0===c.avail_out||0===c.avail_in&&4===l)if("string"===this.options.to)this.onData(h.buf2binstring(g.shrinkBuf(c.output,c.next_out)));else this.onData(g.shrinkBuf(c.output,c.next_out))}while((0<c.avail_in||0===c.avail_out)&&1!==k);return 4===l?(k=e.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,0===k):!0};m.prototype.onData=function(a){this.chunks.push(a)};m.prototype.onEnd=function(a){0===
a&&(this.result="string"===this.options.to?this.chunks.join(""):g.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};a.Deflate=m;a.deflate=d;a.deflateRaw=function(a,b){b=b||{};b.raw=!0;return d(a,b)};a.gzip=function(a,b){b=b||{};b.gzip=!0;return d(a,b)}},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(b,c,a){function d(a,b){var c=new q(b);c.push(a,!0);if(c.err)throw c.msg;return c.result}var e=b("./zlib/inflate.js"),
    g=b("./utils/common"),h=b("./utils/strings"),k=b("./zlib/constants"),l=b("./zlib/messages"),m=b("./zlib/zstream"),p=b("./zlib/gzheader"),q=function(a){var b=this.options=g.assign({chunkSize:16384,windowBits:0,to:""},a||{});b.raw&&0<=b.windowBits&&16>b.windowBits&&(b.windowBits=-b.windowBits,0===b.windowBits&&(b.windowBits=-15));!(0<=b.windowBits&&16>b.windowBits)||a&&a.windowBits||(b.windowBits+=32);15<b.windowBits&&48>b.windowBits&&0===(b.windowBits&15)&&(b.windowBits|=15);this.err=0;this.msg="";
        this.ended=!1;this.chunks=[];this.strm=new m;this.strm.avail_out=0;a=e.inflateInit2(this.strm,b.windowBits);if(a!==k.Z_OK)throw Error(l[a]);this.header=new p;e.inflateGetHeader(this.strm,this.header)};q.prototype.push=function(a,b){var c=this.strm,d=this.options.chunkSize,l,m,p,q,F;if(this.ended)return!1;m=b===~~b?b:!0===b?k.Z_FINISH:k.Z_NO_FLUSH;c.input="string"===typeof a?h.binstring2buf(a):a;c.next_in=0;c.avail_in=c.input.length;do{0===c.avail_out&&(c.output=new g.Buf8(d),c.next_out=0,c.avail_out=
    d);l=e.inflate(c,k.Z_NO_FLUSH);if(l!==k.Z_STREAM_END&&l!==k.Z_OK)return this.onEnd(l),this.ended=!0,!1;if(c.next_out&&(0===c.avail_out||l===k.Z_STREAM_END||0===c.avail_in&&m===k.Z_FINISH))if("string"===this.options.to)p=h.utf8border(c.output,c.next_out),q=c.next_out-p,F=h.buf2string(c.output,p),c.next_out=q,c.avail_out=d-q,q&&g.arraySet(c.output,c.output,p,q,0),this.onData(F);else this.onData(g.shrinkBuf(c.output,c.next_out))}while(0<c.avail_in&&l!==k.Z_STREAM_END);l===k.Z_STREAM_END&&(m=k.Z_FINISH);
    return m===k.Z_FINISH?(l=e.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===k.Z_OK):!0};q.prototype.onData=function(a){this.chunks.push(a)};q.prototype.onEnd=function(a){a===k.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):g.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};a.Inflate=q;a.inflate=d;a.inflateRaw=function(a,b){b=b||{};b.raw=!0;return d(a,b)};a.ungzip=d},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,
    "./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(b,c,a){b="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;a.assign=function(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var c=b.shift();if(c){if("object"!==typeof c)throw new TypeError(c+"must be non-object");for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}}return a};a.shrinkBuf=function(a,b){if(a.length===b)return a;if(a.subarray)return a.subarray(0,
    b);a.length=b;return a};var d={arraySet:function(a,b,c,d,e){if(b.subarray&&a.subarray)a.set(b.subarray(c,c+d),e);else for(var p=0;p<d;p++)a[e+p]=b[c+p]},flattenChunks:function(a){var b,c,d,e,p;b=d=0;for(c=a.length;b<c;b++)d+=a[b].length;p=new Uint8Array(d);b=d=0;for(c=a.length;b<c;b++)e=a[b],p.set(e,d),d+=e.length;return p}},e={arraySet:function(a,b,c,d,e){for(var p=0;p<d;p++)a[e+p]=b[c+p]},flattenChunks:function(a){return[].concat.apply([],a)}};a.setTyped=function(b){b?(a.Buf8=Uint8Array,a.Buf16=
    Uint16Array,a.Buf32=Int32Array,a.assign(a,d)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,e))};a.setTyped(b)},{}],28:[function(b,c,a){function d(a,b){if(65537>b&&(a.subarray&&h||!a.subarray&&g))return String.fromCharCode.apply(null,e.shrinkBuf(a,b));for(var c="",d=0;d<b;d++)c+=String.fromCharCode(a[d]);return c}var e=b("./common"),g=!0,h=!0;try{String.fromCharCode.apply(null,[0])}catch(l){g=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){h=!1}var k=new e.Buf8(256);for(b=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0;256>b;b++)k[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;k[254]=k[254]=1;a.string2buf=function(a){var b,c,d,g,h,k=a.length,w=0;for(g=0;g<k;g++)c=a.charCodeAt(g),55296===(c&64512)&&g+1<k&&(d=a.charCodeAt(g+1),56320===(d&64512)&&(c=65536+(c-55296<<10)+(d-56320),g++)),w+=128>c?1:2048>c?2:65536>c?3:4;b=new e.Buf8(w);for(g=h=0;h<w;g++)c=a.charCodeAt(g),55296===(c&64512)&&g+1<k&&(d=a.charCodeAt(g+1),56320===(d&64512)&&(c=65536+(c-55296<<10)+(d-56320),g++)),128>c?b[h++]=c:(2048>c?b[h++]=192|c>>>6:
    (65536>c?b[h++]=224|c>>>12:(b[h++]=240|c>>>18,b[h++]=128|c>>>12&63),b[h++]=128|c>>>6&63),b[h++]=128|c&63);return b};a.buf2binstring=function(a){return d(a,a.length)};a.binstring2buf=function(a){for(var b=new e.Buf8(a.length),c=0,d=b.length;c<d;c++)b[c]=a.charCodeAt(c);return b};a.buf2string=function(a,b){var c,e,g,h,u=b||a.length,w=Array(2*u);for(c=e=0;c<u;)if(g=a[c++],128>g)w[e++]=g;else if(h=k[g],4<h)w[e++]=65533,c+=h-1;else{for(g&=2===h?31:3===h?15:7;1<h&&c<u;)g=g<<6|a[c++]&63,h--;1<h?w[e++]=65533:
    65536>g?w[e++]=g:(g-=65536,w[e++]=55296|g>>10&1023,w[e++]=56320|g&1023)}return d(w,e)};a.utf8border=function(a,b){var c;b=b||a.length;b>a.length&&(b=a.length);for(c=b-1;0<=c&&128===(a[c]&192);)c--;return 0>c||0===c?b:c+k[a[c]]>b?c:b}},{"./common":27}],29:[function(b,c,a){c.exports=function(a,b,c,h){var k=a&65535|0;a=a>>>16&65535|0;for(var l;0!==c;){l=2E3<c?2E3:c;c-=l;do k=k+b[h++]|0,a=a+k|0;while(--l);k%=65521;a%=65521}return k|a<<16|0}},{}],30:[function(b,c,a){c.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,
    Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(b,c,a){var d=function(){for(var a,b=[],c=0;256>c;c++){a=c;for(var d=0;8>d;d++)a=a&1?3988292384^a>>>1:a>>>1;b[c]=a}return b}();c.exports=
    function(a,b,c,k){c=k+c;for(a^=-1;k<c;k++)a=a>>>8^d[(a^b[k])&255];return a^-1}},{}],32:[function(b,c,a){function d(a,b){a.msg=y[b];return b}function e(a){for(var b=a.length;0<=--b;)a[b]=0}function g(a){var b=a.state,c=b.pending;c>a.avail_out&&(c=a.avail_out);0!==c&&(v.arraySet(a.output,b.pending_buf,b.pending_out,c,a.next_out),a.next_out+=c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))}function h(a,b){F._tr_flush_block(a,0<=a.block_start?a.block_start:
    -1,a.strstart-a.block_start,b);a.block_start=a.strstart;g(a.strm)}function k(a,b){a.pending_buf[a.pending++]=b}function l(a,b){a.pending_buf[a.pending++]=b>>>8&255;a.pending_buf[a.pending++]=b&255}function m(a,b){var c=a.max_chain_length,d=a.strstart,e,g=a.prev_length,h=a.nice_match,k=a.strstart>a.w_size-262?a.strstart-(a.w_size-262):0,l=a.window,m=a.w_mask,q=a.prev,p=a.strstart+258,v=l[d+g-1],r=l[d+g];a.prev_length>=a.good_match&&(c>>=2);h>a.lookahead&&(h=a.lookahead);do if(e=b,l[e+g]===r&&l[e+g-
    1]===v&&l[e]===l[d]&&l[++e]===l[d+1]){d+=2;for(e++;l[++d]===l[++e]&&l[++d]===l[++e]&&l[++d]===l[++e]&&l[++d]===l[++e]&&l[++d]===l[++e]&&l[++d]===l[++e]&&l[++d]===l[++e]&&l[++d]===l[++e]&&d<p;);e=258-(p-d);d=p-258;if(e>g){a.match_start=b;g=e;if(e>=h)break;v=l[d+g-1];r=l[d+g]}}while((b=q[b&m])>k&&0!==--c);return g<=a.lookahead?g:a.lookahead}function p(a){var b=a.w_size,c,d,e,g;do{g=a.window_size-a.lookahead-a.strstart;if(a.strstart>=b+(b-262)){v.arraySet(a.window,a.window,b,b,0);a.match_start-=b;a.strstart-=
    b;a.block_start-=b;c=d=a.hash_size;do e=a.head[--c],a.head[c]=e>=b?e-b:0;while(--d);c=d=b;do e=a.prev[--c],a.prev[c]=e>=b?e-b:0;while(--d);g+=b}if(0===a.strm.avail_in)break;c=a.strm;d=a.window;e=a.strstart+a.lookahead;var h=c.avail_in;h>g&&(h=g);0===h?d=0:(c.avail_in-=h,v.arraySet(d,c.input,c.next_in,h,e),1===c.state.wrap?c.adler=G(c.adler,d,h,e):2===c.state.wrap&&(c.adler=D(c.adler,d,h,e)),c.next_in+=h,c.total_in+=h,d=h);a.lookahead+=d;if(3<=a.lookahead+a.insert)for(g=a.strstart-a.insert,a.ins_h=
    a.window[g],a.ins_h=(a.ins_h<<a.hash_shift^a.window[g+1])&a.hash_mask;a.insert&&!(a.ins_h=(a.ins_h<<a.hash_shift^a.window[g+3-1])&a.hash_mask,a.prev[g&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=g,g++,a.insert--,3>a.lookahead+a.insert););}while(262>a.lookahead&&0!==a.strm.avail_in)}function q(a,b){for(var c;;){if(262>a.lookahead){p(a);if(262>a.lookahead&&0===b)return 1;if(0===a.lookahead)break}c=0;3<=a.lookahead&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,c=a.prev[a.strstart&
a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);0!==c&&a.strstart-c<=a.w_size-262&&(a.match_length=m(a,c));if(3<=a.match_length)if(c=F._tr_tally(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&3<=a.lookahead){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!==--a.match_length);a.strstart++}else a.strstart+=
    a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else c=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(c&&(h(a,!1),0===a.strm.avail_out))return 1}a.insert=2>a.strstart?a.strstart:2;return 4===b?(h(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?1:2}function t(a,b){for(var c,d;;){if(262>a.lookahead){p(a);if(262>a.lookahead&&0===b)return 1;if(0===a.lookahead)break}c=0;3<=a.lookahead&&
(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);a.prev_length=a.match_length;a.prev_match=a.match_start;a.match_length=2;0!==c&&a.prev_length<a.max_lazy_match&&a.strstart-c<=a.w_size-262&&(a.match_length=m(a,c),5>=a.match_length&&(1===a.strategy||3===a.match_length&&4096<a.strstart-a.match_start)&&(a.match_length=2));if(3<=a.prev_length&&a.match_length<=a.prev_length){d=a.strstart+a.lookahead-3;c=F._tr_tally(a,
    a.strstart-1-a.prev_match,a.prev_length-3);a.lookahead-=a.prev_length-1;a.prev_length-=2;do++a.strstart<=d&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!==--a.prev_length);a.match_available=0;a.match_length=2;a.strstart++;if(c&&(h(a,!1),0===a.strm.avail_out))return 1}else if(a.match_available){if((c=F._tr_tally(a,0,a.window[a.strstart-1]))&&h(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return 1}else a.match_available=
    1,a.strstart++,a.lookahead--}a.match_available&&(F._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0);a.insert=2>a.strstart?a.strstart:2;return 4===b?(h(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?1:2}function r(a,b){for(var c,d,e,g=a.window;;){if(258>=a.lookahead){p(a);if(258>=a.lookahead&&0===b)return 1;if(0===a.lookahead)break}a.match_length=0;if(3<=a.lookahead&&0<a.strstart&&(d=a.strstart-1,c=g[d],c===g[++d]&&c===g[++d]&&c===g[++d])){for(e=a.strstart+258;c===
g[++d]&&c===g[++d]&&c===g[++d]&&c===g[++d]&&c===g[++d]&&c===g[++d]&&c===g[++d]&&c===g[++d]&&d<e;);a.match_length=258-(e-d);a.match_length>a.lookahead&&(a.match_length=a.lookahead)}3<=a.match_length?(c=F._tr_tally(a,1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(c=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++);if(c&&(h(a,!1),0===a.strm.avail_out))return 1}a.insert=0;return 4===b?(h(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(h(a,!1),
0===a.strm.avail_out)?1:2}function u(a,b){for(var c;;){if(0===a.lookahead&&(p(a),0===a.lookahead)){if(0===b)return 1;break}a.match_length=0;c=F._tr_tally(a,0,a.window[a.strstart]);a.lookahead--;a.strstart++;if(c&&(h(a,!1),0===a.strm.avail_out))return 1}a.insert=0;return 4===b?(h(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?1:2}function w(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;
    this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new v.Buf16(1146);this.dyn_dtree=
        new v.Buf16(122);this.bl_tree=new v.Buf16(78);e(this.dyn_ltree);e(this.dyn_dtree);e(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new v.Buf16(16);this.heap=new v.Buf16(573);e(this.heap);this.heap_max=this.heap_len=0;this.depth=new v.Buf16(573);e(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function x(a){var b;if(!a||!a.state)return d(a,-2);a.total_in=a.total_out=0;a.data_type=
    2;b=a.state;b.pending=0;b.pending_out=0;0>b.wrap&&(b.wrap=-b.wrap);b.status=b.wrap?42:113;a.adler=2===b.wrap?0:1;b.last_flush=0;F._tr_init(b);return 0}function A(a){var b=x(a);0===b&&(a=a.state,a.window_size=2*a.w_size,e(a.head),a.max_lazy_match=H[a.level].max_lazy,a.good_match=H[a.level].good_length,a.nice_match=H[a.level].nice_length,a.max_chain_length=H[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0);return b}
    function B(a,b,c,e,g,h){if(!a)return-2;var k=1;-1===b&&(b=6);0>e?(k=0,e=-e):15<e&&(k=2,e-=16);if(1>g||9<g||8!==c||8>e||15<e||0>b||9<b||0>h||4<h)return d(a,-2);8===e&&(e=9);var l=new w;a.state=l;l.strm=a;l.wrap=k;l.gzhead=null;l.w_bits=e;l.w_size=1<<l.w_bits;l.w_mask=l.w_size-1;l.hash_bits=g+7;l.hash_size=1<<l.hash_bits;l.hash_mask=l.hash_size-1;l.hash_shift=~~((l.hash_bits+3-1)/3);l.window=new v.Buf8(2*l.w_size);l.head=new v.Buf16(l.hash_size);l.prev=new v.Buf16(l.w_size);l.lit_bufsize=1<<g+6;l.pending_buf_size=
        4*l.lit_bufsize;l.pending_buf=new v.Buf8(l.pending_buf_size);l.d_buf=l.lit_bufsize>>1;l.l_buf=3*l.lit_bufsize;l.level=b;l.strategy=h;l.method=c;return A(a)}var v=b("../utils/common"),F=b("./trees"),G=b("./adler32"),D=b("./crc32"),y=b("./messages");b=function(a,b,c,d,e){this.good_length=a;this.max_lazy=b;this.nice_length=c;this.max_chain=d;this.func=e};var H;H=[new b(0,0,0,0,function(a,b){var c=65535;for(c>a.pending_buf_size-5&&(c=a.pending_buf_size-5);;){if(1>=a.lookahead){p(a);if(0===a.lookahead&&
        0===b)return 1;if(0===a.lookahead)break}a.strstart+=a.lookahead;a.lookahead=0;var d=a.block_start+c;if(0===a.strstart||a.strstart>=d)if(a.lookahead=a.strstart-d,a.strstart=d,h(a,!1),0===a.strm.avail_out)return 1;if(a.strstart-a.block_start>=a.w_size-262&&(h(a,!1),0===a.strm.avail_out))return 1}a.insert=0;if(4===b)return h(a,!0),0===a.strm.avail_out?3:4;a.strstart>a.block_start&&h(a,!1);return 1}),new b(4,4,8,4,q),new b(4,5,16,8,q),new b(4,6,32,32,q),new b(4,4,16,16,t),new b(8,16,32,32,t),new b(8,
        16,128,128,t),new b(8,32,128,256,t),new b(32,128,258,1024,t),new b(32,258,258,4096,t)];a.deflateInit=function(a,b){return B(a,b,8,15,8,0)};a.deflateInit2=B;a.deflateReset=A;a.deflateResetKeep=x;a.deflateSetHeader=function(a,b){if(!a||!a.state||2!==a.state.wrap)return-2;a.state.gzhead=b;return 0};a.deflate=function(a,b){var c,h,m,q;if(!a||!a.state||5<b||0>b)return a?d(a,-2):-2;h=a.state;if(!a.output||!a.input&&0!==a.avail_in||666===h.status&&4!==b)return d(a,0===a.avail_out?-5:-2);h.strm=a;c=h.last_flush;
        h.last_flush=b;42===h.status&&(2===h.wrap?(a.adler=0,k(h,31),k(h,139),k(h,8),h.gzhead?(k(h,(h.gzhead.text?1:0)+(h.gzhead.hcrc?2:0)+(h.gzhead.extra?4:0)+(h.gzhead.name?8:0)+(h.gzhead.comment?16:0)),k(h,h.gzhead.time&255),k(h,h.gzhead.time>>8&255),k(h,h.gzhead.time>>16&255),k(h,h.gzhead.time>>24&255),k(h,9===h.level?2:2<=h.strategy||2>h.level?4:0),k(h,h.gzhead.os&255),h.gzhead.extra&&h.gzhead.extra.length&&(k(h,h.gzhead.extra.length&255),k(h,h.gzhead.extra.length>>8&255)),h.gzhead.hcrc&&(a.adler=D(a.adler,
            h.pending_buf,h.pending,0)),h.gzindex=0,h.status=69):(k(h,0),k(h,0),k(h,0),k(h,0),k(h,0),k(h,9===h.level?2:2<=h.strategy||2>h.level?4:0),k(h,3),h.status=113)):(m=8+(h.w_bits-8<<4)<<8,m|=(2<=h.strategy||2>h.level?0:6>h.level?1:6===h.level?2:3)<<6,0!==h.strstart&&(m|=32),h.status=113,l(h,m+(31-m%31)),0!==h.strstart&&(l(h,a.adler>>>16),l(h,a.adler&65535)),a.adler=1));if(69===h.status)if(h.gzhead.extra){for(m=h.pending;h.gzindex<(h.gzhead.extra.length&65535)&&(h.pending!==h.pending_buf_size||(h.gzhead.hcrc&&
        h.pending>m&&(a.adler=D(a.adler,h.pending_buf,h.pending-m,m)),g(a),m=h.pending,h.pending!==h.pending_buf_size));)k(h,h.gzhead.extra[h.gzindex]&255),h.gzindex++;h.gzhead.hcrc&&h.pending>m&&(a.adler=D(a.adler,h.pending_buf,h.pending-m,m));h.gzindex===h.gzhead.extra.length&&(h.gzindex=0,h.status=73)}else h.status=73;if(73===h.status)if(h.gzhead.name){m=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>m&&(a.adler=D(a.adler,h.pending_buf,h.pending-m,m)),g(a),m=h.pending,h.pending===
            h.pending_buf_size)){q=1;break}q=h.gzindex<h.gzhead.name.length?h.gzhead.name.charCodeAt(h.gzindex++)&255:0;k(h,q)}while(0!==q);h.gzhead.hcrc&&h.pending>m&&(a.adler=D(a.adler,h.pending_buf,h.pending-m,m));0===q&&(h.gzindex=0,h.status=91)}else h.status=91;if(91===h.status)if(h.gzhead.comment){m=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>m&&(a.adler=D(a.adler,h.pending_buf,h.pending-m,m)),g(a),m=h.pending,h.pending===h.pending_buf_size)){q=1;break}q=h.gzindex<h.gzhead.comment.length?
        h.gzhead.comment.charCodeAt(h.gzindex++)&255:0;k(h,q)}while(0!==q);h.gzhead.hcrc&&h.pending>m&&(a.adler=D(a.adler,h.pending_buf,h.pending-m,m));0===q&&(h.status=103)}else h.status=103;103===h.status&&(h.gzhead.hcrc?(h.pending+2>h.pending_buf_size&&g(a),h.pending+2<=h.pending_buf_size&&(k(h,a.adler&255),k(h,a.adler>>8&255),a.adler=0,h.status=113)):h.status=113);if(0!==h.pending){if(g(a),0===a.avail_out)return h.last_flush=-1,0}else if(0===a.avail_in&&(b<<1)-(4<b?9:0)<=(c<<1)-(4<c?9:0)&&4!==b)return d(a,
            -5);if(666===h.status&&0!==a.avail_in)return d(a,-5);if(0!==a.avail_in||0!==h.lookahead||0!==b&&666!==h.status){c=2===h.strategy?u(h,b):3===h.strategy?r(h,b):H[h.level].func(h,b);if(3===c||4===c)h.status=666;if(1===c||3===c)return 0===a.avail_out&&(h.last_flush=-1),0;if(2===c&&(1===b?F._tr_align(h):5!==b&&(F._tr_stored_block(h,0,0,!1),3===b&&(e(h.head),0===h.lookahead&&(h.strstart=0,h.block_start=0,h.insert=0))),g(a),0===a.avail_out))return h.last_flush=-1,0}if(4!==b)return 0;if(0>=h.wrap)return 1;
        2===h.wrap?(k(h,a.adler&255),k(h,a.adler>>8&255),k(h,a.adler>>16&255),k(h,a.adler>>24&255),k(h,a.total_in&255),k(h,a.total_in>>8&255),k(h,a.total_in>>16&255),k(h,a.total_in>>24&255)):(l(h,a.adler>>>16),l(h,a.adler&65535));g(a);0<h.wrap&&(h.wrap=-h.wrap);return 0!==h.pending?0:1};a.deflateEnd=function(a){var b;if(!a||!a.state)return-2;b=a.state.status;if(42!==b&&69!==b&&73!==b&&91!==b&&103!==b&&113!==b&&666!==b)return d(a,-2);a.state=null;return 113===b?d(a,-3):0};a.deflateInfo="pako deflate (from Nodeca project)"},
    {"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(b,c,a){c.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],34:[function(b,c,a){c.exports=function(a,b){var c,h,k,l,m,p,q,t,r,u,w,x,A,B,v,F,G,D,y,H,C,z,E,L;c=a.state;h=a.next_in;E=a.input;k=h+(a.avail_in-5);l=a.next_out;L=a.output;m=l-(b-a.avail_out);p=l+(a.avail_out-257);q=c.dmax;t=c.wsize;r=c.whave;u=c.wnext;
    w=c.window;x=c.hold;A=c.bits;B=c.lencode;v=c.distcode;F=(1<<c.lenbits)-1;G=(1<<c.distbits)-1;a:do b:for(15>A&&(x+=E[h++]<<A,A+=8,x+=E[h++]<<A,A+=8),D=B[x&F];;){y=D>>>24;x>>>=y;A-=y;y=D>>>16&255;if(0===y)L[l++]=D&65535;else if(y&16){H=D&65535;if(y&=15)A<y&&(x+=E[h++]<<A,A+=8),H+=x&(1<<y)-1,x>>>=y,A-=y;15>A&&(x+=E[h++]<<A,A+=8,x+=E[h++]<<A,A+=8);D=v[x&G];c:for(;;){y=D>>>24;x>>>=y;A-=y;y=D>>>16&255;if(y&16){D&=65535;y&=15;A<y&&(x+=E[h++]<<A,A+=8,A<y&&(x+=E[h++]<<A,A+=8));D+=x&(1<<y)-1;if(D>q){a.msg=
        "invalid distance too far back";c.mode=30;break a}x>>>=y;A-=y;y=l-m;if(D>y){y=D-y;if(y>r&&c.sane){a.msg="invalid distance too far back";c.mode=30;break a}C=0;z=w;if(0===u){if(C+=t-y,y<H){H-=y;do L[l++]=w[C++];while(--y);C=l-D;z=L}}else if(u<y){if(C+=t+u-y,y-=u,y<H){H-=y;do L[l++]=w[C++];while(--y);C=0;if(u<H){y=u;H-=y;do L[l++]=w[C++];while(--y);C=l-D;z=L}}}else if(C+=u-y,y<H){H-=y;do L[l++]=w[C++];while(--y);C=l-D;z=L}for(;2<H;)L[l++]=z[C++],L[l++]=z[C++],L[l++]=z[C++],H-=3;H&&(L[l++]=z[C++],1<H&&
    (L[l++]=z[C++]))}else{C=l-D;do L[l++]=L[C++],L[l++]=L[C++],L[l++]=L[C++],H-=3;while(2<H);H&&(L[l++]=L[C++],1<H&&(L[l++]=L[C++]))}}else if(0===(y&64)){D=v[(D&65535)+(x&(1<<y)-1)];continue c}else{a.msg="invalid distance code";c.mode=30;break a}break}}else if(0===(y&64)){D=B[(D&65535)+(x&(1<<y)-1)];continue b}else{y&32?c.mode=12:(a.msg="invalid literal/length code",c.mode=30);break a}break}while(h<k&&l<p);H=A>>3;h-=H;A-=H<<3;a.next_in=h;a.next_out=l;a.avail_in=h<k?5+(k-h):5-(h-k);a.avail_out=l<p?257+
    (p-l):257-(l-p);c.hold=x&(1<<A)-1;c.bits=A}},{}],35:[function(b,c,a){function d(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)}function e(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=
    null;this.lens=new m.Buf16(320);this.work=new m.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function g(a){var b;if(!a||!a.state)return-2;b=a.state;a.total_in=a.total_out=b.total=0;a.msg="";b.wrap&&(a.adler=b.wrap&1);b.mode=1;b.last=0;b.havedict=0;b.dmax=32768;b.head=null;b.hold=0;b.bits=0;b.lencode=b.lendyn=new m.Buf32(852);b.distcode=b.distdyn=new m.Buf32(592);b.sane=1;b.back=-1;return 0}function h(a){var b;if(!a||!a.state)return-2;b=a.state;b.wsize=0;b.whave=0;b.wnext=
    0;return g(a)}function k(a,b){var c,d;if(!a||!a.state)return-2;d=a.state;0>b?(c=0,b=-b):(c=(b>>4)+1,48>b&&(b&=15));if(b&&(8>b||15<b))return-2;null!==d.window&&d.wbits!==b&&(d.window=null);d.wrap=c;d.wbits=b;return h(a)}function l(a,b){var c;if(!a)return-2;c=new e;a.state=c;c.window=null;c=k(a,b);0!==c&&(a.state=null);return c}var m=b("../utils/common"),p=b("./adler32"),q=b("./crc32"),t=b("./inffast"),r=b("./inftrees"),u=!0,w,x;a.inflateReset=h;a.inflateReset2=k;a.inflateResetKeep=g;a.inflateInit=
    function(a){return l(a,15)};a.inflateInit2=l;a.inflate=function(a,b){var c,e,g,h,k,l,C,z,E,L,M,I,K,O,N,R,S,P,Q=new m.Buf8(4),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return-2;c=a.state;12===c.mode&&(c.mode=13);k=a.next_out;g=a.output;C=a.avail_out;h=a.next_in;e=a.input;l=a.avail_in;z=c.hold;E=c.bits;L=l;M=C;P=0;a:for(;;)switch(c.mode){case 1:if(0===c.wrap){c.mode=13;break}for(;16>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}if(c.wrap&2&&
    35615===z){c.check=0;Q[0]=z&255;Q[1]=z>>>8&255;c.check=q(c.check,Q,2,0);E=z=0;c.mode=2;break}c.flags=0;c.head&&(c.head.done=!1);if(!(c.wrap&1)||(((z&255)<<8)+(z>>8))%31){a.msg="incorrect header check";c.mode=30;break}if(8!==(z&15)){a.msg="unknown compression method";c.mode=30;break}z>>>=4;E-=4;K=(z&15)+8;if(0===c.wbits)c.wbits=K;else if(K>c.wbits){a.msg="invalid window size";c.mode=30;break}c.dmax=1<<K;a.adler=c.check=1;c.mode=z&512?10:12;E=z=0;break;case 2:for(;16>E;){if(0===l)break a;l--;z+=e[h++]<<
    E;E+=8}c.flags=z;if(8!==(c.flags&255)){a.msg="unknown compression method";c.mode=30;break}if(c.flags&57344){a.msg="unknown header flags set";c.mode=30;break}c.head&&(c.head.text=z>>8&1);c.flags&512&&(Q[0]=z&255,Q[1]=z>>>8&255,c.check=q(c.check,Q,2,0));E=z=0;c.mode=3;case 3:for(;32>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}c.head&&(c.head.time=z);c.flags&512&&(Q[0]=z&255,Q[1]=z>>>8&255,Q[2]=z>>>16&255,Q[3]=z>>>24&255,c.check=q(c.check,Q,4,0));E=z=0;c.mode=4;case 4:for(;16>E;){if(0===l)break a;l--;
    z+=e[h++]<<E;E+=8}c.head&&(c.head.xflags=z&255,c.head.os=z>>8);c.flags&512&&(Q[0]=z&255,Q[1]=z>>>8&255,c.check=q(c.check,Q,2,0));E=z=0;c.mode=5;case 5:if(c.flags&1024){for(;16>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}c.length=z;c.head&&(c.head.extra_len=z);c.flags&512&&(Q[0]=z&255,Q[1]=z>>>8&255,c.check=q(c.check,Q,2,0));E=z=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(c.flags&1024&&(I=c.length,I>l&&(I=l),I&&(c.head&&(K=c.head.extra_len-c.length,c.head.extra||(c.head.extra=Array(c.head.extra_len)),
        m.arraySet(c.head.extra,e,h,I,K)),c.flags&512&&(c.check=q(c.check,e,I,h)),l-=I,h+=I,c.length-=I),c.length))break a;c.length=0;c.mode=7;case 7:if(c.flags&2048){if(0===l)break a;I=0;do K=e[h+I++],c.head&&K&&65536>c.length&&(c.head.name+=String.fromCharCode(K));while(K&&I<l);c.flags&512&&(c.check=q(c.check,e,I,h));l-=I;h+=I;if(K)break a}else c.head&&(c.head.name=null);c.length=0;c.mode=8;case 8:if(c.flags&4096){if(0===l)break a;I=0;do K=e[h+I++],c.head&&K&&65536>c.length&&(c.head.comment+=String.fromCharCode(K));
while(K&&I<l);c.flags&512&&(c.check=q(c.check,e,I,h));l-=I;h+=I;if(K)break a}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(c.flags&512){for(;16>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}if(z!==(c.check&65535)){a.msg="header crc mismatch";c.mode=30;break}E=z=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0);a.adler=c.check=0;c.mode=12;break;case 10:for(;32>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}a.adler=c.check=d(z);E=z=0;c.mode=11;case 11:if(0===c.havedict)return a.next_out=k,a.avail_out=
    C,a.next_in=h,a.avail_in=l,c.hold=z,c.bits=E,2;a.adler=c.check=1;c.mode=12;case 12:if(5===b||6===b)break a;case 13:if(c.last){z>>>=E&7;E-=E&7;c.mode=27;break}for(;3>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}c.last=z&1;z>>>=1;--E;switch(z&3){case 0:c.mode=14;break;case 1:I=c;if(u){w=new m.Buf32(512);x=new m.Buf32(32);for(K=0;144>K;)I.lens[K++]=8;for(;256>K;)I.lens[K++]=9;for(;280>K;)I.lens[K++]=7;for(;288>K;)I.lens[K++]=8;r(1,I.lens,0,288,w,0,I.work,{bits:9});for(K=0;32>K;)I.lens[K++]=5;r(2,I.lens,
    0,32,x,0,I.work,{bits:5});u=!1}I.lencode=w;I.lenbits=9;I.distcode=x;I.distbits=5;c.mode=20;if(6===b){z>>>=2;E-=2;break a}break;case 2:c.mode=17;break;case 3:a.msg="invalid block type",c.mode=30}z>>>=2;E-=2;break;case 14:z>>>=E&7;for(E-=E&7;32>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}if((z&65535)!==(z>>>16^65535)){a.msg="invalid stored block lengths";c.mode=30;break}c.length=z&65535;E=z=0;c.mode=15;if(6===b)break a;case 15:c.mode=16;case 16:if(I=c.length){I>l&&(I=l);I>C&&(I=C);if(0===I)break a;m.arraySet(g,
    e,h,I,k);l-=I;h+=I;C-=I;k+=I;c.length-=I;break}c.mode=12;break;case 17:for(;14>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}c.nlen=(z&31)+257;z>>>=5;E-=5;c.ndist=(z&31)+1;z>>>=5;E-=5;c.ncode=(z&15)+4;z>>>=4;E-=4;if(286<c.nlen||30<c.ndist){a.msg="too many length or distance symbols";c.mode=30;break}c.have=0;c.mode=18;case 18:for(;c.have<c.ncode;){for(;3>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}c.lens[X[c.have++]]=z&7;z>>>=3;E-=3}for(;19>c.have;)c.lens[X[c.have++]]=0;c.lencode=c.lendyn;c.lenbits=7;
    I={bits:c.lenbits};P=r(0,c.lens,0,19,c.lencode,0,c.work,I);c.lenbits=I.bits;if(P){a.msg="invalid code lengths set";c.mode=30;break}c.have=0;c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;;){N=c.lencode[z&(1<<c.lenbits)-1];I=N>>>24;N&=65535;if(I<=E)break;if(0===l)break a;l--;z+=e[h++]<<E;E+=8}if(16>N)z>>>=I,E-=I,c.lens[c.have++]=N;else{if(16===N){for(K=I+2;E<K;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}z>>>=I;E-=I;if(0===c.have){a.msg="invalid bit length repeat";c.mode=30;break}K=c.lens[c.have-
1];I=3+(z&3);z>>>=2;E-=2}else if(17===N){for(K=I+3;E<K;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}z>>>=I;E-=I;K=0;I=3+(z&7);z>>>=3;E-=3}else{for(K=I+7;E<K;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}z>>>=I;E-=I;K=0;I=11+(z&127);z>>>=7;E-=7}if(c.have+I>c.nlen+c.ndist){a.msg="invalid bit length repeat";c.mode=30;break}for(;I--;)c.lens[c.have++]=K}}if(30===c.mode)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block";c.mode=30;break}c.lenbits=9;I={bits:c.lenbits};P=r(1,c.lens,0,c.nlen,c.lencode,
    0,c.work,I);c.lenbits=I.bits;if(P){a.msg="invalid literal/lengths set";c.mode=30;break}c.distbits=6;c.distcode=c.distdyn;I={bits:c.distbits};P=r(2,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,I);c.distbits=I.bits;if(P){a.msg="invalid distances set";c.mode=30;break}c.mode=20;if(6===b)break a;case 20:c.mode=21;case 21:if(6<=l&&258<=C){a.next_out=k;a.avail_out=C;a.next_in=h;a.avail_in=l;c.hold=z;c.bits=E;t(a,M);k=a.next_out;g=a.output;C=a.avail_out;h=a.next_in;e=a.input;l=a.avail_in;z=c.hold;E=c.bits;12===
c.mode&&(c.back=-1);break}for(c.back=0;;){N=c.lencode[z&(1<<c.lenbits)-1];I=N>>>24;K=N>>>16&255;N&=65535;if(I<=E)break;if(0===l)break a;l--;z+=e[h++]<<E;E+=8}if(K&&0===(K&240)){O=I;R=K;for(S=N;;){N=c.lencode[S+((z&(1<<O+R)-1)>>O)];I=N>>>24;K=N>>>16&255;N&=65535;if(O+I<=E)break;if(0===l)break a;l--;z+=e[h++]<<E;E+=8}z>>>=O;E-=O;c.back+=O}z>>>=I;E-=I;c.back+=I;c.length=N;if(0===K){c.mode=26;break}if(K&32){c.back=-1;c.mode=12;break}if(K&64){a.msg="invalid literal/length code";c.mode=30;break}c.extra=
    K&15;c.mode=22;case 22:if(c.extra){for(K=c.extra;E<K;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}c.length+=z&(1<<c.extra)-1;z>>>=c.extra;E-=c.extra;c.back+=c.extra}c.was=c.length;c.mode=23;case 23:for(;;){N=c.distcode[z&(1<<c.distbits)-1];I=N>>>24;K=N>>>16&255;N&=65535;if(I<=E)break;if(0===l)break a;l--;z+=e[h++]<<E;E+=8}if(0===(K&240)){O=I;R=K;for(S=N;;){N=c.distcode[S+((z&(1<<O+R)-1)>>O)];I=N>>>24;K=N>>>16&255;N&=65535;if(O+I<=E)break;if(0===l)break a;l--;z+=e[h++]<<E;E+=8}z>>>=O;E-=O;c.back+=O}z>>>=
    I;E-=I;c.back+=I;if(K&64){a.msg="invalid distance code";c.mode=30;break}c.offset=N;c.extra=K&15;c.mode=24;case 24:if(c.extra){for(K=c.extra;E<K;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}c.offset+=z&(1<<c.extra)-1;z>>>=c.extra;E-=c.extra;c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back";c.mode=30;break}c.mode=25;case 25:if(0===C)break a;I=M-C;if(c.offset>I){I=c.offset-I;if(I>c.whave&&c.sane){a.msg="invalid distance too far back";c.mode=30;break}I>c.wnext?(I-=c.wnext,K=c.wsize-
    I):K=c.wnext-I;I>c.length&&(I=c.length);O=c.window}else O=g,K=k-c.offset,I=c.length;I>C&&(I=C);C-=I;c.length-=I;do g[k++]=O[K++];while(--I);0===c.length&&(c.mode=21);break;case 26:if(0===C)break a;g[k++]=c.length;C--;c.mode=21;break;case 27:if(c.wrap){for(;32>E;){if(0===l)break a;l--;z|=e[h++]<<E;E+=8}M-=C;a.total_out+=M;c.total+=M;M&&(a.adler=c.check=c.flags?q(c.check,g,M,k-M):p(c.check,g,M,k-M));M=C;if((c.flags?z:d(z))!==c.check){a.msg="incorrect data check";c.mode=30;break}E=z=0}c.mode=28;case 28:if(c.wrap&&
    c.flags){for(;32>E;){if(0===l)break a;l--;z+=e[h++]<<E;E+=8}if(z!==(c.total&4294967295)){a.msg="incorrect length check";c.mode=30;break}E=z=0}c.mode=29;case 29:P=1;break a;case 30:P=-3;break a;case 31:return-4;default:return-2}a.next_out=k;a.avail_out=C;a.next_in=h;a.avail_in=l;c.hold=z;c.bits=E;if(c.wsize||M!==a.avail_out&&30>c.mode&&(27>c.mode||4!==b))e=a.output,h=a.next_out,k=M-a.avail_out,C=a.state,null===C.window&&(C.wsize=1<<C.wbits,C.wnext=0,C.whave=0,C.window=new m.Buf8(C.wsize)),k>=C.wsize?
    (m.arraySet(C.window,e,h-C.wsize,C.wsize,0),C.wnext=0,C.whave=C.wsize):(l=C.wsize-C.wnext,l>k&&(l=k),m.arraySet(C.window,e,h-k,l,C.wnext),(k-=l)?(m.arraySet(C.window,e,h-k,k,0),C.wnext=k,C.whave=C.wsize):(C.wnext+=l,C.wnext===C.wsize&&(C.wnext=0),C.whave<C.wsize&&(C.whave+=l)));L-=a.avail_in;M-=a.avail_out;a.total_in+=L;a.total_out+=M;c.total+=M;c.wrap&&M&&(a.adler=c.check=c.flags?q(c.check,g,M,a.next_out-M):p(c.check,g,M,a.next_out-M));a.data_type=c.bits+(c.last?64:0)+(12===c.mode?128:0)+(20===c.mode||
    15===c.mode?256:0);(0===L&&0===M||4===b)&&0===P&&(P=-5);return P};a.inflateEnd=function(a){if(!a||!a.state)return-2;var b=a.state;b.window&&(b.window=null);a.state=null;return 0};a.inflateGetHeader=function(a,b){var c;if(!a||!a.state)return-2;c=a.state;if(0===(c.wrap&2))return-2;c.head=b;b.done=!1;return 0};a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(b,c,a){var d=b("../utils/common"),e=[3,4,5,6,
    7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],k=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];c.exports=function(a,b,c,q,t,r,u,w){var x=w.bits,A,B,v,F,G,D,y,H,C,z,E,L,M,I=0,K,O=new d.Buf16(16);G=
    new d.Buf16(16);var N,R=0,S,P,Q;for(A=0;15>=A;A++)O[A]=0;for(B=0;B<q;B++)O[b[c+B]]++;F=x;for(v=15;1<=v&&0===O[v];v--);F>v&&(F=v);if(0===v)return t[r++]=20971520,t[r++]=20971520,w.bits=1,0;for(x=1;x<v&&0===O[x];x++);F<x&&(F=x);for(A=D=1;15>=A;A++)if(D<<=1,D-=O[A],0>D)return-1;if(0<D&&(0===a||1!==v))return-1;G[1]=0;for(A=1;15>A;A++)G[A+1]=G[A]+O[A];for(B=0;B<q;B++)0!==b[c+B]&&(u[G[b[c+B]]++]=B);0===a?(M=N=u,K=19):1===a?(M=e,I-=257,N=g,R-=257,K=256):(M=h,N=k,K=-1);B=H=0;A=x;L=r;q=F;G=0;z=-1;y=1<<F;E=
    y-1;if(1===a&&852<y||2===a&&592<y)return 1;for(var X=0;;){X++;S=A-G;u[B]<K?(P=0,Q=u[B]):u[B]>K?(P=N[R+u[B]],Q=M[I+u[B]]):(P=96,Q=0);D=1<<A-G;x=C=1<<q;do C-=D,t[L+(H>>G)+C]=S<<24|P<<16|Q|0;while(0!==C);for(D=1<<A-1;H&D;)D>>=1;0!==D?(H&=D-1,H+=D):H=0;B++;if(0===--O[A]){if(A===v)break;A=b[c+u[B]]}if(A>F&&(H&E)!==z){0===G&&(G=F);L+=x;q=A-G;for(D=1<<q;q+G<v;){D-=O[q+G];if(0>=D)break;q++;D<<=1}y+=1<<q;if(1===a&&852<y||2===a&&592<y)return 1;z=H&E;t[z]=F<<24|q<<16|L-r|0}}0!==H&&(t[L+H]=A-G<<24|4194304);w.bits=
    F;return 0}},{"../utils/common":27}],37:[function(b,c,a){c.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(b,c,a){function d(a){for(var b=a.length;0<=--b;)a[b]=0}function e(a,b){a.pending_buf[a.pending++]=b&255;a.pending_buf[a.pending++]=b>>>8&255}function g(a,b,c){a.bi_valid>16-c?(a.bi_buf|=b<<a.bi_valid&65535,e(a,a.bi_buf),a.bi_buf=b>>16-a.bi_valid,
    a.bi_valid+=c-16):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function h(a,b,c){g(a,c[2*b],c[2*b+1])}function k(a,b){var c=0;do c|=a&1,a>>>=1,c<<=1;while(0<--b);return c>>>1}function l(a,b,c){var d=Array(16),e=0,g;for(g=1;15>=g;g++)d[g]=e=e+c[g-1]<<1;for(c=0;c<=b;c++)e=a[2*c+1],0!==e&&(a[2*c]=k(d[e]++,e))}function m(a){var b;for(b=0;286>b;b++)a.dyn_ltree[2*b]=0;for(b=0;30>b;b++)a.dyn_dtree[2*b]=0;for(b=0;19>b;b++)a.bl_tree[2*b]=0;a.dyn_ltree[512]=1;a.opt_len=a.static_len=0;a.last_lit=a.matches=
    0}function p(a){8<a.bi_valid?e(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf);a.bi_buf=0;a.bi_valid=0}function q(a,b,c,d){var e=2*b,g=2*c;return a[e]<a[g]||a[e]===a[g]&&d[b]<=d[c]}function t(a,b,c){for(var d=a.heap[c],e=c<<1;e<=a.heap_len;){e<a.heap_len&&q(b,a.heap[e+1],a.heap[e],a.depth)&&e++;if(q(b,d,a.heap[e],a.depth))break;a.heap[c]=a.heap[e];c=e;e<<=1}a.heap[c]=d}function r(a,b,c){var d,e,k=0,l,m;if(0!==a.last_lit){do d=a.pending_buf[a.d_buf+2*k]<<8|a.pending_buf[a.d_buf+2*k+
    1],e=a.pending_buf[a.l_buf+k],k++,0===d?h(a,e,b):(l=E[e],h(a,l+256+1,b),m=F[l],0!==m&&(e-=L[l],g(a,e,m)),d--,l=256>d?z[d]:z[256+(d>>>7)],h(a,l,c),m=G[l],0!==m&&(d-=M[l],g(a,d,m)));while(k<a.last_lit)}h(a,256,b)}function u(a,b){var c=b.dyn_tree,d=b.stat_desc.static_tree,e=b.stat_desc.has_stree,g=b.stat_desc.elems,h,k=-1,m;a.heap_len=0;a.heap_max=573;for(h=0;h<g;h++)0!==c[2*h]?(a.heap[++a.heap_len]=k=h,a.depth[h]=0):c[2*h+1]=0;for(;2>a.heap_len;)m=a.heap[++a.heap_len]=2>k?++k:0,c[2*m]=1,a.depth[m]=
    0,a.opt_len--,e&&(a.static_len-=d[2*m+1]);b.max_code=k;for(h=a.heap_len>>1;1<=h;h--)t(a,c,h);m=g;do h=a.heap[1],a.heap[1]=a.heap[a.heap_len--],t(a,c,1),d=a.heap[1],a.heap[--a.heap_max]=h,a.heap[--a.heap_max]=d,c[2*m]=c[2*h]+c[2*d],a.depth[m]=(a.depth[h]>=a.depth[d]?a.depth[h]:a.depth[d])+1,c[2*h+1]=c[2*d+1]=m,a.heap[1]=m++,t(a,c,1);while(2<=a.heap_len);a.heap[--a.heap_max]=a.heap[1];h=b.dyn_tree;m=b.max_code;for(var q=b.stat_desc.static_tree,p=b.stat_desc.has_stree,r=b.stat_desc.extra_bits,u=b.stat_desc.extra_base,
                                                                                                                                                                                                                                                                                                                                                                                                                                        v=b.stat_desc.max_length,A,w,x=0,g=0;15>=g;g++)a.bl_count[g]=0;h[2*a.heap[a.heap_max]+1]=0;for(d=a.heap_max+1;573>d;d++)e=a.heap[d],g=h[2*h[2*e+1]+1]+1,g>v&&(g=v,x++),h[2*e+1]=g,e>m||(a.bl_count[g]++,A=0,e>=u&&(A=r[e-u]),w=h[2*e],a.opt_len+=w*(g+A),p&&(a.static_len+=w*(q[2*e+1]+A)));if(0!==x){do{for(g=v-1;0===a.bl_count[g];)g--;a.bl_count[g]--;a.bl_count[g+1]+=2;a.bl_count[v]--;x-=2}while(0<x);for(g=v;0!==g;g--)for(e=a.bl_count[g];0!==e;)q=a.heap[--d],q>m||(h[2*q+1]!==g&&(a.opt_len+=(g-h[2*q+1])*
    h[2*q],h[2*q+1]=g),e--)}l(c,k,a.bl_count)}function w(a,b,c){var d,e=-1,g,h=b[1],k=0,l=7,m=4;0===h&&(l=138,m=3);b[2*(c+1)+1]=65535;for(d=0;d<=c;d++)g=h,h=b[2*(d+1)+1],++k<l&&g===h||(k<m?a.bl_tree[2*g]+=k:0!==g?(g!==e&&a.bl_tree[2*g]++,a.bl_tree[32]++):10>=k?a.bl_tree[34]++:a.bl_tree[36]++,k=0,e=g,0===h?(l=138,m=3):g===h?(l=6,m=3):(l=7,m=4))}function x(a,b,c){var d,e=-1,k,l=b[1],m=0,q=7,p=4;0===l&&(q=138,p=3);for(d=0;d<=c;d++)if(k=l,l=b[2*(d+1)+1],!(++m<q&&k===l)){if(m<p){do h(a,k,a.bl_tree);while(0!==
--m)}else 0!==k?(k!==e&&(h(a,k,a.bl_tree),m--),h(a,16,a.bl_tree),g(a,m-3,2)):10>=m?(h(a,17,a.bl_tree),g(a,m-3,3)):(h(a,18,a.bl_tree),g(a,m-11,7));m=0;e=k;0===l?(q=138,p=3):k===l?(q=6,p=3):(q=7,p=4)}}function A(a){var b=4093624447,c;for(c=0;31>=c;c++,b>>>=1)if(b&1&&0!==a.dyn_ltree[2*c])return 0;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return 1;for(c=32;256>c;c++)if(0!==a.dyn_ltree[2*c])return 1;return 0}function B(a,b,c,d){g(a,0+(d?1:0),3);p(a);e(a,c);e(a,~c);v.arraySet(a.pending_buf,
    a.window,b,c,a.pending);a.pending+=c}var v=b("../utils/common"),F=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],G=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=Array(576);d(H);var C=Array(60);d(C);var z=Array(512);d(z);var E=Array(256);d(E);var L=Array(29);d(L);var M=Array(30);d(M);var I=function(a,b,c,d,e){this.static_tree=a;this.extra_bits=b;this.extra_base=c;this.elems=
    d;this.max_length=e;this.has_stree=a&&a.length},K,O,N,R=function(a,b){this.dyn_tree=a;this.max_code=0;this.stat_desc=b},S=!1;a._tr_init=function(a){if(!S){var b,c,d,e=Array(16);for(d=c=0;28>d;d++)for(L[d]=c,b=0;b<1<<F[d];b++)E[c++]=d;E[c-1]=d;for(d=c=0;16>d;d++)for(M[d]=c,b=0;b<1<<G[d];b++)z[c++]=d;for(c>>=7;30>d;d++)for(M[d]=c<<7,b=0;b<1<<G[d]-7;b++)z[256+c++]=d;for(b=0;15>=b;b++)e[b]=0;for(b=0;143>=b;)H[2*b+1]=8,b++,e[8]++;for(;255>=b;)H[2*b+1]=9,b++,e[9]++;for(;279>=b;)H[2*b+1]=7,b++,e[7]++;for(;287>=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b;)H[2*b+1]=8,b++,e[8]++;l(H,287,e);for(b=0;30>b;b++)C[2*b+1]=5,C[2*b]=k(b,5);K=new I(H,F,257,286,15);O=new I(C,G,0,30,15);N=new I([],D,0,19,7);S=!0}a.l_desc=new R(a.dyn_ltree,K);a.d_desc=new R(a.dyn_dtree,O);a.bl_desc=new R(a.bl_tree,N);a.bi_buf=0;a.bi_valid=0;m(a)};a._tr_stored_block=B;a._tr_flush_block=function(a,b,c,d){var e,h,k=0;if(0<a.level){2===a.strm.data_type&&(a.strm.data_type=A(a));u(a,a.l_desc);u(a,a.d_desc);w(a,a.dyn_ltree,a.l_desc.max_code);w(a,a.dyn_dtree,a.d_desc.max_code);u(a,a.bl_desc);
    for(k=18;3<=k&&0===a.bl_tree[2*y[k]+1];k--);a.opt_len+=3*(k+1)+14;e=a.opt_len+3+7>>>3;h=a.static_len+3+7>>>3;h<=e&&(e=h)}else e=h=c+5;if(c+4<=e&&-1!==b)B(a,b,c,d);else if(4===a.strategy||h===e)g(a,2+(d?1:0),3),r(a,H,C);else{g(a,4+(d?1:0),3);b=a.l_desc.max_code+1;c=a.d_desc.max_code+1;k+=1;g(a,b-257,5);g(a,c-1,5);g(a,k-4,4);for(e=0;e<k;e++)g(a,a.bl_tree[2*y[e]+1],3);x(a,a.dyn_ltree,b-1);x(a,a.dyn_dtree,c-1);r(a,a.dyn_ltree,a.dyn_dtree)}m(a);d&&p(a)};a._tr_tally=function(a,b,c){a.pending_buf[a.d_buf+
2*a.last_lit]=b>>>8&255;a.pending_buf[a.d_buf+2*a.last_lit+1]=b&255;a.pending_buf[a.l_buf+a.last_lit]=c&255;a.last_lit++;0===b?a.dyn_ltree[2*c]++:(a.matches++,b--,a.dyn_ltree[2*(E[c]+256+1)]++,a.dyn_dtree[2*(256>b?z[b]:z[256+(b>>>7)])]++);return a.last_lit===a.lit_bufsize-1};a._tr_align=function(a){g(a,2,3);h(a,256,H);16===a.bi_valid?(e(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):8<=a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf&255,a.bi_buf>>=8,a.bi_valid-=8)}},{"../utils/common":27}],39:[function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   c,a){c.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}]},{},[9])(9)});
define("src/formats/kml/KmlFileCache",[],function(){var f=function(){this._rootFile=null;this._map={}};f.prototype.retrieve=function(b){if(0==b.indexOf("#")||null==b||0!=b.indexOf("http"))return this._rootFile;var c=b;-1!=b.indexOf("#")&&(c=b.substr(0,b.indexOf("#")-1));return this._map[c]?this._map[c]:null};f.prototype.add=function(b,c){this._rootFile?this._map[b]=c:this._rootFile=c};return f});
define("src/formats/kml/styles/KmlStyleSelector",["./../KmlObject"],function(f){var b=function(b){f.call(this,b)};b.prototype=Object.create(f.prototype);b.prototype.getTagNames=function(){return["Style","StyleMap"]};return b});
define("src/formats/kml/styles/KmlPolyStyle",["../../../util/Color","./KmlColorStyle","./../KmlElements","../util/NodeTransformers"],function(f,b,c,a){var d=function(a){b.call(this,a)};d.prototype=Object.create(b.prototype);Object.defineProperties(d.prototype,{kmlFill:{get:function(){return this._factory.specific(this,{name:"fill",transformer:a["boolean"]})}},kmlOutline:{get:function(){return this._factory.specific(this,{name:"outline",transformer:a["boolean"]})}}});d.update=function(a,b){a=a||{};
    var c=b||{};c._drawInterior=a.kmlFill||!0;c._drawOutline=a.kmlOutline||!1;c._outlineColor=b._outlineColor||f.WHITE;c._interiorColor=a.kmlColor&&f.colorFromKmlHex(a.kmlColor)||f.WHITE;c._colorMode=a.kmlColorMode||"normal";return c};d.prototype.getTagNames=function(){return["PolyStyle"]};c.addKey(d.prototype.getTagNames()[0],d);return d});
define("src/formats/kml/KmlLink",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlHref:{get:function(){return this._factory.specific(this,{name:"href",transformer:c.string})}},kmlRefreshMode:{get:function(){return this._factory.specific(this,{name:"refreshMode",transformer:c.string})}},kmlRefreshInterval:{get:function(){return this._factory.specific(this,{name:"refreshInterval",
    transformer:c.number})}},kmlViewRefreshMode:{get:function(){return this._factory.specific(this,{name:"viewRefreshMode",transformer:c.string})}},kmlViewRefreshTime:{get:function(){return this._factory.specific(this,{name:"viewRefreshTime",transformer:c.number})}},kmlViewBoundScale:{get:function(){return this._factory.specific(this,{name:"viewBoundScale",transformer:c.number})}},kmlViewFormat:{get:function(){return this._factory.specific(this,{name:"viewFormat",transformer:c.string})}},kmlHttpQuery:{get:function(){return this._factory.specific(this,
    {name:"httpQuery",transformer:c.string})}}});a.prototype.getTagNames=function(){return["Link"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/KmlIcon",["./KmlLink","./KmlElements","./util/NodeTransformers"],function(f,b,c){var a=function(a){f.call(this,a)};a.prototype=Object.create(f.prototype);Object.defineProperties(a.prototype,{kmlX:{get:function(){return this._factory.specific(this,{name:"gx:x",transformer:c.number})}},kmlY:{get:function(){return this._factory.specific(this,{name:"gx:y",transformer:c.number})}},kmlW:{get:function(){return this._factory.specific(this,{name:"gx:w",transformer:c.number})}},kmlH:{get:function(){return this._factory.specific(this,
    {name:"gx:h",transformer:c.number})}}});a.prototype.getTagNames=function(){return["Icon"]};b.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/styles/KmlIconStyle",["./KmlColorStyle","./../KmlElements","../KmlIcon","../util/NodeTransformers"],function(f,b,c,a){var d=function(a){f.call(this,a)};d.prototype=Object.create(f.prototype);Object.defineProperties(d.prototype,{kmlScale:{get:function(){return this._factory.specific(this,{name:"scale",transformer:a.number})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:a.number})}},kmlIcon:{get:function(){return this._factory.any(this,
    {name:c.prototype.getTagNames()})}},kmlHotSpotX:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:a.attribute("x")})}},kmlHotSpotY:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:a.attribute("y")})}},kmlHotSpotXUnits:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:a.attribute("xunits")})}},kmlHotSpotYUnits:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:a.attribute("yunits")})}}});
    d.update=function(a,b){a=a||{};var c=b||{};c._imageScale=a.kmlScale||1;c._imageSource=a.kmlIcon&&a.kmlIcon.kmlHref||null;return c};d.prototype.getTagNames=function(){return["IconStyle"]};b.addKey(d.prototype.getTagNames()[0],d);return d});
define("src/formats/kml/styles/KmlLabelStyle",["./KmlColorStyle","../KmlElements","../util/NodeTransformers"],function(f,b,c){var a=function(a){f.call(this,a)};a.prototype=Object.create(f.prototype);Object.defineProperties(a.prototype,{kmlScale:{get:function(){return this._factory.specific(this,{name:"scale",transformer:c.number})}}});a.update=function(){};a.prototype.getTagNames=function(){return["LabelStyle"]};b.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/styles/KmlLineStyle",["../../../util/Color","./KmlColorStyle","./../KmlElements","../util/NodeTransformers"],function(f,b,c,a){var d=function(a){b.call(this,a)};d.prototype=Object.create(b.prototype);Object.defineProperties(d.prototype,{kmlWidth:{get:function(){return this._factory.specific(this,{name:"width",transformer:a.number})}},kmlOuterColor:{get:function(){return this._factory.specific(this,{name:"gx:outerColor",transformer:a.string})}},kmlOuterWidth:{get:function(){return this._factory.specific(this,
    {name:"gx:outerWidth",transformer:a.number})}},kmlPhysicalWidth:{get:function(){return this._factory.specific(this,{name:"gx:physicalWidth",transformer:a.number})}},kmlLabelVisibility:{get:function(){return this._factory.specific(this,{name:"gx:labelVisibility",transformer:a["boolean"]})}}});d.update=function(a,b){var c=b||{};a=a||{};c._outlineColor=a.kmlColor&&f.colorFromKmlHex(a.kmlColor)||f.WHITE;c._outlineWidth=a.kmlWidth||10;return c};d.prototype.getTagNames=function(){return["LineStyle"]};c.addKey(d.prototype.getTagNames()[0],
    d);return d});
define("src/formats/kml/styles/KmlListStyle",["../util/ItemIcon","../KmlElements","./KmlSubStyle","../util/NodeTransformers"],function(f,b,c,a){var d=function(a){c.call(this,a)};d.prototype=Object.create(c.prototype);Object.defineProperties(d.prototype,{kmlBgColor:{get:function(){return this._factory.specific(this,{name:"bgColor",transformer:a.string})}},kmlListItemType:{get:function(){return this._factory.specific(this,{name:"listItemType",transformer:a.string})}},kmlItemIcon:{get:function(){return this._factory.any(this,{name:f.prototype.getTagNames()})}}});
    d.update=function(a){};d.prototype.getTagNames=function(){return["ListStyle"]};b.addKey(d.prototype.getTagNames()[0],d);return d});
define("src/formats/kml/styles/KmlStyle","../../../util/Color ../../../util/Font ./KmlStyleSelector ./../KmlElements ./KmlPolyStyle ./KmlIconStyle ./KmlLabelStyle ./KmlLineStyle ./KmlListStyle ./KmlBalloonStyle ../../../util/Offset ../../../util/Promise ../../../shapes/ShapeAttributes ../../../shapes/TextAttributes".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t){var r=function(a){c.call(this,a)};r.prototype=Object.create(c.prototype);Object.defineProperties(r.prototype,{kmlIconStyle:{get:function(){return this._factory.any(this,
    {name:e.prototype.getTagNames()})}},kmlLabelStyle:{get:function(){return this._factory.any(this,{name:g.prototype.getTagNames()})}},kmlLineStyle:{get:function(){return this._factory.any(this,{name:h.prototype.getTagNames()})}},kmlPolyStyle:{get:function(){return this._factory.any(this,{name:d.prototype.getTagNames()})}},kmlBalloonStyle:{get:function(){return this._factory.any(this,{name:l.prototype.getTagNames()})}},kmlListStyle:{get:function(){return this._factory.any(this,{name:k.prototype.getTagNames()})}}});
    r.prototype.generate=function(a){a=a||{};var b=this||{};b.kmlIconStyle&&e.update(b.kmlIconStyle,a);b.kmlListStyle&&k.update(b.kmlListStyle,a);b.kmlBalloonStyle&&l.update(b.kmlBalloonStyle,a);b.kmlLabelStyle&&g.update(b.kmlLabelStyle,a);b.kmlPolyStyle&&d.update(b.kmlPolyStyle,a);b.kmlLineStyle&&h.update(b.kmlLineStyle,a);return a};r.prototype.getStyle=function(){var a=this;return new p(function(b){window.setTimeout(function(){b(a)},0)})};r.prototype.getTagNames=function(){return["Style"]};a.addKey(r.prototype.getTagNames()[0],
        r);r.placemarkAttributes=function(a){a=a||{};a._imageColor=a._imageColor||new f(1,1,1,1);a._imageOffset=a._imageOffset||new m(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5);a._imageScale=a._imageScale||1;a._imageSource=a._imageSource||null;a._depthTest=a._depthTest||!0;a._labelAttributes=a._labelAttributes||new t(r.textAttributes());a._drawLeaderLine=a._drawLeaderLine||!1;a._leaderLineAttributes=a._leaderLineAttributes||new q(r.shapeAttributes());return a};r.textAttributes=function(a){a=
        a||{};a._color=a._color||new f(1,1,1,1);a._font=a._font||new b(14);a._offset=a._offset||new m(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0);a._scale=a._scale||1;a._depthTest=a._depthTest||!1;return a};r.shapeAttributes=function(a){a=a||{};a._drawInterior=a._drawInterior||!0;a._drawOutline=a._drawOutline||!0;a._enableLighting=a._enableLighting||!1;a._interiorColor=a._interiorColor||f.WHITE;a._outlineColor=a._outlineColor||f.RED;a._outlineWidth=a._outlineWidth||1;a._outlineStippleFactor=
        a._outlineStippleFactor||0;a._outlineStipplePattern=a._outlineStipplePattern||61680;a._imageSource=a._imageSource||null;a._depthTest=a._depthTest||!0;a._drawVerticals=a._drawVerticals||!1;a._applyLighting=a._applyLighting||!1;return a};return r});
define("src/formats/kml/util/StyleResolver",["../KmlFile","../../../util/Logger"],function(f,b){var c=function(a){this._fileCache=a};c.prototype.handleRemoteStyle=function(a,c,e,g,h){a?this.handleStyleUrl(a,e,g,h):c?this.handleStyleSelector(c,e,g):b.logMessage(b.LEVEL_WARNING,"StyleResolver","handleRemoteStyle","Style was null.")};c.prototype.handleStyleUrl=function(a,b,c,g){g=this.handlePromiseOfFile(a,g);g.then(function(g){g.resolveStyle(a).then(function(a){a.isMap?a.resolve(b,c):b({normal:a,highlight:null})})})};
    c.prototype.handlePromiseOfFile=function(a,b){b||(b=this._fileCache.retrieve(a),b||(b=new WorldWind.KmlFile({url:a}),this._fileCache.add(b)));return b};c.prototype.handleStyleSelector=function(a,b,c){a.isMap?a.resolve(b,c):window.setTimeout(function(){b({normal:a,highlight:null})},0)};return c});
define("src/formats/kml/util/Pair","./../KmlElements ../KmlObject ../styles/KmlStyleSelector ./NodeTransformers ../../../util/Promise ../util/StyleResolver".split(" "),function(f,b,c,a,d,e){var g=function(a){b.call(this,a)};g.prototype=Object.create(b.prototype);Object.defineProperties(g.prototype,{kmlKey:{get:function(){return this._factory.specific(this,{name:"key",transformer:a.string})}},kmlStyleUrl:{get:function(){return this._factory.specific(this,{name:"styleUrl",transformer:a.string})}},kmlStyleSelector:{get:function(){return this._factory.any(this,
    {name:c.prototype.getTagNames()})}}});g.prototype.getTagNames=function(){return["Pair"]};g.prototype.getStyle=function(){var a=this;return new d(function(b,c){window.setTimeout(function(){e.handleRemoteStyle(a.kmlStyleUrl,a.kmlStyleSelector,b,c)},0)})};f.addKey(g.prototype.getTagNames()[0],g);return g});
define("src/formats/kml/styles/KmlStyleMap",["../KmlElements","./KmlSubStyle","../util/Pair","../../../util/Promise"],function(f,b,c,a){c=function(a){b.call(this,a)};c.prototype=Object.create(b.prototype);Object.defineProperties(c.prototype,{kmlPairs:{get:function(){return this._factory.all(this)}},isMap:{get:function(){return!0}}});c.prototype.resolve=function(b){var c={},g=[];this.kmlPairs.forEach(function(a){var b=a.kmlKey;a=a.getStyle();g.push(a);a.then(function(a){c[b]=a.normal})});a.all(g).then(function(){c.normal||
(c.normal=null);c.highlight||(c.highlight=null);b(c)})};c.prototype.getTagNames=function(){return["StyleMap"]};f.addKey(c.prototype.getTagNames()[0],c);return c});
define("src/formats/kml/KmlTimeSpan",["./KmlElements","./KmlTimePrimitive","./util/NodeTransformers"],function(f,b,c){var a=function(a){a.isTimeSpan=!0;b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlBegin:{get:function(){return this._factory.specific(this,{name:"begin",transformer:c.date})}},kmlEnd:{get:function(){return this._factory.specific(this,{name:"end",transformer:c.date})}}});a.prototype.getTagNames=function(){return["TimeSpan"]};f.addKey(a.prototype.getTagNames()[0],
    a);return a});define("src/formats/kml/KmlTimeStamp",["./KmlElements","./KmlTimePrimitive","./util/NodeTransformers"],function(f,b,c){var a=function(a){a.isTimeStamp=!0;b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlWhen:{get:function(){return this._factory.specific(this,{name:"when",transformer:c.date})}}});a.prototype.getTagNames=function(){return["TimeStamp"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/util/Remote",["../../../error/ArgumentError","../../../util/Logger","../../../util/Promise"],function(f,b,c){var a=function(a){if(a.ajax)return this.ajax(a.url,a);if(a.zip)return a.responseType=a.responseType||"arraybuffer",this.ajax(a.url,a);throw new f(b.logMessage(b.LEVEL_SEVERE,"RemoteDocument","constructor","Invalid option for retrieval specified. Use either ajax or zip option."));};a.prototype.ajax=function(a,e){return new c(function(c,h){var f=new XMLHttpRequest;f.open("GET",
    a,!0);e.responseType&&(f.responseType=e.responseType);f.onreadystatechange=function(){4===f.readyState&&(200===f.status?c(this.responseText):b.log(b.LEVEL_WARNING,"KmlFile retrieval failed ("+f.statusText+"): "+a))};f.onerror=function(){b.log(b.LEVEL_WARNING,"Remote file retrieval failed: "+a);h()}.bind(this);f.ontimeout=function(){b.log(b.LEVEL_WARNING,"Remote file retrieval timed out: "+a);h()}.bind(this);f.send(null)})};return a});
define("src/util/XmlDocument",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a){this._document=a};c.prototype.dom=function(){if(DOMParser){var a=(new DOMParser).parseFromString(this._document,"text/xml");if(a.getElementsByTagName("parsererror").length)throw new f(b.logMessage(b.LEVEL_SEVERE,"XmlDocument","dom","Invalid XML document. "+a.getElementsByTagName("parsererror")[0].innerHTML));return a}a=new ActiveXObject("Microsoft.XMLDOM");a.async=!1;a.loadXML(text);return a};
    c.isValid=function(a){try{return(new c(a)).dom(),!0}catch(b){return!1}};return c});
define("src/formats/kml/KmlFile","../../error/ArgumentError ../../util/jszip ./KmlElements ./KmlFileCache ./KmlObject ./styles/KmlStyle ./styles/KmlStyleMap ./KmlTimeSpan ./KmlTimeStamp ../../util/Logger ../../util/Promise ./util/Remote ./util/StyleResolver ../../util/XmlDocument".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t){c=function(c,e){var g=this;if(!c)throw new f(l.logMessage(l.LEVEL_SEVERE,"KmlFile","constructor","invalidDocumentPassed"));this._controls=e||null;this._fileCache=new a;this._styleResolver=
    new q(this._fileCache);var h;h=new m(function(a){g.requestRemote(c).then(function(h){var f;if(-1==c.indexOf(".kmz"))f=h;else{var k=new b;k.load(h);k.files.forEach(function(a){a.endsWith(".kml")&&null==f&&(f=a.asText())})}g._document=(new t(f)).dom();d.call(g,{objectNode:g._document.documentElement,controls:e});window.setTimeout(function(){a(g)},0)})});this._fileCache.add(c,h);return h};c.prototype=Object.create(d.prototype);Object.defineProperties(c.prototype,{shapes:{get:function(){return this._factory.all(this)}}});
    c.prototype.render=function(a){var b=this;this.shapes.forEach(function(c){c.render(a,{lastStyle:null,lastVisibility:null,currentTimeInterval:null,regionInvisible:null,fileCache:b._fileCache,styleResolver:b._styleResolver})})};c.prototype.requestRemote=function(a){var b={};b.url=a;a.endsWith&&a.endsWith(".kmz")||-1!=a.indexOf(".kmz")?b.zip=!0:b.ajax=!0;return new p(b)};c.prototype.resolveStyle=function(a){var b=this,c=a.substring(a.indexOf("#")+1,a.length);return new m(function(a,d){var h;(h=b._document.querySelector?
        b._document.querySelector("*[id='"+c+"']"):b._document.getElementById(c))&&null!=h||d();h.nodeName==e.prototype.getTagNames()[0]?a(new e({objectNode:h})):h.nodeName==g.prototype.getTagNames()[0]?a(new g({objectNode:h})):l.logMessage(l.LEVEL_WARNING,"KmlFile","resolveStyle","Style must contain either Style node or StyleMap node.")})};return c});
define("src/formats/kml/KmlLatLonAltBox",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlNorth:{get:function(){return this._factory.specific(this,{name:"north",transformer:c.number})}},kmlSouth:{get:function(){return this._factory.specific(this,{name:"south",transformer:c.number})}},kmlEast:{get:function(){return this._factory.specific(this,{name:"east",transformer:c.number})}},
    kmlWest:{get:function(){return this._factory.specific(this,{name:"west",transformer:c.number})}},kmlMinAltitude:{get:function(){return this._factory.specific(this,{name:"minAltitude",transformer:c.number})}},kmlMaxAltitude:{get:function(){return this._factory.specific(this,{name:"maxAltitude",transformer:c.number})}}});a.prototype.getTagNames=function(){return["LatLonAltBox"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/KmlLod",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlMinLodPixels:{get:function(){return this._factory.specific(this,{name:"minLodPixels",transformer:c.number})}},kmlMaxLodPixels:{get:function(){return this._factory.specific(this,{name:"maxLodPixels",transformer:c.number})}},kmlMinFadeExtent:{get:function(){return this._factory.specific(this,
    {name:"minFadeExtent",transformer:c.number})}},kmlMaxFadeExtent:{get:function(){return this._factory.specific(this,{name:"maxFadeExtent",transformer:c.number})}}});a.prototype.getTagNames=function(){return["Lod"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/KmlRegion","../../geom/BoundingBox ../../util/Color ./KmlElements ./KmlLatLonAltBox ./KmlLod ./KmlObject ./styles/KmlStyle ./util/NodeTransformers ../../geom/Sector".split(" "),function(f,b,c,a,d,e,g,h,k){b=function(a){e.call(this,a)};b.prototype=Object.create(e.prototype);Object.defineProperties(b.prototype,{kmlLatLonAltBox:{get:function(){return this._factory.specific(this,{name:a.prototype.getTagNames(),transformer:h.kmlObject})}},kmlLod:{get:function(){return this._factory.specific(this,
    {name:d.prototype.getTagNames(),transformer:h.kmlObject})}}});b.prototype.intersectsVisible=function(a){var b=this.kmlLatLonAltBox,c=new f;c.setToSector(new k(b.kmlSouth,b.kmlNorth,b.kmlWest,b.kmlEast),a.globe,b.kmlMinAltitude,b.kmlMaxAltitude);return c.intersectsFrustum(a.navigatorState.frustumInModelCoordinates)&&(!b.kmlMinAltitude||a.eyePosition.altitude>b.kmlMinAltitude)&&(!b.kmlMaxAltitude||a.eyePosition.altitude<b.kmlMaxAltitude)};b.prototype.getTagNames=function(){return["Region"]};c.addKey(b.prototype.getTagNames()[0],
    b);return b});
define("src/formats/kml/features/KmlFeature","./../KmlObject ../KmlAbstractView ../KmlFile ../styles/KmlStyleMap ../styles/KmlStyleSelector ../KmlRegion ../KmlTimePrimitive ../util/NodeTransformers ../../../util/Promise".split(" "),function(f,b,c,a,d,e,g,h,k){c=function(a){this.isFeature=a.isFeature=!0;f.call(this,a);this.controlledVisibility=this._pStyle=null};c.prototype=Object.create(f.prototype);Object.defineProperties(c.prototype,{style:{get:function(){return this._pStyle}},kmlName:{get:function(){return this._factory.specific(this,{name:"name",
    transformer:h.string})}},kmlVisibility:{get:function(){return this._factory.specific(this,{name:"visibility",transformer:h["boolean"]})}},kmlOpen:{get:function(){return this._factory.specific(this,{name:"open",transformer:h["boolean"]})}},kmlAddress:{get:function(){return this._factory.specific(this,{name:"address",transformer:h.string})}},kmlPhoneNumber:{get:function(){return this._factory.specific(this,{name:"phoneNumber",transformer:h.string})}},kmlDescription:{get:function(){return this._factory.specific(this,
    {name:"description",transformer:h.string})}},kmlStyleUrl:{get:function(){return this._factory.specific(this,{name:"styleUrl",transformer:h.string})}},kmlSnippet:{get:function(){return this._factory.specific(this,{name:"Snippet",transformer:h.string})}},kmlAbstractView:{get:function(){return this._factory.any(this,{name:b.prototype.getTagNames()})}},kmlTimePrimitive:{get:function(){return this._factory.any(this,{name:g.prototype.getTagNames()})}},kmlStyleSelector:{get:function(){return this._factory.any(this,
    {name:d.prototype.getTagNames()})}},kmlRegion:{get:function(){return this._factory.any(this,{name:e.prototype.getTagNames()})}}});c.prototype.render=function(a,b){f.prototype.render.call(this,a,b);this.solveStyle(a,b);this.solveVisibility(a,b)};c.prototype.solveStyle=function(a,b){this.getStyle(a,b);null!=this.style?b.lastStyle=this.style:a.redrawRequested=!0};c.prototype.solveRegion=function(a){return this.kmlRegion?this.kmlRegion.intersectsVisible(a):!0};c.prototype.solveVisibility=function(a,b){var c=
    !1!==b.lastVisibility,d=this.solveTimeVisibility(a),e=this.solveRegion(a),g=!1!==this.kmlVisibility,h=!1!==this.controlledVisibility;this.enabled=c&&d&&e&&g&&h;b.lastVisibility=this.enabled;this._renderable&&(this._renderable.enabled=this.enabled)};c.prototype.solveTimeVisibility=function(a){var b=this.kmlTimePrimitive&&this.kmlTimePrimitive.timeRange();if(a.currentLayer.currentTimeInterval&&b){var c=a.currentLayer.currentTimeInterval[0];a=a.currentLayer.currentTimeInterval[1];if(b&&(b.from<c||b.from>
    a||b.to>a))return!1}return!0};c.prototype.getStyle=function(a,b){if(!this._pStyle&&(this.kmlStyleUrl||this.kmlStyleSelector)){var c=this;(new k(function(a,d){window.setTimeout(function(){b.styleResolver.handleRemoteStyle(c.kmlStyleUrl,c.kmlStyleSelector,a,d)},0)})).then(function(b){c._pStyle=b;a.redrawRequested=!0})}};c.prototype.getTagNames=function(){return"NetworkLink Placemark PhotoOverlay ScreenOverlay GroundOverlay Folder Document".split(" ")};return c});
define("src/formats/kml/features/KmlContainer",["./KmlFeature"],function(f){var b=function(b){f.call(this,b)};b.prototype=Object.create(f.prototype);Object.defineProperties(b.prototype,{kmlShapes:{get:function(){return this._factory.all(this).filter(function(b){return b.isFeature})}}});b.prototype.render=function(b,a){f.prototype.render.call(this,b,a);var d=this;this.kmlShapes.forEach(function(e){e.render(b,{lastStyle:a.lastStyle,lastVisibility:d.enabled,currentTimeInterval:a.currentTimeInterval,
    regionInvisible:a.regionInvisible,fileCache:a.fileCache,styleResolver:a.styleResolver})})};b.prototype.getTagNames=function(){return["Folder","Document"]};return b});define("src/formats/kml/util/Schema",["./../KmlElements","../KmlObject"],function(f,b){var c=function(a){b.call(this,a)};c.prototype=Object.create(b.prototype);c.prototype.getTagNames=function(){return["Schema"]};f.addKey(c.prototype.getTagNames()[0],c);return c});
define("src/formats/kml/features/KmlDocument",["./KmlContainer","../KmlElements","./KmlFeature","../util/Schema"],function(f,b,c,a){c=function(a){f.call(this,a)};c.prototype=Object.create(f.prototype);Object.defineProperties(c.prototype,{kmlSchemas:{get:function(){return this._factory.all(this).filter(function(b){return b instanceof a})}}});c.prototype.getTagNames=function(){return["Document"]};b.addKey(c.prototype.getTagNames()[0],c);return c});
define("src/formats/kml/features/KmlFolder",["./KmlContainer","./../KmlElements"],function(f,b){var c=function(a){f.call(this,a)};c.prototype=Object.create(f.prototype);c.prototype.getTagNames=function(){return["Folder"]};b.addKey(c.prototype.getTagNames()[0],c);return c});
define("src/formats/kml/geom/KmlGeometry",["../KmlObject"],function(f){var b=function(b){f.call(this,b);this._renderable=null};b.prototype=Object.create(f.prototype);b.prototype.render=function(b,a){f.prototype.render.call(this,b,a);this.enabled=a.lastVisibility};b.prototype.getTagNames=b.getTagNames=function(){return["Point","LinearRing","LineString","MultiGeometry","Polygon"]};return b});
define("src/formats/kml/KmlLatLonBox",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlNorth:{get:function(){return this._factory.specific(this,{name:"north",transformer:c.number})}},kmlSouth:{get:function(){return this._factory.specific(this,{name:"south",transformer:c.number})}},kmlEast:{get:function(){return this._factory.specific(this,{name:"east",transformer:c.number})}},
    kmlWest:{get:function(){return this._factory.specific(this,{name:"west",transformer:c.number})}},kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:c.string})}}});a.prototype.getTagNames=function(){return["LatLonBox"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/KmlLatLonQuad",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlCoordinates:{get:function(){return this._factory.specific(this,{name:"coordinates",transformer:c.string})}}});a.prototype.getTagNames=function(){return["gx:LatLonQuad"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/features/KmlOverlay",["./KmlFeature","./../KmlIcon","../util/NodeTransformers"],function(f,b,c){var a=function(a){f.call(this,a)};a.prototype=Object.create(f.prototype);Object.defineProperties(a.prototype,{kmlColor:{get:function(){return this._factory.specific(this,{name:"color",transformer:c.string})}},kmlDrawOrder:{get:function(){return this._factory.specific(this,{name:"drawOrder",transformer:c.string})}},kmlIcon:{get:function(){return this._factory.any(this,{name:b.prototype.getTagNames()})}}});
    a.prototype.getTagNames=function(){return["PhotoOverlay","ScreenOverlay","GroundOverlay"]};return a});
define("src/formats/kml/features/KmlGroundOverlay","./../KmlElements ./KmlFeature ../KmlLatLonBox ../KmlLatLonQuad ./KmlOverlay ../util/NodeTransformers ../../../geom/Sector ../../../shapes/SurfaceImage".split(" "),function(f,b,c,a,d,e,g,h){var k=function(a){this.isGroundOverlay=!0;d.call(this,a)};k.prototype=Object.create(d.prototype);Object.defineProperties(k.prototype,{kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:e.string})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,
    {name:"altitudeMode",transformer:e.string})}},kmlLatLonBox:{get:function(){return this._factory.any(this,{name:c.prototype.getTagNames()})}},kmlLatLonQuad:{get:function(){return this._factory.any(this,{name:a.prototype.getTagNames()})}}});k.prototype.render=function(a,c){b.prototype.render.call(this,a,c);!this._renderable&&this.enabled&&this.kmlIcon&&this.kmlLatLonBox&&(this._renderable=new h(new g(this.kmlLatLonBox.kmlSouth,this.kmlLatLonBox.kmlNorth,this.kmlLatLonBox.kmlWest,this.kmlLatLonBox.kmlEast),
    this.kmlIcon.kmlHref),a.redrawRequested=!0);this._renderable&&this._renderable.render(a)};k.prototype.getTagNames=function(){return["GroundOverlay"]};f.addKey(k.prototype.getTagNames()[0],k);return k});
define("src/shapes/Path","../shapes/AbstractShape ../error/ArgumentError ../shaders/BasicTextureProgram ../geom/BoundingBox ../util/Color ../geom/Location ../util/Logger ../geom/Matrix ../pick/PickedObject ../geom/Position ../shapes/ShapeAttributes ../shapes/SurfacePolyline ../geom/Vec2 ../geom/Vec3".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t){d=function(a,c){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Path","constructor","missingPositions"));f.call(this,c);this._positions=a;this._pathType=
    WorldWind.GREAT_CIRCLE;this._numSubSegments=this._terrainConformance=10;this.referencePosition=this.determineReferencePosition(this._positions);this.scratchPoint=new t(0,0,0)};d.prototype=Object.create(f.prototype);Object.defineProperties(d.prototype,{positions:{get:function(){return this._positions},set:function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Path","constructor","missingPositions"));this._positions=a;this.referencePosition=this.determineReferencePosition(this._positions);this.reset()}},
    followTerrain:{get:function(){return this._followTerrain},set:function(a){this._followTerrain=a;this.reset()}},terrainConformance:{get:function(){return this._terrainConformance},set:function(a){this._terrainConformance=a;this.reset()}},numSubSegments:{get:function(){return this._numSubSegments},set:function(a){this._numSubSegments=0<=a?a:0;this.reset()}},pathType:{get:function(){return this._pathType},set:function(a){this._pathType=a;this.reset()}},extrude:{get:function(){return this._extrude},set:function(a){this._extrude=
        a;this.reset()}}});d.prototype.determineReferencePosition=function(a){return 0<a.length?a[0]:null};d.prototype.mustGenerateGeometry=function(a){return!this.currentData.tessellatedPoints||this.currentData.drawInterior!==this.activeAttributes.drawInterior||this.currentData.drawVerticals!==this.activeAttributes.drawVerticals||!this.followTerrain&&this.currentData.numSubSegments!==this.numSubSegments||this.followTerrain&&this.currentData.terrainConformance!==this.terrainConformance?!0:this.altitudeMode===
WorldWind.ABSOLUTE?!1:this.currentData.isExpired};d.prototype.createSurfaceShape=function(){return new p(this.positions,null)};d.prototype.doMakeOrderedRenderable=function(b){if(!this.referencePosition)return null;if(!this.mustGenerateGeometry(b))return this;var c=this.currentData.referencePoint;b.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude,this._altitudeMode,c);this.currentData.transformationMatrix.setToTranslation(c[0],c[1],
    c[2]);c=this.makeTessellatedPositions(b);if(2>c.length)return null;b=this.computeRenderedPath(b,c);this.currentData.tessellatedPoints=b;this.currentData.drawInterior=this.activeAttributes.drawInterior;this.currentData.drawVerticals=this.activeAttributes.drawVerticals;this.currentData.numSubSegments=this.numSubSegments;this.currentData.terrainConformance=this.terrainConformance;this.resetExpiration(this.currentData);this.currentData.fillVbo=!0;this.currentData.extent||(this.currentData.extent=new a);
    this.currentData.extent.setToPoints(b);this.currentData.extent.translate(this.currentData.referencePoint);return this};d.prototype.makeTessellatedPositions=function(a){var b=[],c=a.navigatorState,d=this.mustDrawVerticals(a),e=new t(0,0,0),g=new t(0,0,0),h=this._positions[0],f,k;d&&(this.currentData.verticalIndices=new Int16Array(2*this.positions.length),this.currentData.verticalIndices[0]=0,this.currentData.verticalIndices[1]=1);b.push(h);a.surfacePointForMode(h.latitude,h.longitude,h.altitude,this._altitudeMode,
    e);for(var l=1,m=this._positions.length;l<m;l++)f=this._positions[l],a.surfacePointForMode(f.latitude,f.longitude,f.altitude,this._altitudeMode,g),k=c.eyePoint.distanceTo(e),k=c.pixelSizeAtDistance(k),e.distanceTo(g)<8*k&&this.altitudeMode!==WorldWind.ABSOLUTE?b.push(f):this.makeSegment(a,h,f,e,g,b),h=f,e.copy(g),d&&(f=2*(b.length-1),this.currentData.verticalIndices[2*l]=f,this.currentData.verticalIndices[2*l+1]=f+1);return b};d.prototype.makeSegment=function(a,b,c,d,g,h){var f=a.navigatorState,k=
    f.eyePoint,m=new e(0,0),q=0,p,t,C;if(this._pathType!==WorldWind.LINEAR||this._followTerrain){if(g=this._pathType===WorldWind.LINEAR?e.linearDistance(b,c):this._pathType===WorldWind.RHUMB_LINE?e.rhumbDistance(b,c):e.greatCircleDistance(b,c),this._altitudeMode!==WorldWind.CLAMP_TO_GROUND&&(q=.5*(b.altitude+c.altitude)),q=g*(a.globe.equatorialRadius+q*a.verticalExaggeration),!(0>=q)){p=this._pathType===WorldWind.LINEAR?e.linearAzimuth(b,c):this._pathType===WorldWind.RHUMB_LINE?e.rhumbAzimuth(b,c):e.greatCircleAzimuth(b,
    c);this.scratchPoint.copy(d);for(t=d=0;1>d;){t=this._followTerrain?t+this._terrainConformance*f.pixelSizeAtDistance(this.scratchPoint.distanceTo(k)):t+q/this._numSubSegments;if(q<t||1E-9>q-t)break;d=t/q;C=d*g;this._pathType===WorldWind.LINEAR?e.linearLocation(b,p,C,m):this._pathType===WorldWind.RHUMB_LINE?e.rhumbLocation(b,p,C,m):e.greatCircleLocation(b,p,C,m);m.altitude=(1-d)*b.altitude+d*c.altitude;h.push(new l(m.latitude,m.longitude,m.altitude));this._followTerrain&&a.surfacePointForMode(m.latitude,
    m.longitude,m.altitude,WorldWind.CLAMP_TO_GROUND,this.scratchPoint)}h.push(c)}}else d.equals(g)||h.push(c)};d.prototype.computeRenderedPath=function(a,b){var c=this.mustDrawInterior(a)||this.mustDrawVerticals(a),d=Number.MAX_VALUE,e=a.navigatorState.eyePoint,g=new Float32Array((c?2:1)*b.length*3),h=c?6:3,f=new t(0,0,0),k,l,m,q;k=this._followTerrain&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND?WorldWind.RELATIVE_TO_GROUND:this.altitudeMode;for(var p=0,z=b.length;p<z;p++)l=b[p],a.surfacePointForMode(l.latitude,
    l.longitude,l.altitude,k,f),q=f.distanceToSquared(e),q<d&&(d=q),f.subtract(this.currentData.referencePoint),m=h*p,g[m]=f[0],g[m+1]=f[1],g[m+2]=f[2],c&&(a.surfacePointForMode(l.latitude,l.longitude,0,WorldWind.CLAMP_TO_GROUND,f),q=f.distanceToSquared(e),q<d&&(d=q),f.subtract(this.currentData.referencePoint),g[m+3]=f[0],g[m+4]=f[1],g[m+5]=f[2]);this.currentData.pointBufferHasExtrusionPoints=c;this.currentData.eyeDistance=Math.sqrt(d);return g};d.prototype.mustDrawInterior=function(a){return this.activeAttributes.drawInterior&&
    this._extrude&&this._altitudeMode!==WorldWind.CLAMP_TO_GROUND};d.prototype.mustDrawVerticals=function(a){return this.activeAttributes.drawOutline&&this.activeAttributes.drawVerticals&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND};d.prototype.doRenderOrdered=function(a){var b=a.currentGlContext,c=a.currentProgram,d=this.currentData,e=d.tessellatedPoints.length/3,g,h,f;this.applyMvpMatrix(a);d.vboCacheKey||(d.vboCacheKey=a.gpuResourceCache.generateCacheKey());g=a.gpuResourceCache.resourceForKey(d.vboCacheKey);
    g||(g=b.createBuffer(),a.gpuResourceCache.putResource(this.currentData.vboCacheKey,g,4*d.tessellatedPoints.length),d.fillVbo=!0);b.bindBuffer(b.ARRAY_BUFFER,g);d.fillVbo&&(b.bufferData(b.ARRAY_BUFFER,d.tessellatedPoints,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1));c.loadTextureEnabled(b,!1);a.pickingMode&&(f=a.uniquePickColor());this.mustDrawInterior(a)&&(h=this.activeAttributes.interiorColor,g=h.alpha*a.currentLayer.opacity,1>g&&!a.pickingMode&&b.depthMask(!1),c.loadColor(b,a.pickingMode?
        f:h),c.loadOpacity(b,a.pickingMode?0<g?1:0:g),b.vertexAttribPointer(c.vertexPointLocation,3,b.FLOAT,!1,0,0),b.drawArrays(b.TRIANGLE_STRIP,0,e));this.activeAttributes.drawOutline&&((this.mustDrawVerticals(a)&&this.mustDrawInterior(a)||this.altitudeMode===WorldWind.CLAMP_TO_GROUND)&&this.applyMvpMatrixForOutline(a),h=this.activeAttributes.outlineColor,g=h.alpha*a.currentLayer.opacity,1>g&&!a.pickingMode&&b.depthMask(!1),c.loadColor(b,a.pickingMode?f:h),c.loadOpacity(b,a.pickingMode?1:g),b.lineWidth(this.activeAttributes.outlineWidth),
        this.currentData.pointBufferHasExtrusionPoints?(g=24,e/=2):g=12,b.vertexAttribPointer(c.vertexPointLocation,3,b.FLOAT,!1,g,0),b.drawArrays(b.LINE_STRIP,0,e),this.mustDrawVerticals(a)&&(d.verticalIndicesVboCacheKey||(d.verticalIndicesVboCacheKey=a.gpuResourceCache.generateCacheKey()),g=a.gpuResourceCache.resourceForKey(d.verticalIndicesVboCacheKey),g||(g=b.createBuffer(),a.gpuResourceCache.putResource(d.verticalIndicesVboCacheKey,g,4*d.verticalIndices.length),d.fillVbo=!0),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,
        g),d.fillVbo&&(b.bufferData(b.ELEMENT_ARRAY_BUFFER,d.verticalIndices,b.STATIC_DRAW),a.frameStatistics.incrementVboLoadCount(1)),b.vertexAttribPointer(c.vertexPointLocation,3,b.FLOAT,!1,0,0),b.drawElements(b.LINES,d.verticalIndices.length,b.UNSIGNED_SHORT,0)));d.fillVbo=!1;a.pickingMode&&(b=new k(f,this.pickDelegate?this.pickDelegate:this,null,a.currentLayer,!1),a.resolvePick(b))};d.prototype.beginDrawing=function(a){var b=a.currentGlContext;this.mustDrawInterior(a)&&b.disable(b.CULL_FACE);a.findAndBindProgram(c);
    b.enableVertexAttribArray(a.currentProgram.vertexPointLocation)};d.prototype.endDrawing=function(a){var b=a.currentGlContext;b.disableVertexAttribArray(a.currentProgram.vertexPointLocation);b.depthMask(!0);b.lineWidth(1);b.enable(b.CULL_FACE)};return d});
define("src/formats/kml/geom/KmlLineString","../../../util/Color ../KmlElements ./KmlGeometry ../styles/KmlStyle ../../../geom/Location ../util/NodeTransformers ../../../shapes/Path ../../../geom/Position ../../../shapes/ShapeAttributes ../../../util/WWUtil".split(" "),function(f,b,c,a,d,e,g,h,k,l){f=function(a){c.call(this,a);this._style=null};f.prototype=Object.create(c.prototype);Object.defineProperties(f.prototype,{kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",
        transformer:e["boolean"]})||!1}},kmlTessellate:{get:function(){return this._factory.specific(this,{name:"tessellate",transformer:e["boolean"]})||!1}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:e.string})||WorldWind.ABSOLUTE}},kmlPositions:{get:function(){return this._factory.specific(this,{name:"coordinates",transformer:e.positions})}},kmlCenter:{get:function(){var a=0,b=0,c=0;this.kmlPositions.forEach(function(d){a+=d.latitude;b+=d.longitude;
    c+=d.altitude});return new h(a/this.kmlPositions.length,b/this.kmlPositions.length,c/this.kmlPositions.length)}}});f.prototype.createPath=function(a){this._renderable=new g(this.prepareLocations(),this.prepareAttributes(a.normal));this.moveValidProperties()};f.prototype.render=function(a,b){c.prototype.render.call(this,a,b);b.lastStyle&&!this._renderable&&(this.createPath(b.lastStyle),a.redrawRequested=!0);this._renderable&&(this._renderable.enabled=this.enabled,this._renderable.render(a))};f.prototype.prepareAttributes=
    function(b){b=b&&b.generate()||{};b._applyLighting=!0;b._drawOutline=!0;b._drawInterior=!0;b._drawVerticals=this.kmlExtrude||!1;b._outlineStippleFactor=0;b._outlineStipplePattern=61680;b._enableLighting=!0;return new k(a.shapeAttributes(b))};f.prototype.prepareLocations=function(){return this.kmlPositions};f.prototype.moveValidProperties=function(){this._renderable.extrude=this.kmlExtrude||!1;this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.ABSOLUTE;this._renderable.tesselate=this.kmlTesselate||
    !1};f.prototype.equals=function(a){return a?l.arrayEquals(a.kmlPositions,this.kmlPositions)&&a.kmlExtrude==this.kmlExtrude&&a.kmlTessellate==this.kmlTessellate&&a.kmlAltitudeMode==this.kmlAltitudeMode:!1};f.prototype.getTagNames=function(){return["LineString"]};b.addKey(f.prototype.getTagNames()[0],f);return f});
define("src/formats/kml/geom/KmlLinearRing",["./KmlLineString","../KmlElements"],function(f,b){var c=function(a){f.call(this,a)};c.prototype=Object.create(f.prototype);c.prototype.getTagNames=function(){return["LinearRing"]};b.addKey(c.prototype.getTagNames()[0],c);return c});
define("src/formats/kml/KmlLocation",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:c.string})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:c.string})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",
    transformer:c.string})}}});a.prototype.getTagNames=function(){return["Location"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/KmlLookAt",["./KmlAbstractView","./KmlElements","./util/NodeTransformers","../../geom/Position"],function(f,b,c,a){var d=function(a){f.call(this,a)};d.prototype=Object.create(f.prototype);Object.defineProperties(d.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:c.number})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:c.number})}},kmlAltitude:{get:function(){return this._factory.specific(this,
    {name:"altitude",transformer:c.number})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:c.number})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:c.number})}},kmlRange:{get:function(){return this._factory.specific(this,{name:"range",transformer:c.number})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:c.string})}}});d.prototype.update=function(b){b.wwd&&b.wwd.goTo(new a(this.kmlLatitude,
    this.kmlLongitude,this.kmlAltitude||4E3))};d.prototype.getTagNames=function(){return["LookAt"]};b.addKey(d.prototype.getTagNames()[0],d);return d});
define("src/formats/kml/geom/KmlMultiGeometry",["./../KmlElements","./KmlGeometry","../../../geom/Position"],function(f,b,c){var a=function(a){b.call(this,a);this._style=a.style};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlShapes:{get:function(){return this._factory.all(this)}},kmlCenter:{get:function(){var a=this.kmlShapes.map(function(a){return a.kmlCenter}),b=0,g=0,h=0;a.forEach(function(a){b+=a.latitude;g+=a.longitude;h+=a.altitude});return new c(b/a.length,
    g/a.length,h/a.length)}}});a.prototype.render=function(a){b.prototype.render.call(this,a);this.kmlShapes.forEach(function(b){b.render(a)})};a.prototype.getTagNames=function(){return["MultiGeometry"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/features/KmlNetworkLink",["./../KmlElements","./KmlFeature","../KmlLink","../util/NodeTransformers"],function(f,b,c,a){f=function(a){b.call(this,a)};f.prototype=Object.create(b.prototype);Object.defineProperties(f.prototype,{kmlRefreshVisibility:{get:function(){return this._factory.specific(this,{name:"refreshVisibility",transformer:a["boolean"]})}},kmlFlyToView:{get:function(){return this._factory.specific(this,{name:"flyToView",transformer:a["boolean"]})}},kmlLink:{get:function(){return this._factory.any(this,
    {name:c.prototype.getTagNames()})}}});f.prototype.getTagNames=function(){return["NetworkLink"]};return f});
define("src/formats/kml/KmlOrientation",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:c.number})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:c.number})}},kmlRoll:{get:function(){return this._factory.specific(this,{name:"roll",transformer:c.number})}}});
    a.prototype.getTagNames=function(){return["Orientation"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/geom/KmlPoint","../../../util/Color ../KmlElements ./KmlGeometry ../../../geom/Location ../util/NodeTransformers ../../../shapes/Polygon ../../../geom/Position".split(" "),function(f,b,c,a,d,e,g){f=function(a){c.call(this,a);this._shape=null};f.prototype=Object.create(c.prototype);Object.defineProperties(f.prototype,{kmlPosition:{get:function(){var a=this._factory.specific(this,{name:"coordinates",transformer:d.string}).split(",");return new g(a[1],a[0],a[2]||0)}},kmlExtrude:{get:function(){return this._factory.specific(this,
    {name:"extrude",transformer:d["boolean"]})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:d.string})}},kmlCenter:{get:function(){return this.kmlPosition}}});f.prototype.getTagNames=function(){return["Point"]};b.addKey(f.prototype.getTagNames()[0],f);return f});
define("src/formats/kml/util/ViewVolume",["../KmlElements","../KmlObject","./NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlLeftFov:{get:function(){return this._factory.specific(this,{name:"leftFov",transformer:c.number})}},kmlRightFov:{get:function(){return this._factory.specific(this,{name:"rightFov",transformer:c.number})}},kmlBottomFov:{get:function(){return this._factory.specific(this,{name:"bottomFov",
    transformer:c.number})}},kmlTopFov:{get:function(){return this._factory.specific(this,{name:"topFov",transformer:c.number})}},kmlNear:{get:function(){return this._factory.specific(this,{name:"near",transformer:c.string})}}});a.prototype.getTagNames=function(){return["ViewVolume"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/formats/kml/features/KmlPhotoOverlay","../util/ImagePyramid ./../KmlElements ./KmlOverlay ../geom/KmlPoint ../util/NodeTransformers ../util/ViewVolume".split(" "),function(f,b,c,a,d,e){var g=function(a){c.call(this,a)};g.prototype=Object.create(c.prototype);Object.defineProperties(g.prototype,{kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:d.string})}},kmlShape:{get:function(){return this._factory.specific(this,{name:"shape",transformer:d.string})}},
    kmlPoint:{get:function(){return this._factory.any(this,{name:a.prototype.getTagNames()})}},kmlViewVolume:{get:function(){return this._factory.any(this,{name:e.prototype.getTagNames()})}},kmlImagePyramid:{get:function(){return this._factory.any(this,{name:f.prototype.getTagNames()})}}});g.prototype.getTagNames=function(){return["PhotoOverlay"]};b.addKey(g.prototype.getTagNames[0],g);return g});
define("src/formats/kml/features/KmlPlacemark","./../KmlElements ./KmlFeature ../geom/KmlGeometry ../styles/KmlStyle ../KmlTimeSpan ../KmlTimeStamp ../../../shapes/PlacemarkAttributes ../../../shapes/Placemark ../../../util/Color ../../../shapes/ShapeAttributes ../../../shapes/TextAttributes ../../../util/Offset ../../../util/WWUtil".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q){d=function(a){b.call(this,a)};d.prototype=Object.create(b.prototype);Object.defineProperties(d.prototype,{kmlGeometry:{get:function(){return this._factory.any(this,
    {name:c.prototype.getTagNames()})}}});d.prototype.render=function(a,c){b.prototype.render.call(this,a,c);c=q.clone(c);c.lastStyle&&!this._renderable&&this.kmlGeometry&&(this._renderable=new h(this.kmlGeometry.kmlCenter,!1,this.prepareAttributes(c.lastStyle.normal)),this.moveValidProperties(),a.redrawRequested=!0);this._renderable&&this.kmlGeometry&&(this.kmlGeometry.render(a,c),this._renderable.render(a))};d.prototype.prepareAttributes=function(b){b=b&&b.generate()||{normal:{},highlight:{}};b=new g(a.placemarkAttributes(b));
    b.imageOffset=new p(WorldWind.OFFSET_FRACTION,.3,WorldWind.OFFSET_FRACTION,0);b.imageColor=k.WHITE;b.labelAttributes=new m(a.textAttributes({_offset:new p(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,1),_color:k.YELLOW}));b.drawLeaderLine=!0;b.leaderLineAttributes=new l(a.shapeAttributes({outlineColor:k.RED}));return b};d.prototype.moveValidProperties=function(){this._renderable.label=this.kmlName||"";this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.RELATIVE_TO_GROUND;this._renderable.enableLeaderLinePicking=
    !0};d.prototype.getTagNames=function(){return["Placemark"]};f.addKey(d.prototype.getTagNames()[0],d);return d});
define("src/formats/kml/geom/KmlPolygon","../../../util/Color ../KmlElements ./KmlGeometry ./KmlLinearRing ../styles/KmlStyle ../../../geom/Location ../util/NodeTransformers ../../../shapes/Polygon ../../../shapes/ShapeAttributes".split(" "),function(f,b,c,a,d,e,g,h,k){f=function(a){c.call(this,a);this.initialized=!1};f.prototype=Object.create(c.prototype);Object.defineProperties(f.prototype,{kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:g["boolean"]})}},
    kmlTessellate:{get:function(){return this._factory.specific(this,{name:"tessellate",transformer:g["boolean"]})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:g.string})}},kmlOuterBoundary:{get:function(){return this._factory.specific(this,{name:"outerBoundaryIs",transformer:g.linearRing})}},kmlInnerBoundary:{get:function(){return this._factory.specific(this,{name:"innerBoundaryIs",transformer:g.linearRing})}},kmlCenter:{get:function(){return this.kmlOuterBoundary.kmlCenter}}});
    f.prototype.createPolygon=function(a){this._renderable=new h(this.prepareLocations(),this.prepareAttributes(a.normal));this.moveValidProperties()};f.prototype.render=function(a,b){c.prototype.render.call(this,a,b);b.lastStyle&&!this._renderable&&(this.createPolygon(b.lastStyle),a.redrawRequested=!0);this._renderable&&(this._renderable.enabled=this.enabled,this._renderable.render(a))};f.prototype.moveValidProperties=function(){this._renderable.extrude=this.kmlExtrude||!0;this._renderable.altitudeMode=
        this.kmlAltitudeMode||WorldWind.CLAMP_TO_GROUND};f.prototype.prepareAttributes=function(a){a=a&&a.generate()||{};a._drawVerticals=this.kmlExtrude||!1;a._applyLighting=!0;a._depthTest=!0;a._outlineStippleFactor=0;a._outlineStipplePattern=61680;a._enableLighting=!0;return new k(d.shapeAttributes(a))};f.prototype.prepareLocations=function(){var a=[];null!=this.kmlInnerBoundary?(a[0]=this.kmlInnerBoundary.kmlPositions,a[1]=this.kmlOuterBoundary.kmlPositions):a=this.kmlOuterBoundary.kmlPositions;return a};
    f.prototype.getStyle=function(){return this._style};f.prototype.getTagNames=function(){return["Polygon"]};b.addKey(f.prototype.getTagNames()[0],f);return f});
define("src/formats/kml/features/KmlScreenOverlay","./../KmlElements ./KmlFeature ./KmlOverlay ../util/NodeTransformers ../../../util/Offset ../../../shapes/ScreenImage ../../../util/WWUtil".split(" "),function(f,b,c,a,d,e,g){g=function(a){c.call(this,a);console.log("Create Screen Overlay",this)};g.prototype=Object.create(c.prototype);Object.defineProperties(g.prototype,{kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:a.number})}},kmlOverlayXYx:{get:function(){return this._factory.specific(this,
    {name:"overlayXY",transformer:a.attribute("x"),attribute:"kmlOverlayXYx"})}},kmlOverlayXYy:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:a.attribute("y"),attribute:"kmlOverlayXYy"})}},kmlOverlayXYxunits:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:a.attribute("xunits"),attribute:"kmlOverlayXYxunits"})}},kmlOverlayXYyunits:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:a.attribute("yunits"),attribute:"kmlOverlayXYyunits"})}},
    kmlScreenXYx:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:a.attribute("x"),attribute:"kmlScreenXYx"})}},kmlScreenXYy:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:a.attribute("y"),attribute:"kmlScreenXYy"})}},kmlScreenXYxunits:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:a.attribute("xunits"),attribute:"kmlScreenXYxunits"})}},kmlScreenXYyunits:{get:function(){return this._factory.specific(this,
        {name:"screenXY",transformer:a.attribute("yunits"),attribute:"kmlScreenXYyunits"})}},kmlRotationXYx:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:a.attribute("x"),attribute:"kmlRotationXYx"})}},kmlRotationXYy:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:a.attribute("y"),attribute:"kmlRotationXYy"})}},kmlRotationXYxunits:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:a.attribute("xunits"),attribute:"kmlRotationXYxunits"})}},
    kmlRotationXYyunits:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:a.attribute("yunits"),attribute:"kmlRotationXYyunits"})}},kmlSizex:{get:function(){return this._factory.specific(this,{name:"size",transformer:a.attribute("x"),attribute:"kmlSizex"})}},kmlSizey:{get:function(){return this._factory.specific(this,{name:"size",transformer:a.attribute("y"),attribute:"kmlSizey"})}},kmlSizexunits:{get:function(){return this._factory.specific(this,{name:"size",transformer:a.attribute("xunits"),
        attribute:"kmlSizexunits"})}},kmlSizeyunits:{get:function(){return this._factory.specific(this,{name:"size",transformer:a.attribute("yunits"),attribute:"kmlSizeyunits"})}}});g.prototype.render=function(a,c){b.prototype.render.call(this,a,c);!this._renderable&&this.kmlIcon&&(this._renderable=new e(new d(this.kmlScreenXYxunits,this.kmlScreenXYx,this.kmlScreenXYyunits,this.kmlScreenXYy),this.kmlIcon.kmlHref),this._renderable.imageOffset=new d(this.kmlOverlayXYxunits,this.kmlOverlayXYx,this.kmlOverlayXYyunits,
    this.kmlOverlayXYy),a.redrawRequested=!0);this._renderable&&this._renderable.render(a)};g.prototype.getTagNames=function(){return["ScreenOverlay"]};f.addKey(g.prototype.getTagNames()[0],g);return g});define("src/formats/kml/features/KmlTour",["./../KmlElements","./KmlFeature"],function(f,b){var c=function(a){b.call(this,a)};c.prototype=Object.create(b.prototype);c.prototype.getTagNames=function(){return["gx:Tour"]};f.addKey(c.prototype.getTagNames()[0],c);return c});
define("src/formats/kml/geom/KmlTrack",["./../KmlElements","./KmlGeometry"],function(f,b){var c=function(a){b.call(this,a)};c.prototype=Object.create(b.prototype);c.prototype.getTagNames=function(){return["gx:Track"]};f.addKey(c.prototype.getTagNames()[0],c);return c});
define("src/layer/LandsatRestLayer","../error/ArgumentError ../geom/Location ../util/Logger ../geom/Sector ../layer/TiledImageLayer ../util/LevelRowColumnUrlBuilder ../util/WWUtil".split(" "),function(f,b,c,a,d,e,g){f=function(c,f,l){var m=g.urlPath(c+"/"+f);d.call(this,a.FULL_SPHERE,new b(36,36),10,"image/png",m,512,512);this.displayName=l;this.pickEnabled=!1;this.urlBuilder=new e(c,f)};f.prototype=Object.create(d.prototype);return f});
define("src/navigate/Navigator","../error/ArgumentError ../util/Logger ../geom/Matrix ../navigate/NavigatorState ../geom/Position ../error/UnsupportedOperationError ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h){var k=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"Navigator","constructor","missingWorldWindow"));this.worldWindow=a;this.roll=this.tilt=this.heading=0;this.nearDistance=1;this.farDistance=1E7};k.prototype.currentState=function(){throw new e(b.logMessage(b.LEVEL_SEVERE,
    "Navigator","currentState","abstractInvocation"));};k.prototype.currentStateForModelview=function(e){if(!e)throw new f(b.logMessage(b.LEVEL_SEVERE,"Navigator","currentStateForModelview","missingMatrix"));var k=this.worldWindow.globe,p=h.max(k.equatorialRadius,k.polarRadius),q=e.extractEyePoint(new g(0,0,0)),t=k.computePositionFromPoint(q[0],q[1],q[2],new d(0,0,0)),q=this.worldWindow.viewport,r=this.worldWindow.depthBits,u=c.fromIdentity();this.farDistance=h.horizonDistanceForGlobeRadius(p,t.altitude);
    this.farDistance+=145E4;1E3>this.farDistance&&(this.farDistance=1E3);this.nearDistance=h.perspectiveNearDistanceForFarDistance(this.farDistance,10,r);k=t.altitude-k.elevationAtLocation(t.latitude,t.longitude);0<k&&(k=h.perspectiveNearDistance(q.width,q.height,k),this.nearDistance>k&&(this.nearDistance=k));1>this.nearDistance&&(this.nearDistance=1);u.setToPerspectiveProjection(q.width,q.height,this.nearDistance,this.farDistance);return new a(e,u,q,this.heading,this.tilt)};return k});
define("src/gesture/PanRecognizer",["../gesture/GestureRecognizer"],function(f){var b=function(b,a){f.call(this,b,a);this.minNumberOfTouches=1;this.maxNumberOfTouches=Number.MAX_VALUE;this.interpretDistance=20};b.prototype=Object.create(f.prototype);b.prototype.mouseDown=function(b){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)};b.prototype.touchMove=function(b){if(this.state==WorldWind.POSSIBLE)this.shouldInterpret()&&(this.shouldRecognize()?this.state=WorldWind.BEGAN:this.state=
    WorldWind.FAILED);else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)this.state=WorldWind.CHANGED};b.prototype.touchEnd=function(b){if(0==this.touchCount)if(this.state==WorldWind.POSSIBLE)this.state=WorldWind.FAILED;else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)this.state=WorldWind.ENDED};b.prototype.touchCancel=function(b){if(0==this.touchCount)if(this.state==WorldWind.POSSIBLE)this.state=WorldWind.FAILED;else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)this.state=
    WorldWind.CANCELLED};b.prototype.prepareToRecognize=function(){this.translationY=this.translationX=0};b.prototype.shouldInterpret=function(){var b=this.translationX,a=this.translationY;return Math.sqrt(b*b+a*a)>this.interpretDistance};b.prototype.shouldRecognize=function(){var b=this.touchCount;return 0!=b&&b>=this.minNumberOfTouches&&b<=this.maxNumberOfTouches};return b});
define("src/gesture/PinchRecognizer",["../gesture/GestureRecognizer"],function(f){var b=function(b,a){f.call(this,b,a);this._offsetScale=this._scale=1;this.referenceDistance=0;this.interpretThreshold=20;this.weight=.4;this.pinchTouches=[]};b.prototype=Object.create(f.prototype);Object.defineProperties(b.prototype,{scale:{get:function(){return this._scale*this._offsetScale}}});b.prototype.reset=function(){f.prototype.reset.call(this);this._offsetScale=this._scale=1;this.referenceDistance=0;this.pinchTouches=
    []};b.prototype.mouseDown=function(b){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)};b.prototype.touchStart=function(b){2>this.pinchTouches.length&&2==this.pinchTouches.push(b)&&(this.referenceDistance=this.currentPinchDistance(),this._offsetScale*=this._scale,this._scale=1)};b.prototype.touchMove=function(b){if(2==this.pinchTouches.length)if(this.state==WorldWind.POSSIBLE)this.shouldRecognize()&&(this.state=WorldWind.BEGAN);else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED){b=
    this.currentPinchDistance();var a=this.weight;this._scale=this._scale*(1-a)+Math.abs(b/this.referenceDistance)*a;this.state=WorldWind.CHANGED}};b.prototype.touchEnd=function(b){b=this.pinchTouches.indexOf(b);-1!=b&&this.pinchTouches.splice(b,1);if(0==this.touchCount)if(this.state==WorldWind.POSSIBLE)this.state=WorldWind.FAILED;else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)this.state=WorldWind.ENDED};b.prototype.touchCancel=function(b){b=this.pinchTouches.indexOf(b);-1!=b&&this.pinchTouches.splice(b,
    1);if(0==this.touchCount)if(this.state==WorldWind.POSSIBLE)this.state=WorldWind.FAILED;else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)this.state=WorldWind.CANCELLED};b.prototype.prepareToRecognize=function(){this.referenceDistance=this.currentPinchDistance();this._scale=1};b.prototype.shouldRecognize=function(){var b=this.currentPinchDistance();return Math.abs(b-this.referenceDistance)>this.interpretThreshold};b.prototype.currentPinchDistance=function(){var b=this.pinchTouches[0],
    a=this.pinchTouches[1],d=b.clientX-a.clientX,b=b.clientY-a.clientY;return Math.sqrt(d*d+b*b)};return b});
define("src/gesture/RotationRecognizer",["../geom/Angle","../gesture/GestureRecognizer"],function(f,b){var c=function(a,c){b.call(this,a,c);this.referenceAngle=this._offsetRotation=this._rotation=0;this.interpretThreshold=20;this.weight=.4;this.rotationTouches=[]};c.prototype=Object.create(b.prototype);Object.defineProperties(c.prototype,{rotation:{get:function(){return this._rotation+this._offsetRotation}}});c.prototype.reset=function(){b.prototype.reset.call(this);this.referenceAngle=this._offsetRotation=
    this._rotation=0;this.rotationTouches=[]};c.prototype.mouseDown=function(a){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)};c.prototype.touchStart=function(a){2>this.rotationTouches.length&&2==this.rotationTouches.push(a)&&(this.referenceAngle=this.currentTouchAngle(),this._offsetRotation+=this._rotation,this._rotation=0)};c.prototype.touchMove=function(a){if(2==this.rotationTouches.length)if(this.state==WorldWind.POSSIBLE)this.shouldRecognize()&&(this.state=WorldWind.BEGAN);else if(this.state==
    WorldWind.BEGAN||this.state==WorldWind.CHANGED){a=this.currentTouchAngle();a=f.normalizedDegrees(a-this.referenceAngle);var b=this.weight;this._rotation=this._rotation*(1-b)+a*b;this.state=WorldWind.CHANGED}};c.prototype.touchEnd=function(a){a=this.rotationTouches.indexOf(a);-1!=a&&this.rotationTouches.splice(a,1);if(0==this.touchCount)if(this.state==WorldWind.POSSIBLE)this.state=WorldWind.FAILED;else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)this.state=WorldWind.ENDED};c.prototype.touchCancel=
    function(a){a=this.rotationTouches.indexOf(a);if(-1!=a&&(this.rotationTouches.splice(a,1),0==this.touchCount))if(this.state==WorldWind.POSSIBLE)this.state=WorldWind.FAILED;else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)this.state=WorldWind.CANCELLED};c.prototype.prepareToRecognize=function(){this.referenceAngle=this.currentTouchAngle();this._rotation=0};c.prototype.shouldRecognize=function(){var a=this.currentTouchAngle(),a=f.normalizedDegrees(a-this.referenceAngle);return Math.abs(a)>
    this.interpretThreshold};c.prototype.currentTouchAngle=function(){var a=this.rotationTouches[0],b=this.rotationTouches[1];return Math.atan2(a.clientY-b.clientY,a.clientX-b.clientX)*f.RADIANS_TO_DEGREES};return c});
define("src/gesture/TiltRecognizer",["../gesture/PanRecognizer"],function(f){var b=function(b,a){f.call(this,b,a);this.maxTouchDistance=250;this.maxTouchDivergence=50};b.LEFT=1;b.RIGHT=2;b.UP=4;b.DOWN=8;b.prototype=Object.create(f.prototype);b.prototype.shouldInterpret=function(){for(var b=0,a=this.touchCount;b<a;b++){var d=this.touch(b),e=d.translationX,d=d.translationY;if(Math.sqrt(e*e+d*d)>this.interpretDistance)return!0}return!1};b.prototype.shouldRecognize=function(){if(2>this.touchCount)return!1;
    var c=this.touch(0),a=this.touch(1),d=c.clientX-a.clientX,e=c.clientY-a.clientY;if(Math.sqrt(d*d+e*e)>this.maxTouchDistance)return!1;d=c.translationX-a.translationX;e=c.translationY-a.translationY;if(Math.sqrt(d*d+e*e)>this.maxTouchDivergence)return!1;d=b.UP|b.DOWN;c=this.touchDirection(c)&d;a=this.touchDirection(a)&d;return 0!=(c&a)};b.prototype.touchDirection=function(c){var a=c.translationX;c=c.translationY;var d=0;Math.abs(a)>Math.abs(c)?(d|=0>a?b.LEFT:0,d|=0<a?b.RIGHT:0):(d|=0>c?b.UP:0,d|=0<
c?b.DOWN:0);return d};return b});
define("src/navigate/LookAtNavigator","../geom/Angle ../gesture/DragRecognizer ../geom/Frustum ../gesture/GestureRecognizer ../geom/Line ../geom/Location ../util/Logger ../geom/Matrix ../navigate/Navigator ../gesture/PanRecognizer ../gesture/PinchRecognizer ../geom/Position ../gesture/RotationRecognizer ../gesture/TiltRecognizer ../geom/Vec2 ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t,r,u,w){c=function(a){function c(a){a.preventDefault()}k.call(this,a);a.addEventListener("mousedown",
    c);a.addEventListener("touchstart",c);a.addEventListener("contextmenu",c);a.addEventListener("wheel",c);window.PointerEvent&&a.canvas.style.setProperty("touch-action","none");this.lookAtLocation=new e(30,-110);this.range=1E7;this.enable2DLimits=!0;var d=this;this.primaryDragRecognizer=new b(a,function(a){d.handlePanOrDrag(a)});this.secondaryDragRecognizer=new b(a,function(a){d.handleSecondaryDrag(a)});this.secondaryDragRecognizer.button=2;this.panRecognizer=new l(a,function(a){d.handlePanOrDrag(a)});
    this.pinchRecognizer=new m(a,function(a){d.handlePinch(a)});this.rotationRecognizer=new q(a,function(a){d.handleRotation(a)});this.tiltRecognizer=new t(a,function(a){d.handleTilt(a)});a.addEventListener("wheel",function(a){d.handleWheelEvent(a)});this.panRecognizer.recognizeSimultaneouslyWith(this.pinchRecognizer);this.panRecognizer.recognizeSimultaneouslyWith(this.rotationRecognizer);this.pinchRecognizer.recognizeSimultaneouslyWith(this.rotationRecognizer);this.panRecognizer.requireRecognizerToFail(this.tiltRecognizer);
    this.pinchRecognizer.requireRecognizerToFail(this.tiltRecognizer);this.rotationRecognizer.requireRecognizerToFail(this.tiltRecognizer);this.beginPoint=new r(0,0);this.lastPoint=new r(0,0);this.lastRotation=this.beginRange=this.beginTilt=this.beginHeading=0};c.prototype=Object.create(k.prototype);c.prototype.currentState=function(){this.applyLimits();var a=this.worldWindow.globe,b=new p(this.lookAtLocation.latitude,this.lookAtLocation.longitude,0),c=h.fromIdentity();c.multiplyByLookAtModelview(b,this.range,
    this.heading,this.tilt,this.roll,a);return this.currentStateForModelview(c)};c.prototype.handlePanOrDrag=function(a){this.worldWindow.globe.is2D()?this.handlePanOrDrag2D(a):this.handlePanOrDrag3D(a)};c.prototype.handlePanOrDrag3D=function(a){var b=a.state,c=a.translationX;a=a.translationY;if(b==WorldWind.BEGAN)this.lastPoint.set(0,0);else if(b==WorldWind.CHANGED){var b=this.worldWindow.canvas,d=this.worldWindow.globe,d=w.max(d.equatorialRadius,d.polarRadius),e=w.max(1,this.range),e=w.perspectivePixelSize(b.clientWidth,
    b.clientHeight,e),b=(a-this.lastPoint[1])*e/d*f.RADIANS_TO_DEGREES,d=-(c-this.lastPoint[0])*e/d*f.RADIANS_TO_DEGREES,e=Math.sin(this.heading*f.DEGREES_TO_RADIANS),g=Math.cos(this.heading*f.DEGREES_TO_RADIANS);this.lookAtLocation.latitude+=b*g-d*e;this.lookAtLocation.longitude+=b*e+d*g;this.lastPoint.set(c,a);this.applyLimits();this.worldWindow.redraw()}};c.prototype.handlePanOrDrag2D=function(a){var b=a.state,c=a.clientX,d=a.clientY,e=a.translationX;a=a.translationY;if(b==WorldWind.BEGAN)this.beginPoint.set(c,
    d),this.lastPoint.set(c,d);else if(b==WorldWind.CHANGED){var d=this.lastPoint[0],g=this.lastPoint[1],e=this.beginPoint[0]+e,c=this.beginPoint[1]+a;this.lastPoint.set(e,c);a=this.currentState();var b=this.worldWindow.globe,d=a.rayFromScreenPoint(this.worldWindow.canvasCoordinates(d,g)),g=new u(0,0,0),f=new u(0,0,0),k=new u(0,0,0);b.intersectsLine(d,g)&&(d=a.rayFromScreenPoint(this.worldWindow.canvasCoordinates(e,c)),b.intersectsLine(d,f)&&(e=h.fromIdentity(),e.copy(a.modelview),e.multiplyByTranslation(f[0]-
    g[0],f[1]-g[1],f[2]-g[2]),e.extractEyePoint(d.origin),e.extractForwardVector(d.direction),b.intersectsLine(d,k)&&(e=e.extractViewingParameters(k,this.roll,b,{}),this.lookAtLocation.copy(e.origin),this.range=e.range,this.heading=e.heading,this.tilt=e.tilt,this.roll=e.roll,this.applyLimits(),this.worldWindow.redraw())))}};c.prototype.handleSecondaryDrag=function(a){var b=a.state,c=a.translationX;a=a.translationY;b==WorldWind.BEGAN?(this.beginHeading=this.heading,this.beginTilt=this.tilt):b==WorldWind.CHANGED&&
(b=90*a/this.worldWindow.canvas.clientHeight,this.heading=this.beginHeading+180*c/this.worldWindow.canvas.clientWidth,this.tilt=this.beginTilt+b,this.applyLimits(),this.worldWindow.redraw())};c.prototype.handlePinch=function(a){var b=a.state;a=a.scale;b==WorldWind.BEGAN?this.beginRange=this.range:b==WorldWind.CHANGED&&0!=a&&(this.range=this.beginRange/a,this.applyLimits(),this.worldWindow.redraw())};c.prototype.handleRotation=function(a){var b=a.state;a=a.rotation;b==WorldWind.BEGAN?this.lastRotation=
    0:b==WorldWind.CHANGED&&(this.heading-=a-this.lastRotation,this.lastRotation=a,this.applyLimits(),this.worldWindow.redraw())};c.prototype.handleTilt=function(a){var b=a.state;a=a.translationY;b==WorldWind.BEGAN?this.beginTilt=this.tilt:b==WorldWind.CHANGED&&(this.tilt=this.beginTilt+-90*a/this.worldWindow.canvas.clientHeight,this.applyLimits(),this.worldWindow.redraw())};c.prototype.handleWheelEvent=function(a){var b;a.deltaMode==WheelEvent.DOM_DELTA_PIXEL?b=a.deltaY:a.deltaMode==WheelEvent.DOM_DELTA_LINE?
    b=40*a.deltaY:a.deltaMode==WheelEvent.DOM_DELTA_PAGE&&(b=400*a.deltaY);this.range*=1+b/1E3;this.applyLimits();this.worldWindow.redraw()};c.prototype.applyLimits=function(){this.lookAtLocation.latitude=w.clamp(this.lookAtLocation.latitude,-90,90);this.lookAtLocation.longitude=f.normalizedDegreesLongitude(this.lookAtLocation.longitude);this.range=w.clamp(this.range,1,Number.MAX_VALUE);this.heading=f.normalizedDegrees(this.heading);this.tilt=w.clamp(this.tilt,0,90);this.roll=f.normalizedDegrees(this.roll);
    this.worldWindow.globe.is2D()&&this.enable2DLimits&&(this.range=w.clamp(this.range,1,2*Math.PI*this.worldWindow.globe.equatorialRadius),this.tilt=0)};return c});
define("src/cache/MemoryCacheListener",["../util/Logger","../error/UnsupportedOperationError"],function(f,b){var c=function(){};c.prototype.entryRemoved=function(a,c){throw new b(f.logMessage(f.LEVEL_SEVERE,"MemoryCacheListener","entryRemoved","abstractInvocation"));};c.prototype.removalError=function(a,c,e){throw new b(f.logMessage(f.LEVEL_SEVERE,"MemoryCacheListener","removalError","abstractInvocation"));};return c});
define("src/util/NominatimGeocoder",["../util/Logger"],function(f){f=function(){this.service="http://open.mapquestapi.com/nominatim/v1/search/"};f.prototype.lookup=function(b,c,a){b=this.service+b.replace(" ","%20")+"?format=json";var d=new XMLHttpRequest,e=this;d.open("GET",b+("&key="+(a||"lUvVRchXGGDh5Xwk3oidrXeIDAAevOUS")),!0);d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){var a=JSON.parse(d.responseText);c(e,a)}};d.send(null)};return f});
define("src/layer/OpenStreetMapImageLayer",["../geom/Angle","../util/Color","../geom/Location","../geom/Sector","../layer/MercatorTiledImageLayer"],function(f,b,c,a,d){f=function(b){this.imageSize=256;b=b||"Open Street Map";d.call(this,new a(-85.05,85.05,-180,180),new c(85.05,180),19,"image/png",b,this.imageSize,this.imageSize);this.displayName=b;this.pickEnabled=!1;this.destCanvas=document.createElement("canvas");this.destContext=this.destCanvas.getContext("2d");this.urlBuilder={urlForTile:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         b){return"http://otile1.mqcdn.com/tiles/1.0.0/osm/"+(a.level.levelNumber+1)+"/"+a.column+"/"+a.row+".png"}}};f.prototype=Object.create(d.prototype);f.prototype.doRender=function(a){d.prototype.doRender.call(this,a);this.inCurrentFrame&&(a.screenCreditController.addStringCredit("\u00a9OpenStreetMap",b.DARK_GRAY),a.screenCreditController.addStringCredit("Tiles Courtesy of MapQuest",b.DARK_GRAY))};f.prototype.createTopLevelTiles=function(a){this.topLevelTiles=[];this.topLevelTiles.push(this.createTile(null,
    this.levels.firstLevel(),0,0));this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1));this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0));this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))};f.prototype.mapSizeForLevel=function(a){return 256<<a+1};return f});
define("src/projections/ProjectionGnomonic","../geom/Angle ../error/ArgumentError ../projections/GeographicProjection ../util/Logger ../geom/Sector ../util/WWMath".split(" "),function(f,b,c,a,d,e){var g=function(a){var b=(this.north="South"!==a)?new d(30,90,-180,180):new d(-90,-30,-180,180);c.call(this,"Polar Gnomonic",!1,b);this._pole=a;this.displayName=this.north?"North Gnomonic":"South Gnomonic";this._stateKey="projection polar gnomonic "+this._pole+" "};g.prototype=Object.create(c.prototype);
    Object.defineProperties(g.prototype,{pole:{get:function(){return this._pole},set:function(a){this._pole=a;this.projectionLimits=(this.north="South"!==this._pole)?new d(30,90,-180,180):new d(-90,-30,-180,180);this._stateKey="projection polar gnomonic "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}});g.prototype.geographicToCartesian=function(c,d,e,g,p,q){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesian","missingGlobe"));if(!q)throw new b(a.logMessage(a.LEVEL_SEVERE,
        "ProjectionGnomonic","geographicToCartesian","missingResult"));this.north&&90===d||!this.north&&-90===d?(q[0]=0,q[1]=0):(c=c.equatorialRadius/Math.tan(d*f.DEGREES_TO_RADIANS),q[0]=c*Math.sin(e*f.DEGREES_TO_RADIANS)*(this.north?1:-1),q[1]=c*-Math.cos(e*f.DEGREES_TO_RADIANS));q[2]=g;return q};g.prototype.geographicToCartesianGrid=function(c,d,g,m,p,q,t,r){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingGlobe"));if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,
        "ProjectionGnomonic","geographicToCartesianGrid","missingSector"));if(!p||p.length<g*m)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!r)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingResult"));var u=d.minLatitude*f.DEGREES_TO_RADIANS;t=d.maxLatitude*f.DEGREES_TO_RADIANS;var w=d.minLongitude*f.DEGREES_TO_RADIANS;d=d.maxLongitude*
        f.DEGREES_TO_RADIANS;var x=(t-u)/(1<g?g-1:1),A=(d-w)/(1<m?m-1:1),B=this.projectionLimits.minLatitude*f.DEGREES_TO_RADIANS,v=this.projectionLimits.maxLatitude*f.DEGREES_TO_RADIANS,F=this.north?1:-1;q=q?q:new Vec3(0,0,0);var G,D,y=0,H=0,C,z;for(G=0;G<g;G++,u+=x){G===g-1&&(u=t);D=e.clamp(u,B,v);z=c.equatorialRadius/Math.tan(D);if(this.north&&D===Math.PI/2||!this.north&&D===-Math.PI/2)z=0;D=0;for(C=w;D<m;D++,C+=A)D===m-1&&(C=d),r[H++]=z*Math.sin(C)*F-q[0],r[H++]=z*-Math.cos(C)-q[1],r[H++]=p[y++]-q[2]}return r};
    g.prototype.cartesianToGeographic=function(c,d,e,g,p,q){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionGnomonic","cartesianToGeographic","missingGlobe"));if(!q)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionGnomonic","cartesianToGeographic","missingResult"));p=Math.sqrt(d*d+e*e);1E-4>p?(q.latitude=this.north?90:-90,q.longitude=0):(c=Math.atan2(p,c.equatorialRadius),c>Math.PI&&(c=Math.PI),q.latitude=Math.asin(Math.cos(c)*(this.north?1:-1))*f.RADIANS_TO_DEGREES,q.longitude=Math.atan2(d,
            e*(this.north?-1:1))*f.RADIANS_TO_DEGREES);q.altitude=g;return q};g.prototype.northTangentAtLocation=function(c,d,e,g){if(!g)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionGnomonic","northTangentAtLocation","missingResult"));g[0]=Math.sin(e*f.DEGREES_TO_RADIANS)*(this.north?-1:1);g[1]=Math.cos(e*f.DEGREES_TO_RADIANS);g[2]=0;return g};g.prototype.northTangentAtPoint=function(c,d,e,g,f,q){if(!q)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionGnomonic","northTangentAtLocation","missingResult"));
        c=Math.sqrt(d*d+e*e);1E-4>c?(q[0]=0,q[1]=1):(q[0]=d/c*(this.north?-1:1),q[1]=e/c*(this.north?-1:1));q[2]=0;return q};return g});
define("src/projections/ProjectionMercator","../geom/Angle ../error/ArgumentError ../projections/GeographicProjection ../util/Logger ../geom/Sector ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g){var h=function(){c.call(this,"Mercator",!0,new d(-78,78,-180,180))};h.prototype=Object.create(c.prototype);h.prototype.geographicToCartesian=function(c,d,e,g,h,t){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesian","missingGlobe"));if(!t)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "ProjectionMercator","geographicToCartesian","missingResult"));d>this.projectionLimits.maxLatitude&&(d=this.projectionLimits.maxLatitude);d<this.projectionLimits.minLatitude&&(d=this.projectionLimits.minLatitude);var r=Math.sqrt(c.eccentricitySquared);d=Math.sin(d*f.DEGREES_TO_RADIANS);r=(1+d)/(1-d)*Math.pow((1-r*d)/(1+r*d),r);t[0]=c.equatorialRadius*e*f.DEGREES_TO_RADIANS+(h?h[0]:0);t[1]=.5*c.equatorialRadius*Math.log(r);t[2]=g;return t};Object.defineProperties(h.prototype,{stateKey:{get:function(){return"projection mercator "}}});
    h.prototype.geographicToCartesianGrid=function(c,d,h,p,q,t,r,u){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingGlobe"));if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingSector"));if(!q||q.length<h*p)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!u)throw new b(a.logMessage(a.LEVEL_SEVERE,
        "ProjectionMercator","geographicToCartesianGrid","missingResult"));var w=c.equatorialRadius;c=Math.sqrt(c.eccentricitySquared);var x=d.minLatitude*f.DEGREES_TO_RADIANS,A=d.maxLatitude*f.DEGREES_TO_RADIANS,B=d.minLongitude*f.DEGREES_TO_RADIANS;d=d.maxLongitude*f.DEGREES_TO_RADIANS;var v=(A-x)/(1<h?h-1:1),F=(d-B)/(1<p?p-1:1),G=this.projectionLimits.minLatitude*f.DEGREES_TO_RADIANS,D=this.projectionLimits.maxLatitude*f.DEGREES_TO_RADIANS;t=t?t:new e(0,0,0);r=r?r[0]:0;var y,H,C=0,z=0,E,L;for(y=0;y<h;y++,
        x+=v)for(y===h-1&&(x=A),H=g.clamp(x,G,D),H=Math.sin(H),H=(1+H)/(1-H)*Math.pow((1-c*H)/(1+c*H),c),L=w*Math.log(H)*.5-t[1],H=0,E=B;H<p;H++,E+=F)H===p-1&&(E=d),u[z++]=w*E-t[0]+r,u[z++]=L,u[z++]=q[C++]-t[2];return u};h.prototype.cartesianToGeographic=function(c,d,e,g,h,t){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionMercator","cartesianToGeographic","missingGlobe"));if(!t)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionMercator","cartesianToGeographic","missingResult"));var r=c.eccentricitySquared,
        u=r*r,w=u*r,x=w*r;e=Math.PI/2-2*Math.atan(Math.pow(Math.E,-e/c.equatorialRadius));var A=7*u/48+29*w/240+811*x/11520,B=7*w/120+81*x/1120,v=4279*x/161280,F=Math.sin(2*e);t.latitude=(e-A+v+F*(r/2+5*u/24+w/12+13*x/360-3*B+F*(2*A-8*v+F*(4*B+8*v*F))))*f.RADIANS_TO_DEGREES;t.longitude=(d-(h?h[0]:0))/c.equatorialRadius*f.RADIANS_TO_DEGREES;t.altitude=g;return t};return h});
define("src/projections/ProjectionPolarEquidistant",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger"],function(f,b,c,a){var d=function(a){c.call(this,"Polar Equidistant",!1,null);this._pole=a;this.displayName=(this.north="South"!==a)?"North Polar":"South Polar";this._stateKey="projection polar equidistant "+this._pole+" "};d.prototype=Object.create(c.prototype);Object.defineProperties(d.prototype,{pole:{get:function(){return this._pole},set:function(a){this._pole=
    a;this.north="South"!==this._pole;this._stateKey="projection polar equidistant "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}});d.prototype.geographicToCartesian=function(c,d,h,k,l,m){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesian","missingGlobe"));if(!m)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesian","missingResult"));this.north&&90===d||!this.north&&-90===d?(m[0]=0,m[1]=0):(l=this.north?
    -1:1,c=c.equatorialRadius*(Math.PI/2+d*f.DEGREES_TO_RADIANS*l),m[0]=c*Math.sin(h*f.DEGREES_TO_RADIANS),m[1]=c*Math.cos(h*f.DEGREES_TO_RADIANS)*l);m[2]=k;return m};d.prototype.geographicToCartesianGrid=function(c,d,h,k,l,m,p,q){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingGlobe"));if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingSector"));if(!l||l.length<h*k)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "ProjectionPolarEquidistant","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!q)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingResult"));c=c.equatorialRadius;var t=d.minLatitude*f.DEGREES_TO_RADIANS;p=d.maxLatitude*f.DEGREES_TO_RADIANS;var r=d.minLongitude*f.DEGREES_TO_RADIANS,u=d.maxLongitude*f.DEGREES_TO_RADIANS;d=(p-t)/(1<h?h-1:1);var w=(u-r)/(1<k?k-1:1),x=this.north?-1:1;m=m?m:
    new Vec3(0,0,0);var A=Math.PI/2,B,v=0,F=0,G=new Float64Array(k),D=new Float64Array(k);for(B=0;B<k;B++,r+=w)B===k-1&&(r=u),G[B]=Math.cos(r),D[B]=Math.sin(r);for(r=0;r<h;r++,t+=d){r===h-1&&(t=p);u=c*(A+t*x);if(this.north&&t===A||!this.north&&t===-A)u=0;for(B=0;B<k;B++)q[F++]=u*D[B]-m[0],q[F++]=u*G[B]*x-m[1],q[F++]=l[v++]-m[2]}return q};d.prototype.cartesianToGeographic=function(c,d,h,k,l,m){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant","cartesianToGeographic","missingGlobe"));
    if(!m)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant","cartesianToGeographic","missingResult"));l=Math.sqrt(d*d+h*h);1E-4>l?(m.latitude=this.north?90:-90,m.longitude=0):(c=l/c.equatorialRadius,c>Math.PI&&(c=Math.PI),m.latitude=Math.asin(Math.cos(c)*(this.north?1:-1))*f.RADIANS_TO_DEGREES,m.longitude=Math.atan2(d,h*(this.north?-1:1))*f.RADIANS_TO_DEGREES);m.altitude=k;return m};d.prototype.northTangentAtLocation=function(c,d,h,k){if(!k)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant",
    "northTangentAtLocation","missingResult"));k[0]=Math.sin(h*f.DEGREES_TO_RADIANS)*(this.north?-1:1);k[1]=Math.cos(h*f.DEGREES_TO_RADIANS);k[2]=0;return k};d.prototype.northTangentAtPoint=function(c,d,h,f,l,m){if(!m)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));c=Math.sqrt(d*d+h*h);1E-4>c?(m[0]=0,m[1]=1):(m[0]=d/c*(this.north?-1:1),m[1]=h/c*(this.north?-1:1));m[2]=0;return m};return d});
define("src/projections/ProjectionUPS","../geom/Angle ../error/ArgumentError ../projections/GeographicProjection ../util/Logger ../geom/Sector ../geom/Vec3 ../util/WWMath".split(" "),function(f,b,c,a,d,e,g){var h=function(a){var b=(this.north="South"!==a)?new d(0,90,-180,180):new d(-90,0,-180,180);c.call(this,"Uniform Polar Stereographic",!1,b);this._pole=a;this.displayName=this.north?"North UPS":"South UPS";this._stateKey="projection ups "+this._pole+" "};h.prototype=Object.create(c.prototype);Object.defineProperties(h.prototype,
    {pole:{get:function(){return this._pole},set:function(a){this._pole=a;this.projectionLimits=(this.north="South"!==this._pole)?new d(0,90,-180,180):new d(-90,0,-180,180);this._stateKey="projection ups "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}});h.prototype.geographicToCartesian=function(c,d,e,g,h,t){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesian","missingGlobe"));if(!t)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesian",
    "missingResult"));if(this.north&&90===d||!this.north&&-90===d)t[0]=0,t[1]=0;else{h=this.north?1:-1;d*=f.DEGREES_TO_RADIANS;e*=f.DEGREES_TO_RADIANS;var r=Math.sqrt(c.eccentricitySquared),u=Math.sqrt(Math.pow(1+r,1+r)*Math.pow(1-r,1-r));if(this.north&&0>d||!this.north&&0<d)d=0;d=Math.sin(d*h);c=1.988*c.equatorialRadius*Math.sqrt((1-d)/(1+d)*Math.pow((1+r*d)/(1-r*d),r))/u;t[0]=c*Math.sin(e);t[1]=-c*Math.cos(e)*h}t[2]=g;return t};h.prototype.geographicToCartesianGrid=function(c,d,h,p,q,t,r,u){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "ProjectionUPS","geographicToCartesianGrid","missingGlobe"));if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingSector"));if(!q||q.length<h*p)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!u)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingResult"));r=c.equatorialRadius;var w=d.minLatitude*f.DEGREES_TO_RADIANS,
    x=d.maxLatitude*f.DEGREES_TO_RADIANS,A=d.minLongitude*f.DEGREES_TO_RADIANS;d=d.maxLongitude*f.DEGREES_TO_RADIANS;var B=(x-w)/(1<h?h-1:1),v=(d-A)/(1<p?p-1:1),F=this.projectionLimits.minLatitude*f.DEGREES_TO_RADIANS,G=this.projectionLimits.maxLatitude*f.DEGREES_TO_RADIANS;c=Math.sqrt(c.eccentricitySquared);var D=Math.sqrt(Math.pow(1+c,1+c)*Math.pow(1-c,1-c)),y=this.north?1:-1;t=t?t:new e(0,0,0);var H,C,z=0,E=0,L,M;for(H=0;H<h;H++,w+=B)for(H===h-1&&(w=x),C=g.clamp(w,F,G),C=Math.sin(C*y),C=Math.sqrt((1-
    C)/(1+C)*Math.pow((1+c*C)/(1-c*C),c)),M=1.988*r*C/D,C=0,L=A;C<p;C++,L+=v)C===p-1&&(L=d),u[E++]=M*Math.sin(L)-t[0],u[E++]=-M*Math.cos(L)*y-t[1],u[E++]=q[z++]-t[2];return u};h.prototype.cartesianToGeographic=function(c,d,e,g,h,t){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionUPS","cartesianToGeographic","missingGlobe"));if(!t)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionUPS","cartesianToGeographic","missingResult"));h=Math.atan2(d,e*(this.north?-1:1));var r=Math.sqrt(c.eccentricitySquared),
    u=c.eccentricitySquared,w=u*u,x=w*u,A=x*u;c=Math.PI/2-2*Math.atan(Math.sqrt(d*d+e*e)*Math.sqrt(Math.pow(1+r,1+r)*Math.pow(1-r,1-r))/(1.988*c.equatorialRadius));d=7*w/48+29*x/240+811*A/11520;e=7*x/120+81*A/1120;var r=4279*A/161280,B=Math.sin(2*c),u=(c-d+r+B*(u/2+5*w/24+x/12+13*A/360-3*e+B*(2*d-8*r+B*(4*e+8*r*B))))*(this.north?1:-1);t.latitude=u*f.RADIANS_TO_DEGREES;t.longitude=h*f.RADIANS_TO_DEGREES;t.altitude=g;return t};h.prototype.northTangentAtLocation=function(c,d,e,g){if(!g)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "ProjectionUPS","northTangentAtLocation","missingResult"));g[0]=Math.sin(e*f.DEGREES_TO_RADIANS)*(this.north?-1:1);g[1]=Math.cos(e*f.DEGREES_TO_RADIANS);g[2]=0;return g};h.prototype.northTangentAtPoint=function(c,d,e,g,h,f){if(!f)throw new b(a.logMessage(a.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));c=Math.sqrt(d*d+e*e);1E-4>c?(f[0]=0,f[1]=1):(f[0]=d/c*(this.north?-1:1),f[1]=e/c*(this.north?-1:1));f[2]=0;return f};return h});
define("src/formats/kml/util/Scale",["./../KmlElements","../KmlObject","./NodeTransformers"],function(f,b,c){var a=function(a){b.call(this,a)};a.prototype=Object.create(b.prototype);Object.defineProperties(a.prototype,{kmlX:{get:function(){return this._factory.specific(this,{name:"x",transformer:c.number})}},kmlY:{get:function(){return this._factory.specific(this,{name:"y",transformer:c.number})}},kmlZ:{get:function(){return this._factory.specific(this,{name:"z",transformer:c.number})}}});a.prototype.getTagNames=
    function(){return["Scale"]};f.addKey(a.prototype.getTagNames()[0],a);return a});
define("src/util/ByteBuffer",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"ByteBuffer","constructor","missingArray"));this.array=a;this.data=new DataView(a);this.position=0;this._order=c.LITTLE_ENDIAN};c.prototype.getByte=function(){var a=this.data.getUint8(this.position);this.position+=c.BYTE_SIZE;return a};c.prototype.getByteArray=function(a){var b=new Uint8Array(this.array,this.position,a);this.position+=c.BYTE_SIZE*a;
    return b};c.prototype.getInt16=function(){var a=this.data.getInt16(this.position,this._order);this.position+=c.INT16_SIZE;return a};c.prototype.getInt16Array=function(a){var b=new Int16Array(this.array,this.position,a);this.position+=c.INT16_SIZE*a;return b};c.prototype.getInt32=function(){var a=this.data.getInt32(this.position,this._order);this.position+=c.INT32_SIZE;return a};c.prototype.getInt32Array=function(a){var b=new Int32Array(this.array,this.position,a);this.position+=c.INT32_SIZE*a;return b};
    c.prototype.getFloat=function(){var a=this.data.getFloat32(this.position,this._order);this.position+=c.FLOAT_SIZE;return a};c.prototype.getFloatArray=function(a){var b=new Float32Array(this.array,this.position,a);this.position+=c.FLOAT_SIZE*a;return b};c.prototype.getDouble=function(){var a=this.data.getFloat64(this.position,this._order);this.position+=c.DOUBLE_SIZE;return a};c.prototype.getDoubleArray=function(a){var b;0!=this.position%8?(b=this.array.slice(this.position,this.position+a*c.DOUBLE_SIZE),
        b=new Float64Array(b)):b=new Float64Array(this.array,this.position,a);this.position+=c.DOUBLE_SIZE*a;return b};c.prototype.skipBytes=function(a){this.position+=a*c.BYTE_SIZE};c.prototype.skipInt16s=function(a){this.position+=a*c.INT16_SIZE};c.prototype.skipInt32s=function(a){this.position+=a*c.INT32_SIZE};c.prototype.skipFloats=function(a){this.position+=a*c.FLOAT_SIZE};c.prototype.skipDoubles=function(a){this.position+=a*c.DOUBLE_SIZE};c.prototype.seek=function(a){this.position=a};c.prototype.order=
        function(a){this._order=a};c.prototype.limit=function(){return this.data.byteLength};c.prototype.hasRemaining=function(){return this.position<this.data.byteLength};c.BIG_ENDIAN=!1;c.LITTLE_ENDIAN=!0;c.BYTE_SIZE=1;c.INT16_SIZE=2;c.INT32_SIZE=4;c.FLOAT_SIZE=4;c.DOUBLE_SIZE=8;return c});
define("src/formats/shapefile/DBaseField",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseFile","../../util/Logger"],function(f,b,c,a){var d=function(b,c){if(!b)throw new f(a.logMessage(a.LEVEL_SEVERE,"DBaseField","constructor","missingAttributeName"));if(!c)throw new f(a.logMessage(a.LEVEL_SEVERE,"DBaseField","constructor","missingBuffer"));this.type=this.name=null;this.decimals=this.length=this.typeCode=-1;this.readFieldDescriptor(b,c)};d.prototype.getName=function(){return this.name};
    d.prototype.getType=function(){return this.type};d.prototype.getLength=function(){return this.length};d.prototype.getDecimals=function(){return this.decimals};d.prototype.readFieldDescriptor=function(c,g){g.order(b.LITTLE_ENDIAN);var h=g.position;this.name=c.readNullTerminatedString(g,d.FIELD_NAME_LENGTH);g.seek(h+d.FIELD_NAME_LENGTH);this.typeCode=String.fromCharCode(g.getByte());this.type=d.getFieldType(this.typeCode);if(null==this.type)throw Error(a.log(a.LEVEL_SEVERE,"Shapefile dBase encountered unsupported field type: "+
        this.typeCode));g.skipBytes(4);this.length=g.getByte();this.decimals=g.getByte();g.seek(h+d.FIELD_DESCRIPTOR_LENGTH)};d.getFieldType=function(a){switch(a){case "C":return d.TYPE_CHAR;case "D":return d.TYPE_DATE;case "F":return d.TYPE_NUMBER;case "L":return d.TYPE_BOOLEAN;case "N":return d.TYPE_NUMBER;default:return null}};d.prototype.toString=function(){return this.name+"("+this.typeCode+")"};d.TYPE_CHAR="DBase.FieldTypeChar";d.TYPE_NUMBER="DBase.FieldTypeNumber";d.TYPE_DATE="DBase.FieldTypeDate";
    d.TYPE_BOOLEAN="DBase.FieldTypeBoolean";d.FIELD_NAME_LENGTH=11;d.FIELD_DESCRIPTOR_LENGTH=32;return d});
define("src/formats/shapefile/DBaseRecord",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseField","../../formats/shapefile/DBaseFile","../../util/Logger"],function(f,b,c,a,d){a=function(a,b,c){if(!a)throw new f(d.logMessage(d.LEVEL_SEVERE,"DBaseRecord","constructor","missingAttributeName"));if(!b)throw new f(d.logMessage(d.LEVEL_SEVERE,"DBaseRecord","constructor","missingBuffer"));this.deleted=!1;this.recordNumber=c;this.values=null;this.readFromBuffer(a,b,c)};a.prototype.isDeleted=
    function(){return this.deleted};a.prototype.getRecordNumber=function(){return this.recordNumber};a.prototype.readFromBuffer=function(a,g,h){g.order(b.LITTLE_ENDIAN);this.recordNumber=h;this.deleted=42==g.getByte();h=a.getFields();this.values={};for(var f=0,l=h.length;f<l;f+=1){var m=h[f],p=m.getName(),q=a.readNullTerminatedString(g,m.getLength()).trim();try{if(m.getType()==c.TYPE_BOOLEAN){var t=q.charAt(0);this.values[p]="t"==t||"T"==t||"Y"==t||"y"==t}else m.getType()==c.TYPE_CHAR?this.values[p]=
    q:m.getType()==c.TYPE_DATE?this.values[p]=new Date(q):m.getType()==c.TYPE_NUMBER&&(this.values[p]=+q)}catch(r){d.log(d.LEVEL_WARNING,"Shapefile attribute parsing error:"+m.toString()+" -> "+q.toString()+" ["+r+"]")}}};return a});
define("src/formats/shapefile/DBaseFile",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseField","../../formats/shapefile/DBaseRecord","../../util/Logger"],function(f,b,c,a,d){var e=function(a){if(!a)throw new f(d.logMessage(d.LEVEL_SEVERE,"DBaseFile","constructor","missingUrl"));this.url=a;this.buffer=this.fields=this.header=null;this["boolean"]=!0;this.numRecordsRead=0;this._completionCallback=null};e.prototype.getLastModificationDate=function(){return this.header.lastModificationDate};
    e.prototype.getNumberOfRecords=function(){return this.header.numberOfRecords};e.prototype.getHeaderLength=function(){return this.header.headerLength};e.prototype.getRecordLength=function(){return this.header.recordLength};e.prototype.getNumberOfFields=function(){return(this.header.headerLength-1-e.FIXED_HEADER_LENGTH)/e.FIELD_DESCRIPTOR_LENGTH};e.prototype.getFields=function(){return this.fields};e.prototype.hasNext=function(){return this.numRecordsRead<this.header.numberOfRecords};e.prototype.nextRecord=
        function(){return this.numRecordsRead>=this.getNumberOfRecords()?null:this.readNextRecord(this._buffer,this.numRecordsRead)};e.prototype.load=function(a){this._completionCallback=a;this.requestUrl(this.url)};e.prototype.requestUrl=function(a){var c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onreadystatechange=function(){4===c.readyState&&(200===c.status?(this._buffer=new b(c.response),this.parse()):d.log(d.LEVEL_WARNING,"DBaseFile retrieval failed ("+c.statusText+"): "+a),
    this._completionCallback&&this._completionCallback(this))}.bind(this);c.onerror=function(){d.log(d.LEVEL_WARNING,"DBaseFile retrieval failed: "+a);this._completionCallback&&this._completionCallback(this)};c.ontimeout=function(){d.log(d.LEVEL_WARNING,"DBaseFile retrieval timed out: "+a);this._completionCallback&&this._completionCallback(this)};c.send(null)};e.prototype.parse=function(){this.header=this.readHeader(this._buffer);this.fields=this.readFieldDescriptors(this._buffer,this.getNumberOfFields())};
    e.prototype.readHeader=function(a){var c=a.position;a.order(b.LITTLE_ENDIAN);var d=a.getByte();if(5<d)throw Error("???");var f=a.getByte(),m=a.getByte(),p=a.getByte(),q=a.getInt32(),t=a.getInt16(),r=a.getInt16(),d={fileCode:d,lastModificationDate:{year:1900+f,month:m-1,day:p},numberOfRecords:q,headerLength:t,recordLength:r};a.seek(c+e.FIXED_HEADER_LENGTH);return d};e.prototype.readFieldDescriptors=function(a,b){for(var d=a.position,f=[],m=0;m<b;m+=1)f[m]=new c(this,a);a.seek(d+(this.header.headerLength-
        e.FIXED_HEADER_LENGTH));return f};e.prototype.readNextRecord=function(){return this.readRecordFromBuffer(this._buffer,++this.numRecordsRead)};e.prototype.readNextRecord=function(b,c){return new a(this,b,c)};e.prototype.readNullTerminatedString=function(a,b){if(0>=b)return 0;for(var c="",d=0;d<b;d+=1){var e=a.getByte();if(0==e)break;c+=String.fromCharCode(e)}return this.isStringEmpty(c)?"":c};e.prototype.isStringEmpty=function(a){return 0>=a.length||e.isStringFilled(a,32)||e.isStringFilled(a,42)};
    e.isStringFilled=function(a,b){if(0>=a.length)return!1;for(var c=0;c<a.length;c++)if(a.charAt(c)!=b)return!1;return!0};e.FIXED_HEADER_LENGTH=32;e.FIELD_DESCRIPTOR_LENGTH=32;return e});
define("src/formats/shapefile/PrjFile",["../../error/ArgumentError","../../util/Logger","../../error/NotYetImplementedError"],function(f,b,c){var a=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"DBaseFile","constructor","missingUrl"));this._url=a;this._params=this._completionCallback=null};Object.defineProperties(a.prototype,{url:{get:function(){return this._url}},coordinateSystem:{get:function(){return this.params?this.params[a.COORDINATE_SYSTEM]:null}},params:{get:function(){return this._params}}});
    a.prototype.load=function(a){this._completionCallback=a;this.requestUrl(this._url)};a.prototype.requestUrl=function(a){var c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onreadystatechange=function(){if(4===c.readyState){if(200===c.status){var g=String.fromCharCode.apply(null,new Uint8Array(c.response));this._params=this.decodeOGCCoordinateSystem(g)}else b.log(b.LEVEL_WARNING,"PrjFile retrieval failed ("+c.statusText+"): "+a);this._completionCallback&&this._completionCallback(this)}}.bind(this);
        c.onerror=function(){b.log(b.LEVEL_WARNING,"PrjFile retrieval failed: "+a);this._completionCallback&&this._completionCallback(this)}.bind(this);c.ontimeout=function(){b.log(b.LEVEL_WARNING,"PrjFile retrieval timed out: "+a);this._completionCallback&&this._completionCallback(this)}.bind(this);c.send(null)};a.prototype.decodeOGCCoordinateSystem=function(d){d||new f(b.logMessage(b.LEVEL_SEVERE,"PrjFile","decodeOGCCoordinateSystem","missingText"));var e={};d=d.trim().toUpperCase();if(a.GEOGCS_WKT_PATTERN.test(d))e[a.COORDINATE_SYSTEM]=
        a.COORDINATE_SYSTEM_GEOGRAPHIC;else{if(d.match(a.PROJCS_WKT_PATTERN))throw e[PrfFile.COORDINATE_SYSTEM]=a.COORDINATE_SYSTEM_PROJECTED,new c(b.log(b.LEVEL_SEVERE,"PrjFile implementation  for projected coordinate systems in incomplete."));e[a.COORDINATE_SYSTEM]=a.COORDINATE_SYSTEM_UNKNOWN}return e};a.prototype.isUnknownCoordinateSystem=function(){return!this.params||this.params.coordinateSystem===a.COORDINATE_SYSTEM_UNKNOWN};a.prototype.isKnownCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem!==
        a.COORDINATE_SYSTEM_UNKNOWN};a.prototype.isGeographicCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem===a.COORDINATE_SYSTEM_GEOGRAPHIC};a.prototype.isProjectedCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem===a.COORDINATE_SYSTEM_PROJECTED};a.GEOGCS_WKT_PATTERN=/\{*GEOGCS[\[\(](.*)[\]\)]\}*/;a.PROJCS_WKT_PATTERN=/\{*PROJCS[\[\(](.*)[\]\)]\}*/;a.UTM_NAME_WKT_PATTERN=/.*UTM.*ZONE.*?(\d+).*?([\w\s]+).*?/;a.COORDINATE_SYSTEM="Coordinate_system";
    a.COORDINATE_SYSTEM_GEOGRAPHIC="Coordinate_system_geographic";a.COORDINATE_SYSTEM_PROJECTED="Coordinate_system_projected";a.COORDINATE_SYSTEM_UNKNOWN="Coordinate_system_unknown";a.PROJECTION_NAME="Projection_name";a.PROJECTION_UTM="Projection_UTM";a.PROJECTION_ZONE="Projection_zone";a.PROJECTION_HEMISPHERE="Projection_hemisphere";a.PROJECTION_HEMISPHERE_NORTH="Projection_hemisphere_north";a.PROJECTION_HEMISPHERE_SOUTH="Projection_hemisphere_south";return a});
define("src/formats/shapefile/ShapefileRecord","../../geom/Angle ../../error/ArgumentError ../../util/ByteBuffer ../../geom/Location ../../util/Logger ../../formats/shapefile/Shapefile".split(" "),function(f,b,c,a,d,e){var g=function(a,c){if(!a)throw new b(d.logMessage(d.LEVEL_SEVERE,"ShapefileRecord","constructor","The specified shapefile is null or undefined"));if(!c)throw new b(d.logMessage(d.LEVEL_SEVERE,"ShapefileRecord","constructor","The specified buffer is null or undefined"));this._shapefile=
    a;this._recordNumber=-1;this._attributes={};this._numberOfPoints=this._lastPartNumber=this._firstPartNumber=this._numberOfParts=0;this._boundingRectangle=[];this._mValues=this._mRange=this._zValues=this._zRange=null;this._contentLengthInBytes=-1;this._buffer=c;this._isNormalized=!1;this._parts=[];this.readRecord()};Object.defineProperties(g.prototype,{shapefile:{get:function(){return this._shapefile}},recordNumber:{get:function(){return this._recordNumber}},attributes:{get:function(){return this._attributes}},
    numberOfParts:{get:function(){return this._numberOfParts}},firstPartNumber:{get:function(){return this._firstPartNumber}},lastPartNumber:{get:function(){return this._lastPartNumber}},numberOfPoints:{get:function(){return this._numberOfPoints}},boundingRectangle:{get:function(){return this._boundingRectangle}},zRange:{get:function(){return this._zRange}},zValues:{get:function(){return this._zValues}},mRange:{get:function(){return this._mRange}},mValues:{get:function(){return this._mValues}}});g.prototype.pointBuffer=
    function(a){return 0<=a&&a<this._parts.length?this._parts[a]:null};g.prototype.readRecord=function(){this.readHeader();this._buffer.order(c.LITTLE_ENDIAN);var a=this._buffer.getInt32(),a=this.shapefile.getShapeType(a);this.validateShapeType(a);this.readContents()};g.prototype.readHeader=function(){this._buffer.order(c.BIG_ENDIAN);this._recordNumber=this._buffer.getInt32();this._contentLengthInBytes=2*this._buffer.getInt32()};g.prototype.validateShapeType=function(a){if(a!==this.shapefile.NULL&&a!==
    this.shapefile.shapeType)throw Error(d.log(d.LEVEL_SEVERE,"Shapefile record is not supported."));};g.prototype.readNullContents=function(){this._numberOfPoints=this._numberOfParts=0;this._boundingRectangle=this._parts=null;this._buffer.seek(this._contentLengthInBytes-c.INT32_SIZE)};g.prototype.readPointContents=function(){this._numberOfParts=1;this._firstPartNumber=0;this._lastPartNumber=this._numberOfParts-1;this._numberOfPoints=1;this._parts=[this._buffer.getDoubleArray(2)];var a=this._parts[0][1],
    b=this._parts[0][0];this._boundingRectangle=[a,a,b,b];this.isZType()&&this.readZ(!0);this.isMeasureType()&&this.readOptionalMeasures(!0)};g.prototype.readPolylineContents=function(){var a=this.shapefile.readBoundingRectangle(this._buffer);this._boundingRectangle=a.coords;this._isNormalized=a.isNormalized;this._numberOfParts=this._buffer.getInt32();this._firstPartNumber=0;this._lastPartNumber=this._numberOfParts-1;this._numberOfPoints=this._buffer.getInt32();if(0<this._numberOfParts&&0<this._numberOfPoints)for(var a=
    this._buffer.getInt32Array(this.numberOfParts),b=0;b<this.numberOfParts;b+=1)this._parts[b]=this._buffer.getDoubleArray(2*(b==this.numberOfParts-1?this._numberOfPoints-a[b]:a[b+1]-a[b])),g.normalizeLocations(this._parts[b]);this.isZType()&&this.readZ(!1);this.isMeasureType()&&this.readOptionalMeasures(!1)};g.prototype.readMultiPointContents=function(){var a=this.shapefile.readBoundingRectangle(this._buffer);this._boundingRectangle=a.coords;this._isNormalized=a.isNormalized;this._numberOfParts=1;this._numberOfPoints=
    this._buffer.getInt32();this._parts=[this._buffer.getDoubleArray(2*this._numberOfPoints)];g.normalizeLocations(this._parts[0]);this.isZType()&&this.readZ(!1);this.isMeasureType()&&this.readOptionalMeasures(!1)};g.prototype.readZ=function(a){a?(this._zValues=this._buffer.getDoubleArray(1),a=this._zValues[0],this._zRange=[a,a]):(this._zRange=this._buffer.getDoubleArray(2),this._zValues=this._buffer.getDoubleArray(this.numberOfPoints))};g.prototype.readOptionalMeasures=function(a){this._buffer.hasRemaining()&&
this._buffer.limit()-this._buffer.position>=8*this.numberOfPoints&&(a?(this._mValues=this._buffer.getDoubleArray(1),a=this._mValues[0],this._mRange=[a,a]):(this._mRange=this._buffer.getDoubleArray(2),this._mValues=this._buffer.getDoubleArray(this.numberOfPoints)))};g.normalizeLocations=function(a){for(var b=0,c=a.length;b<c;b+=2){var d=a[b+1];a[b]=f.normalizedDegreesLongitude(a[b]);a[b+1]=f.normalizedDegreesLatitude(d)}};g.prototype.isPointType=function(){return this.shapefile.isPointType()};g.prototype.isMultiPointType=
    function(){return this.shapefile.isMultiPointType()};g.prototype.isPolylineType=function(){return this.shapefile.isPolylineType()};g.prototype.isPolygonType=function(){return this.shapefile.isPolygonType()};g.prototype.isZType=function(){return this.shapefile.isZType()};g.prototype.isMeasureType=function(){return this.shapefile.isMeasureType()};g.prototype.setAttributes=function(a){this._attributes=a};g.RECORD_HEADER_LENGTH=8;return g});
define("src/formats/shapefile/ShapefileRecordMultiPoint",["../../util/ByteBuffer","../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(f,b,c){f=function(a,b){c.call(this,a,b)};f.prototype=Object.create(c.prototype);f.prototype.readContents=function(){this.readMultiPointContents()};return f});
define("src/formats/shapefile/ShapefileRecordNull",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(f,b){var c=function(a,c){b.call(this,a,c)};c.prototype=Object.create(b.prototype);c.prototype.readContents=function(){this.readNullContents()};return c});
define("src/formats/shapefile/ShapefileRecordPoint",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(f,b){var c=function(a,c){b.call(this,a,c)};c.prototype=Object.create(b.prototype);c.prototype.readContents=function(){this.readPointContents()};return c});
define("src/formats/shapefile/ShapefileRecordPolygon",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(f,b){var c=function(a,c){b.call(this,a,c)};c.prototype=Object.create(b.prototype);c.prototype.readContents=function(){this.readPolylineContents()};return c});
define("src/formats/shapefile/ShapefileRecordPolyline",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(f,b){var c=function(a,c){b.call(this,a,c)};c.prototype=Object.create(b.prototype);c.prototype.readContents=function(){this.readPolylineContents()};return c});
define("src/formats/shapefile/Shapefile","../../geom/Angle ../../error/ArgumentError ../../util/ByteBuffer ../../util/Color ../../formats/shapefile/DBaseFile ../../geom/Location ../../util/Logger ../../error/NotYetImplementedError ../../shapes/Path ../../shapes/Placemark ../../shapes/PlacemarkAttributes ../../shapes/Polygon ../../geom/Position ../../formats/shapefile/PrjFile ../../layer/RenderableLayer ../../shapes/ShapeAttributes ../../formats/shapefile/ShapefileRecord ../../formats/shapefile/ShapefileRecordMultiPoint ../../formats/shapefile/ShapefileRecordNull ../../formats/shapefile/ShapefileRecordPoint ../../formats/shapefile/ShapefileRecordPolygon ../../formats/shapefile/ShapefileRecordPolyline ../../shapes/SurfacePolygon ../../shapes/SurfacePolyline".split(" "),function(f,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   b,c,a,d,e,g,h,k,l,m,p,q,t,r,u,w,x,A,B,v,F,G,D){var y=function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Shapefile","constructor","missingUrl"));this._url=a;this._layer=this._shapeType=null;this._shapeConfigurationCallback=this.defaultShapeConfigurationCallback;this._parserCompletionCallback=this.defaultParserCompletionCallback;this._buffer=null;this.attributeFile=new d(a.replace(".shp",".dbf"));this.projectionFile=new t(a.replace(".shp",".prj"));this.defaultPlacemarkAttributes=new m(null);
    this.defaultShapeAttributes=new u(null)};Object.defineProperties(y.prototype,{url:{get:function(){return this._url}},shapeType:{get:function(){return this._shapeType}},layer:{get:function(){return this._layer}},parserCompletionCallback:{get:function(){return this._parserCompletionCallback}},shapeConfigurationCallback:{get:function(){return this._shapeConfigurationCallback}}});y.prototype.load=function(a,b,c){a&&(this._parserCompletionCallback=a);b&&(this._shapeConfigurationCallback=b);this._layer=
    c||new r;a=function(){var a=function(){this.requestUrl(this.url)}.bind(this);this.attributeFile.load(a)}.bind(this);this.projectionFile.load(a)};y.prototype.defaultParserCompletionCallback=function(a){this.addRenderablesForShapefile(this.layer)};y.prototype.defaultShapeConfigurationCallback=function(a,b){var c={},d=a.values.name||a.values.Name||a.values.NAME;d&&(c.name=d);b.isPointType()?c.attributes=this.defaultPlacemarkAttributes:b.isMultiPointType()?c.attributes=this.defaultPlacemarkAttributes:
    b.isPolylineType()?c.attributes=this.defaultShapeAttributes:b.isPolygonType()&&(c.attributes=this.defaultShapeAttributes,d=a.values.height||a.values.Height||a.values.HEIGHT)&&(c.height=d);return c};y.prototype.addRenderablesForShapefile=function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Shapefile","addRenderablesForShapefile","missingLayer"));this.isPointType()?this.addRenderablesForPoints(a):this.isMultiPointType()?this.addRenderablesForMultiPoints(a):this.isPolylineType()?this.addRenderablesForPolylines(a):
this.isPolygonType()&&this.addRenderablesForPolygons(a)};y.prototype.addRenderablesForPoints=function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Shapefile","addRenderablesForPoints","missingLayer"));for(var c=this.next();c;c=this.next()){var d=this.shapeConfigurationCallback(c.attributes,c),e=d&&d.altitude?d.altitude:0;if(d)for(var h=0,f=c.numberOfParts;h<f;h+=1)for(var k=c.pointBuffer(h),m=0,p=k.length;m<p;m+=2){var r=new q(k[m+1],k[m],e),r=new l(r,!1,d.attributes);r.altitudeMode=d.altitudeMode||
    WorldWind.RELATIVE_TO_GROUND;d.highlightAttributes&&(r.highlightAttributes=d.highlightAttributes);d.name&&(r.label=d.name);a.addRenderable(r)}}};y.prototype.addRenderablesForMultiPoints=function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Shapefile","addRenderablesForMultiPoints","missingLayer"));for(var c=this.next();c;c=this.next()){var d=this.shapeConfigurationCallback(c.attributes,c),e=d&&d.altitude?d.altitude:0;if(d)for(var h=0,f=c.numberOfParts;h<f;h+=1)for(var k=c.pointBuffer(h),m=0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  p=k.length;m<p;m+=2){var r=new q(k[m+1],k[m],e),r=new l(r,!1,d.attributes);r.altitudeMode=d.altitudeMode||WorldWind.RELATIVE_TO_GROUND;d.highlightAttributes&&(r.highlightAttributes=d.highlightAttributes);d.name&&(r.label=d.name);a.addRenderable(r)}}};y.prototype.addRenderablesForPolylines=function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,"Shapefile","addRenderablesForPolylines","missingLayer"));for(var c=this.next();c;c=this.next()){var d=this.shapeConfigurationCallback(c.attributes,c),h=
    d&&d.altitude?d.altitude:0;if(d)for(var f=0,l=c.numberOfParts;f<l;f+=1){for(var m=c.pointBuffer(f),p=[],r=0,t=m.length;r<t;r+=2){var u=m[r],v=m[r+1],u=h?new q(v,u,h):new e(v,u);p.push(u)}h?(m=new k(p,d.attributes),m.altitudeMode=d.altitudeMode||WorldWind.RELATIVE_TO_GROUND):m=new D(p,d.attributes);d.highlightAttributes&&(m.highlightAttributes=d.highlightAttributes);d.name&&(m.displayName=d.name);a.addRenderable(m)}}};y.prototype.addRenderablesForPolygons=function(a){if(!a)throw new b(g.logMessage(g.LEVEL_SEVERE,
    "Shapefile","addRenderablesForPolygons","missingLayer"));for(var c=this.next();c;c=this.next()){for(var d=this.shapeConfigurationCallback(c.attributes,c),h=[],f,k=d.height,l=d.altitude,m=0,r=c.numberOfParts;m<r;m+=1){for(var t=c.pointBuffer(m),u=[],v=0,w=t.length-2;v<w;v+=2){f=t[v];var A=t[v+1];f=k?new q(A,f,k):l?new q(A,f,l):new e(A,f);u.push(f)}h.push(u)}k?(c=new p(h,d.attributes),c.extrude=!0,c.altitudeMode=d.altitudeMode||WorldWind.RELATIVE_TO_GROUND):l?(c=new p(h,d.attributes),c.altitudeMode=
    d.altitudeMode||WorldWind.RELATIVE_TO_GROUND):c=new G(h,d.attributes);d.highlightAttributes&&(c.highlightAttributes=d.highlightAttributes);d.name&&(c.displayName=d.name);a.addRenderable(c)}};y.prototype.next=function(){for(;this._buffer.position<this._buffer.limit();){var a=this.readRecord(this._buffer);if(!(a instanceof A))return a}return null};y.prototype.requestUrl=function(a){var b=new XMLHttpRequest;b.open("GET",a,!0);b.responseType="arraybuffer";b.onreadystatechange=function(){4===b.readyState&&
(200===b.status?(this._buffer=new c(b.response),this.parse()):g.log(g.LEVEL_WARNING,"Shapefile retrieval failed ("+b.statusText+"): "+a),this._parserCompletionCallback&&this._parserCompletionCallback(this))}.bind(this);b.onerror=function(){g.log(g.LEVEL_WARNING,"Shapefile retrieval failed: "+a);this._parserCompletionCallback&&this._parserCompletionCallback(this)};b.ontimeout=function(){g.log(g.LEVEL_WARNING,"Shapefile retrieval timed out: "+a);this._parserCompletionCallback&&this._parserCompletionCallback(this)};
    b.send(null)};y.prototype.parse=function(){try{this._shapeType=this.readHeader(this._buffer).shapeType}catch(a){console.log(a)}finally{}};y.prototype.readHeader=function(a){a.order(c.BIG_ENDIAN);if(a.getInt32()!=y.FILE_CODE)throw Error(g.log(g.LEVEL_SEVERE,"Shapefile header is invalid"));a.skipInt32s(5);var b=a.getInt32();a.order(c.LITTLE_ENDIAN);var d=a.getInt32(),e=a.getInt32(),h=this.readBoundingRectangle(a),f=this.getShapeType(e);if(null==f)throw Error(g.log(g.LEVEL_SEVERE,"Shapefile type is unsupported: "+
    e.toString()));b={fileLength:2*b,version:d,shapeType:f,boundingRectangle:h.coords,normalizePoints:h.isNormalized};a.skipDoubles(4);return b};y.prototype.readBoundingRectangle=function(a){return this.projectionFile?this.projectionFile.isGeographicCoordinateSystem()?this.readGeographicBoundingRectangle(a):this.projectionFile.isProjectedCoordinateSystem()?this.readProjectedBoundingRectangle(a):this.readUnspecifiedBoundingRectangle(a):this.readUnspecifiedBoundingRectangle(a)};y.prototype.readUnspecifiedBoundingRectangle=
    function(a){return{coords:this.readBoundingRectangleCoordinates(a),isNormalized:!1}};y.prototype.readGeographicBoundingRectangle=function(a){a=this.readBoundingRectangleCoordinates(a);var b=!1,c;-90>a[0]&&(c=f.normalizedDegreesLatitude(a[0]),a[0]=90,b=!0,a[1]<c&&(a[1]=c));90<a[1]&&(c=f.normalizedDegreesLatitude(a[1]),a[1]=90,b=!0,a[0]>c&&(a[0]=c));if(-180>a[2]||180<a[3])a[2]=-180,a[3]=180,b=!0;return{coords:a,isNormalized:b}};y.prototype.readProjectedBoundingRectangle=function(a){throw new h(g.log(g.LEVEL_SEVERE,
    "Shapefile.readProjectedBoundingRectangle() not yet implemented"));};y.prototype.readBoundingRectangleCoordinates=function(a){var b=a.getDouble(),c=a.getDouble(),d=a.getDouble();a=a.getDouble();return[c,a,b,d]};y.prototype.readRecord=function(a){a=this.createRecord(a);if(null!=a&&null!=this.attributeFile&&this.attributeFile.hasNext()){var b=this.attributeFile.nextRecord();a.setAttributes(b)}return a};y.prototype.createRecord=function(a){return this.isNullType()?this.createNull(a):this.isPointType()?
    this.createPoint(a):this.isMultiPointType()?this.createMultiPoint(a):this.isPolygonType()?this.createPolygon(a):this.isPolylineType()?this.createPolyline(a):null};y.prototype.createNull=function(a){return new A(this,a)};y.prototype.createPoint=function(a){return new B(this,a)};y.prototype.createMultiPoint=function(a){return new x(this,a)};y.prototype.createPolyline=function(a){return new F(this,a)};y.prototype.createPolygon=function(a){return new v(this,a)};y.prototype.getShapeType=function(a){switch(a){case 0:return y.NULL;
    case 1:return y.POINT;case 3:return y.POLYLINE;case 5:return y.POLYGON;case 8:return y.MULTI_POINT;case 11:return y.POINT_Z;case 13:return y.POLYLINE_Z;case 15:return y.POLYGON_Z;case 18:return y.MULTI_POINT_Z;case 21:return y.POINT_M;case 23:return y.POLYLINE_M;case 25:return y.POLYGON_M;case 28:return y.MULTI_POINT_M;default:return null}};y.prototype.isMeasureType=function(){return y.measureTypes.hasOwnProperty(this._shapeType)};y.prototype.isZType=function(){return y.zTypes.hasOwnProperty(this._shapeType)};
    y.prototype.isNullType=function(){return this._shapeType===y.NULL};y.prototype.isPointType=function(){return y.pointTypes.hasOwnProperty(this._shapeType)};y.prototype.isMultiPointType=function(){return y.multiPointTypes.hasOwnProperty(this._shapeType)};y.prototype.isPolylineType=function(){return y.polylineTypes.hasOwnProperty(this._shapeType)};y.prototype.isPolygonType=function(){return y.polygonTypes.hasOwnProperty(this._shapeType)};y.NULL="null";y.POINT="point";y.MULTI_POINT="multiPoint";y.POLYLINE=
        "polyline";y.POLYGON="polygon";y.POINT_M=y.POINT+"M";y.MULTI_POINT_M=y.MULTI_POINT+"M";y.POLYLINE_M=y.POLYLINE+"M";y.POLYGON_M=y.POLYGON+"M";y.POINT_Z=y.POINT+"Z";y.MULTI_POINT_Z=y.MULTI_POINT+"Z";y.POLYLINE_Z=y.POLYLINE+"Z";y.POLYGON_Z=y.POLYGON+"Z";y.SHAPE_MULTI_PATCH="multiPatch";y.measureTypes={pointM:y.POINT_M,pointZ:y.POINT_Z,multiPointM:y.MULTI_POINT_M,multiPointZ:y.MULTI_POINT_Z,polylineM:y.POLYLINE_M,polylineZ:y.POLYLINE_Z,polygonM:y.POLYGON_M,polygonZ:y.POLYGON_Z};y.zTypes={pointZ:y.POINT_Z,
        multiPointZ:y.MULTI_POINT_Z,polylineZ:y.POLYLINE_Z,polygonZ:y.POLYGON_Z};y.pointTypes={point:y.POINT,pointZ:y.POINT_Z,pointM:y.POINT_M};y.multiPointTypes={multiPoint:y.MULTI_POINT,multiPointZ:y.MULTI_POINT_Z,multiPointM:y.MULTI_POINT_M};y.polylineTypes={polyline:y.POLYLINE,polylineZ:y.POLYLINE_Z,polylineM:y.POLYLINE_M};y.polygonTypes={polygon:y.POLYGON,polygonZ:y.POLYGON_Z,polygonM:y.POLYGON_M};y.FILE_CODE=9994;return y});
define("src/layer/ShowTessellationLayer",["../shaders/BasicProgram","../layer/Layer"],function(f,b){var c=function(){b.call(this,"Show Tessellation");this.enableTerrainGeometry=!0;this.enableTerrainExtent=!1};c.prototype=Object.create(b.prototype);c.prototype.doRender=function(a){try{this.beginRendering(a),this.enableTerrainGeometry&&this.drawTerrainGeometry(a),this.enableTerrainExtent&&this.drawTerrainExtent(a)}finally{this.endRendering(a)}};c.prototype.beginRendering=function(a){a.currentGlContext.depthMask(!1)};
    c.prototype.endRendering=function(a){a.currentGlContext.depthMask(!0)};c.prototype.drawTerrainGeometry=function(a){if(a.terrain&&a.terrain.tessellator){var b=a.currentGlContext,c=a.terrain,g=c.tessellator,c=c.surfaceGeometry,h,k;try{h=a.findAndBindProgram(f);g.beginRendering(a);for(var l=0,m=c.length;l<m;l++)k=c[l],g.beginRenderingTile(a,k),h.loadColorComponents(b,1,1,1,.3),g.renderWireframeTile(a,k),h.loadColorComponents(b,1,0,0,.6),g.renderTileOutline(a,k),g.endRenderingTile(a,k)}finally{g.endRendering(a)}}};
    c.prototype.drawTerrainExtent=function(a){for(var b=a.terrain.surfaceGeometry,c,g=0,h=b.length;g<h;g++)c=b[g],c.extent.render(a)};return c});
define("src/shapes/SurfaceEllipse","../geom/Angle ../error/ArgumentError ../geom/Location ../util/Logger ../shapes/ShapeAttributes ../shapes/SurfaceShape ../util/WWMath".split(" "),function(f,b,c,a,d,e,g){var h=function(c,d,g,f,q){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"SurfaceEllipse","constructor","missingLocation"));if(0>d||0>g)throw new b(a.logMessage(a.LEVEL_SEVERE,"SurfaceEllipse","constructor","Radius is negative."));e.call(this,q);this._center=c;this._majorRadius=d;this._minorRadius=
    g;this._heading=f;this._intervals=h.DEFAULT_NUM_INTERVALS};h.prototype=Object.create(e.prototype);Object.defineProperties(h.prototype,{center:{get:function(){return this._center},set:function(a){this.stateKeyInvalid=!0;this._center=a}},majorRadius:{get:function(){return this._majorRadius},set:function(a){this.stateKeyInvalid=!0;this._majorRadius=a}},minorRadius:{get:function(){return this._minorRadius},set:function(a){this.stateKeyInvalid=!0;this._minorRadius=a}},heading:{get:function(){return this._heading},
    set:function(a){this.stateKeyInvalid=!0;this._heading=a}},intervals:{get:function(){return this._intervals},set:function(a){this.stateKeyInvalid=!0;this._intervals=a}}});h.staticStateKey=function(a){return e.staticStateKey(a)+" ce "+a.center.toString()+" ma "+a.majorRadius.toString()+" mi "+a.minorRadius.toString()+" he "+a.heading.toString()+" in "+a.intervals.toString()};h.prototype.computeStateKey=function(){return h.staticStateKey(this)};h.prototype.computeBoundaries=function(a){if(0==this.majorRadius&&
    0==this.minorRadius)return null;var b=1+Math.max(h.MIN_NUM_INTERVALS,this.intervals),d=2*Math.PI/(b-1);a=a.globe.radiusAt(this.center.latitude,this.center.longitude);this._boundaries=Array(b);for(var e=0;e<b;e++){var q=e!=b-1?e*d:0,t=this.majorRadius*Math.cos(q),r=this.minorRadius*Math.sin(q),q=Math.sqrt(t*t+r*r),t=Math.PI/2-(Math.acos(t/q)*g.signum(r)-this.heading*f.DEGREES_TO_RADIANS);this._boundaries[e]=c.greatCircleLocation(this.center,t*f.RADIANS_TO_DEGREES,q/a,new c(0,0))}};h.MIN_NUM_INTERVALS=
    8;h.DEFAULT_NUM_INTERVALS=64;return h});
define("src/shapes/SurfaceCircle",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceEllipse"],function(f,b,c,a){var d=function(c,d,h){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"SurfaceCircle","constructor","missingLocation"));if(0>d)throw new f(b.logMessage(b.LEVEL_SEVERE,"SurfaceCircle","constructor","Radius is negative"));a.call(this,c,d,d,0,h);this._radius=d};d.prototype=Object.create(a.prototype);Object.defineProperties(d.prototype,{radius:{get:function(){return this._radius},
    set:function(a){this.stateKeyInvalid=!0;this._radius=a}}});d.staticStateKey=function(b){return a.staticStateKey(b)+" ra "+b.radius.toString()};d.prototype.computeStateKey=function(){return d.staticStateKey(this)};return d});
define("src/shapes/SurfaceRectangle","../geom/Angle ../error/ArgumentError ../geom/Location ../util/Logger ../shapes/ShapeAttributes ../shapes/SurfaceShape ../util/WWMath".split(" "),function(f,b,c,a,d,e,g){var h=function(c,d,g,h,f){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"SurfaceRectangle","constructor","missingLocation"));if(0>d||0>g)throw new b(a.logMessage(a.LEVEL_SEVERE,"SurfaceRectangle","constructor","Size is negative."));e.call(this,f);this._center=c;this._width=d;this._height=g;this._heading=
    h};h.prototype=Object.create(e.prototype);Object.defineProperties(h.prototype,{center:{get:function(){return this._center},set:function(a){this.stateKeyInvalid=!0;this._center=a}},width:{get:function(){return this._width},set:function(a){this.stateKeyInvalid=!0;this._width=a}},height:{get:function(){return this._height},set:function(a){this.stateKeyInvalid=!0;this._height=a}},heading:{get:function(){return this._heading},set:function(a){this.stateKeyInvalid=!0;this._heading=a}}});h.staticStateKey=
    function(a){return e.staticStateKey(a)+" ce "+a.center.toString()+" wi "+a.width.toString()+" he "+a.height.toString()+" hd "+a.heading.toString()};h.prototype.computeStateKey=function(){return h.staticStateKey(this)};h.prototype.computeBoundaries=function(a){var b=.5*this.width,c=.5*this.height;a=a.globe.radiusAt(this.center.latitude,this.center.longitude);this._boundaries=Array(4);this.addLocation(0,-b,-c,a);this.addLocation(1,b,-c,a);this.addLocation(2,b,c,a);this.addLocation(3,-b,c,a)};h.prototype.addLocation=
    function(a,b,d,e){var h=Math.sqrt(b*b+d*d);b=Math.PI/2-(Math.acos(b/h)*g.signum(d)-this.heading*f.DEGREES_TO_RADIANS);this._boundaries[a]=c.greatCircleLocation(this.center,b*f.RADIANS_TO_DEGREES,h/e,new c(0,0))};return h});
define("src/render/SurfaceRenderable",["../util/Logger","../error/UnsupportedOperationError"],function(f,b){var c=function(){this.displayName="Renderable";this.enabled=!0;throw new b(f.logMessage(f.LEVEL_SEVERE,"SurfaceRenderable","constructor","abstractInvocation"));};c.prototype.renderSurface=function(a){throw new b(f.logMessage(f.LEVEL_SEVERE,"SurfaceRenderable","renderSurface","abstractInvocation"));};return c});
define("src/shapes/SurfaceSector",["../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(f,b,c,a,d){var e=function(a,b){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"SurfaceSector","constructor","missingSector"));d.call(this,b);this._sector=a};e.prototype=Object.create(d.prototype);e.staticStateKey=function(a){return d.staticStateKey(a)};e.prototype.computeStateKey=function(){return e.staticStateKey(this)};e.prototype.computeBoundaries=
    function(a){a=this._sector;this._boundaries=Array(4);this._boundaries[0]=new b(a.minLatitude,a.minLongitude);this._boundaries[1]=new b(a.maxLatitude,a.minLongitude);this._boundaries[2]=new b(a.maxLatitude,a.maxLongitude);this._boundaries[3]=new b(a.minLatitude,a.maxLongitude)};return e});
define("src/gesture/TapRecognizer",["../gesture/GestureRecognizer"],function(f){var b=function(b,a){f.call(this,b,a);this.numberOfTouches=this.numberOfTaps=1;this.maxTouchMovement=20;this.maxTapDuration=500;this.maxTapInterval=400;this.taps=[];this.timeout=null};b.prototype=Object.create(f.prototype);b.prototype.reset=function(){f.prototype.reset.call(this);this.taps=[];this.cancelFailAfterDelay()};b.prototype.mouseDown=function(b){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)};b.prototype.touchStart=
    function(b){this.state==WorldWind.POSSIBLE&&(this.touchCount>this.numberOfTouches?this.state=WorldWind.FAILED:1==this.touchCount?(b={touchCount:this.touchCount,clientX:this.clientX,clientY:this.clientY},this.taps.push(b),this.failAfterDelay(this.maxTapDuration)):(b=this.taps[this.taps.length-1],b.touchCount=this.touchCount,b.clientX=this.clientX,b.clientY=this.clientY))};b.prototype.touchMove=function(b){if(this.state==WorldWind.POSSIBLE){b=this.translationX;var a=this.translationY;Math.sqrt(b*b+
    a*a)>this.maxTouchMovement&&(this.state=WorldWind.FAILED)}};b.prototype.touchEnd=function(b){this.state==WorldWind.POSSIBLE&&0==this.touchCount&&(b=this.taps.length,this.taps[b-1].touchCount!=this.numberOfTouches?this.state=WorldWind.FAILED:b==this.numberOfTaps?(this.clientX=this.taps[0].clientX,this.clientY=this.taps[0].clientY,this.state=WorldWind.RECOGNIZED):this.failAfterDelay(this.maxTapInterval))};b.prototype.touchCancel=function(b){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)};
    b.prototype.failAfterDelay=function(b){var a=this;a.timeout&&window.clearTimeout(a.timeout);a.timeout=window.setTimeout(function(){a.timeout=null;a.state==WorldWind.POSSIBLE&&(a.state=WorldWind.FAILED)},b)};b.prototype.cancelFailAfterDelay=function(){this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)};return b});
define("src/layer/TectonicPlatesLayer","../error/ArgumentError ../util/Color ../geom/Location ../util/Logger ../layer/RenderableLayer ../shapes/ShapeAttributes ../shapes/SurfacePolygon".split(" "),function(f,b,c,a,d,e,g){f=function(a){d.call(this,"Tectonic Plates");a?this._attributes=a:(this._attributes=new e(null),this._attributes.drawInterior=!1,this._attributes.drawOutline=!0,this._attributes.outlineColor=b.RED);this.loadPlateData()};f.prototype=Object.create(d.prototype);Object.defineProperties(g.prototype,
    {attributes:{get:function(){return this._attributes},set:function(a){a&&this.renderables.map(function(b,c,d){b.attributes=a})}}});f.prototype.loadPlateData=function(){var b=new XMLHttpRequest;b.open("GET","http://worldwindserver.net/webworldwind/data/TectonicPlates.json",!0);b.onreadystatechange=function(){4===b.readyState&&(200===b.status?this.parse(b.responseText):a.log(a.LEVEL_WARNING,"Tectonic plate data retrieval failed ("+b.statusText+"): http://worldwindserver.net/webworldwind/data/TectonicPlates.json"))}.bind(this);
    b.onerror=function(){a.log(a.LEVEL_WARNING,"Tectonic plate data retrieval failed: http://worldwindserver.net/webworldwind/data/TectonicPlates.json")};b.ontimeout=function(){a.log(a.LEVEL_WARNING,"Tectonic plate data retrieval timed out: http://worldwindserver.net/webworldwind/data/TectonicPlates.json")};b.send(null)};f.prototype.parse=function(a){var b=this;JSON.parse(a).features.map(function(a,d,e){var h=[];a.geometry.coordinates.map(function(a,b,d){h.push(new c(a[1],a[0]))});a=new g(h,b._attributes);
    b.addRenderable(a)})};return f});define("src/util/TileFactory",["../util/Logger","../error/UnsupportedOperationError"],function(f,b){var c=function(){};c.prototype.createTile=function(a,c,e,g){throw new b(f.logMessage(f.LEVEL_SEVERE,"TileFactory","createTile","abstractInvocation"));};return c});
define("src/shapes/TriangleMesh","../shapes/AbstractMesh ../error/ArgumentError ../shaders/BasicTextureProgram ../geom/BoundingBox ../util/Color ../util/ImageSource ../geom/Location ../util/Logger ../geom/Matrix ../pick/PickedObject ../geom/Position ../shapes/ShapeAttributes ../shapes/SurfacePolygon ../geom/Vec2 ../geom/Vec3".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t,r){c=function(a,c,d){if(!a)throw new b(h.logMessage(h.LEVEL_SEVERE,"TriangleMesh","constructor","missingPositions"));if(1>a.length)throw new b(h.logMessage(h.LEVEL_SEVERE,
    "TriangleMesh","constructor","missingPositions"));if(65536<a.length)throw new b(h.logMessage(h.LEVEL_SEVERE,"TriangleMesh","constructor","Too many positions. Must be fewer than 65537. Use TriangleMesh.split to split the shape."));if(!c)throw new b(h.logMessage(h.LEVEL_SEVERE,"TriangleMesh","constructor","Indices array is null or undefined"));if(3>c.length)throw new b(h.logMessage(h.LEVEL_SEVERE,"TriangleMesh","constructor","Too few indices."));f.call(this,d);this._positions=a;this._indices=c;this.referencePosition=
    this._positions[0]};c.prototype=Object.create(f.prototype);Object.defineProperties(c.prototype,{positions:{get:function(){return this._positions},set:function(a){if(!a)throw new b(h.logMessage(h.LEVEL_SEVERE,"TriangleMesh","positions","missingPositions"));this._positions=a;this.referencePosition=this._positions[0];this.reset()}},indices:{get:function(){return this._indices},set:function(a){if(!a)throw new b(h.logMessage(h.LEVEL_SEVERE,"TriangleMesh","indices","Indices array is null or undefined"));
    this._indices=a;this.meshIndices=null;this.reset()}},outlineIndices:{get:function(){return this._outlineIndices},set:function(a){this._outlineIndices=a;this.meshOutlineIndices=null;this.reset()}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(a){if(a&&a.length!=this._positions.length)throw new b(h.logMessage(h.LEVEL_SEVERE,"TriangleMesh","textureCoordinates","Number of texture coordinates is inconsistent with the currently specified positions."));this._textureCoordinates=
    a;this.reset();this.texCoords=null}}});c.prototype.createSurfaceShape=function(){if(this._outlineIndices){for(var a=[],b=0;b<this._outlineIndices.length;b++)a.push(this._positions[this._outlineIndices[b]]);return new q(a,null)}return null};c.prototype.computeMeshPoints=function(a,b){for(var c=Number.MAX_VALUE,d=a.navigatorState.eyePoint,e=new Float32Array(3*this._positions.length),g=new r(0,0,0),h=0,f,k=0;k<this._positions.length;k++)f=this._positions[k],a.surfacePointForMode(f.latitude,f.longitude,
    f.altitude*this._altitudeScale,this.altitudeMode,g),f=g.distanceToSquared(d),f<c&&(c=f),g.subtract(this.currentData.referencePoint),e[h++]=g[0],e[h++]=g[1],e[h++]=g[2];b.eyeDistance=Math.sqrt(c);return e};c.prototype.computeTexCoords=function(){if(this._textureCoordinates){for(var a=new Float32Array(2*this._textureCoordinates.length),b=0,c=0,d=this._textureCoordinates.length;c<d;c++){var e=this._textureCoordinates[c];a[b++]=e[0];a[b++]=e[1]}return a}return null};c.prototype.computeMeshIndices=function(){for(var a=
    new Uint16Array(this._indices.length),b=0,c=this._indices.length;b<c;b++)a[b]=this._indices[b];return a};c.prototype.computeOutlineIndices=function(){if(this._outlineIndices){for(var a=new Uint16Array(this._outlineIndices.length),b=0;b<this._outlineIndices.length;b++)a[b]=this._outlineIndices[b];return a}return null};c.split=function(a,b,c,d){for(var e=[],g=[],h=[],f=[],k=[],l,m,q=0;q<=b.length;q++){if(q===b.length||65533<e.length&&0===h.length%3){if(0<e.length){e={positions:e,indices:h};c&&(e.textureCoords=
    g);if(d){for(var h=[],p=0;p<d.length;p++)l=d[p],(m=f[l])&&h.push(f[d[p]]);e.outlineIndices=h}k.push(e)}if(q===b.length)break;e=[];h=[];f=[]}l=b[q];m=f[l];m||(m=e.length,f[l]=m,e.push(a[l]),c&&g.push(c[l]));h.push(m)}return k};return c});
define("src/layer/ViewControlsLayer","../geom/Angle ../error/ArgumentError ../layer/Layer ../geom/Location ../util/Logger ../util/Offset ../shapes/ScreenImage ../geom/Vec2 ../util/WWUtil".split(" "),function(f,b,c,a,d,e,g,h,k){k=function(a){if(!a)throw new b(d.logMessage(d.LEVEL_SEVERE,"ViewControlsLayer","constructor","missingWorldWindow"));c.call(this,"View Controls");this.wwd=a;this.placement=new e(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0);this.alignment=new e(WorldWind.OFFSET_FRACTION,
    0,WorldWind.OFFSET_FRACTION,0);this.exaggerationIncrement=.01;this.zoomIncrement=.04;this.tiltIncrement=this.headingIncrement=1;this.fieldOfViewIncrement=.1;this.panIncrement=.001;this._inactiveOpacity=.5;this._activeOpacity=1;a=new e(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0);var f=WorldWind.configuration.baseUrl+"images/view/";this.panControl=new g(a.clone(),f+"view-pan-64x64.png");this.zoomInControl=new g(a.clone(),f+"view-zoom-in-32x32.png");this.zoomOutControl=new g(a.clone(),f+"view-zoom-out-32x32.png");
    this.headingLeftControl=new g(a.clone(),f+"view-heading-left-32x32.png");this.headingRightControl=new g(a.clone(),f+"view-heading-right-32x32.png");this.tiltUpControl=new g(a.clone(),f+"view-pitch-up-32x32.png");this.tiltDownControl=new g(a.clone(),f+"view-pitch-down-32x32.png");this.exaggerationUpControl=new g(a.clone(),f+"view-elevation-up-32x32.png");this.exaggerationDownControl=new g(a.clone(),f+"view-elevation-down-32x32.png");this.fovNarrowControl=new g(a.clone(),f+"view-fov-narrow-32x32.png");
    this.fovWideControl=new g(a.clone(),f+"view-fov-wide-32x32.png");this.fovNarrowControl.enabled=!1;this.fovWideControl.enabled=!1;this.controls=[this.panControl,this.zoomInControl,this.zoomOutControl,this.headingLeftControl,this.headingRightControl,this.tiltUpControl,this.tiltDownControl,this.exaggerationUpControl,this.exaggerationDownControl,this.fovNarrowControl,this.fovWideControl];for(f=0;f<this.controls.length;f++)this.controls[f].imageOffset=a.clone(),this.controls[f].opacity=this._inactiveOpacity,
        this.controls[f].size=this.controls[f]===this.panControl?64:32;this.panControlCenter=new h(0,0);this.pickEnabled=this.isTouchDevice=!1;this.setupInteraction()};k.prototype=Object.create(c.prototype);Object.defineProperties(k.prototype,{showPanControl:{get:function(){return this.panControl.enabled},set:function(a){this.panControl.enabled=a}},showZoomControl:{get:function(){return this.zoomInControl.enabled},set:function(a){this.zoomInControl.enabled=a;this.zoomOutControl.enabled=a}},showHeadingControl:{get:function(){return this.headingLeftControl.enabled},
    set:function(a){this.headingLeftControl.enabled=a;this.headingRightControl.enabled=a}},showTiltControl:{get:function(){return this.tiltUpControl.enabled},set:function(a){this.tiltUpControl.enabled=a;this.tiltDownControl.enabled=a}},showExaggerationControl:{get:function(){return this.exaggerationUpControl.enabled},set:function(a){this.exaggerationUpControl.enabled=a;this.exaggerationDownControl.enabled=a}},showFieldOfViewControl:{get:function(){return this.fovNarrowControl.enabled},set:function(a){this.fovNarrowControl.enabled=
    a;this.fovWideControl.enabled=a}},inactiveOpacity:{get:function(){return this._inactiveOpacity},set:function(a){this._inactiveOpacity=a;for(var b=0;b<this.controls.length;b++)this.controls[b].opacity=a}},activeOpacity:{get:function(){return this._activeOpacity},set:function(a){this._activeOpacity=a;for(var b=0;b<this.controls.length;b++)this.controls[b].opacity=a}}});k.prototype.doRender=function(a){var b=0,c,d;this.inCurrentFrame=!1;this.showPanControl&&(b+=this.panControl.size,this.inCurrentFrame=
    !0);this.showZoomControl&&(b+=this.zoomInControl.size,this.inCurrentFrame=!0);this.showHeadingControl&&(b+=this.headingLeftControl.size,this.inCurrentFrame=!0);this.showTiltControl&&(b+=this.tiltDownControl.size,this.inCurrentFrame=!0);this.showExaggerationControl&&(b+=this.exaggerationDownControl.size,this.inCurrentFrame=!0);this.showFieldOfViewControl&&(b+=this.fovNarrowControl.size,this.inCurrentFrame=!0);d=this.placement.offsetForSize(a.navigatorState.viewport.width,a.navigatorState.viewport.height);
    c=this.alignment.offsetForSize(b,64);b=d[0]-c[0];d=d[1]-c[1];this.showPanControl&&(this.panControl.screenOffset.x=b,this.panControl.screenOffset.y=d,this.panControl.render(a),this.panControlCenter[0]=b+this.panControl.size/2,this.panControlCenter[1]=d+this.panControl.size/2,b+=this.panControl.size);this.showZoomControl&&(this.zoomOutControl.screenOffset.x=b,this.zoomOutControl.screenOffset.y=d,this.zoomInControl.screenOffset.x=b,this.zoomInControl.screenOffset.y=d+this.zoomOutControl.size,this.zoomOutControl.render(a),
        this.zoomInControl.render(a),b+=this.zoomOutControl.size);this.showHeadingControl&&(this.headingRightControl.screenOffset.x=b,this.headingRightControl.screenOffset.y=d,this.headingLeftControl.screenOffset.x=b,this.headingLeftControl.screenOffset.y=d+this.headingLeftControl.size,this.headingRightControl.render(a),this.headingLeftControl.render(a),b+=this.headingLeftControl.size);this.showTiltControl&&(this.tiltDownControl.screenOffset.x=b,this.tiltDownControl.screenOffset.y=d,this.tiltUpControl.screenOffset.x=
        b,this.tiltUpControl.screenOffset.y=d+this.tiltDownControl.size,this.tiltDownControl.render(a),this.tiltUpControl.render(a),b+=this.tiltDownControl.size);this.showExaggerationControl&&(this.exaggerationDownControl.screenOffset.x=b,this.exaggerationDownControl.screenOffset.y=d,this.exaggerationUpControl.screenOffset.x=b,this.exaggerationUpControl.screenOffset.y=d+this.exaggerationDownControl.size,this.exaggerationUpControl.render(a),this.exaggerationDownControl.render(a),b+=this.exaggerationDownControl.size);
    this.showFieldOfViewControl&&(this.fovNarrowControl.screenOffset.x=b,this.fovNarrowControl.screenOffset.y=d,this.fovWideControl.screenOffset.x=b,this.fovWideControl.screenOffset.y=d+this.fovNarrowControl.size,this.fovNarrowControl.render(a),this.fovWideControl.render(a))};k.prototype.setupInteraction=function(){var a=this.wwd,b=this,c=function(c){if(b.enabled&&!b.isTouchDevice){var d,e;b.highlightedControl&&(b.highlight(b.highlightedControl,!1),b.wwd.redraw());c.type&&"mouseup"===c.type&&1===c.which&&
b.activeControl?(b.activeControl=null,b.activeOperation=null,c.preventDefault()):(b.activeOperation?(b.activeOperation.call(b,c,null),c.preventDefault()):(d=b.pickControl(a.canvasCoordinates(c.clientX,c.clientY)),(e=b.determineOperation(c,d))&&e.call(b,c,d)),b.handleHighlight(c,d),b.wwd.redraw())}};a.addEventListener("mousedown",c);a.addEventListener("mouseup",c);a.addEventListener("mousemove",c);window.addEventListener("mouseup",c);window.addEventListener("mousemove",c);c=function(c){this.isTouchDevice=
    !0;if(b.enabled){b.highlightedControl&&(b.highlight(b.highlightedControl,!1),b.wwd.redraw());if(!c.type||"touchend"!==c.type&&"touchcancel"!==c.type)if(b.activeOperation)b.activeOperation.call(b,c,null),c.preventDefault();else{var d;d=c.changedTouches.item(0);var e;d=b.pickControl(a.canvasCoordinates(d.clientX,d.clientY));(e=b.determineOperation(c,d))&&e.call(b,c,d)}else b.activeControl&&b.isCurrentTouch(c)&&(b.activeControl=null,b.activeOperation=null,c.preventDefault());b.handleHighlight(c,d);b.wwd.redraw()}};
    a.addEventListener("touchstart",c);a.addEventListener("touchend",c);a.addEventListener("touchcancel",c);a.addEventListener("touchmove",c)};k.prototype.isControl=function(a){for(var b=0;b<this.controls.length;b++)if(this.controls[b]==a)return!0;return!1};k.prototype.pickControl=function(a){var b=a[0];a=this.wwd.canvas.height-a[1];for(var c,d=0;d<this.controls.length;d++)if(c=this.controls[d],c.enabled&&b>=c.screenOffset.x&&b<=c.screenOffset.x+c.size&&a>=c.screenOffset.y&&a<=c.screenOffset.y+c.size)return c;
    return null};k.prototype.determineOperation=function(a,b){var c=null;if(b&&b instanceof g)if(b===this.panControl)c=this.handlePan;else if(b===this.zoomInControl||b===this.zoomOutControl)c=this.handleZoom;else if(b===this.headingLeftControl||b===this.headingRightControl)c=this.handleHeading;else if(b===this.tiltUpControl||b===this.tiltDownControl)c=this.handleTilt;else if(b===this.exaggerationUpControl||b===this.exaggerationDownControl)c=this.handleExaggeration;else if(b===this.fovNarrowControl||b===
    this.fovWideControl)c=this.handleFov;return c};k.prototype.isCurrentTouch=function(a){for(var b=0;b<a.changedTouches.length;b++)if(a.changedTouches.item(b).identifier===this.currentTouchId)return!0;return!1};k.prototype.handlePan=function(b,c){if("mousedown"===b.type||"mousemove"===b.type)this.currentEventPoint=this.wwd.canvasCoordinates(b.clientX,b.clientY);else if("touchstart"===b.type||"touchmove"===b.type){var d=b.changedTouches.item(0);this.currentEventPoint=this.wwd.canvasCoordinates(d.clientX,
    d.clientY)}if("mousedown"===b.type&&1===b.which||"touchstart"===b.type){this.activeControl=c;this.activeOperation=this.handlePan;b.preventDefault();"touchstart"===b.type&&(this.currentTouchId=b.changedTouches.item(0).identifier);var e=this,g=function(){if(e.activeControl){var b=e.panControlCenter[0]-e.currentEventPoint[0],c=e.panControlCenter[1]-(e.wwd.viewport.height-e.currentEventPoint[1]),d=e.panIncrement*(e.wwd.navigator.range/e.wwd.globe.radiusAt(e.wwd.navigator.lookAtLocation.latitude,e.wwd.navigator.lookAtLocation.longitude));
    a.greatCircleLocation(e.wwd.navigator.lookAtLocation,e.wwd.navigator.heading+Math.atan2(b,c)*f.RADIANS_TO_DEGREES,-(d*Math.sqrt(b*b+c*c)),e.wwd.navigator.lookAtLocation);e.wwd.redraw();setTimeout(g,50)}};setTimeout(g,50)}};k.prototype.handleZoom=function(a,b){if("mousedown"===a.type&&1===a.which||"touchstart"===a.type){this.activeControl=b;this.activeOperation=this.handleZoom;a.preventDefault();"touchstart"===a.type&&(this.currentTouchId=a.changedTouches.item(0).identifier);var c=this,d=function(){c.activeControl&&
(c.activeControl===c.zoomInControl?c.wwd.navigator.range*=1-c.zoomIncrement:c.activeControl===c.zoomOutControl&&(c.wwd.navigator.range*=1+c.zoomIncrement),c.wwd.redraw(),setTimeout(d,50))};setTimeout(d,50)}};k.prototype.handleHeading=function(a,b){if("mousedown"===a.type&&1===a.which||"touchstart"===a.type){this.activeControl=b;this.activeOperation=this.handleHeading;a.preventDefault();"touchstart"===a.type&&(this.currentTouchId=a.changedTouches.item(0).identifier);var c=this,d=function(){c.activeControl&&
(c.activeControl===c.headingLeftControl?c.wwd.navigator.heading+=c.headingIncrement:c.activeControl===c.headingRightControl&&(c.wwd.navigator.heading-=c.headingIncrement),c.wwd.redraw(),setTimeout(d,50))};setTimeout(d,50)}};k.prototype.handleTilt=function(a,b){if("mousedown"===a.type&&1===a.which||"touchstart"===a.type){this.activeControl=b;this.activeOperation=this.handleTilt;a.preventDefault();"touchstart"===a.type&&(this.currentTouchId=a.changedTouches.item(0).identifier);var c=this,d=function(){c.activeControl&&
(c.activeControl===c.tiltUpControl?c.wwd.navigator.tilt=Math.max(0,c.wwd.navigator.tilt-c.tiltIncrement):c.activeControl===c.tiltDownControl&&(c.wwd.navigator.tilt=Math.min(90,c.wwd.navigator.tilt+c.tiltIncrement)),c.wwd.redraw(),setTimeout(d,50))};setTimeout(d,50)}};k.prototype.handleExaggeration=function(a,b){if("mousedown"===a.type&&1===a.which||"touchstart"===a.type){this.activeControl=b;this.activeOperation=this.handleExaggeration;a.preventDefault();"touchstart"===a.type&&(this.currentTouchId=
    a.changedTouches.item(0).identifier);var c=this,d=function(){c.activeControl&&(c.activeControl===c.exaggerationUpControl?c.wwd.verticalExaggeration+=c.exaggerationIncrement:c.activeControl===c.exaggerationDownControl&&(c.wwd.verticalExaggeration=Math.max(1,c.wwd.verticalExaggeration-c.exaggerationIncrement)),c.wwd.redraw(),setTimeout(d,50))};setTimeout(d,50)}};k.prototype.handleFov=function(a,b){if("mousedown"===a.type&&1===a.which||"touchstart"===a.type){this.activeControl=b;this.activeOperation=
    this.handleFov;a.preventDefault();"touchstart"===a.type&&(this.currentTouchId=a.changedTouches.item(0).identifier);var c=this,d=function(){c.activeControl&&(c.activeControl===c.fovWideControl?c.wwd.navigator.fieldOfView=Math.max(90,c.wwd.navigator.fieldOfView+c.fieldOfViewIncrement):c.activeControl===c.fovNarrowControl&&(c.wwd.navigator.fieldOfView=Math.min(0,c.wwd.navigator.fieldOfView-c.fieldOfViewIncrement)),c.wwd.redraw(),setTimeout(d,50))};setTimeout(d,50)}};k.prototype.handleHighlight=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             b){this.activeControl?this.highlight(this.activeControl,!0):b&&this.isControl(b)&&this.highlight(b,!0)};k.prototype.highlight=function(a,b){a.opacity=b?this._activeOpacity:this._inactiveOpacity;this.highlightedControl=b?a:null};return k});
define("src/ogc/WmsLayerCapabilities",["../error/ArgumentError","../util/Logger"],function(f,b){var c=function(a,c){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmsLayerCapabilities","constructor","Layer element is null or undefined."));this.parent=c;this.assembleLayer(a)};Object.defineProperties(c.prototype,{capability:{get:function(){for(var a=this;a&&a instanceof c;)a=a.parent;return a}},queryable:{get:function(){return c.replace(this,"_queryable")}},cascaded:{get:function(){return c.replace(this,
    "_cascaded")}},opaque:{get:function(){return c.replace(this,"_opaque")}},noSubsets:{get:function(){return c.replace(this,"_noSubsets")}},fixedWidth:{get:function(){return c.replace(this,"_fixedWidth")}},fixedHeight:{get:function(){return c.replace(this,"_fixedHeight")}},styles:{get:function(){return c.accumulate(this,"_styles",[])}},crses:{get:function(){return c.accumulate(this,"_crses",[])}},srses:{get:function(){return c.accumulate(this,"_srses",[])}},geographicBoundingBox:{get:function(){return c.replace(this,
    "_geographicBoundingBox")}},latLonBoundingBox:{get:function(){return c.replace(this,"_latLonBoundingBox")}},boundingBoxes:{get:function(){return c.replace(this,"_boundingBoxes")}},dimensions:{get:function(){for(var a=[],b=this;b&&b instanceof c;)b._dimensions&&0<b._dimensions.length&&b._dimensions.forEach(function(b){var c=b.name,d=!0;a.forEach(function(a){a.name===c&&(d=!1)});d&&a.push(b)}),b=b.parent;return 0<a.length?a:void 0}},extents:{get:function(){for(var a=[],b=this;b&&b instanceof c;)b._extents&&
0<b._extents.length&&b._extents.forEach(function(b){var c=b.name,d=!0;a.forEach(function(a){a.name===c&&(d=!1)});d&&a.push(b)}),b=b.parent;return 0<a.length?a:void 0}},attribution:{get:function(){return c.replace(this,"_attribution")}},authorityUrls:{get:function(){return c.accumulate(this,"_authorityUrls",[])}},minScaleDenominator:{get:function(){return c.replace(this,"_minScaleDenominator")}},maxScaleDenominator:{get:function(){return c.replace(this,"_maxScaleDenominator")}},scaleHint:{get:function(){return c.replace(this,
    "_scaleHint")}}});c.accumulate=function(a,b,e){for(;a&&a instanceof c;){var g=a[b];if(g)for(var h=0;h<g.length;h++)e.push(g[h]);a=a.parent}return 0<e.length?e:null};c.replace=function(a,b){for(;a&&a instanceof c;){var e=a[b];if(e)return e;a=a.parent}};c.prototype.assembleLayer=function(a){var b;if(b=a.getAttribute("queryable"))this._queryable="1"===b||"true"===b;if(b=a.getAttribute("opaque"))this._opaque="1"===b||"true"===b;if(b=a.getAttribute("noSubsets"))this._noSubsets="1"===b||"true"===b;if(b=
        a.getAttribute("cascaded"))this._cascaded=10;if(b=a.getAttribute("fixedWidth"))this._fixedWidth=10;if(b=a.getAttribute("fixedHeight"))this._fixedHeight=10;b=a.children||a.childNodes;for(a=0;a<b.length;a++){var e=b[a];if("Layer"===e.localName)this.layers||(this.layers=[]),this.layers.push(new c(e,this));else if("Name"===e.localName)this.name=e.textContent;else if("Title"===e.localName)this.title=e.textContent;else if("Abstract"===e.localName)this["abstract"]=e.textContent;else if("KeywordList"===e.localName){this.keywordList=
    this.keywordList||[];for(var e=e.children||e.childNodes,g=0;g<e.length;g++){var h=e[g];"Keyword"===h.localName&&this.keywordList.push(h.textContent)}}else"Style"===e.localName?(this._styles||(this._styles=[]),this._styles.push(c.assembleStyle(e))):"CRS"===e.localName?(this._crses||(this._crses=[]),this._crses.push(e.textContent)):"SRS"===e.localName?(this._srses||(this._srses=[]),this._srses.push(e.textContent)):"EX_GeographicBoundingBox"===e.localName?this._geographicBoundingBox=c.assembleGeographicBoundingBox(e):
    "LatLonBoundingBox"===e.localName?this._geographicBoundingBox=c.assembleLatLonBoundingBox(e):"BoundingBox"===e.localName?(this._boundingBoxes||(this._boundingBoxes=[]),this._boundingBoxes.push(c.assembleBoundingBox(e))):"Dimension"===e.localName?(this._dimensions||(this._dimensions=[]),this._dimensions.push(c.assembleDimension(e))):"Extent"===e.localName?(this._extents||(this._extents=[]),this._extents.push(c.assembleDimension(e))):"Attribution"===e.localName?this._attribution=c.assembleAttribution(e):
        "AuthorityURL"===e.localName?(this._authorityUrls||(this._authorityUrls=[]),this._authorityUrls.push(c.assembleAuthorityUrl(e))):"Identifier"===e.localName?(this.identifiers||(this.identifiers=[]),this.identifiers.push(c.assembleIdentifier(e))):"MetadataURL"===e.localName?(this.metadataUrls||(this.metadataUrls=[]),this.metadataUrls.push(c.assembleMetadataUrl(e))):"DataURL"===e.localName?(this.dataUrls||(this.dataUrls=[]),this.dataUrls.push(c.assembleUrl(e))):"FeatureListURL"===e.localName?(this.featureListUrls||
        (this.featureListUrls=[]),this.featureListUrls.push(c.assembleUrl(e))):"MinScaleDenominator"===e.localName?this._minScaleDenominator=parseFloat(e.textContent):"MaxScaleDenominator"===e.localName?this._maxScaleDenominator=parseFloat(e.textContent):"ScaleHint"===e.localName&&(this._scaleHint={},this._scaleHint.min=c.getFloatAttribute(e,"min"),this._scaleHint.max=c.getFloatAttribute(e,"max"))}};c.assembleStyle=function(a){var b={};a=a.children||a.childNodes;for(var e=0;e<a.length;e++){var g=a[e];"Name"===
g.localName?b.name=g.textContent:"Title"===g.localName?b.title=g.textContent:"Abstract"===g.localName?b["abstract"]=g.textContent:"LegendURL"===g.localName?(b.legendUrls||(b.legendUrls=[]),b.legendUrls.push(c.assembleLegendUrl(g))):"StyleSheetURL"===g.localName?b.styleSheetUrl=c.assembleUrl(g):"StyleURL"===g.localName&&(b.styleUrl=c.assembleUrl(g))}return b};c.assembleGeographicBoundingBox=function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var g=a[c];"westBoundLongitude"===
g.localName?b.westBoundLongitude=parseFloat(g.textContent):"eastBoundLongitude"===g.localName?b.eastBoundLongitude=parseFloat(g.textContent):"southBoundLatitude"===g.localName?b.southBoundLatitude=parseFloat(g.textContent):"northBoundLatitude"===g.localName&&(b.northBoundLatitude=parseFloat(g.textContent))}return b};c.assembleLatLonBoundingBox=function(a){var b={};b.minx=c.getFloatAttribute(a,"minx");b.miny=c.getFloatAttribute(a,"miny");b.maxx=c.getFloatAttribute(a,"maxx");b.maxy=c.getFloatAttribute(a,
    "maxy");return b};c.assembleBoundingBox=function(a){var b={};b.crs=a.getAttribute("CRS");b.minx=c.getFloatAttribute(a,"minx");b.miny=c.getFloatAttribute(a,"miny");b.maxx=c.getFloatAttribute(a,"maxx");b.maxy=c.getFloatAttribute(a,"maxy");b.resx=c.getFloatAttribute(a,"resx");b.resy=c.getFloatAttribute(a,"resy");return b};c.assembleDimension=function(a){var b={};b.name=a.getAttribute("name");b.units=a.getAttribute("units");b.unitSymbol=a.getAttribute("unitSymbol");b["default"]=a.getAttribute("default");
    b.multipleValues=a.getAttribute("multipleValues");b.multipleValues&&(b.multipleValues="true"===b.multipleValues||"1"===b.multipleValues);b.nearestValue=a.getAttribute("nearestValue");b.nearestValue&&(b.nearestValue="true"===b.nearestValue||"1"===b.nearestValue);b.current=a.getAttribute("current");b.current&&(b.current="true"===b.current||"1"===b.current);b.content=a.textContent;return b};c.assembleAttribution=function(a){var b={};a=a.children||a.childNodes;for(var e=0;e<a.length;e++){var g=a[e];"Title"===
g.localName?b.title=g.textContent:"OnlineResource"===g.localName?b.url=g.getAttribute("xlink:href"):"LogoUrul"===g.localName&&(b.logoUrl=c.assembleLogoUrl(g))}return b};c.assembleAuthorityUrl=function(a){var b={};b.name=a.getAttribute("name");a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var g=a[c];"OnlineResource"===g.localName&&(b.url=g.getAttribute("xlink:href"))}return b};c.assembleIdentifier=function(a){var b={};b.authority=a.getAttribute("authority");b.content=a.textContent;return b};
    c.assembleMetadataUrl=function(a){var b={};b.type=a.getAttribute("type");a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var g=a[c];"Format"===g.localName?b.format=g.textContent:"OnlineResource"===g.localName&&(b.url=g.getAttribute("xlink:href"))}return b};c.assembleLegendUrl=function(a){var b={};b.width=c.getIntegerAttribute(a,"width");b.height=c.getIntegerAttribute(a,"height");a=a.children||a.childNodes;for(var e=0;e<a.length;e++){var g=a[e];"Format"===g.localName?b.format=g.textContent:
    "OnlineResource"===g.localName&&(b.url=g.getAttribute("xlink:href"))}return b};c.assembleLogoUrl=function(a){var b={};b.width=c.getIntegerAttribute(a,"width");b.height=c.getIntegerAttribute(a,"height");a=a.children||a.childNodes;for(var e=0;e<a.length;e++){var g=a[e];"Format"===g.localName?b.format=g.textContent:"OnlineResource"===g.localName&&(b.url=g.getAttribute("xlink:href"))}return b};c.assembleUrl=function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var g=a[c];"Format"===
    g.localName?b.format=g.textContent:"OnlineResource"===g.localName&&(b.url=g.getAttribute("xlink:href"))}return b};c.getIntegerAttribute=function(a,b){var c=a.getAttribute(b);return c=c?parseInt(c):void 0};c.getFloatAttribute=function(a,b){var c=a.getAttribute(b);return c=c?parseFloat(c):void 0};return c});
define("src/ogc/WmsCapabilities",["../error/ArgumentError","../util/Logger","../ogc/WmsLayerCapabilities"],function(f,b,c){var a=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(a)};a.prototype.assembleDocument=function(a){a=a.documentElement;this.version=a.getAttribute("version");this.updateSequence=a.getAttribute("updateSequence");a=a.children||a.childNodes;for(var b=0;b<a.length;b++){var c=a[b];"Service"===
c.localName?this.service=this.assembleService(c):"Capability"===c.localName&&(this.capability=this.assembleCapability(c))}};a.prototype.assembleService=function(a){var b={capsDoc:this};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var h=a[c];"Name"===h.localName?b.name=h.textContent:"Title"===h.localName?b.title=h.textContent:"Abstract"===h.localName?b["abstract"]=h.textContent:"KeywordList"===h.localName?b.keywordList=this.assembleKeywordList(h):"OnlineResource"===h.localName?b.onlineResource=
    h.getAttribute("xlink:href"):"Fees"===h.localName?b.fees=h.textContent:"AccessConstraints"===h.localName?b.accessConstraints=h.textContent:"LayerLimit"==h.localName?b.layerLimit=parseInt(h.textContent):"MaxWidth"==h.localName?b.maxWidth=parseInt(h.textContent):"MaxHeight"==h.localName?b.maxHeight=parseInt(h.textContent):"ContactInformation"===h.localName&&(b.contactInformation=this.assembleContactInformation(h))}return b};a.prototype.assembleKeywordList=function(a){var b=[];a=a.children||a.childNodes;
    for(var c=0;c<a.length;c++){var h=a[c];"Keyword"===h.localName&&b.push(h.textContent)}return b};a.prototype.assembleContactInformation=function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var h=a[c];"ContactPersonPrimary"===h.localName?b.contactPersonPrimary=this.assembleContactPersonPrimary(h):"ContactPosition"===h.localName?b.contactPosition=h.textContent:"ContactVoiceTelephone"===h.localName?b.contactVoiceTelephone=h.textContent:"ContactFacsimileTelephone"===h.localName?
    b.contactFacsimileTelephone=h.textContent:"ContactElectronicMailAddress"===h.localName?b.contactElectronicMailAddress=h.textContent:"ContactAddress"===h.localName&&(b.contactAddress=this.assembleContactAddress(h))}return b};a.prototype.assembleContactPersonPrimary=function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var h=a[c];"ContactPerson"===h.localName?b.contactPerson=h.textContent:"ContactOrganization"===h.localName&&(b.contactOrganization=h.textContent)}return b};a.prototype.assembleContactAddress=
    function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var h=a[c];"AddressType"===h.localName?b.addressType=h.textContent:"Address"===h.localName?b.address=h.textContent:"City"===h.localName?b.city=h.textContent:"StateOrProvince"===h.localName?b.stateOrProvince=h.textContent:"PostCode"===h.localName?b.postCode=h.textContent:"Country"===h.localName&&(b.country=h.textContent)}return b};a.prototype.assembleCapability=function(a){var b={capsDoc:this};a=a.children||a.childNodes;for(var g=
    0;g<a.length;g++){var h=a[g];"Request"===h.localName?b.request=this.assembleRequests(h):"Exception"===h.localName?b.exception=this.assembleException(h):"Layer"===h.localName&&(b.layers=b.layers||[],b.layers.push(new c(h,b)))}return b};a.prototype.assembleRequests=function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var h=a[c];"GetCapabilities"===h.localName?b.getCapabilities=this.assembleRequest(h):"GetMap"===h.localName?b.getMap=this.assembleRequest(h):"GetFeatureInfo"===h.localName&&
(b.getFeatureInfo=this.assembleRequest(h))}return b};a.prototype.assembleRequest=function(a){var b={name:a.localName};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var h=a[c];if("Format"===h.localName)b.formats=b.formats||[],b.formats.push(h.textContent);else if("DCPType"===h.localName)for(var h=h.children||h.childNodes,f=0;f<h.length;f++){var l=h[f];if("HTTP"===l.localName)for(var l=l.children||l.childNodes,m=0;m<l.length;m++){var p=l[m];if("Get"===p.localName)for(var p=p.children||p.childNodes,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   q=0;q<p.length;q++){var t=p[q];"OnlineResource"===t.localName&&(b.url=t.getAttribute("xlink:href"))}}}}return b};a.prototype.assembleException=function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var h=a[c];"Format"===h.localName&&(b.formats=b.formats||[],b.formats.push(h.textContent))}return b};return a});
define("src/layer/WmsLayer","../error/ArgumentError ../geom/Location ../util/Logger ../util/PeriodicTimeSequence ../geom/Sector ../layer/TiledImageLayer ../util/WmsUrlBuilder".split(" "),function(f,b,c,a,d,e,g){var h=function(a,b){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"WmsLayer","constructor","No configuration specified."));var d=a.service+a.layerNames+a.styleNames;b&&(d+=b);e.call(this,a.sector,a.levelZeroDelta,a.numLevels,a.format,d,a.size,a.size);this.displayName=a.title;this.pickEnabled=
    !1;this.urlBuilder=new g(a.service,a.layerNames,a.styleNames,a.version,b);a.coordinateSystem&&(this.urlBuilder.crs=a.coordinateSystem);this.timeString=b};h.prototype=Object.create(e.prototype);h.formLayerConfiguration=function(a){var c={title:a.title,version:a.capability.capsDoc.version},e=a.geographicBoundingBox||a.latLonBoundingBox;c.sector=e&&e.westBoundLongitude?new d(e.southBoundLatitude,e.northBoundLatitude,e.westBoundLongitude,e.eastBoundLongitude):e&&e.minx?new d(e.miny,e.maxy,e.minx,e.maxx):
    d.FULL_SPHERE;c.levelZeroDelta=new b(36,36);c.numLevels=19;c.size=256;c.layerNames=a.name;var e=a.capability.request.getMap,g=e.formats;0<=g.indexOf("image/png")?c.format="image/png":0<=g.indexOf("image/jpeg")?c.format="image/jpeg":0<=g.indexOf("image/tiff")?c.format="image/tiff":0<=g.indexOf("image/gif")&&(c.format="image/gif");c.service=e.url;e=a.crses;e||(e=a.srses);if(e)if(0<=e.indexOf("EPSG:4326")||0<=e.indexOf("epsg:4326"))c.coordinateSystem="EPSG:4326";else if(0<=e.indexOf("CRS84")||0<=e.indexOf("CRS:84"))c.coordinateSystem=
    "CRS:84";(a=h.parseTimeDimensions(a))&&0<a.length&&(c.timeSequences=a);return c};h.parseTimeDimensions=function(b){b=b.extents||b.dimensions;var c=null;if(b)for(var c=[],d=0;d<b.length;d++){var e=b[d];if("time"===e.name.toLowerCase()&&(!e.units||"iso8601"===e.units.toLowerCase()))for(var e=e.content.split(","),g=0;g<e.length;g++){var h=e[g],f=h.split("/");1===f.length?c.push(new Date(h)):3===f.length&&c.push(new a(h))}}return c};return h});
define("src/layer/WmsTimeDimensionedLayer",["../error/ArgumentError","../layer/Layer","../util/Logger","../layer/WmsLayer"],function(f,b,c,a){var d=function(a){if(!a)throw new f(c.logMessage(c.LEVEL_SEVERE,"WmsTimeDimensionedLayer","constructor","No configuration specified."));b.call(this,"WMS Time Dimensioned Layer");this.config=a;this.displayName=a.title;this.pickEnabled=!1;this.layers={}};d.prototype=Object.create(b.prototype);d.prototype.doRender=function(b){if(this.time){var c=this.time.toISOString(),
    d=this.layers[c];d||(d=new a(this.config,c),this.layers[c]=d);d.opacity=this.opacity;d.doRender(b);this.inCurrentFrame=d.inCurrentFrame}};return d});define("src/ogc/OwsLanguageString",["../error/ArgumentError","../util/Logger"],function(f,b){return function(c){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"LanguageString","constructor","missingDomElement"));this.value=c.textContent;if(c=c.getAttribute("lang"))this.lang=c}});
define("src/ogc/OwsConstraint",["../error/ArgumentError","../util/Logger"],function(f,b){return function(c){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"OwsConstraint","constructor","missingDomElement"));this.name=c.getAttribute("name");c=c.children;for(var a=0;a<c.length;a++){var d=c[a];if("AllowedValues"===d.localName){this.allowedValues=this.allowedValues||[];for(var e=0;e<d.children.length;e++)"Value"===d.children[e].localName&&this.allowedValues.push(d.children[e].textContent)}else"AnyValue"===
d.localName?this.anyValue=!0:"NoValues"===d.localName&&(this.noValues=!0)}}});
define("src/ogc/OwsOperationsMetadata",["../error/ArgumentError","../util/Logger","../ogc/OwsConstraint"],function(f,b,c){var a=function(c){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"OwsOperationsMetadata","constructor","missingDomElement"));c=c.children;for(var e=0;e<c.length;e++){var g=c[e];"Operation"===g.localName&&(this.operation=this.operation||[],this.operation.push(a.assembleOperation(g)))}};a.assembleOperation=function(b){var c={};c.name=b.getAttribute("name");b=b.children;for(var g=
    0;g<b.length;g++){var h=b[g];"DCP"===h.localName&&(c.dcp=c.dcp||[],c.dcp.push(a.assembleDcp(h)))}return c};a.assembleDcp=function(b){var c={};b=b.children;for(var g=0;g<b.length;g++){var h=b[g];"HTTP"===h.localName&&(c.http=a.assembleHttp(h))}return c};a.assembleHttp=function(b){var c={};b=b.children;for(var g=0;g<b.length;g++){var h=b[g];"Get"===h.localName&&(c.get=c.get||[],c.get.push(a.assembleGet(h)))}return c};a.assembleGet=function(a){var b={};b.href=a.getAttribute("xlink:href");a=a.children;
    for(var g=0;g<a.length;g++){var h=a[g];"Constraint"===h.localName&&(b.constraint=b.constraint||[],b.constraint.push(new c(h)))}return b};return a});
define("src/ogc/OwsServiceIdentification",["../error/ArgumentError","../util/Logger"],function(f,b){return function(c){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"OwsServiceIdentification","constructor","missingDomElement"));c=c.children;for(var a=0;a<c.length;a++){var d=c[a];"ServiceType"===d.localName?this.serviceType=d.textContent:"ServiceTypeVersion"===d.localName?this.serviceTypeVersion=d.textContent:"Profile"===d.localName?(this.profile=this.profiles||[],this.profile.push(d.textContent)):
    "Title"===d.localName?(this.title=this.title||[],this.title.push(d.textContent)):"Abstract"===d.localName?(this["abstract"]=this.title||[],this["abstract"].push(d.textContent)):"Fees"===d.localName?this.fees=d.textContent:"AccessConstraints"===d.localName&&(this.accessConstraints=this.accessConstraints||[],this.accessConstraints.push(d.textContent))}}});
define("src/ogc/OwsServiceProvider",["../error/ArgumentError","../util/Logger"],function(f,b){return function(c){if(!c)throw new f(b.logMessage(b.LEVEL_SEVERE,"OwsServiceProvider","constructor","missingDomElement"));c=c.children;for(var a=0;a<c.length;a++){var d=c[a];"ProviderName"===d.localName?this.providerName=d.textContent:"ProviderSite"===d.localName&&(this.providerSite=d.getAttribute("xlink:href"))}}});
define("src/ogc/WmtsLayerCapabilities",["../error/ArgumentError","../util/Logger","../ogc/OwsLanguageString","../ogc/WmsCapabilities"],function(f,b,c,a){var d=function(a,c){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmtsLayerCapabilities","constructor","missingDomElement"));this.capabilities=c;this.assembleLayer(a)};d.prototype.assembleLayer=function(a){a=a.children||a.childNodes;for(var b=0;b<a.length;b++){var h=a[b];"Identifier"===h.localName?this.identifier=h.textContent:"Title"===h.localName?
    (this.title=this.title||[],this.title.push(new c(h))):"Abstract"===h.localName?(this["abstract"]=this["abstract"]||[],this["abstract"].push(new c(h))):"WGS84BoundingBox"===h.localName?this.wgs84BoundingBox=d.assembleBoundingBox(h):"BoundingBox"===h.localName?(this.boundingBox=this.boundingBox||[],this.boundingBox.push(d.assembleBoundingBox(h))):"Style"===h.localName?(this.style=this.style||[],this.style.push(d.assembleStyle(h))):"Format"===h.localName?(this.format=this.format||[],this.format.push(h.textContent)):
    "InfoFormat"===h.localName?(this.infoFormat=this.infoFormat||[],this.infoFormat.push(h.textContent)):"Dimension"===h.localName?(this.dimension=this.dimension||[],this.dimension.push(d.assembleDimension(h))):"Metadata"===h.localName?(this.metadata=this.metadata||[],this.metadata.push(d.assembleMetadata(h))):"ResourceURL"===h.localName?(this.resourceUrl=this.resourceUrl||[],this.resourceUrl.push(d.assembleResourceUrl(h))):"TileMatrixSetLink"===h.localName&&(this.tileMatrixSetLink=this.tileMatrixSetLink||
        [],this.tileMatrixSetLink.push(d.assembleTileMatrixSetLink(h)))}};d.assembleStyle=function(a){var b={};b.isDefault=a.getAttribute("isDefault");a=a.children||a.childNodes;for(var h=0;h<a.length;h++){var f=a[h];"Identifier"===f.localName?b.identifier=f.textContent:"Title"===f.localName?(b.title=b.title||[],b.title.push(new c(f))):"Abstract"===f.localName?(b["abstract"]=b["abstract"]||[],b["abstract"].push(new c(f))):"LegendURL"===f.localName&&(b.legendUrl=b.legendUrl||[],b.legendUrl.push(d.assembleLegendUrl(f)))}return b};
    d.assembleBoundingBox=function(a){var b={},c=a.getAttribute("crs");c&&(b.crs=c);a=a.children||a.childNodes;for(c=0;c<a.length;c++){var d=a[c];"LowerCorner"===d.localName?(d=d.textContent.split(" "),b.lowerCorner=[parseFloat(d[0]),parseFloat(d[1])]):"UpperCorner"===d.localName&&(d=d.textContent.split(" "),b.upperCorner=[parseFloat(d[0]),parseFloat(d[1])])}return b};d.assembleDimension=function(a){var b={};a=a.children||a.childNodes;for(var d=0;d<a.length;d++){var f=a[d];"Identifier"===f.localName?
        b.identifier=f.textContent:"Title"===f.localName?(b.title=b.title||[],b.title.push(new c(f))):"Abstract"===f.localName?(b["abstract"]=b["abstract"]||[],b["abstract"].push(new c(f))):"UOM"===f.localName?b.uom={name:f.getAttribute("name"),reference:f.getAttribute("reference")}:"UnitSymbol"==f.localName?b.unitSymbol=f.textContent:"Default"===f.localName?b["default"]=f.textContent:"Current"===f.localName?b.current="true"===f.textContent:"Value"===f.localName&&(b.value=b.value||[],b.value.push(f.textContent))}return b};
    d.assembleMetadata=function(a){return{}};d.assembleResourceUrl=function(a){var b={};b.format=a.getAttribute("format");b.resourceType=a.getAttribute("resourceType");b.template=a.getAttribute("template");return b};d.assembleLegendUrl=function(a){var b={};b.format=a.getAttribute("format");b.minScaleDenominator=a.getAttribute("minScaleDenominator");b.maxScaleDenominator=a.getAttribute("maxScaleDenominator");b.href=a.getAttribute("xlink:href");b.width=a.getAttribute("width");b.height=a.getAttribute("height");
        return b};d.assembleTileMatrixSetLink=function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var f=a[c];"TileMatrixSet"===f.localName?b.tileMatrixSet=f.textContent:"TileMatrixSetLimits"===f.localName&&(b.tileMatrixSetLimits=d.assembleTileMatrixSetLimits(f))}return b};d.assembleTileMatrixSetLimits=function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var f=a[c];"TileMatrixLimits"===f.localName&&(b.tileMatrixLimits=b.tileMatrixLimits||[],b.tileMatrixLimits.push(d.assembleTileMatrixLimits(f)))}return b};
    d.assembleTileMatrixLimits=function(a){var b={};a=a.children||a.childNodes;for(var c=0;c<a.length;c++){var d=a[c];"TileMatrix"===d.localName?b.tileMatrix=d.textContent:"MinTileRow"===d.localName?b.minTileRow=parseInt(d.textContent):"MaxTileRow"===d.localName?b.maxTileRow=parseInt(d.textContent):"MinTileCol"===d.localName?b.minTileCol=parseInt(d.textContent):"maxTileCol"===d.localName&&(b.maxTileCol=parseInt(d.textContent))}return b};return d});
define("src/ogc/WmtsCapabilities","../error/ArgumentError ../util/Logger ../ogc/OwsLanguageString ../ogc/OwsOperationsMetadata ../ogc/OwsServiceIdentification ../ogc/OwsServiceProvider ../ogc/WmsCapabilities ../ogc/WmtsLayerCapabilities".split(" "),function(f,b,c,a,d,e,g,h){var k=function(a){if(!a)throw new f(b.logMessage(b.LEVEL_SEVERE,"WmtsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(a)};k.prototype.assembleDocument=function(b){b=b.documentElement;this.version=b.getAttribute("version");
    this.updateSequence=b.getAttribute("updateSequence");b=b.children||b.childNodes;for(var c=0;c<b.length;c++){var g=b[c];"ServiceIdentification"===g.localName?this.serviceIdentification=new d(g):"ServiceProvider"===g.localName?this.serviceProvider=new e(g):"OperationsMetadata"===g.localName?this.operationsMetadata=new a(g):"Contents"===g.localName&&(this.contents=this.assembleContents(g))}this.resolveTileMatrixSetLinks()};k.prototype.assembleContents=function(a){var c={};a=a.children||a.childNodes;
    for(var d=0;d<a.length;d++){var e=a[d];if("Layer"===e.localName){c.layer=c.layer||[];try{c.layer.push(new h(e,this))}catch(g){b.logMessage(b.LEVEL_SEVERE,"WmtsCapabilities","constructor","Exception reading WMTS layer description: "+g.message)}}else if("TileMatrixSet"===e.localName){c.tileMatrixSet=c.tileMatrixSet||[];try{c.tileMatrixSet.push(k.assembleTileMatrixSet(e))}catch(g){b.logMessage(b.LEVEL_SEVERE,"WmtsCapabilities","constructor","Exception reading WMTS tile matrix set description: "+g.message)}}}return c};
    k.assembleTileMatrixSet=function(a){var b={};a=a.children||a.childNodes;for(var d=0;d<a.length;d++){var e=a[d];"Identifier"===e.localName?b.identifier=e.textContent:"SupportedCRS"===e.localName?b.supportedCRS=e.textContent:"WellKnownScaleSet"===e.localName?b.wellKnownScaleSet=e.textContent:"BoundingBox"===e.localName?b.boundingBox=h.assembleBoundingBox(e):"TileMatrix"===e.localName?(b.tileMatrix=b.tileMatrix||[],b.tileMatrix.push(k.assembleTileMatrix(e))):"Title"===e.localName?(b.title=b.title||[],
        b.title.push(new c(e))):"Abstract"===e.localName&&(b["abstract"]=b["abstract"]||[],b["abstract"].push(new c(e)))}for(a=0;a<b.tileMatrix.length;a++)b.tileMatrix[a].levelNumber=a;return b};k.assembleTileMatrix=function(a){var b={};a=a.children||a.childNodes;for(var d=0;d<a.length;d++){var e=a[d];"Identifier"===e.localName?b.identifier=e.textContent:"Title"===e.localName?(b.title=tileMatrixSet.title||[],b.title.push(new c(e))):"Abstract"===e.localName?(b["abstract"]=tileMatrixSet["abstract"]||[],b["abstract"].push(new c(e))):
        "ScaleDenominator"===e.localName?b.scaleDenominator=parseFloat(e.textContent):"TileWidth"===e.localName?b.tileWidth=parseFloat(e.textContent):"TileHeight"===e.localName?b.tileHeight=parseFloat(e.textContent):"MatrixWidth"===e.localName?b.matrixWidth=parseFloat(e.textContent):"MatrixHeight"===e.localName?b.matrixHeight=parseFloat(e.textContent):"TopLeftCorner"===e.localName&&(e=e.textContent.split(" "),b.topLeftCorner=[parseFloat(e[0]),parseFloat(e[1])])}return b};k.prototype.resolveTileMatrixSetLinks=
        function(){for(var a=0;a<this.contents.layer.length;a++)for(var b=this.contents.layer[a],c=0;c<b.tileMatrixSetLink.length;c++)for(var d=b.tileMatrixSetLink[c],e=0;e<this.contents.tileMatrixSet.length;e++)if(this.contents.tileMatrixSet[e].identifier===d.tileMatrixSet){d.tileMatrixSetRef=this.contents.tileMatrixSet[e];break}};k.prototype.getGetTileKvpAddress=function(){for(var a=0;a<this.operationsMetadata.operation.length;a++){var b=this.operationsMetadata.operation[a];if("GetTile"===b.name)return b.dcp[0].http.get[0].href}return null};
    return k});
define("src/layer/WmtsLayerTile","../geom/Angle ../error/ArgumentError ../geom/BoundingBox ../util/Logger ../geom/Vec3 ../util/WWUtil".split(" "),function(f,b,c,a,d,e){var g=function(a,b,c,d,e){this.sector=a;this.tileMatrix=b;this.row=c;this.column=d;this.imagePath=e;this.texelSize=a.deltaLatitude()*f.DEGREES_TO_RADIANS/b.tileHeight;this.tileKey=b.levelNumber.toString()+"."+c.toString()+"."+d.toString();this.gpuCacheKey=e};g.prototype.isEqual=function(a){return a&&a.tileKey?this.tileKey==a.tileKey:
    !1};g.prototype.distanceTo=function(c){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"Tile","distanceTo","missingVector"));var d=c[0],e=c[1];c=c[2];for(var g,f,q,t=this.samplePoints,r=Number.POSITIVE_INFINITY,u=0,w=t.length;u<w;u+=3)g=d-t[u],f=e-t[u+1],q=c-t[u+2],r=Math.min(r,g*g+f*f+q*q);return Math.sqrt(r)};g.prototype.subdivide=function(c,d){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,"WmtsLayerTile","subdivide","The specified tile matrix is null or undefined."));if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "WmtsLayerTile","subdivide","The specified tile factory is null or undefined."));var e,g,f,q,t=[];e=c.matrixHeight/this.tileMatrix.matrixHeight;g=c.matrixWidth/this.tileMatrix.matrixWidth;f=e*this.row;q=g*this.column;t.push(d.createTile(c,f,q));f=e*this.row;q=g*this.column+1;t.push(d.createTile(c,f,q));f=e*this.row+1;q=g*this.column;t.push(d.createTile(c,f,q));f=e*this.row+1;q=g*this.column+1;t.push(d.createTile(c,f,q));return t};g.prototype.subdivideToCache=function(c,d,e){if(!c)throw new b(a.logMessage(a.LEVEL_SEVERE,
    "Tile","subdivideToCache","The specified tile matrix is null or undefined."));if(!d)throw new b(a.logMessage(a.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile factory is null or undefined."));var g=e?e.entryForKey(this.tileKey):null;g||(g=this.subdivide(c,d))&&e&&e.putEntry(this.tileKey,g,g.length);return g};g.prototype.mustSubdivide=function(a,b){var c=a.globe.equatorialRadius*this.texelSize,d=this.distanceTo(a.navigatorState.eyePoint),d=a.navigatorState.pixelSizeAtDistance(d);return c>
    Math.max(b*d,.5)};g.prototype.update=function(a){var b=a.globe.elevationTimestamp(),c=a.verticalExaggeration,d=a.globeStateKey;if(this.updateTimestamp!=b||this.updateVerticalExaggeration!=c||this.updateGlobeStateKey!=d)this.doUpdate(a),a.frameStatistics.incrementTileUpdateCount(1),this.updateTimestamp=b,this.updateVerticalExaggeration=c,this.updateGlobeStateKey=d};g.prototype.doUpdate=function(a){var b=a.globe,g=a.verticalExaggeration,f=b.minAndMaxElevationsForSector(this.sector);a=f?f[0]*g:0;g=f?
f[1]*g:0;a==g&&(a=g+10);this.extent||(this.extent=new c);this.extent.setToSector(this.sector,b,a,g);this.samplePoints||(this.sampleElevations=new Float64Array(9),this.samplePoints=new Float64Array(3*this.sampleElevations.length));e.fillArray(this.sampleElevations,.5*(a+g));b.computePointsForGrid(this.sector,3,3,this.sampleElevations,d.ZERO,this.samplePoints);this.referencePoint||(this.referencePoint=new d(0,0,0));b.computePointFromPosition(this.sector.centroidLatitude(),this.sector.centroidLongitude(),
    0,this.referencePoint)};g.prototype.bind=function(a){var b=a.gpuResourceCache.resourceForKey(this.gpuCacheKey);return b&&b.bind(a)?!0:this.fallbackTile?this.fallbackTile.bind(a):!1};g.prototype.applyInternalTransform=function(a,b){};return g});
define("src/layer/WmtsLayer","../util/AbsentResourceList ../error/ArgumentError ../util/Logger ../geom/Sector ../layer/Layer ../cache/MemoryCache ../render/Texture ../util/WmsUrlBuilder ../layer/WmtsLayerTile ../util/WWMath ../util/WWUtil".split(" "),function(f,b,c,a,d,e,g,h,k,l,m){var p=function(g,k,l){if(!g)throw new b(c.logMessage(c.LEVEL_SEVERE,"WmtsLayer","constructor","No layer configuration specified."));d.call(this,"WMTS Layer");this.layerIdentifier=g.identifier;this.styleIdentifier=k;this.timeString=
    l;k=g.format;0<=k.indexOf("image/png")?this.imageFormat="image/png":0<=k.indexOf("image/jpeg")?this.imageFormat="image/jpeg":0<=k.indexOf("image/tiff")?this.imageFormat="image/tiff":0<=k.indexOf("image/gif")?this.imageFormat="image/gif":this.imageFormat=k[0];if(!this.imageFormat)throw new b(c.logMessage(c.LEVEL_SEVERE,"WmtsLayer","constructor","Layer does not provide a supported image format."));if(g.resourceUrl&&1<g.resourceUrl.length)for(k=0;k<g.resourceUrl.length;k++){if(this.imageFormat===g.resourceUrl[k].format){this.resourceUrl=
    g.resourceUrl[k].template;break}}else if(this.serviceUrl=g.capabilities.getGetTileKvpAddress())this.serviceUrl=h.fixGetMapString(this.serviceUrl);if(!this.resourceUrl&&!this.serviceUrl)throw new b(c.logMessage(c.LEVEL_SEVERE,"WmtsLayer","constructor","No resource URL or KVP GetTile service URL specified in WMTS capabilities."));if(this.styleIdentifier){var m=!1;for(k=0;k<g.style.length;k++)if(g.style[k].identifier===this.styleIdentifier){m=!0;break}m||(c.logMessage(c.LEVEL_WARNING,"WmtsLayer","constructor",
    "The specified style identifier is not available. The server's default style will be used."),this.styleIdentifier=null)}if(!this.styleIdentifier)for(k=0;k<g.style.length;k++)if(g.style[k].isDefault){this.styleIdentifier=g.style[k].identifier;break}this.styleIdentifier||c.logMessage(c.LEVEL_WARNING,"WmtsLayer","constructor","No default style available. A style will not be specified in tile requests.");var w=null,x=null;for(k=0;k<g.tileMatrixSetLink.length;k++)m=g.tileMatrixSetLink[k].tileMatrixSetRef,
    p.isEpsg4326Crs(m.supportedCRS)?w=w||m:p.isEpsg3857Crs(m.supportedCRS)&&(x=x||m);this.tileMatrixSet=w||x;if(!this.tileMatrixSet)throw new b(c.logMessage(c.LEVEL_SEVERE,"WmtsLayer","constructor","No supported Tile Matrix Set could be found."));if(g.wgs84BoundingBox)this.sector=new a(g.wgs84BoundingBox.lowerCorner[1],g.wgs84BoundingBox.upperCorner[1],g.wgs84BoundingBox.lowerCorner[0],g.wgs84BoundingBox.upperCorner[0]);else if(this.tileMatrixSet.boundingBox&&WmtsLayerCapabilities.isEpsg4326Crs(this.tileMatrixSet.boundingBox.crs))this.sector=
    new a(this.tileMatrixSet.boundingBox.lowerCorner[1],this.tileMatrixSet.boundingBox.upperCorner[1],this.tileMatrixSet.boundingBox.lowerCorner[0],this.tileMatrixSet.boundingBox.upperCorner[0]);else if(WmtsLayerCapabilities.isEpsg4326Crs(this.tileMatrixSet.supportedCRS))throw new b(c.logMessage(c.LEVEL_SEVERE,"WmtsLayer","constructor","No EPSG:4326 bounding box was specified in the layer or tile matrix set capabilities."));this.cachePath=(this.resourceUrl||this.serviceUrl)+this.layerIdentifier+this.styleIdentifier+
    this.tileMatrixSet.identifier;l&&(this.cachePath+=l);this.displayName=0<g.title.length?g.title[0].value:g.identifier;this.currentTiles=[];this.currentTilesInvalid=!0;this.tileCache=new e(500,400);this.currentRetrievals=[];this.absentResourceList=new f(3,5E4);this.pickEnabled=!1;this.detailControl=1.75};p.prototype=Object.create(d.prototype);p.prototype.doRender=function(a){a.terrain&&(!this.currentTilesInvalid&&this.lasTtMVP&&a.navigatorState.modelviewProjection.equals(this.lasTtMVP)&&a.globeStateKey==
this.lastGlobeStateKey||(this.currentTilesInvalid=!1,this.assembleTiles(a)),this.lasTtMVP=a.navigatorState.modelviewProjection,this.lastGlobeStateKey=a.globeStateKey,0<this.currentTiles.length&&(a.surfaceTileRenderer.renderTiles(a,this.currentTiles,this.opacity),a.frameStatistics.incrementImageTileCount(this.currentTiles.length),this.inCurrentFrame=!0))};p.prototype.isLayerInView=function(a){return a.terrain&&a.terrain.sector&&a.terrain.sector.intersects(this.sector)};p.prototype.isTileVisible=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b){return a.globe.projectionLimits&&!b.sector.overlaps(a.globe.projectionLimits)?!1:b.extent.intersectsFrustum(a.navigatorState.frustumInModelCoordinates)};p.prototype.assembleTiles=function(a){this.currentTiles=[];this.topLevelTiles&&0!==this.topLevelTiles.length||this.createTopLevelTiles(a);for(var b=0,c=this.topLevelTiles.length;b<c;b++){var d=this.topLevelTiles[b];d.update(a);this.currentAncestorTile=null;this.isTileVisible(a,d)&&this.addTileOrDescendants(a,d)}};p.prototype.addTileOrDescendants=
    function(a,b){if(this.tileMeetsRenderingCriteria(a,b))this.addTile(a,b);else{var c=null;try{if(this.isTileTextureInMemory(a,b)||0===b.tileMatrix.levelNumber)c=this.currentAncestorTile,this.currentAncestorTile=b;for(var d=b.subdivideToCache(this.tileMatrixSet.tileMatrix[b.tileMatrix.levelNumber+1],this,this.tileCache),e=0,g=d.length;e<g;e++){var h=d[e];h.update(a);this.sector.intersects(h.sector)&&this.isTileVisible(a,h)&&this.addTileOrDescendants(a,h)}}finally{c&&(this.currentAncestorTile=c)}}};p.prototype.addTile=
    function(a,b){b.fallbackTile=null;var c=a.gpuResourceCache.resourceForKey(b.imagePath);c?(this.currentTiles.push(b),this.expiration&&this.isTextureExpired(c)&&this.retrieveTileImage(a,b)):(this.retrieveTileImage(a,b),this.currentAncestorTile&&this.isTileTextureInMemory(a,this.currentAncestorTile)&&this.currentTiles.push(this.currentAncestorTile))};p.prototype.isTextureExpired=function(a){return this.expiration&&a.creationTime.getTime()<=this.expiration.getTime()};p.prototype.isTileTextureInMemory=
    function(a,b){return a.gpuResourceCache.containsResource(b.imagePath)};p.prototype.tileMeetsRenderingCriteria=function(a,b){var c=this.detailControl;if(75<=b.sector.minLatitude||-75>=b.sector.maxLatitude)c*=1.2;return b.tileMatrix.levelNumber===this.tileMatrixSet.tileMatrix.length-1||!b.mustSubdivide(a,c)};p.prototype.retrieveTileImage=function(a,b){if(0>this.currentRetrievals.indexOf(b.imagePath)&&!this.absentResourceList.isResourceAbsent(b.imagePath)){var d=this.resourceUrlForTile(b,this.imageFormat),
    e=new Image,g=b.imagePath,h=a.gpuResourceCache,f=a.currentGlContext.canvas,k=this;d?(e.onload=function(){c.log(c.LEVEL_INFO,"Image retrieval succeeded: "+d);var l=k.createTexture(a,b,e);k.removeFromCurrentRetrievals(g);l&&(h.putResource(g,l,l.size),k.currentTilesInvalid=!0,k.absentResourceList.unmarkResourceAbsent(g),l=document.createEvent("Event"),l.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),f.dispatchEvent(l))},e.onerror=function(){k.removeFromCurrentRetrievals(g);k.absentResourceList.markResourceAbsent(g);
    c.log(c.LEVEL_WARNING,"Image retrieval failed: "+d)},this.currentRetrievals.push(g),e.crossOrigin="anonymous",e.src=d):this.currentTilesInvalid=!0}};p.prototype.resourceUrlForTile=function(a,b){var c;this.resourceUrl?(c=this.resourceUrl.replace("{Style}",this.styleIdentifier).replace("{TileMatrixSet}",this.tileMatrixSet.identifier).replace("{TileMatrix}",a.tileMatrix.identifier).replace("{TileCol}",a.column).replace("{TileRow}",a.row),this.timeString&&c.replace("{Time}",this.timeString)):(c=this.serviceUrl+
    "service=WMTS&request=GetTile&version=1.0.0",c+="&Layer="+this.layerIdentifier,this.styleIdentifier&&(c+="&Style="+this.styleIdentifier),c+="&Format="+b,this.timeString&&(c+="&Time="+this.timeString),c+="&TileMatrixSet="+this.tileMatrixSet.identifier,c+="&TileMatrix="+a.tileMatrix.identifier,c+="&TileRow="+a.row,c+="&TileCol="+a.column);return c};p.prototype.removeFromCurrentRetrievals=function(a){a=this.currentRetrievals.indexOf(a);-1<a&&this.currentRetrievals.splice(a,1)};p.prototype.createTopLevelTiles=
    function(a){a=this.tileMatrixSet.tileMatrix[0];this.topLevelTiles=[];for(var b=0;b<a.matrixHeight;b++)for(var c=0;c<a.matrixWidth;c++)this.topLevelTiles.push(this.createTile(a,b,c))};p.prototype.createTile=function(a,b,c){if(p.isEpsg4326Crs(this.tileMatrixSet.supportedCRS))return this.createTile4326(a,b,c);if(p.isEpsg3857Crs(this.tileMatrixSet.supportedCRS))return this.createTile3857(a,b,c)};p.prototype.createTile4326=function(b,c,d){var e=this.sector.deltaLatitude()/b.matrixHeight,g=this.sector.deltaLongitude()/
    b.matrixWidth,h=b.topLeftCorner[0]-c*e,f=b.topLeftCorner[1]+g*d,e=new a(h-e,h,f,f+g);return this.makeTile(e,b,c,d)};p.prototype.createTile3857=function(b,c,d){b.mapWidth||this.computeTileMatrixValues3857(b);var e=l.clamp(d*b.tileWidth-.5,0,b.mapWidth),g=l.clamp(c*b.tileHeight-.5,0,b.mapHeight),h=l.clamp(e+b.tileWidth+.5,0,b.mapWidth),f=l.clamp(g+b.tileHeight+.5,0,b.mapHeight),k,e=e/b.mapWidth;k=f/b.mapHeight;f=l.epsg3857ToEpsg4326(b.topLeftCorner[0]+e*b.tileMatrixDeltaX,b.topLeftCorner[1]-k*b.tileMatrixDeltaY);
    e=h/b.mapWidth;k=g/b.mapHeight;g=l.epsg3857ToEpsg4326(b.topLeftCorner[0]+e*b.tileMatrixDeltaX,b.topLeftCorner[1]-k*b.tileMatrixDeltaY);g=new a(f[0],g[0],f[1],g[1]);return this.makeTile(g,b,c,d)};p.prototype.computeTileMatrixValues3857=function(a){var b=2.8E-4*a.scaleDenominator,b=[a.topLeftCorner[0]+a.tileWidth*b*a.matrixWidth,a.topLeftCorner[1]-a.tileHeight*b*a.matrixHeight],c=a.topLeftCorner;a.tileMatrixDeltaX=b[0]-c[0];a.tileMatrixDeltaY=c[1]-b[1];a.mapWidth=a.tileWidth*a.matrixWidth;a.mapHeight=
    a.tileHeight*a.matrixHeight};p.prototype.makeTile=function(a,b,c,d){var e=this.cachePath+"-layer/"+b.identifier+"/"+c+"/"+d+"."+m.suffixForMimeType(this.imageFormat);return new k(a,b,c,d,e)};p.prototype.createTexture=function(a,b,c){if(p.isEpsg4326Crs(this.tileMatrixSet.supportedCRS))return new g(a.currentGlContext,c);if(p.isEpsg3857Crs(this.tileMatrixSet.supportedCRS))return this.createTexture3857(a,b,c)};p.prototype.createTexture3857=function(a,b,c){this.destCanvas||(this.destCanvas=document.createElement("canvas"),
    this.destContext=this.destCanvas.getContext("2d"));var d=a.canvas2D,e=a.ctx2D,h=this.destCanvas,f=this.destContext,k=f.createImageData(c.width,c.height);b=b.sector;var m=l.gudermannianInverse(b.minLatitude),p=l.gudermannianInverse(b.maxLatitude),G,D,y;d.width=c.width;d.height=c.height;h.width=c.width;h.height=c.height;e.drawImage(c,0,0,c.width,c.height);d=e.getImageData(0,0,c.width,c.height);for(e=0;1>e;e++)for(var H=0;H<c.height;H++){G=1-H/(c.height-1);G=G*b.deltaLatitude()+b.minLatitude;G=l.gudermannianInverse(G);
    G=1-(G-m)/(p-m);G=l.clamp(G,0,1);G=Math.floor(G*(c.height-1));for(var C=0;C<c.width;C++)D=4*(C+G*c.width),y=4*(C+H*c.width),k.data[y]=d.data[D],k.data[y+1]=d.data[D+1],k.data[y+2]=d.data[D+2],k.data[y+3]=d.data[D+3]}f.putImageData(k,0,0);return new g(a.currentGlContext,h)};p.isEpsg4326Crs=function(a){return 0<=a.indexOf("EPSG")&&0<=a.indexOf("4326")};p.isEpsg3857Crs=function(a){return 0<=a.indexOf("EPSG")&&(0<=a.indexOf("3857")||0<=a.indexOf("900913"))};return p});
define("src/WorldWindow","./error/ArgumentError ./render/DrawContext ./globe/EarthElevationModel ./util/FrameStatistics ./globe/Globe ./globe/Globe2D ./util/GoToAnimator ./cache/GpuResourceCache ./util/Logger ./navigate/LookAtNavigator ./navigate/NavigatorState ./pick/PickedObjectList ./geom/Rectangle ./geom/Sector ./shapes/SurfaceShape ./shapes/SurfaceShapeTileBuilder ./globe/Terrain ./geom/Vec2".split(" "),function(f,b,c,a,d,e,g,h,k,l,m,p,q,t,r,u,w,x){e=function(e,h){function m(a){t.handleRedrawEvent(a)}
    if(!window.WebGLRenderingContext)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow","constructor","The specified canvas does not support WebGL."));var p=document.getElementById(e);if(!p)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow","constructor","The specified canvas name is not in the document."));var r=this.createContext(p);this.drawContext=new b(r);this.eventListeners={};this.redrawRequested=!0;this.redrawRequestId=null;this.canvas=p;this.depthBits=r.getParameter(r.DEPTH_BITS);this.viewport=
        new q(0,0,r.drawingBufferWidth,r.drawingBufferHeight);this.globe=new d(h||new c);this.layers=[];this.navigator=new l(this);this.verticalExaggeration=1;this.subsurfaceMode=this.deepPicking=!1;this.surfaceOpacity=1;this.frameStatistics=new a;this.goToAnimator=new g(this);this._redrawCallbacks=[];this._orderedRenderingFilters=[function(a){t.declutter(a,1)},function(a){t.declutter(a,2)}];this.pixelScale=1;var t=this;this.canvas.addEventListener("webglcontextlost",function(a){t.handleContextLost(a)},!1);
    this.canvas.addEventListener("webglcontextrestored",function(a){t.handleContextRestored(a)},!1);this.canvas.addEventListener(WorldWind.REDRAW_EVENT_TYPE,m,!1);window.addEventListener(WorldWind.REDRAW_EVENT_TYPE,m,!1);this.animationFrameLoop()};Object.defineProperties(e.prototype,{orderedRenderingFilters:{get:function(){return this._orderedRenderingFilters}},redrawCallbacks:{get:function(){return this._redrawCallbacks}}});e.prototype.canvasCoordinates=function(a,b){var c=this.canvas.getBoundingClientRect();
    return new x(a-(c.left+this.canvas.clientLeft),b-(c.top+this.canvas.clientTop))};e.prototype.addEventListener=function(a,b){if(!a)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow","addEventListener","missingType"));if(!b)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow","addEventListener","missingListener"));var c=this,d=this.eventListeners[a];d||(d={listeners:[],callback:function(a){a.worldWindow=c;for(var b=0,e=d.listeners.length;b<e;b++)d.listeners[b](a)}},this.eventListeners[a]=d);-1==
d.listeners.indexOf(b)&&(d.listeners.splice(0,0,b),1==d.listeners.length&&this.canvas.addEventListener(a,d.callback,!1))};e.prototype.removeEventListener=function(a,b){if(!a)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingType"));if(!b)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingListener"));var c=this.eventListeners[a];if(c){var d=c.listeners.indexOf(b);-1!=d&&(c.listeners.splice(d,1),0==c.listeners.length&&this.canvas.removeEventListener(a,
    c.callback,!1))}};e.prototype.redraw=function(){this.redrawRequested=!0};e.prototype.pick=function(a){if(!a)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow","pick","missingPoint"));if(this.drawContext.currentGlContext.isContextLost())return new p;this.resize();this.resetDrawContext();this.drawContext.pickingMode=!0;this.drawContext.pickPoint=a;this.drawFrame();return this.drawContext.objectsAtPickPoint};e.prototype.pickTerrain=function(a){if(!a)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow",
    "pickTerrain","missingPoint"));if(this.drawContext.currentGlContext.isContextLost())return new p;this.resize();this.resetDrawContext();this.drawContext.pickingMode=!0;this.drawContext.pickTerrainOnly=!0;this.drawContext.pickPoint=a;this.drawFrame();return this.drawContext.objectsAtPickPoint};e.prototype.pickShapesInRegion=function(a){if(!a)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow","pickShapesInRegion","missingRectangle"));if(this.drawContext.currentGlContext.isContextLost())return new p;
    this.resize();this.resetDrawContext();this.drawContext.pickingMode=!0;this.drawContext.regionPicking=!0;this.drawContext.pickRectangle=new q(a.x,this.canvas.height-a.y,a.width,a.height);this.drawFrame();return this.drawContext.objectsAtPickPoint};e.prototype.createContext=function(a){var b={antialias:!1,stencil:!0},c=a.getContext("webgl",b);c||(c=a.getContext("experimental-webgl",b));this.hasStencilBuffer=c.getContextAttributes().stencil;return c};e.prototype.handleContextLost=function(a){k.log(k.LEVEL_INFO,
    "WebGL context event: "+a.statusMessage);a.preventDefault();this.drawContext.contextLost();window.cancelAnimationFrame(this.redrawRequestId)};e.prototype.handleContextRestored=function(a){k.log(k.LEVEL_INFO,"WebGL context event: "+a.statusMessage);this.drawContext.contextRestored();this.redraw();this.animationFrameLoop()};e.prototype.handleRedrawEvent=function(a){this.redraw()};e.prototype.animationFrameLoop=function(){this.redrawIfNeeded();var a=this;this.redrawRequestId=window.requestAnimationFrame(function(){a.animationFrameLoop()})};
    e.prototype.redrawIfNeeded=function(){this.resize();if(this.redrawRequested)try{this.redrawRequested=!1,this.drawContext.previousRedrawTimestamp=this.drawContext.timestamp,this.callRedrawCallbacks(WorldWind.BEFORE_REDRAW),this.resetDrawContext(),this.drawFrame()}catch(a){k.logMessage(k.LEVEL_SEVERE,"WorldWindow","redrawIfNeeded","Exception occurred during redrawing.\n"+a.toString())}finally{this.callRedrawCallbacks(WorldWind.AFTER_REDRAW),this.drawContext.redrawRequested&&(this.redrawRequested=!0)}};
    e.prototype.resize=function(){var a=this.drawContext.currentGlContext,b=a.canvas.clientWidth*this.pixelScale,c=a.canvas.clientHeight*this.pixelScale;if(a.canvas.width!=b||a.canvas.height!=c)a.canvas.width=b,a.canvas.height=c,a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),this.viewport=new q(0,0,a.drawingBufferWidth,a.drawingBufferHeight),this.redrawRequested=!0};e.prototype.resetDrawContext=function(){this.globe.offset=0;var a=this.drawContext;a.reset();a.globe=this.globe;a.layers=this.layers;
        a.navigatorState=this.navigator.currentState();a.verticalExaggeration=this.verticalExaggeration;a.surfaceOpacity=this.surfaceOpacity;a.deepPicking=this.deepPicking;a.frameStatistics=this.frameStatistics;a.pixelScale=this.pixelScale;a.update()};e.prototype.drawFrame=function(){try{this.drawContext.frameStatistics.beginFrame(),this.beginFrame(),this.drawContext.globe.is2D()&&this.drawContext.globe.continuous?this.do2DContiguousRepaint():this.doNormalRepaint()}finally{this.endFrame(),this.drawContext.frameStatistics.endFrame()}};
    e.prototype.doNormalRepaint=function(){this.createTerrain();this.clearFrame();this.deferOrderedRendering=!1;this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.doPick(),this.resolvePick()):(this.doDraw(),this.subsurfaceMode&&this.hasStencilBuffer&&(this.redrawSurface(),this.drawScreenRenderables()))};e.prototype.do2DContiguousRepaint=function(){this.createTerrain2DContiguous();this.clearFrame();this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.pick2DContiguous(),
        this.resolvePick()):this.draw2DContiguous()};e.prototype.resolvePick=function(){this.drawContext.pickTerrainOnly?this.resolveTerrainPick():this.drawContext.regionPicking?this.resolveRegionPick():this.resolveTopPick()};e.prototype.beginFrame=function(){var a=this.drawContext.currentGlContext;a.enable(a.BLEND);a.enable(a.CULL_FACE);a.enable(a.DEPTH_TEST);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);a.depthFunc(a.LEQUAL);this.drawContext.pickingMode&&(this.drawContext.makePickFramebuffer(),this.drawContext.bindFramebuffer(this.drawContext.pickFramebuffer))};
    e.prototype.endFrame=function(){var a=this.drawContext.currentGlContext;a.disable(a.BLEND);a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.blendFunc(a.ONE,a.ZERO);a.depthFunc(a.LESS);a.clearColor(0,0,0,1);this.drawContext.bindFramebuffer(null);this.drawContext.bindProgram(null)};e.prototype.clearFrame=function(){var a=this.drawContext,b=a.currentGlContext;b.clearColor(a.clearColor.red,a.clearColor.green,a.clearColor.blue,a.clearColor.alpha);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)};e.prototype.doDraw=
        function(){this.drawContext.renderShapes=!0;this.subsurfaceMode&&this.hasStencilBuffer?(this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),
            this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables(),this.drawContext.screenCreditController.drawCredits(this.drawContext))):(this.drawContext.surfaceShapeTileBuilder.clear(),
            this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables()),this.drawContext.screenCreditController.drawCredits(this.drawContext))};e.prototype.redrawSurface=function(){this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST);this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.EQUAL,1,1);this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.KEEP,
        this.drawContext.currentGlContext.KEEP,this.drawContext.currentGlContext.KEEP);this.drawContext.surfaceShapeTileBuilder.clear();this.drawLayers(!1);this.drawSurfaceRenderables();this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST)};e.prototype.doPick=function(){this.drawContext.terrain&&this.drawContext.terrain.pick(this.drawContext);this.drawContext.pickTerrainOnly||(this.subsurfaceMode&&this.hasStencilBuffer?
        (this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),
            this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables(),this.drawContext.terrain.pick(this.drawContext),this.drawScreenRenderables())):(this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),
    this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables())))};e.prototype.createTerrain=function(){var a=this.drawContext;a.terrain=this.globe.tessellator.tessellate(a);a.frameStatistics.setTerrainTileCount(a.terrain?a.terrain.surfaceGeometry.length:0)};e.prototype.makeCurrent=function(a){var b=this.drawContext;b.globe.offset=a;b.globeStateKey=b.globe.stateKey;switch(a){case -1:b.terrain=this.terrainLeft;break;case 0:b.terrain=this.terrainCenter;break;case 1:b.terrain=
        this.terrainRight}};e.prototype.createTerrain2DContiguous=function(){var a=this.drawContext;this.terrainCenter=null;a.globe.offset=0;a.globeStateKey=a.globe.stateKey;a.globe.intersectsFrustum(a.navigatorState.frustumInModelCoordinates)&&(this.terrainCenter=a.globe.tessellator.tessellate(a));this.terrainRight=null;a.globe.offset=1;a.globeStateKey=a.globe.stateKey;a.globe.intersectsFrustum(a.navigatorState.frustumInModelCoordinates)&&(this.terrainRight=a.globe.tessellator.tessellate(a));this.terrainLeft=
        null;a.globe.offset=-1;a.globeStateKey=a.globe.stateKey;a.globe.intersectsFrustum(a.navigatorState.frustumInModelCoordinates)&&(this.terrainLeft=a.globe.tessellator.tessellate(a))};e.prototype.draw2DContiguous=function(){this.terrainCenter&&(this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doDraw());this.terrainRight&&(this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doDraw());this.deferOrderedRendering=!1;this.terrainLeft&&
    (this.makeCurrent(-1),this.doDraw());this.subsurfaceMode&&this.hasStencilBuffer&&(this.deferOrderedRendering=!0,this.terrainCenter&&(this.makeCurrent(0),this.redrawSurface()),this.terrainRight&&(this.makeCurrent(1),this.redrawSurface()),this.terrainLeft&&(this.makeCurrent(-1),this.redrawSurface()));this.drawScreenRenderables()};e.prototype.pick2DContiguous=function(){this.terrainCenter&&(this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doPick());this.terrainRight&&
    (this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doPick());this.deferOrderedRendering=!1;this.terrainLeft&&(this.makeCurrent(-1),this.doPick())};e.prototype.drawLayers=function(a){var b=Date.now(),c=this.drawContext,d=c.layers;c.accumulateOrderedRenderables=a;for(var e=0,g=d.length;e<g;e++)if(a=d[e]){c.currentLayer=a;try{a.render(c)}catch(h){k.log(k.LEVEL_SEVERE,"Error while rendering layer "+a.displayName+".\n"+h.toString())}}d=Date.now();c.frameStatistics.layerRenderingTime=
        d-b};e.prototype.addLayer=function(a){this.layers.push(a)};e.prototype.removeLayer=function(a){if(a){for(var b=-1,c=0,d=this.layers.length;c<d;c++)if(this.layers[c]==a){b=c;break}0<=b&&this.layers.splice(b,1)}};e.prototype.insertLayer=function(a,b){b&&this.layers.splice(a,0,b)};e.prototype.drawSurfaceRenderables=function(){var a=this.drawContext,b;for(a.reverseSurfaceRenderables();b=a.popSurfaceRenderable();)try{b.renderSurface(a)}catch(c){k.logMessage(k.LEVEL_WARNING,"WorldWindow","drawSurfaceRenderables",
        "Error while rendering a surface renderable.\n"+c.message)}};e.prototype.drawOrderedRenderables=function(){var a=Date.now(),b=this.drawContext,c;b.sortOrderedRenderables();if(this._orderedRenderingFilters)for(c=0;c<this._orderedRenderingFilters.length;c++)this._orderedRenderingFilters[c](this.drawContext);for(b.orderedRenderingMode=!0;c=b.popOrderedRenderable();)try{c.renderOrdered(b)}catch(d){k.logMessage(k.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering an ordered renderable.\n"+
        d.message)}b.orderedRenderingMode=!1;b.frameStatistics.orderedRenderingTime=Date.now()-a};e.prototype.drawScreenRenderables=function(){for(var a=this.drawContext,b;b=a.nextScreenRenderable();)try{b.renderOrdered(a)}catch(c){k.logMessage(k.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering a screen renderable.\n"+c.message)}};e.prototype.resolveTopPick=function(){if(0!=this.drawContext.objectsAtPickPoint.objects.length){var a=this.drawContext.objectsAtPickPoint,b=this.drawContext.readPickColor(this.drawContext.pickPoint),
        c=null,d=null;if(b){for(var e=0,g=a.objects.length;e<g;e++){var h=a.objects[e];h.isTerrain&&(d=h);if(h.color.equals(b)&&(h.isOnTop=!0,c=h,d))break}this.drawContext.deepPicking||(a.clear(),c&&a.add(c),d&&d!=c&&a.add(d))}else a.clear()}};e.prototype.resolveTerrainPick=function(){for(var a=this.drawContext.objectsAtPickPoint,b,c=0,d=a.objects.length;c<d;c++)if(b=a.objects[c],b.isTerrain){b.isOnTop=!0;break}};e.prototype.resolveRegionPick=function(){if(0!=this.drawContext.objectsAtPickPoint.objects.length)for(var a=
        this.drawContext.objectsAtPickPoint,b=this.drawContext.readPickColors(this.drawContext.pickRectangle),c,d,e=0,g=a.objects.length;e<g;e++)if(c=a.objects[e])d=c.color.toByteString(),(d=b[d])?c.isOnTop=!0:c.userObject instanceof r&&(a.objects.splice(e,1),--e)};e.prototype.callRedrawCallbacks=function(a){for(var b=0,c=this._redrawCallbacks.length;b<c;b++)try{this._redrawCallbacks[b](this,a)}catch(d){k.log(k.LEVEL_SEVERE,"Exception calling redraw callback.\n"+d.toString())}};e.prototype.goTo=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             b){this.goToAnimator.goTo(a,b)};e.prototype.declutter=function(a,b){if(!b)throw new f(k.logMessage(k.LEVEL_SEVERE,"WorldWindow","declutter","Group ID is null, undefined or 0."));for(var c=[],d=0;d<a.orderedRenderables.length;d++){var e=a.orderedRenderables[d].orderedRenderable;e.declutterGroup===b&&c.push(e)}d=[];for(e=0;e<c.length;e++){var g=c[e],h=g.screenBounds;h&&h.intersectsRectangles(d)?g.targetVisibility=0:(g.targetVisibility=1,h&&d.push(h))}};return e});
define("src/util/WWMessage",[],function(){return function(f,b){this.type=f;this.source=b}});
define("src/WorldWind","./error/AbstractError ./geom/Angle ./shapes/Annotation ./shapes/AnnotationAttributes ./error/ArgumentError ./layer/AtmosphereLayer ./shaders/AtmosphereProgram ./shaders/BasicProgram ./shaders/BasicTextureProgram ./util/BasicTimeSequence ./layer/BingAerialLayer ./layer/BingAerialWithLabelsLayer ./layer/BingRoadsLayer ./layer/BingWMSLayer ./layer/BlueMarbleLayer ./layer/BMNGLandsatLayer ./layer/BMNGLayer ./layer/BMNGOneImageLayer ./geom/BoundingBox ./gesture/ClickRecognizer ./formats/collada/ColladaLoader ./util/Color ./shapes/Compass ./layer/CompassLayer ./layer/CoordinatesDisplayLayer ./util/Date ./layer/DigitalGlobeTiledImageLayer ./gesture/DragRecognizer ./render/DrawContext ./globe/EarthElevationModel ./globe/EarthRestElevationModel ./globe/ElevationModel ./util/Font ./util/FrameStatistics ./layer/FrameStatisticsLayer ./render/FramebufferTexture ./render/FramebufferTile ./render/FramebufferTileController ./geom/Frustum ./shapes/GeographicMesh ./projections/GeographicProjection ./shapes/GeographicText ./formats/geojson/GeoJSONParser ./formats/geotiff/GeoTiffReader ./gesture/GestureRecognizer ./globe/Globe ./globe/Globe2D ./util/GoToAnimator ./shaders/GpuProgram ./cache/GpuResourceCache ./shaders/GpuShader ./shaders/GroundProgram ./util/HighlightController ./formats/kml/util/ImagePyramid ./util/ImageSource ./render/ImageTile ./util/Insets ./formats/kml/util/ItemIcon ./formats/kml/KmlAbstractView ./formats/kml/styles/KmlBalloonStyle ./formats/kml/KmlCamera ./formats/kml/styles/KmlColorStyle ./formats/kml/features/KmlContainer ./formats/kml/features/KmlDocument ./formats/kml/KmlElements ./formats/kml/features/KmlFeature ./formats/kml/KmlFile ./formats/kml/features/KmlFolder ./formats/kml/geom/KmlGeometry ./formats/kml/features/KmlGroundOverlay ./formats/kml/KmlIcon ./formats/kml/styles/KmlIconStyle ./formats/kml/styles/KmlLabelStyle ./formats/kml/KmlLatLonAltBox ./formats/kml/KmlLatLonBox ./formats/kml/KmlLatLonQuad ./formats/kml/geom/KmlLinearRing ./formats/kml/geom/KmlLineString ./formats/kml/styles/KmlLineStyle ./formats/kml/KmlLink ./formats/kml/styles/KmlListStyle ./formats/kml/KmlLocation ./formats/kml/KmlLod ./formats/kml/KmlLookAt ./formats/kml/geom/KmlMultiGeometry ./formats/kml/features/KmlNetworkLink ./formats/kml/KmlObject ./formats/kml/KmlOrientation ./formats/kml/features/KmlOverlay ./formats/kml/features/KmlPhotoOverlay ./formats/kml/features/KmlPlacemark ./formats/kml/geom/KmlPoint ./formats/kml/geom/KmlPolygon ./formats/kml/styles/KmlPolyStyle ./formats/kml/KmlRegion ./formats/kml/features/KmlScreenOverlay ./formats/kml/styles/KmlStyle ./formats/kml/styles/KmlStyleMap ./formats/kml/styles/KmlStyleSelector ./formats/kml/styles/KmlSubStyle ./formats/kml/KmlTimePrimitive ./formats/kml/KmlTimeSpan ./formats/kml/KmlTimeStamp ./formats/kml/features/KmlTour ./formats/kml/geom/KmlTrack ./layer/LandsatRestLayer ./layer/Layer ./util/Level ./util/LevelRowColumnUrlBuilder ./util/LevelSet ./geom/Line ./geom/Location ./util/Logger ./navigate/LookAtNavigator ./geom/Matrix ./cache/MemoryCache ./cache/MemoryCacheListener ./layer/MercatorTiledImageLayer ./navigate/Navigator ./navigate/NavigatorState ./util/NominatimGeocoder ./error/NotYetImplementedError ./util/Offset ./layer/OpenStreetMapImageLayer ./formats/kml/util/Pair ./gesture/PanRecognizer ./shapes/Path ./util/PeriodicTimeSequence ./pick/PickedObject ./pick/PickedObjectList ./gesture/PinchRecognizer ./shapes/Placemark ./shapes/PlacemarkAttributes ./geom/Plane ./shapes/Polygon ./geom/Position ./projections/ProjectionEquirectangular ./projections/ProjectionGnomonic ./projections/ProjectionMercator ./projections/ProjectionPolarEquidistant ./projections/ProjectionUPS ./projections/ProjectionWgs84 ./geom/Rectangle ./render/Renderable ./layer/RenderableLayer ./layer/RestTiledImageLayer ./gesture/RotationRecognizer ./formats/kml/util/Scale ./formats/kml/util/Schema ./shapes/ScreenImage ./shapes/ScreenText ./geom/Sector ./shapes/ShapeAttributes ./formats/shapefile/Shapefile ./layer/ShowTessellationLayer ./shaders/SkyProgram ./shapes/SurfaceImage ./shapes/SurfaceCircle ./shapes/SurfaceEllipse ./shapes/SurfacePolygon ./shapes/SurfacePolyline ./shapes/SurfaceRectangle ./render/SurfaceRenderable ./shapes/SurfaceSector ./shapes/SurfaceShape ./shapes/SurfaceShapeTile ./shapes/SurfaceShapeTileBuilder ./render/SurfaceTile ./render/SurfaceTileRenderer ./shaders/SurfaceTileRendererProgram ./gesture/TapRecognizer ./layer/TectonicPlatesLayer ./globe/Terrain ./globe/TerrainTile ./globe/TerrainTileList ./globe/Tessellator ./shapes/Text ./shapes/TextAttributes ./render/TextSupport ./render/Texture ./render/TextureTile ./util/Tile ./layer/TiledImageLayer ./util/TileFactory ./gesture/TiltRecognizer ./gesture/Touch ./shapes/TriangleMesh ./error/UnsupportedOperationError ./geom/Vec2 ./geom/Vec3 ./layer/ViewControlsLayer ./formats/kml/util/ViewVolume ./ogc/WmsCapabilities ./layer/WmsLayer ./ogc/WmsLayerCapabilities ./layer/WmsTimeDimensionedLayer ./util/WmsUrlBuilder ./ogc/WmtsCapabilities ./layer/WmtsLayer ./ogc/WmtsLayerCapabilities ./WorldWindow ./util/WWMath ./util/WWMessage ./util/WWUtil ./util/XmlDocument ./globe/ZeroElevationModel".split(" "),function(f,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                b,c,a,d,e,g,h,k,l,m,p,q,t,r,u,w,x,A,B,v,F,G,D,y,H,C,z,E,L,M,I,K,O,N,R,S,P,Q,X,V,Y,W,U,T,Z,aa,ca,da,ea,fa,ga,ha,bc,ia,ja,ka,cc,dc,ec,fc,gc,hc,ic,jc,kc,la,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc,Ec,Fc,Gc,Hc,Ic,Jc,Kc,Lc,Mc,Nc,Oc,Pc,Qc,Rc,Sc,Tc,Uc,Vc,Wc,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Xc,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,Yc,Zc,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,$c,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,ba,ad,ac){var J={VERSION:"0.0.0",ABSOLUTE:"absolute",AFTER_REDRAW:"afterRedraw",BEFORE_REDRAW:"beforeRedraw",BEGAN:"began",CANCELLED:"cancelled",CHANGED:"changed",CLAMP_TO_GROUND:"clampToGround",EARTH_RADIUS:6371E3,EAST:"east",ENDED:"ended",FAILED:"failed",GREAT_CIRCLE:"greatCircle",LINEAR:"linear",MULTI_POINT:"multiPoint",NORTH:"north",NULL:"null",OFFSET_FRACTION:"fraction",OFFSET_INSET_PIXELS:"insetPixels",OFFSET_PIXELS:"pixels",POINT:"point",
    POLYLINE:"polyline",POLYGON:"polygon",POSSIBLE:"possible",RECOGNIZED:"recognized",REDRAW_EVENT_TYPE:"WorldWindRedraw",RELATIVE_TO_GLOBE:"relativeToGlobe",RELATIVE_TO_GROUND:"relativeToGround",RELATIVE_TO_SCREEN:"relativeToScreen",RHUMB_LINE:"rhumbLine",SOUTH:"south",WEST:"west"};J.AbstractError=f;J.Angle=b;J.Annotation=c;J.AnnotationAttributes=a;J.ArgumentError=d;J.AtmosphereLayer=e;J.AtmosphereProgram=g;J.BasicProgram=h;J.BasicTextureProgram=k;J.BasicTimeSequence=l;J.BingAerialLayer=m;J.BingAerialWithLabelsLayer=
    p;J.BingRoadsLayer=q;J.BingWMSLayer=t;J.BlueMarbleLayer=r;J.BMNGLandsatLayer=u;J.BMNGLayer=w;J.BMNGOneImageLayer=x;J.BoundingBox=A;J.ClickRecognizer=B;J.ColladaLoader=v;J.Color=F;J.Compass=G;J.CompassLayer=D;J.CoordinatesDisplayLayer=y;J.DateWW=H;J.DigitalGlobeTiledImageLayer=C;J.DragRecognizer=z;J.DrawContext=E;J.EarthElevationModel=L;J.EarthRestElevationModel=M;J.ElevationModel=I;J.Font=K;J.FrameStatistics=O;J.FrameStatisticsLayer=N;J.FramebufferTexture=R;J.FramebufferTile=S;J.FramebufferTileController=
    P;J.Frustum=Q;J.GeographicMesh=X;J.GeographicProjection=V;J.GeographicText=Y;J.GeoJSONParser=W;J.GeoTiffReader=U;J.GestureRecognizer=T;J.Globe=Z;J.Globe2D=aa;J.GoToAnimator=ca;J.GpuProgram=da;J.GpuResourceCache=ea;J.GpuShader=fa;J.GroundProgram=ga;J.HighlightController=ha;J.ImageSource=ia;J.ImageTile=ja;J.Insets=ka;J.KmlFile=la;J.LandsatRestLayer=ma;J.Layer=na;J.Level=oa;J.LevelRowColumnUrlBuilder=pa;J.LevelSet=qa;J.Line=ra;J.Location=sa;J.Logger=ta;J.LookAtNavigator=ua;J.Matrix=va;J.MemoryCache=
    wa;J.MemoryCacheListener=xa;J.MercatorTiledImageLayer=ya;J.Navigator=za;J.NavigatorState=Aa;J.NominatimGeocoder=Ba;J.NotYetImplementedError=Ca;J.Offset=Da;J.OpenStreetMapImageLayer=Ea;J.PanRecognizer=Fa;J.Path=Ga;J.PeriodicTimeSequence=Ha;J.PickedObject=Ia;J.PickedObjectList=Ja;J.PinchRecognizer=Ka;J.Placemark=La;J.PlacemarkAttributes=Ma;J.Plane=Na;J.Polygon=Oa;J.Position=Pa;J.ProjectionEquirectangular=Qa;J.ProjectionGnomonic=Ra;J.ProjectionMercator=Sa;J.ProjectionPolarEquidistant=Ta;J.ProjectionUPS=
    Ua;J.ProjectionWgs84=Va;J.Rectangle=Wa;J.Renderable=Xa;J.RenderableLayer=Ya;J.RestTiledImageLayer=Za;J.RotationRecognizer=$a;J.ScreenText=bb;J.ScreenImage=ab;J.Sector=cb;J.ShapeAttributes=db;J.Shapefile=eb;J.ShowTessellationLayer=fb;J.SkyProgram=gb;J.SurfaceImage=hb;J.SurfaceCircle=ib;J.SurfaceEllipse=jb;J.SurfacePolygon=kb;J.SurfacePolyline=lb;J.SurfaceRectangle=mb;J.SurfaceRenderable=nb;J.SurfaceSector=ob;J.SurfaceShape=pb;J.SurfaceShapeTile=qb;J.SurfaceShapeTileBuilder=rb;J.SurfaceTile=sb;J.SurfaceTileRenderer=
    tb;J.SurfaceTileRendererProgram=ub;J.TapRecognizer=vb;J.TectonicPlatesLayer=wb;J.Terrain=xb;J.TerrainTile=yb;J.TerrainTileList=zb;J.Tessellator=Ab;J.Text=Bb;J.TextAttributes=Cb;J.TextSupport=Db;J.Texture=Eb;J.TextureTile=Fb;J.Tile=Gb;J.TiledImageLayer=Hb;J.TileFactory=Ib;J.TiltRecognizer=Jb;J.Touch=Kb;J.TriangleMesh=Lb;J.UnsupportedOperationError=Mb;J.Vec2=Nb;J.Vec3=Ob;J.ViewControlsLayer=Pb;J.WmsCapabilities=Qb;J.WmsLayer=Rb;J.WmsLayerCapabilities=Sb;J.WmsTimeDimensionedLayer=Tb;J.WmsUrlBuilder=
    Ub;J.WmtsCapabilities=Vb;J.WmtsLayer=Wb;J.WmtsLayerCapabilities=Xb;J.WWMath=Zb;J.WWMessage=$b;J.WWUtil=ba;J.WorldWindow=Yb;J.ZeroElevationModel=ac;J.configuration={gpuCacheSize:25E7,baseUrl:ba.worldwindlibLocation()||ba.currentUrlSansFilePart()+"/../"};J.BingMapsKey=null;return window.WorldWind=J});define("myScripts/Layer",["src/WorldWind"],function(f){var b=function(b){f.RenderableLayer.call(this,b)};b.prototype=Object.create(f.RenderableLayer.prototype);return b});
define("myScripts/LayerGroup",["myScripts/Layer"],function(f){var b=function(){this.layers=[]};b.prototype.addLayer=function(b,a){this.layers[b]=new f(a)};b.prototype.pushLayer=function(b){this.layers.push(new f(b))};b.prototype.setAll=function(b){this.layers.forEach(function(a){$.each(b,function(b,c){a[b]=c})})};b.prototype.setAllRend=function(b){var a=this;this.layers.forEach(function(d){d.renderables.forEach(function(d){$.each(b,function(b,c){a.setValue(d,b,c)})})})};b.prototype.setValue=function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         a,d){"string"==typeof a&&(a=a.split("."));1<a.length?this.setValue(b[a.shift()],a,d):b[a[0]]=d};return b});var wwd,layers;
define("myScripts/AppConstructor",["myScripts/DataLoader","myScripts/GlobeHelper","myScripts/csvToGrid/Converter","myScripts/LayerGroup"],function(f,b,c,a){var d=function(){};d.prototype.init=function(a,c){c.init(a,this);b.clean(c.smallVoxels,c.bigVoxels,c.gridlayer,c.globe);a.isCSV||a.isUrl?this.initCSV(a,c):this.initGridData(a,c)};d.prototype.initCSV=function(a,d,h,f){b.clean(d.smallVoxels.layers,d.bigVoxels.layers,d.gridLayer,d.globe);var l=[];d.options=a;l[0]=a.config_0;l[0].data=a.csv.data;l[0].time=
    a.csv.time;l[0].delimiter=a.csv.delimiter;var m=a.sub,p=this;(new Promise(function(b){h||a.isUrl?h&&!a.isUrl?b(d.allData):a.isUrl&&p.prepareWCS(a.config_0,b):c.loadData(a.csv.csvUrl,b,l[0].delimiter)})).then(function(b){d.allData=b;if(h){for(h=d._navigator.getVisibleAreaBoundaries();40<h._top-h._bottom;)--h._top,h._bottom+=1;for(;40<h._right-h._left;)--h._right,h._left+=1;for(;1.3<(h._right-h._left)/(h._top-h._bottom);)h._right-=.2,h._left+=.2,h._top+=.1,h._bottom-=.1;for(;1.3<(h._top-h._bottom)/
(h._right-h._left);)h._top-=.2,h._bottom+=.2,h._right+=.1,h._left-=.1}else h=d._navigator.getVisibleAreaBoundaries();a.isUrl&&(l[0].data=[0],l[0].time=3,l[0].lat=1,l[0].lng=2);try{b=c.filterData(b,l[0],h,f);if(0<b.length){var p=c.initData(b,l[0],0);b.bounds=c.getDataBounds(b,l[0],0);l[0].heightExtrusion&&(b.bounds1=c.getDataBounds(b,l[0],1));var r=JSON.stringify(c.initJson(p,a.csv.zone,a.csv.quadSub,a.csv.source)),u=new Promise(function(a){d.gridLayer=d.loadGrid(r,1,a)})}u.then(function(){var a=d.createRect(m,
    d.gridLayer),e;if("undefined"!==typeof Worker)var h=new Promise(function(a){e=new Worker("myScripts/workers/setGridtoData.js");e.postMessage([r,p.times,l[0]]);e.onmessage=function(b){a(b.data)}});else p.times=c.setGridtoData(r,p.times,l[0]);h.then(function(c){p.times=JSON.parse(c);d.myData[0]=b;d.doxelFromData(p.allTime,p.times,l);d.allTime=p.allTime;d.times=p.times;d.rectInit(a)})})}catch(w){console.log(w+"Error in parsing file")}})};d.prototype.initGridData=function(a,b){var c=[];c[0]=a.config_0;
    var d=a.sub,l=[],m=new f(this,0);b.dataLoaded=0;var p=new Promise(function(c){var d=a.gridUrl;if(a.isLocal){var h=new FileReader;h.onload=function(){d=h.result};h.readAsText(a.gridUrl);h.onloadend=function(){b.gridLayer=b.loadGrid(d,1,c)}}else b.gridLayer=b.loadGrid(d,0,c)}),q=new Promise(function(a){p.then(function(){m.getData(c[0].url,a,c[0])})});q.then(function(a){b.myData[0]=a;a=b.dataParser(a,[],{},c[0],0);b.allTime=a.allTime;b.times=a.times;b.doxelFromData(a.allTime,a.times,c)});c[0].half&&
    new Promise(function(a){l[1].getData(c[1].url,a,c[0])});Promise.all([q,p]).then(function(){var a=b.createRect(d,b.gridLayer);b.rectInit(a)})};d.prototype.newData=function(c,d){for(var h=d.globe.layers.length,k=4;k<=h;k++)d.globe.removeLayer(d.globe.layers[k]);b.clean(d.smallVoxels.layers,d.bigVoxels.layers,d.gridLayer,d.globe);d.smallVoxels=new a;d.config[1]=c;var l=new f(this,1);(new Promise(function(a){l.getData(c.url,a,c)})).then(function(a){d.myData[1]=a;a=d.dataParser(a,d.allTime,d.times,c,1);
    d.allTime=a.allTime;d.times=a.times;a=$jscomp.makeIterator(d.sliceTime(d.allTime,d.times));d.allTime=a.next().value;d.times=a.next().value;d.doxelFromData(d.allTime,d.times,d.config,1)})};d.prototype.addCsv=function(a){if(a.options&&a.autoTile){var c=b.getMaxTile();this.initCSV(a.options,a,1,c)}};d.prototype.prepareWCS=function(a,b){for(var c=gInterface._navigator.getVisibleAreaBoundaries();40<c._top-c._bottom;)--c._top,c._bottom+=1;for(;40<c._right-c._left;)--c._right,c._left+=1;var d=a.monthRange1,
    f=a.monthRange2;(new Promise(function(b){$.ajax({type:"POST",url:a.url,data:'request=<?xml version="1.0" encoding="UTF-8" ?><ProcessCoveragesRequest xmlns="http://www.opengis.net/wcps/1.0" service="WCPS" version="1.0.0">  <query>    <abstractSyntax>      for c in ('+a.coverage+") return encode(c[Lat("+c._bottom+":"+c._top+"), Long("+c._left+":"+c._right+'), ansi("2014-'+d+'":"2014-'+f+'")], "csv")    </abstractSyntax>  </query></ProcessCoveragesRequest>',contentType:"application/json; charset=utf-8",
    success:function(a){b(a)}})})).then(function(a){var e=[],q=f-d+1;a=a.split("}},");for(var t=-.1,r=0;r<a.length;r++)for(var u=a[r].replace(/\{|\}/g,""),u=u.split(","),t=t+.1,w=-.1,x=0;x<u.length/q;x++)for(var w=w+.1,A=0;A<q;A++){var B=Number(u[x+A]);999>B&&e.push([B,c._bottom+w,c._left+t,A+1])}b(e)})};return d});
define("myScripts/Voxel",[],function(){return function(f,b){var c=[],a=[],d=[],e=[],g=[];d[0]=f[0].lat;e[0]=f[0].lng;d[1]=f[3].lat;e[1]=f[3].lng;d[2]=f[1].lat;e[2]=f[1].lng;d[3]=f[2].lat;e[3]=f[2].lng;g[0]=f.altitude;g[1]=g[0]+f.height;var h=[];c.push(new WorldWind.Position(d[1],e[1],g[0]));c.push(new WorldWind.Position(d[1],e[1],g[1]));c.push(new WorldWind.Position(d[0],e[0],g[0]));a.push(0);a.push(1);a.push(2);c.push(new WorldWind.Position(d[0],e[0],g[1]));c.push(new WorldWind.Position(d[0],e[0],
    g[0]));c.push(new WorldWind.Position(d[1],e[1],g[1]));a.push(3);a.push(4);a.push(5);c.push(new WorldWind.Position(d[1],e[1],g[1]));c.push(new WorldWind.Position(d[2],e[2],g[1]));c.push(new WorldWind.Position(d[0],e[0],g[1]));a.push(6);a.push(7);a.push(8);c.push(new WorldWind.Position(d[1],e[1],g[1]));c.push(new WorldWind.Position(d[3],e[3],g[1]));c.push(new WorldWind.Position(d[2],e[2],g[1]));a.push(9);a.push(10);a.push(11);c.push(new WorldWind.Position(d[1],e[1],g[1]));c.push(new WorldWind.Position(d[3],
    e[3],g[1]));c.push(new WorldWind.Position(d[1],e[1],g[0]));a.push(12);a.push(13);a.push(14);h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));c.push(new WorldWind.Position(d[3],e[3],g[1]));c.push(new WorldWind.Position(d[3],e[3],g[0]));c.push(new WorldWind.Position(d[1],e[1],g[0]));a.push(15);a.push(16);a.push(17);c.push(new WorldWind.Position(d[3],e[3],g[1]));c.push(new WorldWind.Position(d[2],e[2],g[0]));c.push(new WorldWind.Position(d[3],e[3],g[0]));
    a.push(18);a.push(19);a.push(20);h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));c.push(new WorldWind.Position(d[3],e[3],g[1]));c.push(new WorldWind.Position(d[2],e[2],g[1]));c.push(new WorldWind.Position(d[2],e[2],g[0]));a.push(21);a.push(22);a.push(23);c.push(new WorldWind.Position(d[2],e[2],g[1]));c.push(new WorldWind.Position(d[2],e[2],g[0]));c.push(new WorldWind.Position(d[0],e[0],g[1]));a.push(24);a.push(25);a.push(26);h.push(new WorldWind.Vec2(0,
        0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,0));c.push(new WorldWind.Position(d[2],e[2],g[0]));c.push(new WorldWind.Position(d[0],e[0],g[0]));c.push(new WorldWind.Position(d[0],e[0],g[1]));a.push(27);a.push(28);a.push(29);g=new WorldWind.ShapeAttributes(null);g.drawOutline=!1;g.applyLighting=!0;c=new WorldWind.TriangleMesh(c,a,g);if(1<b.length){var a=document.createElement("canvas"),k=a.getContext("2d"),l=k.createLinearGradient(0,0,0,a.height);l.addColorStop(0,b[0]);l.addColorStop(.49,
        b[0]);l.addColorStop(.51,b[1]);l.addColorStop(1,b[1]);k.fillStyle=l;k.fillRect(0,0,a.width,a.height);h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,
        0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(0,0));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));h.push(new WorldWind.Vec2(1,1));g.imageSource=new WorldWind.ImageSource(a);c.textureCoordinates=h}else g.interiorColor=b;c.point={0:d[0],1:e[0]};return c}});
define("myScripts/GlobeInterface",["myScripts/Voxel","myScripts/GlobeHelper","src/WorldWind","myScripts/Layer","myScripts/LayerGroup"],function(f,b,c,a,d){a=function(a){this.globe=a};a.prototype.init=function(a,b){this.heightCube=a.heightCube;this.gridUrl=a.gridUrl;this.heightDim=a.heightDim;this.maxShown=a.maxShown;this.maxInApp=a.maxInApp;this.startHeight=a.startHeight;this.autoTime=a.autoTime;this.statIndex=a.statIndex;this.maxDownload=a.maxDownload;this.colors=a.colors;this.config=[];this.config[0]=
    a.config_0;this.sub=a.sub;this.smallVoxels=new d;this.bigVoxels=new d;this.dim={};this.rect=[];this.compare=this.activeLayers=this.minTime=0;this.parent=b;this.myData=[]};a.prototype.updateOpt=function(a){this.UI.resetTime(a[0]);this.autoTime=a[1];this.statIndex=a[2]};a.prototype.setUI=function(a){this.UI=a};a.prototype.dataParser=function(a,b,c,d,f){for(var m=a.length,p=0;p<m;p++){var q=a[p],t=q[d.time];if(-1==b.indexOf(t))if(b.length>=this.maxInApp)break;else b.push(t);c[t]||(c[t]=[]);c[t][f]||
(c[t][f]=[]);var r=[q[d.id]],u;for(u in d.data)r.push(q[d.data[u]]);c[t][f].push(r)}return{allTime:b,times:c}};a.prototype.sliceTime=function(a,b){for(var c in b)2>b[c].length&&delete b[c];for(c in a)b[a[c]]||a.splice(c);return[a,b]};a.prototype.doxelFromData=function(a,b,c){this.dataLoaded++;if(this.config[1]){gInterface.maxShown=1;var d=this.config[1].reference}else d=0;this.makeSmallLayers(a,b);results=this.makeSmallDoxels([this.colors,this.startHeight,this.heightCube],this.myData,this.gridLayer,
    a,b,c,d);this.resolveDoxel(results)};a.prototype.resolveDoxel=function(a){for(var b=0;b<a.length;b++)this.smallVoxels.layers[a[b][0]].addRenderables(a[b][1]);2==this.dataLoaded&&(this.UI.disableNewData(),this.UI.start(),a=this.createRect(this.sub,this.gridLayer),this.movingTemplate=a[0],this.rect=a[1],this.dim.x=a[2],this.dim.y=a[3],this.assignVoxels(a[1],this.gridLayer.renderables,this.smallVoxels.layers))};a.prototype.loadGrid=function(a,b,d){var f=new c.RenderableLayer("GridLayer");this.createJson(f,
    a,b,d);this.globe.addLayer(f);return f};a.prototype.createJson=function(a,b,d,f){(new c.GeoJSONParser(b)).load(f,function(a,b){var d={};if(a.isPolygonType()||a.isMultiPolygonType())d.attributes=new c.ShapeAttributes(null),d.attributes.id=b.id,d.attributes.interiorColor=new c.Color(.3,.3,.3,.5),d.attributes.outlineColor=new c.Color(1,1,1,.8);return d},a)};a.prototype.makeBigDoxels=function(){var a=new d,g=this.heightDim,h=this.compare,f,l;this.smallVoxels.layers.forEach(function(a){a.renderables.forEach(function(a){a.enabled=
    !1;a.bigCubed=!0})});g>this.maxShown&&(g=this.maxShown);var m={altitude:this.startHeight,height:this.activeLayers*this.heightCube/g};for(f=0;f<g;f++){this.bigVoxels&&this.bigVoxels.layers[f]&&this.globe.removeLayer(this.bigVoxels.layers[f]);a.pushLayer("bigVoxels_"+f);this.globe.addLayer(a.layers[f]);var p=this.rect;for(l=0;l<p.length;l++){var q=p[l],t=b.getStatistics(q,f+this.minTime,this.myData[h],this.statIndex,this.colors,this.config,this.compare),r=c.Color.colorFromBytes(t[0][0],t[0][1],t[0][2],
    t[0][3]),q=this.getBigVoxels(q,m,r);q.data=t[1];q.showAlt=!0;q.bigShow=!0;a.layers[f].addRenderable(q)}m.altitude+=m.height}this.bigVoxels=a};a.prototype.makeSmallLayers=function(a,b){this.activeLayers=0;for(var c=this.smallVoxels,d=[],f=a.length,m=0;m<f;m++){if(-1==d.indexOf(m))d.push(m);else break;if(this.config[1]&&(!b[a[m]][0]||!b[a[m]][1]))break;c.addLayer(m,m);c.layers[m].enabled=!0;c.layers[m].active=!0;this.activeLayers++;m>=this.maxShown&&(c.layers[m].enabled=!1,c.layers[m].active=!1,this.activeLayers--);
    c.layers[m].heightLayer=m;this.globe.addLayer(c.layers[m])}};a.prototype.makeSmallDoxels=function(a,d,h,k,l,m,p,q){q=[];var t=a[0],r=a[1];a=a[2];for(var u=k.length,w=0;w<u;w++){var x=[],A,B,v,F,G,D,y,H=l[k[w]][p],C=H.length;m[1]&&(C=Math.min(l[k[w]][0].length,l[k[w]][1].length));for(var z=0;z<h.renderables.length&&(!m[1]||l[k[w]][1][z]);z++){var E=h.renderables,L=E[z].attributes.id,M=[];M.number=0;M.values=0;for(var I=M.position=0;I<C-1;I++)if(L==H[I][0]&&(F=E[z])&&F._boundaries){m[1]&&(A=[],G=[]);
    l[k[w]][1]&&(B=l[k[w]][1][I][1].split(".").join(""),y=d[1].bounds[1],y=b.getColor((B-y)/(d[1].bounds[0]-y)*100,t),A.push("rgb("+y[0]+","+y[1]+","+y[2]+")"),G.push(l[k[w]][1][I]),y=B);B=m[0].separator?l[k[w]][p][I][1].split(m[0].separator).join(""):l[k[w]][p][I][1];M.values+=Number(B);M.number++;D=M.values/M.number;var K=d[0].bounds[0],O=d[0].bounds[1];B=b.getColor((B-O)/(K-O)*100,t);m[1]?(A.push("rgb("+B[0]+","+B[1]+","+B[2]+")"),G.push(l[k[w]][0][I])):(A=c.Color.colorFromBytes(B[0],B[1],B[2],B[3]),
        G=l[k[w]][p][I]);v=b.getCoords(F);v.altitude=r+w*a;v.height=a;m[0].heightExtrusion&&(B=m[0].separator?l[k[w]][p][I][2].split(m[0].separator).join(""):l[k[w]][p][I][2],K=d[0].bounds1[0],O=d[0].bounds1[1],v.height=a+(B-O)/(K-O)*100*a/10);F=F.attributes.id;B=new f(v,A);B.enabled=!0;B.info=G;B.heightLayer=w;B.data=[];B.data.push(D);m[1]&&B.data.push(y);B.filtered=!1;B.latlongfilter=!1;B.id=F;M.position?x[M.position]=B:(M.position=x.length,x.push(B))}}q.push([w,x])}return q};a.prototype.assignVoxels=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     b,c){for(var d in b)for(var f=0;f<a.length;f++)c.forEach(function(b){b.renderables[d]&&a[f].containsPoint(b.renderables[d].point)&&a[f].cubes.push(b.renderables[d])})};a.prototype.getBigVoxels=function(a,b,c){var d={},l=this.dim;d[0]={};d[1]={};d[2]={};d[3]={};d[0].lat=a.x;d[0].lng=a.y;d[1].lat=a.x+l.x;d[1].lng=a.y;d[2].lat=a.x+l.x;d[2].lng=a.y+l.y;d[3].lat=a.x;d[3].lng=a.y+l.y;d.altitude=b.altitude;d.height=b.height;a=new f(d,c);a.enabled=!0;a.active=!0;a.height=d.height;return a};a.prototype.createRect=
    function(a,b){var d,f=Infinity,l=Infinity,m=-Infinity,p=-Infinity;b.renderables.forEach(function(a){l=Math.min(l,a._boundaries[0].longitude);l=Math.min(l,a._boundaries[1].longitude);f=Math.min(f,a._boundaries[0].latitude);f=Math.min(f,a._boundaries[1].latitude);p=Math.max(p,a._boundaries[1].longitude);p=Math.max(p,a._boundaries[2].longitude);m=Math.max(m,a._boundaries[1].latitude);m=Math.max(m,a._boundaries[3].latitude);a.point={0:a._boundaries[0].latitude,1:a._boundaries[0].longitude}});b.bounds=
    {};b.bounds.minLng=l;b.bounds.minLat=f;b.bounds.maxLng=p;b.bounds.maxLat=m;var q=(m-f)/a,t=(p-l)/a,r=0,u=f,w=l,x=[];for(d=0;d<a;d++){for(var A=0;A<a;A++)x[r]=new c.Rectangle(u,w,q,t),x[r].cubes=[],r++,u+=q;w+=t;u=f}return[new c.Rectangle(f-1E-5,l-1E-5,q*a,t*a),x,q,t]};a.prototype.rectInit=function(a){this.movingTemplate=a[0];this.rect=a[1];this.dim.x=a[2];this.dim.y=a[3];this.assignVoxels(a[1],this.gridLayer.renderables,this.smallVoxels.layers);this.UI.start()};a.prototype.changeAltitude=function(a){this.smallVoxels.setAll.call(this.smallVoxels,
    {enabled:!1});this.bigVoxels.setAllRend.call(this.bigVoxels,{enabled:!1,showAlt:!1});var b=[Math.floor(this.heightDim*a[0]/this.activeLayers),Math.floor(this.heightDim*a[1]/this.activeLayers)],c=this.bigVoxels.layers,d;for(d=b[0];d<b[1];d++)c[d]&&c[d].renderables.forEach(function(a){a.active?(a.bigShow&&(a.enabled=!0),a.showAlt=!0):a.showAlt=!1});b=this.smallVoxels.layers;for(d=a[0]+this.minTime;d<a[1]+this.minTime;d++)b[d].active&&(b[d].enabled=!0);this.globe.redraw()};a.prototype.setOpacity=function(a){this.smallVoxels.setAllRend.call(this.smallVoxels,
    {"_attributes.interiorColor.alpha":a});this.bigVoxels.setAllRend.call(this.bigVoxels,{"_attributes.interiorColor.alpha":a})};a.prototype.filterValues=function(a){var b=this.compare;this.smallVoxels.layers.forEach(function(c){c.renderables.forEach(function(c){var d=c.data[b];d<a[0]||d>a[1]?(c.enabled=!1,c.filtered=!0):c.filtered&&(c.filtered=!1,c.latlongfilter||c.bigCubed||(c.enabled=!0))})})};a.prototype.changeTime=function(a){this.minTime=a;var b,c=this.startHeight;layers=this.smallVoxels.layers;
    layers.forEach(function(b,d){b.renderables.forEach(function(g,f){var q=g.positions[0].altitude,t=g.positions[7].altitude;g.positions.forEach(function(b){var g=t-q,g=Number(c+g*Number(d)-a*g),g=b.altitude==q?g+0:g+(t-q);b.altitude=g});b.renderables[f].reset()})});layers.forEach(function(a){a.enabled=!1;a.active=!1});for(b=a;b<=this.activeLayers-1+a;b++)layers[b].enabled=!0,layers[b].active=!0;this.globe.redraw()};a.prototype.changeSize=function(a,b){var c,d=this.dim,f=this.movingTemplate,m=this.sub;
    c=this.gridLayer;b?(f.y=c.bounds.minLng+a[0],c=d.y*m-a[0],f.height=c,f.height=c-(d.y*m-a[1])):(f.x=c.bounds.minLat+a[0],c=d.x*m-a[0],f.width=c,f.width=c-(d.x*m-a[1]))};a.prototype.moveWindow=function(a){var b=this.rect,c=this.smallVoxels.layers,d=this.bigVoxels.layers,f=this.movingTemplate;a?c.forEach(function(a){a.renderables.forEach(function(a){f.containsPoint(a.point)&&!1===a.enabled&&b.forEach(function(b,c){a&&-1!==b.cubes.indexOf(a)&&f.intersects(b)&&(0<d.length?d.forEach(function(b){b.renderables[c].active?
b.renderables[c].showAlt&&(b.renderables[c].enabled=!0,b.renderables[c].bigShow=!0):(a.latlongfilter=!1,a.filtered||(a.enabled=!0))}):(a.latlongfilter=!1,a.filtered||(a.enabled=!0)))})})}):c.forEach(function(a){a.renderables.forEach(function(a){f.containsPoint(a.point)||b.forEach(function(b,c){a&&-1!==b.cubes.indexOf(a)&&(0<d.length?d.forEach(function(b){b.renderables[c].active?(b.renderables[c].enabled=!1,b.renderables[c].bigShow=!1):(a.enabled=!1,a.latlongfilter=!0)}):(a.enabled=!1,a.latlongfilter=
    !0))})})})};return a});define("myScripts/Globe",["src/WorldWind"],function(f){var b=window.WorldWind,c=function(a){b.WorldWindow.call(this,a.id);this.addLayer(new b.BMNGOneImageLayer);this.addLayer(new b.BingAerialWithLabelsLayer);this.addLayer(new b.CoordinatesDisplayLayer(this));this.addLayer(new b.AtmosphereLayer("images/dnb_land.png"));this.layers[0].detailControl=1;this.layers[1].detailControl=1};c.prototype=Object.create(f.WorldWindow.prototype);return c});
define("myScripts/Configurator",[],function(){var f=function(b){this.parent=b};f.prototype.getConfig=function(b,c){Papa.parse(b,{worker:!1,download:!0,preview:1,fastMode:!0,complete:function(a){c(a.data[0])}})};return f});
define("myScripts/Chart",[],function(){var f=function(){google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback()};f.prototype.draw=function(b,c){this.chart=new google.visualization.AreaChart($("#chart_div")[0]);this.chart.draw(b,c);this.started=1};f.prototype.setPoint=function(b,c){this.chart.setSelection([{row:b,column:c+1}])};return f});
define("myScripts/Correlation",[],function(){var f=function(){};f.getCorrelationDatasets=function(b,c,a){var d=[],e=[],g=0,f=0,k,l,m;if(a[1])for(k in c){if(c[k][0]&&c[k][1]){var p=Math.min(c[k][0].length,c[k][1].length);for(l=0;l<p;l++)m=a[0].separator?Number(c[k][0][l][1].split(a[0].separator).join("")):Number(c[k][0][l][1]),g+=m,m=a[0].separator?Number(c[k][1][l][1].split(a[1].separator).join("")):Number(c[k][1][l][1]),f+=m;d.push(g/c[k][0].length);e.push(f/c[k][1].length)}}else for(k in c){for(l=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0;l<c[k][0].length;l++){if(3>c[k][0][l].length)return;m=a[0].separator?Number(c[k][0][l][1].split(a[0].separator).join("")):Number(c[k][0][l][1]);g+=m;m=a[0].separator?Number(c[k][0][l][2].split(a[0].separator).join("")):Number(c[k][0][l][2]);f+=m}d.push(g/c[k][0].length);e.push(f/c[k][0].length)}c=this.correlation([d,e],0,1);b(c)};f.getCorrelationVariables=function(b,c,a,d){var e=b.id;b=[b.names];var g,f,k,l,m;for(g in c){var p=c[g];if(!a[1])for(f in p[0]){if(p[0][f][0]==e){l=[g];for(var q=1;q<d+
1;q++)m=p[0][f][q],a[0].separator&&(m=Number(m.split(a[0].separator).join(""))),l.push(Number(m));b.push(l)}}else if(p[0]&&p[1])for(f in p[0])if(p[0][f][0]==e){l=[g];m=p[0][f][1];a[0].separator&&(m=Number(m.split(a[0].separator).join("")));l.push(Number(m));for(k in p[1])p[1][k][a[1].id]==e&&(m=p[1][f][a[1].data[0]],a[1].separator&&(m=Number(m.split(a[1].separator).join(""))));l.push(m);b.push(l)}}return b};f.correlation=function(b,c,a){var d=[],e;for(e in b[c])b[a][e]&&d.push(e);e=d.length;if(0===
    e)return 0;var g=0,f;for(f=0;f<d.length;f++)g+=b[c][d[f]];var k=0;for(f=0;f<d.length;f++)k+=b[a][d[f]];var l=0;for(f=0;f<d.length;f++)l+=Math.pow(b[c][d[f]],2);var m=0;for(f=0;f<d.length;f++)m+=Math.pow(b[a][d[f]],2);var p=0;for(f=0;f<d.length;f++)p+=b[c][d[f]]*b[a][d[f]];b=Math.sqrt((l-Math.pow(g,2)/e)*(m-Math.pow(k,2)/e));return 0===b?0:(p-g*k/e)/b};return f});
define("myScripts/HandlePicks",["myScripts/Chart","myScripts/Correlation"],function(f,b){var c=function(){this.chart=new f};c.prototype.getBigDoxels=function(a,b,c){return function(g){var f=g.clientX,k;g=c.pick(c.canvasCoordinates(f,g.clientY));if(0<g.objects.length)for(var l=0;l<g.objects.length;l++)if(g.objects[l].isOnTop){for(f in a)if(-1!=a[f].cubes.indexOf(g.objects[l].userObject)){for(k in b)b[k].renderables[f].enabled=!0,b[k].renderables[f].active=!0;for(var m in a[f].cubes)a[f].cubes[m]&&
(a[f].cubes[m].enabled=!1,a[f].cubes[m].bigCubed=!0);c.redraw();break}for(k in b)for(f in b[k].renderables)if(b[k].renderables[f]==g.objects[l].userObject){for(var p in b)b[p].renderables[f].enabled=!1,b[p].renderables[f].active=!1;for(var q in a[f].cubes)a[f].cubes[q]&&(a[f].cubes[q].enabled=!0,a[f].cubes[q].bigCubed=!1);c.redraw();break}}}};c.prototype.getDoxel=function(a){var c=this,e=a.globe,g=a.compare,f=a.config;return function(k){var l=k.clientX;k=e.pick(e.canvasCoordinates(l,k.clientY));if(0<
    k.objects.length)for(var m=0;m<k.objects.length;m++)if(k.objects[m].isOnTop){if(c.highLighted&&c.highLighted.userObject==k.objects[m].userObject)c.resetSelected();else{c.resetSelected();c.highLighted=k.objects[m];for(l in k.objects[m].userObject._positions)k.objects[m].userObject._positions[l].altitude+=500;var p=k.objects[m].userObject.id;if(void 0!==p){var q=["Time"],t=[f[0].data];if(f[1])q.push("Set 1","Set 2"),t=[f[0].data,f[1].data];else for(var r=0;r<f[0].data.length;r++)q.push("Variable "+
    (r+1));p={names:q,values:t,id:p};$("#bottomMenu").show();q=a.myData[g].bounds[1];p=b.getCorrelationVariables(p,a.times,a.config,a.config[0].data.length);if(0<p.length)var u=google.visualization.arrayToDataTable(p);c.chart.draw(u,{title:"Voxel Data",hAxis:{title:"Timestamp",titleTextStyle:{color:"#333"},slantedText:!1},vAxis:{minValue:q,format:"scientific"}});if(f[0]||0<f[1].data.length){u=[[],[]];for(l=0;l<p.length;l++)0!==l&&(u[0].push(p[l][1]),u[1].push(p[l][2]));u=b.correlation(u,0,1);u=Number(Math.round(u+
        "e5")+"e-5");q="variables";f[0]&&(q="datasets");$("#correlationVoxel").text("Correlation between "+q+" in selected voxel: "+u)}u=a.allTime[a.UI.oldValTime];q=0;for(l in p)p[l][0]==u&&(q=l-1);c.chart.setPoint(q,g);k.objects[m].userObject.reset();k.objects[m].userObject._attributes._outlineColor=new WorldWind.Color(1,1,1,.65);k.objects[m].userObject._attributes._drawOutline=!0;e.redraw()}else if(u=k.objects[m].userObject.data)$("#correlationVoxel").text("Value of selected Big Doxel: "+u),$("#bottomMenu").show()}break}}};
    c.prototype.resetSelected=function(){try{if(this.highLighted){for(var a in this.highLighted.userObject._positions)this.highLighted.userObject._positions[a].altitude-=500;this.highLighted.userObject._attributes._drawOutline=!1;this.highLighted.userObject.reset()}this.highLighted=""}catch(b){}};return c});
define("myScripts/UserInterface",["myScripts/Correlation"],function(f){var b=function(b){this.parent=b};b.prototype.start=function(){var b=this.parent;this.oldValLng=[0,b.dim.y*b.sub];this.oldValLat=[0,b.dim.x*b.sub];this.oldValAlt=[0,b.activeLayers];this.oldValTime=0;this.startSlider(b);$("#minVal").html("Min: <br>"+b.myData[0].bounds[1]);$("#maxVal").html("Max: <br>"+b.myData[0].bounds[0]);1<b.config[0].data.length&&(new Promise(function(a){f.getCorrelationDatasets(a,b.times,b.config)})).then(function(a){(a=
    Number(Math.round(a+"e7")+"e-7"))||(a="unavailable");var d;d=b.config[1]?"datasets":"variables";$("#correlation").text("Correlation between "+d+": "+a)})};b.prototype.disableNewData=function(){$("#compare").attr("disabled",!0);$("#compareOptions").hide()};b.prototype.resetTime=function(b){var a=this.parent;a.startHeight=b;a.changeAltitude(this.oldValAlt);a.changeTime(0);$("#sliderTime").slider("value",0);$("#timeSpan").html(a.allTime[0])};b.prototype.alert=function(b){var a=$("#alert");a.css("visibility",
    "visible");a.css("opacity",1);$("#alertContent").html(b)};b.prototype.startSlider=function(b){for(var a=this,d=b.rect,e=$("#sliderLng"),g=$("#LngSpan"),f=$("#sliderLat"),k=$("#LatSpan"),l=$("#sliderAlt"),m=$("#AltSpan"),p=$("#sliderTime"),q=$("#TimeSpan"),t=$("#sliderOpacity"),r=$("#OpacitySpan"),u=$("#sliderValues"),w=$("#ValuesSpan"),x=0,A=0;A<d.length;A++)x=Math.max(d[A].cubes.length,x);x=Math.floor(Math.sqrt(x));e.slider({min:0,max:b.dim.y*b.sub,range:!0,step:b.dim.y/x,values:[0,b.dim.y*b.sub],
    slide:function(d,e){e.values[0]!=e.values[1]&&(g.html(Math.floor(e.values[0]/(b.dim.y*b.sub)*100)+" - "+Math.floor(e.values[1]/(b.dim.y*b.sub)*100)+"%"),b.changeSize(e.values,1),b.moveWindow(e.values[0]>a.oldValLng[0]||e.values[1]<a.oldValLng[1]?0:1),b.globe.redraw(),a.oldValLng=e.values)}});f.slider({min:0,max:b.dim.x*b.sub,range:!0,step:b.dim.x/x,values:[0,b.dim.x*b.sub],slide:function(d,e){e.values[0]!=e.values[1]&&(k.html(Math.floor(e.values[0]/(b.dim.x*b.sub)*100)+" - "+Math.floor(e.values[1]/
        (b.dim.x*b.sub)*100)+"%"),b.changeSize(e.values,0),b.moveWindow(e.values[0]>a.oldValLat[0]||e.values[1]<a.oldValLat[1]?0:1),b.globe.redraw(),a.oldValLat=e.values)}});w.html(b.myData[0].bounds[1]+" - "+b.myData[0].bounds[0]);u.slider({min:b.myData[0].bounds[1],max:b.myData[0].bounds[0],range:!0,step:(b.myData[0].bounds[0]-b.myData[0].bounds[1])/100,values:[b.myData[0].bounds[1],b.myData[0].bounds[0]],slide:function(a,d){d.values[0]!=d.values[1]&&(w.html(d.values[0]+" - "+d.values[1]),b.filterValues(d.values),
    b.globe.redraw())}});l.slider({min:0,max:b.activeLayers,step:1,range:!0,values:[0,b.activeLayers],slide:function(d,e){e.values[0]!=e.values[1]&&(m.html(e.values[0]+" - "+e.values[1]),b.changeAltitude(e.values),a.oldValAlt=e.values)}});d=b.smallVoxels.layers.length-b.allTime.slice(0,b.activeLayers).length;q.html(b.allTime[0]);p.slider({min:0,max:d,range:!1,step:1,slide:function(d,e){q.html(b.allTime[e.value]);b.changeTime(e.value);if(b.autoTime){var g=$("#checkCompare").is(":checked")?1:0;b.compare=
    g;b.UI.resetValueFilter();b.makeBigDoxels()}var g=b.allTime[e.value],f=0;for(A in b.allTime)b.allTime[A]==g&&(f=A-1);g=$("#checkCompare").is(":checked")?1:0;a.handlePick.chart.started&&a.handlePick.chart.setPoint(f,g);b.changeAltitude(a.oldValAlt);a.oldValTime=e.value}});t.slider({min:0,max:100,range:!1,step:1,value:0,slide:function(a,d){var e=d.value;100>d.value&&95<d.value&&(e=95);5>d.value&&0<d.value&&(e=0);r.html(100-d.value+"%");b.setOpacity((100-e)/100);b.globe.redraw()}});$("#loading").hide();
    b.started||(b.started=1,b._navigator.lookAtLocation.latitude=b.gridLayer.renderables[1].point[0],b._navigator.lookAtLocation.longitude=b.gridLayer.renderables[1].point[1],b._navigator.range=2E5,p=$("#my-tour-id1").tourbus({}),$("#my-tour-id").tourbus({}).trigger("stop.tourbus"),tourStarted&&p.trigger("depart.tourbus"))};b.prototype.resetValueFilter=function(){gInterface=this.parent;var b=gInterface.compare;gInterface.filterValues([gInterface.myData[b].bounds[1],gInterface.myData[b].bounds[0]]);$("#sliderValues").slider("values",
    [gInterface.myData[b].bounds[1],gInterface.myData[b].bounds[0]]);$("#ValuesSpan").html(gInterface.myData[b].bounds[1]+" - "+gInterface.myData[b].bounds[0])};return b});
define("myScripts/map/BoundingBox",[],function(){var f=function(b,c,a,d){this._top=a;this._left=c;this._bottom=b;this._right=d};Object.defineProperties(f.prototype,{top:{get:function(){return this._top}},left:{get:function(){return this._left}},bottom:{get:function(){return this._bottom}},right:{get:function(){return this._right}}});f.prototype.isPartiallyInArea=function(b){return this.isFullyInArea(b)||this.isFullyInAreaCrossingDateline(b)||this.isEnclosedByArea(b)||this.isPartInArea(b)};f.prototype.isPartInArea=
    function(b){return!(this.left>=b.right||b.left>=this.right||this.top<=b.bottom||b.top<=this.bottom)};f.prototype.isFullyInArea=function(b){return this.top<b.top&&this.left>b.left&&this.right<b.right&&this.bottom>b.bottom};f.prototype.isFullyInAreaCrossingDateline=function(b){return this.top<b.top&&this.bottom>b.bottom&&this.left>b.left&&this.right>b.right&&b.right<b.left||this.top<b.top&&this.bottom>b.bottom&&this.right<b.right&&this.left<b.left&&b.right<b.left};f.prototype.isEnclosedByArea=function(b){return this.top>
    b.top&&this.left<b.left&&this.right>b.right&&this.bottom<b.bottom};f.prototype.toString=function(){return"["+this.top+","+this.left+","+this.bottom+","+this.right+"]"};return f});
define("myScripts/map/CoordConversions",[],function(){var f=function(){};f.prototype.isDatelineInViewport=function(b){for(var c=0,a=!1,d=0;d<b.length;d++)180<Math.abs(b[d][1]-c)&&(a=!0),c=b[d][1];return a};f.prototype.isPoleInViewport=function(b){var c=b.length,a=b[c/8];b=b[5*c/8];if(180==Math.abs(a[1])+Math.abs(b[1])){if(0<a[0]&&0<b[0])return"north";if(0>a[0]&&0>b[0])return"south"}return"none"};f.prototype.isPoleVisible=function(b){return 0==b[0][1]-b[b.length/2][1]?"none":Math.abs(b[b.length/2][0])>=
Math.abs(b[0][0])&&0<b[b.length/2][0]?"north":"south"};f.prototype.transformVisibleToBoundaries=function(b){return-180>b?360+b:180<b?-360+b:b};f.prototype.carto2geoConversion=function(b,c,a,d,e){b=b*Math.PI/180;c=c*Math.PI/180;d=d*Math.PI/180;var g=[],f=Math.asin(Math.sin(b)*Math.sin(a)-Math.cos(a)*Math.cos(b)*Math.cos(d));b=!0===this.poleVisibility(a,b)&&0<=b?!0===e?Math.PI+Math.asin(Math.sin(d)*Math.cos(a)/Math.cos(f))+c:-Math.asin(Math.sin(d)*Math.cos(a)/Math.cos(f))+c:!0===this.poleVisibility(a,
    b)&&0>b?!0===this.poleVisibility(a,b)&&!0===e?Math.asin(Math.sin(d)*Math.cos(a)/Math.cos(f))+c:Math.PI-Math.asin(Math.sin(d)*Math.cos(a)/Math.cos(f))+c:-Math.asin(Math.sin(d)*Math.cos(a)/Math.cos(f))+c;f=Math.round(180*f/Math.PI*10)/10;b=Math.round(180*b/Math.PI*10)/10;g.push(f,b);return g};f.prototype.poleVisibility=function(b,c){var a=180*b/Math.PI,d=180*c/Math.PI;return 0<=d?90<90-a+d:90<90-a-d};return f});
define("myScripts/map/VisibleArea",["./BoundingBox","./CoordConversions","src/WorldWind"],function(f,b){var c=WorldWind.Vec2,a=function(a){this._viewport=a.viewport;this._eyeGeoCoord=a.eyeGeoCoord;this._range=a.range;this._worldWindow=a.wwd;this._conversions=new b};a.prototype.getPosition=function(a){a=this._worldWindow.pickTerrain(a).objects;return 0<a.length?a[0].position:null};a.prototype.visibilityStatus=function(){var a=this.getPosition([1,1]),b=this.getPosition([this._viewport().width-1,this._viewport().height/
2]),c=this.getPosition([this._viewport().width/2,this._viewport().height-1]),f=this.getPosition([1,this._viewport().height/2]);return null==a&&null==b&&null==c&&null==f?0:null!=a&&null!=b&&null!=c&&null!=f?2:1};a.prototype.getVisibleArea4FullViewport=function(){for(var a=this._viewport(),b=a.width-2,g=a.height-2,a=[],f=[],k=0;2>k;k++)a[k]=new c(1+b/2*k,1),a[k+2]=new c(1+b,1+g/2*k),a[k+4]=new c(2+b-(1+b/2*k),1+g),a[k+6]=new c(1,2+g-(1+g/2*k));for(b=0;b<a.length;b++)g=this.getPosition(a[b]),null!=g&&
f.push([Math.round(10*g.latitude)/10,Math.round(10*g.longitude)/10]);return this.inBoundingBox(f)};a.prototype.getVisibleArea4PartGlobe=function(){for(var a=this._viewport(),b=a.width-2,a=a.height-2,g=[],f=0;11>f;f++)for(var k=0;11>k;k++){var l=new c(1+b/10*k,1+a/10*f),l=this.getPosition(l);null!=l&&g.push([Math.round(l.latitude),Math.round(l.longitude)])}return this.inBoundingBox(g)};a.prototype.getVisibleArea4FullGlobe=function(){for(var a=this._eyeGeoCoord().latitude,b=this._eyeGeoCoord().longitude,
                                                                                                                                                                                                                                                                                                                                                                                                                                                            c=Math.asin(6378E3/(6378E3+this._range())),f=[0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],k=[],l=!1,m=360,p=0;p<f.length;p++)k[p]=this._conversions.carto2geoConversion(a,b,c,f[p],l),l=0==l?k[p][1]>m:k[p][1]<m,k[p]=this._conversions.carto2geoConversion(a,b,c,f[p],l),m=k[p][1],k[p][1]=this._conversions.transformVisibleToBoundaries(k[p][1]);return this.inBoundingBox(k)};a.prototype.inBoundingBox=function(a){var b=
    -90,c=90,h=180,k=-180,l=this.visibilityStatus();this._conversions.isDatelineInViewport(a)?(h=180,k=-180,a.forEach(function(a){var d=a[0];a=a[1];d>b&&(b=d);d<c&&(c=d);a<h&&0<a&&(h=a);a>k&&0>a&&(k=a)})):a.forEach(function(a){var d=a[0];a=a[1];d>b&&(b=d);d<c&&(c=d);a<h&&(h=a);a>k&&(k=a)});2==l?"north"==this._conversions.isPoleInViewport(a)?(b=90,h=-180,k=180):"south"==this._conversions.isPoleInViewport(a)&&(c=-90,h=-180,k=180):0==l?"north"==this._conversions.isPoleVisible(a)?(b=90,h=-180,k=180):"south"==
this._conversions.isPoleVisible(a)&&(c=-90,h=-180,k=180):1==l&&(b+=5,c-=5,h-=5,k+=5,84<b?(b=90,h=-180,k=180):-84>c&&(c=-90,h=-180,k=180));return new f(c,h,b,k)};return a});
define("myScripts/navigator/MoveNavigator",["../map/VisibleArea"],function(f){var b=WorldWind.LookAtNavigator,c=function(a){b.call(this,a.wwd);a.wwd.navigator=this;this._lastRange=0;this._zoomLevelListeners=a.zoomLevelListeners||[];this._viewPortChangeListeners=a.viewPortChangedListeners||[];this._zoomLevel=10;this.range=23440143;this.lookAtLocation.latitude=10;this.lookAtLocation.longitude=15;var c=this;this._visibleArea=new f({viewport:function(){return c.worldWindow.viewport},eyeGeoCoord:function(){return c.lookAtLocation},
    range:function(){return c.range},wwd:c.worldWindow})};c.prototype=Object.create(b.prototype);c.prototype.handleWheelEvent=function(a){b.prototype.handleWheelEvent.apply(this,arguments);this._zoomLevel!=this.getZoomLevel()&&this.callListeners(this._zoomLevelListeners);this._lastRange=this.range};c.prototype.getRange=function(){return this.range};c.prototype.getZoomLevel=function(){var a=[8E5,2E6,5E6,1E7];this.getRange()<a[0]&&this._lastRange>a[0]&&(this._zoomLevel=1);this.getRange()>a[0]&&this.getRange()<
a[1]&&(this._lastRange<a[0]||this._lastRange>a[1])&&(this._zoomLevel=2);this.getRange()>a[1]&&this.getRange()<a[2]&&(this._lastRange<a[1]||this._lastRange>a[2])&&(this._zoomLevel=5);this.getRange()>a[2]&&this.getRange()<a[3]&&(this._lastRange<a[2]||this._lastRange>a[3])&&(this._zoomLevel=10);this.getRange()>a[a.length-1]&&this._lastRange<a[a.length-1]&&(this._zoomLevel=20);return this._zoomLevel};c.prototype.handlePanOrDrag=function(a){b.prototype.handlePanOrDrag.apply(this,arguments);a.state==WorldWind.ENDED&&
this.callListeners(this._viewPortChangeListeners)};c.prototype.getVisibleAreaBoundaries=function(){var a=this._visibleArea.visibilityStatus();return 0==a?this._visibleArea.getVisibleArea4FullGlobe():1==a?this._visibleArea.getVisibleArea4PartGlobe():this._visibleArea.getVisibleArea4FullViewport()};c.prototype.callListeners=function(a){a.forEach(function(a){a()})};return c});
define("scripts/Controls",[],function(){var f=function(b){this.wwd=b;this.exaggerationIncrement=.01;this.zoomIncrement=.04;this.tiltIncrement=this.headingIncrement=1;this.fieldOfViewIncrement=.1;this.panIncrement=.001;this.setupInteraction()};f.prototype.setupInteraction=function(){$("#zoom-plus-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleZoomIn),mouseup:this.handleMouseEvent.bind(this,this.handleZoomIn)});$("#zoom-minus-control").on({mousedown:this.handleMouseEvent.bind(this,
    this.handleZoomOut),mouseup:this.handleMouseEvent.bind(this,this.handleZoomOut)});$("#tilt-less-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleTiltUp),mouseup:this.handleMouseEvent.bind(this,this.handleTiltUp)});$("#tilt-more-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleTiltDown),mouseup:this.handleMouseEvent.bind(this,this.handleTiltDown)});$("#rotate-right-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleHeadingRight),mouseup:this.handleMouseEvent.bind(this,
    this.handleHeadingRight)});$("#rotate-left-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleHeadingLeft),mouseup:this.handleMouseEvent.bind(this,this.handleHeadingLeft)});$("#rotate-needle-control").on({mouseup:this.handleHeadingReset.bind(this)});this.wwd.addEventListener("mousemove",this.handleManualRedraw.bind(this))};f.prototype.handleMouseEvent=function(b,c){c.type&&("mouseup"===c.type&&1===c.which||"touchend"===c.type||"touchcancel"===c.type)?this.handleOperationEnd(c):this.handleOperationStart(b,
    c)};f.prototype.handleOperationStart=function(b,c){if("mousedown"===c.type&&1===c.which||"touchstart"===c.type){this.activeOperation=b;c.preventDefault();var a=this,d=function(){a.activeOperation&&(b.call(a),setTimeout(d,50))};setTimeout(d,50)}};f.prototype.handleOperationEnd=function(b){this.activeOperation=null;b.preventDefault()};f.prototype.handleZoomIn=function(){this.wwd.navigator.range*=1-this.zoomIncrement;this.wwd.redraw()};f.prototype.handleZoomOut=function(){this.wwd.navigator.range*=1+
    this.zoomIncrement;this.wwd.redraw()};f.prototype.handleHeadingRight=function(){this.wwd.navigator.heading-=this.headingIncrement;this.wwd.redraw();this.redrawHeadingIndicator()};f.prototype.handleHeadingLeft=function(){this.wwd.navigator.heading+=this.headingIncrement;this.wwd.redraw();this.redrawHeadingIndicator()};f.prototype.handleHeadingReset=function(){var b=1;60<Math.abs(this.wwd.navigator.heading)?b=2:120<Math.abs(this.wwd.navigator.heading)&&(b=3);0<this.wwd.navigator.heading&&(b=-b);var c=
    this,a=function(){Math.abs(c.wwd.navigator.heading)>Math.abs(b)?(c.wwd.navigator.heading+=b,c.wwd.redraw(),c.redrawHeadingIndicator(),setTimeout(a,10)):(c.wwd.navigator.heading=0,c.wwd.redraw(),c.redrawHeadingIndicator())};setTimeout(a,10)};f.prototype.redrawHeadingIndicator=function(){var b=0-this.wwd.navigator.heading-45;$("#rotate-needle-control").find("i").css("transform","rotate("+b+"deg)")};f.prototype.handleTiltUp=function(){this.wwd.navigator.tilt=Math.max(0,this.wwd.navigator.tilt-this.tiltIncrement);
    this.wwd.redraw()};f.prototype.handleTiltDown=function(){this.wwd.navigator.tilt=Math.min(90,this.wwd.navigator.tilt+this.tiltIncrement);this.wwd.redraw()};f.prototype.handleManualRedraw=function(b){b.which&&(this._lastHeading=this._lastHeading||0,this.wwd.navigator.heading!=this._lastHeading&&this.redrawHeadingIndicator(),this._lastHeading=this.wwd.navigator.heading)};return f});var gInterface,appConstructor,tourStarted=0;
define("myScripts/ESTWA","myScripts/AppConstructor myScripts/GlobeInterface myScripts/Globe myScripts/Configurator myScripts/HandlePicks myScripts/UserInterface myScripts/GlobeHelper myScripts/navigator/MoveNavigator scripts/Controls".split(" "),function(f,b,c,a,d,e,g,h,k){return function(l){function m(b){var c=new a,d=0===r?$("#csv-file").get(0).files[0]:$("input[option='re1']").val();(new Promise(function(a){c.getConfig(d,a)})).then(function(a){for(var c=0;c<a.length;c++)$(".timeConfig, .gridConfig, .dataConfig, .latitudeConfig, .longitudeConfig").append($("<option></option>").attr("value",
    c).text(a[c]));loadConfig=!0;b&&b()});$("#configType").show();$("#advanced").show();$("#start").show()}var p=new c({id:l.globe});new k(p);gInterface=new b(p);appConstructor=new f;gInterface._navigator=new h({wwd:gInterface.globe,zoomLevelListeners:[gInterface.globe.redraw.bind(this)],viewPortChangedListeners:[gInterface.globe.redraw.bind(this),appConstructor.addCsv.bind(appConstructor,gInterface)]});gInterface.setUI(new e(gInterface));var q=new d;gInterface.UI.handlePick=q;var t=0;$("#changeValues").click(function(){var a=
    Number($("#changeHeight").val()),b=Number($("#changeBig").val()),c=Number($("#changeStat").val());gInterface.updateOpt([a,b,c])});var r=1;$("#fileType").change(function(){var a=$("#fileType").val();"1"==a?($("#csv-file").show(),$("#hostedFileSelector").hide(),$("#loadConfig").show(),r=0):("2"==a?($("#csv-file").hide(),$("#hostedFileSelector").show(),$("#loadConfig").show()):($("#csv-file").hide(),$("#hostedFileSelector").hide(),$("#sample").show()),r=1)});var u=1;$("#gridType").change(function(){"1"==
$("#gridType").val()?($("#grid-file").show(),$("#hostedGridSelector").hide(),u=0):($("#grid-file").hide(),$("#hostedGridSelector").show(),u=1)});$("#checkCompare").change(function(){t=$("#checkCompare").is(":checked")?1:0;gInterface.compare=t;gInterface.UI.resetValueFilter()});$("input[name=optradio]").change(function(){var a=Number($("input[name=optradio]:checked","#radioButtons").val());p.eventListeners.dblclick&&p.removeEventListener("dblclick",self.handlePick);a?(gInterface.UI.resetValueFilter(),
    gInterface.makeBigDoxels(),a=q.getBigDoxels(gInterface.rect,gInterface.bigVoxels.layers,p),p.addEventListener("dblclick",a),self.handlePick=a):(a=q.getDoxel(gInterface),self.handlePick=a,p.addEventListener("dblclick",a))});$("#autoTile").change(function(){var a=$("#autoTile").is(":checked")?1:0;gInterface.autoTile=a});$("#atmosphere-icon").click(function(){p.layers[3].enabled?(p.layers[3].enabled=!1,$("#atmosphere-icon").attr("style","color: #444 !important")):(p.layers[3].enabled=!0,$("#atmosphere-icon").css("color",
    "#2f6eff"));p.redraw()});$("#loadConfigCompare").click(function(){$("#configSelectorCompare").show();configurator=new a;var b=$("input[option='co1']").val();(new Promise(function(a){configurator.getConfig(b,a)})).then(function(a){for(var b=0;b<a.length;b++)$("#timeConfigCompare, #gridConfigCompare, #dataConfigCompare").append($("<option></option>").attr("value",b).text(a[b]))})});$("#addData").click(function(){try{var a=$("input[option='co1']").val(),b=$("input[option='co6']").val(),c=Number($("select[option='co3']").val()),
    d=Number($("select[option='co4']").val()),e=$("input[option='co2']").val(),g=$("select[option='co5']").val();$(".checkCompare").show();appConstructor.newData({time:c,id:d,data:g,half:1,separator:e,idSeparator:b,url:a,reference:0},gInterface);$("#afterType option[value=2]").attr("disabled","disabled")}catch(f){gInterface.UI.alert(f)}});$("#start").click(function(){$("#loading").show();$("#my-tour-id").tourbus({}).trigger("stop");$("#openButton").click();var a=0;if(0===u)var b=$("#grid-file").get(0).files[0],
    a=1;else b=$("input[option='gr1']").val();var c=0===r?$("#csv-file").get(0).files[0]:$("input[option='re1']").val(),d=Number($("select[option='re3']").val()),e=Number($("select[option='re4']").val()),f=$("input[option='re2']").val(),h=$("input[option='re6']").val(),k=$("select[option='re5']").val(),l=Number($(".latitudeConfig").val()),m=Number($(".longitudeConfig").val()),p=Number($("select[option='re8']").val()),q=Number($("input[option='re10']").val()),t=$("select[option='re9']").val(),L=$("input[option='heightExtrusion']").is(":checked")?
        1:0,M=$("input[option='isUrl']").is(":checked")?1:0,I=$("input[option='csvImporting']").is(":checked")?1:0,K=Number($("input[option='heightCube']").val()),O=Number($("input[option='shown']").val()),N=Number($("input[option='maxApp']").val()),R=Number($("input[option='subxy']").val()),S=Number($("input[option='subz']").val()),P=Number($("input[option='initH']").val()),Q=Number($("select[option='statIndex']").val()),X=Number($("input[option='monthRange1']").val()),V=Number($("input[option='monthRange2']").val()),
    Y=$("input[option='coverage']").val();$("#alert").css("visibility","hidden");$("#alert").css("visibility","hidden");$("#controls").hide();$(".afterControls").show();var W=$("input[name='maxcolor']").val(),U=$("input[name='mincolor']").val(),T=$("input[name='midcolor']").val(),Z=[g.getRGB(U),g.getRGB(T),g.getRGB(W)];$("#legendScale").css("background","linear-gradient(to bottom,"+U+" 0%,"+T+" 50%,"+W+" 100%)");$("#legendScale").css("background","-moz-linear-gradient(to bottom,"+U+" 0%,"+T+" 50%,"+W+
    " 100%)");$("#legendScale").css("background","-webkit-linear-gradient(to bottom,"+U+" 0%,"+T+" 50%,"+W+" 100%)");W=$("input[option='refSystem']").val();U=Number($("input[option='csvZone']").val());(I||M)&&$(".autoTile").show();try{appConstructor.init({globe:"canvasOne",gridUrl:b,isCSV:I,csv:{csvUrl:c,zone:U,source:W,time:p,data:t,quadSub:q,delimiter:";"},config_0:{time:d,id:e,data:k,half:0,separator:f,idSeparator:h,url:c,reference:0,heightExtrusion:L,lat:l,lng:m,monthRange1:X,monthRange2:V,coverage:Y},
    isLocal:a,isUrl:M,heightCube:K,maxShown:O,maxInApp:N,startHeight:P,sub:R,heightDim:S,autoTime:0,statIndex:Q,maxDownload:2E3,colors:Z},gInterface)}catch(aa){gInterface.UI.alert(aa)}});$("#teleSample").click(function(){$("input[option='re1']").val("data/blocks.csv");$("#loading").show();(new Promise(function(a){m(a)})).then(function(){$("input[option='gr1']").val("data/grid.txt");$("select[option='re4']").val(1);$("select[option='re3']").val(0);$("select[option='re5']").val([2,4]);$("input[option='re2']").val(".");
    $("input[option='re6']").val("_");$("input[option='shown']").val(3);$("#configType").val(4);$("#configType").change();$("#loading").hide()})});$("#turinSample").click(function(){$("#loading").show();$("input[option='re1']").val("data/torino.csv");$("#loadConfig").click();(new Promise(function(a){m(a)})).then(function(){$("input[option='csvImporting']").prop("checked",!0);$("select[option='re8']").val(0);$("select[option='re9']").val([1,2]);$(".latitudeConfig").val(3);$(".longitudeConfig").val(4);
    $("input[option='heightExtrusion']").prop("checked",!0);$("#configType").val(4);$("#configType").change();$("#loading").hide()})});$("#fullSample").click(function(){$("#loading").show();$("input[option='re1']").val("data/full.csv");$("#loadConfig").click();(new Promise(function(a){m(a)})).then(function(){gInterface._navigator.lookAtLocation.longitude=14.209447413225549;gInterface._navigator.lookAtLocation.latitude=37.70978565490195;gInterface._navigator.range=312535.24849800026;$("input[option='csvImporting']").prop("checked",
    !0);$("select[option='re8']").val(3);$("select[option='re9']").val([2]);$(".latitudeConfig").val(0);$(".longitudeConfig").val(1);$("#configType").val(4);$("#configType").change();$("#loading").hide()})});$("#litoSample").click(function(){$("#loading").show();$("input[option='re1']").val("data/chalk_small.csv");$("#loadConfig").click();(new Promise(function(a){m(a)})).then(function(){$("input[option='csvImporting']").prop("checked",!0);$("select[option='re8']").val(4);$("input[option='re10']").val(4);
    $("select[option='re9']").val([2,3]);$(".latitudeConfig").val(1);$(".longitudeConfig").val(0);$("input[option='initH']").val(0);$("input[option='heightCube']").val(200);$("input[option='heightExtrusion']").prop("checked",!0);$("#configType").val(4);$("#configType").change();$("#loading").hide()})});$("#rasdaSample").click(function(){$("#loadConfig").click();(new Promise(function(a){$("#loading").show();m(a)})).then(function(){$("input[option='re1']").val("http://ows.rasdaman.org/rasdaman/ows");$("input[option='isUrl']").prop("checked",
    !0);$("input[option='monthRange2']").val(1);gInterface._navigator.lookAtLocation.longitude=14.209447413225549;gInterface._navigator.lookAtLocation.latitude=37.70978565490195;gInterface._navigator.range=312535.24849800026;$("input[option='initH']").val(1E4);$("input[option='heightCube']").val(1E4);$("input[option='shown']").val(1);$("#configType").val(4);$("#configType").change();$("#loading").hide()})})}});requirejs.config({baseUrl:".",paths:{app:"../src"}});
require(["myScripts/ESTWA"],function(f){new f({globe:"canvasOne"});$("#loading").hide();$("#my-tour-id").tourbus({}).trigger("depart.tourbus");$("#openButton").click(function(){$("#controlMenu").data("open")?($("#controlMenu").css("left","-30%"),$("#controlMenu").data("open",0),$("#openButton").css("right","-40px")):($("#controlMenu").css("left","0%"),$("#openButton").css("right","-5px"),$("#controlMenu").data("open",1))});$("#hideStatistics").click(function(){$("#bottomMenu").hide()});$("input[option='heightExtrusion']").change(function(){var b=
    $("input[option='heightExtrusion']").is(":checked")?1:0;2>$("select[option='re5']").val().length?(gInterface.UI.alert("Error: At least two Data values must be selected to apply the extrusion"),$("input[option='heightExtrusion']").prop("checked",!1)):b?($("input[option='shown']").val(1),$("input[option='shown']").attr("disabled",!0)):$("input[option='shown']").attr("disabled",!1)});$("#configType").change(function(){var b=$("#configType option:selected").val();1==b&&($("#configSelector").show(),$("#CSVOptions").hide(),
    $("#dbOptions").hide(),$("#advancedOptions").hide());2==b&&($("#configSelector").hide(),$("#CSVOptions").show(),$("#dbOptions").hide(),$("#advancedOptions").hide());3==b&&($("#configSelector").hide(),$("#CSVOptions").hide(),$("#dbOptions").show(),$("#advancedOptions").hide());4==b&&($("#configSelector").hide(),$("#CSVOptions").hide(),$("#dbOptions").hide(),$("#advancedOptions").show())});$("#afterType").change(function(){var b=$("#afterType option:selected").val();0==b&&($("#sliders").show(),$("#updateSettings").hide(),
    $("#compareOptions").hide());1==b&&($("#sliders").hide(),$("#updateSettings").show(),$("#compareOptions").hide());2==b&&($("#sliders").hide(),$("#updateSettings").hide(),$("#compareOptions").show())})});define("main",function(){});