/**
 * @license almond 0.3.0 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
 * Copyright (C) 2014 United States Government as represented by the Administrator of the
 * National Aeronautics and Space Administration. All Rights Reserved.
 */

/*
 * Copyright (C) 2015 United States Government as represented by the Administrator of the
 * National Aeronautics and Space Administration. All Rights Reserved.
 */

/*
 * @license
 * Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 * Copyright 2014, Google Inc. All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice including the dates of first publication and
 * either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 * shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 * IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * Original Code. The Original Code is: OpenGL Sample Implementation,
 * Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 * Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 * Copyright in any portions created by third parties is as indicated
 * elsewhere herein. All Rights Reserved.
 */

/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.0.2
 */

/*!

JSZip - A Javascript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2014 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/

/**
 * The following functions come from pako, from pako/lib/utils/strings
 * released under the MIT license, see pako https://github.com/nodeca/pako/
 */

/*
 * Copyright (C) 2017 United States Government as represented by the Administrator of the
 * National Aeronautics and Space Administration. All Rights Reserved.
 */

/*! decimal.js v5.0.8 https://github.com/MikeMcl/decimal.js/LICENCE */

/*
	   *  decimal.js v5.0.8
	   *  An arbitrary-precision Decimal type for JavaScript.
	   *  https://github.com/MikeMcl/decimal.js
	   *  Copyright (c) 2016 Michael Mclaughlin <M8ch88l@gmail.com>
	   *  MIT Expat Licence
	   */

/**
	 * @license Complex.js v2.0.1 11/02/2016
	 *
	 * Copyright (c) 2016, Robert Eisele (robert@xarg.org)
	 * Dual licensed under the MIT or GPL Version 2 licenses.
	 **/

/**
	 * @license Fraction.js v3.3.1 09/09/2015
	 * http://www.xarg.org/2014/03/precise-calculations-in-javascript/
	 *
	 * Copyright (c) 2015, Robert Eisele (robert@xarg.org)
	 * Dual licensed under the MIT or GPL Version 2 licenses.
	 **/

/**
	   * Round a value towards zero.
	   * For matrices, the function is evaluated element wise.
	   *
	   * Syntax:
	   *
	   *    math.fix(x)
	   *
	   * Examples:
	   *
	   *    math.fix(3.2);                // returns number 3
	   *    math.fix(3.8);                // returns number 3
	   *    math.fix(-4.2);               // returns number -4
	   *    math.fix(-4.7);               // returns number -4
	   *
	   *    var c = math.complex(3.2, -2.7);
	   *    math.fix(c);                  // returns Complex 3 - 2i
	   *
	   *    math.fix([3.2, 3.8, -4.7]);   // returns Array [3, 3, -4]
	   *
	   * See also:
	   *
	   *    ceil, floor, round
	   *
	   * @param {number | BigNumber | Fraction | Complex | Array | Matrix} x Number to be rounded
	   * @return {number | BigNumber | Fraction | Complex | Array | Matrix}            Rounded value
	   */

// Copyright Joyent, Inc. and other Node contributors.

// distribute, sublicense, and/or sell copies of the Software, and to permit

// The above copyright notice and this permission notice shall be included

/**
	   * Round a value towards plus infinity
	   * If `x` is complex, both real and imaginary part are rounded towards plus infinity.
	   * For matrices, the function is evaluated element wise.
	   *
	   * Syntax:
	   *
	   *    math.ceil(x)
	   *
	   * Examples:
	   *
	   *    math.ceil(3.2);               // returns number 4
	   *    math.ceil(3.8);               // returns number 4
	   *    math.ceil(-4.2);              // returns number -4
	   *    math.ceil(-4.7);              // returns number -4
	   *
	   *    var c = math.complex(3.2, -2.7);
	   *    math.ceil(c);                 // returns Complex 4 - 2i
	   *
	   *    math.ceil([3.2, 3.8, -4.7]);  // returns Array [4, 4, -4]
	   *
	   * See also:
	   *
	   *    floor, fix, round
	   *
	   * @param  {number | BigNumber | Fraction | Complex | Array | Matrix} x  Number to be rounded
	   * @return {number | BigNumber | Fraction | Complex | Array | Matrix} Rounded value
	   */

/**
	   * Round a value towards minus infinity.
	   * For matrices, the function is evaluated element wise.
	   *
	   * Syntax:
	   *
	   *    math.floor(x)
	   *
	   * Examples:
	   *
	   *    math.floor(3.2);              // returns number 3
	   *    math.floor(3.8);              // returns number 3
	   *    math.floor(-4.2);             // returns number -5
	   *    math.floor(-4.7);             // returns number -5
	   *
	   *    var c = math.complex(3.2, -2.7);
	   *    math.floor(c);                // returns Complex 3 - 3i
	   *
	   *    math.floor([3.2, 3.8, -4.7]); // returns Array [3, 3, -5]
	   *
	   * See also:
	   *
	   *    ceil, fix, round
	   *
	   * @param  {number | BigNumber | Fraction | Complex | Array | Matrix} x  Number to be rounded
	   * @return {number | BigNumber | Fraction | Complex | Array | Matrix} Rounded value
	   */

/**
	   * Round a value towards the nearest integer.
	   * For matrices, the function is evaluated element wise.
	   *
	   * Syntax:
	   *
	   *    math.round(x)
	   *    math.round(x, n)
	   *
	   * Examples:
	   *
	   *    math.round(3.2);              // returns number 3
	   *    math.round(3.8);              // returns number 4
	   *    math.round(-4.2);             // returns number -4
	   *    math.round(-4.7);             // returns number -5
	   *    math.round(math.pi, 3);       // returns number 3.142
	   *    math.round(123.45678, 2);     // returns number 123.46
	   *
	   *    var c = math.complex(3.2, -2.7);
	   *    math.round(c);                // returns Complex 3 - 3i
	   *
	   *    math.round([3.2, 3.8, -4.7]); // returns Array [3, 4, -5]
	   *
	   * See also:
	   *
	   *    ceil, fix, floor
	   *
	   * @param  {number | BigNumber | Fraction | Complex | Array | Matrix} x  Number to be rounded
	   * @param  {number | BigNumber | Array} [n=0]                            Number of decimals
	   * @return {number | BigNumber | Fraction | Complex | Array | Matrix} Rounded value
	   */

!function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):t.WorldWind=e()}(this,function(){function t(e){return this instanceof t?(this._canvas=e="string"==typeof e?document.getElementById(e):e,this._ctx=e.getContext("2d"),this._width=e.width,this._height=e.height,this._max=1,this._fixedOpacity=null,void(this._data=[])):new t(e)}var e,r,i;!function(t){function n(t,e){return w.call(t,e)}function o(t,e){var r,i,n,o,a,s,l,u,c,h,f,d=e&&e.split("/"),p=v.map,m=p&&p["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),a=t.length-1,v.nodeIdCompat&&x.test(t[a])&&(t[a]=t[a].replace(x,"")),t=d.concat(t),c=0;c<t.length;c+=1)if(f=t[c],"."===f)t.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||m)&&p){for(r=t.split("/"),c=r.length;c>0;c-=1){if(i=r.slice(0,c).join("/"),d)for(h=d.length;h>0;h-=1)if(n=p[d.slice(0,h).join("/")],n&&(n=n[i])){o=n,s=c;break}if(o)break;!l&&m&&m[i]&&(l=m[i],u=c)}!o&&l&&(o=l,s=u),o&&(r.splice(0,s,o),t=r.join("/"))}return t}function a(e,r){return function(){var i=b.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),d.apply(t,i.concat([e,r]))}}function s(t){return function(e){return o(e,t)}}function l(t){return function(e){g[t]=e}}function u(e){if(n(y,e)){var r=y[e];delete y[e],E[e]=!0,f.apply(t,r)}if(!n(g,e)&&!n(E,e))throw new Error("No "+e);return g[e]}function c(t){var e,r=t?t.indexOf("!"):-1;return r>-1&&(e=t.substring(0,r),t=t.substring(r+1,t.length)),[e,t]}function h(t){return function(){return v&&v.config&&v.config[t]||{}}}var f,d,p,m,g={},y={},v={},E={},w=Object.prototype.hasOwnProperty,b=[].slice,x=/\.js$/;p=function(t,e){var r,i=c(t),n=i[0];return t=i[1],n&&(n=o(n,e),r=u(n)),n?t=r&&r.normalize?r.normalize(t,s(e)):o(t,e):(t=o(t,e),i=c(t),n=i[0],t=i[1],n&&(r=u(n))),{f:n?n+"!"+t:t,n:t,pr:n,p:r}},m={require:function(t){return a(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:h(t)}}},f=function(e,r,i,o){var s,c,h,f,d,v,w=[],b=typeof i;if(o=o||e,"undefined"===b||"function"===b){for(r=!r.length&&i.length?["require","exports","module"]:r,d=0;d<r.length;d+=1)if(f=p(r[d],o),c=f.f,"require"===c)w[d]=m.require(e);else if("exports"===c)w[d]=m.exports(e),v=!0;else if("module"===c)s=w[d]=m.module(e);else if(n(g,c)||n(y,c)||n(E,c))w[d]=u(c);else{if(!f.p)throw new Error(e+" missing "+c);f.p.load(f.n,a(o,!0),l(c),{}),w[d]=g[c]}h=i?i.apply(g[e],w):void 0,e&&(s&&s.exports!==t&&s.exports!==g[e]?g[e]=s.exports:h===t&&v||(g[e]=h))}else e&&(g[e]=i)},e=r=d=function(e,r,i,n,o){if("string"==typeof e)return m[e]?m[e](r):u(p(e,r).f);if(!e.splice){if(v=e,v.deps&&d(v.deps,v.callback),!r)return;r.splice?(e=r,r=i,i=null):e=t}return r=r||function(){},"function"==typeof i&&(i=n,n=o),n?f(t,e,r,i):setTimeout(function(){f(t,e,r,i)},4),d},d.config=function(t){return d(t)},e._defined=g,i=function(t,e,r){e.splice||(r=e,e=[]),n(g,t)||n(y,t)||(y[t]=[t,e,r])},i.amd={jQuery:!0}}(),i("../tools/almond",function(){}),i("../src/scripts/DataLoader",[],function(){var t=function(t){};return t.prototype.getData=function(e,r,i){var n=this,o=0;Papa.parse(e,{worker:!1,download:!0,preview:2e4,fastMode:!0,complete:function(e){if(!o){o=1;var a=t.removeEmpty(e.data);return a.bounds=n.getDataBounds(a,i,0),i.heightExtrusion&&(a.bounds1=n.getDataBounds(a,i,1)),r(a),1}}})},t.removeEmpty=function(t){return(""==t[t.length-1]||void 0==t[t.length-1])&&t.splice(t.length-1),t},t.prototype.getDataBounds=function(t,e,r){for(var i,n=-(1/0),o=1/0,a=0;a<t.length;a++)i=t[a],-1!==i[e.data[0]].indexOf(e.separator)&&(n=Math.max(n,i[e.data[r]].split(e.separator).join("")),o=Math.min(o,i[e.data[r]].split(e.separator).join("")));return[n,o]},t}),i("../src/scripts/GlobeHelper",[],function(){var t=t||{};return t.getCoords=function(t){var e={};return e[0]={},e[0].lat=t._boundaries[0].latitude,e[0].lng=t._boundaries[0].longitude,e[1]={},e[1].lat=t._boundaries[1].latitude,e[1].lng=t._boundaries[1].longitude,e[2]={},e[2].lat=t._boundaries[2].latitude,e[2].lng=t._boundaries[2].longitude,e[3]={},e[3].lat=t._boundaries[3].latitude,e[3].lng=t._boundaries[3].longitude,e},t.getMaxTile=function(){return Number($("#maxTile").val())},t.clean=function(t,e,r,i){var n;if(r&&i.removeLayer(r),t)for(n in t)i.removeLayer(t[n]);if(e)for(n in e)i.removeLayer(e[n])},t.getStatistics=function(t,e,r,i,n,o,a){for(var s=0,l=0,u=0,c=0,h=0,f=-(1/0),d=0,p=0;p<t.cubes.length;p++)if(t.cubes[p].heightLayer==e){c+=1;var m;if(o[a].idSeparator){var g=t.cubes[p].id.split(o[a].idSeparator).length/3;m=1/g}else m=1;l+=m,s+=Number(t.cubes[p].data[a]*m),u+=Number(t.cubes[p].data),f=Math.max(f,Number(t.cubes[p].data[a])),h=Math.min(h,Number(t.cubes[p].data[a]))}var y;switch(i){case 0:y=s/l;break;case 1:y=u/c;break;case 2:var v=u/c,E=0;for(p=0;p<t.cubes.length;p++)if(t.cubes[p].heightLayer==e){var w=t.cubes[p].data[a];E+=(w-v)*(w-v)}E/=c-1,y=Math.sqrt(E);break;case 3:d=Math.ceil(c/2),y=t.cubes[d].data[a];break;case 4:y=f;break;case 5:y=h;break;default:y=s/l}var b=r.bounds[0],x=r.bounds[1],_=this.getColor((y-x)/(b-x)*100,n);return[_,y]},t.getRGB=function(t){t="#"==t.charAt(0)?t.substring(1,7):t;var e=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16);return[e,r,i]},t.getColor=function(t,e){var r,i=[];50>t?(i[1]=e[0],i[0]=e[1],r=t/50):(i[1]=e[1],i[0]=e[2],r=(t-50)/50);var n=2*r-1,o=(n/1+1)/2,a=1-o,s=[Math.round(i[0][0]*o+i[1][0]*a),Math.round(i[0][1]*o+i[1][1]*a),Math.round(i[0][2]*o+i[1][2]*a)];return[s[0],s[1],s[2],255]},t.toTime=function(t){var e=new Date(0);try{e.setMilliseconds(Number(t+"000")),t=e.toLocaleDateString()+" "+e.toLocaleTimeString()}catch(r){t=0}return t},t}),i("../src/scripts/csvToGrid/CSVReader",[],function(){var t=t||{};return t.getData=function(e,r,i){Papa.parse(e,{download:!0,delimiter:i,complete:function(e){var i=t.removeEmpty(e.data);r(i)}})},t.removeEmpty=function(t){return(""==t[t.length-1]||void 0==t[t.length-1])&&t.splice(t.length-1),t},t});var o;i("../src/scripts/csvToGrid/Converter",["./CSVReader"],function(t){var e=e||{};return e.loadData=function(e,r,i){t.getData(e,r,i)},e.filterData=function(t,e,r,i){i||(i=4e4);var n=[],o=r._bottom,a=r._top,s=r._left,l=r._right;return t.forEach(function(t){Number(t[e.lat])<=a&&Number(t[e.lat])>=o&&Number(t[e.lng])>=s&&Number(t[e.lng])<=l&&n.length<i&&n.push(t)}),n},e.initData=function(t,e,r){var i=this.parseData(t,e,r);return i},e.getDataBounds=function(t,e,r){for(var i,n=-(1/0),o=1/0,a=1;a<t.length;a++)i=t[a],isNaN(i[e.data[0]])&&-1!==i[e.data[0]].indexOf(e.separator)?isNaN(n)||isNaN(o)||(n=Math.max(n,Number(i[e.data[r]].split(e.separator).join(""))),o=Math.min(o,Number(i[e.data[r]].split(e.separator).join("")))):isNaN(n)||isNaN(o)||(n=Math.max(n,i[e.data[r]]),o=Math.min(o,i[e.data[r]]));return[n,o]},e.initJson=function(t,e,r,i){var n=Math.floor(t.positions.length/2),a=Number(t.positions[n][1]),s=Number(t.positions[n][0]);e=Math.floor((a+180)/6)+1,s>=56&&64>s&&a>=3&&12>a&&(e=32),s>=72&&84>s&&(a>=0&&9>a?e=31:a>=9&&21>a?e=33:a>=21&&33>a?e=35:a>=33&&42>a&&(e=37));var l=this.getCoordinatesBoundaries(t.positions),l=this.convertBounds(l,e,i),u=this.getPoints(t.positions,e,i);minPoint=l[0],maxPoint=l[1],sizeW=maxPoint[0]-minPoint[0],sizeH=maxPoint[1]-minPoint[1];var c=!0,h={x:minPoint[0],y:minPoint[1],width:sizeW,height:sizeH};o=new QuadTree(h,c,r,1),o=this.insertData(o,u);var f=this.getJson(o,e,i);return f},e.setGridtoData=function(t,e,r){t=JSON.parse(t);for(var i in e)for(var n=e[i].length,o=0;n>o;o++)for(var a=e[i][o].length,s=0;a>s;s++)for(var l=t.features.length,u=0;l>u;u++){var c=e[i][o][s],h=t.features[u],f=[h.properties.lat,h.properties.lng];if(0!==f[0]&&0!==f[1]){var d=[Number(c[r.data.length+1][0]),Number(c[r.data.length+1][1])];f[0]==d[0]&&f[1]==d[1]&&(c[0]=h.properties.id)}}return e},e.parseData=function(t,e,r){for(var i=[],n={},o=t.length,a=[],s=0;o>s;s++){var l=t[s];-1==i.indexOf(l[e.time])&&i.push(l[e.time]),n[l[e.time]]||(n[l[e.time]]=[]),n[l[e.time]][r]||(n[l[e.time]][r]=[]);var u=[l[e.lat],l[e.lng]],c=[],h=[];h.length<1&&(c.push(-1),a.push(u));for(var f in e.data)c.push(l[e.data[f]]);c.push(u),n[l[e.time]][r].push(c)}var d={allTime:i,positions:a,times:n};return d},e.insertData=function(t,e){var r,i,o={};for(i=0,n=e.length;i<n;i++){var a=e[i];0!=a[0]&&(o[a[0]+" - "+a[1]]=a)}var i=0,s=[];for(var a in o)s[i++]=o[a];for(r in o)t.insert({x:o[r][0],y:o[r][1],width:10,height:10,coords:[o[r].coord[0],o[r].coord[1]]});return t},e.getPoints=function(t,e,r){var i=[];r=r||"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs";for(var n=0;n<t.length;n++){var o=t[n][0],a=t[n][1];o=Number(o),a=Number(a),i[n]=[a,o],i[n].coord=[o,a]}return i},e.convertBounds=function(t,e,r){r=r||"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs";var i=t[0],n=t[1],o=t[2],a=t[3],s=[n,i],l=[a,o];return[s,l]},e.getJson=function(t,e,r){var i={type:"FeatureCollection",features:[]},n=[];0==t.root.children.length&&t.root.nodes.length>0?n=this.explore(t.root,n):n.push([t.root._bounds,[0,0]]);r=r||"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs";for(var o=0,a=0;a<n.length;a++){var s=this.newFeature();s.properties.id=a,s.properties.lat=n[a][1][0],s.properties.lng=n[a][1][1],i.features.push(s);var l=n[a][0],u=[];u[0]=u[4]=[l.x,l.y],u[1]=[l.x+l.width,l.y],u[2]=[l.x+l.width,l.y+l.height],u[3]=[l.x,l.y+l.height];for(var c=0;c<u.length;c++)i.features[o].geometry.coordinates[0].push([u[c][0],u[c][1]]);o++}return i},e.newFeature=function(){return{type:"Feature",properties:{id:"gridBound"},geometry:{type:"Polygon",coordinates:[[]]}}},e.explore=function(t,e){if(0==t.children.length&&t.nodes.length>0)for(var r=0;r<t.nodes.length;r++)e=this.explore(t.nodes[r],e);else 0==t.children.length?e.push([t._bounds,[0,0]]):e.push([t._bounds,t.children[0].coords]);return e},e.getCoordinatesBoundaries=function(t,e){for(var r=-(1/0),i=-(1/0),n=1/0,o=1/0,a=0;a<t.length;a++){if(e)var s=t[a][e.lat],l=t[a][e.lng];else var s=t[a][0],l=t[a][1];s=Number(s),l=Number(l),s&&l&&(n=Math.min(n,s),o=Math.min(o,l),r=Math.max(r,s),i=Math.max(i,l))}return[n,o,r,i]},e}),i("../src/worldwind/error/AbstractError",[],function(){"use strict";var t=function(t,e){this.name=t,this.message=e};return t.prototype.toString=function(){var t=this.name+": "+this.message;return this.stack&&(t+="\n"+this.stack.toString()),t},t}),i("../src/worldwind/geom/Angle",[],function(){"use strict";var t={DEGREES_TO_RADIANS:Math.PI/180,RADIANS_TO_DEGREES:180/Math.PI,TWO_PI:2*Math.PI,HALF_PI:Math.PI/2,normalizedDegrees:function(t){var e=t%360;return e>180?e-360:-180>e?360+e:e},normalizedDegreesLatitude:function(t){var e=t%180;return e>90?180-e:-90>e?-180-e:e},normalizedDegreesLongitude:function(t){var e=t%360;return e>180?e-360:-180>e?360+e:e},normalizedRadians:function(t){var e=t%this.TWO_PI;return e>Math.PI?e-this.TWO_PI:e<-Math.PI?this.TWO_PI+e:e},normalizedRadiansLatitude:function(t){var e=t%Math.PI;return e>this.HALF_PI?Math.PI-e:e<-this.HALF_PI?-Math.PI-e:e},normalizedRadiansLongitude:function(t){var e=t%this.TWO_PI;return e>Math.PI?e-this.TWO_PI:e<-Math.PI?this.TWO_PI+e:e},isValidLatitude:function(t){return t>=-90&&90>=t},isValidLongitude:function(t){return t>=-180&&180>=t},toString:function(t){return t.toString()+"°"},toDecimalDegreesString:function(t){return t.toString()+"°"},toDMSString:function(t){var e,r,i,n,o;return e=0>t?-1:1,r=e*t,i=Math.floor(r),r=60*(r-i),n=Math.floor(r),r=60*(r-n),o=Math.round(r),60==o&&(n++,o=0),60==n&&(i++,n=0),(-1==e?"-":"")+i+"° "+n+"’ "+o+"”"},toDMString:function(t){var e,r,i,n,o,a;return e=0>t?-1:1,r=e*t,i=Math.floor(r),r=60*(r-i),n=Math.floor(r),r=60*(r-n),o=Math.round(r),60==o&&(n++,o=0),60==n&&(i++,n=0),a=0==o?n:n+o/60,(-1==e?"-":"")+i+"° "+a+"’"}};return t}),i("../src/worldwind/util/Logger",[],function(){"use strict";var t={LEVEL_NONE:0,LEVEL_SEVERE:1,LEVEL_WARNING:2,LEVEL_INFO:3,setLoggingLevel:function(t){e=t},getLoggingLevel:function(){return e},log:function(r,i){i&&r>0&&e>=r&&(r===t.LEVEL_SEVERE?console.error(i):r===t.LEVEL_WARNING?console.warn(i):r===t.LEVEL_INFO?console.info(i):console.log(i))},makeMessage:function(t,e,r){var i=this.messageTable[r]?this.messageTable[r]:r;return t+"."+e+": "+i},logMessage:function(t,e,r,i){var n=this.makeMessage(e,r,i);return this.log(t,n),n},messageTable:{abstractInvocation:"The function called is abstract and must be overridden in a subclass.",indexOutOfRange:"The specified index is out of range.",invalidHeight:"The specified height is zero or negative.",invalidWidth:"The specified width is zero or negative.",invalidSize:"The specified size is zero or negative.",missingAltitudeMode:"The specified altitude mode is null or undefined.",missingAttributeName:"The specified DBase attribute file name is null or undefined.",missingArray:"The specified array is null, undefined or of insufficient length.",missingBoundaries:"The specified boundaries array is null or undefined.",missingBuffer:"The specified buffer descriptor is null or undefined.",missingColor:"The specified color is null or undefined.",missingDc:"The specified draw context is null or undefined.",missingDomElement:"The specified DOM element is null or undefined.",missingEntry:"The specified entry is null or undefined.",missingFont:"The specified font is null or undefined.",missingFrustum:"The specified frustum is null or undefined.",missingFunction:"The specified function is null or undefined.",missingGlContext:"The specified WebGL rendering context is null or undefined.",missingGlobe:"The specified globe is null or undefined.",missingImage:"The specified image is null or undefined.",missingIndices:"The specified indices array is null or undefined.",missingKey:"The specified key is null or undefined.",missingLevel:"The specified level is null or undefined.",missingLine:"The specified line is null or undefined.",missingList:"The specified list is null or undefined.",missingListener:"The specified listener is null or undefined",missingLocation:"The specified location is null or undefined.",missingMatrix:"The specified matrix is null or undefined.",missingNavigatorState:"The specified navigator state is null or undefined.",missingOffset:"The specified offset is null or undefined.",missingPath:"The specified path is null or undefined.",missingPlacename:"The specified place name is null or undefined.",missingPlane:"The specified plane is null or undefined.",missingPoint:"The specified point is null or undefined.",missingPoints:"The specified points array is null or undefined.",missingPosition:"The specified position is null or undefined.",missingPositions:"The specified positions array is null or undefined.",missingProgram:"The specified program is null or undefined.",missingProjection:"The specified projection is null or undefined.",missingRectangle:"The specified rectangle is null or undefined.",missingRenderable:"The specified renderable is null or undefined.",missingResource:"The specified resource is null or undefined.",missingResult:"The specified result variable is null or undefined.",missingResults:"The specified results array is null or undefined.",missingSector:"The specified sector is null or undefined.",missingShapeType:"The specified shape type is null or undefined.",missingSize:"The specified size is null or undefined.",missingText:"The specified text is null or undefined.",missingTexture:"The specified texture is null or undefined.",missingTile:"The specified tile is null or undefined.",missingType:"The specified type is null or undefined.",missingUrl:"The specified URL is null or undefined",missingVector:"The specified vector is null or undefined.",missingVertex:"The specified vertex is null or undefined.",missingViewport:"The specified viewport is null or undefined.",missingWorldWindow:"The specified World Window is null or undefined.",notYetImplemented:"This function is not yet implemented"}},e=1;return t}),i("../src/worldwind/util/Color",["../util/Logger"],function(t){"use strict";var e=function(t,e,r,i){this.red=t,this.green=e,this.blue=r,this.alpha=i};return e.WHITE=new e(1,1,1,1),e.BLACK=new e(0,0,0,1),e.RED=new e(1,0,0,1),e.GREEN=new e(0,1,0,1),e.BLUE=new e(0,0,1,1),e.CYAN=new e(0,1,1,1),e.YELLOW=new e(1,1,0,1),e.MAGENTA=new e(1,0,1,1),e.LIGHT_GRAY=new e(.75,.75,.75,1),e.MEDIUM_GRAY=new e(.5,.5,.5,1),e.DARK_GRAY=new e(.25,.25,.25,1),e.TRANSPARENT=new e(0,0,0,0),e.prototype.set=function(t,e,r,i){return this.red=t,this.green=e,this.blue=r,this.alpha=i,this},e.prototype.copy=function(e){if(!e)throw new ArgumentError(t.logMessage(t.LEVEL_SEVERE,"Color","copy","missingColor"));return this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha,this},e.prototype.clone=function(){return new e(this.red,this.green,this.blue,this.alpha)},e.prototype.premultipliedComponents=function(t){var e=this.alpha;return t[0]=this.red*e,t[1]=this.green*e,t[2]=this.blue*e,t[3]=e,t},e.colorFromByteArray=function(t){return new e(t[0]/255,t[1]/255,t[2]/255,t[3]/255)},e.colorFromBytes=function(t,r,i,n){return new e(t/255,r/255,i/255,n/255)},e.colorFromHex=function(t){var r=parseInt(t.substring(0,2),16),i=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16),o=parseInt(t.substring(6,8),16);return e.colorFromBytes(r,i,n,o)},e.colorFromKmlHex=function(t){var r=parseInt(t.substring(0,2),16),i=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16),o=parseInt(t.substring(6,8),16);return e.colorFromBytes(o,n,i,r)},e.prototype.nextColor=function(){var t=Math.round(255*this.red),e=Math.round(255*this.green),r=Math.round(255*this.blue);return 255>t?this.red=(t+1)/255:255>e?(this.red=0,this.green=(e+1)/255):255>r?(this.red=0,this.green=0,this.blue=(r+1)/255):(this.red=1/255,this.green=0,this.blue=0),this},e.prototype.equals=function(t){var e=Math.round(255*this.red),r=Math.round(255*this.green),i=Math.round(255*this.blue),n=Math.round(255*this.alpha),o=Math.round(255*t.red),a=Math.round(255*t.green),s=Math.round(255*t.blue),l=Math.round(255*t.alpha);return e===o&&r===a&&i===s&&n===l},e.prototype.equalsBytes=function(t){var e=Math.round(255*this.red),r=Math.round(255*this.green),i=Math.round(255*this.blue),n=Math.round(255*this.alpha);return e===t[0]&&r===t[1]&&i===t[2]&&n===t[3]},e.prototype.toByteString=function(){var t=Math.round(255*this.red),e=Math.round(255*this.green),r=Math.round(255*this.blue),i=Math.round(255*this.alpha);return"("+t+","+e+","+r+","+i+")"},e.prototype.toHexString=function(t){var e=Math.ceil(255*this.red).toString(16),r=Math.ceil(255*this.green).toString(16),i=Math.ceil(255*this.blue).toString(16),n=Math.ceil(255*this.alpha).toString(16),o="#";return o+=e.length<2?"0"+e:e,o+=r.length<2?"0"+r:r,o+=i.length<2?"0"+i:i,t&&(o+=n.length<2?"0"+n:n),o},e.prototype.toRGBAString=function(){var t=Math.floor(255*this.red),e=Math.floor(255*this.green),r=Math.floor(255*this.blue);return"rgba("+t+" ,"+e+" ,"+r+" ,"+this.alpha+")"},e}),i("../src/worldwind/error/ArgumentError",["../error/AbstractError"],function(t){"use strict";var e=function(e){t.call(this,"ArgumentError",e);var r;try{throw new Error}catch(i){r=i.stack}this.stack=r};return e.prototype=Object.create(t.prototype),e}),i("../src/worldwind/util/Font",["../error/ArgumentError","../util/Color","../util/Logger"],function(t,e,r){"use strict";var i=function(e,i,n,o,a,s){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Font","constructor","missingSize"));if(0>=e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Font","constructor","invalidSize"));this._size=e,this.style=i||"normal",this.variant=n||"normal",this.weight=o||"normal",this.family=a||"sans-serif",this.horizontalAlignment=s||"center"};return Object.defineProperties(i.prototype,{size:{get:function(){return this._size},set:function(t){this._fontString=null,this._size=t}},style:{get:function(){return this._style},set:function(t){this._fontString=null,this._style=t}},variant:{get:function(){return this._variant},set:function(t){this._fontString=null,this._variant=t}},weight:{get:function(){return this._weight},set:function(t){this._fontString=null,this._weight=t}},family:{get:function(){return this._family},set:function(t){this._fontString=null,this._family=t}},horizontalAlignment:{get:function(){return this._horizontalAlignment},set:function(t){this._toString=null,this._horizontalAlignment=t}},fontString:{get:function(){return this._fontString||(this._fontString=this._style+" "+this.variant+" "+this._weight+" "+this._size.toString()+"px "+this._family),this._fontString}}}),i.prototype.toString=function(){return this._toString&&this._fontString||(this._toString=this.fontString+" "+this.horizontalAlignment),this._toString},i}),i("../src/worldwind/util/Insets",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i,n,o){if(4!==arguments.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"Insets","constructor","invalidArgumentCount"));this._top=r,this._left=i,this._bottom=n,this._right=o};return r.prototype.set=function(t,e,r,i){this._top=t,this._left=e,this._bottom=r,this._right=i},r.prototype.clone=function(){return new r(this._top,this._left,this._bottom,this._right)},r.prototype.toString=function(){return this._top+" "+this._left+" "+this._bottom+" "+this._right},Object.defineProperties(r.prototype,{top:{get:function(){return this._top},set:function(t){this._top=t}},left:{get:function(){return this._left},set:function(t){this._left=t}},bottom:{get:function(){return this._bottom},set:function(t){this._bottom=t}},right:{get:function(){return this._right},set:function(t){this._right=t}}}),r}),i("../src/worldwind/geom/Vec3",["../util/Logger","../error/ArgumentError"],function(t,e){"use strict";var r=function(t,e,r){this[0]=t,this[1]=e,this[2]=r};return r.prototype=new Float64Array(3),r.ZERO=new r(0,0,0),r.average=function(r,i){if(!r||r.length<1)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","average","missingArray"));if(!i)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","average","missingResult"));var n,o=r.length;i[0]=0,i[1]=0,i[2]=0;for(var a=0,s=r.length;s>a;a++)n=r[a],i[0]+=n[0]/o,i[1]+=n[1]/o,i[2]+=n[2]/o;return i},r.averageOfBuffer=function(r,i){if(!r||r.length<1)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","averageBuffer","missingArray"));if(!i)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","averageBuffer","missingResult"));var n=r.length/3;i[0]=0,i[1]=0,i[2]=0;for(var o=0;n>o;o++)i[0]+=r[3*o]/n,i[1]+=r[3*o+1]/n,i[2]+=r[3*o+2]/n;return i},r.areColinear=function(i,n,o){if(!i||!n||!o)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","areColinear","missingVector"));var a=new r(i[0]-n[0],i[1]-n[1],i[2]-n[2]).normalize(),s=new r(o[0]-n[0],o[1]-n[1],o[2]-n[2]).normalize();return Math.abs(a.dot(s))>.999},r.computeTriangleNormal=function(i,n,o){if(!i||!n||!o)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","areColinear","missingVector"));var a=(n[1]-i[1])*(o[2]-i[2])-(n[2]-i[2])*(o[1]-i[1]),s=(n[2]-i[2])*(o[0]-i[0])-(n[0]-i[0])*(o[2]-i[2]),l=(n[0]-i[0])*(o[1]-i[1])-(n[1]-i[1])*(o[0]-i[0]),u=a*a+s*s+l*l;return 0===u?new r(a,s,l):(u=Math.sqrt(u),new r(a/u,s/u,l/u))},r.findThreeIndependentVertices=function(t,e){var i=e&&e>0?e:3;if(!t||t.length<3*i)return null;for(var n=new r(t[0],t[1],t[2]),o=null,a=null,s=i;s<t.length&&(o=new r(t[s],t[s+1],t[s+2]),o[0]===n[0]&&o[1]===n[1]&&o[2]===n[2]);s+=i)o=null;if(!o)return null;for(s+=i;s<t.length&&(a=new r(t[s],t[s+1],t[s+2]),a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]||a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]||r.areColinear(n,o,a));s+=i)a=null;return a?[n,o,a]:null},r.computeBufferNormal=function(t,e){var i=r.findThreeIndependentVertices(t,e);return i?r.computeTriangleNormal(i[0],i[1],i[2]):null},r.prototype.set=function(t,e,r){return this[0]=t,this[1]=e,this[2]=r,this},r.prototype.copy=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","copy","missingVector"));return this[0]=r[0],this[1]=r[1],this[2]=r[2],this},r.prototype.equals=function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]},r.prototype.add=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","add","missingVector"));return this[0]+=r[0],this[1]+=r[1],this[2]+=r[2],this},r.prototype.subtract=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","subtract","missingVector"));return this[0]-=r[0],this[1]-=r[1],this[2]-=r[2],this},r.prototype.multiply=function(t){return this[0]*=t,this[1]*=t,this[2]*=t,this},r.prototype.divide=function(t){return this[0]/=t,this[1]/=t,this[2]/=t,this},r.prototype.multiplyByMatrix=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","multiplyByMatrix","missingMatrix"));var i=r[0]*this[0]+r[1]*this[1]+r[2]*this[2]+r[3],n=r[4]*this[0]+r[5]*this[1]+r[6]*this[2]+r[7],o=r[8]*this[0]+r[9]*this[1]+r[10]*this[2]+r[11],a=r[12]*this[0]+r[13]*this[1]+r[14]*this[2]+r[15];return this[0]=i/a,this[1]=n/a,this[2]=o/a,this},r.prototype.mix=function(r,i){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","mix","missingVector"));var n=1-i,o=i;return this[0]=this[0]*n+r[0]*o,this[1]=this[1]*n+r[1]*o,this[2]=this[2]*n+r[2]*o,this},r.prototype.negate=function(){return this[0]=-this[0],this[1]=-this[1],this[2]=-this[2],this},r.prototype.dot=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","dot","missingVector"));return this[0]*r[0]+this[1]*r[1]+this[2]*r[2]},r.prototype.cross=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","cross","missingVector"));var i=this[1]*r[2]-this[2]*r[1],n=this[2]*r[0]-this[0]*r[2],o=this[0]*r[1]-this[1]*r[0];return this[0]=i,this[1]=n,this[2]=o,this},r.prototype.magnitudeSquared=function(){return this.dot(this)},r.prototype.magnitude=function(){return Math.sqrt(this.magnitudeSquared())},r.prototype.normalize=function(){var t=this.magnitude(),e=1/t;return this[0]*=e,this[1]*=e,this[2]*=e,this},r.prototype.distanceToSquared=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","distanceToSquared","missingVector"));var i=this[0]-r[0],n=this[1]-r[1],o=this[2]-r[2];return i*i+n*n+o*o},r.prototype.distanceTo=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","distanceTo","missingVector"));return Math.sqrt(this.distanceToSquared(r))},r.prototype.swap=function(t){var e=this[0];return this[0]=t[0],t[0]=e,e=this[1],this[1]=t[1],t[1]=e,e=this[2],this[2]=t[2],t[2]=e,this},r.prototype.toString=function(){return"("+this[0]+", "+this[1]+", "+this[2]+")"},r}),i("../src/worldwind/geom/Vec2",["../util/Logger","../error/ArgumentError","../geom/Vec3"],function(t,e,r){"use strict";var i=function(t,e){this[0]=t,this[1]=e};return i.prototype=new Float64Array(2),i.prototype.set=function(t,e){return this[0]=t,this[1]=e,this},i.prototype.copy=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","copy","missingVector"));return this[0]=r[0],this[1]=r[1],this},i.prototype.equals=function(t){return this[0]===t[0]&&this[1]===t[1]},i.average=function(r,i){if(!r||r.length<1)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","average","missingArray"));if(!i)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","average","missingResult"));var n,o=r.length;i[0]=0,i[1]=0;for(var a=0,s=r.length;s>a;a++)n=r[a],i[0]+=n[0]/o,i[1]+=n[1]/o;return i},i.prototype.add=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","add","missingVector"));return this[0]+=r[0],this[1]+=r[1],this},i.prototype.subtract=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","subtract","missingVector"));return this[0]-=r[0],this[1]-=r[1],this},i.prototype.multiply=function(t){return this[0]*=t,this[1]*=t,this},i.prototype.divide=function(t){return this[0]/=t,this[1]/=t,this},i.prototype.mix=function(r,i){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","mix","missingVector"));var n=1-i,o=i;return this[0]=this[0]*n+r[0]*o,this[1]=this[1]*n+r[1]*o,this},i.prototype.negate=function(){return this[0]=-this[0],this[1]=-this[1],this},i.prototype.dot=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","dot","missingVector"));return this[0]*r[0]+this[1]*r[1]},i.prototype.magnitudeSquared=function(){return this.dot(this)},i.prototype.magnitude=function(){return Math.sqrt(this.magnitudeSquared())},i.prototype.normalize=function(){var t=this.magnitude(),e=1/t;return this[0]*=e,this[1]*=e,this},i.prototype.distanceToSquared=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","distanceToSquared","missingVector"));var i=this[0]-r[0],n=this[1]-r[1];return i*i+n*n},i.prototype.distanceTo=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","distanceTo","missingVector"));return Math.sqrt(this.distanceToSquared(r))},i.prototype.toVec3=function(){return new r(this[0],this[1],0)},i.prototype.swap=function(t){var e=this[0];return this[0]=t[0],t[0]=e,e=this[1],this[1]=t[1],t[1]=e,this},i.prototype.toString=function(){return"("+this[0]+", "+this[1]+")"},i}),i("../src/worldwind/util/Offset",["../geom/Vec2"],function(t){"use strict";var e=function(t,e,r,i){this.x=e,this.y=i,this.xUnits=t,this.yUnits=r};return e.prototype.clone=function(){return new e(this.xUnits,this.x,this.yUnits,this.y)},e.prototype.offsetForSize=function(e,r){var i,n;return i=this.xUnits==WorldWind.OFFSET_FRACTION?e*this.x:this.xUnits==WorldWind.OFFSET_INSET_PIXELS?e-this.x:this.x,n=this.yUnits==WorldWind.OFFSET_FRACTION?r*this.y:this.yUnits==WorldWind.OFFSET_INSET_PIXELS?r-this.y:this.y,new t(i,n)},e.prototype.toString=function(){return this.xUnits+" "+this.x+" "+this.yUnits+" "+this.y},e}),i("../src/worldwind/shapes/TextAttributes",["../util/Color","../util/Font","../util/Offset"],function(t,e,r){"use strict";var i=function(i){this._color=i?i._color:new t(1,1,1,1),this._font=i?i._font:new e(14),this._offset=i?i._offset:new r(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0),this._scale=i?i._scale:1,this._depthTest=i?i._depthTest:!1,this.stateKeyInvalid=!0};return i.prototype.computeStateKey=function(){return"c "+this._color.toHexString(!0)+" f "+this._font.toString()+" o "+this._offset.toString()+" s "+this._scale+" dt "+this._depthTest},Object.defineProperties(i.prototype,{stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}},color:{get:function(){return this._color},set:function(t){this._color=t,this.stateKeyInvalid=!0}},font:{get:function(){return this._font},set:function(t){this._font=t,this.stateKeyInvalid=!0}},offset:{get:function(){return this._offset},set:function(t){this._offset=t,this.stateKeyInvalid=!0}},scale:{get:function(){return this._scale},set:function(t){this._scale=t,this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(t){this._depthTest=t,this.stateKeyInvalid=!0}}}),i}),i("../src/worldwind/shapes/AnnotationAttributes",["../util/Color","../util/Font","../util/Insets","../shapes/TextAttributes"],function(t,e,r,i){"use strict";var n=function(e){this._cornerRadius=e?e._cornerRadius:0,this._insets=e?e._insets:new r(0,0,0,0),this._backgroundColor=e?e._backgroundColor:t.WHITE,this._leaderGapWidth=e?e._leaderGapWidth:40,this._leaderGapHeight=e?e._leaderGapHeight:30,this._opacity=e?e._opacity:1,this._scale=e?e._scale:1,this._drawLeader=e?e._drawLeader:!0,this._width=e?e._width:200,this._height=e?e._height:100,this._textAttributes=e?e._textAttributes:new i(null),this.stateKeyInvalid=!0};return n.prototype.computeStateKey=function(){return"wi "+this._width+" he "+this._height+" cr "+this._cornerRadius+" in "+this._insets.toString()+" bg "+this.backgroundColor.toHexString(!0)+" dl "+this.drawLeader+" lgw "+this.leaderGapWidth+" lgh "+this.leaderGapHeight+" op "+this.opacity+" ta "+this._textAttributes.stateKey+" sc "+this.scale},Object.defineProperties(n.prototype,{width:{get:function(){return this._width},set:function(t){this._width=t,this.stateKeyInvalid=!0}},height:{get:function(){return this._height},set:function(t){this._height=t,this.stateKeyInvalid=!0}},cornerRadius:{get:function(){return this._cornerRadius},set:function(t){this._cornerRadius=t,this.stateKeyInvalid=!0}},insets:{
get:function(){return this._insets},set:function(t){this._insets=t,this.stateKeyInvalid=!0}},backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this.stateKeyInvalid=!0}},textAttributes:{get:function(){return this._textAttributes},set:function(t){this._textAttributes=t,this.stateKeyInvalid=!0}},drawLeader:{get:function(){return this._drawLeader},set:function(t){this._drawLeader=t,this.stateKeyInvalid=!0}},leaderGapWidth:{get:function(){return this._leaderGapWidth},set:function(t){this._leaderGapWidth=t,this.stateKeyInvalid=!0}},leaderGapHeight:{get:function(){return this._leaderGapHeight},set:function(t){this._leaderGapHeight=t,this.stateKeyInvalid=!0}},opacity:{get:function(){return this._opacity},set:function(t){this._opacity=t,this.stateKeyInvalid=!0}},scale:{get:function(){return this._scale},set:function(t){this._scale=t,this.stateKeyInvalid=!0}},stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}}}),n}),i("../src/worldwind/shaders/GpuShader",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i,n){if(i!==r.VERTEX_SHADER&&i!==r.FRAGMENT_SHADER)throw new t(e.logMessage(e.LEVEL_SEVERE,"GpuShader","constructor","The specified shader type is unrecognized."));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"GpuShader","constructor","The specified shader source is null or undefined."));var o=r.createShader(i);if(!o)throw new t(e.logMessage(e.LEVEL_SEVERE,"GpuShader","constructor","Unable to create shader of type "+(i==r.VERTEX_SHADER?"VERTEX_SHADER.":"FRAGMENT_SHADER.")));if(!this.compile(r,o,i,n)){var a=r.getShaderInfoLog(o);throw r.deleteShader(o),new t(e.logMessage(e.LEVEL_SEVERE,"GpuShader","constructor","Unable to compile shader: "+a))}this.shaderId=o};return r.prototype.compile=function(t,e,r,i){return t.shaderSource(e,i),t.compileShader(e),t.getShaderParameter(e,t.COMPILE_STATUS)},r.prototype.dispose=function(t){this.shaderId&&(t.deleteShader(this.shaderId),delete this.shaderId)},r}),i("../src/worldwind/shaders/GpuProgram",["../error/ArgumentError","../util/Color","../shaders/GpuShader","../util/Logger"],function(t,e,r,i){"use strict";var n=function(e,n,o,a){if(!n||!o)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","constructor","The specified shader source is null or undefined."));var s,l,u;try{l=new r(e,e.VERTEX_SHADER,n),u=new r(e,e.FRAGMENT_SHADER,o)}catch(c){throw l&&l.dispose(e),u&&u.dispose(e),c}if(s=e.createProgram(),!s)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","constructor","Unable to create shader program."));if(e.attachShader(s,l.shaderId),e.attachShader(s,u.shaderId),a)for(var h=0,f=a.length;f>h;h++)e.bindAttribLocation(s,h,a[h]);if(!this.link(e,s)){var d=e.getProgramInfoLog(s);throw e.detachShader(s,l.shaderId),e.detachShader(s,u.shaderId),e.deleteProgram(s),l.dispose(e),u.dispose(e),new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","constructor","Unable to link shader program: "+d))}this.programId=s,this.attributeLocations={},this.uniformLocations={},this.vertexShader=l,this.fragmentShader=u,this.size=n.length+o.length,this.scratchArray=new Float32Array(16)};return n.prototype.dispose=function(t){this.programId&&(this.vertexShader&&t.detachShader(this.programId,this.vertexShader.shaderId),this.fragmentShader&&t.detachShader(this.programId,this.fragmentShader.shaderId),t.deleteProgram(this.programId),delete this.programId),this.vertexShader&&(this.vertexShader.dispose(t),delete this.vertexShader),this.fragmentShader&&(this.fragmentShader.dispose(t),delete this.fragmentShader),this.attributeLocations={},this.uniformLocations={}},n.prototype.attributeLocation=function(e,r){if(!r||0==r.length)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","attributeLocation","The specified attribute name is null, undefined or empty."));var n=this.attributeLocations[r];return n||(n=e.getAttribLocation(this.programId,r),this.attributeLocations[r]=n),n},n.prototype.uniformLocation=function(e,r){if(!r||0==r.length)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","uniformLocation","The specified uniform name is null, undefined or empty."));var n=this.uniformLocations[r];return n||(n=e.getUniformLocation(this.programId,r),this.uniformLocations[r]=n),n},n.prototype.link=function(t,e){return t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)},n.prototype.loadUniformMatrix=function(e,r,n){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","loadUniformMatrix","missingMatrix"));var o=r.columnMajorComponents(this.scratchArray);e.uniformMatrix4fv(n,!1,o)},n.prototype.loadUniformColor=function(e,r,n){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","loadUniformColor","missingColor"));var o=r.premultipliedComponents(this.scratchArray);e.uniform4f(n,o[0],o[1],o[2],o[3])},n.prototype.loadUniformColorComponents=function(t,e,r,i,n,o){t.uniform4f(o,e*n,r*n,i*n,n)},n}),i("../src/worldwind/shaders/BasicTextureProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(t,e,r,i){"use strict";var n=function(t){var e="attribute vec4 vertexPoint;\nattribute vec4 vertexTexCoord;\nattribute vec4 normalVector;\nuniform mat4 mvpMatrix;\nuniform mat4 mvInverseMatrix;\nuniform mat4 texCoordMatrix;\nuniform bool applyLighting;\nvarying vec2 texCoord;\nvarying vec4 normal;\nvoid main() {gl_Position = mvpMatrix * vertexPoint;\ntexCoord = (texCoordMatrix * vertexTexCoord).st;\nif (applyLighting) {normal = mvInverseMatrix * normalVector;}\n}",i="precision mediump float;\nuniform float opacity;\nuniform vec4 color;\nuniform bool enableTexture;\nuniform bool modulateColor;\nuniform sampler2D textureSampler;\nuniform bool applyLighting;\nvarying vec2 texCoord;\nvarying vec4 normal;\nvoid main() {\nvec4 textureColor = texture2D(textureSampler, texCoord);\nfloat ambient = 0.15; vec4 lightDirection = vec4(0, 0, 1, 0);\nif (enableTexture && !modulateColor)\n    gl_FragColor = textureColor * color * opacity;\nelse if (enableTexture && modulateColor)\n    gl_FragColor = color * floor(textureColor.a + 0.5);\nelse\n    gl_FragColor = color * opacity;\nif (gl_FragColor.a == 0.0) {discard;}\nif (applyLighting) {\n    vec4 n = normal * (gl_FrontFacing ? 1.0 : -1.0);\n    gl_FragColor.rgb *= clamp(ambient + dot(lightDirection, n), 0.0, 1.0);\n}\n}",n=["vertexPoint","normalVector","vertexTexCoord"];r.call(this,t,e,i,n),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.normalVectorLocation=this.attributeLocation(t,"normalVector"),this.vertexTexCoordLocation=this.attributeLocation(t,"vertexTexCoord"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.mvInverseMatrixLocation=this.uniformLocation(t,"mvInverseMatrix"),this.colorLocation=this.uniformLocation(t,"color"),this.textureEnabledLocation=this.uniformLocation(t,"enableTexture"),this.modulateColorLocation=this.uniformLocation(t,"modulateColor"),this.textureUnitLocation=this.uniformLocation(t,"textureSampler"),this.textureMatrixLocation=this.uniformLocation(t,"texCoordMatrix"),this.opacityLocation=this.uniformLocation(t,"opacity"),this.applyLightingLocation=this.uniformLocation(t,"applyLighting")};return n.key="WorldWindGpuBasicTextureProgram",n.prototype=Object.create(r.prototype),n.prototype.loadModelviewInverse=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicTextureProgram","loadModelviewInverse","missingMatrix"));this.loadUniformMatrix(e,r,this.mvInverseMatrixLocation)},n.prototype.loadModelviewProjection=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicTextureProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,r,this.mvpMatrixLocation)},n.prototype.loadColor=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicTextureProgram","loadColor","missingColor"));this.loadUniformColor(e,r,this.colorLocation)},n.prototype.loadTextureEnabled=function(t,e){t.uniform1i(this.textureEnabledLocation,e?1:0)},n.prototype.loadModulateColor=function(t,e){t.uniform1i(this.modulateColorLocation,e?1:0)},n.prototype.loadTextureUnit=function(t,e){t.uniform1i(this.textureUnitLocation,e-t.TEXTURE0)},n.prototype.loadTextureMatrix=function(t,e){this.loadUniformMatrix(t,e,this.textureMatrixLocation)},n.prototype.loadOpacity=function(t,e){t.uniform1f(this.opacityLocation,e)},n.prototype.loadApplyLighting=function(t,e){t.uniform1i(this.applyLightingLocation,e)},n}),i("../src/worldwind/geom/Line",["../error/ArgumentError","../util/Logger","../geom/Vec3"],function(t,e,r){"use strict";var i=function(r,i){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"Line","constructor","Origin is null or undefined."));if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Line","constructor","Direction is null or undefined."));this.origin=r,this.direction=i};return i.fromSegment=function(n,o){if(!n||!o)throw new t(e.logMessage(e.LEVEL_SEVERE,"Line","fromSegment","missingPoint"));var a=new r(n[0],n[1],n[2]),s=new r(o[0]-n[0],o[1]-n[1],o[2]-n[2]);return new i(a,s)},i.prototype.pointAt=function(r,i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Line","pointAt","missingResult."));return i[0]=this.origin[0]+this.direction[0]*r,i[1]=this.origin[1]+this.direction[1]*r,i[2]=this.origin[2]+this.direction[2]*r,i},i}),i("../src/worldwind/geom/Plane",["../error/ArgumentError","../geom/Line","../util/Logger","../geom/Vec3"],function(t,e,r,i){"use strict";var n=function(t,e,r,n){this.normal=new i(t,e,r),this.distance=n};return n.fromPoints=function(e,o,a){if(!e||!o||!a)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","fromPoints","missingVector"));var s=new i(o[0],o[1],o[2]);s.subtract(e);var l=new i(a[0],a[1],a[2]);l.subtract(e),s.cross(l),s.normalize();var u=-s.dot(e);return new n(s[0],s[1],s[2],u)},n.prototype.dot=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","dot","missingVector"));return this.normal.dot(e)+this.distance},n.prototype.distanceToPoint=function(t){return this.dot(t)},n.prototype.transformByMatrix=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","transformByMatrix","missingMatrix"));var i=e[0]*this.normal[0]+e[1]*this.normal[1]+e[2]*this.normal[2]+e[3]*this.distance,n=e[4]*this.normal[0]+e[5]*this.normal[1]+e[6]*this.normal[2]+e[7]*this.distance,o=e[8]*this.normal[0]+e[9]*this.normal[1]+e[10]*this.normal[2]+e[11]*this.distance,a=e[12]*this.normal[0]+e[13]*this.normal[1]+e[14]*this.normal[2]+e[15]*this.distance;return this.normal[0]=i,this.normal[1]=n,this.normal[2]=o,this.distance=a,this},n.prototype.normalize=function(){var t=this.normal.magnitude();return 0===t?this:(this.normal.divide(t),this.distance/=t,this)},n.prototype.intersectsSegment=function(t,e){var r=this.dot(t),i=this.dot(e);return 0>=r*i},n.prototype.intersectsSegmentAt=function(t,e,r){var i=this.dot(t),n=this.dot(e);if(0===i&&0===n)return r[0]=t[0],r[1]=t[1],r[2]=t[2],!0;if(i===n)return!1;var o=-i/(n-i),a=1-o;return r[0]=o*t[0]+a*e[0],r[1]=o*t[1]+a*e[1],r[2]=o*t[2]+a*e[2],0>=i*n},n.prototype.onSameSide=function(e,i){if(!e||!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","onSameSide","missingPoint"));var n=this.distanceToPoint(e),o=this.distanceToPoint(i);return 0>n&&0>o?-1:n>0&&o>0?1:0},n.prototype.clip=function(n,o){if(!n||!o)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","clip","missingPoint"));if(n.equals(o))return null;var a,s,l,u=e.fromSegment(n,o),c=this.normal.dot(u.direction);return 0===c?(a=this.dot(u.origin),0===a?[n,o]:null):(s=-this.dot(u.origin)/c,0>s||s>1?null:(l=u.pointAt(s,new i(0,0,0)),c>0?[l,o]:[n,l]))},n.prototype.set=function(t,e,r,i){this.normal[0]=t,this.normal[1]=e,this.normal[2]=r,this.distance=i,this.normalizeIfNeeded()},n.prototype.normalizeIfNeeded=function(){var t=this.normal.magnitude();if(0!=t){var e=1e-10;t>=1-e&&1+e>=t||(this.normal[0]/=t,this.normal[1]/=t,this.normal[2]/=t,this.distance/=t)}},n}),i("../src/worldwind/geom/Rectangle",["../util/Logger"],function(t){"use strict";var e=function(t,e,r,i){this.x=t,this.y=e,this.width=r,this.height=i};return e.prototype.set=function(t,e,r,i){this.x=t,this.y=e,this.width=r,this.height=i},e.prototype.getMinX=function(){return this.x},e.prototype.getMinY=function(){return this.y},e.prototype.getMaxX=function(){return this.x+this.width},e.prototype.getMaxY=function(){return this.y+this.height},e.prototype.containsPoint=function(t){return t[0]>=this.x&&t[0]<=this.x+this.width&&t[1]>=this.y&&t[1]<=this.y+this.height},e.prototype.intersects=function(t){return t.x+t.width<this.x?!1:t.x>this.x+this.width?!1:t.y+t.height<this.y?!1:t.y>this.y+this.height?!1:!0},e.prototype.intersectsRectangles=function(t){if(t)for(var e=0;e<t.length;e++)if(this.intersects(t[e]))return!0;return!1},e.prototype.toString=function(){return this.x+", "+this.y+", "+this.width+", "+this.height},e}),i("../src/worldwind/util/WWMath",["../geom/Angle","../error/ArgumentError","../geom/Line","../util/Logger","../geom/Rectangle","../geom/Vec3"],function(t,e,r,i,n,o){"use strict";var a={clamp:function(t,e,r){return e>t?e:t>r?r:t},interpolate:function(t,e,r){return(1-t)*e+t*r},cbrt:function(t){return"function"==typeof Math.cbrt?Math.cbrt(t):Math.pow(t,1/3)},computeEllipsoidalGlobeIntersection:function(t,r,n,o){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeEllipsoidalGlobeIntersection","missingLine"));if(!o)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeEllipsoidalGlobeIntersection","missingResult"));var a,s=t.direction[0],l=t.direction[1],u=t.direction[2],c=t.origin[0],h=t.origin[1],f=t.origin[2],d=r/n,p=d*d,m=r*r,g=s*s+p*l*l+u*u,y=2*(c*s+p*h*l+f*u),v=c*c+p*h*h+f*f-m,E=y*y-4*g*v;return 0>E?!1:(a=(-y-Math.sqrt(E))/(2*g),o[0]=c+s*a,o[1]=h+l*a,o[2]=f+u*a,!0)},computeTriangleIntersection:function(t,r,n,o,a){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingLine"));if(!r||!n||!o)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingVertex"));if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingResult"));var s=t.direction[0],l=t.direction[1],u=t.direction[2],c=t.origin[0],h=t.origin[1],f=t.origin[2],d=1e-5,p=n[0]-r[0],m=n[1]-r[1],g=n[2]-r[2],y=o[0]-r[0],v=o[1]-r[1],E=o[2]-r[2],w=l*E-u*v,b=u*y-s*E,x=s*v-l*y,_=p*w+m*b+g*x;if(_>-d&&d>_)return!1;var S=1/_,T=c-r[0],L=h-r[1],M=f-r[2],A=S*(T*w+L*b+M*x);if(-d>A||A>1+d)return!1;var N=L*g-M*m,R=M*p-T*g,C=T*m-L*p,P=S*(s*N+l*R+u*C);if(-d>P||A+P>1+d)return!1;var O=S*(y*N+v*R+E*C);return 0>O?!1:(a[0]=c+s*O,a[1]=h+l*O,a[2]=f+u*O,!0)},computeIndexedTrianglesIntersection:function(t,r,n,s){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingLine"));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingPoints"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingIndices"));if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingResults"));for(var l=new o(0,0,0),u=new o(0,0,0),c=new o(0,0,0),h=new o(0,0,0),f=0,d=n.length;d>f;f+=3){var p=3*n[f],m=3*n[f+1],g=3*n[f+2];l[0]=r[p],l[1]=r[p+1],l[2]=r[p+2],u[0]=r[m],u[1]=r[m+1],u[2]=r[m+2],c[0]=r[g],c[1]=r[g+1],c[2]=r[g+2],a.computeTriangleIntersection(t,l,u,c,h)&&(s.push(h),h=new o(0,0,0))}return s.length>0},computeTriStripIntersections:function(t,r,n,a){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingLine"));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingPoints"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingIndices"));if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingResults"));var s,l,u,c,h,f,d,p,m,g,y,v,E,w,b,x,_,S,T,L,M,A,N,R,C,P,O,I,k,D,V=t.direction[0],F=t.direction[1],G=t.direction[2],B=t.origin[0],W=t.origin[1],U=t.origin[2],j=1e-5;D=3*n[0],c=r[D++],h=r[D++],f=r[D],D=3*n[1],d=r[D++],p=r[D++],m=r[D];for(var z=2,K=n.length;K>z;z++)s=c,l=h,u=f,c=d,h=p,f=m,D=3*n[z],d=r[D++],p=r[D++],m=r[D],g=c-s,y=h-l,v=f-u,E=d-s,w=p-l,b=m-u,x=F*b-G*w,_=G*E-V*b,S=V*w-F*E,I=g*x+y*_+v*S,I>-j&&j>I||(k=1/I,T=B-s,L=W-l,M=U-u,C=k*(T*x+L*_+M*S),-j>C||C>1+j||(A=L*v-M*y,N=M*g-T*v,R=T*y-L*g,P=k*(V*A+F*N+G*R),-j>P||C+P>1+j||(O=k*(E*A+w*N+b*R),O>=0&&a.push(new o(B+V*O,W+F*O,U+G*O)))))},fabs:function(t){return t>=0?t:-t},fmod:function(t,e){return 0===e?0:t-Math.floor(t/e)*e},fract:function(t){return t-Math.floor(t)},mod:function(t,e){return(t%e+e)%e},max:function(t,e){return t>e?t:e},localCoordinateAxesAtPoint:function(t,r,n,o,a){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingVector"));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingGlobe"));if(!n||!o||!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingResult"));var s=t[0],l=t[1],u=t[2];r.surfaceNormalAtPoint(s,l,u,a),r.northTangentAtPoint(s,l,u,o),n.set(o[0],o[1],o[2]),n.cross(a),n.normalize(),o.set(a[0],a[1],a[2]),o.cross(n),o.normalize()},horizonDistanceForGlobeRadius:function(t,r){if(0>t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","horizontalDistanceForGlobeRadius","The specified globe radius is negative."));return t>0&&r>0?Math.sqrt(r*(2*t+r)):0},perspectiveNearDistanceForFarDistance:function(t,r,n){if(0>t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified distance is negative."));if(0>r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified resolution is negative."));if(1>n)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified depth bits is negative."));var o=(1<<n)-1;return t/(o/(1-r/t)-o+1)},perspectiveNearDistance:function(t,r,n){if(0>=t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","invalidWidth"));if(0>=r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","invalidHeight"));if(0>n)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","The specified distance is negative."));var o=r/t;return 2*n/Math.sqrt(o*o+5)},perspectiveFrustumRectangle:function(t,r,o){if(0>=t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","invalidWidth"));if(0>=r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","invalidHeight"));if(0>o)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","The specified distance is negative."));var a=o,s=o*r/t;return new n(-a/2,-s/2,a,s)},perspectivePixelSize:function(t,r,n){if(0>=t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectivePixelSize","invalidWidth"));if(0>=r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectivePixelSize","invalidHeight"));if(0>n)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectivePixelSize","The specified distance is negative."));var o=a.perspectiveFrustumRectangle(t,r,n).height;return o/r},boundingRectForUnitQuad:function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","boundingRectForUnitQuad","missingMatrix"));var r=t,o=r[3],a=r[7],s=r[0]+r[3],l=r[4]+r[7],u=r[1]+r[3],c=r[5]+r[7],h=r[0]+r[1]+r[3],f=r[4]+r[5]+r[7],d=Math.min(Math.min(o,s),Math.min(u,h)),p=Math.max(Math.max(o,s),Math.max(u,h)),m=Math.min(Math.min(a,l),Math.min(c,f)),g=Math.max(Math.max(a,l),Math.max(c,f));return new n(d,m,p-d,g-m)},isPowerOfTwo:function(t){return 0!=t&&0===(t&t-1)},signum:function(t){return t>0?1:0>t?-1:0},gudermannianInverse:function(e){return Math.log(Math.tan(Math.PI/4+e*t.DEGREES_TO_RADIANS/2))/Math.PI},epsg3857ToEpsg4326:function(e,r){var i=6378100,n=Math.PI/2-2*Math.atan(Math.exp(-r/i)),o=e/i;return[a.clamp(n*t.RADIANS_TO_DEGREES,-90,90),a.clamp(o*t.RADIANS_TO_DEGREES,-180,180)]},powerOfTwoFloor:function(t){var e=Math.floor(Math.log(t)/Math.log(2));return Math.pow(2,e)},toRadians:function(e){return t.DEGREES_TO_RADIANS*e},toDegrees:function(e){return t.RADIANS_TO_DEGREES*e},normalizeAngle360:function(t){var e=t%360;return e>=0?e:0>e?360+e:360-e}};return a}),i("../src/worldwind/geom/Location",["../geom/Angle","../error/ArgumentError","../util/Logger","../geom/Plane","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o){"use strict";var a=function(t,e){this.latitude=t,this.longitude=e};return a.ZERO=new a(0,0),a.fromRadians=function(e,r){return new a(e*t.RADIANS_TO_DEGREES,r*t.RADIANS_TO_DEGREES)},a.prototype.copy=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","copy","missingLocation"));return this.latitude=t.latitude,this.longitude=t.longitude,this},a.prototype.set=function(t,e){return this.latitude=t,this.longitude=e,this},a.prototype.equals=function(t){return t&&t.latitude===this.latitude&&t.longitude===this.longitude},a.interpolateAlongPath=function(t,i,n,o,a){if(!n||!o)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateAlongPath","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateAlongPath","missingResult"));return t===WorldWind.GREAT_CIRCLE?this.interpolateGreatCircle(i,n,o,a):t&&t===WorldWind.RHUMB_LINE?this.interpolateRhumb(i,n,o,a):this.interpolateLinear(i,n,o,a)},a.interpolateGreatCircle=function(t,i,n,a){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateGreatCircle","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateGreatCircle","missingResult"));if(i.equals(n))return a.latitude=i.latitude,a.longitude=i.longitude,a;var s=o.clamp(t,0,1),l=this.greatCircleAzimuth(i,n),u=this.greatCircleDistance(i,n);return this.greatCircleLocation(i,l,s*u,a)},a.greatCircleAzimuth=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleAzimuth","missingLocation"));var o,a,s,l=i.latitude*t.DEGREES_TO_RADIANS,u=n.latitude*t.DEGREES_TO_RADIANS,c=i.longitude*t.DEGREES_TO_RADIANS,h=n.longitude*t.DEGREES_TO_RADIANS;return l==u&&c==h?0:c==h?l>u?180:0:(a=Math.cos(u)*Math.sin(h-c),o=Math.cos(l)*Math.sin(u)-Math.sin(l)*Math.cos(u)*Math.cos(h-c),s=Math.atan2(a,o),isNaN(s)?0:s*t.RADIANS_TO_DEGREES)},a.greatCircleDistance=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleDistance","missingLocation"));var o,a,s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=n.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n.longitude*t.DEGREES_TO_RADIANS;return u==c&&h==f?0:(o=Math.sin((c-u)/2),a=Math.sin((f-h)/2),s=o*o+Math.cos(u)*Math.cos(c)*a*a,l=2*Math.asin(Math.sqrt(s)),isNaN(l)?0:l)},a.greatCircleLocation=function(i,n,o,a){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleLocation","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleLocation","missingResult"));if(0==o)return a.latitude=i.latitude,a.longitude=i.longitude,a;var s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=i.longitude*t.DEGREES_TO_RADIANS,h=n*t.DEGREES_TO_RADIANS;return s=Math.asin(Math.sin(u)*Math.cos(o)+Math.cos(u)*Math.sin(o)*Math.cos(h)),l=c+Math.atan2(Math.sin(o)*Math.sin(h),Math.cos(u)*Math.cos(o)-Math.sin(u)*Math.sin(o)*Math.cos(h)),isNaN(s)||isNaN(l)?(a.latitude=i.latitude,a.longitude=i.longitude):(a.latitude=t.normalizedDegreesLatitude(s*t.RADIANS_TO_DEGREES),a.longitude=t.normalizedDegreesLongitude(l*t.RADIANS_TO_DEGREES)),a},a.interpolateRhumb=function(t,i,n,a){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateRhumb","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateRhumb","missingResult"));if(i.equals(n))return a.latitude=i.latitude,a.longitude=i.longitude,a;var s=o.clamp(t,0,1),l=this.rhumbAzimuth(i,n),u=this.rhumbDistance(i,n);return this.rhumbLocation(i,l,s*u,a)},a.rhumbAzimuth=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","rhumbAzimuth","missingLocation"));var a,s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=n.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n.longitude*t.DEGREES_TO_RADIANS;return u==c&&h==f?0:(a=f-h,s=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(u/2+Math.PI/4)),o.fabs(a)>Math.PI&&(a=a>0?-(2*Math.PI-a):2*Math.PI+a),l=Math.atan2(a,s),isNaN(l)?0:l*t.RADIANS_TO_DEGREES)},a.rhumbDistance=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","rhumbDistance","missingLocation"));var a,s,l,u,c,h=i.latitude*t.DEGREES_TO_RADIANS,f=n.latitude*t.DEGREES_TO_RADIANS,d=i.longitude*t.DEGREES_TO_RADIANS,p=n.longitude*t.DEGREES_TO_RADIANS;return h==f&&d==p?0:(a=f-h,s=p-d,l=Math.log(Math.tan(f/2+Math.PI/4)/Math.tan(h/2+Math.PI/4)),u=a/l,(isNaN(l)||isNaN(u))&&(u=Math.cos(h)),o.fabs(s)>Math.PI&&(s=s>0?-(2*Math.PI-s):2*Math.PI+s),c=Math.sqrt(a*a+u*u*s*s),isNaN(c)?0:c)},a.rhumbLocation=function(i,n,a,s){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","rhumbLocation","missingLocation"));if(!s)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","rhumbLocation","missingResult"));if(0==a)return s.latitude=i.latitude,s.longitude=i.longitude,s;var l,u,c=i.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n*t.DEGREES_TO_RADIANS,d=c+a*Math.cos(f),p=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(c/2+Math.PI/4)),m=(d-c)/p;return(isNaN(p)||isNaN(m)||!isFinite(m))&&(m=Math.cos(c)),l=a*Math.sin(f)/m,o.fabs(d)>Math.PI/2&&(d=d>0?Math.PI-d:-Math.PI-d),u=o.fmod(h+l+Math.PI,2*Math.PI)-Math.PI,isNaN(d)||isNaN(u)?(s.latitude=i.latitude,s.longitude=i.longitude):(s.latitude=t.normalizedDegreesLatitude(d*t.RADIANS_TO_DEGREES),s.longitude=t.normalizedDegreesLongitude(u*t.RADIANS_TO_DEGREES)),s},a.interpolateLinear=function(t,i,n,a){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateLinear","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateLinear","missingResult"));if(i.equals(n))return a.latitude=i.latitude,a.longitude=i.longitude,a;var s=o.clamp(t,0,1),l=this.linearAzimuth(i,n),u=this.linearDistance(i,n);return this.linearLocation(i,l,s*u,a)},a.linearAzimuth=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","linearAzimuth","missingLocation"));var a,s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=n.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n.longitude*t.DEGREES_TO_RADIANS;return u==c&&h==f?0:(a=f-h,s=c-u,o.fabs(a)>Math.PI&&(a=a>0?-(2*Math.PI-a):2*Math.PI+a),l=Math.atan2(a,s),isNaN(l)?0:l*t.RADIANS_TO_DEGREES)},a.linearDistance=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","linearDistance","missingLocation"));var a,s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=n.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n.longitude*t.DEGREES_TO_RADIANS;return u==c&&h==f?0:(a=c-u,s=f-h,o.fabs(s)>Math.PI&&(s=s>0?-(2*Math.PI-s):2*Math.PI+s),l=Math.sqrt(a*a+s*s),isNaN(l)?0:l)},a.linearLocation=function(i,n,a,s){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","linearLocation","missingLocation"));if(!s)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","linearLocation","missingResult"));if(0==a)return s.latitude=i.latitude,s.longitude=i.longitude,s;var l,u=i.latitude*t.DEGREES_TO_RADIANS,c=i.longitude*t.DEGREES_TO_RADIANS,h=n*t.DEGREES_TO_RADIANS,f=u+a*Math.cos(h);return o.fabs(f)>Math.PI/2&&(f=f>0?Math.PI-f:-Math.PI-f),l=o.fmod(c+a*Math.sin(h)+Math.PI,2*Math.PI)-Math.PI,isNaN(f)||isNaN(l)?(s.latitude=i.latitude,s.longitude=i.longitude):(s.latitude=t.normalizedDegreesLatitude(f*t.RADIANS_TO_DEGREES),s.longitude=t.normalizedDegreesLongitude(l*t.RADIANS_TO_DEGREES)),s},a.locationsCrossDateLine=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","locationsCrossDateline","missingLocation"));for(var i=null,n=0,a=t.length;a>n;n+=1){var s=t[n];if(null!=i&&o.signum(i.longitude)!=o.signum(s.longitude)){var l=Math.abs(i.longitude-s.longitude);if(l>180&&360>l)return!0}i=s}return!1},a.greatCircleArcExtremeLocations=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleArcExtremeLocations","missingLocation"));for(var i=null,n=null,o=null,s=0,l=t.length;l>s;s+=1){var u=t[s];if(null!=o){var c=a.greatCircleArcExtremeForTwoLocations(o,u);if(null==c)continue;(null==i||i.latitude>c[0].latitude)&&(i=c[0]),(null==n||n.latitude<c[1].latitude)&&(n=c[1])}o=u}return[i,n]},a.greatCircleArcExtremeForTwoLocations=function(t,i){if(!t||!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleArcExtremeForTwoLocations","missingLocation"));var n,s,l,u=null,c=null,h=90,f=-90,d=[t,i];for(n=0,s=d.length;s>n;n+=1)l=d[n],h>=l.latitude&&(h=l.latitude,u=l),f<=l.latitude&&(f=l.latitude,c=l);var p=a.greatCircleAzimuth(t,i),m=a.greatCircleDistance(t,i),g=a.greatCircleExtremeLocationsUsingAzimuth(t,p);for(n=0,s=g.length;s>n;n+=1){l=g[n];var y=a.greatCircleAzimuth(t,l),v=a.greatCircleDistance(t,l);o.signum(y)==o.signum(p)&&v>=0&&m>=v&&(h>=l.latitude&&(h=l.latitude,u=l),f<=l.latitude&&(f=l.latitude,c=l))}return[u,c]},a.greatCircleExtremeLocationsUsingAzimuth=function(i,n){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleArcExtremeLocationsUsingAzimuth","missingLocation"));var o=i.latitude,s=n*t.DEGREES_TO_RADIANS,l=-Math.tan(o)/Math.cos(s),u=Math.atan(l),c=u+Math.PI/2,h=u-Math.PI/2;return[a.greatCircleLocation(i,n,c,new a(0,0)),a.greatCircleLocation(i,n,h,new a(0,0))]},a.intersectionWithMeridian=function(t,e,r,o){var a=o.computePointFromLocation(t.latitude,t.longitude,new n(0,0,0)),s=o.computePointFromLocation(e.latitude,e.longitude,new n(0,0,0)),l=o.computePointFromLocation(90,r,new n(0,0,0)),u=o.computePointFromLocation(0,r,new n(0,0,0)),c=i.fromPoints(l,u,n.ZERO),h=new n(0,0,0);if(!c.intersectsSegmentAt(a,s,h))return null;var f=new WorldWind.Position(0,0,0);return o.computePositionFromPoint(h[0],h[1],h[2],f),f.latitude},a.normalizeLatitude=function(t){var e=t%180,r=e>90?180-e:-90>e?-180-e:e,i=Math.round(t/180);return i%2==0?r:-r},a.normalizeLongitude=function(t){var e=t%360;return e>180?e-360:-180>e?360+e:e},a.meridianIntersection=function(t,e,r){var i=t.longitude<0?t.longitude+360:t.longitude,n=e.longitude<0?e.longitude+360:e.longitude;if(i===n)return null;var o=0>r?r+360:r,a=(e.latitude-t.latitude)/(n-i),s=t.latitude+a*(o-i);return s},a.poles={NONE:0,NORTH:1,SOUTH:2},a}),i("../src/worldwind/geom/Position",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../util/WWMath"],function(t,e,r,i,n){"use strict";var o=function(t,e,r){this.latitude=t,this.longitude=e,this.altitude=r};return o.ZERO=new o(0,0,0),o.fromRadians=function(e,r,i){return new o(e*t.RADIANS_TO_DEGREES,r*t.RADIANS_TO_DEGREES,i)},o.prototype.copy=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","copy","missingPosition"));return this.latitude=t.latitude,this.longitude=t.longitude,this.altitude=t.altitude,this},o.prototype.equals=function(t){return t&&t.latitude===this.latitude&&t.longitude===this.longitude&&t.altitude===this.altitude},o.interpolateGreatCircle=function(t,o,a,s){if(!o||!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateGreatCircle","missingPosition"));if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateGreatCircle","missingResult"));var l=n.clamp(t,0,1);return s.altitude=n.interpolate(l,o.altitude,a.altitude),r.interpolateGreatCircle(l,o,a,s),s},o.interpolateRhumb=function(t,o,a,s){if(!o||!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateRhumb","missingPosition"));if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateRhumb","missingResult"));var l=n.clamp(t,0,1);return s.altitude=n.interpolate(l,o.altitude,a.altitude),r.interpolateRhumb(l,o,a,s),s},o.interpolateLinear=function(t,o,a,s){if(!o||!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateLinear","missingPosition"));if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateLinear","missingResult"));var l=n.clamp(t,0,1);return s.altitude=n.interpolate(l,o.altitude,a.altitude),r.interpolateLinear(l,o,a,s),
s},o.prototype.toString=function(){return"("+this.latitude.toString()+"°, "+this.longitude.toString()+"°, "+this.altitude.toString()+")"},o}),i("../src/worldwind/render/Texture",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Texture","constructor","missingGlContext"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"Texture","constructor","missingImage"));o||(o=i.CLAMP_TO_EDGE);var a=i.createTexture(),s=r.isPowerOfTwo(n.width)&&r.isPowerOfTwo(n.height);this.originalImageWidth=n.width,this.originalImageHeight=n.height,o!==i.REPEAT||s||(n=this.resizeImage(n),s=!0),this.imageWidth=n.width,this.imageHeight=n.height,this.size=n.width*n.height*4,i.bindTexture(i.TEXTURE_2D,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,s?i.LINEAR_MIPMAP_LINEAR:i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,o);var l=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");l&&i.texParameteri(i.TEXTURE_2D,l.TEXTURE_MAX_ANISOTROPY_EXT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),s&&i.generateMipmap(i.TEXTURE_2D),this.textureId=a,this.creationTime=new Date};return i.prototype.dispose=function(t){t.deleteTexture(this.textureId),delete this.textureId},i.prototype.bind=function(t){return t.currentGlContext.bindTexture(t.currentGlContext.TEXTURE_2D,this.textureId),t.frameStatistics.incrementTextureLoadCount(1),!0},i.prototype.resizeImage=function(t){var e=document.createElement("canvas");e.width=r.powerOfTwoFloor(t.width),e.height=r.powerOfTwoFloor(t.height);var i=e.getContext("2d");return i.drawImage(t,0,0,e.width,e.height),e},i}),i("../src/worldwind/geom/Matrix",["../geom/Angle","../error/ArgumentError","../util/Logger","../geom/Plane","../geom/Position","../geom/Rectangle","../render/Texture","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m){this[0]=t,this[1]=e,this[2]=r,this[3]=i,this[4]=n,this[5]=o,this[6]=a,this[7]=s,this[8]=l,this[9]=u,this[10]=c,this[11]=h,this[12]=f,this[13]=d,this[14]=p,this[15]=m};return u.prototype=new Float64Array(16),u.fromIdentity=function(){return new u(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},u.principalAxesFromPoints=function(t,i,n,o){if(!t||t.length<1)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","principalAxesFromPoints","missingPoints"));if(!i||!n||!o)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","principalAxesFromPoints","An axis argument is null or undefined."));var a=u.fromIdentity();a.setToCovarianceOfPoints(t),a.eigensystemFromSymmetricMatrix(i,n,o),i.normalize(),n.normalize(),o.normalize()},u.prototype.set=function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m){return this[0]=t,this[1]=e,this[2]=r,this[3]=i,this[4]=n,this[5]=o,this[6]=a,this[7]=s,this[8]=l,this[9]=u,this[10]=c,this[11]=h,this[12]=f,this[13]=d,this[14]=p,this[15]=m,this},u.prototype.setToIdentity=function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1},u.prototype.copy=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","copy","missingMatrix"));this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15]},u.prototype.equals=function(t){return t&&this[0]==t[0]&&this[1]==t[1]&&this[2]==t[2]&&this[3]==t[3]&&this[4]==t[4]&&this[5]==t[5]&&this[6]==t[6]&&this[7]==t[7]&&this[8]==t[8]&&this[9]==t[9]&&this[10]==t[10]&&this[11]==t[11]&&this[12]==t[12]&&this[13]==t[13]&&this[14]==t[14]&&this[15]==t[15]},u.prototype.equalsWithPrecision=function(t,e){return t&&this[0].toFixed(e)==t[0].toFixed(e)&&this[1].toFixed(e)==t[1].toFixed(e)&&this[2].toFixed(e)==t[2].toFixed(e)&&this[3].toFixed(e)==t[3].toFixed(e)&&this[4].toFixed(e)==t[4].toFixed(e)&&this[5].toFixed(e)==t[5].toFixed(e)&&this[6].toFixed(e)==t[6].toFixed(e)&&this[7].toFixed(e)==t[7].toFixed(e)&&this[8].toFixed(e)==t[8].toFixed(e)&&this[9].toFixed(e)==t[9].toFixed(e)&&this[10].toFixed(e)==t[10].toFixed(e)&&this[11].toFixed(e)==t[11].toFixed(e)&&this[12].toFixed(e)==t[12].toFixed(e)&&this[13].toFixed(e)==t[13].toFixed(e)&&this[14].toFixed(e)==t[14].toFixed(e)&&this[15].toFixed(e)==t[15].toFixed(e)},u.prototype.columnMajorComponents=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","columnMajorComponents","missingResult"));return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t},u.prototype.setToTranslation=function(t,e,r){return this[0]=1,this[1]=0,this[2]=0,this[3]=t,this[4]=0,this[5]=1,this[6]=0,this[7]=e,this[8]=0,this[9]=0,this[10]=1,this[11]=r,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.setTranslation=function(t,e,r){return this[3]=t,this[7]=e,this[11]=r,this},u.prototype.setToScale=function(t,e,r){return this[0]=t,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=e,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=r,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.setScale=function(t,e,r){return this[0]=t,this[5]=e,this[10]=r,this},u.prototype.setToTransposeOfMatrix=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToTransposeOfMatrix","missingMatrix"));return this[0]=t[0],this[1]=t[4],this[2]=t[8],this[3]=t[12],this[4]=t[1],this[5]=t[5],this[6]=t[9],this[7]=t[13],this[8]=t[2],this[9]=t[6],this[10]=t[10],this[11]=t[14],this[12]=t[3],this[13]=t[7],this[14]=t[11],this[15]=t[15],this},u.prototype.setToMultiply=function(t,i){if(!t||!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToMultiply","missingMatrix"));var n=t,o=i;return this[0]=n[0]*o[0]+n[1]*o[4]+n[2]*o[8]+n[3]*o[12],this[1]=n[0]*o[1]+n[1]*o[5]+n[2]*o[9]+n[3]*o[13],this[2]=n[0]*o[2]+n[1]*o[6]+n[2]*o[10]+n[3]*o[14],this[3]=n[0]*o[3]+n[1]*o[7]+n[2]*o[11]+n[3]*o[15],this[4]=n[4]*o[0]+n[5]*o[4]+n[6]*o[8]+n[7]*o[12],this[5]=n[4]*o[1]+n[5]*o[5]+n[6]*o[9]+n[7]*o[13],this[6]=n[4]*o[2]+n[5]*o[6]+n[6]*o[10]+n[7]*o[14],this[7]=n[4]*o[3]+n[5]*o[7]+n[6]*o[11]+n[7]*o[15],this[8]=n[8]*o[0]+n[9]*o[4]+n[10]*o[8]+n[11]*o[12],this[9]=n[8]*o[1]+n[9]*o[5]+n[10]*o[9]+n[11]*o[13],this[10]=n[8]*o[2]+n[9]*o[6]+n[10]*o[10]+n[11]*o[14],this[11]=n[8]*o[3]+n[9]*o[7]+n[10]*o[11]+n[11]*o[15],this[12]=n[12]*o[0]+n[13]*o[4]+n[14]*o[8]+n[15]*o[12],this[13]=n[12]*o[1]+n[13]*o[5]+n[14]*o[9]+n[15]*o[13],this[14]=n[12]*o[2]+n[13]*o[6]+n[14]*o[10]+n[15]*o[14],this[15]=n[12]*o[3]+n[13]*o[7]+n[14]*o[11]+n[15]*o[15],this},u.prototype.setToCovarianceOfPoints=function(t){if(!t||t.length<1)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToCovarianceOfPoints","missingArray"));var i,n,o,a,l=0,u=0,c=0,h=0,f=0,d=0,p=0,m=new s(0,0,0);i=s.averageOfBuffer(t,new s(0,0,0));for(var g=0,y=t.length/3;y>g;g++)m[0]=t[3*g],m[1]=t[3*g+1],m[2]=t[3*g+2],n=m[0]-i[0],o=m[1]-i[1],a=m[2]-i[2],++l,u+=n*n,c+=o*o,h+=a*a,f+=n*o,d+=n*a,p+=o*a;return this[0]=u/l,this[1]=f/l,this[2]=d/l,this[3]=0,this[4]=f/l,this[5]=c/l,this[6]=p/l,this[7]=0,this[8]=d/l,this[9]=p/l,this[10]=h/l,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=0,this},u.prototype.multiplyByTranslation=function(t,e,r){return this.multiply(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},u.prototype.multiplyByRotation=function(e,r,i,n){var o=Math.cos(n*t.DEGREES_TO_RADIANS),a=Math.sin(n*t.DEGREES_TO_RADIANS);return this.multiply(o+(1-o)*e*e,(1-o)*e*r-a*i,(1-o)*e*i+a*r,0,(1-o)*e*r+a*i,o+(1-o)*r*r,(1-o)*r*i-a*e,0,(1-o)*e*i-a*r,(1-o)*r*i+a*e,o+(1-o)*i*i,0,0,0,0,1),this},u.prototype.multiplyByScale=function(t,e,r){return this.multiply(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},u.prototype.setToUnitYFlip=function(){return this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=-1,this[6]=0,this[7]=1,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.multiplyByLocalCoordinateTransform=function(t,i){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLocalCoordinateTransform","Origin vector is null or undefined"));if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLocalCoordinateTransform","missingGlobe"));var n=new s(0,0,0),o=new s(0,0,0),a=new s(0,0,0);return l.localCoordinateAxesAtPoint(t,i,n,o,a),this.multiply(n[0],o[0],a[0],t[0],n[1],o[1],a[1],t[1],n[2],o[2],a[2],t[2],0,0,0,1),this},u.prototype.multiplyByTextureTransform=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByTextureTransform","missingTexture"));var i=t.originalImageWidth/t.imageWidth,n=t.originalImageHeight/t.imageHeight;return this.multiply(i,0,0,0,0,-n,0,n,0,0,1,0,0,0,0,1),this},u.prototype.extractTranslation=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractTranslation","missingResult"));return t[0]=this[3],t[1]=this[7],t[2]=this[11],t},u.prototype.extractRotationAngles=function(i){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractRotationAngles","missingResult"));var n=Math.atan2(this[6],this[10]),o=Math.atan2(-this[2],Math.sqrt(this[0]*this[0]+this[1]*this[1])),a=Math.cos(n),s=Math.sin(n),l=Math.atan2(s*this[8]-a*this[4],a*this[5]-s*this[9]);return i[0]=n*t.RADIANS_TO_DEGREES,i[1]=o*t.RADIANS_TO_DEGREES,i[2]=l*t.RADIANS_TO_DEGREES,i},u.prototype.multiplyByFirstPersonModelview=function(i,n,o,a,u){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByFirstPersonModelview","missingPosition"));if(!u)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByFirstPersonModelview","missingGlobe"));var c,h,f,d,p,m,g,y,v,E,w,b,x,_,S=new s(0,0,0),T=new s(0,0,0),L=new s(0,0,0),M=new s(0,0,0);return c=Math.cos(a*t.DEGREES_TO_RADIANS),h=Math.sin(a*t.DEGREES_TO_RADIANS),this.multiply(c,h,0,0,-h,c,0,0,0,0,1,0,0,0,0,1),c=Math.cos(o*t.DEGREES_TO_RADIANS),h=Math.sin(o*t.DEGREES_TO_RADIANS),this.multiply(1,0,0,0,0,c,h,0,0,-h,c,0,0,0,0,1),c=Math.cos(n*t.DEGREES_TO_RADIANS),h=Math.sin(n*t.DEGREES_TO_RADIANS),this.multiply(c,-h,0,0,h,c,0,0,0,0,1,0,0,0,0,1),u.computePointFromPosition(i.latitude,i.longitude,i.altitude,S),f=S[0],d=S[1],p=S[2],l.localCoordinateAxesAtPoint(S,u,T,L,M),m=T[0],g=T[1],y=T[2],v=L[0],E=L[1],w=L[2],b=M[0],x=M[1],_=M[2],this.multiply(m,g,y,-m*f-g*d-y*p,v,E,w,-v*f-E*d-w*p,b,x,_,-b*f-x*d-_*p,0,0,0,1),this},u.prototype.multiplyByLookAtModelview=function(t,i,n,o,a,s){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","missingPosition"));if(0>i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","Range is less than zero"));if(!s)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","missingGlobe"));return this.multiplyByTranslation(0,0,-i),this.multiplyByFirstPersonModelview(t,n,o,a,s),this},u.prototype.setToPerspectiveProjection=function(t,i,n,o,a){if(0>=t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","invalidWidth"));if(0>=i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","invalidHeight"));if(0>=n||n>=180)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","invalidFieldOfView"));if(o===a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","Near and far distance are the same."));if(0>=o||0>=a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","Near or far distance is less than or equal to zero."));var s=t/i,u=Math.tan(l.toRadians(.5*n)),c=2*o*u,h=c*s,f=o,d=a;return this[0]=2*f/h,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=2*f/c,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=-(d+f)/(d-f),this[11]=-(2*f*d)/(d-f),this[12]=0,this[13]=0,this[14]=-1,this[15]=0,this},u.prototype.setToScreenProjection=function(t,i){if(0>=t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToScreenProjection","invalidWidth"));if(0>=i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToScreenProjection","invalidHeight"));return this[0]=2/t,this[1]=0,this[2]=0,this[3]=-1,this[4]=0,this[5]=2/i,this[6]=0,this[7]=-1,this[8]=0,this[9]=0,this[10]=2,this[11]=-1,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.setToInfiniteProjection=function(t,i,n,o){if(0>=t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToInfiniteProjection","invalidWidth"));if(0>=i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToInfiniteProjection","invalidHeight"));if(0>=n||n>=180)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToInfiniteProjection","invalidFieldOfView"));if(0>=o)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToInfiniteProjection","invalidClipDistance"));var a=t/i,s=Math.tan(l.toRadians(.5*n)),u=2*o*s,c=u*a,h=o;return this[0]=2*h/c,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=2*h/u,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=-1,this[11]=-2*h,this[12]=0,this[13]=0,this[14]=-1,this[15]=0,this},u.prototype.extractEyePoint=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractEyePoint","missingResult"));return t[0]=-(this[0]*this[3])-this[4]*this[7]-this[8]*this[11],t[1]=-(this[1]*this[3])-this[5]*this[7]-this[9]*this[11],t[2]=-(this[2]*this[3])-this[6]*this[7]-this[10]*this[11],t},u.prototype.extractForwardVector=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractForwardVector","missingResult"));return t[0]=-this[8],t[1]=-this[9],t[2]=-this[10],t},u.prototype.extractViewingParameters=function(i,o,a,s){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractViewingParameters","The specified origin is null or undefined."));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractViewingParameters","missingGlobe"));if(!s)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractViewingParameters","missingResult"));var l,c,h,f,d,p,m,g,y,v=new n(0,0,0),E=u.fromIdentity();return a.computePositionFromPoint(i[0],i[1],i[2],v),E.copy(this),E.multiplyByLocalCoordinateTransform(i,a),l=-E[11],c=E[10],h=Math.sqrt(E[2]*E[2]+E[6]*E[6]),f=Math.atan2(h,c)*t.RADIANS_TO_DEGREES,d=Math.cos(o*t.DEGREES_TO_RADIANS),p=Math.sin(o*t.DEGREES_TO_RADIANS),m=d*E[0]-p*E[4],g=p*E[5]-d*E[1],y=Math.atan2(g,m)*t.RADIANS_TO_DEGREES,s.origin=v,s.range=l,s.heading=y,s.tilt=f,s.roll=o,s},u.prototype.offsetProjectionDepth=function(t){return this[10]*=1+t,this},u.prototype.multiplyMatrix=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyMatrix","missingMatrix"));var i,n,o,a,s=this,l=t;return i=s[0],n=s[1],o=s[2],a=s[3],s[0]=i*l[0]+n*l[4]+o*l[8]+a*l[12],s[1]=i*l[1]+n*l[5]+o*l[9]+a*l[13],s[2]=i*l[2]+n*l[6]+o*l[10]+a*l[14],s[3]=i*l[3]+n*l[7]+o*l[11]+a*l[15],i=s[4],n=s[5],o=s[6],a=s[7],s[4]=i*l[0]+n*l[4]+o*l[8]+a*l[12],s[5]=i*l[1]+n*l[5]+o*l[9]+a*l[13],s[6]=i*l[2]+n*l[6]+o*l[10]+a*l[14],s[7]=i*l[3]+n*l[7]+o*l[11]+a*l[15],i=s[8],n=s[9],o=s[10],a=s[11],s[8]=i*l[0]+n*l[4]+o*l[8]+a*l[12],s[9]=i*l[1]+n*l[5]+o*l[9]+a*l[13],s[10]=i*l[2]+n*l[6]+o*l[10]+a*l[14],s[11]=i*l[3]+n*l[7]+o*l[11]+a*l[15],i=s[12],n=s[13],o=s[14],a=s[15],s[12]=i*l[0]+n*l[4]+o*l[8]+a*l[12],s[13]=i*l[1]+n*l[5]+o*l[9]+a*l[13],s[14]=i*l[2]+n*l[6]+o*l[10]+a*l[14],s[15]=i*l[3]+n*l[7]+o*l[11]+a*l[15],this},u.prototype.multiply=function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m){var g,y,v,E,w=this;return g=w[0],y=w[1],v=w[2],E=w[3],w[0]=g*t+y*n+v*l+E*f,w[1]=g*e+y*o+v*u+E*d,w[2]=g*r+y*a+v*c+E*p,w[3]=g*i+y*s+v*h+E*m,g=w[4],y=w[5],v=w[6],E=w[7],w[4]=g*t+y*n+v*l+E*f,w[5]=g*e+y*o+v*u+E*d,w[6]=g*r+y*a+v*c+E*p,w[7]=g*i+y*s+v*h+E*m,g=w[8],y=w[9],v=w[10],E=w[11],w[8]=g*t+y*n+v*l+E*f,w[9]=g*e+y*o+v*u+E*d,w[10]=g*r+y*a+v*c+E*p,w[11]=g*i+y*s+v*h+E*m,g=w[12],y=w[13],v=w[14],E=w[15],w[12]=g*t+y*n+v*l+E*f,w[13]=g*e+y*o+v*u+E*d,w[14]=g*r+y*a+v*c+E*p,w[15]=g*i+y*s+v*h+E*m,this},u.prototype.invertMatrix=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","invertMatrix","missingMatrix"));var i=[[],[],[],[]];i[0][0]=t[0],i[0][1]=t[1],i[0][2]=t[2],i[0][3]=t[3],i[1][0]=t[4],i[1][1]=t[5],i[1][2]=t[6],i[1][3]=t[7],i[2][0]=t[8],i[2][1]=t[9],i[2][2]=t[10],i[2][3]=t[11],i[3][0]=t[12],i[3][1]=t[13],i[3][2]=t[14],i[3][3]=t[15];var n,o,a=[],s=u.ludcmp(i,a);for(n=0;4>n;n+=1)s*=i[n][n];if(Math.abs(s)<1e-8)return null;var l=[[],[],[],[]],c=[];for(o=0;4>o;o+=1){for(n=0;4>n;n+=1)c[n]=0;for(c[o]=1,u.lubksb(i,a,c),n=0;4>n;n+=1)l[n][o]=c[n]}return this[0]=l[0][0],this[1]=l[0][1],this[2]=l[0][2],this[3]=l[0][3],this[4]=l[1][0],this[5]=l[1][1],this[6]=l[1][2],this[7]=l[1][3],this[8]=l[2][0],this[9]=l[2][1],this[10]=l[2][2],this[11]=l[2][3],this[12]=l[3][0],this[13]=l[3][1],this[14]=l[3][2],this[15]=l[3][3],this},u.lubksb=function(t,e,r){var i,n,o,a=-1;for(i=0;4>i;i+=1){var s=e[i];if(o=r[s],r[s]=r[i],-1!=a)for(n=a;i-1>=n;n+=1)o-=t[i][n]*r[n];else 0!=o&&(a=i);r[i]=o}for(i=3;i>=0;i-=1){for(o=r[i],n=i+1;4>n;n+=1)o-=t[i][n]*r[n];r[i]=o/t[i][i]}},u.ludcmp=function(t,e){var r,i,n,o,a,s,l,u,c=1e-20,h=[],f=1;for(i=0;4>i;i+=1){for(a=0,n=0;4>n;n+=1)(r=Math.abs(t[i][n]))>a&&(a=r);if(0==a)return 0;h[i]=1/a}for(n=0;4>n;n+=1){for(i=0;n>i;i+=1){for(s=t[i][n],o=0;i>o;o+=1)s-=t[i][o]*t[o][n];t[i][n]=s}for(a=0,l=-1,i=n;4>i;i+=1){for(s=t[i][n],o=0;n>o;o++)s-=t[i][o]*t[o][n];t[i][n]=s,(u=h[i]*Math.abs(s))>=a&&(a=u,l=i)}if(n!=l){for(o=0;4>o;o+=1)u=t[l][o],t[l][o]=t[n][o],t[n][o]=u;f=-f,h[l]=h[n]}if(e[n]=l,0==t[n][n]&&(t[n][n]=c),3!=n)for(u=1/t[n][n],i=n+1;4>i;i+=1)t[i][n]*=u}return f},u.prototype.invertOrthonormalMatrix=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","invertOrthonormalMatrix","missingMatrix"));var i=t;return this[0]=i[0],this[1]=i[4],this[2]=i[8],this[3]=0-i[0]*i[3]-i[4]*i[7]-i[8]*i[11],this[4]=i[1],this[5]=i[5],this[6]=i[9],this[7]=0-i[1]*i[3]-i[5]*i[7]-i[9]*i[11],this[8]=i[2],this[9]=i[6],this[10]=i[10],this[11]=0-i[2]*i[3]-i[6]*i[7]-i[10]*i[11],this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.invertOrthonormal=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","invertOrthonormalMatrix","missingMatrix"));var i=t,n=i[1],o=i[2],a=i[6],s=i[3],l=i[7],u=i[11];return this[0]=i[0],this[1]=i[4],this[2]=i[8],this[3]=0-i[0]*s-i[1]*l-i[2]*u,this[4]=n,this[5]=i[5],this[6]=i[9],this[7]=0-i[4]*s-i[5]*l-i[6]*u,this[8]=o,this[9]=a,this[10]=i[10],this[11]=0-i[8]*s-i[9]*l-i[10]*u,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.eigensystemFromSymmetricMatrix=function(t,i,n){if(!t||!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","eigensystemFromSymmetricMatrix","missingResult"));if(this[1]!=this[4]||this[2]!=this[8]||this[6]!=this[9])throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","eigensystemFromSymmetricMatrix","Matrix is not symmetric"));for(var o,a,s,u,c,h,f,d,p,m,g,y=1e-10,v=this[0],E=this[1],w=this[2],b=this[5],x=this[6],_=this[10],S=[[1,0,0],[0,1,0],[0,0,1]],T=32,L=0;T>L&&!(l.fabs(E)<y&&l.fabs(w)<y&&l.fabs(x)<y);L++){if(0!=E)for(o=.5*(b-v)/E,a=o*o,s=a+1,u=s!=a?(0>o?-1:1)*(Math.sqrt(s)-l.fabs(o)):.5/o,c=1/Math.sqrt(u*u+1),h=c*u,v-=u*E,b+=u*E,E=0,f=c*w-h*x,x=h*w+c*x,w=f,d=0;3>d;d++)f=c*S[d][0]-h*S[d][1],S[d][1]=h*S[d][0]+c*S[d][1],S[d][0]=f;if(0!=w)for(o=.5*(_-v)/w,a=o*o,s=a+1,u=s!=a?(0>o?-1:1)*(Math.sqrt(s)-l.fabs(o)):.5/o,c=1/Math.sqrt(u*u+1),h=c*u,v-=u*w,_+=u*w,w=0,f=c*E-h*x,x=h*E+c*x,E=f,d=0;3>d;d++)f=c*S[d][0]-h*S[d][2],S[d][2]=h*S[d][0]+c*S[d][2],S[d][0]=f;if(0!=x)for(o=.5*(_-b)/x,a=o*o,s=a+1,u=s!=a?(0>o?-1:1)*(Math.sqrt(s)-l.fabs(o)):.5/o,c=1/Math.sqrt(u*u+1),h=c*u,b-=u*x,_+=u*x,x=0,f=c*E-h*w,w=h*E+c*w,E=f,d=0;3>d;d++)f=c*S[d][1]-h*S[d][2],S[d][2]=h*S[d][1]+c*S[d][2],S[d][1]=f}p=0,m=1,g=2,b>v&&(f=v,v=b,b=f,f=p,p=m,m=f),_>b&&(f=b,b=_,_=f,f=m,m=g,g=f),b>v&&(f=v,v=b,b=f,f=p,p=m,m=f),t[0]=S[0][p],t[1]=S[1][p],t[2]=S[2][p],i[0]=S[0][m],i[1]=S[1][m],i[2]=S[2][m],n[0]=S[0][g],n[1]=S[1][g],n[2]=S[2][g],t.normalize(),i.normalize(),n.normalize(),t.multiply(v),i.multiply(b),n.multiply(_)},u.prototype.upper3By3=function(){var t=u.fromIdentity();return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[4]=this[4],t[5]=this[5],t[6]=this[6],t[8]=this[8],t[9]=this[9],t[10]=this[10],t},u}),i("../src/worldwind/pick/PickedObject",[],function(){"use strict";var t=function(t,e,r,i,n){this.color=t,this.userObject=e,this.position=r,this.parentLayer=i,this.isTerrain=n,this.isOnTop=!1};return t}),i("../src/worldwind/error/UnsupportedOperationError",["../error/AbstractError"],function(t){"use strict";var e=function(e){t.call(this,"UnsupportedOperationError",e);var r;try{throw new Error}catch(i){r=i.stack}this.stack=r};return e.prototype=Object.create(t.prototype),e}),i("../src/worldwind/render/Renderable",["../util/Logger","../error/UnsupportedOperationError"],function(t,e){"use strict";var r=function(){this.displayName="Renderable",this.enabled=!0,this.pickDelegate=null,this.userProperties={}};return r.prototype.render=function(r){throw new e(t.logMessage(t.LEVEL_SEVERE,"Renderable","render","abstractInvocation"))},r}),i("../src/worldwind/shapes/Annotation",["../shapes/AnnotationAttributes","../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Insets","../util/Logger","../geom/Matrix","../util/Offset","../pick/PickedObject","../render/Renderable","../shapes/TextAttributes","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p){"use strict";var m=function(r,i){if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Annotation","constructor","missingPosition"));c.call(this),this.position=r,this.attributes=i?i:new t(null),this.altitudeMode=WorldWind.ABSOLUTE,this.layer=null,this.lastStateKey=null,this.calloutTransform=s.fromIdentity(),this.calloutOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0),this.label="",this.labelTexture=null,this.labelTransform=s.fromIdentity(),this.placePoint=new d(0,0,0),this.depthOffset=-2.05,this.calloutPoints=null};return m.matrix=s.fromIdentity(),m.screenPoint=new d(0,0,0),m.scratchPoint=new d(0,0,0),m.prototype=Object.create(c.prototype),Object.defineProperties(m.prototype,{text:{get:function(){return this.label},set:function(t){this.label=t,this.lastStateKey=null}}}),m.prototype.renderOrdered=function(t){if(this.drawOrderedAnnotation(t),t.pickingMode){var e=new u(this.pickColor.clone(),this,this.position,this.layer,!1);t.pickPoint&&this.labelBounds.containsPoint(t.navigatorState.convertPointToViewport(t.pickPoint,m.scratchPoint))&&(e.labelPicked=!0),t.resolvePick(e)}},m.prototype.clone=function(){var t=new m(this.position);return t.copy(this),t.pickDelegate=this.pickDelegate?this.pickDelegate:this,t},m.prototype.copy=function(t){return this.position=t.position,this.enabled=t.enabled,this.attributes=t.attributes,this.label=t.label,this.altitudeMode=t.altitudeMode,this.pickDelegate=t.pickDelegate,this.depthOffset=t.depthOffset,this},m.prototype.render=function(t){if(this.enabled&&t.accumulateOrderedRenderables&&(!t.globe.projectionLimits||t.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude))){var e;if(this.lastFrameTime!==t.timestamp)e=this.makeOrderedRenderable(t);else{var r=this.clone();e=r.makeOrderedRenderable(t)}e&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e))}},m.prototype.drawOrderedAnnotation=function(t){this.beginDrawing(t);try{this.doDrawOrderedAnnotation(t)}finally{this.endDrawing(t)}},m.prototype.makeOrderedRenderable=function(t){var e,r,i,n,o,a,s,l,u;if(this.label=t.textSupport.wrap(this.label,this.attributes.width,this.attributes.height,this.attributes.textAttributes.font),t.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint),this.eyeDistance=t.navigatorState.eyePoint.distanceTo(this.placePoint),!t.navigatorState.projectWithDepth(this.placePoint,this.depthOffset,m.screenPoint))return null;var c=this.attributes.textAttributes.font,h=this.label+c.toString();this.labelTexture=t.gpuResourceCache.resourceForKey(h),this.labelTexture||(this.labelTexture=t.textSupport.createTexture(t,this.label,c,!1),t.gpuResourceCache.putResource(h,this.labelTexture,this.labelTexture.size)),e=this.labelTexture.imageWidth,r=this.labelTexture.imageHeight,i=this.attributes.scale,n=this.attributes.insets.left,o=this.attributes.insets.right,a=this.attributes.insets.top,s=this.attributes.insets.bottom,u=this.attributes.leaderGapHeight,l=this.calloutOffset.offsetForSize((e+n+o)*i,(r+a+s)*i),this.calloutTransform.setTranslation(m.screenPoint[0]-l[0],m.screenPoint[1]+u,m.screenPoint[2]),this.labelTransform.setTranslation(m.screenPoint[0]-l[0]+n*i,m.screenPoint[1]+u+s*i,m.screenPoint[2]),this.labelTransform.setScale(e*i,r*i,1),this.labelBounds=p.boundingRectForUnitQuad(this.labelTransform);var f=(e+n+o)*i,d=(r+a+s)*i,g=f/2,y=-u;return this.attributes.drawLeader||(y=0),this.attributes.stateKey!=this.lastStateKey&&(this.calloutPoints=this.createCallout(f,d,g,y,this.attributes.leaderGapWidth,this.attributes.cornerRadius)),this},m.prototype.beginDrawing=function(t){var e,i=t.currentGlContext;t.findAndBindProgram(r),e=t.currentProgram,i.enableVertexAttribArray(e.vertexPointLocation),i.enableVertexAttribArray(e.vertexTexCoordLocation),e.loadModulateColor(i,t.pickingMode)},m.prototype.endDrawing=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),t.bindProgram(null)},m.prototype.drawCorner=function(t,e,r,i,n,o,a,s){if(1>r)return s;for(var l=(n-i)/(o-1),u=1;o-1>u;u++){var c=i+l*u,h=t+Math.cos(c)*r,f=e+Math.sin(c)*r;a[s++]=h,a[s++]=f}return s},m.prototype.createCallout=function(t,e,r,i,n,o){var a=16,s=2*(12+(1>o?0:4*(a-2))),l=new Float32Array(s),u=0;return l[u++]=t/2+n/2,l[u++]=0,l[u++]=t-o,l[u++]=0,u=this.drawCorner(t-o,o,o,-Math.PI/2,0,a,l,u),l[u++]=t,l[u++]=o,l[u++]=t,l[u++]=e-o,u=this.drawCorner(t-o,e-o,o,0,Math.PI/2,a,l,u),l[u++]=t-o,l[u++]=e,l[u++]=o,l[u++]=e,u=this.drawCorner(o,e-o,o,Math.PI/2,Math.PI,a,l,u),l[u++]=0,l[u++]=e-o,l[u++]=0,l[u++]=o,u=this.drawCorner(o,o,o,Math.PI,1.5*Math.PI,a,l,u),l[u++]=o,l[u++]=0,l[u++]=t/2-n/2,l[u++]=0,l[u++]=r,l[u++]=i,l[u++]=t/2+n/2,l[u]=0,l},m.prototype.doDrawOrderedAnnotation=function(t){var e,r=t.currentGlContext,i=t.currentProgram,n=!1;t.pickingMode&&(this.pickColor=t.uniquePickColor()),i.loadOpacity(r,this.attributes.opacity);var o=this.attributes.stateKey!=this.lastStateKey;(!this.calloutCacheKey||o)&&(this.calloutCacheKey=t.gpuResourceCache.generateCacheKey());var a=t.gpuResourceCache.resourceForKey(this.calloutCacheKey);a||(a=r.createBuffer(),t.gpuResourceCache.putResource(this.calloutCacheKey,a,4*this.calloutPoints.length),n=!0),o&&this.calloutCacheKey&&t.gpuResourceCache.removeResource(this.calloutCacheKey),this.lastStateKey=this.attributes.stateKey,m.matrix.copy(t.screenProjection),m.matrix.multiplyMatrix(this.calloutTransform),i.loadModelviewProjection(r,m.matrix),r.bindBuffer(r.ARRAY_BUFFER,a),n&&(r.bufferData(r.ARRAY_BUFFER,this.calloutPoints,r.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),i.loadColor(r,t.pickingMode?this.pickColor:this.attributes.backgroundColor),i.loadTextureEnabled(r,!1),r.vertexAttribPointer(i.vertexPointLocation,2,r.FLOAT,!1,0,0),r.vertexAttribPointer(i.vertexTexCoordLocation,2,r.FLOAT,!1,0,0),r.drawArrays(r.TRIANGLE_FAN,0,this.calloutPoints.length/2),m.matrix.copy(t.screenProjection),m.matrix.multiplyMatrix(this.labelTransform),i.loadModelviewProjection(r,m.matrix),m.matrix.setToIdentity(),m.matrix.multiplyByTextureTransform(this.labelTexture),i.loadTextureMatrix(r,m.matrix),i.loadColor(r,t.pickingMode?this.pickColor:this.attributes.textAttributes.color),e=this.labelTexture.bind(t),i.loadTextureEnabled(r,e),r.bindBuffer(r.ARRAY_BUFFER,t.unitQuadBuffer3()),r.vertexAttribPointer(i.vertexPointLocation,3,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,t.unitQuadBuffer()),r.vertexAttribPointer(i.vertexTexCoordLocation,2,r.FLOAT,!1,0,0),r.drawArrays(r.TRIANGLE_STRIP,0,4)},m}),i("../src/worldwind/util/measure/MeasurerUtils",["../../geom/Location","../../geom/Position"],function(t,e){"use strict";var r={subdividePositions:function(r,i,n,o,a){var s,l=[],u=new t(0,0),c=new t(0,0),h=i[0];this.addPosition(r,l,h,n);for(var f=1;f<i.length;f++){var d=i[f],p=t.greatCircleDistance(h,d);u=t.interpolateAlongPath(o,.5,h,d,u);var m=p*r.radiusAt(u.latitude,u.longitude);if(m>a)for(var g=null,y=null,v=Math.ceil(m/a),E=1;v>E;E++){var w=E/v;o===WorldWind.LINEAR?c=t.interpolateLinear(w,h,d,c):o===WorldWind.RHUMB_LINE?(null==g&&(g=t.rhumbAzimuth(h,d),y=t.rhumbDistance(h,d)),c=t.rhumbLocation(h,g,w*y,c)):(null==g&&(g=t.greatCircleAzimuth(h,d),y=t.greatCircleDistance(h,d)),c=t.greatCircleLocation(h,g,w*y,c)),s=n?r.elevationAtLocation(c.latitude,c.longitude):h.altitude*(1-w)+d.altitude*w,l.push(new e(c.latitude,c.longitude,s))}this.addPosition(r,l,d,n),h=d}return l},addPosition:function(t,r,i,n){var o=i.altitude;return n&&(o=t.elevationAtLocation(i.latitude,i.longitude)),r.push(new e(i.latitude,i.longitude,o)),r},isLocationInside:function(t,e){for(var r=!1,i=e[0],n=1,o=e.length;o>n;n++){var a=e[n];(a.latitude<=t.latitude&&t.latitude<i.latitude||i.latitude<=t.latitude&&t.latitude<a.latitude)&&t.longitude<(i.longitude-a.longitude)*(t.latitude-a.latitude)/(i.latitude-a.latitude)+a.longitude&&(r=!r),i=a}return r},angleBetweenVectors:function(t,e){var r=t.dot(e),i=t.magnitude()*e.magnitude();return 0!==i&&1!==i&&(r/=i),-1>r?r=-1:r>1&&(r=1),Math.acos(r)}};return r}),i("../src/worldwind/geom/Sector",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o){"use strict";var a=function(t,e,r,i){this.minLatitude=t,this.maxLatitude=e,this.minLongitude=r,this.maxLongitude=i};return a.ZERO=new a(0,0,0,0),a.FULL_SPHERE=new a(-90,90,-180,180),a.prototype.copy=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","copy","missingSector"));return this.minLatitude=t.minLatitude,this.maxLatitude=t.maxLatitude,this.minLongitude=t.minLongitude,this.maxLongitude=t.maxLongitude,this},a.prototype.isEmpty=function(){return this.minLatitude===this.maxLatitude&&this.minLongitude===this.maxLongitude},a.prototype.deltaLatitude=function(){return this.maxLatitude-this.minLatitude},a.prototype.deltaLongitude=function(){return this.maxLongitude-this.minLongitude},a.prototype.centroidLatitude=function(){return.5*(this.minLatitude+this.maxLatitude)},a.prototype.centroidLongitude=function(){return.5*(this.minLongitude+this.maxLongitude)},a.prototype.centroid=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","centroid","missingResult"));return t.latitude=this.centroidLatitude(),t.longitude=this.centroidLongitude(),t},a.prototype.minLatitudeRadians=function(){return this.minLatitude*t.DEGREES_TO_RADIANS},a.prototype.maxLatitudeRadians=function(){return this.maxLatitude*t.DEGREES_TO_RADIANS},a.prototype.minLongitudeRadians=function(){return this.minLongitude*t.DEGREES_TO_RADIANS},a.prototype.maxLongitudeRadians=function(){return this.maxLongitude*t.DEGREES_TO_RADIANS},a.prototype.setToBoundingSector=function(t){if(!t||t.length<2)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","setToBoundingSector","missingArray"));for(var r=90,n=-90,o=180,a=-180,s=0,l=t.length;l>s;s+=1){var u=t[s];u&&(r=Math.min(r,u.latitude),n=Math.max(n,u.latitude),o=Math.min(o,u.longitude),a=Math.max(a,u.longitude))}return this.minLatitude=r,this.maxLatitude=n,this.minLongitude=o,this.maxLongitude=a,this},a.splitBoundingSectors=function(t){if(!t||t.length<2)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","splitBoundingSectors","missingArray"));for(var r=90,n=180,s=-90,l=-180,u=null,c=0,h=t.length;h>c;c+=1){var f=t[c],d=f.latitude;r>d&&(r=d),d>s&&(s=d);var p=f.longitude;if(p>=0&&n>p&&(n=p),0>=p&&p>l&&(l=p),null!=u){var m=u.longitude;o.signum(p)!=o.signum(m)&&Math.abs(p-m)<180&&(l=0,
n=0)}u=f}return r===s&&n===l?null:[new a(r,s,n,180),new a(r,s,-180,l)]},a.prototype.intersects=function(t){return t&&this.minLongitude<=t.maxLongitude&&this.maxLongitude>=t.minLongitude&&this.minLatitude<=t.maxLatitude&&this.maxLatitude>=t.minLatitude},a.prototype.overlaps=function(t){return t&&this.minLongitude<t.maxLongitude&&this.maxLongitude>t.minLongitude&&this.minLatitude<t.maxLatitude&&this.maxLatitude>t.minLatitude},a.prototype.contains=function(t){return t&&this.minLatitude<=t.minLatitude&&this.maxLatitude>=t.maxLatitude&&this.minLongitude<=t.minLongitude&&this.maxLongitude>=t.maxLongitude},a.prototype.containsLocation=function(t,e){return this.minLatitude<=t&&this.maxLatitude>=t&&this.minLongitude<=e&&this.maxLongitude>=e},a.prototype.intersection=function(t){if(!t instanceof a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","intersection","missingSector"));return this.minLatitude<t.minLatitude&&(this.minLatitude=t.minLatitude),this.maxLatitude>t.maxLatitude&&(this.maxLatitude=t.maxLatitude),this.minLongitude<t.minLongitude&&(this.minLongitude=t.minLongitude),this.maxLongitude>t.maxLongitude&&(this.maxLongitude=t.maxLongitude),this.maxLatitude<this.minLatitude&&(this.maxLatitude=this.minLatitude),this.maxLongitude<this.minLongitude&&(this.maxLongitude=this.minLongitude),this},a.prototype.union=function(t){if(!t instanceof a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","union","missingSector"));return this.minLatitude>t.minLatitude&&(this.minLatitude=t.minLatitude),this.maxLatitude<t.maxLatitude&&(this.maxLatitude=t.maxLatitude),this.minLongitude>t.minLongitude&&(this.minLongitude=t.minLongitude),this.maxLongitude<t.maxLongitude&&(this.maxLongitude=t.maxLongitude),this},a}),i("../src/worldwind/util/measure/AreaMeasurer",["../../geom/Angle","../../error/ArgumentError","../../geom/Location","../Logger","./MeasurerUtils","../../geom/Sector","../../geom/Vec3"],function(t,e,r,i,n,o,s){"use strict";var l=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"AreaMeasurer","constructor","missingWorldWindow"));this.wwd=t,this.DEFAULT_AREA_SAMPLING_STEPS=32,this._areaTerrainSamplingSteps=this.DEFAULT_AREA_SAMPLING_STEPS,this._maxSegmentLength=1e5,this.subdividedPositions=null,this.vecZ=new s(0,0,1),this.scratchLocation=new r(0,0)};return Object.defineProperties(l.prototype,{areaTerrainSamplingSteps:{get:function(){return this._areaTerrainSamplingSteps},set:function(t){this._areaTerrainSamplingSteps=t}},maxSegmentLength:{get:function(){return this._maxSegmentLength},set:function(t){this._maxSegmentLength=t}}}),l.prototype.getArea=function(t,e,r){var i=this.wwd.globe;return e?this.computeSurfaceAreaSampling(i,t,r):this.computeProjectedAreaGeometry(i,t,r)},l.prototype.computeSurfaceAreaSampling=function(e,r,i){var a=new o(0,0,0,0);a.setToBoundingSector(r),this.subdividedPositions=n.subdividePositions(e,r,!0,i,this._maxSegmentLength);for(var l=Math.max(this.DEFAULT_AREA_SAMPLING_STEPS,this._areaTerrainSamplingSteps),u=a.deltaLatitude()*t.DEGREES_TO_RADIANS,c=a.deltaLongitude()*t.DEGREES_TO_RADIANS,h=Math.max(u/l,c/l),f=Math.round(u/h),d=Math.round(c/h*Math.cos(a.centroidLatitude()*t.DEGREES_TO_RADIANS)),p=u/f,m=c/d,g=0,y=0;f>y;y++)for(var v=a.minLatitude*t.DEGREES_TO_RADIANS+p*y,E=e.radiusAt((v+p/2)*t.RADIANS_TO_DEGREES,a.centroidLongitude()),w=m*E*Math.cos(v+p/2),b=p*E,x=w*b,_=0;d>_;_++){var S=a.minLongitude*t.DEGREES_TO_RADIANS+m*_,T=v*t.RADIANS_TO_DEGREES,L=(v+p)*t.RADIANS_TO_DEGREES,M=S*t.RADIANS_TO_DEGREES,A=(S+m)*t.RADIANS_TO_DEGREES,N=new o(T,L,M,A),R=n.isLocationInside(N.centroid(this.scratchLocation),this.subdividedPositions);if(R){var C=e.elevationAtLocation(T,M),P=e.elevationAtLocation(T,A),O=e.elevationAtLocation(L,M),I=new s(w,0,P-C),k=new s(0,b,O-C);I.normalize(),k.normalize();var D=I.cross(k).normalize(),V=Math.tan(n.angleBetweenVectors(this.vecZ,D)),F=Math.sqrt(1+V*V);g+=x*F}}return g},l.prototype.computeProjectedAreaGeometry=function(e,r,i){this.subdividedPositions=n.subdividePositions(e,r,!1,i,this._maxSegmentLength);var o=this.subdividedPositions.length,a=this.subdividedPositions[0],s=this.subdividedPositions[o-1];a.equals(s)&&o--;for(var l=[],u=0,c=0;o>c;c++){var h=this.subdividedPositions[c];l[u++]=h.longitude*t.DEGREES_TO_RADIANS,l[u++]=h.latitude*t.DEGREES_TO_RADIANS,l[u++]=0}var f=this.tessellatePolygon(o,l),d=0,p=f.length/9;for(c=0;p>c;c++){u=9*c;var m=[f[u+0],f[u+1],f[u+2],f[u+3],f[u+4],f[u+5],f[u+6],f[u+7],f[u+8]];d+=this.computeTriangleProjectedArea(e,m)}return d},l.prototype.computeTriangleProjectedArea=function(e,r){var i=r[0],n=r[1],o=r[3],a=r[4],s=r[6],l=r[7],u=Math.abs(i*(a-l)+o*(l-n)+s*(n-a));u/=2;var c=(i+o+s)/3,h=(n+a+l)/3,f=e.radiusAt(h*t.RADIANS_TO_DEGREES,c*t.RADIANS_TO_DEGREES);return u*=Math.cos(h)*f*f},l.prototype.tessellatePolygon=function(t,e){var r,n=new window.libtess.GluTesselator,o=[];n.gluTessCallback(a.gluEnum.GLU_TESS_BEGIN,function(t){t!==a.primitiveType.GL_TRIANGLES&&i.logMessage(i.LEVEL_WARNING,"AreaMeasurer","tessellatePolygon","Tessellation error, primitive is not TRIANGLES.")}),n.gluTessCallback(a.gluEnum.GLU_TESS_VERTEX_DATA,function(t,e){e.push(t[0]),e.push(t[1]),e.push(t[2])}),n.gluTessCallback(a.gluEnum.GLU_TESS_EDGE_FLAG,function(){}),n.gluTessCallback(a.gluEnum.GLU_TESS_ERROR,function(t){i.logMessage(i.LEVEL_WARNING,"AreaMeasurer","tessellatePolygon","Tessellation error "+t+".")}),n.gluTessBeginPolygon(o),n.gluTessBeginContour();for(var s=0;t>s;s++)r=e.slice(3*s,3*s+3),n.gluTessVertex(r,r);return n.gluTessEndContour(),n.gluTessEndPolygon(),o},l}),i("../src/worldwind/shaders/AtmosphereProgram",["../error/ArgumentError","../shaders/GpuProgram","../util/Logger"],function(t,e,r){"use strict";var i=function(t,r,i,n){e.call(this,t,r,i,n),this.FRAGMODE_SKY=1,this.FRAGMODE_GROUND_PRIMARY=2,this.FRAGMODE_GROUND_SECONDARY=3,this.FRAGMODE_GROUND_PRIMARY_TEX_BLEND=4,this.altitude=16e4,this.rayleighScaleDepth=.25,this.fragModeLocation=this.uniformLocation(t,"fragMode"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.texCoordMatrixLocation=this.uniformLocation(t,"texCoordMatrix"),this.vertexOriginLocation=this.uniformLocation(t,"vertexOrigin"),this.eyePointLocation=this.uniformLocation(t,"eyePoint"),this.eyeMagnitudeLocation=this.uniformLocation(t,"eyeMagnitude"),this.eyeMagnitude2Location=this.uniformLocation(t,"eyeMagnitude2"),this.lightDirectionLocation=this.uniformLocation(t,"lightDirection"),this.atmosphereRadiusLocation=this.uniformLocation(t,"atmosphereRadius"),this.atmosphereRadius2Location=this.uniformLocation(t,"atmosphereRadius2"),this.globeRadiusLocation=this.uniformLocation(t,"globeRadius"),this.scaleLocation=this.uniformLocation(t,"scale"),this.scaleDepthLocation=this.uniformLocation(t,"scaleDepth"),this.scaleOverScaleDepthLocation=this.uniformLocation(t,"scaleOverScaleDepth"),this.scratchArray9=new Float32Array(9)};return i.key="WorldWindGpuAtmosphereProgram",i.prototype=Object.create(e.prototype),i.prototype.getAltitude=function(){return this.altitude},i.prototype.loadFragMode=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadFragMode","missingFragMode"));e.uniform1i(this.fragModeLocation,i)},i.prototype.loadModelviewProjection=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,i,this.mvpMatrixLocation)},i.prototype.loadVertexOrigin=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadVertexOrigin","missingVector"));e.uniform3f(this.vertexOriginLocation,i[0],i[1],i[2])},i.prototype.loadLightDirection=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadLightDirection","missingVector"));e.uniform3f(this.lightDirectionLocation,i[0],i[1],i[2])},i.prototype.loadEyePoint=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadEyePoint","missingVector"));e.uniform3f(this.eyePointLocation,i[0],i[1],i[2]),e.uniform1f(this.eyeMagnitudeLocation,i.magnitude()),e.uniform1f(this.eyeMagnitude2Location,i.magnitudeSquared())},i.prototype.loadGlobeRadius=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadGlobeRadius","missingGlobeRadius"));var n=i,o=n+this.altitude;e.uniform1f(this.globeRadiusLocation,n),e.uniform1f(this.atmosphereRadiusLocation,o),e.uniform1f(this.atmosphereRadius2Location,o*o)},i.prototype.setScale=function(t){t.uniform1f(this.scaleLocation,1/this.getAltitude()),t.uniform1f(this.scaleDepthLocation,this.rayleighScaleDepth),t.uniform1f(this.scaleOverScaleDepthLocation,1/this.getAltitude()/this.rayleighScaleDepth)},i.prototype.loadTexMatrix=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadTexMatrix","missingMatrix"));i.columnMajorComponents(this.scratchArray9),e.uniformMatrix3fv(this.texCoordMatrixLocation,!1,this.scratchArray9)},i}),i("../src/worldwind/shaders/GroundProgram",["../shaders/AtmosphereProgram"],function(t){"use strict";var e=function(e){var r="precision mediump int;\nconst int FRAGMODE_GROUND_PRIMARY_TEX_BLEND = 4;\nconst int SAMPLE_COUNT = 2;\nconst float SAMPLES = 2.0;\nconst float PI = 3.141592653589;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * PI;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * PI;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 invWavelength = vec3(5.60204474633241, 9.473284437923038, 19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nuniform int fragMode;\nuniform mat4 mvpMatrix;\nuniform mat3 texCoordMatrix;\nuniform vec3 vertexOrigin;\nuniform vec3 eyePoint;\nuniform float eyeMagnitude;\nuniform float eyeMagnitude2;\nuniform vec3 lightDirection;\nuniform float atmosphereRadius;\nuniform float atmosphereRadius2;\nuniform float globeRadius;\nuniform float scale;\nuniform float scaleDepth;\nuniform float scaleOverScaleDepth;\nattribute vec4 vertexPoint;\nattribute vec2 vertexTexCoord;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec2 texCoord;\nfloat scaleFunc(float cos) {\n    float x = 1.0 - cos;\n    return scaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid sampleGround() {\n    vec3 point = vertexPoint.xyz + vertexOrigin;\n    vec3 ray = point - eyePoint;\n    float far = length(ray);\n    ray /= far;\n    vec3 start;\n    if (eyeMagnitude < atmosphereRadius) {\n        start = eyePoint;\n    } else {\n        float B = 2.0 * dot(eyePoint, ray);\n        float C = eyeMagnitude2 - atmosphereRadius2;\n        float det = max(0.0, B*B - 4.0 * C);\n        float near = 0.5 * (-B - sqrt(det));\n        start = eyePoint + ray * near;\n        far -= near;\n}\n    float depth = exp((globeRadius - atmosphereRadius) / scaleDepth);\n    float eyeAngle = dot(-ray, point) / length(point);\n    float lightAngle = dot(lightDirection, point) / length(point);\n    float eyeScale = scaleFunc(eyeAngle);\n    float lightScale = scaleFunc(lightAngle);\n    float eyeOffset = depth*eyeScale;\n    float temp = (lightScale + eyeScale);\n    float sampleLength = far / SAMPLES;\n    float scaledLength = sampleLength * scale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    vec3 attenuate = vec3(0.0, 0.0, 0.0);\n    for(int i=0; i<SAMPLE_COUNT; i++)\n    {\n        float height = length(samplePoint);\n        float depth = exp(scaleOverScaleDepth * (globeRadius - height));\n        float scatter = depth*temp - eyeOffset;\n        attenuate = exp(-scatter * (invWavelength * Kr4PI + Km4PI));\n        frontColor += attenuate * (depth * scaledLength);\n        samplePoint += sampleRay;\n    }\n    primaryColor = frontColor * (invWavelength * KrESun + KmESun);\n    secondaryColor = attenuate;\n}\nvoid main()\n {\n    sampleGround();\n    gl_Position = mvpMatrix * vertexPoint;\n    if (fragMode == FRAGMODE_GROUND_PRIMARY_TEX_BLEND) {\n        texCoord = (texCoordMatrix * vec3(vertexTexCoord, 1.0)).st;\n    }\n}",i="precision mediump float;\nprecision mediump int;\nconst int FRAGMODE_GROUND_PRIMARY = 2;\nconst int FRAGMODE_GROUND_SECONDARY = 3;\nconst int FRAGMODE_GROUND_PRIMARY_TEX_BLEND = 4;\nuniform int fragMode;\nuniform sampler2D texSampler;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec2 texCoord;\nvoid main (void)\n{\n    if (fragMode == FRAGMODE_GROUND_PRIMARY) {\n        gl_FragColor = vec4(primaryColor, 1.0);\n    } else if (fragMode == FRAGMODE_GROUND_SECONDARY) {\n        gl_FragColor = vec4(secondaryColor, 1.0);\n    } else if (fragMode == FRAGMODE_GROUND_PRIMARY_TEX_BLEND) {\n        vec4 texColor = texture2D(texSampler, texCoord);\n        gl_FragColor = vec4(primaryColor + texColor.rgb * (1.0 - secondaryColor), 1.0);\n    }\n}";t.call(this,e,r,i,["vertexPoint","vertexTexCoord"])};return e.key="WorldWindGroundProgram",e.prototype=Object.create(t.prototype),e}),i("../src/worldwind/layer/Layer",["../util/Logger"],function(t){"use strict";var e=function(t){this.displayName=t?t:"Layer",this.enabled=!0,this.pickEnabled=!0,this.opacity=1,this.minActiveAltitude=-Number.MAX_VALUE,this.maxActiveAltitude=Number.MAX_VALUE,this.inCurrentFrame=!1,this.time=null};return e.prototype.refresh=function(){},e.prototype.render=function(t){this.inCurrentFrame=!1,this.enabled&&(!t.pickingMode||this.pickEnabled)&&this.withinActiveAltitudes(t)&&this.isLayerInView(t)&&this.doRender(t)},e.prototype.doRender=function(t){},e.prototype.withinActiveAltitudes=function(t){var e=t.eyePosition;return e?e.altitude>=this.minActiveAltitude&&e.altitude<=this.maxActiveAltitude:!1},e.prototype.isLayerInView=function(t){return!0},e}),i("../src/worldwind/geom/Matrix3",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(t,e,r,i,n,o,a,s,l){this[0]=t,this[1]=e,this[2]=r,this[3]=i,this[4]=n,this[5]=o,this[6]=a,this[7]=s,this[8]=l};return r.prototype=new Float64Array(9),r.fromIdentity=function(){return new r(1,0,0,0,1,0,0,0,1)},r.prototype.setToUnitYFlip=function(){return this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=-1,this[5]=1,this[6]=0,this[7]=0,this[8]=1,this},r.prototype.multiplyMatrix=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"Matrix3","multiplyMatrix","missingMatrix"));var i,n,o,a=this,s=r;return i=a[0],n=a[1],o=a[2],a[0]=i*s[0]+n*s[3]+o*s[6],a[1]=i*s[1]+n*s[4]+o*s[7],a[2]=i*s[2]+n*s[5]+o*s[8],i=a[3],n=a[4],o=a[5],a[3]=i*s[0]+n*s[3]+o*s[6],a[4]=i*s[1]+n*s[4]+o*s[7],a[5]=i*s[2]+n*s[5]+o*s[8],i=a[6],n=a[7],o=a[8],a[6]=i*s[0]+n*s[3]+o*s[6],a[7]=i*s[1]+n*s[4]+o*s[7],a[8]=i*s[2]+n*s[5]+o*s[8],this},r.prototype.multiplyByTileTransform=function(t,e){var r=t.deltaLatitude(),i=t.deltaLongitude(),n=e.deltaLatitude(),o=e.deltaLongitude(),a=i/o,s=r/n,l=(t.minLongitude-e.minLongitude)/o,u=(t.minLatitude-e.minLatitude)/n,c=this;return c[2]+=c[0]*l+c[1]*u,c[5]+=c[3]*l+c[4]*u,c[8]+=c[6]*l+c[6]*u,c[0]*=a,c[1]*=s,c[3]*=a,c[4]*=s,c[6]*=a,c[7]*=s,this},r.prototype.columnMajorComponents=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"Matrix3","columnMajorComponents","missingResult"));return r[0]=this[0],r[1]=this[3],r[2]=this[6],r[3]=this[1],r[4]=this[4],r[5]=this[7],r[6]=this[2],r[7]=this[5],r[8]=this[8],r},r}),i("../src/worldwind/shaders/SkyProgram",["../shaders/AtmosphereProgram"],function(t){"use strict";var e=function(e){var r="precision mediump int;\nconst int SAMPLE_COUNT = 2;\nconst float SAMPLES = 2.0;\nconst float PI = 3.141592653589;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * PI;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * PI;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 invWavelength = vec3(5.60204474633241, 9.473284437923038, 19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nuniform mat4 mvpMatrix;\nuniform vec3 vertexOrigin;\nuniform vec3 eyePoint;\nuniform float eyeMagnitude;\nuniform float eyeMagnitude2;\nuniform mediump vec3 lightDirection;\nuniform float atmosphereRadius;\nuniform float atmosphereRadius2;\nuniform float globeRadius;\nuniform float scale;\nuniform float scaleDepth;\nuniform float scaleOverScaleDepth;\nattribute vec4 vertexPoint;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nfloat scaleFunc(float cos)\n{\n    float x = 1.0 - cos;\n    return scaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid sampleSky() {\n    vec3 point = vertexPoint.xyz + vertexOrigin;\n    vec3 ray = point - eyePoint;\n    float far = length(ray);\n    ray /= far;\n    vec3 start;\n    float startOffset;\n    if (eyeMagnitude < atmosphereRadius) {\n        start = eyePoint;\n        float height = length(start);\n        float depth = exp(scaleOverScaleDepth * (globeRadius - eyeMagnitude));\n        float startAngle = dot(ray, start) / height;\n        startOffset = depth*scaleFunc(startAngle);\n    } else {\n        float B = 2.0 * dot(eyePoint, ray);\n        float C = eyeMagnitude2 - atmosphereRadius2;\n        float det = max(0.0, B*B - 4.0 * C);\n        float near = 0.5 * (-B - sqrt(det));\n        start = eyePoint + ray * near;\n        far -= near;\n        float startAngle = dot(ray, start) / atmosphereRadius;\n        float startDepth = exp(-1.0 / scaleDepth);\n        startOffset = startDepth*scaleFunc(startAngle);\n    }\n    float sampleLength = far / SAMPLES;\n    float scaledLength = sampleLength * scale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    for(int i=0; i<SAMPLE_COUNT; i++)\n    {\n       float height = length(samplePoint);\n       float depth = exp(scaleOverScaleDepth * (globeRadius - height));\n       float lightAngle = dot(lightDirection, samplePoint) / height;\n       float cameraAngle = dot(ray, samplePoint) / height;\n       float scatter = (startOffset + depth*(scaleFunc(lightAngle) - scaleFunc(cameraAngle)));\n       vec3 attenuate = exp(-scatter * (invWavelength * Kr4PI + Km4PI));\n       frontColor += attenuate * (depth * scaledLength);\n       samplePoint += sampleRay;\n    }\n    primaryColor = frontColor * (invWavelength * KrESun);\n    secondaryColor = frontColor * KmESun;\n    direction = eyePoint - point;\n}\nvoid main()\n{\n    sampleSky();\n    gl_Position = mvpMatrix * vertexPoint;\n}",i="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nconst float g = -0.95;\nconst float g2 = g * g;\nuniform mediump vec3 lightDirection;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nvoid main (void)\n{\n    float cos = dot(lightDirection, direction) / length(direction);\n    float rayleighPhase = 0.75 * (1.0 + cos * cos);\n    float miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cos*cos) /         pow(1.0 + g2 - 2.0*g*cos, 1.5);\n    const float exposure = 2.0;\n    vec3 color = primaryColor * rayleighPhase + secondaryColor * miePhase;\n    color = vec3(1.0) - exp(-exposure * color);\n    gl_FragColor = vec4(color, color.b);\n}";t.call(this,e,r,i,["vertexPoint"])};return e.key="WorldWindSkyProgram",e.prototype=Object.create(t.prototype),e}),i("../src/worldwind/util/WWUtil",["../error/ArgumentError","../geom/Line","../util/Logger","../geom/Rectangle","../geom/Vec3"],function(t,e,r,i,n){"use strict";var o={latLonRegex:/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/,suffixForMimeType:function(t){return"image/png"===t?"png":"image/jpeg"===t?"jpg":"application/bil16"===t?"bil":"application/bil32"===t?"bil":null},currentUrlSansFilePart:function(){for(var t=window.location.protocol,e=window.location.host,r=window.location.pathname,i=r.split("/"),n="",o=0,a=i.length;a-1>o;o++)i[o].length>0&&(n=n+"/"+i[o]);return t+"//"+e+n},worldwindlibLocation:function(){for(var t=document.getElementsByTagName("script"),e="/worldwind.",r=0;r<t.length;r++){var i=t[r].src.indexOf(e);if(i>=0)return t[r].src.substring(0,i)+"/"}return null},urlPath:function(t){if(!t)return"";for(var e=t.split("/"),r="",i=0,n=e.length;n>i;i++){var o=e[i];o&&0!==o.length&&-1==o.indexOf(":")&&"."!==o&&".."!==o&&"null"!==o&&"undefined"!==o&&(0!==r.length&&(r+="/"),r+=o)}return r},fillArray:function(t,e){if(t)for(var r=0,i=t.length;i>r;r++)t[r]=e},multiplyArray:function(t,e){if(t)for(var r=0,i=t.length;i>r;r++)t[r]*=e},jsonpCounter:0,jsonp:function(t,e,r){var i="gov_nasa_worldwind_jsonp_"+o.jsonpCounter++;window[i]=function(t){delete window[i],r(t)};var n=t+(-1===t.indexOf("?")?"?":"&");n+=e+"="+i;var a=document.createElement("script");a.async=!0,a.src=n;var s=document.getElementsByTagName("head")[0],l=function(){a.onload=void 0,a.onerror=void 0,s.removeChild(a)};a.onload=l,a.onerror=l,s.appendChild(a)},arrayEquals:function(t,e){return t.length==e.length&&t.every(function(t,r){return t===e[r]||t.equals&&t.equals(e[r])})},transformToBoolean:function(t){return 0==t||"0"==t||"false"==t?!1:Boolean(t)},clone:function(t){var e,r={},i=Object.keys(t);for(e=0;e<i.length;e++)r[i[e]]=t[i[e]];return r},guid:function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},date:function(t){return new Date(t)},startsWith:function(t,e,r){return r=r||0,t.substr(r,e.length)===e},endsWith:function(t,e,r){("number"!=typeof r||!isFinite(r)||Math.floor(r)!==r||r>t.length)&&(r=t.length),r-=e.length;var i=t.lastIndexOf(e,r);return-1!==i&&i===r}};return o}),i("../src/worldwind/layer/AtmosphereLayer",["../error/ArgumentError","../shaders/GroundProgram","../layer/Layer","../util/Logger","../geom/Matrix","../geom/Matrix3","../geom/Sector","../shaders/SkyProgram","../geom/Vec3","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u){"use strict";var c=function(t){r.call(this,"Atmosphere"),this.pickEnabled=!1,this._nightImageSource=t||WorldWind.configuration.baseUrl+"images/dnb_land_ocean_ice_2012.png",this._lightLocation=null,this._activeLightDirection=new l(0,0,0),this._fullSphereSector=a.FULL_SPHERE,this._skyData={},this._skyWidth=128,this._skyHeight=128,this._numIndices=0,this._texMatrix=o.fromIdentity(),this._activeTexture=null};return c.prototype=Object.create(r.prototype),Object.defineProperties(c.prototype,{lightLocation:{get:function(){return this._lightLocation},set:function(t){this._lightLocation=t}},nightImageSource:{get:function(){return this._nightImageSource},set:function(t){this._nightImageSource=t}}}),c.prototype.doRender=function(t){t.globe.is2D()||(this.determineLightDirection(t),this.drawSky(t),this.drawGround(t))},c.prototype.applySkyVertices=function(t){var e,r,i=t.currentGlContext,n=t.currentProgram,o=this._skyData;o.verticesVboCacheKey||(o.verticesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(o.verticesVboCacheKey),r?(i.bindBuffer(i.ARRAY_BUFFER,r),i.vertexAttribPointer(0,3,i.FLOAT,!1,0,0)):(e=this.assembleVertexPoints(t,this._skyHeight,this._skyWidth,n.getAltitude()),r=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,r),i.bufferData(i.ARRAY_BUFFER,e,i.STATIC_DRAW),i.vertexAttribPointer(0,3,i.FLOAT,!1,0,0),t.gpuResourceCache.putResource(o.verticesVboCacheKey,r,4*e.length),t.frameStatistics.incrementVboLoadCount(1))},c.prototype.applySkyIndices=function(t){var e,r,i=t.currentGlContext,n=this._skyData;n.indicesVboCacheKey||(n.indicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(n.indicesVboCacheKey),r?i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r):(e=this.assembleTriStripIndices(this._skyWidth,this._skyHeight),r=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e,i.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),t.gpuResourceCache.putResource(n.indicesVboCacheKey,r,2*e.length))},c.prototype.drawSky=function(t){var e=t.currentGlContext,r=t.findAndBindProgram(s);r.loadGlobeRadius(e,t.globe.equatorialRadius),r.loadEyePoint(e,t.navigatorState.eyePoint),r.loadVertexOrigin(e,l.ZERO),r.loadModelviewProjection(e,t.navigatorState.modelviewProjection),r.loadLightDirection(e,this._activeLightDirection),r.setScale(e),this.applySkyVertices(t),this.applySkyIndices(t),e.depthMask(!1),e.frontFace(e.CW),e.enableVertexAttribArray(0),e.drawElements(e.TRIANGLE_STRIP,this._numIndices,e.UNSIGNED_SHORT,0),e.depthMask(!0),e.frontFace(e.CCW),e.disableVertexAttribArray(0)},c.prototype.drawGround=function(t){var r,i=t.currentGlContext,n=t.findAndBindProgram(e),o=t.terrain;n.loadGlobeRadius(i,t.globe.equatorialRadius),n.loadEyePoint(i,t.navigatorState.eyePoint),n.loadLightDirection(i,this._activeLightDirection),n.setScale(i),this.nightImageSource&&this.lightLocation&&(this._activeTexture=t.gpuResourceCache.resourceForKey(this.nightImageSource),this._activeTexture||(this._activeTexture=t.gpuResourceCache.retrieveTexture(i,this.nightImageSource)),r=this._activeTexture&&this._activeTexture.bind(t)),o.beginRendering(t);for(var a=0,s=o.surfaceGeometry.length;s>a;a++){var l=o.surfaceGeometry[a],u=l.referencePoint;n.loadVertexOrigin(i,u),r&&(this._texMatrix.setToUnitYFlip(),this._texMatrix.multiplyByTileTransform(l.sector,this._fullSphereSector),n.loadTexMatrix(i,this._texMatrix)),o.beginRenderingTile(t,l),n.loadFragMode(i,n.FRAGMODE_GROUND_SECONDARY),i.blendFunc(i.DST_COLOR,i.ZERO),o.renderTile(t,l);var c=r?n.FRAGMODE_GROUND_PRIMARY_TEX_BLEND:n.FRAGMODE_GROUND_PRIMARY;n.loadFragMode(i,c),i.blendFunc(i.ONE,i.ONE),o.renderTile(t,l),o.endRenderingTile(t,l)}o.endRendering(t),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),this._activeTexture=null},c.prototype.assembleVertexPoints=function(t,e,r,i){var n=e*r,o=new Array(n);u.fillArray(o,i);var a=new Float32Array(3*n);return t.globe.computePointsForGrid(this._fullSphereSector,e,r,o,l.ZERO,a)},c.prototype.assembleTriStripIndices=function(t,e){for(var r=[],i=0,n=0;t-1>n;n++){for(var o=0;e>o;o++)i=o+n*e,r.push(i+e),r.push(i);t-2>n&&(r.push(i),r.push((n+2)*e))}return this._numIndices=r.length,new Uint16Array(r)},c.prototype.determineLightDirection=function(t){null!=this.lightLocation?t.globe.computePointFromLocation(this.lightLocation.latitude,this.lightLocation.longitude,this._activeLightDirection):this._activeLightDirection.copy(t.navigatorState.eyePoint),this._activeLightDirection.normalize()},c}),i("../src/worldwind/shaders/BasicProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(t,e,r,i){"use strict";var n=function(t){var e="attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nvoid main() {gl_Position = mvpMatrix * vertexPoint;}",i="precision mediump float;\nuniform vec4 color;\nvoid main() {gl_FragColor = color;}";r.call(this,t,e,i),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.colorLocation=this.uniformLocation(t,"color")};return n.key="WorldWindGpuBasicProgram",n.prototype=Object.create(r.prototype),n.prototype.loadModelviewProjection=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,r,this.mvpMatrixLocation)},n.prototype.loadColor=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicProgram","loadColor","missingColor"));this.loadUniformColor(e,r,this.colorLocation)},n.prototype.loadColorComponents=function(t,e,r,i,n){this.loadUniformColorComponents(t,e,r,i,n,this.colorLocation)},n}),i("../src/worldwind/util/BasicTimeSequence",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r&&r.length<2)throw new t(e.logMessage(e.LEVEL_SEVERE,"BasicTimeSequence","constructor","missingDates"));this.dates=r,this.currentIndex=0,this.currentTime=r[0]};return Object.defineProperties(r.prototype,{scaleForCurrentTime:{get:function(){return this.currentTime?this.currentIndex/this.dates.length:1}}}),r.prototype.next=function(){return this.currentIndex>=this.dates.length-1?null:(this.currentIndex++,this.currentTime=this.dates[this.currentIndex],this.currentTime)},r.prototype.previous=function(){return this.currentIndex<=0?null:(this.currentIndex--,this.currentTime=this.dates[this.currentIndex],this.currentTime)},r.prototype.reset=function(){this.currentIndex=-1,this.currentTime=null},r.prototype.getTimeForScale=function(t){return 0>=t?this.currentIndex=0:t>=1?this.currentIndex=this.dates.length-1:this.currentIndex=Math.floor(this.dates.length*t),this.currentTime=this.dates[this.currentIndex],this.currentTime},r}),i("../src/worldwind/gesture/Touch",[],function(){"use strict";var t=function(t,e,r){this.identifier=t,this._clientX=e,this._clientY=r,this._clientStartX=e,this._clientStartY=r};return Object.defineProperties(t.prototype,{clientX:{get:function(){return this._clientX},set:function(t){this._clientX=t}},clientY:{get:function(){return this._clientY},set:function(t){this._clientY=t}},translationX:{get:function(){return this._clientX-this._clientStartX},set:function(t){this._clientStartX=this._clientX-t}},translationY:{get:function(){return this._clientY-this._clientStartY},set:function(t){this._clientStartY=this._clientY-t}}}),t}),i("../src/worldwind/gesture/GestureRecognizer",["../error/ArgumentError","../util/Logger","../gesture/Touch"],function(t,e,r){"use strict";var i=function(r,n){function o(t){a.handleEvent(t)}if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","constructor","missingTarget"));this.target=r,this.enabled=!0,this._state=WorldWind.POSSIBLE,this._nextState=null,this._clientX=0,this._clientY=0,this._clientStartX=0,this._clientStartY=0,this._translationX=0,this._translationY=0,this._translationWeight=.4,this._mouseButtonMask=0,this._touches=[],this._touchCentroidShiftX=0,this._touchCentroidShiftY=0,this._gestureCallbacks=[],this._canRecognizeWith=[],this._requiresFailureOf=[],this._requiredToFailBy=[],n&&this._gestureCallbacks.push(n),i.allRecognizers.push(this);var a=this;window.PointerEvent?(r.addEventListener("pointerdown",o,!1),window.addEventListener("pointermove",o,!1),window.addEventListener("pointercancel",o,!1),window.addEventListener("pointerup",o,!1)):(r.addEventListener("mousedown",o,!1),window.addEventListener("mousemove",o,!1),window.addEventListener("mouseup",o,!1),r.addEventListener("touchstart",o,!1),r.addEventListener("touchmove",o,!1),r.addEventListener("touchend",o,!1),r.addEventListener("touchcancel",o,!1))};return i.allRecognizers=[],Object.defineProperties(i.prototype,{state:{get:function(){return this._state},set:function(t){this.transitionToState(t)}},clientX:{get:function(){return this._clientX},set:function(t){this._clientX=t}},clientY:{get:function(){return this._clientY},set:function(t){this._clientY=t}},translationX:{get:function(){return this._translationX},set:function(t){this._translationX=t,this._clientStartX=this._clientX,this._touchCentroidShiftX=0}},translationY:{get:function(){return this._translationY},set:function(t){this._translationY=t,this._clientStartY=this._clientY,this._touchCentroidShiftY=0}},mouseButtonMask:{get:function(){return this._mouseButtonMask}},touchCount:{get:function(){return this._touches.length}},gestureCallbacks:{get:function(){return this._gestureCallbacks}}}),i.prototype.touch=function(r){if(0>r||r>=this._touches.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","touch","indexOutOfRange"));return this._touches[r]},i.prototype.recognizeSimultaneouslyWith=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","recognizeSimultaneouslyWith","The specified gesture recognizer is null or undefined."));var i=this._canRecognizeWith.indexOf(r);-1==i&&(this._canRecognizeWith.push(r),r._canRecognizeWith.push(this))},i.prototype.canRecognizeSimultaneouslyWith=function(t){var e=this._canRecognizeWith.indexOf(t);return-1!=e},i.prototype.requireRecognizerToFail=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","requireRecognizerToFail","The specified gesture recognizer is null or undefined"));var i=this._requiresFailureOf.indexOf(r);
-1==i&&(this._requiresFailureOf.push(r),r._requiredToFailBy.push(this))},i.prototype.requiresRecognizerToFail=function(t){var e=this._requiresFailureOf.indexOf(t);return-1!=e},i.prototype.requiredToFailByRecognizer=function(t){var e=this._requiredToFailBy.indexOf(t);return-1!=e},i.prototype.reset=function(){this._state=WorldWind.POSSIBLE,this._nextState=null,this._clientX=0,this._clientY=0,this._clientStartX=0,this._clientStartY=0,this._translationX=0,this._translationY=0,this._mouseButtonMask=0,this._touches=[],this._touchCentroidShiftX=0,this._touchCentroidShiftY=0},i.prototype.prepareToRecognize=function(){},i.prototype.mouseDown=function(t){},i.prototype.mouseMove=function(t){},i.prototype.mouseUp=function(t){},i.prototype.touchStart=function(t){},i.prototype.touchMove=function(t){},i.prototype.touchCancel=function(t){},i.prototype.touchEnd=function(t){},i.prototype.transitionToState=function(t){this._nextState=null,t==WorldWind.FAILED?(this._state=t,this.updateRecognizersWaitingForFailure(),this.resetIfEventsEnded()):t==WorldWind.RECOGNIZED?(this.tryToRecognize(t),this._state==t&&(this.prepareToRecognize(),this.callGestureCallbacks(),this.resetIfEventsEnded())):t==WorldWind.BEGAN?(this.tryToRecognize(t),this._state==t&&(this.prepareToRecognize(),this.callGestureCallbacks())):t==WorldWind.CHANGED?(this._state=t,this.callGestureCallbacks()):t==WorldWind.CANCELLED?(this._state=t,this.callGestureCallbacks(),this.resetIfEventsEnded()):t==WorldWind.ENDED&&(this._state=t,this.callGestureCallbacks(),this.resetIfEventsEnded())},i.prototype.updateRecognizersWaitingForFailure=function(){for(var t=0,e=this._requiredToFailBy.length;e>t;t++){var r=this._requiredToFailBy[t];null!=r._nextState&&r.transitionToState(r._nextState)}},i.prototype.tryToRecognize=function(t){if(i.allRecognizers.some(this.canBePreventedByRecognizer,this))return void this.transitionToState(WorldWind.FAILED);if(i.allRecognizers.some(this.isWaitingForRecognizerToFail,this))return void(this._nextState=t);for(var e=i.allRecognizers.filter(this.canPreventRecognizer,this),r=0,n=e.length;n>r;r++)e[r].transitionToState(WorldWind.FAILED);this._state=t},i.prototype.canPreventRecognizer=function(t){return this!=t&&this.target==t.target&&t.state==WorldWind.POSSIBLE&&(this.requiredToFailByRecognizer(t)||!this.canRecognizeSimultaneouslyWith(t))},i.prototype.canBePreventedByRecognizer=function(t){return this!=t&&this.target==t.target&&t.state==WorldWind.RECOGNIZED&&(this.requiresRecognizerToFail(t)||!this.canRecognizeSimultaneouslyWith(t))},i.prototype.isWaitingForRecognizerToFail=function(t){return this!=t&&this.target==t.target&&t.state==WorldWind.POSSIBLE&&this.requiresRecognizerToFail(t)},i.prototype.callGestureCallbacks=function(){for(var t=0,e=this._gestureCallbacks.length;e>t;t++)this._gestureCallbacks[t](this)},i.prototype.handleEvent=function(t){if(this.enabled&&(!t.defaultPrevented||this.state!=WorldWind.POSSIBLE)){var r,i;try{if("mousedown"==t.type)this.handleMouseDown(t);else if("mousemove"==t.type)this.handleMouseMove(t);else if("mouseup"==t.type)this.handleMouseUp(t);else if("touchstart"==t.type)for(r=0,i=t.changedTouches.length;i>r;r++)this.handleTouchStart(t.changedTouches.item(r));else if("touchmove"==t.type)for(r=0,i=t.changedTouches.length;i>r;r++)this.handleTouchMove(t.changedTouches.item(r));else if("touchcancel"==t.type)for(r=0,i=t.changedTouches.length;i>r;r++)this.handleTouchCancel(t.changedTouches.item(r));else if("touchend"==t.type)for(r=0,i=t.changedTouches.length;i>r;r++)this.handleTouchEnd(t.changedTouches.item(r));else"pointerdown"==t.type&&"mouse"==t.pointerType?this.handleMouseDown(t):"pointermove"==t.type&&"mouse"==t.pointerType?this.handleMouseMove(t):"pointercancel"==t.type&&"mouse"==t.pointerType||("pointerup"==t.type&&"mouse"==t.pointerType?this.handleMouseUp(t):"pointerdown"==t.type&&"touch"==t.pointerType?this.handleTouchStart(t):"pointermove"==t.type&&"touch"==t.pointerType?this.handleTouchMove(t):"pointercancel"==t.type&&"touch"==t.pointerType?this.handleTouchCancel(t):"pointerup"==t.type&&"touch"==t.pointerType?this.handleTouchEnd(t):e.logMessage(e.LEVEL_INFO,"GestureRecognizer","handleEvent","Unrecognized event type: "+t.type))}catch(n){e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","handleEvent","Error handling event.\n"+n.toString())}}},i.prototype.handleMouseDown=function(t){if(!("mousedown"==t.type&&this._touches.length>0)){var e=1<<t.button;e&0!=this._mouseButtonMask||(0==this._mouseButtonMask&&(this._clientX=t.clientX,this._clientY=t.clientY,this._clientStartX=t.clientX,this._clientStartY=t.clientY,this._translationX=0,this._translationY=0),this._mouseButtonMask|=e,this.mouseDown(t))}},i.prototype.handleMouseMove=function(t){if(0!=this._mouseButtonMask&&(this._clientX!=t.clientX||this._clientY!=t._clientY)){var e=t.clientX-this._clientStartX,r=t.clientY-this._clientStartY,i=this._translationWeight;this._clientX=t.clientX,this._clientY=t.clientY,this._translationX=this._translationX*(1-i)+e*i,this._translationY=this._translationY*(1-i)+r*i,this.mouseMove(t)}},i.prototype.handleMouseUp=function(t){var e=1<<t.button;e&0==this._mouseButtonMask||(this._mouseButtonMask&=~e,this.mouseUp(t),0==this._mouseButtonMask&&this.resetIfEventsEnded())},i.prototype.handleTouchStart=function(t){var e=new r(t.identifier||t.pointerId,t.clientX,t.clientY);this._touches.push(e),1==this._touches.length?(this._clientX=t.clientX,this._clientY=t.clientY,this._clientStartX=t.clientX,this._clientStartY=t.clientY,this._translationX=0,this._translationY=0,this._touchCentroidShiftX=0,this._touchCentroidShiftY=0):this.touchesAddedOrRemoved(),this.touchStart(e)},i.prototype.handleTouchMove=function(t){var e=this.indexOfTouchWithId(t.identifier||t.pointerId);if(-1!=e){var r=this._touches[e];if(r.clientX!=t.clientX||r.clientY!=t.clientY){r.clientX=t.clientX,r.clientY=t.clientY;var i=this.touchCentroid(),n=i.clientX-this._clientStartX+this._touchCentroidShiftX,o=i.clientY-this._clientStartY+this._touchCentroidShiftY,a=this._translationWeight;this._clientX=i.clientX,this._clientY=i.clientY,this._translationX=this._translationX*(1-a)+n*a,this._translationY=this._translationY*(1-a)+o*a,this.touchMove(r)}}},i.prototype.handleTouchCancel=function(t){var e=this.indexOfTouchWithId(t.identifier||t.pointerId);if(-1!=e){var r=this._touches[e];this._touches.splice(e,1),this.touchesAddedOrRemoved(),this.touchCancel(r),this.resetIfEventsEnded()}},i.prototype.handleTouchEnd=function(t){var e=this.indexOfTouchWithId(t.identifier||t.pointerId);if(-1!=e){var r=this._touches[e];this._touches.splice(e,1),this.touchesAddedOrRemoved(),this.touchEnd(r),this.resetIfEventsEnded()}},i.prototype.resetIfEventsEnded=function(){this._state!=WorldWind.POSSIBLE&&0==this._mouseButtonMask&&0==this._touches.length&&this.reset()},i.prototype.touchesAddedOrRemoved=function(){this._touchCentroidShiftX+=this._clientX,this._touchCentroidShiftY+=this._clientY;var t=this.touchCentroid();this._clientX=t.clientX,this._clientY=t.clientY,this._touchCentroidShiftX-=this._clientX,this._touchCentroidShiftY-=this._clientY},i.prototype.touchCentroid=function(){for(var t=0,e=0,r=0,i=this._touches.length;i>r;r++){var n=this._touches[r];t+=n.clientX/i,e+=n.clientY/i}return{clientX:t,clientY:e}},i.prototype.indexOfTouchWithId=function(t){for(var e=0,r=this._touches.length;r>e;e++)if(this._touches[e].identifier==t)return e;return-1},i}),i("../src/worldwind/gesture/DragRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.button=0,this.interpretDistance=5};return e.prototype=Object.create(t.prototype),e.prototype.mouseMove=function(t){this.state==WorldWind.POSSIBLE?this.shouldInterpret()&&(this.shouldRecognize()?(this.translationX=0,this.translationY=0,this.state=WorldWind.BEGAN):this.state=WorldWind.FAILED):(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CHANGED)},e.prototype.mouseUp=function(t){0==this.mouseButtonMask&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.ENDED))},e.prototype.touchStart=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.shouldInterpret=function(){var t=this.translationX,e=this.translationY,r=Math.sqrt(t*t+e*e);return r>this.interpretDistance},e.prototype.shouldRecognize=function(){var t=1<<this.button;return t==this.mouseButtonMask},e}),i("../src/worldwind/geom/Frustum",["../error/ArgumentError","../geom/Matrix","../geom/Plane","../util/Logger"],function(t,e,r,i){"use strict";var n=function(e,r,n,o,a,s){if(!(e&&r&&n&&o&&a&&s))throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","constructor","missingPlane"));this._left=e,this._right=r,this._bottom=n,this._top=o,this._near=a,this._far=s,this._planes=[this._left,this._right,this._top,this._bottom,this._near,this._far]};return Object.defineProperties(n.prototype,{left:{get:function(){return this._left}},right:{get:function(){return this._right}},bottom:{get:function(){return this._bottom}},top:{get:function(){return this._top}},near:{get:function(){return this._near}},far:{get:function(){return this._far}}}),n.prototype.transformByMatrix=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","transformByMatrix","missingMatrix"));return this._left.transformByMatrix(e),this._right.transformByMatrix(e),this._bottom.transformByMatrix(e),this._top.transformByMatrix(e),this._near.transformByMatrix(e),this._far.transformByMatrix(e),this},n.prototype.normalize=function(){return this._left.normalize(),this._right.normalize(),this._bottom.normalize(),this._top.normalize(),this._near.normalize(),this._far.normalize(),this},n.unitFrustum=function(){return new n(new r(1,0,0,1),new r(-1,0,0,1),new r(0,1,1,1),new r(0,-1,0,1),new r(0,0,-1,1),new r(0,0,1,1))},n.fromProjectionMatrix=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","fromProjectionMatrix","missingMatrix"));var o,a,s,l,u,c,h,f,d,p,m;return o=e[12]+e[0],a=e[13]+e[1],s=e[14]+e[2],l=e[15]+e[3],u=Math.sqrt(o*o+a*a+s*s),c=new r(o/u,a/u,s/u,l/u),o=e[12]-e[0],a=e[13]-e[1],s=e[14]-e[2],l=e[15]-e[3],u=Math.sqrt(o*o+a*a+s*s),h=new r(o/u,a/u,s/u,l/u),o=e[12]+e[4],a=e[13]+e[5],s=e[14]+e[6],l=e[15]+e[7],u=Math.sqrt(o*o+a*a+s*s),d=new r(o/u,a/u,s/u,l/u),o=e[12]-e[4],a=e[13]-e[5],s=e[14]-e[6],l=e[15]-e[7],u=Math.sqrt(o*o+a*a+s*s),f=new r(o/u,a/u,s/u,l/u),o=e[12]+e[8],a=e[13]+e[9],s=e[14]+e[10],l=e[15]+e[11],u=Math.sqrt(o*o+a*a+s*s),p=new r(o/u,a/u,s/u,l/u),o=e[12]-e[8],a=e[13]-e[9],s=e[14]-e[10],l=e[15]-e[11],u=Math.sqrt(o*o+a*a+s*s),m=new r(o/u,a/u,s/u,l/u),new n(c,h,d,f,p,m)},n.prototype.containsPoint=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","containsPoint","missingPoint"));return this._far.dot(e)<=0?!1:this._left.dot(e)<=0?!1:this._right.dot(e)<=0?!1:this._top.dot(e)<=0?!1:this._bottom.dot(e)<=0?!1:this._near.dot(e)<=0?!1:!0},n.prototype.intersectsSegment=function(e,r){if(!e||!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","containsPoint","missingPoint"));if(this.containsPoint(e)||this.containsPoint(r))return!0;if(e.equals(r))return!1;for(var n=0,o=this._planes.length;o>n;n++){if(this._planes[n].onSameSide(e,r)<0)return!1;if(null!=this._planes[n].clip(e,r))return!0}return!1},n.prototype.setToModelViewProjection=function(r,n,o){if(null==r||null==n)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","setToModelviewProjection","missingMatrix"));if(null==o)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","setToModelviewProjection","missingViewport"));var a=e.fromIdentity();a.setToTransposeOfMatrix(n);var s,l,u,c;return s=r[12]+r[0],l=r[13]+r[1],u=r[14]+r[2],c=r[15]+r[3],this.left.set(s,l,u,c),this.left.transformByMatrix(a),s=r[12]-r[0],l=r[13]-r[1],u=r[14]-r[2],c=r[15]-r[3],this.right.set(s,l,u,c),this.right.transformByMatrix(a),s=r[12]+r[4],l=r[13]+r[5],u=r[14]+r[6],c=r[15]+r[7],this.bottom.set(s,l,u,c),this.bottom.transformByMatrix(a),s=r[12]-r[4],l=r[13]-r[5],u=r[14]-r[6],c=r[15]-r[7],this.top.set(s,l,u,c),this.top.transformByMatrix(a),s=r[12]+r[8],l=r[13]+r[9],u=r[14]+r[10],c=r[15]+r[11],this.near.set(s,l,u,c),this.near.transformByMatrix(a),s=r[12]-r[8],l=r[13]-r[9],u=r[14]-r[10],c=r[15]-r[11],this.far.set(s,l,u,c),this.far.transformByMatrix(a),this.viewport=o,this},n}),i("../src/worldwind/navigate/LookAt",[],function(){var t=function(t,e,r,i,n,o,a,s){this._latitude=t||0,this._longitude=e||0,this._altitude=r||0,this._altitudeMode=i||WorldWind.ABSOLUTE,this._range=n||0,this._heading=o||0,this._tilt=a||0,this._roll=s||0};return Object.defineProperties(t.prototype,{latitude:{get:function(){return this._latitude},set:function(t){this._latitude=t}},longitude:{get:function(){return this._longitude},set:function(t){this._longitude=t}},altitude:{get:function(){return this._altitude},set:function(t){this._altitude=t}},altitudeMode:{get:function(){return this._altitudeMode},set:function(t){this._altitudeMode=t}},range:{get:function(){return this._range},set:function(t){this._range=t}},heading:{get:function(){return this._heading},set:function(t){this._heading=t}},tilt:{get:function(){return this._tilt},set:function(t){this._tilt=t}},roll:{get:function(){return this._roll},set:function(t){this._roll=t}}}),t.prototype.set=function(t){return this.latitude=t.latitude,this.longitude=t.longitude,this.altitude=t.altitude,this.altitudeMode=t.altitudeMode,this.range=t.range,this.heading=t.heading,this.tilt=t.tilt,this.roll=t.roll,this},t.prototype.equals=function(t){return t&&this.latitude==t.latitude&&this.longitude==t.longitude&&this.altitude==t.altitude&&this.altitudeMode==t.altitudeMode&&this.range==t.range&&this.heading==t.heading&&this.tilt==t.tilt&&this.roll==t.roll},t.prototype.toString=function(){return"LookAt{latitude="+this.latitude+", longitude="+this.longitude+", altitude="+this.altitude+", altitudeMode="+this.altitudeMode+", range="+this.range+", heading="+this.heading+", tilt="+this.tilt+", roll="+this.roll+"}"},t}),i("../src/worldwind/navigate/Camera",[],function(){var t=function(t,e,r,i,n,o,a){this._latitude=t||0,this._longitude=e||0,this._altitude=r||0,this._altitudeMode=i||WorldWind.ABSOLUTE,this._heading=n||0,this._tilt=o||0,this._roll=a||0};return Object.defineProperties(t.prototype,{latitude:{get:function(){return this._latitude},set:function(t){this._latitude=t}},longitude:{get:function(){return this._longitude},set:function(t){this._longitude=t}},altitude:{get:function(){return this._altitude},set:function(t){this._altitude=t}},altitudeMode:{get:function(){return this._altitudeMode},set:function(t){this._altitudeMode=t}},heading:{get:function(){return this._heading},set:function(t){this._heading=t}},tilt:{get:function(){return this._tilt},set:function(t){this._tilt=t}},roll:{get:function(){return this._roll},set:function(t){this._roll=t}}}),t.prototype.set=function(t){return this.latitude=t.latitude,this.longitude=t.longitude,this.altitude=t.altitude,this.altitudeMode=t.altitudeMode,this.heading=t.heading,this.tilt=t.tilt,this.roll=t.roll,this},t.prototype.equals=function(t){return t&&this.latitude==t.latitude&&this.longitude==t.longitude&&this.altitude==t.altitude&&this.altitudeMode==t.altitudeMode&&this.heading==t.heading&&this.tilt==t.tilt&&this.roll==t.roll},t.prototype.toString=function(){return"Camera{latitude="+this.latitude+", longitude="+this.longitude+", altitude="+this.altitude+", altitudeMode="+this.altitudeMode+", heading="+this.heading+", tilt="+this.tilt+", roll="+this.roll+"}"},t}),i("../src/worldwind/navigate/NavigatorState",["../error/ArgumentError","../geom/Frustum","../geom/Line","../util/Logger","../geom/Matrix","../geom/Rectangle","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(t,r,i,o,a,u){this.modelview=t,this.projection=r,this.modelviewProjection=n.fromIdentity(),this.modelviewProjection.setToMultiply(r,t),this.viewport=o,this.infiniteProjection=i,this.heading=a,this.tilt=u,this.eyePoint=this.modelview.extractEyePoint(new s(0,0,0)),this.frustumInModelCoordinates=null;var c=n.fromIdentity();c.setToTransposeOfMatrix(this.modelview),this.frustumInModelCoordinates=e.fromProjectionMatrix(this.projection),this.frustumInModelCoordinates.setToModelViewProjection(r,t,o),this.modelviewInv=n.fromIdentity(),this.modelviewInv.invertOrthonormalMatrix(this.modelview),this.projectionInv=n.fromIdentity(),this.projectionInv.invertMatrix(this.projection),this.modelviewProjectionInv=n.fromIdentity(),this.modelviewProjectionInv.invertMatrix(this.modelviewProjection),this.modelviewNormalTransform=n.fromIdentity().setToTransposeOfMatrix(this.modelviewInv.upper3By3());var h=new s(-1,-1,-1),f=new s(1,1,-1),d=new s(-1,-1,1),p=new s(1,1,1);h.multiplyByMatrix(this.projectionInv),f.multiplyByMatrix(this.projectionInv),d.multiplyByMatrix(this.projectionInv),p.multiplyByMatrix(this.projectionInv);var m=l.fabs(f[0]-h[0]),g=l.fabs(p[0]-d[0]),y=-h[2],v=-d[2],E=(g-m)/(v-y),w=m-E*y;this.pixelSizeScale=E/o.width,this.pixelSizeOffset=w/o.height};return u.prototype.project=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","project","missingPoint"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","project","missingResult"));var n=e[0],o=e[1],a=e[2],s=this.modelviewProjection,l=s[0]*n+s[1]*o+s[2]*a+s[3],u=s[4]*n+s[5]*o+s[6]*a+s[7],c=s[8]*n+s[9]*o+s[10]*a+s[11],h=s[12]*n+s[13]*o+s[14]*a+s[15],f=this.viewport;return 0==h?!1:(l/=h,u/=h,c/=h,-1>c||c>1?!1:(l=.5*l+.5,u=.5*u+.5,c=.5*c+.5,l=l*f.width+f.x,u=u*f.height+f.y,r[0]=l,r[1]=u,r[2]=c,!0))},u.prototype.projectWithDepth=function(e,r,n){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","projectWithDepth","missingPoint"));if(!n)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","projectWithDepth","missingResult"));var o=e[0],a=e[1],s=e[2],u=this.modelview,c=u[0]*o+u[1]*a+u[2]*s+u[3],h=u[4]*o+u[5]*a+u[6]*s+u[7],f=u[8]*o+u[9]*a+u[10]*s+u[11],d=u[12]*o+u[13]*a+u[14]*s+u[15],p=this.projection,m=p[0]*c+p[1]*h+p[2]*f+p[3]*d,g=p[4]*c+p[5]*h+p[6]*f+p[7]*d,y=p[8]*c+p[9]*h+p[10]*f+p[11]*d,v=p[12]*c+p[13]*h+p[14]*f+p[15]*d,E=this.viewport;return 0===v?!1:(m/=v,g/=v,y/=v,-1>y||y>1?!1:(y=p[8]*c+p[9]*h+p[10]*f*(1+r)+p[11]*d,y/=v,y=l.clamp(y,-1,1),m=.5*m+.5,g=.5*g+.5,y=.5*y+.5,m=m*E.width+E.x,g=g*E.height+E.y,n[0]=m,n[1]=g,n[2]=y,!0))},u.prototype.unProject=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","unProject","missingPoint"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","unProject","missingResult"));var n=e[0],o=e[1],a=e[2],s=this.viewport;if(n=(n-s.x)/s.width,o=(o-s.y)/s.height,n=2*n-1,o=2*o-1,a=2*a-1,-1>a||a>1)return!1;var l=this.modelviewProjectionInv,u=l[0]*n+l[1]*o+l[2]*a+l[3],c=l[4]*n+l[5]*o+l[6]*a+l[7],h=l[8]*n+l[9]*o+l[10]*a+l[11],f=l[12]*n+l[13]*o+l[14]*a+l[15];return 0===f?!1:(r[0]=u/f,r[1]=c/f,r[2]=h/f,!0)},u.prototype.convertPointToWindow=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","convertPointToWindow","missingPoint"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","convertPointToWindow","missingResult"));return r[0]=e[0],r[1]=this.viewport.height-e[1],r},u.prototype.convertPointToViewport=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","convertPointToViewport","missingPoint"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","convertPointToViewport","missingResult"));return r[0]=e[0],r[1]=this.viewport.height-e[1],r},u.prototype.rayFromScreenPoint=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","rayFromScreenPoint","missingPoint"));var n=this.convertPointToViewport(e,new s(0,0,0)),o=new s(0,0,0),a=new s(0,0,0);if(!this.unProject(n,o))return null;if(n[2]=1,!this.unProject(n,a))return null;var l=new s(this.eyePoint[0],this.eyePoint[1],this.eyePoint[2]),u=new s(a[0],a[1],a[2]);return u.subtract(o),u.normalize(),new r(l,u)},u.prototype.pixelSizeAtDistance=function(t){return this.pixelSizeScale*t+this.pixelSizeOffset},u}),i("../src/worldwind/navigate/Navigator",["../error/ArgumentError","./Camera","../util/Logger","../geom/Matrix","./NavigatorState"],function(t,e,r,i,n){var o=function(t){this.scratchCamera=new e,this.worldWindow=t,this.fieldOfView=45,this.heading=0,this.tilt=0,this.latitude=30,this.longitude=-110,this.altitude=1e7,this.roll=0};return Object.defineProperties(o.prototype,{latitude:{get:function(){return this._latitude},set:function(t){this._latitude=t}},longitude:{get:function(){return this._longitude},set:function(t){this._longitude=t}},altitude:{get:function(){return this._altitude},set:function(t){this._altitude=t}},heading:{get:function(){return this._heading},set:function(t){this._heading=t}},tilt:{get:function(){return this._tilt},set:function(t){this._tilt=t}},roll:{get:function(){return this._roll},set:function(t){this._roll=t}}}),o.prototype.getAsCamera=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","getAsCamera","missing result"));return i.latitude=this.latitude,i.longitude=this.longitude,i.altitude=this.altitude,i.altitudeMode=WorldWind.ABSOLUTE,i.heading=this.heading,i.tilt=this.tilt,i.roll=this.roll,i},o.prototype.setAsCamera=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","setAsCamera","missing camera"));return this.latitude=i.latitude,this.longitude=i.longitude,this.altitude=i.altitude,this.heading=i.heading,this.tilt=i.tilt,this.roll=i.roll,this},o.prototype.getAsLookAt=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","getAsLookAt","missing globe"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","getAsLookAt","missing result"));return this.getAsCamera(e,this.scratchCamera),e.cameraToLookAt(this.scratchCamera,i),i},o.prototype.setAsLookAt=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","setAsLookAt","missing globe"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","setAsLookAt","missing lookAt"));return e.lookAtToCamera(i,this.scratchCamera),this.setAsCamera(e,this.scratchCamera),this},o.prototype.currentState=function(t){var e=this.getAsCamera(t,this.scratchCamera),r=i.fromIdentity(),o=i.fromIdentity(),a=i.fromIdentity(),s=this.worldWindow.viewport;return this.worldWindow.computeViewingTransform(o,r),a.setToInfiniteProjection(s.width,s.height,this.fieldOfView,1),a.multiplyMatrix(r),new n(r,o,a,s,e.heading,e.tilt)},o}),i("../src/worldwind/gesture/PanRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.minNumberOfTouches=1,this.maxNumberOfTouches=Number.MAX_VALUE,this.interpretDistance=20};return e.prototype=Object.create(t.prototype),e.prototype.mouseDown=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.touchMove=function(t){this.state==WorldWind.POSSIBLE?this.shouldInterpret()&&(this.shouldRecognize()?this.state=WorldWind.BEGAN:this.state=WorldWind.FAILED):(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CHANGED)},e.prototype.touchEnd=function(t){0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.ENDED))},e.prototype.touchCancel=function(t){0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CANCELLED))},e.prototype.prepareToRecognize=function(){this.translationX=0,this.translationY=0},e.prototype.shouldInterpret=function(){var t=this.translationX,e=this.translationY,r=Math.sqrt(t*t+e*e);return r>this.interpretDistance},e.prototype.shouldRecognize=function(){var t=this.touchCount;return 0!=t&&t>=this.minNumberOfTouches&&t<=this.maxNumberOfTouches},e}),i("../src/worldwind/gesture/PinchRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this._scale=1,this._offsetScale=1,this.referenceDistance=0,this.interpretThreshold=20,this.weight=.4,this.pinchTouches=[]};return e.prototype=Object.create(t.prototype),Object.defineProperties(e.prototype,{scale:{get:function(){return this._scale*this._offsetScale}}}),e.prototype.reset=function(){t.prototype.reset.call(this),this._scale=1,this._offsetScale=1,this.referenceDistance=0,this.pinchTouches=[]},e.prototype.mouseDown=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.touchStart=function(t){this.pinchTouches.length<2&&2==this.pinchTouches.push(t)&&(this.referenceDistance=this.currentPinchDistance(),this._offsetScale*=this._scale,this._scale=1)},e.prototype.touchMove=function(t){if(2==this.pinchTouches.length)if(this.state==WorldWind.POSSIBLE)this.shouldRecognize()&&(this.state=WorldWind.BEGAN);else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED){var e=this.currentPinchDistance(),r=Math.abs(e/this.referenceDistance),i=this.weight;this._scale=this._scale*(1-i)+r*i,this.state=WorldWind.CHANGED}},e.prototype.touchEnd=function(t){var e=this.pinchTouches.indexOf(t);-1!=e&&this.pinchTouches.splice(e,1),0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.ENDED))},e.prototype.touchCancel=function(t){var e=this.pinchTouches.indexOf(t);-1!=e&&this.pinchTouches.splice(e,1),0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CANCELLED))},e.prototype.prepareToRecognize=function(){this.referenceDistance=this.currentPinchDistance(),this._scale=1},e.prototype.shouldRecognize=function(){var t=this.currentPinchDistance();return Math.abs(t-this.referenceDistance)>this.interpretThreshold},e.prototype.currentPinchDistance=function(){var t=this.pinchTouches[0],e=this.pinchTouches[1],r=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(r*r+i*i)},e}),i("../src/worldwind/gesture/RotationRecognizer",["../geom/Angle","../gesture/GestureRecognizer"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r),this._rotation=0,this._offsetRotation=0,this.referenceAngle=0,this.interpretThreshold=20,this.weight=.4,this.rotationTouches=[]};return r.prototype=Object.create(e.prototype),Object.defineProperties(r.prototype,{rotation:{get:function(){return this._rotation+this._offsetRotation}}}),r.prototype.reset=function(){e.prototype.reset.call(this),this._rotation=0,this._offsetRotation=0,this.referenceAngle=0,this.rotationTouches=[]},r.prototype.mouseDown=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},r.prototype.touchStart=function(t){this.rotationTouches.length<2&&2==this.rotationTouches.push(t)&&(this.referenceAngle=this.currentTouchAngle(),this._offsetRotation+=this._rotation,this._rotation=0)},r.prototype.touchMove=function(e){if(2==this.rotationTouches.length)if(this.state==WorldWind.POSSIBLE)this.shouldRecognize()&&(this.state=WorldWind.BEGAN);else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED){var r=this.currentTouchAngle(),i=t.normalizedDegrees(r-this.referenceAngle),n=this.weight;this._rotation=this._rotation*(1-n)+i*n,this.state=WorldWind.CHANGED}},r.prototype.touchEnd=function(t){var e=this.rotationTouches.indexOf(t);-1!=e&&this.rotationTouches.splice(e,1),0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.ENDED))},r.prototype.touchCancel=function(t){var e=this.rotationTouches.indexOf(t);-1!=e&&(this.rotationTouches.splice(e,1),0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CANCELLED)))},r.prototype.prepareToRecognize=function(){this.referenceAngle=this.currentTouchAngle(),this._rotation=0},r.prototype.shouldRecognize=function(){var e=this.currentTouchAngle(),r=t.normalizedDegrees(e-this.referenceAngle);return Math.abs(r)>this.interpretThreshold},r.prototype.currentTouchAngle=function(){var e=this.rotationTouches[0],r=this.rotationTouches[1],i=e.clientX-r.clientX,n=e.clientY-r.clientY;return Math.atan2(n,i)*t.RADIANS_TO_DEGREES},r}),i("../src/worldwind/gesture/TiltRecognizer",["../gesture/PanRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.maxTouchDistance=250,this.maxTouchDivergence=50};return e.LEFT=1,e.RIGHT=2,e.UP=4,e.DOWN=8,e.prototype=Object.create(t.prototype),e.prototype.shouldInterpret=function(){for(var t=0,e=this.touchCount;e>t;t++){var r=this.touch(t),i=r.translationX,n=r.translationY,o=Math.sqrt(i*i+n*n);if(o>this.interpretDistance)return!0}return!1},e.prototype.shouldRecognize=function(){var t=this.touchCount;if(2>t)return!1;var r=this.touch(0),i=this.touch(1),n=r.clientX-i.clientX,o=r.clientY-i.clientY,a=Math.sqrt(n*n+o*o);if(a>this.maxTouchDistance)return!1;var s=r.translationX-i.translationX,l=r.translationY-i.translationY,u=Math.sqrt(s*s+l*l);if(u>this.maxTouchDivergence)return!1;var c=e.UP|e.DOWN,h=this.touchDirection(r)&c,f=this.touchDirection(i)&c;return 0!=(h&f)},e.prototype.touchDirection=function(t){var r=t.translationX,i=t.translationY,n=0;return Math.abs(r)>Math.abs(i)?(n|=0>r?e.LEFT:0,n|=r>0?e.RIGHT:0):(n|=0>i?e.UP:0,n|=i>0?e.DOWN:0),n},e}),i("../src/worldwind/navigate/WorldWindowController",["../geom/Angle","../gesture/DragRecognizer","../geom/Frustum","../gesture/GestureRecognizer","../geom/Line","../geom/Location","../navigate/LookAt","../util/Logger","../geom/Matrix","../navigate/Navigator","../gesture/PanRecognizer","../gesture/PinchRecognizer","../geom/Position","../gesture/RotationRecognizer","../gesture/TiltRecognizer","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m,g,y){"use strict";var v=function(t){function r(t){t.preventDefault()}var i=this;t.addEventListener("mousedown",r),t.addEventListener("touchstart",r),t.addEventListener("contextmenu",r),t.addEventListener("wheel",r),window.PointerEvent&&t.canvas.style.setProperty("touch-action","none"),this.worldWindow=t,this.lookAt=t.navigator.getAsLookAt(this.worldWindow.globe,new a),this.modelview=l.fromIdentity(),this.range=1e7,this.enable2DLimits=!0,this.primaryDragRecognizer=new e(t,function(t){i.handlePanOrDrag(t)}),this.secondaryDragRecognizer=new e(t,function(t){i.handleSecondaryDrag(t)}),this.secondaryDragRecognizer.button=2,this.panRecognizer=new c(t,function(t){i.handlePanOrDrag(t)}),this.pinchRecognizer=new h(t,function(t){i.handlePinch(t)}),this.rotationRecognizer=new d(t,function(t){i.handleRotation(t)}),this.tiltRecognizer=new p(t,function(t){i.handleTilt(t)}),t.addEventListener("wheel",function(t){i.handleWheelEvent(t)}),this.panRecognizer.recognizeSimultaneouslyWith(this.pinchRecognizer),this.panRecognizer.recognizeSimultaneouslyWith(this.rotationRecognizer),this.pinchRecognizer.recognizeSimultaneouslyWith(this.rotationRecognizer),this.panRecognizer.requireRecognizerToFail(this.tiltRecognizer),this.pinchRecognizer.requireRecognizerToFail(this.tiltRecognizer),this.rotationRecognizer.requireRecognizerToFail(this.tiltRecognizer),this.beginPoint=new m(0,0),this.lastPoint=new m(0,0),this.beginHeading=0,this.beginTilt=0,this.beginRange=0,this.lastRotation=0};return v.prototype.handlePanOrDrag=function(t){this.worldWindow.globe.is2D()?this.handlePanOrDrag2D(t):this.handlePanOrDrag3D(t)},v.prototype.handlePanOrDrag3D=function(e){var r=e.state,i=e.translationX,n=e.translationY;if(r==WorldWind.BEGAN)this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.lastPoint.set(0,0);else if(r==WorldWind.CHANGED){var o=this.worldWindow.canvas,a=this.worldWindow.globe,s=y.max(a.equatorialRadius,a.polarRadius),l=y.max(1,this.lookAt.range),u=y.perspectivePixelSize(o.clientWidth,o.clientHeight,l),c=(n-this.lastPoint[1])*u,h=-(i-this.lastPoint[0])*u,f=c/s*t.RADIANS_TO_DEGREES,d=h/s*t.RADIANS_TO_DEGREES,p=Math.sin(this.lookAt.heading*t.DEGREES_TO_RADIANS),m=Math.cos(this.lookAt.heading*t.DEGREES_TO_RADIANS);
this.lookAt.latitude+=f*m-d*p,this.lookAt.longitude+=f*p+d*m,this.lastPoint.set(i,n),this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()}},v.prototype.handlePanOrDrag2D=function(t){var e=t.state,r=t.clientX,i=t.clientY,n=t.translationX,o=t.translationY;if(e==WorldWind.BEGAN)this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.beginPoint.set(r,i),this.lastPoint.set(r,i);else if(e==WorldWind.CHANGED){var a=this.lastPoint[0],s=this.lastPoint[1],u=this.beginPoint[0]+n,c=this.beginPoint[1]+o;this.lastPoint.set(u,c);var h=this.currentState(),f=this.worldWindow.globe,d=h.rayFromScreenPoint(this.worldWindow.canvasCoordinates(a,s)),p=new g(0,0,0),m=new g(0,0,0),y=new g(0,0,0);if(!f.intersectsLine(d,p))return;if(d=h.rayFromScreenPoint(this.worldWindow.canvasCoordinates(u,c)),!f.intersectsLine(d,m))return;var v=l.fromIdentity();if(v.copy(h.modelview),v.multiplyByTranslation(m[0]-p[0],m[1]-p[1],m[2]-p[2]),v.extractEyePoint(d.origin),v.extractForwardVector(d.direction),!f.intersectsLine(d,y))return;var E=v.extractViewingParameters(y,this.roll,f,{});this.lookAt.set(E.origin),this.lookAt.range=E.range,this.lookAt.heading=E.heading,this.lookAt.tilt=E.tilt,this.lookAt.roll=E.roll,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()}},v.prototype.handleSecondaryDrag=function(t){var e=t.state,r=t.translationX,i=t.translationY;if(this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),e==WorldWind.BEGAN)this.beginHeading=this.lookAt.heading,this.beginTilt=this.lookAt.tilt;else if(e==WorldWind.CHANGED){var n=180*r/this.worldWindow.canvas.clientWidth,o=90*i/this.worldWindow.canvas.clientHeight;this.lookAt.heading=this.beginHeading+n,this.lookAt.tilt=this.beginTilt+o,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()}},v.prototype.handlePinch=function(t){var e=t.state,r=t.scale;e==WorldWind.BEGAN?(this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.beginRange=this.lookAt.range):e==WorldWind.CHANGED&&0!=r&&(this.lookAt.range=this.beginRange/r,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw())},v.prototype.handleRotation=function(t){var e=t.state,r=t.rotation;e==WorldWind.BEGAN?(this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.lastRotation=0):e==WorldWind.CHANGED&&(this.lookAt.heading-=r-this.lastRotation,this.lookAt.lastRotation=r,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw())},v.prototype.handleTilt=function(t){var e=t.state,r=t.translationY;if(e==WorldWind.BEGAN)this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.beginTilt=this.lookAt.tilt;else if(e==WorldWind.CHANGED){var i=-90*r/this.worldWindow.canvas.clientHeight;this.lookAt.tilt=this.beginTilt+i,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()}},v.prototype.handleWheelEvent=function(t){this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt);var e;t.deltaMode==WheelEvent.DOM_DELTA_PIXEL?e=t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_LINE?e=40*t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_PAGE&&(e=400*t.deltaY);var r=1+e/1e3;this.lookAt.range*=r,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()},v.prototype.applyLimits=function(){if(this.lookAt.latitude=y.clamp(this.lookAt.latitude,-90,90),this.lookAt.longitude=t.normalizedDegreesLongitude(this.lookAt.longitude),this.lookAt.range=y.clamp(this.lookAt.range,1,Number.MAX_VALUE),this.lookAt.heading=t.normalizedDegrees(this.lookAt.heading),this.lookAt.tilt=y.clamp(this.lookAt.tilt,0,90),this.lookAt.roll=t.normalizedDegrees(this.lookAt.roll),this.worldWindow.globe.is2D()&&this.enable2DLimits){var e=2*Math.PI*this.worldWindow.globe.equatorialRadius;this.lookAt.range=y.clamp(this.lookAt.range,1,e),this.lookAt.tilt=0}},v}),i("../src/worldwind/util/AbsentResourceList",[],function(){"use strict";var t=function(t,e){this.maxTrys=t,this.minCheckInterval=e,this.tryAgainInterval=6e4,this.possiblyAbsent={}};return t.prototype.isResourceAbsent=function(t){var e=this.possiblyAbsent[t];if(!e)return!1;if(e.permanent)return!0;var r=Date.now()-e.timeOfLastMark;return r>this.tryAgainInterval?(delete this.possiblyAbsent[t],!1):r<this.minCheckInterval||e.numTrys>this.maxTrys},t.prototype.markResourceAbsent=function(t){var e=this.possiblyAbsent[t];e||(e={timeOfLastMark:Date.now(),numTrys:0},this.possiblyAbsent[t]=e),e.numTrys=e.numTrys+1,e.timeOfLastMark=Date.now()},t.prototype.markResourceAbsentPermanently=function(t){var e=this.possiblyAbsent[t];e||(e={timeOfLastMark:Date.now(),numTrys:0},this.possiblyAbsent[t]=e),e.numTrys=e.numTrys+1,e.timeOfLastMark=Date.now(),e.permanent=!0},t.prototype.unmarkResourceAbsent=function(t){var e=this.possiblyAbsent[t];e&&delete this.possiblyAbsent[t]},t}),i("../src/worldwind/error/NotYetImplementedError",["../error/AbstractError"],function(t){"use strict";var e=function(e){t.call(this,"NotYetImplementedError",e);var r;try{throw new Error}catch(i){r=i.stack}this.stack=r};return e.prototype=Object.create(t.prototype),e}),i("../src/worldwind/geom/BoundingBox",["../error/ArgumentError","../shaders/BasicProgram","../geom/Frustum","../util/Logger","../geom/Matrix","../error/NotYetImplementedError","../geom/Plane","../geom/Sector","../geom/Vec3","../util/WWMath","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(){this.center=new l(0,0,0),this.bottomCenter=new l(-.5,0,0),this.topCenter=new l(.5,0,0),this.r=new l(1,0,0),this.s=new l(0,1,0),this.t=new l(0,0,1),this.radius=Math.sqrt(3),this.tmp1=new l(0,0,0),this.tmp2=new l(0,0,0),this.tmp3=new l(0,0,0),this.scratchElevations=new Float64Array(9),this.scratchPoints=new Float64Array(3*this.scratchElevations.length)};return h.scratchMatrix=n.fromIdentity(),h.prototype.setToPoints=function(e){if(!e||e.length<3)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","setToPoints","missingArray"));var r,o,a,s,u,c,h,f,d,p,m,g,y,v,E,w=+Number.MAX_VALUE,b=-Number.MAX_VALUE,x=+Number.MAX_VALUE,_=-Number.MAX_VALUE,S=+Number.MAX_VALUE,T=-Number.MAX_VALUE,L=this.r,M=this.s,A=this.t,N=new l(0,0,0);n.principalAxesFromPoints(e,L,M,A);for(var R=0,C=e.length/3;C>R;R++)N[0]=e[3*R],N[1]=e[3*R+1],N[2]=e[3*R+2],r=N.dot(L),w>r&&(w=r),r>b&&(b=r),o=N.dot(M),x>o&&(x=o),o>_&&(_=o),a=N.dot(A),S>a&&(S=a),a>T&&(T=a);return b===w&&(b=w+1),_===x&&(_=x+1),T===S&&(T=S+1),s=b-w,u=_-x,c=T-S,h=b+w,f=_+x,d=T+S,p=.5*L[0]*s,m=.5*L[1]*s,g=.5*L[2]*s,y=.5*(L[0]*h+M[0]*f+A[0]*d),v=.5*(L[1]*h+M[1]*f+A[1]*d),E=.5*(L[2]*h+M[2]*f+A[2]*d),this.center[0]=y,this.center[1]=v,this.center[2]=E,this.topCenter[0]=y+p,this.topCenter[1]=v+m,this.topCenter[2]=E+g,this.bottomCenter[0]=y-p,this.bottomCenter[1]=v-m,this.bottomCenter[2]=E-g,L.multiply(s),M.multiply(u),A.multiply(c),this.radius=.5*Math.sqrt(s*s+u*u+c*c),this},h.prototype.setToSector=function(e,r,n,o){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","setToSector","missingSector"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","setToSector","missingGlobe"));var a=this.scratchElevations,s=this.scratchPoints;c.fillArray(a,o),a[0]=a[2]=a[6]=a[8]=n,r.computePointsForGrid(e,3,3,a,l.ZERO,s);var h=12;this.tmp1.set(s[h],s[h+1],s[h+2]),u.localCoordinateAxesAtPoint(this.tmp1,r,this.r,this.s,this.t);for(var f=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],d=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],p=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],m=0,g=s.length;g>m;m+=3)this.tmp1.set(s[m],s[m+1],s[m+2]),this.adjustExtremes(this.r,f,this.s,d,this.t,p,this.tmp1);f[1]-f[0]<d[1]-d[0]&&this.swapAxes(this.r,f,this.s,d),d[1]-d[0]<p[1]-p[0]&&this.swapAxes(this.s,d,this.t,p),f[1]-f[0]<d[1]-d[0]&&this.swapAxes(this.r,f,this.s,d);var y=f[1]-f[0],v=d[1]-d[0],E=p[1]-p[0],w=f[1]+f[0],b=d[1]+d[0],x=p[1]+p[0],_=.5*(this.r[0]*w+this.s[0]*b+this.t[0]*x),S=.5*(this.r[1]*w+this.s[1]*b+this.t[1]*x),T=.5*(this.r[2]*w+this.s[2]*b+this.t[2]*x),L=.5*this.r[0]*y,M=.5*this.r[1]*y,A=.5*this.r[2]*y;return this.center.set(_,S,T),this.topCenter.set(_+L,S+M,T+A),this.bottomCenter.set(_-L,S-M,T-A),this.r.multiply(y),this.s.multiply(v),this.t.multiply(E),this.radius=.5*Math.sqrt(y*y+v*v+E*E),this},h.prototype.translate=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","translate","missingVector"));return this.bottomCenter.add(e),this.topCenter.add(e),this.center.add(e),this},h.prototype.distanceTo=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","distanceTo","missingPoint"));var r=this.center.distanceTo(e)-this.radius;return r>=0?r:-r},h.prototype.effectiveRadius=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","effectiveRadius","missingPlane"));var r=e.normal;return.5*(u.fabs(this.r.dot(r))+u.fabs(this.s.dot(r))+u.fabs(this.t.dot(r)))},h.prototype.intersectsFrustum=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","intersectsFrustum","missingFrustum"));return this.tmp1.copy(this.bottomCenter),this.tmp2.copy(this.topCenter),this.intersectionPoint(e.near)<0?!1:this.intersectionPoint(e.far)<0?!1:this.intersectionPoint(e.left)<0?!1:this.intersectionPoint(e.right)<0?!1:this.intersectionPoint(e.top)<0?!1:this.intersectionPoint(e.bottom)<0?!1:!0},h.prototype.intersectionPoint=function(t){var e=t.normal,r=.5*(Math.abs(this.s.dot(e))+Math.abs(this.t.dot(e)));return this.intersectsAt(t,r,this.tmp1,this.tmp2)},h.prototype.intersectsAt=function(t,e,r,i){var n=t.dot(r),o=-e>=n,a=t.dot(i),s=-e>=a;if(o&&s)return-1;if(o==s)return 0;this.tmp3.copy(r),this.tmp3.subtract(i);var l=(e+n)/t.normal.dot(this.tmp3);return this.tmp3.copy(i),this.tmp3.subtract(r),this.tmp3.multiply(l),this.tmp3.add(r),o?r.copy(this.tmp3):i.copy(this.tmp3),l},h.prototype.adjustExtremes=function(t,e,r,i,n,o,a){var s=a.dot(t);e[0]>s&&(e[0]=s),e[1]<s&&(e[1]=s);var l=a.dot(r);i[0]>l&&(i[0]=l),i[1]<l&&(i[1]=l);var u=a.dot(n);o[0]>u&&(o[0]=u),o[1]<u&&(o[1]=u)},h.prototype.swapAxes=function(t,e,r,i){t.swap(r);var n=e[0];e[0]=i[0],i[0]=n,n=e[1],e[1]=i[1],i[1]=n},h.prototype.render=function(t){var r=t.currentGlContext,i=h.scratchMatrix,n=t.findAndBindProgram(e);try{i.copy(t.navigatorState.modelviewProjection),i.multiply(this.r[0],this.s[0],this.t[0],this.center[0],this.r[1],this.s[1],this.t[1],this.center[1],this.r[2],this.s[2],this.t[2],this.center[2],0,0,0,1),i.multiplyByTranslation(-.5,-.5,-.5),n.loadModelviewProjection(r,i),r.disable(r.CULL_FACE),r.bindBuffer(r.ARRAY_BUFFER,t.unitCubeBuffer()),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.unitCubeElements()),r.enableVertexAttribArray(n.vertexPointLocation),r.vertexAttribPointer(n.vertexPointLocation,3,r.FLOAT,!1,0,0),n.loadColorComponents(r,0,1,0,.6),r.drawElements(r.LINES,24,r.UNSIGNED_SHORT,72),n.loadColorComponents(r,1,1,1,.3),r.drawElements(r.TRIANGLES,36,r.UNSIGNED_SHORT,0)}finally{r.enable(r.CULL_FACE),r.bindBuffer(r.ARRAY_BUFFER,null),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null)}},h}),i("../src/worldwind/util/Tile",["../error/ArgumentError","../geom/BoundingBox","../util/Logger","../geom/Sector","../geom/Vec3","../util/WWUtil"],function(t,e,r,i,n,o){"use strict";var a=function(e,i,n,o){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","constructor","missingSector"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","constructor","The specified level is null or undefined."));if(0>n||0>o)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","constructor","The specified row or column is less than zero."));this.sector=e,this.level=i,this.row=n,this.column=o,this.tileWidth=i.tileWidth,this.tileHeight=i.tileHeight,this.texelSize=i.texelSize,this.tileKey=i.levelNumber.toString()+"."+n.toString()+"."+o.toString(),this.extent=null,this.referencePoint=null,this.opacity=1,this.samplePoints=null,this.sampleElevations=null,this.updateTimestamp=null,this.updateVerticalExaggeration=null,this.updateGlobeStateKey=null};return a.prototype.isEqual=function(t){return t&&t.tileKey?this.tileKey==t.tileKey:!1},a.prototype.size=function(){return 828},a.prototype.distanceTo=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","distanceTo","missingVector"));for(var i,n,o,a=e[0],s=e[1],l=e[2],u=this.samplePoints,c=Number.POSITIVE_INFINITY,h=0,f=u.length;f>h;h+=3)i=a-u[h],n=s-u[h+1],o=l-u[h+2],c=Math.min(c,i*i+n*n+o*o);return Math.sqrt(c)},a.prototype.subdivide=function(e,n){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","subdivide","The specified level is null or undefined."));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","subdivide","The specified tile factory is null or undefined."));var o,a,s,l=this.sector.minLatitude,u=this.sector.maxLatitude,c=this.sector.centroidLatitude(),h=this.sector.minLongitude,f=this.sector.maxLongitude,d=this.sector.centroidLongitude(),p=[];return o=2*this.row,a=2*this.column,s=new i(l,c,h,d),p.push(n.createTile(s,e,o,a)),o=2*this.row,a=2*this.column+1,s=new i(l,c,d,f),p.push(n.createTile(s,e,o,a)),o=2*this.row+1,a=2*this.column,s=new i(c,u,h,d),p.push(n.createTile(s,e,o,a)),o=2*this.row+1,a=2*this.column+1,s=new i(c,u,d,f),p.push(n.createTile(s,e,o,a)),p},a.prototype.subdivideToCache=function(e,i,n){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","subdivideToCache","The specified level is null or undefined."));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile factory is null or undefined."));var o=n?n.entryForKey(this.tileKey):null;return o||(o=this.subdivide(e,i),o&&n&&n.putEntry(this.tileKey,o,4*o[0].size())),o},a.prototype.mustSubdivide=function(t,e){var r=t.globe.equatorialRadius*this.texelSize,i=this.distanceTo(t.navigatorState.eyePoint),n=t.navigatorState.pixelSizeAtDistance(i);return r>Math.max(e*n,.5)},a.prototype.update=function(t){var e=t.globe.elevationTimestamp(),r=t.verticalExaggeration,i=t.globeStateKey;(this.updateTimestamp!=e||this.updateVerticalExaggeration!=r||this.updateGlobeStateKey!=i)&&(this.doUpdate(t),t.frameStatistics.incrementTileUpdateCount(1),this.updateTimestamp=e,this.updateVerticalExaggeration=r,this.updateGlobeStateKey=i)},a.prototype.doUpdate=function(t){var r=t.globe,i=t.verticalExaggeration,a=r.minAndMaxElevationsForSector(this.sector),s=a?a[0]*i:0,l=a?a[1]*i:0;s==l&&(s=l+10),this.extent||(this.extent=new e),this.extent.setToSector(this.sector,r,s,l),this.samplePoints||(this.sampleElevations=new Float64Array(9),this.samplePoints=new Float64Array(3*this.sampleElevations.length)),o.fillArray(this.sampleElevations,.5*(s+l)),r.computePointsForGrid(this.sector,3,3,this.sampleElevations,n.ZERO,this.samplePoints),this.referencePoint||(this.referencePoint=new n(0,0,0)),r.computePointFromPosition(this.sector.centroidLatitude(),this.sector.centroidLongitude(),0,this.referencePoint)},a.computeRow=function(t,e){var r=Math.floor((e+90)/t);return 90==e&&(r-=1),r},a.computeColumn=function(t,e){var r=Math.floor((e+180)/t);return 180==e&&(r-=1),r},a.computeLastRow=function(t,e){var r=Math.ceil((e+90)/t-1);return t>e+90&&(r=0),r},a.computeLastColumn=function(t,e){var r=Math.ceil((e+180)/t-1);return t>e+180&&(r=0),r},a.computeSector=function(e,n,o){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","computeSector","missingLevel"));if(0>n||0>o)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","computeSector","The specified row or column is less than zero."));var a=e.tileDelta.latitude,s=e.tileDelta.longitude,l=-90+n*a,u=-180+o*s,c=l+a,h=u+s;return new i(l,c,u,h)},a.createTilesForLevel=function(e,n,o){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","createTilesForLevel","missingLevel"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","createTilesForLevel","The specified tile factory is null or undefined"));if(!o)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","createTilesForLevel","missingResult"));for(var s,l,u,c=e.tileDelta.latitude,h=e.tileDelta.longitude,f=e.sector,d=a.computeRow(c,f.minLatitude),p=a.computeRow(c,f.maxLatitude),m=a.computeColumn(h,f.minLongitude),g=a.computeColumn(h,f.maxLongitude),y=-90+d*c,v=-180+m*h,E=y,w=d;p>=w;w+=1){l=E+c,s=v;for(var b=m;g>=b;b+=1){u=s+h;var x=new i(E,l,s,u),_=n.createTile(x,e,w,b);o.push(_),s=u}E=l}},a}),i("../src/worldwind/render/TextureTile",["../error/ArgumentError","../util/Logger","../util/Tile"],function(t,e,r){"use strict";var i=function(t,e,i,n){r.call(this,t,e,i,n),this.gpuCacheKey=null};return i.prototype=Object.create(r.prototype),i.prototype.size=function(){return r.prototype.size.call(this)},i.prototype.bind=function(t){var e=t.gpuResourceCache.resourceForKey(this.gpuCacheKey);return e?e.bind(t):!1},i.prototype.applyInternalTransform=function(t,e){},i}),i("../src/worldwind/render/ImageTile",["../error/ArgumentError","../util/Logger","../render/TextureTile","../util/Tile"],function(t,e,r,i){"use strict";var n=function(i,n,o,a,s){if(!s||s.length<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"ImageTile","constructor","The specified image path is null, undefined or zero length."));r.call(this,i,n,o,a),this.imagePath=s,this.fallbackTile=null,this.gpuCacheKey=s};return n.prototype=Object.create(r.prototype),n.prototype.size=function(){return this.__proto__.__proto__.size.call(this)+this.imagePath.length+8},n.prototype.bind=function(t){var e=this.__proto__.__proto__.bind.call(this,t);return e?!0:this.fallbackTile?this.fallbackTile.bind(t):!1},n.prototype.applyInternalTransform=function(t,e){this.fallbackTile&&!t.gpuResourceCache.resourceForKey(this.imagePath)&&this.applyFallbackTransform(e)},n.prototype.applyFallbackTransform=function(t){var e=this.level.levelNumber-this.fallbackTile.level.levelNumber;if(!(0>=e)){var r=this.fallbackTile.sector.deltaLatitude(),i=this.fallbackTile.sector.deltaLongitude(),n=this.sector.deltaLongitude()/i,o=this.sector.deltaLatitude()/r,a=(this.sector.minLongitude-this.fallbackTile.sector.minLongitude)/i,s=(this.sector.minLatitude-this.fallbackTile.sector.minLatitude)/r;t.multiply(n,0,0,a,0,o,0,s,0,0,1,0,0,0,0,1)}},n}),i("../src/worldwind/util/Level",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger"],function(t,e,r,i){"use strict";var n=function(r,n,o){if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"Level","constructor","The specified tile delta is null or undefined"));if(!o)throw new e(i.logMessage(i.LEVEL_SEVERE,"Level","constructor","The specified parent level set is null or undefined"));this.levelNumber=r,this.tileDelta=n,this.parent=o,this.texelSize=n.latitude*t.DEGREES_TO_RADIANS/o.tileHeight,this.tileWidth=o.tileWidth,this.tileHeight=o.tileHeight,this.sector=o.sector};return n.prototype.isFirstLevel=function(){return this.parent.firstLevel()==this},n.prototype.isLastLevel=function(){return this.parent.lastLevel()==this},n.prototype.previousLevel=function(){return this.parent.level(this.levelNumber-1)},n.prototype.nextLevel=function(){return this.parent.level(this.levelNumber+1)},n.prototype.compare=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Level","compare","The specified level is null or undefined"));return this.levelNumber<t.levelNumber?-1:this.levelNumber>t.levelNumber?1:0},n}),i("../src/worldwind/util/LevelSet",["../error/ArgumentError","../util/Level","../geom/Location","../util/Logger"],function(t,e,r,i){"use strict";var n=function(n,o,a,s,l){if(!n)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","missingSector"));if(!o)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","The specified level zero delta is null or undefined"));if(o.latitude<=0||o.longitude<=0)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","The specified level zero delta is less than or equal to zero."));if(1>a)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","The specified number of levels is less than one."));if(1>s||1>l)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","The specified tile width or tile height is less than one."));this.sector=n,this.levelZeroDelta=o,this.numLevels=a,this.tileWidth=s,this.tileHeight=l,this.levels=[];for(var u=0;a>u;u+=1){var c=Math.pow(2,u),h=o.latitude/c,f=o.longitude/c,d=new r(h,f),p=new e(u,d,this);this.levels[u]=p}};return n.prototype.level=function(t){return 0>t||t>=this.levels.length?null:this.levels[t]},n.prototype.levelForTexelSize=function(t){var e=this.lastLevel();if(e.texelSize>=t)return e;for(var r=0,i=this.levels.length;i>r;r+=1){var n=this.levels[r];if(n.texelSize<=t)return n}return e},n.prototype.firstLevel=function(){return this.levels[0]},n.prototype.lastLevel=function(){return this.levels[this.levels.length-1]},n}),i("../src/worldwind/cache/MemoryCache",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i){if(!r||1>r)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","constructor","The specified capacity is undefined, zero or negative"));if(!i||i>=r||0>i)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","constructor","The specified low-water value is undefined, greater than or equal to the capacity, or less than 1"));this._capacity=r,this._lowWater=i,this.usedCapacity=0,this.freeCapacity=r,this.entries={},this.listeners=[]};return Object.defineProperties(r.prototype,{capacity:{get:function(){return this._capacity},set:function(r){if(!r||1>r)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","capacity","Specified cache capacity is undefined, 0 or negative."));var i=this._capacity;this._capacity=r,this._capacity<=this.lowWater&&(this._lowWater=.85*this._capacity),this._capacity<i&&this.makeSpace(0)}},lowWater:{get:function(){return this._lowWater},set:function(r){if(!r||r>=this._capacity||0>r)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","lowWater","Specified cache low-water value is undefined, negative or not less than the current capacity."));this._lowWater=r}}}),r.prototype.entryForKey=function(t){if(!t)return null;var e=this.entries[t];return e?(e.lastUsed=Date.now(),e.entry):null},r.prototype.putEntry=function(r,i,n){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","putEntry","missingKey."));if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","putEntry","missingEntry."));if(1>n)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","putEntry","The specified entry size is less than 1."));var o,a=this.entries[r];a&&this.removeEntry(r),this.usedCapacity+n>this._capacity&&this.makeSpace(n),this.usedCapacity+=n,this.freeCapacity=this._capacity-this.usedCapacity,o={key:r,entry:i,size:n,lastUsed:Date.now()},this.entries[r]=o},r.prototype.clear=function(t){if(t)for(var e in this.entries)this.entries.hasOwnProperty(e)&&this.removeCacheEntry(e);this.entries={},this.freeCapacity=this._capacity,this.usedCapacity=0},r.prototype.removeEntry=function(t){if(t){var e=this.entries[t];e&&this.removeCacheEntry(e)}},r.prototype.removeCacheEntry=function(t){delete this.entries[t.key],this.usedCapacity-=t.size,this.freeCapacity=this._capacity-this.usedCapacity;for(var e=0,r=this.listeners.length;r>e;e++)try{this.listeners[e].entryRemoved(t.key,t.entry)}catch(i){this.listeners[e].removalError(i,t.key,t.entry)}},r.prototype.containsKey=function(t){return t&&this.entries[t]},r.prototype.addCacheListener=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","addCacheListener","missingListener"));if("function"!=typeof r.entryRemoved||"function"!=typeof r.removalError)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","addCacheListener","The specified listener does not implement the required functions."));this.listeners.push(r)},r.prototype.removeCacheListener=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","removeCacheListener","missingListener"));var i=this.listeners.indexOf(r);i>-1&&this.listeners.splice(i,1)},r.prototype.makeSpace=function(t){var e=[];this.usedCapacity;for(var r in this.entries)this.entries.hasOwnProperty(r)&&e.push(this.entries[r]);e.sort(function(t,e){return t.lastUsed-e.lastUsed});for(var i=0,n=e.length;n>i&&(this.usedCapacity>this._lowWater||this.freeCapacity<t);i++)this.removeCacheEntry(e[i])},r}),i("../src/worldwind/layer/TiledImageLayer",["../util/AbsentResourceList","../error/ArgumentError","../render/ImageTile","../layer/Layer","../util/LevelSet","../util/Logger","../cache/MemoryCache","../render/Texture","../util/Tile","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u){"use strict";var c=function(r,s,l,u,c,h,f){if(!r)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","missingSector"));if(!s)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified level-zero delta is null or undefined."));if(!u)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified image format is null or undefined."));if(!c)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified cache path is null or undefined."));if(!l||1>l)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified number of levels is less than one."));if(!h||!f||1>h||1>f)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified tile width or height is less than one."));i.call(this,"Tiled Image Layer"),this.retrievalImageFormat=u,this.cachePath=c,this.levels=new n(r,s,l,h,f),this.detailControl=1.75,this.expiration=null,this.currentTiles=[],this.currentTilesInvalid=!0,this.tileCache=new a(5e5,4e5),this.currentRetrievals=[],this.absentResourceList=new t(3,5e4),this.pickEnabled=!1};return c.prototype=Object.create(i.prototype),c.prototype.refresh=function(){this.expiration=new Date,this.currentTilesInvalid=!0},c.prototype.prePopulate=function(t){if(!t)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","prePopulate","missingWorldWindow"));var r=t.drawContext;this.topLevelTiles&&0!==this.topLevelTiles.length||this.createTopLevelTiles(r);for(var i=0;i<this.topLevelTiles.length;i++){var n=this.topLevelTiles[i];this.isTileTextureInMemory(r,n)||this.retrieveTileImage(r,n,!0)}},c.prototype.prePopulateCurrentTiles=function(t){if(!t)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","prePopulate","missingWorldWindow"));var r=t.drawContext;this.assembleTiles(r);for(var i=0,n=this.currentTiles.length;n>i;i++){var a=this.currentTiles[i];this.isTileTextureInMemory(r,a)||this.retrieveTileImage(r,a,!0)}},c.prototype.isPrePopulated=function(t){if(!t)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","isPrePopulated","missingWorldWindow"));for(var r=0;r<this.topLevelTiles.length;r++)if(!this.isTileTextureInMemory(t.drawContext,this.topLevelTiles[r]))return!1;return!0},c.prototype.createTile=function(t,e,i,n){var o=this.cachePath+"-layer/"+e.levelNumber+"/"+i+"/"+i+"_"+n+"."+u.suffixForMimeType(this.retrievalImageFormat);return new r(t,e,i,n,o)},c.prototype.doRender=function(t){if(t.terrain){if(this.currentTilesInvalid||!this.lasTtMVP||!t.navigatorState.modelviewProjection.equals(this.lasTtMVP)||t.globeStateKey!=this.lastGlobeStateKey)if(this.currentTilesInvalid=!1,t.surfaceOpacity>=1&&this.opacity>=1){this.previousTiles={};for(var e=0;e<this.currentTiles.length;e++)this.previousTiles[this.currentTiles[e].imagePath]=this.currentTiles[e];this.assembleTiles(t),this.fadeOutgoingTiles(t)}else this.assembleTiles(t);this.lasTtMVP=t.navigatorState.modelviewProjection,this.lastGlobeStateKey=t.globeStateKey,this.currentTiles.length>0&&(t.surfaceTileRenderer.renderTiles(t,this.currentTiles,this.opacity,t.surfaceOpacity>=1),t.frameStatistics.incrementImageTileCount(this.currentTiles.length),this.inCurrentFrame=!0)}},c.prototype.fadeOutgoingTiles=function(t){for(var e=(t.timestamp-t.previousRedrawTimestamp)/t.fadeTime,r={},i=0;i<this.currentTiles.length;i++){var n=this.currentTiles[i];r[n.imagePath]=n}for(var o in this.previousTiles)this.previousTiles.hasOwnProperty(o)&&(n=this.previousTiles[o],n.opacity>0&&!r[n.imagePath]&&(n.opacity=Math.max(0,n.opacity-e),n.opacity>0&&(this.currentTiles.push(n),this.currentTilesInvalid=!0,t.redrawRequested=!0)))},c.prototype.isLayerInView=function(t){return t.terrain&&t.terrain.sector&&t.terrain.sector.intersects(this.levels.sector)},c.prototype.createTopLevelTiles=function(t){this.topLevelTiles=[],l.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)},c.prototype.assembleTiles=function(t){this.currentTiles=[],this.topLevelTiles&&0!==this.topLevelTiles.length||this.createTopLevelTiles(t);for(var e=0,r=this.topLevelTiles.length;r>e;e++){var i=this.topLevelTiles[e];i.update(t),this.currentAncestorTile=null,this.isTileVisible(t,i)&&this.addTileOrDescendants(t,i)}},c.prototype.addTileOrDescendants=function(t,e){if(this.tileMeetsRenderingCriteria(t,e))return void this.addTile(t,e);var r=null;try{(this.isTileTextureInMemory(t,e)||0===e.level.levelNumber)&&(r=this.currentAncestorTile,this.currentAncestorTile=e);for(var i=this.levels.level(e.level.levelNumber+1),n=e.subdivideToCache(i,this,this.tileCache),o=0,a=n.length;a>o;o++){var s=n[o];s.update(t),this.levels.sector.intersects(s.sector)&&this.isTileVisible(t,s)&&this.addTileOrDescendants(t,s)}}finally{r&&(this.currentAncestorTile=r)}},c.prototype.addTile=function(t,e){e.fallbackTile=null;var r=t.gpuResourceCache.resourceForKey(e.imagePath);return r?(e.opacity=1,this.currentTiles.push(e),void(this.expiration&&this.isTextureExpired(r)&&this.retrieveTileImage(t,e))):(this.retrieveTileImage(t,e),void(this.currentAncestorTile&&this.isTileTextureInMemory(t,this.currentAncestorTile)&&(e.fallbackTile=this.currentAncestorTile,e.fallbackTile.opacity=1,this.currentTiles.push(e))))},c.prototype.isTileVisible=function(t,e){return t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits)?!1:e.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)},c.prototype.tileMeetsRenderingCriteria=function(t,e){var r=this.detailControl;return(e.sector.minLatitude>=75||e.sector.maxLatitude<=-75)&&(r*=1.2),e.level.isLastLevel()||!e.mustSubdivide(t,r)},c.prototype.isTileTextureInMemory=function(t,e){return t.gpuResourceCache.containsResource(e.imagePath)},c.prototype.isTextureExpired=function(t){return this.expiration&&t.creationTime.getTime()<=this.expiration.getTime()},c.prototype.retrieveTileImage=function(t,e,r){if(this.currentRetrievals.indexOf(e.imagePath)<0){if(this.absentResourceList.isResourceAbsent(e.imagePath))return;var i=this.resourceUrlForTile(e,this.retrievalImageFormat),n=new Image,a=e.imagePath,s=t.gpuResourceCache,l=t.currentGlContext.canvas,u=this;if(!i)return void(this.currentTilesInvalid=!0);n.onload=function(){o.log(o.LEVEL_INFO,"Image retrieval succeeded: "+i);var c=u.createTexture(t,e,n);if(u.removeFromCurrentRetrievals(a),c&&(s.putResource(a,c,c.size),u.currentTilesInvalid=!0,u.absentResourceList.unmarkResourceAbsent(a),!r)){var h=document.createEvent("Event");h.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),l.dispatchEvent(h)}},n.onerror=function(){u.removeFromCurrentRetrievals(a),u.absentResourceList.markResourceAbsent(a),o.log(o.LEVEL_WARNING,"Image retrieval failed: "+i)},this.currentRetrievals.push(a),n.crossOrigin="anonymous",n.src=i}},c.prototype.createTexture=function(t,e,r){return new s(t.currentGlContext,r)},c.prototype.removeFromCurrentRetrievals=function(t){var e=this.currentRetrievals.indexOf(t);e>-1&&this.currentRetrievals.splice(e,1)},c.prototype.resourceUrlForTile=function(t,e){return this.urlBuilder?this.urlBuilder.urlForTile(t,e):null},c}),i("../src/worldwind/layer/MercatorTiledImageLayer",["../util/Color","../geom/Sector","../layer/TiledImageLayer","../geom/Vec2","../util/WWMath"],function(t,e,r,i,n){"use strict";var o=function(t,e,n,o,a,s,l){r.call(this,t,e,n,o,a,s,l),this.detectBlankImages=!1,this.testPixels=[new i(20,20),new i(235,20),new i(20,235),new i(235,235)],this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d");
};return o.prototype=Object.create(r.prototype),o.prototype.createTile=function(t,i,o,a){var s,l,u,c,h,f,d=this.mapSizeForLevel(i.levelNumber),p=n.clamp(a*this.imageSize,0,d),m=n.clamp(o*this.imageSize,0,d),g=n.clamp(p+this.imageSize,0,d),y=n.clamp(m+this.imageSize,0,d);return s=p/d-.5,l=.5-y/d,u=90-360*Math.atan(Math.exp(2*-l*Math.PI))/Math.PI,c=360*s,s=g/d-.5,l=.5-m/d,h=90-360*Math.atan(Math.exp(2*-l*Math.PI))/Math.PI,f=360*s,t=new e(u,h,c,f),r.prototype.createTile.call(this,t,i,o,a)},o.prototype.createTexture=function(t,e,i){var o,a,s,l,u,c,h,f,d=t.canvas2D,p=t.ctx2D,m=this.destCanvas,g=this.destContext,y=g.createImageData(i.width,i.height),v=e.sector,E=n.gudermannianInverse(v.minLatitude),w=n.gudermannianInverse(v.maxLatitude);if(d.width=i.width,d.height=i.height,m.width=i.width,m.height=i.height,p.drawImage(i,0,0,i.width,i.height),o=p.getImageData(0,0,i.width,i.height),this.detectBlankImages&&this.isBlankImage(i,o))return this.absentResourceList.markResourceAbsentPermanently(e.imagePath),null;for(var b=0;1>b;b++)for(var x=0;x<i.height;x++){h=1-x/(i.height-1),a=h*v.deltaLatitude()+v.minLatitude,s=n.gudermannianInverse(a),f=1-(s-E)/(w-E),f=n.clamp(f,0,1),l=Math.floor(f*(i.height-1));for(var _=0;_<i.width;_++)u=4*(_+l*i.width),c=4*(_+x*i.width),y.data[c]=o.data[u],y.data[c+1]=o.data[u+1],y.data[c+2]=o.data[u+2],y.data[c+3]=o.data[u+3]}return g.putImageData(y,0,0),r.prototype.createTexture.call(this,t,e,m)},o.prototype.isBlankImage=function(t,e){for(var r,i,n=null,o=0,a=this.testPixels.length;a>o;o++)if(r=this.testPixels[o],i=4*(r[0]+r[1]*t.width),n){if(e.data[i]!=n[0]||e.data[i+1]!=n[1]||e.data[i+2]!=n[2])return!1}else n=[e.data[i],e.data[i+1],e.data[i+2]];return!0},o}),i("../src/worldwind/layer/BingTiledImageLayer",["../geom/Angle","../geom/Location","../geom/Sector","../layer/MercatorTiledImageLayer"],function(t,e,r,i){"use strict";var n=function(t){this.imageSize=256,i.call(this,new r(-85.05,85.05,-180,180),new e(85.05,180),23,"image/jpeg",t,this.imageSize,this.imageSize),this.displayName=t,this.pickEnabled=!1,this.detectBlankImages=!0,this.creditImage=WorldWind.configuration.baseUrl+"images/powered-by-bing.png"};return n.prototype=Object.create(i.prototype),n.prototype.doRender=function(t){i.prototype.doRender.call(this,t),this.inCurrentFrame&&t.screenCreditController.addImageCredit(this.creditImage)},n.prototype.createTopLevelTiles=function(t){this.topLevelTiles=[],this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))},n.prototype.mapSizeForLevel=function(t){return 256<<t+1},n}),i("../src/worldwind/util/BingImageryUrlBuilder",["../error/ArgumentError","../util/Logger","../util/WWUtil"],function(t,e,r){"use strict";var i=function(t,e){var r="AkttWCS8p6qzxvx5RH3qUcCPgwG9nRJ7IwlpFGb14B0rBorB5DvmXr2Y_eCUNIxH";e||(this.bingMapsKey=WorldWind.BingMapsKey,e||(this.bingMapsKey=r),e===r&&(this.bingMapsKey=r,i.showBingMapsKeyWarning())),this.imagerySet=t};return i.showBingMapsKeyWarning=function(){i.keyMessagePrinted||(i.keyMessagePrinted=!0,e.log(e.LEVEL_WARNING,"WARNING: You are using a limited use, non-production Bing Maps key.\nIf you are developing an app or a web page this violates the Bing Terms of Use.\nPlease visit https://www.microsoft.com/maps/choose-your-bing-maps-API.aspx to obtain your own key for your application.\nSpecify that key to World Wind by setting the WorldWind.BingMapsKey property to your key prior to creating any Bing Maps layers.\n"))},i.prototype.requestMetadata=function(){if(!this.metadataRetrievalInProcess){this.metadataRetrievalInProcess=!0;var t="https://dev.virtualearth.net/REST/V1/Imagery/Metadata/"+this.imagerySet+"/0,0?zl=1&uriScheme=https&key="+this.bingMapsKey,e=this;r.jsonp(t,"jsonp",function(t){e.imageUrl=t.resourceSets[0].resources[0].imageUrl;var r=document.createEvent("Event");r.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(r),e.metadataRetrievalInProcess=!1})}},i.prototype.urlForTile=function(r,i){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"BingImageryUrlBuilder","urlForTile","missingTile"));if(!this.imageUrl)return this.requestMetadata(),null;var n,o=this.quadKeyFromLevelRowColumn(r.level.levelNumber,r.row,r.column);return"Aerial"===this.imagerySet?n=this.imageUrl.replace(/a3/,"a"+o):"AerialWithLabels"===this.imagerySet?n=this.imageUrl.replace(/h3/,"h"+o):"Road"===this.imagerySet&&(n=this.imageUrl.replace(/r3/,"r"+o)),n},i.prototype.quadKeyFromLevelRowColumn=function(t,e,r){for(var i,n,o="",a=t+1;a>0;a--)i=0,n=1<<a-1,0!=(r&n)&&(i+=1),0!=(e&n)&&(i+=2),o+=i.toString();return o},i}),i("../src/worldwind/layer/BingAerialLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,"Bing Aerial"),this.urlBuilder=new i("Aerial",t)};return n.prototype=Object.create(r.prototype),n}),i("../src/worldwind/layer/BingAerialWithLabelsLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,"Bing Aerial with Labels"),this.urlBuilder=new i("AerialWithLabels",t)};return n.prototype=Object.create(r.prototype),n}),i("../src/worldwind/layer/BingRoadsLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,"Bing Roads"),this.urlBuilder=new i("Road",t),this.detectBlankImages=!1};return n.prototype=Object.create(r.prototype),n}),i("../src/worldwind/util/WmsUrlBuilder",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i,n,o,a){if(!r||0===r.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","constructor","The WMS service address is missing."));if(!i||0===i.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","constructor","The WMS layer names are not specified."));this.serviceAddress=r,this.layerNames=i,this.styleNames=n?n:"",this.transparent=!0,this.wmsVersion=o&&o.length>0?o:"1.3.0",this.isWms130OrGreater=this.wmsVersion>="1.3.0",this.crs="EPSG:4326",this.timeString=a};return r.prototype.urlForTile=function(i,n){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","missingTile"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","The image format is null or undefined."));var o=i.sector,a=r.fixGetMapString(this.serviceAddress);return a.search(/service=wms/i)<0&&(a+="service=WMS"),a+="&request=GetMap",a=a+"&version="+this.wmsVersion,a=a+"&transparent="+(this.transparent?"TRUE":"FALSE"),a=a+"&layers="+this.layerNames,a=a+"&styles="+this.styleNames,a=a+"&format="+n,a=a+"&width="+i.tileWidth,a=a+"&height="+i.tileHeight,this.timeString&&(a=a+"&time="+this.timeString),this.isWms130OrGreater?(a=a+"&crs="+this.crs,a+="&bbox=","CRS:84"===this.crs?(a=a+o.minLongitude+","+o.minLatitude+",",a=a+o.maxLongitude+","+o.maxLatitude):(a=a+o.minLatitude+","+o.minLongitude+",",a=a+o.maxLatitude+","+o.maxLongitude)):(a=a+"&srs="+this.crs,a+="&bbox=",a=a+o.minLongitude+","+o.minLatitude+",",a=a+o.maxLongitude+","+o.maxLatitude),a=a.replace(" ","%20")},r.fixGetMapString=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","fixGetMapString","The specified service address is null or undefined."));var i=r.indexOf("?");return 0>i?r+="?":i!==r.length-1&&(i=r.search(/&$/),0>i&&(r+="&")),r},r}),i("../src/worldwind/layer/BingWMSLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(t,e,r,i){"use strict";var n=function(){r.call(this,e.FULL_SPHERE,new t(45,45),16,"image/png","BingWMS",256,256),this.displayName="Bing WMS",this.pickEnabled=!1,this.maxActiveAltitude=1e4,this.urlBuilder=new i("https://worldwind27.arc.nasa.gov/wms/virtualearth","ve","","1.3.0")};return n.prototype=Object.create(r.prototype),n}),i("../src/worldwind/layer/BMNGLandsatLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(t,e,r,i){"use strict";var n=function(){r.call(this,e.FULL_SPHERE,new t(45,45),10,"image/jpeg","BMNGLandsat256",256,256),this.displayName="Blue Marble & Landsat",this.pickEnabled=!1,this.urlBuilder=new i("https://worldwind25.arc.nasa.gov/wms","BlueMarble-200405,esat","","1.3.0")};return n.prototype=Object.create(r.prototype),n}),i("../src/worldwind/layer/BMNGLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(t,e,r,i){"use strict";var n=function(n){r.call(this,e.FULL_SPHERE,new t(45,45),5,"image/jpeg",n||"BMNG256",256,256),this.displayName="Blue Marble",this.pickEnabled=!1,this.urlBuilder=new i("https://worldwind25.arc.nasa.gov/wms",n||"BlueMarble-200405","","1.3.0")};return n.prototype=Object.create(r.prototype),n}),i("../src/worldwind/layer/RenderableLayer",["../error/ArgumentError","../layer/Layer","../util/Logger"],function(t,e,r){"use strict";var i=function(t){e.call(this,t),this.renderables=[]};return i.prototype=Object.create(e.prototype),i.prototype.addRenderable=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"RenderableLayer","addRenderable","missingRenderable"));this.renderables.push(e)},i.prototype.addRenderables=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"RenderableLayer","addRenderables","The renderables array is null or undefined."));for(var i=0,n=e.length;n>i;i++)this.addRenderable(e[i])},i.prototype.removeRenderable=function(t){var e=this.renderables.indexOf(t);e>=0&&this.renderables.splice(e,1)},i.prototype.removeAllRenderables=function(){this.renderables=[]},i.prototype.doRender=function(t){for(var e=t.orderedRenderables.length,i=0,n=this.renderables.length;n>i;i++)try{this.renderables[i].render(t)}catch(o){r.logMessage(r.LEVEL_SEVERE,"RenderableLayer","doRender","Error while rendering shape "+this.renderables[i].displayName+".\n"+o.toString())}t.orderedRenderables.length>e&&(this.inCurrentFrame=!0)},i}),i("../src/worldwind/render/SurfaceTile",["../error/ArgumentError","../util/Logger","../geom/Matrix","../geom/Sector","../error/UnsupportedOperationError"],function(t,e,r,i,n){"use strict";var o=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceTile","constructor","missingSector"));this.sector=r};return o.prototype.bind=function(t){throw new n(e.logMessage(e.LEVEL_SEVERE,"SurfaceTile","bind","abstractInvocation"))},o.prototype.applyInternalTransform=function(t,r){throw new n(e.logMessage(e.LEVEL_SEVERE,"SurfaceTile","applyInternalTransform","abstractInvocation"))},o}),i("../src/worldwind/shapes/SurfaceImage",["../error/ArgumentError","../util/Logger","../pick/PickedObject","../render/SurfaceTile"],function(t,e,r,i){"use strict";var n=function(r,n){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceImage","constructor","missingSector"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceImage","constructor","missingImage"));i.call(this,r),this.enabled=!0,this._imageSource=n,this.opacity=1,this.displayName="Surface Image",this.imageSourceWasUpdated=!0};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{imageSource:{get:function(){return this._imageSource},set:function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceImage","imageSource","missingImage"));this._imageSource=r,this.imageSourceWasUpdated=!0}}}),n.prototype.bind=function(t){var e=t.gpuResourceCache.resourceForKey(this._imageSource);return e&&!this.imageSourceWasUpdated?e.bind(t):(e=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this._imageSource),this.imageSourceWasUpdated=!1,e?e.bind(t):void 0)},n.prototype.applyInternalTransform=function(t,e){},n.prototype.render=function(t){if(this.enabled&&this.sector.overlaps(t.terrain.sector)){if(t.pickingMode&&(this.pickColor=t.uniquePickColor()),t.surfaceTileRenderer.renderTiles(t,[this],this.opacity*t.currentLayer.opacity),t.pickingMode){var e=new r(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);t.resolvePick(e)}t.currentLayer.inCurrentFrame=!0}},n}),i("../src/worldwind/layer/BMNGOneImageLayer",["../layer/RenderableLayer","../geom/Sector","../shapes/SurfaceImage","../util/WWUtil"],function(t,e,r,i){"use strict";var n=function(){t.call(this,"Blue Marble Image");var i=new r(e.FULL_SPHERE,WorldWind.configuration.baseUrl+"images/BMNG_world.topo.bathy.200405.3.2048x1024.jpg");this.addRenderable(i),this.pickEnabled=!1,this.minActiveAltitude=3e6};return n.prototype=Object.create(t.prototype),n}),i("../src/worldwind/util/PeriodicTimeSequence",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"PeriodicTimeSequence","constructor","missingString"));var n=i.split("/");if(3!==n.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"PeriodicTimeSequence","constructor","The interval string "+i+" does not contain 3 elements."));this.sequenceString=i,this.startTime=new Date(n[0]),this.endTime=new Date(n[1]),this.intervalMilliseconds=this.endTime.getTime()-this.startTime.getTime(),this._currentTime=this.startTime,this.infiniteInterval=this.startTime.getTime()==this.endTime.getTime(),this.period=r.parsePeriodString(n[2],!1)};return Object.defineProperties(r.prototype,{currentTime:{get:function(){return this._currentTime},set:function(t){this._currentTime=t}},scaleForCurrentTime:{get:function(){return this.currentTime?(this.currentTime.getTime()-this.startTime.getTime())/this.intervalMilliseconds:1}}}),r.prototype.next=function(){return this.currentTime?this.currentTime.getTime()>=this.endTime.getTime()&&!this.infiniteInterval?this.currentTime=null:this.currentTime=r.incrementTime(this.currentTime,this.period):this.currentTime=this.startTime,this.currentTime},r.prototype.previous=function(){return this.currentTime?this.currentTime.getTime()===this.startTime.getTime()?this.currentTime=null:this.currentTime=this.getTimeForScale(.9999*this.scaleForCurrentTime):this.currentTime=this.endTime,this.currentTime},r.prototype.reset=function(){this.currentTime=null},r.prototype.getTimeForScale=function(t){if(0>=t)return this.startTime;if(t>=1)return this.endTime;var e=new Date(this.startTime.getTime()),i=e,n=0;for(n=0;t>n;n=(e.getTime()-this.startTime.getTime())/this.intervalMilliseconds)i=e,e=r.incrementTime(e,this.period);return i},r.incrementTime=function(t,e){var i=new Date(t.getTime());return 0!=e[0]&&i.setUTCFullYear(i.getUTCFullYear()+e[0]),0!=e[1]&&r.addMonths(i,e[1]),0!=e[2]&&i.setUTCDate(i.getUTCDate()+7*e[2]),0!=e[3]&&i.setUTCDate(i.getUTCDate()+e[3]),0!=e[4]&&i.setUTCHours(i.getUTCHours()+e[4]),0!=e[5]&&i.setUTCMinutes(i.getUTCMinutes()+e[5]),0!=e[6]&&i.setUTCSeconds(i.getUTCSeconds()+e[6]),i},r.isLeapYear=function(t){return t%4===0&&t%100!==0||t%400===0},r.getDaysInMonth=function(t,e){return[31,r.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},r.addMonths=function(t,e){var i=t.getUTCDate();return t.setUTCDate(1),t.setUTCMonth(t.getUTCMonth()+e),t.setUTCDate(Math.min(i,r.getDaysInMonth(t.getUTCFullYear(),t.getUTCMonth()))),t},r.parsePeriodString=function(r,i){var n,o=i?i:!1,a=[2,3,4,5,7,8,9],s=[0,0,0,0,0,0,0],l=[0,12,4,7,24,60,60];if(r=r.toUpperCase().trim(),!r)return s;if("string"!=typeof r)throw new t(e.logMessage(e.LEVEL_SEVERE,"PeriodicTimeSequence","parsePeriodString","Invalid ISO8601 period string '"+r+"'"));if(!(n=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(r)))throw new t(e.logMessage(e.LEVEL_SEVERE,"PeriodicTimeSequence","parsePeriodString","String '"+r+"' is not a valid ISO8601 period."));for(var u=0;u<a.length;u++){var c=a[u];s[u]=n[c]?+n[c].replace(/[A-Za-z]+/g,""):0}if(o)for(u=s.length-1;u>0;u--)s[u]>=l[u]&&(s[u-1]=s[u-1]+Math.floor(s[u]/l[u]),s[u]=s[u]%l[u]);return s},r}),i("../src/worldwind/util/LevelRowColumnUrlBuilder",["../error/ArgumentError","../util/Logger","../util/WWUtil"],function(t,e,r){"use strict";var i=function(t,e){this.serverAddress=t,t&&0!==t.length||(this.serverAddress=r.currentUrlSansFilePart()),this.pathToData=e};return i.prototype.urlForTile=function(i,n){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","missingTile"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","The image format is null or undefined."));var o=this.serverAddress;return this.pathToData&&(o=o+"/"+this.pathToData),o=o+"/"+i.level.levelNumber.toString(),o=o+"/"+i.row.toString(),o=o+"/"+i.row.toString()+"_"+i.column.toString(),o=o+"."+r.suffixForMimeType(n),o=o.replace(" ","%20")},i}),i("../src/worldwind/layer/RestTiledImageLayer",["../error/ArgumentError","../geom/Location","../util/Logger","../geom/Sector","../layer/TiledImageLayer","../util/LevelRowColumnUrlBuilder","../util/WWUtil"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,s,l){var u=a.urlPath(t+"/"+r);n.call(this,l&&l.sector||i.FULL_SPHERE,l&&l.levelZeroTileDelta||new e(45,45),l&&l.numLevels||5,l&&l.imageFormat||"image/jpeg",u,l&&l.tileWidth||256,l&&l.tileHeight||256),this.displayName=s,this.pickEnabled=!1,this.urlBuilder=new o(t,r)};return s.prototype=Object.create(n.prototype),s}),i("../src/worldwind/layer/BMNGRestLayer",["../error/ArgumentError","../layer/Layer","../util/Logger","../util/PeriodicTimeSequence","../layer/RestTiledImageLayer"],function(t,e,r,i,n){"use strict";var o=function(t,r,n,a){e.call(this,n||"Blue Marble time series"),this.time=a||new Date("2004-01"),this.pickEnabled=!1,this.layers={},this.layerNames=[{month:"BlueMarble-200401",time:o.availableTimes[0]},{month:"BlueMarble-200402",time:o.availableTimes[1]},{month:"BlueMarble-200403",time:o.availableTimes[2]},{month:"BlueMarble-200404",time:o.availableTimes[3]},{month:"BlueMarble-200405",time:o.availableTimes[4]},{month:"BlueMarble-200406",time:o.availableTimes[5]},{month:"BlueMarble-200407",time:o.availableTimes[6]},{month:"BlueMarble-200408",time:o.availableTimes[7]},{month:"BlueMarble-200409",time:o.availableTimes[8]},{month:"BlueMarble-200410",time:o.availableTimes[9]},{month:"BlueMarble-200411",time:o.availableTimes[10]},{month:"BlueMarble-200412",time:o.availableTimes[11]}],this.timeSequence=new i("2004-01-01/2004-12-01/P1M"),this.serverAddress=t||"http://worldwindserver.net/webworldwind/",this.pathToData=r||"/standalonedata/Earth/BlueMarble256/"};return o.prototype=Object.create(e.prototype),o.availableTimes=[new Date("2004-01"),new Date("2004-02"),new Date("2004-03"),new Date("2004-04"),new Date("2004-05"),new Date("2004-06"),new Date("2004-07"),new Date("2004-08"),new Date("2004-09"),new Date("2004-10"),new Date("2004-11"),new Date("2004-12")],o.prototype.prePopulate=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"BMNGRestLayer","prePopulate","missingWorldWindow"));for(var i=0;i<this.layerNames.length;i++){var n=this.layerNames[i].month;this.layers[n]||this.createSubLayer(n),this.layers[n].prePopulate(e)}},o.prototype.isPrePopulated=function(t){for(var e=0;e<this.layerNames.length;e++){var r=this.layers[this.layerNames[e].month];if(!r||!r.isPrePopulated(t))return!1}return!0},o.prototype.doRender=function(t){var e=this.nearestLayer(this.time);e.opacity=this.opacity,this.detailControl&&(e.detailControl=this.detailControl),e.doRender(t),this.inCurrentFrame=e.inCurrentFrame},o.prototype.nearestLayer=function(t){var e=this.nearestLayerName(t);return this.layers[e]||this.createSubLayer(e),this.layers[e]},o.prototype.createSubLayer=function(t){var e=this.pathToData+t;this.layers[t]=new n(this.serverAddress,e,this.displayName)},o.prototype.nearestLayerName=function(t){var e=t.getTime();if(e<=this.layerNames[0].time.getTime())return this.layerNames[0].month;if(e>=this.layerNames[11].time.getTime())return this.layerNames[11].month;for(var r=0;r<this.layerNames.length-1;r++){var i=this.layerNames[r].time.getTime(),n=this.layerNames[r+1].time.getTime();if(e>=i&&n>=e){var o=e-i,a=n-e;return a>o?this.layerNames[r].month:this.layerNames[r+1].month}}},o}),i("../src/worldwind/gesture/ClickRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.numberOfClicks=1,this.button=0,this.maxMouseMovement=5,this.maxClickDuration=500,this.maxClickInterval=400,this.clicks=[],this.timeout=null};return e.prototype=Object.create(t.prototype),e.prototype.reset=function(){t.prototype.reset.call(this),this.clicks=[],this.cancelFailAfterDelay()},e.prototype.mouseDown=function(t){if(this.state==WorldWind.POSSIBLE)if(this.button!=t.button)this.state=WorldWind.FAILED;else{var e={clientX:this.clientX,clientY:this.clientY};this.clicks.push(e),this.failAfterDelay(this.maxClickDuration)}},e.prototype.mouseMove=function(t){if(this.state==WorldWind.POSSIBLE){var e=this.translationX,r=this.translationY,i=Math.sqrt(e*e+r*r);i>this.maxMouseMovement&&(this.state=WorldWind.FAILED)}},e.prototype.mouseUp=function(t){if(this.state==WorldWind.POSSIBLE&&0==this.mouseButtonMask){var e=this.clicks.length;e==this.numberOfClicks?(this.clientX=this.clicks[0].clientX,this.clientY=this.clicks[0].clientY,this.state=WorldWind.RECOGNIZED):this.failAfterDelay(this.maxClickInterval)}},e.prototype.touchStart=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.failAfterDelay=function(t){var e=this;e.timeout&&window.clearTimeout(e.timeout),e.timeout=window.setTimeout(function(){e.timeout=null,e.state==WorldWind.POSSIBLE&&(e.state=WorldWind.FAILED)},t)},e.prototype.cancelFailAfterDelay=function(){var t=this;t.timeout&&(window.clearTimeout(t.timeout),t.timeout=null)},e}),i("../src/worldwind/formats/collada/ColladaAsset",[],function(){"use strict";var t=function(t){this.xmlAsset=t.getElementsByTagName("asset")[0],this.asset={daeVersion:t.querySelector("COLLADA").getAttribute("version")}};return t.prototype.parse=function(){if(!this.xmlAsset)return null;for(var t=0;t<this.xmlAsset.childNodes.length;t++){var e=this.xmlAsset.childNodes.item(t);if(1===e.nodeType)switch(e.nodeName){case"contributor":var r=e.querySelector("authoring_tool");r&&(this.asset.authoring_tool=r.textContext);break;case"unit":this.asset.unit=e.getAttribute("meter");break;default:this.asset[e.localName]=e.textContent}}return this.xmlAsset=null,this.asset},t}),i("../src/worldwind/formats/collada/ColladaUtils",["../../util/Logger"],function(t){"use strict";var e={getRawValues:function(t){if(!t)return null;var e=t.textContent;return e=e.replace(/\n/gi," "),e=e.replace(/\s+/gi," "),e=e.trim(),0===e.length?null:e.split(" ")},bufferDataFloat32:function(t){var e=this.getRawValues(t);if(!e)return null;for(var r=e.length,i=new Float32Array(r),n=0;r>n;n++)i[n]=parseFloat(e[n]);return i},bufferDataUInt32:function(t){var e=this.getRawValues(t);if(!e)return null;for(var r=e.length,i=new Uint32Array(r),n=0;r>n;n++)i[n]=parseInt(e[n]);return i},getFirstChildElement:function(t,e){for(var r=t.childNodes,i=0;i<r.length;++i){var n=r.item(i);if(1===n.nodeType&&(n.nodeName&&!e||e&&e===n.nodeName))return n}return null},getFilename:function(t){var e=t.lastIndexOf("\\");return-1!==e&&(t=t.substr(e+1)),e=t.lastIndexOf("/"),-1!==e&&(t=t.substr(e+1)),t},replaceSpace:function(t){return t?t.replace(/ /g,"_"):""},querySelectorById:function(t,e){for(var r=0;r<t.length;r++){var i=t.item(r).getAttribute("id");if(i&&i.toString()===e)return t.item(r)}return null},getTextureType:function(t){for(var e=!0,r=0,i=t.length;i>r;r++)if(t[r]<0||t[r]>1){e=!1;break}return e},fetchFile:function(e,r){var i=new XMLHttpRequest;i.onload=function(){this.status>=200&&this.status<400?r(this.response):(t.log(t.LEVEL_SEVERE,"sever error: "+this.status),r(null))},i.onerror=function(e){t.log(t.LEVEL_SEVERE,"connection error: "+e),r(null)},i.open("get",e,!0),i.send()}};return e}),i("../src/worldwind/formats/collada/ColladaImage",["./ColladaUtils"],function(t){"use strict";var e=function(t,e){this.filename="",this.map=t,this.name=e,this.path=""};return e.prototype.parse=function(e){for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"init_from":this.filename=t.getFilename(i.textContent),this.path=i.textContent}}return this},e}),i("../src/worldwind/formats/collada/ColladaMaterial",["./ColladaUtils"],function(t){"use strict";var e=function(t){this.id=t,this.newParams=[]};return e.prototype.parse=function(t){for(var e=0;e<t.childNodes.length;e++){var r=t.childNodes[e];if(1===r.nodeType)switch(r.nodeName){case"profile_COMMON":this.parseProfileCommon(r)}}return this},e.prototype.parseProfileCommon=function(t){for(var e=0;e<t.childNodes.length;e++){var r=t.childNodes[e];if(1===r.nodeType)switch(r.nodeName){case"newparam":this.parseNewparam(r);break;case"image":break;case"technique":this.parseTechnique(r)}}},e.prototype.parseNewparam=function(t){for(var e=t.getAttribute("sid"),r=0;r<t.childNodes.length;r++){var i=t.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"surface":var n=i.querySelector("init_from");n&&this.newParams.push({sid:e,type:"surface",initFrom:n.textContent});break;case"sampler2D":var o=i.querySelector("source");this.newParams.push({sid:e,type:"sampler2D",source:o.textContent});break;case"extra":}}},e.prototype.parseTechnique=function(t){for(var e=0;e<t.childNodes.length;e++){var r=t.childNodes[e];if(1===r.nodeType)switch(r.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.techniqueType=r.nodeName,this.parseTechniqueType(r);break;case"extra":}}},e.prototype.parseTechniqueType=function(e){for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType&&i.nodeName){var n=i.nodeName,o=t.getFirstChildElement(i);if(o)switch(o.nodeName){case"color":this[n]=t.bufferDataFloat32(o).subarray(0,4);break;case"float":this[n]=t.bufferDataFloat32(o)[0];break;case"texture":var a=o.getAttribute("texture"),s=this.newParams.map(function(t){return t.sid}).indexOf(a),l=this.newParams[s].source;s=this.newParams.map(function(t){return t.sid}).indexOf(l);var u=this.newParams[s].initFrom;this.textures||(this.textures={}),this.textures[n]={mapId:u}}}}},e}),i("../src/worldwind/formats/collada/ColladaMesh",["./ColladaUtils"],function(t){"use strict";var e=function(t){this.filename=t||"",this.name=t||"",this.buffers=[]};return e.prototype.parse=function(e){for(var r={},i={},n={id:"",inputs:[]},o=0;o<e.childNodes.length;o++){var a=e.childNodes[o];if(1===a.nodeType)switch(a.nodeName){case"source":if(!a.querySelector)continue;var s=a.querySelector("float_array");if(!s)continue;var l=t.bufferDataFloat32(s),u=a.querySelector("accessor"),c=parseInt(u.getAttribute("stride"));r[a.getAttribute("id")]={stride:c,data:l};break;case"vertices":this.parseVertices(a,n);break;case"triangles":i=this.parsePolygons(a,r,n,3),this.buffers.push(i);break;case"polygons":i=this.parsePolygons(a,r,n,4),this.buffers.push(i);break;case"polylist":i=this.parsePolygons(a,r,n,null),this.buffers.push(i)}}return this},e.prototype.parseVertices=function(t,e){e.id=t.getAttribute("id");for(var r=t.querySelectorAll("input"),i=0;i<r.length;i++){var n=r[i],o=n.getAttribute("source").substr(1),a=n.getAttribute("semantic").toUpperCase();e.inputs.push({semantic:a,source:o})}},e.prototype.parsePolygons=function(t,e,r,i){var n=[];if(null==i){var o=t.querySelector("vcount");n=o.textContent.trim().split(" ")}var a=parseInt(t.getAttribute("count")),s=t.getAttribute("material"),l=this.parseInputs(t,e,r),u=l.inputs,c=l.maxOffset,h=t.querySelector("p"),f=[];h&&(f=h.textContent.trim().split(" "));for(var d=u.length,p=0,m={},g=[],y=0,v=!1,E=0;a>E;E++){if(n.length)var w=parseInt(n[E]);else w=i;for(var b=-1,x=-1,_=-1,S=0;w>S;S++){var T=f.slice(y,y+c).join(" ");if(_=x,m.hasOwnProperty(T))x=m[T],v=!0;else{for(var L=0;d>L;L++){var M=u[L],A=M[4],N=parseInt(f[y+A]),R=M[1],C=M[3];N*=M[2];for(var P=0;P<M[2];P++)R.push(C[N+P])}x=p,p+=1,m[T]=x}w>3&&(0===S&&(b=x),S>2*c&&(g.push(b),g.push(_))),g.push(x),y+=c}}var O={vertices:new Float32Array(u[0][1]),indexedRendering:v,material:s};return this.transformMeshInfo(O,u,g),O},e.prototype.parseInputs=function(t,e,r){for(var i=[],n=0,o=t.querySelectorAll("input"),a=0;a<o.length;a++){var s=o.item(a);if(s.getAttribute){var l=s.getAttribute("semantic").toUpperCase(),u=s.getAttribute("source").substr(1),c=parseInt(s.getAttribute("offset"));n=c+1>n?c+1:n;var h=0;if(s.getAttribute("set")&&(h=parseInt(s.getAttribute("set"))),r.id===u)for(var f=r.inputs,d=0;d<f.length;d++){var p=e[f[d].source];p&&i.push([f[d].semantic,[],p.stride,p.data,c,h])}else p=e[u],i.push([l,[],p.stride,p.data,c,h])}}return{inputs:i,maxOffset:n}},e.prototype.transformMeshInfo=function(e,r,i){for(var n={normal:"normals",texcoord:"uvs"},o=1;o<r.length;o++){var a=r[o][0].toLowerCase(),s=r[o][1];s.length&&(n[a]&&(a=n[a]),e[a]&&(a+=r[o][5]),e[a]=new Float32Array(s),"uvs"===a&&(e.isClamp=t.getTextureType(s)))}return e.indexedRendering&&(e.indices=new Uint16Array(i)),e},e}),i("../src/worldwind/formats/collada/ColladaNode",["./ColladaUtils","../../geom/Matrix","../../geom/Vec3"],function(t,e,r){"use strict";var i=function(){this.id="",this.name="",this.sid="",this.children=[],this.materials=[],this.mesh="",this.localMatrix=e.fromIdentity(),this.worldMatrix=e.fromIdentity()};return i.prototype.parse=function(t,r,n){this.id=t.getAttribute("id"),this.sid=t.getAttribute("sid"),this.name=t.getAttribute("name"),this.children=[],this.materials=[],this.mesh="",this.localMatrix=e.fromIdentity(),this.worldMatrix=e.fromIdentity(),this.setNodeTransforms(t,n);for(var o=0;o<t.childNodes.length;o++){var a=t.childNodes[o];if(1===a.nodeType)switch(a.nodeName){case"node":this.children.push((new i).parse(a,r,this.worldMatrix));break;case"instance_geometry":this.mesh=a.getAttribute("url").substr(1);for(var s=a.querySelectorAll("instance_material"),l=0;l<s.length;l++){var u=s.item(l);this.materials.push({id:u.getAttribute("target").substr(1),symbol:u.getAttribute("symbol")})}break;case"instance_node":var c=a.getAttribute("url").substr(1),h=this.getLibraryNode(r,c);h&&this.children.push((new i).parse(h,r,this.worldMatrix))}}return this},i.prototype.setNodeTransforms=function(i,n){var o=e.fromIdentity(),a=e.fromIdentity(),s=e.fromIdentity(),l=e.fromIdentity();n||(n=e.fromIdentity());for(var u=[],c=0;c<i.childNodes.length;c++){var h=i.childNodes[c];if(1===h.nodeType)switch(h.nodeName){case"matrix":var f=t.bufferDataFloat32(h);o.copy(f),u.push(o);break;case"rotate":f=t.bufferDataFloat32(h),a.multiplyByRotation(f[0],f[1],f[2],f[3]),u.push(a);break;case"translate":f=t.bufferDataFloat32(h),s.multiplyByTranslation(f[0],f[1],f[2]),u.push(s);break;case"scale":f=t.bufferDataFloat32(h),l.multiplyByScale(f[0],f[1],f[2]),u.push(l)}}for(c=0;c<u.length;c++)this.localMatrix.multiplyMatrix(u[c]);this.worldMatrix.setToMultiply(n,this.localMatrix),this.normalMatrix=e.fromIdentity();var d=new r(0,0,0);this.worldMatrix.extractRotationAngles(d),this.normalMatrix.multiplyByRotation(-1,0,0,d[0]),this.normalMatrix.multiplyByRotation(0,-1,0,d[1]),this.normalMatrix.multiplyByRotation(0,0,-1,d[2])},i.prototype.getLibraryNode=function(t,e){for(var r=0;r<t.length;r++){var i=t[r].attributes.getNamedItem("id");if(i&&i.value===e)return t[r]}return null},i}),i("../src/worldwind/formats/collada/ColladaScene",["../../error/ArgumentError","../../shaders/BasicTextureProgram","../../util/Color","../../util/Logger","../../geom/Matrix","../../geom/Position","../../pick/PickedObject","../../render/Renderable","../../geom/Vec3"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"ColladaScene","constructor","missingPosition"));s.call(this),this._position=e,this._nodes=[],this._meshes={},this._materials={},this._images={},this._upAxis="",this._dirPath="",this._xRotation=0,this._yRotation=0,this._zRotation=0,this._xTranslation=0,this._yTranslation=0,this._zTranslation=0,this._scale=1,this._altitudeMode=WorldWind.ABSOLUTE,this._localTransforms=!0,this._useTexturePaths=!0,this._nodesToHide=[],
this._hideNodes=!1,this.setSceneData(r),this._placePoint=new l(0,0,0),this._transformationMatrix=n.fromIdentity(),this._normalMatrix=n.fromIdentity(),this._texCoordMatrix=n.fromIdentity().setToUnitYFlip(),this._activeTexture=null};return u.prototype=Object.create(s.prototype),u.prototype.constructor=u,Object.defineProperties(u.prototype,{position:{get:function(){return this._position},set:function(t){this._position=t}},nodes:{get:function(){return this._nodes},set:function(t){this._nodes=t}},meshes:{get:function(){return this._meshes},set:function(t){this._meshes=t}},materials:{get:function(){return this._materials},set:function(t){this._materials=t}},images:{get:function(){return this._images},set:function(t){this._images=t}},upAxis:{get:function(){return this._upAxis},set:function(t){this._upAxis=t}},dirPath:{get:function(){return this._dirPath},set:function(t){this._dirPath=t}},xRotation:{get:function(){return this._xRotation},set:function(t){this._xRotation=t}},yRotation:{get:function(){return this._yRotation},set:function(t){this._yRotation=t}},zRotation:{get:function(){return this._zRotation},set:function(t){this._zRotation=t}},xTranslation:{get:function(){return this._xTranslation},set:function(t){this._xTranslation=t}},yTranslation:{get:function(){return this._yTranslation},set:function(t){this._yTranslation=t}},zTranslation:{get:function(){return this._zTranslation},set:function(t){this._zTranslation=t}},scale:{get:function(){return this._scale},set:function(t){this._scale=t}},placePoint:{get:function(){return this._placePoint},set:function(t){this._placePoint=t}},altitudeMode:{get:function(){return this._altitudeMode},set:function(t){this._altitudeMode=t}},transformationMatrix:{get:function(){return this._transformationMatrix},set:function(t){this._transformationMatrix=t}},normalMatrix:{get:function(){return this._normalMatrix},set:function(t){this._normalMatrix=t}},localTransforms:{get:function(){return this._localTransforms},set:function(t){this._localTransforms=t}},useTexturePaths:{get:function(){return this._useTexturePaths},set:function(t){this._useTexturePaths=t}},nodesToHide:{get:function(){return this._nodesToHide},set:function(t){this._nodesToHide=t}},hideNodes:{get:function(){return this._hideNodes},set:function(t){this._hideNodes=t}}}),u.prototype.setSceneData=function(t){t&&(this.nodes=t.root.children,this.meshes=t.meshes,this.materials=t.materials,this.images=t.images,this.upAxis=t.metadata.up_axis,this.dirPath=t.dirPath)},u.prototype.render=function(t){var e;this.enabled&&(this.lastFrameTime!==t.timestamp&&(e=this.makeOrderedRenderable(t)),e&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e)))},u.prototype.makeOrderedRenderable=function(t){return t.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint),this.eyeDistance=t.navigatorState.eyePoint.distanceTo(this.placePoint),this},u.prototype.renderOrdered=function(t){if(this.drawOrderedScene(t),t.pickingMode){var e=new a(this.pickColor.clone(),this,this.position,this.layer,!1);t.resolvePick(e)}},u.prototype.drawOrderedScene=function(t){this.beginDrawing(t);try{this.doDrawOrderedScene(t)}finally{this.endDrawing(t)}},u.prototype.beginDrawing=function(t){var r=t.currentGlContext;t.findAndBindProgram(e),r.enable(r.CULL_FACE),r.enable(r.DEPTH_TEST)},u.prototype.doDrawOrderedScene=function(t){t.pickingMode&&(this.pickColor=t.uniquePickColor()),this.computeTransformationMatrix(t.globe);for(var e=0,r=this.nodes.length;r>e;e++)this.traverseNodeTree(t,this.nodes[e])},u.prototype.traverseNodeTree=function(t,e){var r=this.mustRenderNode(e.id);if(r){if(e.mesh)for(var i=e.mesh,n=this.meshes[i].buffers,o=0,a=n.length;a>o;o++){for(var s=n[o].material,l=0;l<e.materials.length;l++)if(s===e.materials[l].symbol){var u=e.materials[l].id;break}var c=this.materials[u];this.draw(t,n[o],c,e.worldMatrix,e.normalMatrix)}for(var h=0;h<e.children.length;h++)this.traverseNodeTree(t,e.children[h])}},u.prototype.draw=function(t,e,r,i,n){var o=t.currentGlContext,a=t.currentProgram;this.applyVertices(t,e),a.loadTextureEnabled(o,!1),this.applyColor(t,r);var s=r&&null!=r.textures&&e.uvs&&e.uvs.length>0;s&&this.applyTexture(t,e,r);var l=null!=e.normals&&e.normals.length>0;l&&!t.pickingMode&&this.applyLighting(t,e),this.applyMatrix(t,l,s,i,n),e.indexedRendering?(this.applyIndices(t,e),o.drawElements(o.TRIANGLES,e.indices.length,o.UNSIGNED_SHORT,0)):o.drawArrays(o.TRIANGLES,0,Math.floor(e.vertices.length/3)),this.resetDraw(t,l,s)},u.prototype.applyVertices=function(t,e){var r,i=t.currentGlContext,n=t.currentProgram;e.verticesVboCacheKey||(e.verticesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(e.verticesVboCacheKey),r||(r=i.createBuffer(),t.gpuResourceCache.putResource(e.verticesVboCacheKey,r,e.vertices.length),e.refreshVertexBuffer=!0),i.bindBuffer(i.ARRAY_BUFFER,r),e.refreshVertexBuffer&&(i.bufferData(i.ARRAY_BUFFER,e.vertices,i.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),e.refreshVertexBuffer=!1),i.enableVertexAttribArray(n.vertexPointLocation),i.vertexAttribPointer(n.vertexPointLocation,3,i.FLOAT,!1,0,0)},u.prototype.applyColor=function(t,e){var i=t.currentGlContext,n=t.currentProgram;if(e)if("constant"===e.techniqueType)var o=e.reflective;else o=e.diffuse;var a,s=1,l=1,u=1,c=1;o&&(s=o[0],l=o[1],u=o[2],c=null!=o[3]?o[3]:1);var h=new r(s,l,u,c);a=c*t.currentLayer.opacity,i.depthMask(a>=1||t.pickingMode),n.loadColor(i,t.pickingMode?this.pickColor:h),n.loadOpacity(i,t.pickingMode?a>0?1:0:a)},u.prototype.applyTexture=function(t,e,r){var i,n,o,a=t.currentGlContext,s=t.currentProgram;if(r.textures.diffuse)var l=r.textures.diffuse.mapId;else l=r.textures.reflective.mapId;var u=this.useTexturePaths?this.images[l].path:this.images[l].filename;this._activeTexture=t.gpuResourceCache.resourceForKey(this.dirPath+u+""),this._activeTexture||(o=e.isClamp?a.CLAMP_TO_EDGE:a.REPEAT,this._activeTexture=t.gpuResourceCache.retrieveTexture(a,this.dirPath+u+"",o)),i=this._activeTexture&&this._activeTexture.bind(t),i&&(e.texCoordsVboCacheKey||(e.texCoordsVboCacheKey=t.gpuResourceCache.generateCacheKey()),n=t.gpuResourceCache.resourceForKey(e.texCoordsVboCacheKey),n||(n=a.createBuffer(),t.gpuResourceCache.putResource(e.texCoordsVboCacheKey,n,e.uvs.length),e.refreshTexCoordBuffer=!0),a.bindBuffer(a.ARRAY_BUFFER,n),e.refreshTexCoordBuffer&&(a.bufferData(a.ARRAY_BUFFER,e.uvs,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),e.refreshTexCoordBuffer=!1),s.loadTextureEnabled(a,!0),a.enableVertexAttribArray(s.vertexTexCoordLocation),a.vertexAttribPointer(s.vertexTexCoordLocation,2,a.FLOAT,!1,0,0),s.loadTextureUnit(a,a.TEXTURE0),s.loadModulateColor(a,t.pickingMode))},u.prototype.applyLighting=function(t,e){var r,i=t.currentGlContext,n=t.currentProgram;n.loadApplyLighting(i,!0),e.normalsVboCacheKey||(e.normalsVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(e.normalsVboCacheKey),r||(r=i.createBuffer(),t.gpuResourceCache.putResource(e.normalsVboCacheKey,r,e.normals.length),e.refreshNormalBuffer=!0),i.bindBuffer(i.ARRAY_BUFFER,r),e.refreshNormalBuffer&&(i.bufferData(i.ARRAY_BUFFER,e.normals,i.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),e.refreshNormalBuffer=!1),i.enableVertexAttribArray(n.normalVectorLocation),i.vertexAttribPointer(n.normalVectorLocation,3,i.FLOAT,!1,0,0)},u.prototype.applyMatrix=function(t,e,r,i,o){var a=n.fromIdentity();if(a.copy(t.navigatorState.modelviewProjection),a.multiplyMatrix(this.transformationMatrix),i&&this.localTransforms&&a.multiplyMatrix(i),e&&!t.pickingMode){var s=n.fromIdentity();s.copy(t.navigatorState.modelviewNormalTransform),s.multiplyMatrix(this.normalMatrix),o&&this.localTransforms&&s.multiplyMatrix(o),t.currentProgram.loadModelviewInverse(t.currentGlContext,s)}r&&this._activeTexture&&(t.currentProgram.loadTextureMatrix(t.currentGlContext,this._texCoordMatrix),this._activeTexture=null),t.currentProgram.loadModelviewProjection(t.currentGlContext,a)},u.prototype.applyIndices=function(t,e){var r,i=t.currentGlContext;e.indicesVboCacheKey||(e.indicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(e.indicesVboCacheKey),r||(r=i.createBuffer(),t.gpuResourceCache.putResource(e.indicesVboCacheKey,r,e.indices.length),e.refreshIndicesBuffer=!0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r),e.refreshIndicesBuffer&&(i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.indices,i.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),e.refreshIndicesBuffer=!1)},u.prototype.resetDraw=function(t,e,r){var i=t.currentGlContext,n=t.currentProgram;e&&!t.pickingMode&&(n.loadApplyLighting(i,!1),i.disableVertexAttribArray(n.normalVectorLocation)),r&&i.disableVertexAttribArray(n.vertexTexCoordLocation),i.disableVertexAttribArray(n.vertexPointLocation)},u.prototype.endDrawing=function(t){t.bindProgram(null)},u.prototype.computeTransformationMatrix=function(t){this.transformationMatrix=n.fromIdentity(),this.transformationMatrix.multiplyByLocalCoordinateTransform(this.placePoint,t),this.transformationMatrix.multiplyByRotation(1,0,0,this.xRotation),this.transformationMatrix.multiplyByRotation(0,1,0,this.yRotation),this.transformationMatrix.multiplyByRotation(0,0,1,this.zRotation),this.transformationMatrix.multiplyByScale(this.scale,this.scale,this.scale),this.transformationMatrix.multiplyByTranslation(this.xTranslation,this.yTranslation,this.zTranslation),this.computeNormalMatrix()},u.prototype.computeNormalMatrix=function(){var t=new l(0,0,0);this.transformationMatrix.extractRotationAngles(t),this.normalMatrix=n.fromIdentity(),this.normalMatrix.multiplyByRotation(-1,0,0,t[0]),this.normalMatrix.multiplyByRotation(0,-1,0,t[1]),this.normalMatrix.multiplyByRotation(0,0,-1,t[2])},u.prototype.mustRenderNode=function(t){var e=!0;if(this.hideNodes){var r=this.nodesToHide.indexOf(t);e=-1===r}return e},u}),i("../src/worldwind/formats/collada/ColladaLoader",["../../error/ArgumentError","./ColladaAsset","./ColladaImage","./ColladaMaterial","./ColladaMesh","./ColladaNode","./ColladaScene","./ColladaUtils","../../util/Logger"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(e,r){if(!e)throw new t(l.logMessage(l.LEVEL_SEVERE,"ColladaLoader","constructor","missingPosition"));this.position=e,this.dirPath="/",this.init(r)};return u.prototype.init=function(t){t&&(this.dirPath=t.dirPath||"/"),this.scene={type:"SceneTree",dirPath:this.dirPath,images:{},metadata:{},materials:{},meshes:{},root:{children:[]}},this.xmlDoc=null},u.prototype.load=function(t,e){-1===t.indexOf("://")&&(t=this.dirPath+t),s.fetchFile(t,function(t){if(t)try{i=this.parse(t)}catch(r){i=null,l.log(l.LEVEL_SEVERE,"error parsing collada file: "+r)}else var i=null;e(i)}.bind(this))},u.prototype.parse=function(t){this.init();var r=new DOMParser;this.xmlDoc=r.parseFromString(t,"text/xml");var i=this.xmlDoc.querySelectorAll("library_nodes node"),n=this.xmlDoc.querySelectorAll("library_effects effect");return this.scene.metadata=new e(this.xmlDoc).parse(),this.parseLib("visual_scene",i),this.parseLib("library_geometries"),this.parseLib("library_materials",n),this.parseLib("library_images"),this.xmlDoc=null,new a(this.position,this.scene)},u.prototype.parseLib=function(t,e){var a=this.xmlDoc.getElementsByTagName(t),l=[];a&&a.length&&(l=a[0].childNodes);for(var u=0;u<l.length;u++){var c=l[u];if(1===c.nodeType)switch(c.nodeName){case"node":var h=(new o).parse(c,e);h&&this.scene.root.children.push(h);break;case"geometry":var f=c.getAttribute("id"),d=c.querySelector("mesh"),p=new n(f).parse(d);p&&(this.scene.meshes[f]=p);break;case"material":var m=c.getAttribute("id"),g=c.querySelector("instance_effect"),y=g.getAttribute("url").substr(1),v=s.querySelectorById(e,y),E=new i(m).parse(v);E&&(this.scene.materials[m]=E);break;case"image":var w=c.getAttribute("id"),b=c.getAttribute("name"),x=new r(w,b).parse(c);x&&(this.scene.images[w]=x)}}},u}),i("../src/worldwind/util/ImageSource",["../error/ArgumentError","../util/Color","../util/Logger"],function(t,e,r){"use strict";var i=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"ImageSource","constructor","missingImage"));this.image=e,this.key="ImageSource "+ ++i.keyPool};return i.keyPool=0,i}),i("../src/worldwind/shapes/ScreenImage",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/ImageSource","../util/Logger","../geom/Matrix","../util/Offset","../pick/PickedObject","../render/Renderable","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(e,i){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenImage","constructor","missingOffset"));if(!i)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenImage","constructor","missingImage"));l.call(this),this.screenOffset=e,this._imageSource=i,this.imageColor=r.WHITE,this.imageOffset=new a(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),this.imageScale=1,this.imageRotation=0,this.imageTilt=0,this.enabled=!0,this.opacity=1,this.pickDelegate=null,this.activeTexture=null,this.imageTransform=o.fromIdentity(),this.texCoordMatrix=o.fromIdentity(),this.imageBounds=null,this.layer=null};return h.matrix=o.fromIdentity(),h.prototype=Object.create(l.prototype),Object.defineProperties(h.prototype,{imageSource:{get:function(){return this._imageSource},set:function(e){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenImage","imageSource","missingImage"));this._imageSource=e,this.imageSourceWasUpdated=!0}}}),h.prototype.render=function(t){if(this.enabled&&t.accumulateOrderedRenderables){var e=null;this.lastFrameTime!==t.timestamp&&(e=this.makeOrderedRenderable(t)),e&&e.isVisible(t)&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e))}},h.prototype.renderOrdered=function(t){if(this.drawOrderedScreenImage(t),t.pickingMode){var e=new s(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);t.resolvePick(e)}},h.prototype.makeOrderedRenderable=function(t){var e,r,i,n,o,a,s;return this.activeTexture=this.getActiveTexture(t),this.activeTexture&&!this.imageSourceWasUpdated||(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this._imageSource),this.activeTexture)?(this.eyeDistance=0,e=this.activeTexture.imageWidth,r=this.activeTexture.imageHeight,i=this.imageScale,a=this.imageOffset.offsetForSize(e,r),n=t.navigatorState.viewport.width,o=t.navigatorState.viewport.height,s=this.screenOffset.offsetForSize(n,o),this.imageTransform.setTranslation(s[0]-a[0]*i,s[1]-a[1]*i,0),this.imageTransform.setScale(e*i,r*i,1),this.imageBounds=c.boundingRectForUnitQuad(this.imageTransform),this):null},h.prototype.getActiveTexture=function(t){return t.gpuResourceCache.resourceForKey(this._imageSource)},h.prototype.isVisible=function(t){return t.pickingMode?t.pickRectangle&&this.imageBounds.intersects(t.pickRectangle):this.imageBounds.intersects(t.navigatorState.viewport)},h.prototype.drawOrderedScreenImage=function(t){this.beginDrawing(t);try{this.doDrawOrderedScreenImage(t)}finally{this.endDrawing(t)}},h.prototype.beginDrawing=function(t){var r,i=t.currentGlContext;t.findAndBindProgram(e),r=t.currentProgram,i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer()),i.vertexAttribPointer(r.vertexTexCoordLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.vertexPointLocation),i.enableVertexAttribArray(r.vertexTexCoordLocation),r.loadTextureUnit(i,i.TEXTURE0),r.loadModulateColor(i,t.pickingMode),i.disable(i.DEPTH_TEST)},h.prototype.endDrawing=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.enable(e.DEPTH_TEST)},h.prototype.doDrawOrderedScreenImage=function(t){var e=t.currentGlContext,r=t.currentProgram;e.bindBuffer(e.ARRAY_BUFFER,t.unitQuadBuffer3()),e.vertexAttribPointer(r.vertexPointLocation,3,e.FLOAT,!1,0,0),h.matrix.copy(t.screenProjection),h.matrix.multiplyMatrix(this.imageTransform),h.matrix.multiplyByTranslation(.5,.5,.5),h.matrix.multiplyByRotation(1,0,0,this.imageTilt),h.matrix.multiplyByRotation(0,0,1,this.imageRotation),h.matrix.multiplyByTranslation(-.5,-.5,0),r.loadModelviewProjection(e,h.matrix),r.loadTextureEnabled(e,!0),t.pickingMode?(this.pickColor=t.uniquePickColor(),r.loadColor(e,this.pickColor)):(r.loadColor(e,this.imageColor),r.loadOpacity(e,this.opacity*this.layer.opacity)),this.texCoordMatrix.setToIdentity(),this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture),r.loadTextureMatrix(e,this.texCoordMatrix),this.activeTexture.bind(t)&&e.drawArrays(e.TRIANGLE_STRIP,0,4)},h}),i("../src/worldwind/shapes/Compass",["../error/ArgumentError","../util/Logger","../util/Offset","../shapes/ScreenImage"],function(t,e,r,i){"use strict";var n=function(t,e){var n=t?t:new r(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,1),o=e?e:WorldWind.configuration.baseUrl+"images/notched-compass.png";i.call(this,n,o),t||(this.imageOffset=new r(WorldWind.OFFSET_FRACTION,1.1,WorldWind.OFFSET_FRACTION,1.1)),this.size=.15};return n.prototype=Object.create(i.prototype),n.prototype.render=function(t){this.imageRotation=t.navigatorState.heading,this.imageTilt=t.navigatorState.tilt;var e=this.getActiveTexture(t);e&&(this.imageScale=this.size*t.currentGlContext.drawingBufferWidth/e.imageWidth),i.prototype.render.call(this,t)},n}),i("../src/worldwind/layer/CompassLayer",["../shapes/Compass","../layer/RenderableLayer"],function(t,e){"use strict";var r=function(){e.call(this,"Compass"),this._compass=new t(null,null),this.addRenderable(this._compass)};return r.prototype=Object.create(e.prototype),Object.defineProperties(r.prototype,{compass:{get:function(){return this._compass},set:function(e){e&&e instanceof t&&(this.removeAllRenderables(),this.addRenderable(e),this._compass=e)}}}),r}),i("../src/worldwind/shapes/Text",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Logger","../geom/Matrix","../pick/PickedObject","../render/Renderable","../shapes/TextAttributes","../error/UnsupportedOperationError","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f){"use strict";var d=function(e){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"Text","constructor","missingText"));s.call(this),this.attributes=new l(null),this.highlightAttributes=null,this.highlighted=!1,this.enabled=!0,this.text=e,this.altitudeMode=WorldWind.ABSOLUTE,this.pickDelegate=null,this.alwaysOnTop=!1,this.targetVisibility=1,this.currentVisibility=1,this.declutterGroup=0,this.markerImageSource=WorldWind.configuration.baseUrl+"images/white-dot.png",this.markerImageScale=.1,this.activeAttributes=null,this.activeTexture=null,this.imageTransform=o.fromIdentity(),this.texCoordMatrix=o.fromIdentity(),this.imageBounds=null,this.layer=null,this.depthOffset=-.003,this.screenPoint=new h(0,0,0)};return d.matrix=o.fromIdentity(),d.glPickPoint=new h(0,0,0),d.prototype=Object.create(s.prototype),d.prototype.copy=function(t){return this.text=t.text,this.attributes=t.attributes,this.highlightAttributes=t.highlightAttributes,this.highlighted=t.highlighted,this.enabled=t.enabled,this.altitudeMode=t.altitudeMode,this.pickDelegate=t.pickDelegate,this.alwaysOnTop=t.alwaysOnTop,this.depthOffset=t.depthOffset,this.declutterGroup=t.declutterGroup,this.targetVisibility=t.targetVisibility,this.currentVisibility=t.currentVisibility,this},Object.defineProperties(d.prototype,{screenBounds:{get:function(){return this.imageBounds}}}),d.prototype.render=function(t){if(this.enabled&&this.text&&0!==this.text.length&&t.accumulateOrderedRenderables){var e;if(this.lastFrameTime!=t.timestamp)e=this.makeOrderedRenderable(t);else{var r=this.clone();e=r.makeOrderedRenderable(t)}e&&e.isVisible(t)&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e))}},d.prototype.renderOrdered=function(t){if((0!==this.currentVisibility||0!==this.targetVisibility||this.markerImageSource)&&(this.drawOrderedText(t),t.pickingMode)){var e=new a(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,this.position,this.layer,!1);t.resolvePick(e)}},d.prototype.makeOrderedRenderable=function(t){var e,r,i,n;if(this.determineActiveAttributes(t),!this.activeAttributes)return null;if(!this.computeScreenPointAndEyeDistance(t))return null;var o=this.activeAttributes.font,a=this.text+o.toString();return this.activeTexture=t.gpuResourceCache.resourceForKey(a),this.activeTexture||(this.activeTexture=t.textSupport.createTexture(t,this.text,o,!0),t.gpuResourceCache.putResource(a,this.activeTexture,this.activeTexture.size)),e=this.activeTexture.imageWidth,r=this.activeTexture.imageHeight,i=this.activeAttributes.scale,n=this.activeAttributes.offset.offsetForSize(e,r),this.imageTransform.setTranslation(this.screenPoint[0]-n[0]*i,this.screenPoint[1]-n[1]*i,this.screenPoint[2]),this.imageTransform.setScale(e*i,r*i,1),this.imageBounds=f.boundingRectForUnitQuad(this.imageTransform),this},d.prototype.computeScreenPointAndEyeDistance=function(t){throw new u(n.logMessage(n.LEVEL_SEVERE,"Renderable","render","abstractInvocation"))},d.prototype.determineActiveAttributes=function(t){this.highlighted&&this.highlightAttributes?this.activeAttributes=this.highlightAttributes:this.activeAttributes=this.attributes},d.prototype.isVisible=function(t){return t.pickingMode?t.pickRectangle&&this.imageBounds.intersects(t.pickRectangle):this.imageBounds.intersects(t.navigatorState.viewport)},d.prototype.drawOrderedText=function(t){this.beginDrawing(t);try{this.doDrawOrderedText(t),!t.pickingMode}finally{this.endDrawing(t)}},d.prototype.drawBatchOrderedText=function(t){for(var e;(e=t.peekOrderedRenderable())&&e instanceof d;){t.popOrderedRenderable();try{e.doDrawOrderedText(t)}catch(r){n.logMessage(n.LEVEL_WARNING,"Text","drawBatchOrderedText","Error occurred while rendering text using batching: "+r.message)}}},d.prototype.beginDrawing=function(t){var r,i=t.currentGlContext;t.findAndBindProgram(e),r=t.currentProgram,i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer3()),i.vertexAttribPointer(r.vertexPointLocation,3,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer()),i.vertexAttribPointer(r.vertexTexCoordLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.vertexPointLocation),i.enableVertexAttribArray(r.vertexTexCoordLocation),r.loadTextureUnit(i,i.TEXTURE0),t.pickingMode&&r.loadTextureEnabled(i,!1),r.loadModulateColor(i,!1),i.depthMask(!1),d.currentTexture=null},d.prototype.endDrawing=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.depthMask(!0),d.currentTexture=null},d.prototype.doDrawOrderedText=function(t){var e,r=t.currentGlContext,i=t.currentProgram;if(t.pickingMode&&(this.pickColor=t.uniquePickColor()),!t.pickingMode&&this.currentVisibility!=this.targetVisibility){var n=(t.timestamp-t.previousRedrawTimestamp)/t.fadeTime;this.currentVisibility<this.targetVisibility?this.currentVisibility=Math.min(1,this.currentVisibility+n):this.currentVisibility=Math.max(0,this.currentVisibility-n),t.redrawRequested=!0}if(this.currentVisibility>0&&(d.matrix.copy(t.screenProjection),d.matrix.multiplyMatrix(this.imageTransform),i.loadModelviewProjection(r,d.matrix),t.pickingMode?(i.loadColor(r,this.pickColor),i.loadTextureEnabled(r,!1)):(i.loadColor(r,this.activeAttributes.color),i.loadOpacity(r,this.layer.opacity*this.currentVisibility),this.texCoordMatrix.setToIdentity(),this.activeTexture&&this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture),i.loadTextureMatrix(r,this.texCoordMatrix),this.activeTexture&&this.activeTexture!=d.currentTexture&&(e=this.activeTexture.bind(t),i.loadTextureEnabled(r,e),d.currentTexture=this.activeTexture)),this.activeAttributes.depthTest||r.disable(r.DEPTH_TEST,!1),r.drawArrays(r.TRIANGLE_STRIP,0,4),this.activeAttributes.depthTest||r.disable(r.DEPTH_TEST,!0)),this.currentVisibility<1&&this.markerImageSource){var a=t.gpuResourceCache.resourceForKey(this.markerImageSource);if(!a)return void t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.markerImageSource);var s=this.markerImageScale,l=o.fromIdentity();if(l.setTranslation(this.screenPoint[0]-s*a.imageWidth/2,this.screenPoint[1]-s*a.imageWidth/2,this.screenPoint[2]),l.setScale(a.imageWidth*s,a.imageHeight*s,1),d.matrix.copy(t.screenProjection),d.matrix.multiplyMatrix(l),i.loadModelviewProjection(r,d.matrix),t.pickingMode)i.loadColor(r,this.pickColor),i.loadTextureEnabled(r,!1);else{i.loadColor(r,this.activeAttributes.color),i.loadOpacity(r,this.layer.opacity*(1-this.currentVisibility));var u=o.fromIdentity();u.multiplyByTextureTransform(a),i.loadTextureMatrix(r,u),a!=d.currentTexture&&(e=a.bind(t),i.loadTextureEnabled(r,e),d.currentTexture=a)}this.activeAttributes.depthTest||r.disable(r.DEPTH_TEST,!1),r.drawArrays(r.TRIANGLE_STRIP,0,4),this.activeAttributes.depthTest||r.enable(r.DEPTH_TEST,!0)}},d}),i("../src/worldwind/shapes/ScreenText",["../error/ArgumentError","../util/Logger","../util/Offset","../shapes/Text"],function(t,e,r,i){"use strict";var n=function(r,n){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"Text","constructor","missingOffset"));i.call(this,n),this.screenOffset=r,this.altitudeMode=null};return n.prototype=Object.create(i.prototype),n.prototype.render=function(t){this.lastFrameTime!=t.timestamp&&i.prototype.render.call(this,t)},n.prototype.computeScreenPointAndEyeDistance=function(t){var e=t.currentGlContext,r=this.screenOffset.offsetForSize(e.drawingBufferWidth,e.drawingBufferHeight);return this.screenPoint[0]=r[0],this.screenPoint[1]=r[1],this.screenPoint[2]=0,this.eyeDistance=0,!0},n}),i("../src/worldwind/layer/CoordinatesDisplayLayer",["../error/ArgumentError","../util/Color","../util/Font","../layer/Layer","../util/Logger","../util/Offset","../geom/Position","../shapes/ScreenImage","../shapes/ScreenText","../shapes/TextAttributes","../geom/Vec2"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(r){function a(t){d.handleUIEvent(t)}function c(t,e){d.handleRedraw(e)}if(!r)throw new t(n.logMessage(n.LEVEL_SEVERE,"ViewControlsLayer","constructor","missingWorldWindow"));i.call(this,"Coordinates"),this.wwd=r,this.pickEnabled=!1,this.eventType=null,this.clientX=null,this.clientY=null,this.terrainPosition=null,this.latText=new l(new o(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.latText.attributes=new u(null),this.latText.attributes.color=e.YELLOW,this.lonText=new l(new o(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.lonText.attributes=new u(null),this.lonText.attributes.color=e.YELLOW,this.elevText=new l(new o(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.elevText.attributes=new u(null),this.elevText.attributes.color=e.YELLOW,this.eyeText=new l(new o(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.eyeText.attributes=new u(null),this.eyeText.attributes.color=e.YELLOW;var h=new o(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),f=WorldWind.configuration.baseUrl+"images/crosshair.png";this.crosshairImage=new s(h,f);var d=this;window.PointerEvent?(r.addEventListener("pointerdown",a),r.addEventListener("pointermove",a),r.addEventListener("pointerleave",a)):(r.addEventListener("mousedown",a),r.addEventListener("mousemove",a),r.addEventListener("mouseleave",a),r.addEventListener("touchstart",a),r.addEventListener("touchmove",a)),this.wwd.redrawCallbacks.push(c)};return h.prototype=Object.create(i.prototype),h.prototype.doRender=function(t){var e,r,i,n,a,s=this.terrainPosition,l=t.eyePosition,u=t.currentGlContext.canvas.clientWidth;u>650?(e=u/2-50,r=5,i=WorldWind.OFFSET_PIXELS,n=0):u>400?(e=60,r=5,i=WorldWind.OFFSET_INSET_PIXELS,n=1):(e=60,r=5,i=WorldWind.OFFSET_INSET_PIXELS,n=1,a=!0),this.latText.text=s?this.formatLatitude(s.latitude):null,this.latText.screenOffset=new o(WorldWind.OFFSET_PIXELS,e,i,r),this.latText.attributes.offset=new o(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,n),this.latText.render(t),e+=70,this.lonText.text=s?this.formatLongitude(s.longitude):null,this.lonText.screenOffset=new o(WorldWind.OFFSET_PIXELS,e,i,r),this.lonText.attributes.offset=new o(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,n),this.lonText.render(t),t.globe.is2D()||(e+=70,this.elevText.text=s?this.formatAltitude(s.altitude,"m"):null,this.elevText.screenOffset=new o(WorldWind.OFFSET_PIXELS,e,i,r),this.elevText.attributes.offset=new o(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,n),this.elevText.render(t)),a||(e+=40,this.eyeText.text="Eye  "+this.formatAltitude(l.altitude,l.altitude<1e3?"m":"km"),this.eyeText.screenOffset=new o(WorldWind.OFFSET_PIXELS,e,i,r),this.eyeText.attributes.offset=new o(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,n),this.eyeText.render(t)),"touch"==this.eventType&&this.crosshairImage.render(t),this.inCurrentFrame=!0},h.prototype.handleUIEvent=function(t){-1!=t.type.indexOf("pointer")?this.eventType=t.pointerType:-1!=t.type.indexOf("mouse")?this.eventType="mouse":-1!=t.type.indexOf("touch")&&(this.eventType="touch"),-1!=t.type.indexOf("leave")?(this.clientX=null,this.clientY=null):(this.clientX=t.clientX,this.clientY=t.clientY),this.wwd.redraw()},h.prototype.handleRedraw=function(t){if(t==WorldWind.BEFORE_REDRAW){var e,r;("mouse"==this.eventType||"pen"==this.eventType)&&this.clientX&&this.clientY?(e=this.wwd.canvasCoordinates(this.clientX,this.clientY),e[0]>=0&&e[0]<this.wwd.canvas.width&&e[1]>=0&&e[1]<this.wwd.canvas.height&&(r=this.wwd.pickTerrain(e).terrainObject())):"touch"==this.eventType&&(e=new c(this.wwd.canvas.width/2,this.wwd.canvas.height/2),r=this.wwd.pickTerrain(e).terrainObject()),this.terrainPosition=r?r.position:null}},h.prototype.formatLatitude=function(t){var e=0>t?"°S":"°N";return Math.abs(t).toFixed(2)+e},h.prototype.formatLongitude=function(t){var e=0>t?"°W":"°E";return Math.abs(t).toFixed(2)+e},h.prototype.formatAltitude=function(t,e){return"km"===e&&(t/=1e3),t.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")+" "+e},h}),i("../src/worldwind/util/Date",[],function(){"use strict";var t=function(t){t?this._date=new Date(t):this._date=new Date};return t.prototype=Object.create(Date.prototype),t.prototype.isAfter=function(t){return-1==this.compare(t)},t.prototype.isBefore=function(t){return 1==this.compare(t)},t.prototype.valueOf=function(){return this._date.valueOf()},t.prototype.getTime=function(){return this._date.getTime()},t.prototype.compare=function(t){var e=this._date.valueOf(),r=t.valueOf();return e>r?-1:r>e?1:0},t}),i("../src/worldwind/layer/DigitalGlobeTiledImageLayer",["../geom/Angle","../error/ArgumentError","../util/Color","../geom/Location","../util/Logger","../geom/Sector","../layer/MercatorTiledImageLayer"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,s){if(!r)throw new e(n.logMessage(n.LEVEL_SEVERE,"DigitalGlobeTiledImageLayer","constructor","The map ID is null or undefined."));if(!s)throw new e(n.logMessage(n.LEVEL_SEVERE,"DigitalGlobeTiledImageLayer","constructor","The access token is null or undefined."));this.imageSize=256,t=t||"Digital Globe",a.call(this,new o(-85.05,85.05,-180,180),new i(85.05,180),19,"image/jpeg",t,this.imageSize,this.imageSize),this.mapId=r,this.accessToken=s,this.displayName=t,this.pickEnabled=!1,this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d"),this.requestMetadata();var l=this;this.urlBuilder={urlForTile:function(t,e){return l.metadataRetrievalInProcess?null:l.urlTemplate.replace("{z}",t.level.levelNumber+1).replace("{x}",t.column).replace("{y}",t.row)}}};return s.prototype=Object.create(a.prototype),s.prototype.requestMetadata=function(){if(!this.metadataRetrievalInProcess){this.metadataRetrievalInProcess=!0;var t="https://api.mapbox.com/v4/"+this.mapId+".json?secure&access_token="+this.accessToken,e=new XMLHttpRequest,r=this;
e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){var t=JSON.parse(e.responseText);r.urlTemplate=t.tiles[0];var i=document.createEvent("Event");i.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(i),r.metadataRetrievalInProcess=!1}},e.open("GET",t,!0),e.send()}},s.prototype.doRender=function(t){a.prototype.doRender.call(this,t),this.inCurrentFrame&&t.screenCreditController.addStringCredit("© Digital Globe",r.DARK_GRAY)},s.prototype.createTopLevelTiles=function(t){this.topLevelTiles=[],this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))},s.prototype.mapSizeForLevel=function(t){return 256<<t+1},s}),i("../src/worldwind/util/FrameStatistics",[],function(){"use strict";var t=function(){this.frameCount=0,this.frameTimeCumulative=0,this.frameTimeBase=0,this.frameTimeExtremes=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],this.frameTime=0,this.tessellationTime=0,this.layerRenderingTime=0,this.orderedRenderingTime=0,this.terrainTileCount=0,this.imageTileCount=0,this.renderedTileCount=0,this.tileUpdateCount=0,this.textureLoadCount=0,this.vboLoadCount=0,this.frameTimeAverage=0,this.frameRateAverage=0,this.frameTimeMin=0,this.frameTimeMax=0};return t.prototype.beginFrame=function(){this.frameTime=Date.now(),this.tessellationTime=0,this.layerRenderingTime=0,this.orderedRenderingTime=0,this.terrainTileCount=0,this.imageTileCount=0,this.renderedTileCount=0,this.tileUpdateCount=0,this.textureLoadCount=0,this.vboLoadCount=0,++this.frameCount},t.prototype.endFrame=function(){var t=Date.now();this.frameTime=t-this.frameTime,this.frameTimeCumulative+=this.frameTime,this.frameTimeExtremes[0]=Math.min(this.frameTimeExtremes[0],this.frameTime),this.frameTimeExtremes[1]=Math.max(this.frameTimeExtremes[1],this.frameTime),t-this.frameTimeBase>2e3&&(this.frameTimeAverage=this.frameTimeCumulative/this.frameCount,this.frameRateAverage=1e3*this.frameCount/(t-this.frameTimeBase),this.frameTimeMin=this.frameTimeExtremes[0],this.frameTimeMax=this.frameTimeExtremes[1],this.frameCount=0,this.frameTimeCumulative=0,this.frameTimeBase=t,this.frameTimeExtremes=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY])},t.prototype.incrementRenderedTileCount=function(t){this.renderedTileCount+=t},t.prototype.setTerrainTileCount=function(t){this.terrainTileCount=t},t.prototype.incrementImageTileCount=function(t){this.imageTileCount=t},t.prototype.incrementTileUpdateCount=function(t){this.tileUpdateCount+=t},t.prototype.incrementTextureLoadCount=function(t){this.textureLoadCount+=t},t.prototype.incrementVboLoadCount=function(t){this.vboLoadCount+=t},t}),i("../src/worldwind/render/FramebufferTexture",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(t,e){"use strict";var r=function(r,i,n,o){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"FramebufferTexture","constructor","missingGlContext"));if(0>i||0>n)throw new t(e.logMessage(e.LEVEL_SEVERE,"FramebufferTexture","constructor","The framebuffer width or height is less than zero."));this.width=i,this.height=n,this.depth=o,this.size=i*n*4+(o?i*n*2:0),this.framebufferId=r.createFramebuffer(),r.bindFramebuffer(r.FRAMEBUFFER,this.framebufferId),this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i,n,0,r.RGBA,r.UNSIGNED_BYTE,null),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.texture,0),this.depthBuffer=null,o&&(this.depthBuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,this.depthBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,i,n),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this.depthBuffer));var a=r.checkFramebufferStatus(r.FRAMEBUFFER);a!=r.FRAMEBUFFER_COMPLETE&&(e.logMessage(e.LEVEL_WARNING,"FramebufferTexture","constructor","Error creating framebuffer: "+a),this.framebufferId=null,this.texture=null,this.depthBuffer=null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindTexture(r.TEXTURE_2D,null)};return r.prototype.bind=function(t){return this.texture&&t.currentGlContext.bindTexture(gl.TEXTURE_2D,this.texture),!!this.texture},r}),i("../src/worldwind/render/FramebufferTile",["../error/ArgumentError","../render/FramebufferTexture","../util/Logger","../geom/Matrix","../geom/Rectangle","../render/TextureTile"],function(t,e,r,i,n,o){"use strict";var a=function(e,n,a,s,l){if(!l||l.length<1)throw new t(r.logMessage(r.LEVEL_SEVERE,"FramebufferTile","constructor","The specified cache name is null, undefined or zero length."));o.call(this,e,n,a,s),this.gpuCacheKey=l,this.textureTransform=i.fromIdentity().setToUnitYFlip(),this.mustClear=!0};return a.prototype=Object.create(o.prototype),a.prototype.clearFramebuffer=function(t){this.mustClear=!0},a.prototype.bindFramebuffer=function(t){var e=t.gpuResourceCache.resourceForKey(this.gpuCacheKey);return e||(e=this.createFramebuffer(t)),t.bindFramebuffer(e),this.mustClear&&(this.doClearFramebuffer(t),this.mustClear=!1),!0},a.prototype.createFramebuffer=function(t){var r=new e(t.currentGlContext,this.tileWidth,this.tileHeight,!1);return t.gpuResourceCache.putResource(this.gpuCacheKey,r,r.size),r},a.prototype.doClearFramebuffer=function(t){var e=t.currentGlContext;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},a.prototype.applyInternalTransform=function(t,e){e.multiplyMatrix(this.textureTransform)},a}),i("../src/worldwind/render/FramebufferTileController",["../error/ArgumentError","../render/FramebufferTile","../util/LevelSet","../geom/Location","../util/Logger","../cache/MemoryCache","../geom/Sector","../util/Tile"],function(t,e,r,i,n,o,a,s){"use strict";var l=function(){this.tileWidth=256,this.tileHeight=256,this.detailControl=1.75,this.levels=new r(a.FULL_SPHERE,new i(45,45),16,this.tileWidth,this.tileHeight),this.topLevelTiles=[],this.currentTiles=[],this.currentTimestamp=null,this.currentGlobeStateKey=null,this.tileCache=new o(5e5,4e5),this.key="FramebufferTileController "+ ++l.keyPool};return l.keyPool=0,l.prototype.selectTiles=function(e,r){if(!r)throw new t(n.logMessage(n.LEVEL_SEVERE,"FramebufferTileController","selectTiles","missingSector"));this.assembleTiles(e);for(var i=[],o=0,a=this.currentTiles.length;a>o;o++){var s=this.currentTiles[o];s.sector.overlaps(r)&&(s.selected=!0,i.push(s))}return i},l.prototype.render=function(t){if(0!=this.currentTiles.length){for(var e=[],r=0,i=this.currentTiles.length;i>r;r++){var n=this.currentTiles[r];n.selected&&e.push(n)}t.surfaceTileRenderer.renderTiles(t,e,1);var o=t.currentGlContext,a=t.currentFramebuffer;try{for(o.clearColor(0,0,0,0),r=0,i=e.length;i>r;r++)n=e[r],n.selected=!1,n.bindFramebuffer(t),o.clear(o.COLOR_BUFFER_BIT)}finally{t.bindFramebuffer(a)}}},l.prototype.assembleTiles=function(t){var e=t.timestamp,r=t.globeStateKey;(this.currentTimestamp!=e||this.currentGlobeStateKey!=r)&&(this.doAssembleTiles(t),this.currentTimestamp=e,this.currentGlobeStateKey=r)},l.prototype.doAssembleTiles=function(t){if(this.currentTiles=[],t.terrain){0==this.topLevelTiles.length&&this.createTopLevelTiles();for(var e=0,r=this.topLevelTiles.length;r>e;e++){var i=this.topLevelTiles[e];i.update(t),this.isTileVisible(t,i)&&this.addTileOrDescendants(t,i)}}},l.prototype.createTile=function(t,r,i,n){var o=this.key+" "+r.levelNumber+"."+i+"."+n;return new e(t,r,i,n,o)},l.prototype.createTopLevelTiles=function(){s.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)},l.prototype.addTileOrDescendants=function(t,e){if(this.tileMeetsRenderingCriteria(t,e))return void this.addTile(e);for(var r=e.subdivideToCache(e.level.nextLevel(),this,this.tileCache),i=0,n=r.length;n>i;i++){var o=r[i];o.update(t),this.isTileVisible(t,o)&&this.addTileOrDescendants(t,o)}},l.prototype.addTile=function(t){this.currentTiles.push(t)},l.prototype.isTileVisible=function(t,e){return t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits)?!1:t.pickingMode?e.extent.intersectsFrustum(t.pickFrustum):e.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)},l.prototype.tileMeetsRenderingCriteria=function(t,e){var r=this.detailControl;return(e.sector.minLatitude>=75||e.sector.maxLatitude<=-75)&&(r*=1.2),e.level.isLastLevel()||!e.mustSubdivide(t,r)},l}),i("../src/worldwind/globe/ElevationImage",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(t,e,r){"use strict";var i=function(r,i,n,o){if(!r||r.length<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","constructor","The specified image path is null, undefined or zero length."));if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","constructor","missingSector"));this.sector=i,this.imagePath=r,this.imageWidth=n,this.imageHeight=o,this.size=this.imageWidth*this.imageHeight};return i.prototype.pixel=function(t,e){return 0>t||t>=this.imageWidth?0:0>e||e>=this.imageHeight?0:(e=this.imageHeight-e-1,this.imageData[t+e*this.imageWidth])},i.prototype.elevationAtLocation=function(t,e){var i=this.sector.maxLatitude,n=this.sector.minLongitude,o=this.sector.deltaLatitude(),a=this.sector.deltaLongitude(),s=(this.imageWidth-1)*(e-n)/a,l=(this.imageHeight-1)*(i-t)/o,u=Math.floor(r.clamp(s,0,this.imageWidth-1)),c=Math.floor(r.clamp(u+1,0,this.imageWidth-1)),h=Math.floor(r.clamp(l,0,this.imageHeight-1)),f=Math.floor(r.clamp(h+1,0,this.imageHeight-1)),d=this.imageData,p=d[u+h*this.imageWidth],m=d[c+h*this.imageWidth],g=d[u+f*this.imageWidth],y=d[c+f*this.imageWidth],v=s-u,E=l-h;return(1-v)*(1-E)*p+v*(1-E)*m+(1-v)*E*g+v*E*y},i.prototype.elevationsForGrid=function(i,n,o,a){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","elevationsForSector","missingSector"));if(1>n||1>o)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","elevationsForSector","The specified number of sample points is less than 1."));if(!a)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","elevationsForSector","missingResult"));var s,l,u,c,h=this.sector.minLatitude,f=this.sector.maxLatitude,d=this.sector.minLongitude,p=this.sector.maxLongitude,m=f-h,g=p-d,y=i.minLatitude,v=i.maxLatitude,E=i.minLongitude,w=i.maxLongitude,b=(v-y)/(n>1?n-1:1),x=(w-E)/(o>1?o-1:1),_=0,S=this.imageData;for(c=0,s=y;n>c;c+=1,s+=b)if(c===n-1&&(s=v),s>=h&&f>=s){var T=(this.imageHeight-1)*(f-s)/m,L=Math.floor(r.clamp(T,0,this.imageHeight-1)),M=Math.floor(r.clamp(L+1,0,this.imageHeight-1)),A=T-L;for(u=0,l=E;o>u;u+=1,l+=x){if(u===o-1&&(l=w),l>=d&&p>=l){var N=(this.imageWidth-1)*(l-d)/g,R=Math.floor(r.clamp(N,0,this.imageWidth-1)),C=Math.floor(r.clamp(R+1,0,this.imageWidth-1)),P=N-R,O=S[R+L*this.imageWidth],I=S[C+L*this.imageWidth],k=S[R+M*this.imageWidth],D=S[C+M*this.imageWidth];a[_]=(1-P)*(1-A)*O+P*(1-A)*I+(1-P)*A*k+P*A*D}_++}}else _+=o},i.prototype.minAndMaxElevationsForSector=function(t){var e=[];if(t)if(t.contains(this.sector))e[0]>this.minElevation&&(e[0]=this.minElevation),e[1]<this.maxElevation&&(e[1]=this.maxElevation);else{var i=this.sector.maxLatitude,n=this.sector.minLongitude,o=this.sector.deltaLatitude(),a=this.sector.deltaLongitude(),s=t.minLatitude,l=t.maxLatitude,u=t.minLongitude,c=t.maxLongitude,h=Math.floor((this.imageHeight-1)*(i-l)/o),f=Math.ceil((this.imageHeight-1)*(i-s)/o),d=Math.floor((this.imageWidth-1)*(u-n)/a),p=Math.ceil((this.imageWidth-1)*(c-n)/a);h=r.clamp(h,0,this.imageHeight-1),f=r.clamp(f,0,this.imageHeight-1),d=r.clamp(d,0,this.imageWidth-1),p=r.clamp(p,0,this.imageWidth-1);for(var m=this.imageData,g=Number.MAX_VALUE,y=-g,v=h;f>=v;v++)for(var E=d;p>=E;E++){var w=m[Math.floor(E+v*this.imageWidth)];g>w&&(g=w),w>y&&(y=w)}e[0]>g&&(e[0]=g),e[1]<y&&(e[1]=y)}else e[0]=this.minElevation,e[1]=this.maxElevation;return e},i.prototype.findMinAndMaxElevation=function(){if(this.imageData&&this.imageData.length>0){this.minElevation=Number.MAX_VALUE,this.maxElevation=-this.minElevation;for(var t=this.imageData,e=this.imageWidth*this.imageHeight,r=0;e>r;r++){var i=t[r];this.minElevation>i&&(this.minElevation=i),this.maxElevation<i&&(this.maxElevation=i)}}else this.minElevation=0,this.maxElevation=0},i}),i("../src/worldwind/globe/ElevationTile",["../error/ArgumentError","../util/Logger","../util/Tile"],function(t,e,r){"use strict";var i=function(i,n,o,a,s,l){if(!s||s.length<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationTile","constructor","The specified image path is null, undefined or zero length."));if(!l)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationTile","constructor","The specified cache is null or undefined."));r.call(this,i,n,o,a),this.imagePath=s,this.memoryCache=l};return i.prototype=Object.create(r.prototype),i.prototype.size=function(){return r.prototype.size.call(this)+this.imagePath.length+8},i.prototype.image=function(){return this.memoryCache.entryForKey(this.imagePath)},i}),i("../src/worldwind/globe/ElevationModel",["../util/AbsentResourceList","../geom/Angle","../error/ArgumentError","../globe/ElevationImage","../globe/ElevationTile","../util/LevelSet","../util/Logger","../cache/MemoryCache","../geom/Sector","../util/Tile","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(e,i,n,u,c,f,d){if(!e)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","missingSector"));if(!i)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified level-zero delta is null or undefined."));if(!u)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified image format is null or undefined."));if(!c)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified cache path is null or undefined."));if(!n||1>n)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified number of levels is not greater than zero."));if(!f||!d||1>f||1>d)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified tile width or height is not greater than zero."));this.coverageSector=e,this.retrievalImageFormat=u,this.cachePath=c,this.displayName="Elevations",this.timestamp=Date.now(),this.minElevation=0,this.maxElevation=0,this.pixelIsPoint=!0,this.levels=new o(this.coverageSector,i,n,f,d),this.currentTiles=[],this.currentSector=new l(0,0,0,0),this.tileCache=new s(1e6,8e5),this.imageCache=new s(1e7,8e6),this.currentRetrievals=[],this.absentResourceList=new t(3,5e3),this.id=++h.idPool,this.stateKey="elevationModel "+this.id.toString()+" "};return h.idPool=0,h.prototype.minAndMaxElevationsForSector=function(t){if(!t)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","minAndMaxElevationsForSector","missingSector"));var i=this.levels.levelForTexelSize(t.deltaLatitude()*e.DEGREES_TO_RADIANS/64);if(this.assembleTiles(i,t,!1),0==this.currentTiles.length)return null;for(var n,o,s,l=Number.MAX_VALUE,u=-l,c=[],h=0,f=this.currentTiles.length;f>h;h++){if(n=this.currentTiles[h].image(),!n)return c[0]=this.minElevation,c[1]=this.maxElevation,c;o=n.minElevation,l>o&&(l=o),s=n.maxElevation,s>u&&(u=s)}return c[0]=l,c[1]=u,c},h.prototype.elevationAtLocation=function(t,e){return this.coverageSector.containsLocation(t,e)?this.pointElevationForLocation(t,e):0},h.prototype.elevationsForGrid=function(t,e,i,n,o){if(!t)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","elevationsForSector","missingSector"));if(!o)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","elevationsForSector","missingResult"));if(!e||!i||1>e||1>i)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified number of latitudinal or longitudinal positions is less than one."));var s=this.levels.levelForTexelSize(n);return this.pixelIsPoint?this.pointElevationsForGrid(t,e,i,s,o):this.areaElevationsForGrid(t,e,i,s,o)},h.prototype.pointElevationForLocation=function(t,e){for(var r,i=this.levels.lastLevel(),n=i.tileDelta.latitude,o=i.tileDelta.longitude,a=u.computeRow(n,t),s=u.computeColumn(o,e),l=null,c=i.levelNumber;c>=0;c--){if(r=this.tileCache.entryForKey(c+"."+a+"."+s),r&&(l=r.image()))return l.elevationAtLocation(t,e);a=Math.floor(a/2),s=Math.floor(s/2)}return 0},h.prototype.pointElevationsForGrid=function(t,e,r,i,n){var o,a=0;if(this.assembleTiles(i,t,!0),0===this.currentTiles.length)return 0;this.currentTiles.sort(function(t,e){return t.level.levelNumber-e.level.levelNumber});for(var s=0,l=this.currentTiles.length;l>s;s++){var u=this.currentTiles[s],c=u.image();c?(c.elevationsForGrid(t,e,r,n),o=u.level.texelSize,o>a&&(a=o)):a=Number.MAX_VALUE}return a},h.prototype.areaElevationsForGrid=function(t,e,r,i,n){var o,a,s,l,u,c,h=t.minLatitude,f=t.maxLatitude,d=t.minLongitude,p=t.maxLongitude,m=t.deltaLatitude()/(e>1?e-1:1),g=t.deltaLongitude()/(r>1?r-1:1),y=0;for(u=0,o=h;e>u;u+=1,o+=m)for(u===e-1&&(o=f),c=0,a=d;r>c;c+=1,a+=g)c===r-1&&(a=p),this.coverageSector.containsLocation(o,a)&&(s=(a+180)/360,l=(o+90)/180,this.areaElevationForCoord(s,l,i.levelNumber,n,y)),y++;return i.texelSize},h.prototype.areaElevationForCoord=function(t,e,r,i,n){for(var o,a,s,l,u,h,f,d,p,m,g,y,v,E,w,b,x=new Float64Array(4),_=r;_>=0;_--)if(o=this.levels.level(_),a=Math.round(360*o.tileWidth/o.tileDelta.longitude),s=Math.round(180*o.tileHeight/o.tileDelta.latitude),l=1/(2*s),u=1-l,h=0,f=s-1,d=a*c.fract(t),p=s*c.clamp(e,l,u),m=c.mod(Math.floor(d-.5),a),g=c.mod(m+1,a),y=c.clamp(Math.floor(p-.5),h,f),v=c.clamp(y+1,h,f),E=c.fract(d-.5),w=c.fract(p-.5),b=_==r||0==_,this.lookupPixels(m,g,y,v,o,b,x))return void(i[n]=(1-E)*(1-w)*x[0]+E*(1-w)*x[1]+(1-E)*w*x[2]+E*w*x[3])},h.prototype.lookupPixels=function(t,e,r,i,n,o,a){var s,l,u,c,h=n.levelNumber,f=n.tileWidth,d=n.tileHeight,p=Math.floor(r/d),m=Math.floor(i/d),g=Math.floor(t/f),y=Math.floor(e/f);return p==m&&p==this.cachedRow&&g==y&&g==this.cachedCol?s=l=u=c=this.cachedImage:p==m&&g==y?(s=this.lookupImage(h,p,g,o),l=u=c=s,this.cachedRow=p,this.cachedCol=g,this.cachedImage=s):(s=this.lookupImage(h,p,g,o),l=this.lookupImage(h,p,y,o),u=this.lookupImage(h,m,g,o),c=this.lookupImage(h,m,y,o)),s&&l&&u&&c?(a[0]=s.pixel(t%f,r%d),a[1]=l.pixel(e%f,r%d),a[2]=u.pixel(t%f,i%d),a[3]=c.pixel(e%f,i%d),!0):!1},h.prototype.lookupImage=function(t,e,r,i){var n=this.tileForLevel(t,e,r),o=n.image();return null==o&&i&&this.retrieveTileImage(n),o},h.prototype.createTile=function(t,e,r,i){var o=this.cachePath+"/"+e.levelNumber+"/"+r+"/"+r+"_"+i+".bil";return new n(t,e,r,i,o,this.imageCache)},h.prototype.assembleTiles=function(t,e,r){if(this.currentTiles=[],this.currentSector.copy(e),this.currentSector.intersection(this.coverageSector),!this.currentSector.isEmpty())for(var i=t.tileDelta.latitude,n=t.tileDelta.longitude,o=u.computeRow(i,this.currentSector.minLatitude),a=u.computeLastRow(i,this.currentSector.maxLatitude),s=u.computeColumn(n,this.currentSector.minLongitude),l=u.computeLastColumn(n,this.currentSector.maxLongitude),c=o;a>=c;c++)for(var h=s;l>=h;h++)this.addTileOrAncestor(t,c,h,r)},h.prototype.addTileOrAncestor=function(t,e,r,i){var n=this.tileForLevel(t.levelNumber,e,r);this.isTileImageInMemory(n)?this.addToCurrentTiles(n):(i&&this.retrieveTileImage(n),t.isFirstLevel()?this.currentTiles.push(n):this.addAncestor(t,e,r,i))},h.prototype.addAncestor=function(t,e,r,i){for(var n=null,o=Math.floor(e/2),a=Math.floor(r/2),s=t.levelNumber-1;s>=0;s--){if(n=this.tileForLevel(s,o,a),this.isTileImageInMemory(n))return void this.addToCurrentTiles(n);o=Math.floor(o/2),a=Math.floor(a/2)}this.addToCurrentTiles(n),i&&this.retrieveTileImage(n)},h.prototype.addToCurrentTiles=function(t){this.currentTiles.push(t)},h.prototype.tileForLevel=function(t,e,r){var i=t+"."+e+"."+r,n=this.tileCache.entryForKey(i);if(n)return n;var o=this.levels.level(t),a=u.computeSector(o,e,r);return n=this.createTile(a,o,e,r),this.tileCache.putEntry(i,n,n.size()),n},h.prototype.isTileImageInMemory=function(t){return this.imageCache.containsKey(t.imagePath)},h.prototype.resourceUrlForTile=function(t){return this.urlBuilder.urlForTile(t,this.retrievalImageFormat)},h.prototype.retrieveTileImage=function(t){if(this.currentRetrievals.indexOf(t.imagePath)<0){var e=this.resourceUrlForTile(t,this.retrievalImageFormat),r=new XMLHttpRequest,i=this;if(!e)return;r.open("GET",e,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){if(4===r.readyState){i.removeFromCurrentRetrievals(t.imagePath);var n=r.getResponseHeader("content-type");if(200===r.status)if(n===i.retrievalImageFormat||"text/plain"===n||"application/octet-stream"===n){a.log(a.LEVEL_INFO,"Elevations retrieval succeeded: "+e),i.loadElevationImage(t,r),i.absentResourceList.unmarkResourceAbsent(t.imagePath);var o=document.createEvent("Event");o.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(o)}else"text/xml"===n?(i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval failed ("+r.statusText+"): "+e+".\n "+String.fromCharCode.apply(null,new Uint8Array(r.response)))):(i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval failed: "+e+". Unexpected content type "+n));else i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval failed ("+r.statusText+"): "+e)}},r.onerror=function(){i.removeFromCurrentRetrievals(t.imagePath),i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval failed: "+e)},r.ontimeout=function(){i.removeFromCurrentRetrievals(t.imagePath),i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval timed out: "+e)},r.send(null),this.currentRetrievals.push(t.imagePath)}},h.prototype.removeFromCurrentRetrievals=function(t){var e=this.currentRetrievals.indexOf(t);e>-1&&this.currentRetrievals.splice(e,1)},h.prototype.loadElevationImage=function(t,e){var r=new i(t.imagePath,t.sector,t.tileWidth,t.tileHeight);"application/bil16"==this.retrievalImageFormat?(r.imageData=new Int16Array(e.response),r.size=2*r.imageData.length):"application/bil32"==this.retrievalImageFormat&&(r.imageData=new Float32Array(e.response),r.size=4*r.imageData.length),r.imageData&&(r.findMinAndMaxElevation(),this.imageCache.putEntry(t.imagePath,r,r.size),this.timestamp=Date.now())},h}),i("../src/worldwind/projections/GeographicProjection",["../error/ArgumentError","../util/Logger","../geom/Sector","../error/UnsupportedOperationError"],function(t,e,r,i){"use strict";var n=function(t,e,r){this.displayName=t||"Geographic Projection",this.continuous=e,this.projectionLimits=r,this.is2D=!0};return n.prototype.geographicToCartesian=function(t,r,n,o,a,s){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","geographicToCartesian","abstractInvocation"))},n.prototype.geographicToCartesianGrid=function(t,r,n,o,a,s,l,u){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","geographicToCartesianGrid","abstractInvocation"))},n.prototype.cartesianToGeographic=function(t,r,n,o,a,s){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","cartesianToGeographic","abstractInvocation"))},n.prototype.northTangentAtLocation=function(r,i,n,o){if(!o)throw new t(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","northTangentAtLocation","missingResult"));return o[0]=0,o[1]=1,o[2]=0,o},n.prototype.northTangentAtPoint=function(r,i,n,o,a,s){if(!s)throw new t(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","northTangentAtPoint","missingResult"));return s[0]=0,s[1]=1,s[2]=0,s},n.prototype.surfaceNormalAtPoint=function(r,i,n,o,a){if(!a)throw new t(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","surfaceNormalAtPoint","missingResult"));return a[0]=0,a[1]=0,a[2]=1,a},n.prototype.geographicToCartesianTransform=function(t,r,n,o,a,s){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","geographicToCartesianTransform","abstractInvocation"))},n.prototype.cartesianToLocalTransform=function(t,r,n,o,a,s){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","cartesianToLocalTransform","abstractInvocation"))},n}),i("../src/worldwind/projections/ProjectionWgs84",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Position","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(){r.call(this,"WGS84",!1,null),this.is2D=!1,this.scratchPosition=new n(0,0,0)};return s.prototype=Object.create(r.prototype),Object.defineProperties(s.prototype,{stateKey:{get:function(){return"projection wgs84 "}}}),s.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesian","missingGlobe"));var u=Math.cos(n*t.DEGREES_TO_RADIANS),c=Math.sin(n*t.DEGREES_TO_RADIANS),h=Math.cos(o*t.DEGREES_TO_RADIANS),f=Math.sin(o*t.DEGREES_TO_RADIANS),d=r.equatorialRadius/Math.sqrt(1-r.eccentricitySquared*c*c);return l[0]=(a+d)*u*f,l[1]=(a+d*(1-r.eccentricitySquared))*c,l[2]=(a+d)*u*h,l},s.prototype.geographicToCartesianGrid=function(r,n,a,s,l,u,c,h){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesianGrid","missingGlobe"));var f,d,p,m,g,y,v,E,w=n.minLatitude*t.DEGREES_TO_RADIANS,b=n.maxLatitude*t.DEGREES_TO_RADIANS,x=n.minLongitude*t.DEGREES_TO_RADIANS,_=n.maxLongitude*t.DEGREES_TO_RADIANS,S=(b-w)/(a>1?a-1:1),T=(_-x)/(s>1?s-1:1),L=u?u:new o(0,0,0),M=0,A=0,N=new Float64Array(s),R=new Float64Array(s);for(d=0,m=x;s>d;d++,m+=T)d===s-1&&(m=_),N[d]=Math.cos(m),R[d]=Math.sin(m);for(f=0,p=w;a>f;f++,p+=S)for(f===a-1&&(p=b),v=Math.cos(p),E=Math.sin(p),g=r.equatorialRadius/Math.sqrt(1-r.eccentricitySquared*E*E),d=0;s>d;d++)y=l[M++],h[A++]=(g+y)*v*R[d]-L[0],h[A++]=(g*(1-r.eccentricitySquared)+y)*E-L[1],h[A++]=(g+y)*v*N[d]-L[2];return h},s.prototype.cartesianToGeographic=function(r,n,o,s,l,u){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","cartesianToGeographic","missingGlobe"));var c,h,f,d,p,m,g,y,v,E,w,b,x,_,S,T=s,L=n,M=o,A=T*T+L*L,N=Math.sqrt(A),R=r.equatorialRadius,C=1/(R*R),P=r.eccentricitySquared,O=P*P,I=A*C,k=M*M*(1-P)*C,D=(I+k-O)/6,V=8*D*D*D+O*I*k;return V>0||0!=k?(V>0?(d=Math.sqrt(V),p=Math.sqrt(O*I*k),V>10*P?(m=a.cbrt((d+p)*(d+p)),f=D+.5*m+2*D*D/m):f=D+.5*a.cbrt((d+p)*(d+p))+.5*a.cbrt((d-p)*(d-p))):(d=Math.sqrt(-V),p=Math.sqrt(-8*D*D*D),m=Math.sqrt(O*I*k),g=2*Math.atan2(m,d+p)/3,f=-4*D*Math.sin(g)*Math.cos(Math.PI/6+g)),y=Math.sqrt(f*f+O*k),v=P*(f+y-k)/(2*y),E=(f+y)/(Math.sqrt(v*v+f+y)+v),w=E*N/(E+P),b=Math.sqrt(w*w+M*M),c=(E+P-1)*b/E,h=2*Math.atan2(M,b+w)):(d=Math.sqrt(1-P),p=Math.sqrt(P-I),x=Math.sqrt(P),c=-R*d*p/x,h=p/(x*p+d*Math.sqrt(I))),S=Math.sqrt(2),_=N+T>(S-1)*L?2*Math.atan2(L,N+T):(S+1)*T>N+L?.5*-Math.PI+2*Math.atan2(T,N-L):.5*Math.PI-2*Math.atan2(T,N+L),u.latitude=t.RADIANS_TO_DEGREES*h,u.longitude=t.RADIANS_TO_DEGREES*_,u.altitude=c,u},s.prototype.northTangentAtLocation=function(e,r,i,n){var o=Math.cos(r*t.DEGREES_TO_RADIANS),a=Math.cos(i*t.DEGREES_TO_RADIANS),s=Math.sin(r*t.DEGREES_TO_RADIANS),l=Math.sin(i*t.DEGREES_TO_RADIANS);return n[0]=-s*l,n[1]=o,n[2]=-s*a,n},s.prototype.northTangentAtPoint=function(t,e,r,i,n,a){return this.cartesianToGeographic(t,e,r,i,o.ZERO,this.scratchPosition),this.northTangentAtLocation(t,this.scratchPosition.latitude,this.scratchPosition.longitude,a)},s.prototype.surfaceNormalAtPoint=function(t,r,n,o,a){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","surfaceNormalAtPoint","missingGlobe"));var s=t.equatorialRadius*t.equatorialRadius,l=t.polarRadius*t.polarRadius;return a[0]=r/s,a[1]=n/l,a[2]=o/s,a.normalize()},s.prototype.cartesianToLocalTransform=function(t,r,n,o,s,l){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","cartesianToLocalTransform","missing globe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","cartesianToLocalTransform","missing result"));var u=this.cartesianToGeographic(t,r,n,o,s,this.scratchPosition),c=a.toRadians(u.latitude),h=a.toRadians(u.longitude),f=Math.cos(c),d=Math.sin(c),p=Math.cos(h),m=Math.sin(h),g=t.equatorialRadius*t.equatorialRadius,y=t.polarRadius*t.polarRadius,v=f*m/g,E=(1-t.eccentricitySquared)*d/y,w=f*p/g,b=Math.sqrt(v*v+E*E+w*w);v/=b,E/=b,w/=b;var x=-d*m,_=f,S=-d*p;b=Math.sqrt(x*x+_*_+S*S),x/=b,_/=b,S/=b;var T=_*w-S*E,L=S*v-x*w,M=x*E-_*v;return x=E*M-w*L,_=w*T-v*M,S=v*L-E*T,l.set(T,x,v,r,L,_,E,n,M,S,w,o,0,0,0,1),l},s.prototype.geographicToCartesianTransform=function(t,r,n,o,s,l){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesianTransform","missing globe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesianTransform","missing result"));var u=a.toRadians(r),c=a.toRadians(n),h=Math.cos(u),f=Math.sin(u),d=Math.cos(c),p=Math.sin(c),m=t.eccentricitySquared,g=t.equatorialRadius/Math.sqrt(1-m*f*f),y=t.equatorialRadius*t.equatorialRadius,v=t.polarRadius*t.polarRadius,E=(g+o)*h*p,w=(g*(1-m)+o)*f,b=(g+o)*h*d,x=h*p/y,_=(1-m)*f/v,S=h*d/y,T=Math.sqrt(x*x+_*_+S*S);x/=T,_/=T,S/=T;var L=-f*p,M=h,A=-f*d;T=Math.sqrt(L*L+M*M+A*A),L/=T,M/=T,A/=T;var N=M*S-A*_,R=A*x-L*S,C=L*_-M*x;return L=_*C-S*R,M=S*N-x*C,A=x*R-_*N,l.set(N,L,x,E,R,M,_,w,C,A,S,b,0,0,0,1),l},s}),i("../src/worldwind/globe/Terrain",["../error/ArgumentError","../util/Logger","../geom/Vec3"],function(t,e,r){"use strict";var i=function(t,e,r,i){this.globe=t,this.verticalExaggeration=i,this.sector=r.sector,this.tessellator=e,this.surfaceGeometry=r.tileArray,this.stateKey=t.stateKey+" ve "+i.toString()};return i.scratchPoint=new r(0,0,0),i.prototype.surfacePoint=function(r,n,o,a){if(!a)throw new t(e.logMessage(e.LEVEL_SEVERE,"Terrain","surfacePoint","missingResult"));for(var s=0,l=this.surfaceGeometry.length;l>s;s++)if(this.surfaceGeometry[s].sector.containsLocation(r,n)){if(this.surfaceGeometry[s].surfacePoint(r,n,a),o){var u=this.globe.surfaceNormalAtPoint(a[0],a[1],a[2],i.scratchPoint);a[0]+=u[0]*o,a[1]+=u[1]*o,a[2]+=u[2]*o}return a}var c=o+this.globe.elevationAtLocation(r,n)*this.verticalExaggeration;return this.globe.computePointFromPosition(r,n,c,a),a},i.prototype.surfacePointForMode=function(r,i,n,o,a){if(!a)throw new t(e.logMessage(e.LEVEL_SEVERE,"Terrain","surfacePointForMode","missingResult"));if(o||(o=WorldWind.ABSOLUTE),o===WorldWind.CLAMP_TO_GROUND)return this.surfacePoint(r,i,0,a);if(o===WorldWind.RELATIVE_TO_GROUND)return this.surfacePoint(r,i,n,a);var s=n*this.verticalExaggeration;return this.globe.computePointFromPosition(r,i,s,a),a},i.prototype.beginRendering=function(t){this.globe&&this.globe.tessellator&&this.globe.tessellator.beginRendering(t)},i.prototype.endRendering=function(t){this.globe&&this.globe.tessellator&&this.globe.tessellator.endRendering(t)},i.prototype.beginRenderingTile=function(r,i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Terrain","beginRenderingTile","missingTile"));this.globe&&this.globe.tessellator&&this.globe.tessellator.beginRenderingTile(r,i)},i.prototype.endRenderingTile=function(t,e){},i.prototype.renderTile=function(r,i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Terrain","renderTile","missingTile"));this.globe&&this.globe.tessellator&&this.globe.tessellator.renderTile(r,i)},i.prototype.pick=function(t){this.globe&&this.globe.tessellator&&this.globe.tessellator.pick(t,this.surfaceGeometry,this)},i}),i("../src/worldwind/globe/TerrainTile",["../error/ArgumentError","../util/Logger","../geom/Matrix","../util/Tile"],function(t,e,r,i){"use strict";var n=function(t,e,n,o){i.call(this,t,e,n,o),this.transformationMatrix=r.fromIdentity(),this.points=null,this.pointsStateKey=null,this.pointsVboStateKey=null,this.neighborMap={},this.neighborMap[WorldWind.NORTH]=null,this.neighborMap[WorldWind.SOUTH]=null,this.neighborMap[WorldWind.EAST]=null,this.neighborMap[WorldWind.WEST]=null,this._stateKey=null,this._elevationTimestamp=null,
this.scratchArray=[]};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{stateKey:{get:function(){return this._stateKey||(this._stateKey=this.computeStateKey()),this._stateKey}}}),n.prototype.neighborLevel=function(t){return this.neighborMap[t]},n.prototype.setNeighborLevel=function(t,e){this.neighborMap[t]=e,this._stateKey=null},n.prototype.surfacePoint=function(r,i,n){if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"TerrainTile","surfacePoint","missingResult"));var o,a,s,l,u,c,h,f,d,p,m=this.sector,g=m.minLatitude,y=m.maxLatitude,v=m.minLongitude,E=m.maxLongitude,w=this.tileWidth,b=this.tileHeight;o=(i-v)/(E-v)*w,a=(r-g)/(y-g)*b,s=w>o?Math.floor(o):w-1,l=b>a?Math.floor(a):b-1,u=w+1,c=this.points,h=this.scratchArray,f=3*(s+l*u);for(var x=0;6>x;x++)h[x]=c[f+x];f=3*(s+(l+1)*u);for(var _=6;12>_;_++)h[_]=c[f+(_-6)];return d=w>o?o-Math.floor(o):1,p=b>a?a-Math.floor(a):1,d>p?(n[0]=h[0]+d*(h[3]-h[0])+p*(h[6]-h[0]),n[1]=h[1]+d*(h[4]-h[1])+p*(h[7]-h[1]),n[2]=h[2]+d*(h[5]-h[2])+p*(h[8]-h[2])):(n[0]=h[9]+(1-d)*(h[6]-h[9])+(1-p)*(h[3]-h[9]),n[1]=h[10]+(1-d)*(h[7]-h[10])+(1-p)*(h[4]-h[10]),n[2]=h[11]+(1-d)*(h[8]-h[11])+(1-p)*(h[5]-h[11])),n[0]+=this.referencePoint[0],n[1]+=this.referencePoint[1],n[2]+=this.referencePoint[2],n},n.prototype.update=function(t){i.prototype.update.call(this,t);var e=t.globe.elevationTimestamp();this._elevationTimestamp!=e&&(this._elevationTimestamp=e,this._stateKey=null)},n.prototype.computeStateKey=function(){var t=[];return t.push(this._elevationTimestamp),t.push(this.neighborMap[WorldWind.NORTH]?this.neighborMap[WorldWind.NORTH].compare(this.level):0),t.push(this.neighborMap[WorldWind.SOUTH]?this.neighborMap[WorldWind.SOUTH].compare(this.level):0),t.push(this.neighborMap[WorldWind.EAST]?this.neighborMap[WorldWind.EAST].compare(this.level):0),t.push(this.neighborMap[WorldWind.WEST]?this.neighborMap[WorldWind.WEST].compare(this.level):0),t.join(".")},n}),i("../src/worldwind/globe/TerrainTileList",["../error/ArgumentError","../util/Logger","../geom/Sector"],function(t,e,r){"use strict";var i=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"TerrainTileList","TerrainTileList","missingTessellator"));this.tessellator=r,this.sector=null,this.tileArray=[]};return Object.defineProperties(i.prototype,{length:{get:function(){return this.tileArray.length}}}),i.prototype.addTile=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"TerrainTileList","addTile","missingTile"));-1==this.tileArray.indexOf(i)&&(this.tileArray.push(i),this.sector?this.sector.union(i.sector):(this.sector=new r(0,0,0,0),this.sector.copy(i.sector)))},i.prototype.removeAllTiles=function(){this.tileArray=[],this.sector=null},i}),i("../src/worldwind/globe/Tessellator",["../error/ArgumentError","../shaders/BasicProgram","../globe/Globe","../shaders/GpuProgram","../util/Level","../util/LevelSet","../geom/Location","../util/Logger","../geom/Matrix","../cache/MemoryCache","../navigate/NavigatorState","../error/NotYetImplementedError","../pick/PickedObject","../geom/Position","../geom/Rectangle","../geom/Sector","../globe/Terrain","../globe/TerrainTile","../globe/TerrainTileList","../util/Tile","../util/WWMath","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m,g,y,v,E,w,b){"use strict";var x=function(){this.numRowsTilesInTopLevel=4,this.numColumnsTilesInTopLevel=8,this.maximumSubdivisionDepth=15,this.tileWidth=32,this.tileHeight=32,this.detailControl=40,this.levels=new o(m.FULL_SPHERE,new a(180/this.numRowsTilesInTopLevel,360/this.numColumnsTilesInTopLevel),this.maximumSubdivisionDepth,this.tileWidth,this.tileHeight),this.topLevelTiles={},this.currentTiles=new v(this),this.tileCache=new u(5e6,4e6),this.elevationTimestamp=void 0,this.lastModelViewProjection=void 0,this.vertexPointLocation=-1,this.vertexTexCoordLocation=-1,this.texCoords=null,this.texCoordVboCacheKey="global_tex_coords",this.indices=null,this.indicesVboCacheKey="global_indices",this.baseIndices=null,this.baseIndicesOffset=null,this.numBaseIndices=null,this.indicesNorth=null,this.indicesNorthOffset=null,this.numIndicesNorth=null,this.indicesSouth=null,this.indicesSouthOffset=null,this.numIndicesSouth=null,this.indicesWest=null,this.indicesWestOffset=null,this.numIndicesWest=null,this.indicesEast=null,this.indicesEastOffset=null,this.numIndicesEast=null,this.indicesLoresNorth=null,this.indicesLoresNorthOffset=null,this.numIndicesLoresNorth=null,this.indicesLoresSouth=null,this.indicesLoresSouthOffset=null,this.numIndicesLoresSouth=null,this.indicesLoresWest=null,this.indicesLoresWestOffset=null,this.numIndicesLoresWest=null,this.indicesLoresEast=null,this.indicesLoresEastOffset=null,this.numIndicesLoresEast=null,this.outlineIndicesOffset=null,this.numOutlineIndices=null,this.wireframeIndicesOffset=null,this.numWireframeIndices=null,this.scratchMatrix=l.fromIdentity(),this.scratchElevations=null,this.scratchPrevElevations=null,this.corners={},this.tiles=[]};return x.prototype.tessellate=function(e){if(!e)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","tessellate","missingDC"));var r=e.globe.elevationTimestamp();if(this.lastGlobeStateKey===e.globeStateKey&&this.lastVerticalExaggeration===e.verticalExaggeration&&this.elevationTimestamp===r&&this.lastModelViewProjection&&e.navigatorState.modelviewProjection.equals(this.lastModelViewProjection))return this.lastTerrain;var i=e.navigatorState;this.lastModelViewProjection=i.modelviewProjection,this.lastGlobeStateKey=e.globeStateKey,this.elevationTimestamp=r,this.lastVerticalExaggeration=e.verticalExaggeration,this.currentTiles.removeAllTiles(),this.topLevelTiles[e.globeStateKey]&&0!=this.topLevelTiles[e.globeStateKey].length||this.createTopLevelTiles(e),this.corners={},this.tiles=[];for(var n=0,o=this.topLevelTiles[e.globeStateKey].length;o>n;n+=1){var a=this.topLevelTiles[e.globeStateKey][n];a.update(e),this.isTileVisible(e,a)&&this.addTileOrDescendants(e,a)}return this.refineNeighbors(e),this.finishTessellating(e),this.lastTerrain=0===this.currentTiles.length?null:new g(e.globe,this,this.currentTiles,e.verticalExaggeration),this.lastTerrain},x.prototype.createTile=function(e,r,i,n){if(!e)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tile","constructor","missingSector"));if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tile","constructor","The specified level is null or undefined."));if(0>i||0>n)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tile","constructor","The specified row or column is less than zero."));return new y(e,r,i,n)},x.prototype.beginRendering=function(t){var e=t.currentProgram;if(!e)return void s.logMessage(s.LEVEL_INFO,"Tessellator","beginRendering","Current Program is empty");this.buildSharedGeometry(),this.cacheSharedGeometryVBOs(t);var r=t.currentGlContext,i=t.gpuResourceCache;if(this.vertexPointLocation=e.attributeLocation(r,"vertexPoint"),this.vertexTexCoordLocation=e.attributeLocation(r,"vertexTexCoord"),r.enableVertexAttribArray(this.vertexPointLocation),this.vertexTexCoordLocation>=0){var n=i.resourceForKey(this.texCoordVboCacheKey);r.bindBuffer(r.ARRAY_BUFFER,n),r.vertexAttribPointer(this.vertexTexCoordLocation,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(this.vertexTexCoordLocation)}var o=i.resourceForKey(this.indicesVboCacheKey);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,o)},x.prototype.endRendering=function(t){var e=t.currentGlContext;e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.vertexPointLocation>=0&&e.disableVertexAttribArray(this.vertexPointLocation),this.vertexTexCoordLocation>=0&&e.disableVertexAttribArray(this.vertexTexCoordLocation)},x.prototype.beginRenderingTile=function(e,r){if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","beginRenderingTile","missingTile"));var i=e.currentGlContext,n=e.gpuResourceCache;this.scratchMatrix.setToMultiply(e.navigatorState.modelviewProjection,r.transformationMatrix),e.currentProgram.loadModelviewProjection(i,this.scratchMatrix);var o=e.globeStateKey+r.tileKey,a=n.resourceForKey(o);a?r.pointsVboStateKey!=r.pointsStateKey?(i.bindBuffer(i.ARRAY_BUFFER,a),i.bufferSubData(i.ARRAY_BUFFER,0,r.points),r.pointsVboStateKey=r.pointsStateKey):e.currentGlContext.bindBuffer(i.ARRAY_BUFFER,a):(a=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,a),i.bufferData(i.ARRAY_BUFFER,r.points,i.STATIC_DRAW),e.frameStatistics.incrementVboLoadCount(1),n.putResource(o,a,4*r.points.length),r.pointsVboStateKey=r.pointsStateKey),i.vertexAttribPointer(this.vertexPointLocation,3,i.FLOAT,!1,0,0)},x.prototype.endRenderingTile=function(t,e){},x.prototype.renderTile=function(e,r){if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","renderTile","missingTile"));var i=e.currentGlContext,n=i.TRIANGLE_STRIP;i.drawElements(n,this.numBaseIndices,i.UNSIGNED_SHORT,2*this.baseIndicesOffset);var o,a=r.level;o=r.neighborLevel(WorldWind.NORTH),o&&o.compare(a)<0?i.drawElements(n,this.numIndicesLoresNorth,i.UNSIGNED_SHORT,2*this.indicesLoresNorthOffset):i.drawElements(n,this.numIndicesNorth,i.UNSIGNED_SHORT,2*this.indicesNorthOffset),o=r.neighborLevel(WorldWind.SOUTH),o&&o.compare(a)<0?i.drawElements(n,this.numIndicesLoresSouth,i.UNSIGNED_SHORT,2*this.indicesLoresSouthOffset):i.drawElements(n,this.numIndicesSouth,i.UNSIGNED_SHORT,2*this.indicesSouthOffset),o=r.neighborLevel(WorldWind.WEST),o&&o.compare(a)<0?i.drawElements(n,this.numIndicesLoresWest,i.UNSIGNED_SHORT,2*this.indicesLoresWestOffset):i.drawElements(n,this.numIndicesWest,i.UNSIGNED_SHORT,2*this.indicesWestOffset),o=r.neighborLevel(WorldWind.EAST),o&&o.compare(a)<0?i.drawElements(n,this.numIndicesLoresEast,i.UNSIGNED_SHORT,2*this.indicesLoresEastOffset):i.drawElements(n,this.numIndicesEast,i.UNSIGNED_SHORT,2*this.indicesEastOffset)},x.prototype.renderWireframeTile=function(e,r){if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","renderWireframeTile","missingTile"));var i=e.currentGlContext;this.vertexTexCoordLocation>=0&&i.disableVertexAttribArray(this.vertexTexCoordLocation),i.drawElements(i.LINES,this.numWireframeIndices,i.UNSIGNED_SHORT,2*this.wireframeIndicesOffset)},x.prototype.renderTileOutline=function(e,r){if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","renderTileOutline","missingTile"));var i=e.currentGlContext;this.vertexTexCoordLocation>=0&&i.disableVertexAttribArray(this.vertexTexCoordLocation),i.drawElements(i.LINE_LOOP,this.numOutlineIndices,i.UNSIGNED_SHORT,2*this.outlineIndicesOffset)},x.prototype.pick=function(e,r,i){if(!e)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","pick","missingDc"));if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","pick","missingList"));for(var n=null,o=i||this,a=new d(0,0,0),l=[],u=0,c=r.length;c>u;u++){var h=r[u];h.extent.intersectsFrustum(e.pickFrustum)&&l.push(h)}if(e.pickTerrainOnly||(n=e.uniquePickColor(),this.drawPickTiles(e,l,n)),!e.regionPicking){var p=e.navigatorState.rayFromScreenPoint(e.pickPoint),m=this.computeNearestIntersection(p,l);m&&(e.globe.computePositionFromPoint(m[0],m[1],m[2],a),a.altitude=e.globe.elevationAtLocation(a.latitude,a.longitude),e.addPickedObject(new f(n,o,a,null,!0)))}},x.prototype.drawPickTiles=function(t,r,i){var n=t.currentGlContext;try{t.findAndBindProgram(e),t.currentProgram.loadColor(n,i),this.beginRendering(t);for(var o=0,a=r.length;a>o;o++){var s=r[o];this.beginRenderingTile(t,s),this.renderTile(t,s),this.endRenderingTile(t,s)}}finally{this.endRendering(t)}},x.prototype.computeNearestIntersection=function(t,e){for(var r=[],i=0,n=e.length;n>i;i++)this.computeIntersections(t,e[i],r);if(0==r.length)return null;var o,a=Number.POSITIVE_INFINITY;for(i=0,n=r.length;n>i;i++){var s=t.origin.distanceToSquared(r[i]);a>s&&(a=s,o=i)}return r[o]},x.prototype.computeIntersections=function(t,e,r){var i,n,o=e.level,a=e.points,s=r.length;t.origin.subtract(e.referencePoint),this.buildSharedGeometry(e),n=this.baseIndices,w.computeTriStripIntersections(t,a,n,r),i=e.neighborLevel(WorldWind.SOUTH),n=i&&i.compare(o)<0?this.indicesLoresSouth:this.indicesSouth,w.computeTriStripIntersections(t,a,n,r),i=e.neighborLevel(WorldWind.WEST),n=i&&i.compare(o)<0?this.indicesLoresWest:this.indicesWest,w.computeTriStripIntersections(t,a,n,r),i=e.neighborLevel(WorldWind.EAST),n=i&&i.compare(o)<0?this.indicesLoresEast:this.indicesEast,w.computeTriStripIntersections(t,a,n,r),i=e.neighborLevel(WorldWind.NORTH),n=i&&i.compare(o)<0?this.indicesLoresNorth:this.indicesNorth,w.computeTriStripIntersections(t,a,n,r),t.origin.add(e.referencePoint);for(var l=s,u=r.length;u>l;l++)r[l].add(e.referencePoint)},x.prototype.createTopLevelTiles=function(t){this.topLevelTiles[t.globeStateKey]=[],E.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles[t.globeStateKey])},x.prototype.addTileOrDescendants=function(t,e){return this.tileMeetsRenderCriteria(t,e)?void this.addTile(t,e):void this.addTileDescendants(t,e)},x.prototype.addTileDescendants=function(t,e){for(var r=e.level.nextLevel(),i=e.subdivideToCache(r,this,this.tileCache),n=0;n<i.length;n+=1){var o=i[n];o.update(t),this.levels.sector.intersects(o.sector)&&this.isTileVisible(t,o)&&this.addTileOrDescendants(t,o)}},x.prototype.addTile=function(t,e){var r=this.tiles.length;this.tiles.push(e);var i,n=e.sector,o=[n.maxLatitude,n.maxLongitude].toString(),a=[n.minLatitude,n.maxLongitude].toString(),s=[n.maxLatitude,n.minLongitude].toString(),l=[n.minLatitude,n.minLongitude].toString();i=this.corners[l],i?i.sw=r:this.corners[l]={sw:r},i=this.corners[s],i?i.nw=r:this.corners[s]={nw:r},i=this.corners[a],i?i.se=r:this.corners[a]={se:r},i=this.corners[o],i?i.ne=r:this.corners[o]={ne:r}},x.prototype.refineNeighbors=function(t){for(var e={},r=0,i=this.tiles.length;i>r;r+=1){var n,o,r,i,a=this.tiles[r],s=a.level.levelNumber,l=a.sector,u=[l.maxLatitude,l.maxLongitude].toString(),c=[l.minLatitude,l.maxLongitude].toString(),h=[l.maxLatitude,l.minLongitude].toString(),f=[l.minLatitude,l.minLongitude].toString();n=this.corners[u],n.hasOwnProperty("se")&&(o=n.se,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n.hasOwnProperty("nw")&&(o=n.nw,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n=this.corners[c],n.hasOwnProperty("ne")&&(o=n.ne,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n.hasOwnProperty("sw")&&(o=n.sw,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n=this.corners[h],n.hasOwnProperty("ne")&&(o=n.ne,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n.hasOwnProperty("sw")&&(o=n.sw,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n=this.corners[f],n.hasOwnProperty("se")&&(o=n.se,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n.hasOwnProperty("nw")&&(o=n.nw,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0)))}var d=[],p=[];for(r=0,i=this.tiles.length;i>r;r+=1)a=this.tiles[r],e[r]?d.push(a):p.push(a);if(d.length>0){for(this.tiles=[],this.corners={},r=0,i=p.length;i>r;r+=1)a=p[r],this.addTile(t,a);for(r=0,i=d.length;i>r;r+=1){var a=d[r];this.addTileDescendants(t,a)}this.refineNeighbors(t)}},x.prototype.finishTessellating=function(t){for(var e=0,r=this.tiles.length;r>e;e+=1){var i=this.tiles[e];this.setNeighbors(i),this.regenerateTileGeometryIfNeeded(t,i),this.currentTiles.addTile(i)}},x.prototype.setNeighbors=function(t){var e=t.sector,r=[e.maxLatitude,e.maxLongitude].toString(),i=[e.minLatitude,e.maxLongitude].toString(),n=[e.maxLatitude,e.minLongitude].toString(),o=[e.minLatitude,e.minLongitude].toString(),a=this.corners[r],s=this.corners[i],l=this.corners[n],u=this.corners[o],c=-1,h=-1,f=-1,d=-1;a.hasOwnProperty("se")?c=a.se:l.hasOwnProperty("sw")&&(c=l.sw),s.hasOwnProperty("ne")?h=s.ne:u.hasOwnProperty("nw")&&(h=u.nw),a.hasOwnProperty("nw")?f=a.nw:s.hasOwnProperty("sw")&&(f=s.sw),l.hasOwnProperty("ne")?d=l.ne:u.hasOwnProperty("se")&&(d=u.se),t.setNeighborLevel(WorldWind.NORTH,c>=0?this.tiles[c].level:null),t.setNeighborLevel(WorldWind.SOUTH,h>=0?this.tiles[h].level:null),t.setNeighborLevel(WorldWind.EAST,f>=0?this.tiles[f].level:null),t.setNeighborLevel(WorldWind.WEST,d>=0?this.tiles[d].level:null)},x.prototype.isTileVisible=function(t,e){return t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits)?!1:e.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)},x.prototype.tileMeetsRenderCriteria=function(t,e){var r=this.detailControl;return(e.sector.minLatitude>=75||e.sector.maxLatitude<=-75)&&(r*=2),e.level.isLastLevel()||!e.mustSubdivide(t,r)},x.prototype.regenerateTileGeometryIfNeeded=function(t,e){var r=t.globeStateKey+e.stateKey+t.verticalExaggeration;e.points&&e.pointsStateKey==r||(this.regenerateTileGeometry(t,e),e.pointsStateKey=r)},x.prototype.regenerateTileGeometry=function(t,e){var r=e.tileHeight+1,i=e.tileWidth+1,n=e.referencePoint,o=this.scratchElevations;o||(o=new Float64Array(r*i),this.scratchElevations=o),e.points||(e.points=new Float32Array(r*i*3)),b.fillArray(o,0),t.globe.elevationsForGrid(e.sector,r,i,e.texelSize,o),this.mustAlignNeighborElevations(t,e)&&this.alignNeighborElevations(t,e,o),b.multiplyArray(o,t.verticalExaggeration),t.globe.computePointsForGrid(e.sector,r,i,o,n,e.points),e.transformationMatrix.setTranslation(n[0],n[1],n[2])},x.prototype.mustAlignNeighborElevations=function(t,e){var r=e.level,i=e.neighborLevel(WorldWind.NORTH),n=e.neighborLevel(WorldWind.SOUTH),o=e.neighborLevel(WorldWind.EAST),a=e.neighborLevel(WorldWind.WEST);return i&&i.compare(r)<0||n&&n.compare(r)<0||o&&o.compare(r)<0||a&&a.compare(r)<0},x.prototype.alignNeighborElevations=function(t,e,r){var i,n,o,a,s=e.tileHeight+1,l=e.tileWidth+1,u=e.level,c=Math.floor(s/2)+1,h=Math.floor(l/2)+1,f=u.previousLevel(),d=this.scratchPrevElevations;if(d||(d=new Float64Array(c*h),this.scratchPrevElevations=d),b.fillArray(d,0),t.globe.elevationsForGrid(e.sector,c,h,f.texelSize,d),i=e.neighborLevel(WorldWind.NORTH),i&&i.compare(u)<0)for(o=(s-1)*l,a=(c-1)*h,n=0;h>n;n++,o+=2,a+=1)r[o]=d[a],h-1>n&&(r[o+1]=.5*(d[a]+d[a+1]));if(i=e.neighborLevel(WorldWind.SOUTH),i&&i.compare(u)<0)for(o=0,a=0,n=0;h>n;n++,o+=2,a+=1)r[o]=d[a],h-1>n&&(r[o+1]=.5*(d[a]+d[a+1]));if(i=e.neighborLevel(WorldWind.EAST),i&&i.compare(u)<0)for(o=l-1,a=h-1,n=0;c>n;n++,o+=2*l,a+=h)r[o]=d[a],c-1>n&&(r[o+l]=.5*(d[a]+d[a+h]));if(i=e.neighborLevel(WorldWind.WEST),i&&i.compare(u)<0)for(o=0,a=0,n=0;c>n;n++,o+=2*l,a+=h)r[o]=d[a],c-1>n&&(r[o+l]=.5*(d[a]+d[a+h]))},x.prototype.buildSharedGeometry=function(){var t=this.levels.tileWidth,e=this.levels.tileHeight;this.texCoords||this.buildTexCoords(t,e),this.indices||this.buildIndices(t,e)},x.prototype.buildTexCoords=function(t,e){for(var r=t+1,i=e+1,n=1/t,o=1/e,a=new Float32Array(r*i*2),s=0,l=0,u=0;i>l;l++,u+=o){l==i-1&&(u=1);for(var c=0,h=0;r>c;c++,h+=n)c==r-1&&(h=1),a[s++]=h,a[s++]=u}this.texCoords=a},x.prototype.buildIndices=function(t,e){for(var r,i=e+1,n=t+1,o=2*(i-3)*(n-2)+2*(i-3),a=[],s=0,l=1;n-2>l;l+=1){for(var u=1;i-1>u;u+=1)r=l+u*n,a[s++]=r,a[s++]=r+1;a[s++]=r+1,r=l+1+1*n,a[s++]=r}for(this.baseIndicesOffset=a.length-o,this.baseIndices=new Uint16Array(a.slice(this.baseIndicesOffset)),this.numBaseIndices=o,o=2*n-2,u=i-1,l=n-1,r=l+u*n,a[s++]=r,l=n-2;l>0;l-=1)r=l+u*n,a[s++]=r,a[s++]=r-n;for(l=0,r=l+u*n,a[s++]=r,this.indicesNorthOffset=a.length-o,this.indicesNorth=new Uint16Array(a.slice(this.indicesNorthOffset)),this.numIndicesNorth=o,o=2*n-2,u=0,l=0,r=l+u*n,a[s++]=r,l=1;n-1>l;l+=1)r=l+u*n,a[s++]=r,a[s++]=r+n;for(l=n-1,r=l+u*n,a[s++]=r,this.indicesSouthOffset=a.length-o,this.indicesSouth=new Uint16Array(a.slice(this.indicesSouthOffset)),this.numIndicesSouth=o,o=2*i-2,l=0,u=i-1,r=l+u*n,a[s++]=r,u=i-2;u>0;u-=1)r=l+u*n,a[s++]=r,a[s++]=r+1;for(u=0,r=l+u*n,a[s++]=r,this.indicesWestOffset=a.length-o,this.indicesWest=new Uint16Array(a.slice(this.indicesWestOffset)),this.numIndicesWest=o,o=2*i-2,l=n-1,u=0,r=l+u*n,a[s++]=r,u=1;i-1>u;u+=1)r=l+u*n,a[s++]=r,a[s++]=r-1;for(u=i-1,r=l+u*n,a[s++]=r,this.indicesEastOffset=a.length-o,this.indicesEast=new Uint16Array(a.slice(this.indicesEastOffset)),this.numIndicesEast=o,o=2*n-2,u=i-1,l=n-1,r=l+u*n,a[s++]=r,l=n-2;l>0;l-=1)r=(l+1&-2)+u*n,a[s++]=r,r=l+(u-1)*n,a[s++]=r;for(l=0,r=l+u*n,a[s++]=r,this.indicesLoresNorthOffset=a.length-o,this.indicesLoresNorth=new Uint16Array(a.slice(this.indicesLoresNorthOffset)),this.numIndicesLoresNorth=o,o=2*n-2,u=0,l=0,r=l+u*n,a[s++]=r,l=1;n-1>l;l+=1)r=(-2&l)+u*n,a[s++]=r,r=l+(u+1)*n,a[s++]=r;for(l=n-1,r=l+u*n,a[s++]=r,this.indicesLoresSouthOffset=a.length-o,this.indicesLoresSouth=new Uint16Array(a.slice(this.indicesLoresSouthOffset)),this.numIndicesLoresSouth=o,o=2*i-2,l=0,u=i-1,r=l+u*n,a[s++]=r,u=i-2;u>0;u-=1)r=l+(u+1&-2)*n,a[s++]=r,r=l+1+u*n,a[s++]=r;for(u=0,r=l+u*n,a[s++]=r,this.indicesLoresWestOffset=a.length-o,this.indicesLoresWest=new Uint16Array(a.slice(this.indicesLoresWestOffset)),this.numIndicesLoresWest=o,o=2*i-2,l=n-1,u=0,r=l+u*n,a[s++]=r,u=1;i-1>u;u+=1)r=l+(-2&u)*n,a[s++]=r,r=l-1+u*n,a[s++]=r;u=i-1,r=l+u*n,a[s++]=r,this.indicesLoresEastOffset=a.length-o,this.indicesLoresEast=new Uint16Array(a.slice(this.indicesLoresEastOffset)),this.numIndicesLoresEast=o;var c=this.buildWireframeIndices(t,e),h=this.buildOutlineIndices(t,e);a=a.concat(c),this.wireframeIndicesOffset=a.length-this.numWireframeIndices,a=a.concat(h),this.outlineIndicesOffset=a.length-this.numOutlineIndices,this.indices=new Uint16Array(a)},x.prototype.buildWireframeIndices=function(t,e){var r,i,n,o=e+1,a=t+1,s=2*t*o+2*e*a,l=[],u=a,c=0;for(i=0;o>i;i+=1)for(r=0;t>r;r+=1)n=r+i*u,l[c]=n,l[c+1]=n+1,c+=2;for(r=0;a>r;r+=1)for(i=0;e>i;i+=1)n=r+i*u,l[c]=n,l[c+1]=n+u,c+=2;return this.numWireframeIndices=s,l},x.prototype.buildOutlineIndices=function(t,e){var r,i,n,o=e+1,a=t+1,s=2*(o-2)+2*a+1,l=[],u=0;for(i=0,r=0;a>r;r+=1)n=r+i*a,l[u]=n,u+=1;for(r=a-1,i=1;o>i;i+=1)n=r+i*a,l[u]=n,u+=1;for(i=o-1,r=a-1;r>=0;r-=1)n=r+i*a,l[u]=n,u+=1;for(r=0,i=o-1;i>=0;i-=1)n=r+i*a,l[u]=n,u+=1;return this.numOutlineIndices=s,l},x.prototype.cacheSharedGeometryVBOs=function(t){var e=t.currentGlContext,r=t.gpuResourceCache,i=r.resourceForKey(this.texCoordVboCacheKey);i||(i=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,this.texCoords,e.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),r.putResource(this.texCoordVboCacheKey,i,4*this.texCoords.length/2));var n=r.resourceForKey(this.indicesVboCacheKey);n||(n=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),r.putResource(this.indicesVboCacheKey,n,2*this.indices.length))},x}),i("../src/worldwind/globe/Globe",["../geom/Angle","../error/ArgumentError","../geom/BoundingBox","../globe/ElevationModel","../geom/Line","../geom/Location","../util/Logger","../geom/Matrix","../geom/Position","../projections/ProjectionWgs84","../geom/Sector","../globe/Tessellator","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d){"use strict";var p=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","constructor","Elevation model is null or undefined."));this.elevationModel=t,this.equatorialRadius=6378137,this.polarRadius=6356752.3,this.eccentricitySquared=.00669437999013,this.tessellator=new h,this._projection=r||new u,this._offset=0,this.offsetVector=new f(0,0,0),this.id=++p.idPool,this.modelview=s.fromIdentity(),this.forwardRay=new f(0,0,0),this.originPos=new l(0,0,0),this.originPoint=new f(0,0,0),this.origin=s.fromIdentity(),this._stateKey="globe "+this.id.toString()+" "};return p.idPool=0,Object.defineProperties(p.prototype,{stateKey:{get:function(){return this._stateKey+this.elevationModel.stateKey+"offset "+this.offset.toString()+" "+this.projection.stateKey}},continuous:{get:function(){return this.projection.continuous}},projection:{get:function(){return this._projection},set:function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","projection","missingProjection"));this.projection!=t&&(this.tessellator=new h),this._projection=t}},projectionLimits:{get:function(){return this._projection.projectionLimits}},offset:{get:function(){return this._offset},set:function(t){this._offset=t,this.offsetVector[0]=2*t*Math.PI*this.equatorialRadius}}}),p.prototype.is2D=function(){return this.projection.is2D},p.prototype.computePointFromPosition=function(t,r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointFromPosition","missingResult"));return this.projection.geographicToCartesian(this,t,r,i,this.offsetVector,n)},p.prototype.computePointFromLocation=function(t,r,i){if(!i)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointFromLocation","missingResult"));return this.computePointFromPosition(t,r,0,i)},p.prototype.computePointsForGrid=function(t,r,i,n,o,s){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointsFromPositions","missingSector"));if(1>r||1>i)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointsFromPositions","Number of latitude or longitude locations is less than one."));var l=r*i;if(!n||n.length<l)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointsFromPositions","Elevations array is null, undefined or insufficient length."));if(!s||s.length<l)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointsFromPositions","Result array is null, undefined or insufficient length."));return this.projection.geographicToCartesianGrid(this,t,r,i,n,o,this.offsetVector,s)},p.prototype.computePositionFromPoint=function(t,r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePositionFromPoint","missingResult"));return this.projection.cartesianToGeographic(this,t,r,i,this.offsetVector,n),this.continuous&&(n.longitude<-180?n.longitude+=360:n.longitude>180&&(n.longitude-=360)),n},p.prototype.radiusAt=function(e,r){var i=Math.sin(e*t.DEGREES_TO_RADIANS),n=this.equatorialRadius/Math.sqrt(1-this.eccentricitySquared*i*i);return n*Math.sqrt(1+(this.eccentricitySquared*this.eccentricitySquared-2*this.eccentricitySquared)*i*i)},p.prototype.surfaceNormalAtLocation=function(r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","surfaceNormalAtLocation","missingResult"));if(this.is2D())return n[0]=0,n[1]=0,n[2]=1,n;var o=Math.cos(r*t.DEGREES_TO_RADIANS),s=Math.cos(i*t.DEGREES_TO_RADIANS),l=Math.sin(r*t.DEGREES_TO_RADIANS),u=Math.sin(i*t.DEGREES_TO_RADIANS),c=this.equatorialRadius*this.equatorialRadius,h=this.polarRadius*this.polarRadius;return n[0]=o*u/c,n[1]=(1-this.eccentricitySquared)*l/h,n[2]=o*s/c,n.normalize()},p.prototype.surfaceNormalAtPoint=function(t,r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","surfaceNormalAtPoint","missingResult"));if(this.projection.surfaceNormalAtPoint)return this.projection.surfaceNormalAtPoint(this,t,r,i,n);if(this.is2D())return n[0]=0,n[1]=0,n[2]=1,n;var o=this.equatorialRadius*this.equatorialRadius,s=this.polarRadius*this.polarRadius;return n[0]=t/o,n[1]=r/s,n[2]=i/o,n.normalize()},p.prototype.northTangentAtLocation=function(t,r,i){if(!i)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","northTangentAtLocation","missingResult"));return this.projection.northTangentAtLocation(this,t,r,i)},p.prototype.northTangentAtPoint=function(t,r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","northTangentAtPoint","missingResult"));return this.projection.northTangentAtPoint(this,t,r,i,this.offsetVector,n)},p.prototype.intersectsFrustum=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","intersectsFrustum","missingFrustum"));if(this.is2D()){var i=new r;return i.setToSector(c.FULL_SPHERE,this,this.elevationModel.minElevation,this.elevationModel.maxElevation),i.intersectsFrustum(t)}return t.far.distance<=this.equatorialRadius?!1:t.left.distance<=this.equatorialRadius?!1:t.right.distance<=this.equatorialRadius?!1:t.top.distance<=this.equatorialRadius?!1:t.bottom.distance<=this.equatorialRadius?!1:t.near.distance<=this.equatorialRadius?!1:!0},p.prototype.intersectsLine=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","intersectWithRay","missingLine"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","intersectsLine","missingResult"));var i,n=t.direction[0],o=t.direction[1],s=t.direction[2],l=t.origin[0],u=t.origin[1],c=t.origin[2];if(this.is2D())return 0==s&&0!=c?!1:(i=-c/s,0>i?!1:(r[0]=l+n*i,r[1]=u+o*i,r[2]=c+s*i,!0));var h,f,d,p,m=this.equatorialRadius,g=m*m,y=m/this.polarRadius,v=y*y;return h=n*n+v*o*o+s*s,f=2*(l*n+v*u*o+c*s),d=l*l+v*u*u+c*c-g,p=f*f-4*h*d,0>p?!1:(i=(-f-Math.sqrt(p))/(2*h),i>0?(r[0]=l+n*i,r[1]=u+o*i,r[2]=c+s*i,!0):(i=(-f+Math.sqrt(p))/(2*h),i>0?(r[0]=l+n*i,r[1]=u+o*i,r[2]=c+s*i,!0):!1))},p.prototype.elevationTimestamp=function(){return this.elevationModel.timestamp},p.prototype.minElevation=function(){return this.elevationModel.minElevation},p.prototype.maxElevation=function(){return this.elevationModel.maxElevation},p.prototype.minAndMaxElevationsForSector=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","minAndMaxElevationsForSector","missingSector"));return this.elevationModel.minAndMaxElevationsForSector(t)},p.prototype.elevationAtLocation=function(t,e){return this.elevationModel.elevationAtLocation(t,e)},p.prototype.elevationsForGrid=function(t,r,i,n,o){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","elevationsForSector","missingSector"));if(0>=r||0>=i)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","elevationsForSector","numLat or numLon is less than 1"));if(!o||o.length<r*i)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","elevationsForSector","missingArray"));return this.elevationModel.elevationsForGrid(t,r,i,n,o)},p.prototype.getRadiusAt=function(t,e){var r=Math.sin(d.toRadians(t)),i=this.eccentricitySquared,n=this.equatorialRadius/Math.sqrt(1-i*r*r);return n*Math.sqrt(1+(i*i-2*i)*r*r)},p.prototype.computeViewHeading=function(t,e){var r=d.toRadians(e),i=Math.cos(r),n=Math.sin(r),o=i*t[0]-n*t[4],a=n*t[5]-i*t[1];return d.toDegrees(Math.atan2(a,o))},p.prototype.computeViewTilt=function(t){var e=t[10],r=Math.sqrt(t[2]*t[2]+t[6]*t[6]);return d.toDegrees(Math.atan2(r,e))},p.prototype.cameraToCartesianTransform=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","cameraToCartesianTransform","missing camera"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","cameraToCartesianTransform","missing result"));return this._projection.geographicToCartesianTransform(this,t.latitude,t.longitude,t.altitude,null,r),r.multiplyByRotation(0,0,1,-t.heading),r.multiplyByRotation(1,0,0,t.tilt),r.multiplyByRotation(0,0,1,t.roll),r},p.prototype.horizonDistance=function(t,r){var i=t,n=this.equatorialRadius,o=Math.sqrt(i*(2*n+i));if(1==arguments.length)return o;if(2==arguments.length){var s=r,l=Math.sqrt(s*(2*n+s));return o+l}throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","horizon distance","Wrong amount of parameters. Expected: 2 or 1, Actual: "+arguments.length))},p.prototype.cameraToLookAt=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","cameraToLookAt","missing camera"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","cameraToLookAt","missing result"));var i=this.cameraToCartesianTransform(t,this.modelview);i.invertOrthonormal(this.modelview);var o=new f,s=new f;this.modelview.extractEyePoint(o),this.modelview.extractForwardVector(s);var l=new n(o,s);if(!this.intersectsLine(l,this.originPoint)){var u=this.horizonDistance(t.altitude);l.pointAt(u,this.originPoint)}return this.computePositionFromPoint(this.originPoint[0],this.originPoint[1],this.originPoint[2],this.originPos),this._projection.cartesianToLocalTransform(this,this.originPoint[0],this.originPoint[1],this.originPoint[2],null,this.origin),this.modelview.multiplyMatrix(this.origin),r.latitude=this.originPos.latitude,r.longitude=this.originPos.longitude,r.altitude=this.originPos.altitude,r.range=-this.modelview[11],r.heading=this.computeViewHeading(this.modelview,t.roll),r.tilt=this.computeViewTilt(this.modelview),r.roll=t.roll,r},p.prototype.lookAtToCamera=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","lookAtToCamera","missing look at"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","lookAtToCamera","missing result"));return this.lookAtToCartesianTransform(t,this.modelview).invertOrthonormal(this.modelview),this.modelview.extractEyePoint(this.originPoint),
this.computePositionFromPoint(this.originPoint[0],this.originPoint[1],this.originPoint[2],this.originPos),this._projection.cartesianToLocalTransform(this,this.originPoint[0],this.originPoint[1],this.originPoint[2],null,this.origin),this.modelview.multiplyMatrix(this.origin),r.latitude=this.originPos.latitude,r.longitude=this.originPos.longitude,r.altitude=this.originPos.altitude,r.heading=this.computeViewHeading(this.modelview,t.roll),r.tilt=this.computeViewTilt(this.modelview),r.roll=t.roll,r},p.prototype.lookAtToCartesianTransform=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","lookAtToCartesianTransform","missing look at"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","lookAtToCartesianTransform","missing result"));return this._projection.geographicToCartesianTransform(this,t.latitude,t.longitude,t.altitude,null,r),r.multiplyByRotation(0,0,1,-t.heading),r.multiplyByRotation(1,0,0,t.tilt),r.multiplyByRotation(0,0,1,t.roll),r.multiplyByTranslation(0,0,t.range),r},p}),i("../src/worldwind/cache/GpuResourceCache",["../util/AbsentResourceList","../error/ArgumentError","../util/ImageSource","../util/Logger","../cache/MemoryCache","../render/Texture"],function(t,e,r,i,n,o){"use strict";var a=function(r,o){if(!r||1>r)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","constructor","Specified cache capacity is undefined, 0 or negative."));if(!o||0>o||o>=r)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","constructor","Specified cache low-water value is undefined, negative or not less than the capacity."));this.entries=new n(r,o),this.cacheKeyPool=0,this.currentRetrievals={},this.absentResourceList=new t(3,6e4)};return Object.defineProperties(a.prototype,{capacity:{get:function(){return this.entries.capacity}},lowWater:{get:function(){return this.entries.lowWater}},usedCapacity:{get:function(){return this.entries.usedCapacity}},freeCapacity:{get:function(){return this.entries.freeCapacity}}}),a.prototype.generateCacheKey=function(){return"GpuResourceCache "+ ++this.cacheKeyPool},a.prototype.putResource=function(t,n,o){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","putResource","missingKey."));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","putResource","missingResource."));if(!o||1>o)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","putResource","The specified resource size is undefined or less than 1."));var a={resource:n};this.entries.putEntry(t instanceof r?t.key:t,a,o)},a.prototype.resourceForKey=function(t){var e=t instanceof r?this.entries.entryForKey(t.key):this.entries.entryForKey(t);return e?e.resource:null},a.prototype.containsResource=function(t){return this.entries.containsKey(t instanceof r?t.key:t)},a.prototype.removeResource=function(t){this.entries.removeEntry(t instanceof r?t.key:t)},a.prototype.clear=function(){this.entries.clear(!1)},a.prototype.retrieveTexture=function(t,e,n){if(!e)return null;if(e instanceof r){var a=new o(t,e.image,n);return this.putResource(e.key,a,a.size),a}if(this.currentRetrievals[e]||this.absentResourceList.isResourceAbsent(e))return null;var s=this,l=new Image;return l.onload=function(){i.log(i.LEVEL_INFO,"Image retrieval succeeded: "+e);var r=new o(t,l,n);s.putResource(e,r,r.size),delete s.currentRetrievals[e],s.absentResourceList.unmarkResourceAbsent(e);var a=document.createEvent("Event");a.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(a)},l.onerror=function(){delete s.currentRetrievals[e],s.absentResourceList.markResourceAbsent(e),i.log(i.LEVEL_WARNING,"Image retrieval failed: "+e)},this.currentRetrievals[e]=e,l.crossOrigin="anonymous",l.src=e,null},a}),i("../src/worldwind/pick/PickedObjectList",[],function(){"use strict";var t=function(){this.objects=[]};return t.prototype.hasNonTerrainObjects=function(){return this.objects.length>1||1===this.objects.length&&null==this.terrainObject()},t.prototype.terrainObject=function(){for(var t=0,e=this.objects.length;e>t;t++)if(this.objects[t].isTerrain)return this.objects[t];return null},t.prototype.add=function(t){if(t)if(t.isTerrain){for(var e=this.objects.length,r=0,i=this.objects.length;i>r;r++)if(this.objects[r].isTerrain){e=r;break}this.objects[e]=t}else this.objects.push(t)},t.prototype.clear=function(){this.objects=[]},t.prototype.topPickedObject=function(){var t=this.objects.length;if(t>1)for(var e=0;t>e;e++)if(this.objects[[e].isOnTop])return this.objects[e];return t>0?this.objects[0]:null},t}),i("../src/worldwind/render/ScreenCreditController",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Logger","../geom/Matrix","../util/Offset","../pick/PickedObject","../render/Renderable","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(){this.imageUrls=[],this.stringCredits=[],this.imageCreditSize=64,this.margin=5,this.opacity=.5,this.creditFont=new i(14)};return h.scratchMatrix=o.fromIdentity(),h.imageTransform=o.fromIdentity(),h.texCoordMatrix=o.fromIdentity(),h.prototype.clear=function(){this.imageUrls=[],this.stringCredits=[]},h.prototype.addImageCredit=function(e){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenCreditController","addImageCredit","missingUrl"));-1===this.imageUrls.indexOf(e)&&this.imageUrls.push(e)},h.prototype.addStringCredit=function(e,i){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenCreditController","addStringCredit","missingText"));if(!i)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenCreditController","addStringCredit","missingColor"));-1===this.stringCredits.indexOf(e)&&this.stringCredits.push({text:e,color:i||r.WHITE})},h.prototype.drawCredits=function(t){if((0!==this.imageUrls.length||0!==this.stringCredits.length)&&!t.pickingMode&&t.timestamp!=this.lastFrameTimestamp){this.lastFrameTimestamp=t.timestamp,this.beginDrawingCredits(t);for(var e,r=t.navigatorState.viewport.width-(this.margin+this.imageCreditSize),i=0,n=0;n<this.imageUrls.length;n++)e=this.drawImageCredit(t,this.imageUrls[n],r,this.margin),e>0&&(r-=this.margin+this.imageCreditSize,i=c.max(e,i));for(var o=i+this.margin,a=0;a<this.stringCredits.length;a++)this.drawStringCredit(t,this.stringCredits[a],o),o+=this.margin+15;this.endDrawingCredits(t)}},h.prototype.beginDrawingCredits=function(t){var r,i=t.currentGlContext;t.findAndBindProgram(e),r=t.currentProgram,i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer3()),i.vertexAttribPointer(r.vertexPointLocation,3,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer()),i.vertexAttribPointer(r.vertexTexCoordLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.vertexPointLocation),i.enableVertexAttribArray(r.vertexTexCoordLocation),r.loadTextureUnit(i,i.TEXTURE0),r.loadModulateColor(i,!1)},h.prototype.endDrawingCredits=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.enable(e.DEPTH_TEST)},h.prototype.drawImageCredit=function(t,e,i,n){var o,a,s,l,u,c;return(l=t.gpuResourceCache.resourceForKey(e))?(o=l.imageWidth,a=l.imageHeight,s=o<=this.imageCreditSize&&this.imageHeight<=this.imageCreditSize?1:o>=a?this.imageCreditSize/o:this.imageCreditSize/a,h.imageTransform.setTranslation(i,n,0),h.imageTransform.setScale(s*o,s*a,1),u=t.currentGlContext,c=t.currentProgram,h.scratchMatrix.copy(t.screenProjection),h.scratchMatrix.multiplyMatrix(h.imageTransform),c.loadModelviewProjection(u,h.scratchMatrix),c.loadTextureEnabled(u,!0),c.loadColor(u,r.WHITE),c.loadOpacity(u,this.opacity),h.texCoordMatrix.setToIdentity(),h.texCoordMatrix.multiplyByTextureTransform(l),c.loadTextureMatrix(u,h.texCoordMatrix),l.bind(t)&&u.drawArrays(u.TRIANGLE_STRIP,0,4),a):(t.gpuResourceCache.retrieveTexture(t.currentGlContext,e),0)},h.prototype.drawStringCredit=function(t,e,r){var i,n,o,a,s,l,u;return a=e.text+this.creditFont.toString(),o=t.gpuResourceCache.resourceForKey(a),o||(o=t.textSupport.createTexture(t,e.text,this.creditFont,!1),t.gpuResourceCache.putResource(a,o,o.size)),i=o.imageWidth,n=o.imageHeight,u=t.navigatorState.viewport.width-(i+this.margin),h.imageTransform.setTranslation(u,r,0),h.imageTransform.setScale(i,n,1),s=t.currentGlContext,l=t.currentProgram,h.scratchMatrix.copy(t.screenProjection),h.scratchMatrix.multiplyMatrix(h.imageTransform),l.loadModelviewProjection(s,h.scratchMatrix),l.loadTextureEnabled(s,!0),l.loadColor(s,e.color),l.loadOpacity(s,this.opacity),h.texCoordMatrix.setToIdentity(),h.texCoordMatrix.multiplyByTextureTransform(o),l.loadTextureMatrix(s,h.texCoordMatrix),o.bind(t)&&s.drawArrays(s.TRIANGLE_STRIP,0,4),!0},h}),i("../src/worldwind/util/HashMap",[],function(){"use strict";var t=function(){this._entries=Object.create(null)};return t.prototype.get=function(t){return this._entries[t]},t.prototype.set=function(t,e){this._entries[t]=e},t.prototype.remove=function(t){delete this._entries[t]},t.prototype.contains=function(t){return t in this._entries},t.reIndex=function(e,r,i){var n=new t;for(var o in e._entries){var a=parseInt(o);a>=r&&(a+=i);var s=e.get(o);s.index=a,n.set(a,s)}return n},t}),i("../src/worldwind/util/PolygonSplitter",["./HashMap","../geom/Location","../geom/Position","./WWMath"],function(t,e,r,i){"use strict";var n={addedIndex:-1,poleIndexOffset:-1,splitContours:function(t,e){for(var r=!1,i=0,n=t.length;n>i;i++){var o=this.splitContour(t[i]);o.polygons.length>1&&(r=!0),e.push(o)}return r},splitContour:function(r){var i=new t,n=[],o=[],a=[],s=[],l=-1,u=this.findIntersectionAndPole(r,n,o,i);return 0===o.length?(a.push(n),s.push(i),this.formatContourOutput(a,u,l,s)):(o.length>2&&o.sort(function(t,e){return e.latitude-t.latitude}),u!==e.poles.NONE&&(n=this.handleOnePole(n,o,i,u),i=this.reindexIntersections(o,i,this.poleIndexOffset)),0===o.length?(a.push(n),s.push(i),l=0,this.formatContourOutput(a,u,l,s)):(this.linkIntersections(o,i),l=this.makePolygons(n,o,i,a,s),this.formatContourOutput(a,u,l,s)))},findIntersectionAndPole:function(t,r,n,o){var a=!1,s=90,l=-90;this.addedIndex=-1;for(var u=0,c=t.length;c>u;u++){var h=t[u],f=t[(u+1)%c];s=Math.min(s,h.latitude),l=Math.max(l,h.latitude);var d=e.locationsCrossDateLine([h,f]);if(d){a=!a;var p=e.meridianIntersection(h,f,180);null===p&&(p=(h.latitude+f.latitude)/2);var m=180*i.signum(h.longitude)||180,g=this.createPoint(p,m,h.altitude),y=this.createPoint(p,-m,f.altitude);this.safeAdd(r,h,u,c);var v=r.length;o.set(v,this.makeIntersectionEntry(v)),o.set(v+1,this.makeIntersectionEntry(v+1)),n.push({indexEnd:v,indexStart:v+1,latitude:p}),r.push(g),r.push(y),this.safeAdd(r,f,u+1,c)}else this.safeAdd(r,h,u,c),this.safeAdd(r,f,u+1,c)}var E=e.poles.NONE;return a&&(E=this.determinePole(s,l)),E},determinePole:function(t,r){var i;return i=t>0?e.poles.NORTH:0>r?e.poles.SOUTH:Math.abs(r)>=Math.abs(t)?e.poles.NORTH:e.poles.SOUTH},handleOnePole:function(t,r,i,n){var o;if(n===e.poles.NORTH)var a=r.shift(),s=90;else n===e.poles.SOUTH&&(a=r.pop(),s=-90);var l=i.get(a.indexEnd),u=i.get(a.indexStart);l.forPole=!0,u.forPole=!0,this.poleIndexOffset=a.indexStart,o=t.slice(0,a.indexEnd+1);var c=this.createPoint(s,t[l.index].longitude,t[l.index].altitude),h=this.createPoint(s,t[u.index].longitude,t[u.index].altitude);return o.push(c,h),o=o.concat(t.slice(this.poleIndexOffset))},linkIntersections:function(t,e){for(var r=0;r<t.length-1;r+=2){var i=t[r],n=t[r+1],o=e.get(i.indexEnd),a=e.get(i.indexStart),s=e.get(n.indexEnd),l=e.get(n.indexStart);o.linkTo=n.indexStart,a.linkTo=n.indexEnd,s.linkTo=i.indexStart,l.linkTo=i.indexEnd}},reindexIntersections:function(e,r,i){r=t.reIndex(r,i,2);for(var n=0,o=e.length;o>n;n++)e[n].indexEnd>=i&&(e[n].indexEnd+=2),e[n].indexStart>=i&&(e[n].indexStart+=2);return r},makePolygons:function(e,r,i,n,o){for(var a=-1,s=0;s<r.length-1;s+=2){var l=r[s],u=r[s+1],c=l.indexStart,h=u.indexEnd,f=[],d=new t,p=this.makePolygon(c,h,e,i,f,d);f.length&&(n.push(f),o.push(d),p&&(a=n.length-1)),c=u.indexStart,h=l.indexEnd,f=[],d=new t,p=this.makePolygon(c,h,e,i,f,d),f.length&&(n.push(f),o.push(d),p&&(a=n.length-1))}return a},makePolygon:function(t,e,r,i,n,o){var a=!1,s=r.length,l=!1;t>e&&(e+=s);for(var u=t;e>=u;u++){var c=u%s,h=r[c],f=i.get(c);if(f){if(f.visited)break;if(n.push(h),o.set(n.length-1,f),f.forPole)l=!0;else{if(a&&(u=f.linkTo-1,u+1===t))break;a=!a,f.visited=!0}}else n.push(h)}return l},safeAdd:function(t,e,r,i){this.addedIndex<r&&this.addedIndex<i-1&&(t.push(e),this.addedIndex=r)},createPoint:function(t,i,n){return null==n?new e(t,i):new r(t,i,n)},formatContourOutput:function(t,e,r,i){return{polygons:t,pole:e,poleIndex:r,iMap:i}},makeIntersectionEntry:function(t){return null==t&&(t=-1),{visited:!1,forPole:!1,index:t,linkTo:-1}}};return n}),i("../src/worldwind/shapes/ShapeAttributes",["../util/Color","../util/ImageSource"],function(t,e){"use strict";var r=function(e){this._drawInterior=e?e._drawInterior:!0,this._drawOutline=e?e._drawOutline:!0,this._enableLighting=e?e._enableLighting:!1,this._interiorColor=e?e._interiorColor:t.WHITE,this._outlineColor=e?e._outlineColor:t.RED,this._outlineWidth=e?e._outlineWidth:1,this._outlineStippleFactor=e?e._outlineStippleFactor:0,this._outlineStipplePattern=e?e._outlineStipplePattern:61680,this._imageSource=e?e._imageSource:null,this._depthTest=e?e._depthTest:!0,this._drawVerticals=e?e._drawVerticals:!1,this._applyLighting=e?e._applyLighting:!1,this.stateKeyInvalid=!0};return r.prototype.computeStateKey=function(){return"di "+this._drawInterior+" do "+this._drawOutline+" el "+this._enableLighting+" ic "+this._interiorColor.toHexString(!0)+" oc "+this._outlineColor.toHexString(!0)+" ow "+this._outlineWidth+" osf "+this._outlineStippleFactor+" osp "+this._outlineStipplePattern+" is "+(this._imageSource?this.imageSource instanceof e?this.imageSource.key:this.imageSource:"null")+" dt "+this._depthTest+" dv "+this._drawVerticals+" li "+this._applyLighting},Object.defineProperties(r.prototype,{stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}},drawInterior:{get:function(){return this._drawInterior},set:function(t){this._drawInterior=t,this.stateKeyInvalid=!0}},drawOutline:{get:function(){return this._drawOutline},set:function(t){this._drawOutline=t,this.stateKeyInvalid=!0}},enableLighting:{get:function(){return this._enableLighting},set:function(t){this._enableLighting=t,this.stateKeyInvalid=!0}},interiorColor:{get:function(){return this._interiorColor},set:function(t){this._interiorColor=t,this.stateKeyInvalid=!0}},outlineColor:{get:function(){return this._outlineColor},set:function(t){this._outlineColor=t,this.stateKeyInvalid=!0}},outlineWidth:{get:function(){return this._outlineWidth},set:function(t){this._outlineWidth=t,this.stateKeyInvalid=!0}},outlineStipplePattern:{get:function(){return this._outlineStipplePattern},set:function(t){this._outlineStipplePattern=t,this.stateKeyInvalid=!0}},outlineStippleFactor:{get:function(){return this._outlineStippleFactor},set:function(t){this._outlineStippleFactor=t,this.stateKeyInvalid=!0}},imageSource:{get:function(){return this._imageSource},set:function(t){this._imageSource=t,this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(t){this._depthTest=t,this.stateKeyInvalid=!0}},drawVerticals:{get:function(){return this._drawVerticals},set:function(t){this._drawVerticals=t,this.stateKeyInvalid=!0}},applyLighting:{get:function(){return this._applyLighting},set:function(t){this._applyLighting=t,this.stateKeyInvalid=!0}}}),r}),i("../src/worldwind/shapes/SurfaceShape",["../error/AbstractError","../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../error/NotYetImplementedError","../pick/PickedObject","../util/PolygonSplitter","../render/Renderable","../geom/Sector","../shapes/ShapeAttributes","../error/UnsupportedOperationError","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f){"use strict";var d=function(t){l.call(this),this._displayName="Surface Shape",this._attributes=t?t:new c(null),this._highlightAttributes=null,this._highlighted=!1,this._enabled=!0,this._pathType=WorldWind.GREAT_CIRCLE,this._maximumNumEdgeIntervals=d.DEFAULT_NUM_EDGE_INTERVALS,this._polarThrottle=d.DEFAULT_POLAR_THROTTLE,this._sector=null,this.pickDelegate=null,this._sectors=[],this._locations=null,this._boundaries=null,this._interiorGeometry=null,this._outlineGeometry=null,this._isInteriorInhibited=!1,this.stateKeyInvalid=!0,this._attributesStateKey=null,this.isPrepared=!1,this.layer=null,this.pickColor=null,this.contours=[],this.containsPole=!1,this.crossesAntiMeridian=!1};return d.prototype=Object.create(l.prototype),Object.defineProperties(d.prototype,{stateKey:{get:function(){if(this._attributesStateKey){var t=null;this._highlighted?this._highlightAttributes&&(t=this._highlightAttributes.stateKey):this._attributes&&(t=this._attributes.stateKey),t!=this._attributesStateKey&&(this._attributesStateKey=t,this.stateKeyInvalid=!0)}else this._highlighted?this._highlightAttributes&&(this._attributesStateKey=this._highlightAttributes.stateKey):this._attributes&&(this._attributesStateKey=this._attributes.stateKey),this._attributesStateKey&&(this.stateKeyInvalid=!0);return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey()),this._stateKey}},displayName:{get:function(){return this._displayName},set:function(t){this.stateKeyInvalid=!0,this._displayName=t}},attributes:{get:function(){return this._attributes},set:function(t){this.stateKeyInvalid=!0,this._attributes=t,this._attributesStateKey=t.stateKey}},highlightAttributes:{get:function(){return this._highlightAttributes},set:function(t){this.stateKeyInvalid=!0,this._highlightAttributes=t}},highlighted:{get:function(){return this._highlighted},set:function(t){this.stateKeyInvalid=!0,this._highlighted=t}},enabled:{get:function(){return this._enabled},set:function(t){this.stateKeyInvalid=!0,this._enabled=t}},pathType:{get:function(){return this._pathType},set:function(t){this.stateKeyInvalid=!0,this._pathType=t}},maximumNumEdgeIntervals:{get:function(){return this._maximumNumEdgeIntervals},set:function(t){this.stateKeyInvalid=!0,this._maximumNumEdgeIntervals=t}},polarThrottle:{get:function(){return this._polarThrottle},set:function(t){this.stateKeyInvalid=!0,this._polarThrottle=t}},sector:{get:function(){return this._sector}}}),d.staticStateKey=function(t){return t.stateKeyInvalid=!1,t.highlighted&&t._highlightAttributes?t._attributesStateKey=t._highlightAttributes.stateKey:t._attributes?t._attributesStateKey=t._attributes.stateKey:t._attributesStateKey=null,"dn "+t.displayName+" at "+(t._attributesStateKey?t._attributesStateKey:"null")+" hi "+t.highlighted+" en "+t.enabled+" pt "+t.pathType+" ne "+t.maximumNumEdgeIntervals+" po "+t.polarThrottle+" se ["+t.sector.minLatitude+","+t.sector.maxLatitude+","+t.sector.minLongitude+","+t.sector.maxLongitude+"]"},d.prototype.computeStateKey=function(){return d.staticStateKey(this)},d.prototype.area=function(t,e){throw new o(n.logMessage(n.LEVEL_SEVERE,"SurfaceShape","area","notYetImplemented"))},d.prototype.computeBoundaries=function(e){throw new t(n.logMessage(n.LEVEL_SEVERE,"SurfaceShape","computeBoundaries","abstractInvocation"))},d.prototype.render=function(t){this.enabled&&(this.layer=t.currentLayer,this.prepareBoundaries(t),t.surfaceShapeTileBuilder.insertSurfaceShape(this))},d.prototype.interpolateLocations=function(t){var e,r,i,n=t[0],o=n,a=!0,s=!0,l=0,u=!0;for(this._locations=[n],r=1,i=t.length;i>r;r+=1)e=o,s=a,o=t[r],a=o.latitude==n.latitude&&o.longitude==n.longitude,u=!0,(a||s)&&(l+=1,l>2&&(u=!1)),u&&this.interpolateEdge(e,o,this._locations),this._locations.push(o),e=o;this._isInteriorInhibited||(e.latitude!=n.latitude||e.longitude!=n.longitude)&&(this.interpolateEdge(e,n,this._locations),this._locations.push(n))},d.prototype.interpolateEdge=function(t,e,r){var n,o,a=i.greatCircleDistance(t,e),s=Math.round(this._maximumNumEdgeIntervals*a/Math.PI);if(s>0){n=1/s,o=t;for(var l=this.throttledStep(n,o);1>l;l+=this.throttledStep(n,o))o=new i(0,0),i.interpolateAlongPath(this._pathType,l,t,e,o),180===t.longitude&&180===e.longitude?o.longitude=180:-180===t.longitude&&-180===e.longitude&&(o.longitude=-180),r.push(o)}},d.prototype.throttledStep=function(t,r){var i=Math.cos(r.latitude*e.DEGREES_TO_RADIANS);i*=i;var n=this._polarThrottle/(1+this._polarThrottle);return t*(1-n+n*i)},d.prototype.prepareBoundaries=function(t){if(!this.isPrepared){this._boundaries||this.computeBoundaries(t);var e=this.formatBoundaries();this.normalizeAngles(e),e=this.interpolateBoundaries(e);var r=[],i=s.splitContours(e,r);this.contours=r,this.crossesAntiMeridian=i,this.prepareGeometry(t,r),this.prepareSectors(),this.isPrepared=!0}},d.prototype.formatBoundaries=function(){var t=[];return this._boundaries.length?(null!=this._boundaries[0].latitude?t.push(this._boundaries):t=this._boundaries,t):t},d.prototype.normalizeAngles=function(t){for(var r=0,i=t.length;i>r;r++)for(var n=t[r],o=0,a=n.length;a>o;o++){var s=n[o];(s.longitude<-180||s.longitude>180)&&(s.longitude=e.normalizedDegreesLongitude(s.longitude)),(s.latitude<-90||s.latitude>90)&&(s.latitude=e.normalizedDegreesLatitude(s.latitude))}},d.prototype.interpolateBoundaries=function(t){for(var e=[],r=0,i=t.length;i>r;r++){var n=t[r];this.interpolateLocations(n),e.push(this._locations.slice()),this._locations.length=0}return e},d.prototype.computeSectors=function(t){return this._sectors&&this._sectors.length>0?this._sectors:(this.prepareBoundaries(t),this._sectors)},d.prototype.prepareSectors=function(){this.determineSectors(),this.crossesAntiMeridian?this.sectorsOverAntiMeridian():this.sectorsNotOverAntiMeridian()},d.prototype.determineSectors=function(){for(var t=0,e=this.contours.length;e>t;t++){var r=this.contours[t],n=r.polygons;r.sectors=[];for(var o=0,a=n.length;a>o;o++){var s=n[o],l=new u(0,0,0,0);if(l.setToBoundingSector(s),this._pathType===WorldWind.GREAT_CIRCLE){var c=i.greatCircleArcExtremeLocations(s),h=Math.min(l.minLatitude,c[0].latitude),f=Math.max(l.maxLatitude,c[1].latitude);l.minLatitude=h,l.maxLatitude=f}r.sectors.push(l)}}},d.prototype.sectorsOverAntiMeridian=function(){for(var t=new u(90,-90,180,-180),e=new u(90,-90,180,-180),r=0,i=this.contours.length;i>r;r++)for(var n=this.contours[r].sectors,o=0,a=n.length;a>o;o++){var s=n[o];s.minLongitude<0&&s.maxLongitude>0?(e.union(s),t.union(s)):s.minLongitude<0?e.union(s):t.union(s)}var l=Math.min(t.minLatitude,e.minLatitude),c=Math.max(t.maxLatitude,t.maxLatitude);this._sector=new u(l,c,-180,180),this._sectors=[t,e]},d.prototype.sectorsNotOverAntiMeridian=function(){this._sector=new u(90,-90,180,-180);for(var t=0,e=this.contours.length;e>t;t++)for(var r=this.contours[t].sectors,i=0,n=r.length;n>i;i++)this._sector.union(r[i]);this._sectors=[this._sector]},d.prototype.prepareGeometry=function(t,e){for(var r=[],n=[],o=0,a=e.length;a>o;o++)for(var s=e[o],l=s.poleIndex,u=0,c=s.polygons.length;c>u;u++){var h=s.polygons[u],f=s.iMap[u];r.push(h),s.pole!==i.poles.NONE&&c>1?u===l?this.outlineForPole(h,f,n):this.outlineForSplit(h,f,n):s.pole!==i.poles.NONE&&1===c?this.outlineForPole(h,f,n):s.pole===i.poles.NONE&&c>1?this.outlineForSplit(h,f,n):s.pole===i.poles.NONE&&1===c&&n.push(h)}this._interiorGeometry=r,this._outlineGeometry=n},d.prototype.outlineForPole=function(t,e,r){this.containsPole=!0;for(var i=[],n=0,o=0,a=t.length;a>o;o++){var s=t[o],l=e.get(o);l&&l.forPole&&(n++,n%2===1&&(i.push(s),r.push(i),i=[])),n%2===0&&i.push(s)}i.length&&r.push(i)},d.prototype.outlineForSplit=function(t,e,r){for(var i=[],n=0,o=0,a=t.length;a>o;o++){var s=t[o],l=e.get(o);l&&!l.forPole&&(n++,n%2===0&&(i.push(s),r.push(i),i=[])),n%2===1&&i.push(s)}},d.prototype.resetPickColor=function(){this.pickColor=null},d.prototype.renderToTexture=function(t,e,r,i,n,o){var s=this._highlighted?this._highlightAttributes||this._attributes:this._attributes,l=!this._isInteriorInhibited&&s.drawInterior,u=s.drawOutline&&s.outlineWidth>0;if(l||u){if(t.pickingMode&&!this.pickColor&&(this.pickColor=t.uniquePickColor()),t.pickingMode)var c=this.pickColor.toHexString();if(this.crossesAntiMeridian||this.containsPole?(l&&(this.draw(this._interiorGeometry,e,r,i,n,o),e.fillStyle=t.pickingMode?c:s.interiorColor.toRGBAString(),e.fill()),u&&(this.draw(this._outlineGeometry,e,r,i,n,o),e.lineWidth=s.outlineWidth,e.strokeStyle=t.pickingMode?c:s.outlineColor.toRGBAString(),e.stroke())):(this.draw(this._interiorGeometry,e,r,i,n,o),l&&(e.fillStyle=t.pickingMode?c:s.interiorColor.toRGBAString(),e.fill()),u&&(e.lineWidth=s.outlineWidth,e.strokeStyle=t.pickingMode?c:s.outlineColor.toRGBAString(),e.stroke())),t.pickingMode){var h=new a(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);t.resolvePick(h)}}},d.prototype.draw=function(t,e,r,i,n,o){e.beginPath();for(var a=0,s=t.length;s>a;a++){var l=t[a],u=l[0],c=u.longitude*r+n,h=u.latitude*i+o;e.moveTo(c,h);for(var f=1,d=l.length;d>f;f++)u=l[f],c=u.longitude*r+n,h=u.latitude*i+o,e.lineTo(c,h)}},d.DEFAULT_NUM_EDGE_INTERVALS=128,d.DEFAULT_POLAR_THROTTLE=10,d}),i("../src/worldwind/shapes/SurfaceShapeTile",["../geom/Angle","../error/ArgumentError","../util/Level","../util/Logger","../geom/Sector","../render/Texture","../render/TextureTile"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,e,r,i){a.call(this,t,e,r,i),this.surfaceShapes=[],this.surfaceShapeStateKeys=[],this.asRenderedSurfaceShapeStateKeys=[],this.sector=t,this.cacheKey=null,this.pickSequence=0,this.createCtx2D()};return s.prototype=Object.create(a.prototype),s.prototype.clearShapes=function(){this.surfaceShapes=[],this.surfaceShapeStateKeys=[]},s.prototype.hasShapes=function(){return this.surfaceShapes.length>0},s.prototype.getShapes=function(){return this.surfaceShapes},s.prototype.setShapes=function(t){this.surfaceShapes=t},s.prototype.getSector=function(){return this.sector},s.prototype.addSurfaceShape=function(t){this.surfaceShapes.push(t),this.surfaceShapeStateKeys.push(t.stateKey)},s.prototype.needsUpdate=function(t){var e,r;if(this.surfaceShapes.length!=this.asRenderedSurfaceShapeStateKeys.length)return!0;for(e=0,r=this.surfaceShapes.length;r>e;e+=1)if(this.surfaceShapeStateKeys[e]!==this.asRenderedSurfaceShapeStateKeys[e])return!0;return this.hasTexture(t)?!1:!0},s.prototype.hasTexture=function(t){if(t.pickingMode)return!1;this.gpuCacheKey||(this.gpuCacheKey=this.getCacheKey());var e=t.gpuResourceCache,r=e.resourceForKey(this.gpuCacheKey);return!!r},s.prototype.updateTexture=function(t){var e=t.currentGlContext,r=s.canvas,i=s.ctx2D;r.width=this.tileWidth,r.height=this.tileHeight;var n=this.tileWidth/this.sector.deltaLongitude(),a=-this.tileHeight/this.sector.deltaLatitude(),l=-this.sector.minLongitude*n,u=-this.sector.maxLatitude*a;this.asRenderedSurfaceShapeStateKeys=[];for(var c=0,h=this.surfaceShapes.length;h>c;c+=1){var f=this.surfaceShapes[c];this.asRenderedSurfaceShapeStateKeys.push(this.surfaceShapeStateKeys[c]),f.renderToTexture(t,i,n,a,l,u)}this.gpuCacheKey=this.getCacheKey();var d=t.gpuResourceCache,p=new o(e,r);return d.putResource(this.gpuCacheKey,p,p.size),p},s.prototype.getCacheKey=function(){return this.cacheKey||(this.cacheKey="SurfaceShapeTile:"+this.tileKey+","+this.pickSequence.toString()),this.cacheKey},s.prototype.createCtx2D=function(){s.ctx2D||(s.canvas=document.createElement("canvas"),s.ctx2D=s.canvas.getContext("2d"))},s.canvas=null,s.ctx2D=null,s}),i("../src/worldwind/shapes/SurfaceShapeTileBuilder",["../error/ArgumentError","../render/DrawContext","../globe/Globe","../shaders/GpuProgram","../util/Level","../util/LevelSet","../geom/Location","../util/Logger","../geom/Matrix","../cache/MemoryCache","../navigate/NavigatorState","../error/NotYetImplementedError","../pick/PickedObject","../geom/Rectangle","../geom/Sector","../shapes/SurfaceShape","../shapes/SurfaceShapeTile","../globe/Terrain","../globe/TerrainTile","../globe/TerrainTileList","../render/TextureTile","../util/Tile"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m,g,y,v,E,w,b){"use strict";var x=function(){this.numRowsTilesInTopLevel=4,this.numColumnsTilesInTopLevel=8,this.maximumSubdivisionDepth=15,this.tileWidth=256,this.tileHeight=256,this.levels=new o(p.FULL_SPHERE,new a(180/this.numRowsTilesInTopLevel,360/this.numColumnsTilesInTopLevel),this.maximumSubdivisionDepth,this.tileWidth,this.tileHeight),this.surfaceShapes=[],this.surfaceShapeTiles=[],this.topLevelTiles=[],this.sector=new p(-90,90,-180,180),this.detailControl=1.25,this.tileCache=new u(5e5,4e5)};return x.prototype.clear=function(){this.surfaceShapeTiles.splice(0,this.surfaceShapeTiles.length),this.surfaceShapes.splice(0,this.surfaceShapes.length)},x.prototype.insertSurfaceShape=function(t){this.surfaceShapes.push(t)},x.prototype.doRender=function(t){if(t.pickingMode){for(var e=0,r=this.surfaceShapes.length;r>e;e+=1)this.surfaceShapes[e].resetPickColor();x.pickSequence+=1;var i=this.surfaceShapeTiles,n=this.topLevelTiles;this.surfaceShapeTiles=[],this.topLevelTiles=[],this.buildTiles(t),t.deepPicking?this.doDeepPickingRender(t):t.surfaceTileRenderer.renderTiles(t,this.surfaceShapeTiles,1),this.surfaceShapeTiles=i,this.topLevelTiles=n}else this.buildTiles(t),t.surfaceTileRenderer.renderTiles(t,this.surfaceShapeTiles,1)},x.prototype.doDeepPickingRender=function(t){var e,r,i,n,o,a,s,l,u,c=[];for(o=0,a=t.objectsAtPickPoint.objects.length;a>o;o+=1)s=t.objectsAtPickPoint.objects[o],s.userObject instanceof m&&(l=s.userObject,c.indexOf(l)<0&&(c.push(l),t.objectsAtPickPoint.objects.splice(o,1),o-=1,a-=1));if(!(c.length<=0)){var h=[];for(i=0,n=c.length;n>i;i+=1){for(l=c[i],e=0,r=this.surfaceShapeTiles.length;r>e;e+=1)u=this.surfaceShapeTiles[e],u.setShapes([l]),u.updateTexture(t);t.surfaceTileRenderer.renderTiles(t,this.surfaceShapeTiles,1);var d=t.readPickColor(t.pickPoint);d&&l.pickColor.equals(d)&&(s=new f(l.pickColor.clone(),l.pickDelegate?l.pickDelegate:l,null,l.layer,!1),h.push(s))}for(o=0,a=t.objectsAtPickPoint.objects.length;a>o;o+=1)s=t.objectsAtPickPoint.objects[o],s.userObject instanceof m&&(t.objectsAtPickPoint.objects.splice(o,1),o-=1,a-=1);for(o=0,a=h.length;a>o;o+=1)s=h[o],t.objectsAtPickPoint.objects.push(s)}},x.prototype.buildTiles=function(e){if(!e)throw new t(s.logMessage(s.LEVEL_SEVERE,"SurfaceShapeTileBuilder","buildTiles","missingDc"));if(this.surfaceShapes&&!(this.surfaceShapes.length<1)){this.assembleTiles(e),this.surfaceShapes.splice(0,this.surfaceShapes.length);for(var r=0,i=this.surfaceShapeTiles.length;i>r;r+=1){var n=this.surfaceShapeTiles[r];n.clearShapes()}}},x.prototype.assembleTiles=function(t){var e,r,i,n,o,a,s;this.topLevelTiles.length<1&&this.createTopLevelTiles();var l={};for(r=0,i=this.surfaceShapes.length;i>r;r+=1){var u=this.surfaceShapes[r],c=u.computeSectors(t);if(c)for(a=0,s=c.length;s>a;a+=1){var h=c[a];for(n=0,o=this.topLevelTiles.length;o>n;n+=1)if(e=this.topLevelTiles[n],e.sector.intersects(h)){var f=e.tileKey;l[f]=e,e.addSurfaceShape(u)}}}for(var d in l)l.hasOwnProperty(d)&&(e=l[d],this.addTileOrDescendants(t,this.levels,null,e))},x.prototype.addTileOrDescendants=function(t,e,r,i){if(!this.intersectsFrustum(t,i))return void i.clearShapes();if(null!=r&&this.addIntersectingShapes(t,r,i),i.hasShapes()){if(this.meetsRenderCriteria(t,e,i))return void this.addTile(t,i);for(var n=e.level(i.level.levelNumber+1),o=t.pickingMode?i.subdivide(n,this):i.subdivideToCache(n,this,this.tileCache),a=0,s=o.length;s>a;a+=1){var l=o[a];this.addTileOrDescendants(t,e,i,l)}i.clearShapes()}},x.prototype.addIntersectingShapes=function(t,e,r){for(var i=e.getShapes(),n=0,o=i.length;o>n;n+=1){var a=i[n],s=a.computeSectors(t);if(s)for(var l=0,u=s.length;u>l;l+=1){var c=s[l];if(r.getSector().intersects(c)){r.addSurfaceShape(a);break}}}},x.prototype.addTile=function(t,e){t.pickingMode&&(e.pickSequence=x.pickSequence),e.needsUpdate(t)&&e.updateTexture(t),this.surfaceShapeTiles.push(e)},x.prototype.createTile=function(t,e,r,i){return new g(t,e,r,i)},x.prototype.createTopLevelTiles=function(){b.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles);
},x.prototype.intersectsFrustum=function(t,e){return t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits)?!1:(e.update(t),e.extent.intersectsFrustum(t.pickingMode?t.pickFrustum:t.navigatorState.frustumInModelCoordinates))},x.prototype.meetsRenderCriteria=function(t,e,r){return r.level.levelNumber==e.lastLevel().levelNumber||!r.mustSubdivide(t,this.detailControl)},x.pickSequence=0,x}),i("../src/worldwind/shaders/SurfaceTileRendererProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(t,e,r,i){"use strict";var n=function(t){var e="attribute vec4 vertexPoint;\nattribute vec4 vertexTexCoord;\nuniform mat4 mvpMatrix;\nuniform mat4 texSamplerMatrix;\nuniform mat4 texMaskMatrix;\nvarying vec2 texSamplerCoord;\nvarying vec2 texMaskCoord;\nvoid main() {\ngl_Position = mvpMatrix * vertexPoint;\ntexSamplerCoord = (texSamplerMatrix * vertexTexCoord).st;\ntexMaskCoord = (texMaskMatrix * vertexTexCoord).st;\n}",i="precision mediump float;\nuniform sampler2D texSampler;\nuniform float opacity;\nuniform vec4 color;\nuniform bool modulateColor;\nvarying vec2 texSamplerCoord;\nvarying vec2 texMaskCoord;\nbool isInsideTextureImage(const vec2 coord) {\n    return coord.x >= 0.0 && coord.x <= 1.0 && coord.y >= 0.0 && coord.y <= 1.0;\n}\nvoid main(void) {\nfloat mask = float(isInsideTextureImage(texMaskCoord));if (modulateColor) {\n    gl_FragColor = color * mask * floor(texture2D(texSampler, texSamplerCoord).a + 0.5);\n} else {\n    gl_FragColor = texture2D(texSampler, texSamplerCoord) * mask * opacity;\n}\n}";r.call(this,t,e,i),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.vertexTexCoordLocation=this.attributeLocation(t,"vertexTexCoord"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.colorLocation=this.uniformLocation(t,"color"),this.modulateColorLocation=this.uniformLocation(t,"modulateColor"),this.texSamplerMatrixLocation=this.uniformLocation(t,"texSamplerMatrix"),this.texMaskMatrixLocation=this.uniformLocation(t,"texMaskMatrix"),this.texSamplerLocation=this.uniformLocation(t,"texSampler"),this.opacityLocation=this.uniformLocation(t,"opacity"),this.vertexPointLocation=-1};return n.key="WorldWindGpuSurfaceTileRenderingProgram",n.prototype=Object.create(r.prototype),n.prototype.loadModelviewProjection=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,r,this.mvpMatrixLocation)},n.prototype.loadTexSamplerMatrix=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadTexSamplerMatrix","missingMatrix"));this.loadUniformMatrix(e,r,this.texSamplerMatrixLocation)},n.prototype.loadTexMaskMatrix=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadTexMaskMatrix","missingMatrix"));this.loadUniformMatrix(e,r,this.texMaskMatrixLocation)},n.prototype.loadTexSampler=function(t,e){t.uniform1i(this.texSamplerLocation,e-WebGLRenderingContext.TEXTURE0)},n.prototype.loadOpacity=function(t,e){t.uniform1f(this.opacityLocation,e)},n.prototype.loadColor=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadColor","missingColor"));this.loadUniformColor(e,r,this.colorLocation)},n.prototype.loadModulateColor=function(t,e){t.uniform1i(this.modulateColorLocation,e?1:0)},n}),i("../src/worldwind/render/SurfaceTileRenderer",["../error/ArgumentError","../util/Logger","../geom/Matrix","../shapes/SurfaceShapeTile","../shaders/SurfaceTileRendererProgram"],function(t,e,r,i,n){"use strict";var o=function(){this.texMaskMatrix=r.fromIdentity(),this.texSamplerMatrix=r.fromIdentity(),this.isSurfaceShapeTileRendering=!1};return o.prototype.renderTiles=function(r,n,o,a){if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceTileRenderer","renderTiles","Specified surface tiles array is null or undefined."));if(!(n.length<1)){var s,l,u,c,h=r.terrain,f=r.currentGlContext,d=0,p=1;if(h){this.isSurfaceShapeTileRendering=n[0]instanceof i,o*=r.surfaceOpacity,s=this.beginRendering(r,o),h.beginRendering(r);try{for(var m=0,g=h.surfaceGeometry.length;g>m;m++){l=h.surfaceGeometry[m],u=l.sector,h.beginRenderingTile(r,l);try{for(var y=0,v=n.length;v>y;y++)c=n[y],c.sector.overlaps(u)&&c.bind(r)&&(r.pickingMode?c.pickColor&&s.loadColor(f,c.pickColor):a&&c.opacity!=p&&(s.loadOpacity(f,o*c.opacity),p=c.opacity),this.applyTileState(r,l,c),h.renderTile(r,l),++d)}catch(E){console.log(E)}finally{h.endRenderingTile(r,l)}}}catch(E){console.log(E)}finally{h.endRendering(r),this.endRendering(r),r.frameStatistics.incrementRenderedTileCount(d)}}}},o.prototype.beginRendering=function(t,e){var r=t.currentGlContext,i=t.findAndBindProgram(n);return i.loadTexSampler(r,r.TEXTURE0),t.pickingMode&&!this.isSurfaceShapeTileRendering?i.loadModulateColor(r,!0):(i.loadModulateColor(r,!1),i.loadOpacity(r,e)),i},o.prototype.endRendering=function(t){var e=t.currentGlContext;e.bindTexture(e.TEXTURE_2D,null)},o.prototype.applyTileState=function(t,e,r){var i=t.currentGlContext,n=t.currentProgram,o=e.sector,a=o.deltaLatitude(),s=o.deltaLongitude(),l=r.sector,u=l.deltaLatitude(),c=l.deltaLongitude(),h=u>0?u:1,f=c>0?c:1,d=s/f,p=a/h,m=-(l.minLongitude-o.minLongitude)/f,g=-(l.minLatitude-o.minLatitude)/h;this.texMaskMatrix.set(d,0,0,m,0,p,0,g,0,0,1,0,0,0,0,1),this.texSamplerMatrix.setToUnitYFlip(),r.applyInternalTransform(t,this.texSamplerMatrix),this.texSamplerMatrix.multiplyMatrix(this.texMaskMatrix),n.loadTexSamplerMatrix(i,this.texSamplerMatrix),n.loadTexMaskMatrix(i,this.texMaskMatrix)},o}),i("../src/worldwind/render/TextSupport",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Logger","../geom/Matrix","../render/Texture","../geom/Vec2"],function(t,e,r,i,n,o,a){"use strict";var s=function(){this.canvas2D=document.createElement("canvas"),this.ctx2D=this.canvas2D.getContext("2d"),this.lineSpacing=.15,this.strokeStyle="rgba(0, 0, 0, 0.5)",this.strokeWidth=4};return s.prototype.textSize=function(t,e,r){if(0===t.length)return new a(0,0);this.ctx2D.font=e.fontString;for(var i=t.split("\n"),n=i.length*(e.size*(1+this.lineSpacing)),o=0,s=0;s<i.length;s++)o=Math.max(o,this.ctx2D.measureText(i[s]).width);return r&&(o+=this.strokeWidth,n+=this.strokeWidth),new a(o,n)},s.prototype.createTexture=function(t,e,i,n){var a=t.currentGlContext,s=this.ctx2D,l=this.canvas2D,u=this.textSize(e,i,n),c=e.split("\n"),h=n?this.strokeWidth/2:0,f=t.pixelScale;l.width=Math.ceil(u[0])*f,l.height=Math.ceil(u[1])*f,s.scale(f,f),s.font=i.fontString,s.textBaseline="top",s.textAlign=i.horizontalAlignment,s.fillStyle=r.WHITE.toHexString(!1),s.strokeStyle=this.strokeStyle,s.lineWidth=this.strokeWidth,s.lineCap="round",s.lineJoin="round","left"===i.horizontalAlignment?s.translate(h,0):"right"===i.horizontalAlignment?s.translate(u[0]-h,0):s.translate(u[0]/2,0);for(var d=0;d<c.length;d++)n&&s.strokeText(c[d],0,0),s.fillText(c[d],0,0),s.translate(0,i.size*(1+this.lineSpacing)+h);return new o(a,l)},s.prototype.getMaxLineHeight=function(t){return this.textSize("_É",t,0)[1]},s.prototype.wrap=function(e,r,n,o){if(!e)throw new t(i.logMessage(i.WARNING,"TextSupport","wrap","missing text"));var a,s=e.split("\n"),l="";for(a=0;a<s.length;a++)s[a]=this.wrapLine(s[a],r,o);var u=0,c=!1,h=this.getMaxLineHeight(o);for(a=0;a<s.length&&!c;a++){for(var f=s[a].split("\n"),d=0;d<f.length&&!c;d++)0>=n||n>=u+h?(l+=f[d],u+=h+this.lineSpacing,d<f.length-1&&(l+="\n")):c=!0;a<s.length-1&&!c&&(l+="\n")}return c&&(l.length>0&&(l=l.substring(0,l.length-1)),l+="..."),l},s.prototype.wrapLine=function(t,e,r){var i="",n=t.trim(),o=this.textSize(n,r,0);if(o[0]>e){for(var a="",s=0,l=n.indexOf(" ",s+1);s<n.length;){-1==l&&(l=n.length);var u=n.substring(s,l),c=a+u;this.textSize(c,r,0)[0]<=e?a+=u:0!=a.length?(i+=a,i+="\n",a="",a+=u.trim()):a+=u.trim(),s=l,s<n.length-1&&(l=n.indexOf(" ",s+1))}i+=a}else i+=n;return i},s}),i("../src/worldwind/render/DrawContext",["../error/ArgumentError","../util/Color","../util/FrameStatistics","../render/FramebufferTexture","../render/FramebufferTileController","../geom/Frustum","../globe/Globe","../shaders/GpuProgram","../cache/GpuResourceCache","../layer/Layer","../util/Logger","../geom/Matrix","../navigate/NavigatorState","../pick/PickedObjectList","../geom/Plane","../geom/Position","../geom/Rectangle","../render/ScreenCreditController","../geom/Sector","../shapes/SurfaceShape","../shapes/SurfaceShapeTileBuilder","../render/SurfaceTileRenderer","../render/TextSupport","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m,g,y,v,E,w,b,x,_,S,T){"use strict";var L=function(r){if(!r)throw new t(c.logMessage(c.LEVEL_SEVERE,"Texture","constructor","missingGlContext"));this.currentGlContext=r,this.canvas2D=document.createElement("canvas"),this.ctx2D=this.canvas2D.getContext("2d"),this.clearColor=e.TRANSPARENT,this.gpuResourceCache=new l(WorldWind.configuration.gpuCacheSize,.8*WorldWind.configuration.gpuCacheSize),this.surfaceTileRenderer=new b,this.surfaceShapeTileBuilder=new w,this.surfaceShapeTileController=new n,this.screenCreditController=new y,this.textSupport=new x,this.currentFramebuffer=null,this.currentProgram=null,this.surfaceRenderables=[],this.orderedRenderingMode=!1,this.orderedRenderables=[],this.screeRenderables=[],this.orderedRenderablesCounter=0,this.timestamp=Date.now(),this.previousRedrawTimestamp=this.timestamp,this.redrawRequested=!1,this.globe=null,this.globeStateKey=null,this.layers=null,this.currentLayer=null,this.navigatorState=null,this.eyePosition=new m(0,0,0),this.screenProjection=h.fromIdentity(),this.terrain=null,this.verticalExaggeration=1,this.fadeTime=500,this.surfaceOpacity=1,this.frameStatistics=null,this.pickingMode=!1,this.pickTerrainOnly=!1,this.deepPicking=!1,this.regionPicking=!1,this.pickPoint=null,this.pickRectangle=null,this.pickFramebuffer=null,this.pickFrustum=null,this.pickColor=new e(0,0,0,1),this.objectsAtPickPoint=new d,this.pixelScale=1};return L.unitCubeKey="DrawContextUnitCubeKey",L.unitCubeElementsKey="DrawContextUnitCubeElementsKey",L.unitQuadKey="DrawContextUnitQuadKey",L.unitQuadKey3="DrawContextUnitQuadKey3",L.prototype.reset=function(){this.screenCreditController.clear(),this.surfaceRenderables=[],this.orderedRenderingMode=!1,this.orderedRenderables=[],this.screenRenderables=[],this.orderedRenderablesCounter=0;var t=this.timestamp;this.timestamp=Date.now(),this.timestamp===t&&++this.timestamp,this.redrawRequested=!1,this.globe=null,this.globeStateKey=null,this.layers=null,this.currentLayer=null,this.navigatorState=null,this.terrain=null,this.verticalExaggeration=1,this.frameStatistics=null,this.accumulateOrderedRenderables=!0,this.pickingMode=!1,this.pickTerrainOnly=!1,this.deepPicking=!1,this.regionPicking=!1,this.pickPoint=null,this.pickRectangle=null,this.pickFrustum=null,this.pickColor=new e(0,0,0,1),this.objectsAtPickPoint.clear()},L.prototype.update=function(){var t=this.currentGlContext,e=this.navigatorState.eyePoint;this.globeStateKey=this.globe.stateKey,this.globe.computePositionFromPoint(e[0],e[1],e[2],this.eyePosition),this.screenProjection.setToScreenProjection(t.drawingBufferWidth,t.drawingBufferHeight)},L.prototype.contextLost=function(){this.gpuResourceCache.clear(),this.pickFramebuffer=null,this.currentFramebuffer=null,this.currentProgram=null},L.prototype.contextRestored=function(){this.gpuResourceCache.clear()},L.prototype.bindFramebuffer=function(t){this.currentFramebuffer!=t&&(this.currentGlContext.bindFramebuffer(this.currentGlContext.FRAMEBUFFER,t?t.framebufferId:null),this.currentFramebuffer=t)},L.prototype.bindProgram=function(t){this.currentProgram!=t&&(this.currentGlContext.useProgram(t?t.programId:null),this.currentProgram=t)},L.prototype.findAndBindProgram=function(e){if(!e)throw new t(c.logMessage(c.LEVEL_SEVERE,"DrawContext","findAndBindProgram","The specified program constructor is null or undefined."));var r=this.gpuResourceCache.resourceForKey(e.key);if(r)this.bindProgram(r);else try{r=new e(this.currentGlContext),this.bindProgram(r),this.gpuResourceCache.putResource(e.key,r,r.size)}catch(i){c.log(c.LEVEL_SEVERE,"Error attempting to create GPU program.")}return r},L.prototype.addSurfaceRenderable=function(t){t&&this.surfaceRenderables.push(t)},L.prototype.peekSurfaceRenderable=function(){return this.surfaceRenderables.length>0?this.surfaceRenderables[this.surfaceRenderables.length-1]:null},L.prototype.popSurfaceRenderable=function(){return this.surfaceRenderables.length>0?this.surfaceRenderables.pop():null},L.prototype.reverseSurfaceRenderables=function(){this.surfaceRenderables.reverse()},L.prototype.addOrderedRenderable=function(t,e){if(t){var r={orderedRenderable:t,insertionOrder:this.orderedRenderablesCounter++,eyeDistance:e||t.eyeDistance,globeStateKey:this.globeStateKey};this.globe.continuous&&(r.globeOffset=this.globe.offset),0===r.eyeDistance?this.screenRenderables.push(r):this.orderedRenderables.push(r)}},L.prototype.addOrderedRenderableToBack=function(t){if(t){var e={orderedRenderable:t,insertionOrder:this.orderedRenderablesCounter++,eyeDistance:Number.MAX_VALUE,globeStateKey:this.globeStateKey};this.globe.continuous&&(e.globeOffset=this.globe.offset),this.orderedRenderables.push(e)}},L.prototype.peekOrderedRenderable=function(){return this.orderedRenderables.length>0?this.orderedRenderables[this.orderedRenderables.length-1].orderedRenderable:null},L.prototype.popOrderedRenderable=function(){if(this.orderedRenderables.length>0){var t=this.orderedRenderables.pop();return this.globeStateKey=t.globeStateKey,this.globe.continuous&&(this.globe.offset=t.globeOffset),t.orderedRenderable}return null},L.prototype.nextScreenRenderable=function(){if(this.screenRenderables.length>0){var t=this.screenRenderables.shift();return this.globeStateKey=t.globeStateKey,this.globe.continuous&&(this.globe.offset=t.globeOffset),t.orderedRenderable}return null},L.prototype.sortOrderedRenderables=function(){this.orderedRenderables.sort(function(t,e){var r=t.eyeDistance,i=e.eyeDistance;if(i>r)return-1;if(r>i)return 1;var n=t.insertionOrder,o=e.insertionOrder;return n>o?-1:o>n?1:0})},L.prototype.readPickColor=function(t){var r=this.navigatorState.convertPointToViewport(t,new _(0,0)),i=new Uint8Array(4);return this.currentGlContext.readPixels(r[0],r[1],1,1,this.currentGlContext.RGBA,this.currentGlContext.UNSIGNED_BYTE,i),this.clearColor.equalsBytes(i)?null:e.colorFromByteArray(i)},L.prototype.readPickColors=function(t){var r,i=this.currentGlContext,n=new Uint8Array(t.width*t.height*4),o={},a=new e(0,0,0,0),s=i.getParameter(i.PACK_ALIGNMENT);i.pixelStorei(i.PACK_ALIGNMENT,1),this.currentGlContext.readPixels(t.x,t.y,t.width,t.height,i.RGBA,i.UNSIGNED_BYTE,n),i.pixelStorei(i.PACK_ALIGNMENT,s);for(var l=0,u=t.width*t.height;u>l;l++){var c=4*l;r=e.colorFromBytes(n[c],n[c+1],n[c+2],n[c+3]),r.equals(this.clearColor)||r.equals(a)||(o[r.toByteString()]=r)}return o},L.prototype.resolvePick=function(t){if(t.userObject instanceof E||!this.deepPicking||this.regionPicking)this.addPickedObject(t);else{var e=this.readPickColor(this.pickPoint);if(!e)return null;t.color.equals(e)&&this.addPickedObject(t)}},L.prototype.addPickedObject=function(t){t&&this.objectsAtPickPoint.add(t)},L.prototype.uniquePickColor=function(){var t=this.pickColor.nextColor().clone();return t.equals(this.clearColor)?t.nextColor():t},L.prototype.makePickFramebuffer=function(){var t=this.currentGlContext,e=t.drawingBufferWidth,r=t.drawingBufferHeight;return this.pickFramebuffer&&this.pickFramebuffer.width==e&&this.pickFramebuffer.height==r||(this.pickFramebuffer=new i(t,e,r,!0)),this.pickFramebuffer},L.prototype.makePickFrustum=function(){if(!this.pickPoint&&!this.pickRectangle)return!1;var t,e,r,i,n,a,s,l,u,c,h,f,d,m,y,v,E,w,b,x,L,M,A=new S(0,0,0),N=2,R=new S(0,0,0),C=this.pickRectangle,P=this.navigatorState.viewport;C||(M=this.navigatorState.convertPointToViewport(this.pickPoint,new _(0,0)),C=new g(M[0]-N,M[1]-N,2*N,2*N));var O=C.x,I=C.x+C.width,k=C.y,D=C.y+C.height;return 0>I||0>D||O>P.x+P.width||k>P.y+P.height?!1:(C.x=T.clamp(O,P.x,P.x+P.width),C.y=T.clamp(k,P.y,P.y+P.height),C.width=T.clamp(I,P.x,P.x+P.width)-C.x,C.height=T.clamp(D,P.y,P.y+P.height)-C.y,this.pickRectangle=C,R[0]=C.x,R[1]=C.y,R[2]=0,this.navigatorState.unProject(R,t=new S(0,0,0)),R[0]=C.x,R[1]=C.y,R[2]=1,this.navigatorState.unProject(R,e=new S(0,0,0)),R[0]=C.x+C.width,R[1]=C.y,R[2]=0,this.navigatorState.unProject(R,r=new S(0,0,0)),R[0]=C.x+C.width,R[1]=C.y,R[2]=1,this.navigatorState.unProject(R,i=new S(0,0,0)),R[0]=C.x,R[1]=C.y+C.height,R[2]=0,this.navigatorState.unProject(R,n=new S(0,0,0)),R[0]=C.x,R[1]=C.y+C.height,R[2]=1,this.navigatorState.unProject(R,a=new S(0,0,0)),R[0]=C.x+C.width,R[1]=C.y+C.height,R[2]=0,this.navigatorState.unProject(R,s=new S(0,0,0)),R[0]=C.x+C.width,R[1]=C.y+C.height,R[2]=1,this.navigatorState.unProject(R,l=new S(0,0,0)),L=new S(a[0]-t[0],a[1]-t[1],a[2]-t[2]),A.set(n[0]-e[0],n[1]-e[1],n[2]-e[2]),u=L.cross(A),y=new p(u[0],u[1],u[2],-u.dot(t)),y.normalize(),L=new S(s[0]-i[0],s[1]-i[1],s[2]-i[2]),A.set(l[0]-r[0],l[1]-r[1],l[2]-r[2]),c=L.cross(A),v=new p(c[0],c[1],c[2],-c.dot(r)),v.normalize(),L=new S(a[0]-s[0],a[1]-s[1],a[2]-s[2]),A.set(l[0]-n[0],l[1]-n[1],l[2]-n[2]),h=L.cross(A),E=new p(h[0],h[1],h[2],-h.dot(n)),E.normalize(),L=new S(i[0]-t[0],i[1]-t[1],i[2]-t[2]),A.set(e[0]-r[0],e[1]-r[1],e[2]-r[2]),f=L.cross(A),w=new p(f[0],f[1],f[2],-f.dot(r)),w.normalize(),L=new S(n[0]-r[0],n[1]-r[1],n[2]-r[2]),A.set(s[0]-t[0],s[1]-t[1],s[2]-t[2]),d=L.cross(A),b=new p(d[0],d[1],d[2],-d.dot(t)),b.normalize(),L=new S(l[0]-e[0],l[1]-e[1],l[2]-e[2]),A.set(a[0]-i[0],a[1]-i[1],a[2]-i[2]),m=L.cross(A),x=new p(m[0],m[1],m[2],-m.dot(e)),x.normalize(),this.pickFrustum=new o(y,v,w,E,b,x),!0)},L.prototype.isSmall=function(t,e){if(!t)return!1;var r=this.navigatorState.eyePoint.distanceTo(t.center),i=this.navigatorState.pixelSizeAtDistance(r);return 2*t.radius<e*i},L.prototype.unitCubeBuffer=function(){var t=this.gpuResourceCache.resourceForKey(L.unitCubeKey);if(!t){var e=this.currentGlContext,r=new Float32Array(24),i=0;r[i++]=0,r[i++]=1,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=1,r[i++]=1,r[i++]=0,r[i++]=1,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=1,r[i++]=1,r[i++]=0,r[i++]=0,r[i++]=1,r[i++]=1,r[i++]=1,r[i++]=1,r[i++]=1,r[i++]=0,r[i]=1,t=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(L.unitCubeKey,t,4*r.length)}return t},L.prototype.unitCubeElements=function(){var t=this.gpuResourceCache.resourceForKey(L.unitCubeElementsKey);if(!t){var e=this.currentGlContext,r=new Int16Array(60),i=0;r[i++]=1,r[i++]=0,r[i++]=3,r[i++]=3,r[i++]=0,r[i++]=2,r[i++]=4,r[i++]=5,r[i++]=6,r[i++]=6,r[i++]=5,r[i++]=7,r[i++]=5,r[i++]=1,r[i++]=7,r[i++]=7,r[i++]=1,r[i++]=3,r[i++]=6,r[i++]=2,r[i++]=4,r[i++]=4,r[i++]=2,r[i++]=0,r[i++]=4,r[i++]=0,r[i++]=5,r[i++]=5,r[i++]=0,r[i++]=1,r[i++]=7,r[i++]=3,r[i++]=6,r[i++]=6,r[i++]=3,r[i++]=2,r[i++]=0,r[i++]=1,r[i++]=1,r[i++]=3,r[i++]=3,r[i++]=2,r[i++]=2,r[i++]=0,r[i++]=4,r[i++]=5,r[i++]=5,r[i++]=7,r[i++]=7,r[i++]=6,r[i++]=6,r[i++]=4,r[i++]=0,r[i++]=4,r[i++]=5,r[i++]=1,r[i++]=2,r[i++]=6,r[i++]=7,r[i]=3,t=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(L.unitCubeElementsKey,t,2*r.length)}return t},L.prototype.unitQuadBuffer=function(){var t=this.gpuResourceCache.resourceForKey(L.unitQuadKey);if(!t){var e=this.currentGlContext,r=new Float32Array(8);r[0]=0,r[1]=1,r[2]=0,r[3]=0,r[4]=1,r[5]=1,r[6]=1,r[7]=0,t=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(L.unitQuadKey,t,4*r.length)}return t},L.prototype.unitQuadBuffer3=function(){var t=this.gpuResourceCache.resourceForKey(L.unitQuadKey3);if(!t){var e=this.currentGlContext,r=new Float32Array(12);r[0]=0,r[1]=1,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=1,r[7]=1,r[8]=0,r[9]=1,r[10]=0,r[11]=0,t=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(L.unitQuadKey3,t,4*r.length)}return t},L.prototype.surfacePointForMode=function(e,r,i,n,o){if(!o)throw new t(c.logMessage(c.LEVEL_SEVERE,"DrawContext","surfacePointForMode","missingResult"));if(this.terrain)this.terrain.surfacePointForMode(e,r,i,n,o);else{var a=i+this.globe.elevationAtLocation(e,r)*this.verticalExaggeration;this.globe.computePointFromPosition(e,r,a,o)}return o},L}),i("../src/worldwind/globe/EarthElevationModel",["../geom/Location","../geom/Sector","../globe/ElevationModel","../util/WmsUrlBuilder"],function(t,e,r,i){"use strict";var n=function(){r.call(this,e.FULL_SPHERE,new t(45,45),12,"application/bil16","EarthElevations256",256,256),this.displayName="Earth Elevation Model",this.minElevation=-11e3,this.maxElevation=8850,this.pixelIsPoint=!1,this.urlBuilder=new i("https://worldwind26.arc.nasa.gov/elev","GEBCO,aster_v2,USGS-NED","","1.3.0")};return n.prototype=Object.create(r.prototype),n}),i("../src/worldwind/globe/EarthRestElevationModel",["../geom/Location","../geom/Sector","../globe/ElevationModel","../util/LevelRowColumnUrlBuilder"],function(t,e,r,i){"use strict";var n=function(n,o,a){r.call(this,e.FULL_SPHERE,new t(60,60),5,"application/bil16","EarthElevations",512,512),this.displayName=a,this.minElevation=-11e3,this.maxElevation=8850,this.urlBuilder=new i(n,o)};return n.prototype=Object.create(r.prototype),n}),i("../src/worldwind/layer/FrameStatisticsLayer",["../error/ArgumentError","../util/Color","../util/Font","../layer/Layer","../util/Logger","../util/Offset","../shapes/ScreenText","../shapes/TextAttributes"],function(t,e,r,i,n,o,a,s){"use strict";var l=function(l){function u(t,e){h.handleRedraw(t,e)}if(!l)throw new t(n.logMessage(n.LEVEL_SEVERE,"FrameStatisticsLayer","constructor","missingWorldWindow"));i.call(this,"Frame Statistics"),this.pickEnabled=!1;var c=new s(null);c.color=e.GREEN,c.font=new r(12),c.offset=new o(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,1),this.frameTime=new a(new o(WorldWind.OFFSET_PIXELS,5,WorldWind.OFFSET_INSET_PIXELS,5)," "),this.frameTime.attributes=c,this.frameRate=new a(new o(WorldWind.OFFSET_PIXELS,5,WorldWind.OFFSET_INSET_PIXELS,25)," "),this.frameRate.attributes=c;var h=this;l.redrawCallbacks.push(u)};return l.prototype=Object.create(i.prototype),l.prototype.doRender=function(t){this.frameRate.render(t),this.frameTime.render(t),this.inCurrentFrame=!0},l.prototype.handleRedraw=function(t,e){if(e==WorldWind.BEFORE_REDRAW){var r=t.frameStatistics;this.frameTime.text="Frame time  "+r.frameTimeAverage.toFixed(0)+" ms  ("+r.frameTimeMin.toFixed(0)+" - "+r.frameTimeMax.toFixed(0)+")",this.frameRate.text="Frame rate  "+r.frameRateAverage.toFixed(0)+" fps"}},l}),i("../src/worldwind/shapes/AbstractShape",["../error/ArgumentError","../util/Logger","../geom/Matrix","../cache/MemoryCache","../render/Renderable","../shapes/ShapeAttributes","../error/UnsupportedOperationError","../geom/Vec3"],function(t,e,r,i,n,o,a,s){"use strict";var l=function(t){n.call(this),this._attributes=t?t:new o(null),this._highlightAttributes=null,this.highlighted=!1,this._altitudeMode=WorldWind.ABSOLUTE,this.referencePosition=null,this.shapeDataCache=new i(3,2),this.currentData=null,this.activeAttributes=null,this.expirationInterval=2e3,this.useSurfaceShapeFor2D=!1,this.scratchMatrix=r.fromIdentity()};return l.prototype=Object.create(n.prototype),Object.defineProperties(l.prototype,{attributes:{get:function(){return this._attributes},set:function(t){this._attributes=t,this.surfaceShape&&(this.surfaceShape.attributes=this._attributes)}},highlightAttributes:{get:function(){return this._highlightAttributes},set:function(t){this._highlightAttributes=t,this.surfaceShape&&(this.surfaceShape.highlightAttributes=this._highlightAttributes)}},altitudeMode:{get:function(){return this._altitudeMode},set:function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"AbstractShape","altitudeMode","missingAltitudeMode"));this._altitudeMode=r,this.reset()}}}),l.prototype.reset=function(){this.shapeDataCache.clear(!1),this.surfaceShape=null},l.prototype.updateSurfaceShape=function(){this.surfaceShape.displayName=this.displayName,this.surfaceShape.highlighted=this.highlighted,this.surfaceShape.enabled=this.enabled,this.surfaceShape.pathType=this.pathType,this.surfaceShape.pickDelegate=this.pickDelegate?this.pickDelegate:this},l.prototype.createSurfaceShape=function(){return null},l.prototype.render=function(t){if(this.enabled&&t.accumulateOrderedRenderables){if(t.globe.is2D()&&this.useSurfaceShapeFor2D&&(this.surfaceShape||(this.surfaceShape=this.createSurfaceShape(),this.surfaceShape&&(this.surfaceShape.attributes=this._attributes,this.surfaceShape.highlightAttributes=this._highlightAttributes)),this.surfaceShape))return this.updateSurfaceShape(),void this.surfaceShape.render(t);if((t.terrain||this.altitudeMode==WorldWind.ABSOLUTE)&&(this.establishCurrentData(t),(!t.globe.projectionLimits||this.isWithinProjectionLimits(t))&&(!this.currentData.extent||this.intersectsFrustum(t))&&(this.determineActiveAttributes(t),this.activeAttributes))){var e=this.makeOrderedRenderable(t);if(e){if(!this.intersectsFrustum(t))return;if(t.isSmall(this.currentData.extent,1))return;e.layer=t.currentLayer,t.addOrderedRenderable(e,this.currentData.eyeDistance)}}}},l.prototype.renderOrdered=function(t){this.currentData=this.shapeDataCache.entryForKey(t.globeStateKey),this.beginDrawing(t);try{this.doRenderOrdered(t)}finally{this.endDrawing(t)}},l.prototype.makeOrderedRenderable=function(t){var e=this.doMakeOrderedRenderable(t);return this.currentData.verticalExaggeration=t.verticalExaggeration,e},l.prototype.doMakeOrderedRenderable=function(t){throw new a(e.logMessage(e.LEVEL_SEVERE,"AbstractShape","makeOrderedRenderable","abstractInvocation"))},l.prototype.doRenderOrdered=function(t){throw new a(e.logMessage(e.LEVEL_SEVERE,"AbstractShape","doRenderOrdered","abstractInvocation"))},l.prototype.beginDrawing=function(t){},l.prototype.endDrawing=function(t){},l.prototype.intersectsFrustum=function(t){return this.currentData&&this.currentData.extent?t.pickingMode?this.currentData.extent.intersectsFrustum(t.pickFrustum):this.currentData.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates):!0},l.prototype.establishCurrentData=function(t){this.currentData=this.shapeDataCache.entryForKey(t.globeStateKey),this.currentData||(this.currentData=this.createShapeDataObject(),this.resetExpiration(this.currentData),this.shapeDataCache.putEntry(t.globeStateKey,this.currentData,1)),this.currentData.isExpired=!this.isShapeDataCurrent(t,this.currentData)},l.prototype.createShapeDataObject=function(){return{transformationMatrix:r.fromIdentity(),referencePoint:new s(0,0,0)}},l.prototype.resetExpiration=function(t){t.expiryTime=Date.now()+this.expirationInterval+1e3*Math.random()},l.prototype.isShapeDataCurrent=function(t,e){return e.verticalExaggeration===t.verticalExaggeration&&e.expiryTime>Date.now()},l.prototype.determineActiveAttributes=function(t){this.highlighted&&this._highlightAttributes?this.activeAttributes=this.highlightAttributes:this.activeAttributes=this._attributes},l.prototype.isWithinProjectionLimits=function(t){return!0},l.prototype.applyMvpMatrix=function(t){this.scratchMatrix.copy(t.navigatorState.modelviewProjection),this.scratchMatrix.multiplyMatrix(this.currentData.transformationMatrix),t.currentProgram.loadModelviewProjection(t.currentGlContext,this.scratchMatrix)},l.prototype.applyMvpMatrixForOutline=function(t){this.scratchMatrix.copy(t.navigatorState.projection),this.scratchMatrix.offsetProjectionDepth(-.001),this.scratchMatrix.multiplyMatrix(t.navigatorState.modelview),this.scratchMatrix.multiplyMatrix(this.currentData.transformationMatrix),t.currentProgram.loadModelviewProjection(t.currentGlContext,this.scratchMatrix)},l}),i("../src/worldwind/shapes/AbstractMesh",["../shapes/AbstractShape","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Line","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m){"use strict";var g=function(e){t.call(this,e),this.pickTransparentImagePixels=!0,this._altitudeScale=1};return g.prototype=Object.create(t.prototype),Object.defineProperties(g.prototype,{altitudeScale:{get:function(){return this._altitudeScale},set:function(t){this._altitudeScale=t,this.reset()}}}),g.prototype.mustGenerateGeometry=function(t){return this.currentData.meshPoints?this.currentData.drawInterior!==this.activeAttributes.drawInterior?!0:this.activeAttributes.applyLighting&&!this.currentData.normals?!0:this.altitudeMode===WorldWind.ABSOLUTE?!1:this.currentData.isExpired:!0},g.prototype.doMakeOrderedRenderable=function(t){if(!this.activeAttributes.drawInterior&&!this.activeAttributes.drawOutline)return null;if(!this.mustGenerateGeometry(t))return this;var e=this.currentData,r=e.referencePoint;return t.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude*this._altitudeScale,this._altitudeMode,r),e.transformationMatrix.setToTranslation(r[0],r[1],r[2]),e.meshPoints=this.computeMeshPoints(t,e),e.refreshVertexBuffer=!0,this.activeAttributes.imageSource&&!this.texCoords&&(this.texCoords=this.computeTexCoords(),this.texCoords&&(e.refreshTexCoordBuffer=!0)),this.meshIndices||(this.meshIndices=this.computeMeshIndices(),e.refreshMeshIndices=!0),this.meshOutlineIndices||(this.meshOutlineIndices=this.computeOutlineIndices(),this.meshOutlineIndices&&(e.refreshOutlineIndices=!0)),this.activeAttributes.applyLighting&&this.computeNormals(e),e.drawInterior=this.activeAttributes.drawInterior,this.resetExpiration(e),e.extent||(e.extent=new i),e.extent.setToPoints(e.meshPoints),e.extent.translate(e.referencePoint),this},g.prototype.computeMeshPoints=function(t,e){throw new UnsupportedOperationError(l.logMessage(l.LEVEL_SEVERE,"AbstractMesh","computeMeshPoints","abstractInvocation"))},g.prototype.computeTexCoords=function(){return null},g.prototype.computeMeshIndices=function(t){throw new UnsupportedOperationError(l.logMessage(l.LEVEL_SEVERE,"AbstractMesh","computeMeshIndices","abstractInvocation"))},g.prototype.computeOutlineIndices=function(t){},g.prototype.computeNormals=function(t){for(var e,r=new Float32Array(t.meshPoints.length),i=this.meshIndices,n=t.meshPoints,o=[],a=[new p(0,0,0),new p(0,0,0),new p(0,0,0)],s=0;s<i.length;s+=3){for(var l=0;3>l;l++)e=i[s+l],a[l].set(n[3*e],n[3*e+1],n[3*e+2]);var u=p.computeTriangleNormal(a[0],a[1],a[2]);for(l=0;3>l;l++)e=i[s+l],o[e]||(o[e]=[]),o[e].push(u)}for(u=new p(0,0,0),s=0;s<o.length;s++)o[s]?(p.average(o[s],u),u.normalize(),r[3*s]=u[0],r[3*s+1]=u[1],r[3*s+2]=u[2]):(r[3*s]=0,r[3*s+1]=0,r[3*s+2]=0);t.normals=r,t.refreshNormalsBuffer=!0},g.prototype.doRenderOrdered=function(t){var e,r,i,n,o,a=t.currentGlContext,s=t.currentProgram,l=this.currentData,u=this.texCoords&&!!this.activeAttributes.imageSource;if(t.pickingMode&&(n=t.uniquePickColor()),l.pointsVboCacheKey||(l.pointsVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.pointsVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.pointsVboCacheKey,e,4*l.meshPoints.length),l.refreshVertexBuffer=!0),a.bindBuffer(a.ARRAY_BUFFER,e),l.refreshVertexBuffer&&(a.bufferData(a.ARRAY_BUFFER,l.meshPoints,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshVertexBuffer=!1),a.vertexAttribPointer(s.vertexPointLocation,3,a.FLOAT,!1,0,0),
s.loadTextureEnabled(a,!1),this.activeAttributes.drawInterior){var h=!t.pickingMode&&l.normals&&this.activeAttributes.applyLighting;this.applyMvpMatrix(t),l.meshIndicesVboCacheKey||(l.meshIndicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.meshIndicesVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.meshIndicesVboCacheKey,e,2*this.meshIndices.length),l.refreshMeshIndices=!0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),l.refreshMeshIndices&&(a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.meshIndices,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshMeshIndices=!1),i=this.activeAttributes.interiorColor,r=i.alpha*t.currentLayer.opacity,a.depthMask(r>=1||t.pickingMode),s.loadColor(a,t.pickingMode?n:i),s.loadOpacity(a,t.pickingMode?r>0?1:0:r),!u||t.pickingMode&&this.pickTransparentImagePixels||(this.activeTexture=t.gpuResourceCache.resourceForKey(this.activeAttributes.imageSource),this.activeTexture||(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.activeAttributes.imageSource)),o=this.activeTexture&&this.activeTexture.bind(t),o&&(l.texCoordsVboCacheKey||(l.texCoordsVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.texCoordsVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.texCoordsVboCacheKey,e,4*this.texCoords.length),l.refreshTexCoordBuffer=!0),a.bindBuffer(a.ARRAY_BUFFER,e),l.refreshTexCoordBuffer&&(a.bufferData(a.ARRAY_BUFFER,this.texCoords,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshTexCoordBuffer=!1),a.enableVertexAttribArray(s.vertexTexCoordLocation),a.vertexAttribPointer(s.vertexTexCoordLocation,2,a.FLOAT,!1,0,0),this.scratchMatrix.setToIdentity(),this.scratchMatrix.multiplyByTextureTransform(this.activeTexture),s.loadTextureEnabled(a,!0),s.loadTextureUnit(a,a.TEXTURE0),s.loadTextureMatrix(a,this.scratchMatrix),s.loadModulateColor(a,t.pickingMode))),h&&(s.loadApplyLighting(a,!0),l.normalsVboCacheKey||(l.normalsVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.normalsVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.normalsVboCacheKey,e,4*l.normals.length),l.refreshNormalsBuffer=!0),a.bindBuffer(a.ARRAY_BUFFER,e),l.refreshNormalsBuffer&&(a.bufferData(a.ARRAY_BUFFER,l.normals,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshNormalsBuffer=!1),a.enableVertexAttribArray(s.normalVectorLocation),a.vertexAttribPointer(s.normalVectorLocation,3,a.FLOAT,!1,0,0)),a.drawElements(a.TRIANGLES,this.meshIndices.length,a.UNSIGNED_SHORT,0),u&&a.disableVertexAttribArray(s.vertexTexCoordLocation),h&&(s.loadApplyLighting(a,!1),a.disableVertexAttribArray(s.normalVectorLocation))}if(this.activeAttributes.drawOutline&&this.meshOutlineIndices&&(s.loadTextureEnabled(a,!1),a.disableVertexAttribArray(s.vertexTexCoordLocation),this.applyMvpMatrixForOutline(t),i=this.activeAttributes.outlineColor,r=i.alpha*t.currentLayer.opacity,a.depthMask(r>=1||t.pickingMode),s.loadColor(a,t.pickingMode?n:i),s.loadOpacity(a,t.pickingMode?1:r),a.lineWidth(this.activeAttributes.outlineWidth),l.outlineIndicesVboCacheKey||(l.outlineIndicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.outlineIndicesVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.outlineIndicesVboCacheKey,e,2*this.meshOutlineIndices.length),l.refreshOutlineIndices=!0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),l.refreshOutlineIndices&&(a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.meshOutlineIndices,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshOutlineIndices=!1),a.drawElements(a.LINE_STRIP,this.meshOutlineIndices.length,a.UNSIGNED_SHORT,0)),t.pickingMode){var f=this.computePickPosition(t),d=new c(n,this.pickDelegate?this.pickDelegate:this,f,t.currentLayer,!1);t.resolvePick(d)}},g.prototype.computePickPosition=function(t){var e=this.currentData,r=t.navigatorState.rayFromScreenPoint(t.pickPoint),i=new p(r.origin[0],r.origin[1],r.origin[2]).subtract(e.referencePoint),n=new a(i,r.direction),o=[];if(m.computeIndexedTrianglesIntersection(n,e.meshPoints,this.meshIndices,o)){var s=o[0];if(o.length>1)for(var l=s.distanceToSquared(t.navigatorState.eyePoint),u=1;u<o.length;u++){var c=o[u].distanceToSquared(t.navigatorState.eyePoint);l>c&&(l=c,s=o[u])}var f=new h(0,0,0);return t.globe.computePositionFromPoint(s[0]+e.referencePoint[0],s[1]+e.referencePoint[1],s[2]+e.referencePoint[2],f),f.altitude/=this._altitudeScale,f}return null},g.prototype.beginDrawing=function(t){var e=t.currentGlContext;if(this.activeAttributes.drawInterior){e.disable(e.CULL_FACE),t.findAndBindProgram(r);var i=!t.pickMode&&this.currentData.normals&&this.activeAttributes.applyLighting;i&&t.currentProgram.loadModelviewInverse(e,t.navigatorState.modelviewNormalTransform)}e.enableVertexAttribArray(t.currentProgram.vertexPointLocation)},g.prototype.endDrawing=function(t){var e=t.currentGlContext;e.disableVertexAttribArray(t.currentProgram.vertexPointLocation),e.depthMask(!0),e.lineWidth(1),e.enable(e.CULL_FACE)},g}),i("../src/worldwind/shapes/SurfacePolygon",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(t,e,r,i){"use strict";var n=function(r,o){if(!Array.isArray(r))throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfacePolygon","constructor","The specified boundary is not an array."));i.call(this,o),this._boundaries=r,this._stateId=n.stateId++};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{boundaries:{get:function(){return this._boundaries},set:function(r){if(!Array.isArray(r))throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfacePolygon","set boundaries","The specified value is not an array."));this._boundaries=r,this._stateId=n.stateId++,this.isPrepared=!1,this.stateKeyInvalid=!0}}}),n.stateId=Number.MIN_SAFE_INTEGER,n.staticStateKey=function(t){var e=i.staticStateKey(t);return e+" pg "+t._stateId},n.prototype.computeStateKey=function(){return n.staticStateKey(this)},n}),i("../src/worldwind/shapes/GeographicMesh",["../shapes/AbstractMesh","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolygon","../geom/Vec2","../geom/Vec3"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p){"use strict";var m=function(r,i){if(!r)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","missingPositions"));if(r.length<2||r[0].length<2)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","Number of positions is insufficient."));if(r.length*r[0].length>65536)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","Too many positions. Must be fewer than 65536. Try using multiple meshes."));for(var n=r[0].length,o=1;o<r.length;o++)if(r[o].length!==n)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","Array lengths are inconsistent."));var a=r.length,l=r[0].length;t.call(this,i),this.pickTransparentImagePixels=!0,this._positions=r,this._altitudeScale=1,this.numRows=a,this.numColumns=l,this._textureCoordinates=null,this.referencePosition=this.determineReferencePosition(this._positions)};return m.prototype=Object.create(t.prototype),Object.defineProperties(m.prototype,{positions:{get:function(){return this._positions},set:function(t){if(!t)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","positions","missingPositions"));if(t.length<2||t[0].length<2)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","positions","Number of positions is insufficient."));for(var r=t[0].length,i=1;i<t.length;i++)if(t[i].length!==r)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","positions","Array lengths are inconsistent."));this.numRows=t.length,this.numColumns=t[0].length,this._positions=t,this.referencePosition=this.determineReferencePosition(this._positions),this.reset(),this.meshIndices=null,this.outlineIndices=null}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(t){if(t&&t.length!=this.numRows)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","textureCoordinates","Number of texture coordinate rows is inconsistent with the currently specified positions."));for(var r=0;r<this.numRows;r++)if(t[r].length!==this.numColumns)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","textureCoordinates","Texture coordinate row lengths are inconsistent with the currently specified positions."));this._textureCoordinates=t,this.reset(),this.texCoords=null}}}),m.makeGridIndices=function(t,e){for(var r=[],i=0,n=0;t-1>n;n++)for(var o=0;e-1>o;o++){var a=n*e+o;r[i++]=a,r[i++]=a+1,r[i++]=a+e,r[i++]=a+1,r[i++]=a+1+e,r[i++]=a+e}return r},m.prototype.determineReferencePosition=function(t){return t[0][0]},m.prototype.createSurfaceShape=function(){for(var t=[],e=0;e<this.numColumns;e++)t.push(this._positions[0][e]);for(var r=1;r<this.numRows;r++)t.push(this._positions[r][this.numColumns-1]);for(e=this.numColumns-2;e>=0;e--)t.push(this._positions[this.numRows-1][e]);for(r=this.numRows-2;r>0;r--)t.push(this._positions[r][0]);return new f(t,null)},m.prototype.computeMeshPoints=function(t,e){for(var r,i,n=Number.MAX_VALUE,o=t.navigatorState.eyePoint,a=new Float32Array(this.numRows*this.numColumns*3),s=new p(0,0,0),l=0,u=0;u<this._positions.length;u++)for(var c=0,h=this._positions[u].length;h>c;c++)r=this._positions[u][c],t.surfacePointForMode(r.latitude,r.longitude,r.altitude*this._altitudeScale,this.altitudeMode,s),i=s.distanceToSquared(o),n>i&&(n=i),s.subtract(this.currentData.referencePoint),a[l++]=s[0],a[l++]=s[1],a[l++]=s[2];return e.eyeDistance=Math.sqrt(n),a},m.prototype.computeTexCoords=function(){return this._textureCoordinates?this.computeExplicitTexCoords():this.computeImplicitTexCoords()},m.prototype.computeExplicitTexCoords=function(){for(var t=new Float32Array(2*this.numRows*this.numColumns),e=0,r=0;r<this._textureCoordinates.length;r++)for(var i=0,n=this._textureCoordinates[r].length;n>i;i++){var o=this._textureCoordinates[r][i];t[e++]=o[0],t[e++]=o[1]}return t},m.prototype.computeImplicitTexCoords=function(){for(var t=new Float32Array(2*this.numRows*this.numColumns),e=1/(this.numRows-1),r=1/(this.numColumns-1),i=0,n=0;n<this._positions.length;n++)for(var o=n===this.numRows-1?1:n*e,a=0,s=this._positions[n].length;s>a;a++)t[i++]=a===this.numColumns-1?1:a*r,t[i++]=o;return t},m.prototype.computeMeshIndices=function(){for(var t=new Uint16Array((this.numRows-1)*(this.numColumns-1)*6),e=0,r=0;r<this.numRows-1;r++)for(var i=0;i<this.numColumns-1;i++){var n=r*this.numColumns+i;t[e++]=n,t[e++]=n+1,t[e++]=n+this.numColumns,t[e++]=n+1,t[e++]=n+1+this.numColumns,t[e++]=n+this.numColumns}return t},m.prototype.computeOutlineIndices=function(){for(var t=new Uint16Array(2*this.numRows+2*this.numColumns),e=0,r=0;r<this.numColumns;r++)t[e++]=r;for(var i=1;i<this.numRows;i++)t[e++]=(i+1)*this.numColumns-1;for(r=this.numRows*this.numColumns-2;r>=(this.numRows-1)*this.numColumns;r--)t[e++]=r;for(i=this.numRows-2;i>=0;i--)t[e++]=i*this.numColumns;return t},m}),i("../src/worldwind/shapes/GeographicText",["../error/ArgumentError","../util/Logger","../shapes/Text","../geom/Vec3"],function(t,e,r,i){"use strict";var n=function(i,n){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Text","constructor","missingPosition"));r.call(this,n),this.position=i,this.declutterGroup=1};return n.placePoint=new i(0,0,0),n.prototype=Object.create(r.prototype),n.prototype.clone=function(){var t=new n(this.position,this.text);return t.copy(this),t.pickDelegate=this.pickDelegate?this.pickDelegate:this,t},n.prototype.render=function(t){(!t.globe.projectionLimits||t.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude))&&r.prototype.render.call(this,t)},n.prototype.computeScreenPointAndEyeDistance=function(t){return t.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,n.placePoint),t.navigatorState.frustumInModelCoordinates.containsPoint(n.placePoint)?(this.eyeDistance=this.alwaysOnTop?0:t.navigatorState.eyePoint.distanceTo(n.placePoint),t.navigatorState.projectWithDepth(n.placePoint,this.depthOffset,this.screenPoint)?!0:!1):!1},n}),i("../src/worldwind/formats/geojson/GeoJSONConstants",[],function(){"use strict";var t=function(){};return t.FIELD_TYPE="type",t.FIELD_CRS="crs",t.FIELD_NAME="name",t.FIELD_BBOX="bbox",t.FIELD_COORDINATES="coordinates",t.FIELD_GEOMETRIES="geometries",t.FIELD_GEOMETRY="geometry",t.FIELD_PROPERTIES="properties",t.FIELD_FEATURES="features",t.FIELD_ID="id",t.TYPE_POINT="Point",t.TYPE_MULTI_POINT="MultiPoint",t.TYPE_LINE_STRING="LineString",t.TYPE_MULTI_LINE_STRING="MultiLineString",t.TYPE_POLYGON="Polygon",t.TYPE_MULTI_POLYGON="MultiPolygon",t.TYPE_GEOMETRY_COLLECTION="GeometryCollection",t.TYPE_FEATURE="Feature",t.TYPE_FEATURE_COLLECTION="FeatureCollection",t.FIELD_CRS_NAME="name",t.FIELD_CRS_LINK="link",t.WGS84_CRS="urn:ogc:def:crs:OGC:1.3:CRS84",t.EPSG4326_CRS="EPSG:4326",t}),i("../src/worldwind/formats/geojson/GeoJSONGeometry",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(t,e,r){"use strict";var i=function(e,i,n){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometry","constructor","missingCoordinates"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometry","constructor","missingType"));this._coordinates=e,this._type=i,this._bbox=n?n:null};return Object.defineProperties(i.prototype,{coordinates:{get:function(){return this._coordinates}},type:{get:function(){return this._type}},bbox:{get:function(){return this._bbox}}}),i.prototype.isPointType=function(){return this.type===e.TYPE_POINT},i.prototype.isMultiPointType=function(){return this.type===e.TYPE_MULTI_POINT},i.prototype.isLineStringType=function(){return this.type===e.TYPE_LINE_STRING},i.prototype.isMultiLineStringType=function(){return this.type===e.TYPE_MULTI_LINE_STRING},i.prototype.isPolygonType=function(){return this.type===e.TYPE_POLYGON},i.prototype.isMultiPolygonType=function(){return this.type===e.TYPE_MULTI_POLYGON},i}),i("../src/worldwind/formats/geojson/GeoJSONGeometryCollection",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(t,e,r){"use strict";var i=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryCollection","constructor","missingGeometries"));if("[object Array]"!==Object.prototype.toString.call(e))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryCollection","constructor","invalidGeometries"));this._geometries=e,this._bbox=i};return Object.defineProperties(i.prototype,{geometries:{get:function(){return this._geometries}},bbox:{get:function(){return this._bbox}}}),i}),i("../src/worldwind/formats/geojson/GeoJSONGeometryLineString",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingCoordinates"));if(i.length<2||i[0].length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Number]"!==Object.prototype.toString.call(i[0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),i("../src/worldwind/formats/geojson/GeoJSONGeometryMultiLineString",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","missingCoordinates"));if(i[0].length<2||i[0][0].length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Array]"!==Object.prototype.toString.call(i[0][0])||"[object Number]"!==Object.prototype.toString.call(i[0][0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),i("../src/worldwind/formats/geojson/GeoJSONGeometryMultiPoint",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","missingCoordinates"));if(i[0].length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Number]"!==Object.prototype.toString.call(i[0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),i("../src/worldwind/formats/geojson/GeoJSONGeometryMultiPolygon",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiPolygon","constructor","missingCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Array]"!==Object.prototype.toString.call(i[0][0])||"[object Array]"!==Object.prototype.toString.call(i[0][0][0])||"[object Number]"!==Object.prototype.toString.call(i[0][0][0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),i("../src/worldwind/formats/geojson/GeoJSONGeometryPoint",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingCoordinates"));if(i.length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i)||"[object Number]"!==Object.prototype.toString.call(i[0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),i("../src/worldwind/formats/geojson/GeoJSONGeometryPolygon",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingCoordinates"));if(i[0].length<2||i[0][0].length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Array]"!==Object.prototype.toString.call(i[0][0])||"[object Number]"!==Object.prototype.toString.call(i[0][0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidCoordinatesType"));if(i[0][0]!==i[0][i.length-1])throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidLinearRing"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof i&&i.amd)i("../src/worldwind/util/proj4-src",t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.proj4=t()}}(function(){return function t(e,i,n){function o(s,l){if(!i[s]){if(!e[s]){var u="function"==typeof r&&r;if(!l&&u)return u(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var r=e[s][1][t];return o(r?r:t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var a="function"==typeof r&&r,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,r){function i(t,e,r){if(!(this instanceof i))return new i(t,e,r);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&"undefined"==typeof e){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=e,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var n=t("mgrs");i.fromMGRS=function(t){return new i(n.toPoint(t))},i.prototype.toMGRS=function(t){return n.forward([this.x,this.y],t)},e.exports=i},{mgrs:66}],2:[function(t,e,r){function i(t,e){if(!(this instanceof i))return new i(t);e=e||function(t){if(t)throw t};var r=n(t);if("object"!=typeof r)return void e(t);var a=s(r),l=i.projections.get(a.projName);l?(o(this,a),o(this,l),this.init(),e(null,this)):e(t)}var n=t("./parseCode"),o=t("./extend"),a=t("./projections"),s=t("./deriveConstants");i.projections=a,i.projections.start(),e.exports=i},{"./deriveConstants":32,"./extend":33,"./parseCode":36,"./projections":38}],3:[function(t,e,r){e.exports=function(t,e,r){var i,n,o,a=r.x,s=r.y,l=r.z||0;for(o=0;3>o;o++)if(!e||2!==o||void 0!==r.z)switch(0===o?(i=a,n="x"):1===o?(i=s,n="y"):(i=l,n="z"),t.axis[o]){case"e":r[n]=i;break;case"w":r[n]=-i;break;case"n":r[n]=i;break;case"s":r[n]=-i;break;case"u":void 0!==r[n]&&(r.z=i);break;case"d":void 0!==r[n]&&(r.z=-i);break;default:return null}return r}},{}],4:[function(t,e,r){var i=Math.PI/2,n=t("./sign");e.exports=function(t){return Math.abs(t)<i?t:t-n(t)*Math.PI}},{"./sign":21}],5:[function(t,e,r){var i=2*Math.PI,n=3.14159265359,o=t("./sign");e.exports=function(t){return Math.abs(t)<=n?t:t-o(t)*i}},{"./sign":21}],6:[function(t,e,r){e.exports=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}},{}],7:[function(t,e,r){e.exports=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))}},{}],8:[function(t,e,r){e.exports=function(t){return.375*t*(1+.25*t*(1+.46875*t))}},{}],9:[function(t,e,r){e.exports=function(t){return.05859375*t*t*(1+.75*t)}},{}],10:[function(t,e,r){e.exports=function(t){return t*t*t*(35/3072)}},{}],11:[function(t,e,r){e.exports=function(t,e,r){var i=e*r;return t/Math.sqrt(1-i*i)}},{}],12:[function(t,e,r){e.exports=function(t,e,r,i,n){var o,a;o=t/e;for(var s=0;15>s;s++)if(a=(t-(e*o-r*Math.sin(2*o)+i*Math.sin(4*o)-n*Math.sin(6*o)))/(e-2*r*Math.cos(2*o)+4*i*Math.cos(4*o)-6*n*Math.cos(6*o)),o+=a,Math.abs(a)<=1e-10)return o;return NaN}},{}],13:[function(t,e,r){var i=Math.PI/2;e.exports=function(t,e){var r=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-r)<1e-6)return 0>e?-1*i:i;for(var n,o,a,s,l=Math.asin(.5*e),u=0;30>u;u++)if(o=Math.sin(l),a=Math.cos(l),s=t*o,n=Math.pow(1-s*s,2)/(2*a)*(e/(1-t*t)-o/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),l+=n,Math.abs(n)<=1e-10)return l;return NaN}},{}],14:[function(t,e,r){e.exports=function(t,e,r,i,n){return t*n-e*Math.sin(2*n)+r*Math.sin(4*n)-i*Math.sin(6*n)}},{}],15:[function(t,e,r){e.exports=function(t,e,r){var i=t*e;return r/Math.sqrt(1-i*i)}},{}],16:[function(t,e,r){var i=Math.PI/2;e.exports=function(t,e){for(var r,n,o=.5*t,a=i-2*Math.atan(e),s=0;15>=s;s++)if(r=t*Math.sin(a),n=i-2*Math.atan(e*Math.pow((1-r)/(1+r),o))-a,a+=n,Math.abs(n)<=1e-10)return a;return-9999}},{}],17:[function(t,e,r){var i=1,n=.25,o=.046875,a=.01953125,s=.01068115234375,l=.75,u=.46875,c=.013020833333333334,h=.007120768229166667,f=.3645833333333333,d=.005696614583333333,p=.3076171875;e.exports=function(t){var e=[];e[0]=i-t*(n+t*(o+t*(a+t*s))),e[1]=t*(l-t*(o+t*(a+t*s)));var r=t*t;return e[2]=r*(u-t*(c+t*h)),r*=t,e[3]=r*(f-t*d),e[4]=r*t*p,e}},{}],18:[function(t,e,r){var i=t("./pj_mlfn"),n=1e-10,o=20;e.exports=function(t,e,r){for(var a=1/(1-e),s=t,l=o;l;--l){var u=Math.sin(s),c=1-e*u*u;if(c=(i(s,u,Math.cos(s),r)-t)*(c*Math.sqrt(c))*a,s-=c,Math.abs(c)<n)return s}return s}},{"./pj_mlfn":19}],19:[function(t,e,r){e.exports=function(t,e,r,i){return r*=e,e*=e,i[0]*t-r*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}},{}],20:[function(t,e,r){e.exports=function(t,e){var r;return t>1e-7?(r=t*e,(1-t*t)*(e/(1-r*r)-.5/t*Math.log((1-r)/(1+r)))):2*e}},{}],21:[function(t,e,r){e.exports=function(t){return 0>t?-1:1}},{}],22:[function(t,e,r){e.exports=function(t,e){return Math.pow((1-t)/(1+t),e)}},{}],23:[function(t,e,r){e.exports=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}},{}],24:[function(t,e,r){var i=Math.PI/2;e.exports=function(t,e,r){var n=t*r,o=.5*t;return n=Math.pow((1-n)/(1+n),o),Math.tan(.5*(i-e))/n}},{}],25:[function(t,e,r){r.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},r.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},r.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},r.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},r.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},r.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},r.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},r.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},r.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},r.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},r.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},r.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},r.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},r.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},r.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},r.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(t,e,r){r.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},r.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},r.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},r.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},r.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},r.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},r.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},r.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},r.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},r.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},r.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},r.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},r.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},r.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},r.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},r.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},r.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},r.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},r.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},r.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},r.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},r.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},r.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},r.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},r.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},r.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},r.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},r.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},r.hough={a:6378270,rf:297,ellipseName:"Hough"},r.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},r.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},r.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},r.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},r.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},r.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},r.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},r.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},r.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},r.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},r.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},r.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},r.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},r.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(t,e,r){r.greenwich=0,r.lisbon=-9.131906111111,r.paris=2.337229166667,r.bogota=-74.080916666667,r.madrid=-3.687938888889,r.rome=12.452333333333,r.bern=7.439583333333,r.jakarta=106.807719444444,r.ferro=-17.666666666667,r.brussels=4.367975,r.stockholm=18.058277777778,r.athens=23.7163375,r.oslo=10.722916666667},{}],28:[function(t,e,r){function i(t,e,r){var i;return Array.isArray(r)?(i=s(t,e,r),3===r.length?[i.x,i.y,i.z]:[i.x,i.y]):s(t,e,r)}function n(t){return t instanceof a?t:t.oProj?t.oProj:a(t)}function o(t,e,r){t=n(t);var o,a=!1;return"undefined"==typeof e?(e=t,t=l,a=!0):("undefined"!=typeof e.x||Array.isArray(e))&&(r=e,e=t,t=l,a=!0),e=n(e),r?i(t,e,r):(o={forward:function(r){return i(t,e,r)},inverse:function(r){return i(e,t,r)}},a&&(o.oProj=e),o)}var a=t("./Proj"),s=t("./transform"),l=a("WGS84");e.exports=o},{"./Proj":2,"./transform":64}],29:[function(t,e,r){var i=Math.PI/2,n=1,o=2,a=3,s=4,l=5,u=484813681109536e-20,c=1.0026,h=.3826834323650898,f=function(t){if(!(this instanceof f))return new f(t);if(this.datum_type=s,t){if(t.datumCode&&"none"===t.datumCode&&(this.datum_type=l),t.datum_params){for(var e=0;e<t.datum_params.length;e++)t.datum_params[e]=parseFloat(t.datum_params[e]);(0!==t.datum_params[0]||0!==t.datum_params[1]||0!==t.datum_params[2])&&(this.datum_type=n),t.datum_params.length>3&&(0!==t.datum_params[3]||0!==t.datum_params[4]||0!==t.datum_params[5]||0!==t.datum_params[6])&&(this.datum_type=o,t.datum_params[3]*=u,t.datum_params[4]*=u,t.datum_params[5]*=u,t.datum_params[6]=t.datum_params[6]/1e6+1)}this.datum_type=t.grids?a:this.datum_type,this.a=t.a,this.b=t.b,this.es=t.es,this.ep2=t.ep2,this.datum_params=t.datum_params,this.datum_type===a&&(this.grids=t.grids)}};f.prototype={compare_datums:function(t){return this.datum_type!==t.datum_type?!1:this.a!==t.a||Math.abs(this.es-t.es)>5e-11?!1:this.datum_type===n?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]:this.datum_type===o?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]&&this.datum_params[3]===t.datum_params[3]&&this.datum_params[4]===t.datum_params[4]&&this.datum_params[5]===t.datum_params[5]&&this.datum_params[6]===t.datum_params[6]:this.datum_type===a||t.datum_type===a?this.nadgrids===t.nadgrids:!0;
},geodetic_to_geocentric:function(t){var e,r,n,o,a,s,l,u=t.x,c=t.y,h=t.z?t.z:0,f=0;if(-i>c&&c>-1.001*i)c=-i;else if(c>i&&1.001*i>c)c=i;else if(-i>c||c>i)return null;return u>Math.PI&&(u-=2*Math.PI),a=Math.sin(c),l=Math.cos(c),s=a*a,o=this.a/Math.sqrt(1-this.es*s),e=(o+h)*l*Math.cos(u),r=(o+h)*l*Math.sin(u),n=(o*(1-this.es)+h)*a,t.x=e,t.y=r,t.z=n,f},geocentric_to_geodetic:function(t){var e,r,n,o,a,s,l,u,c,h,f,d,p,m,g,y,v,E=1e-12,w=E*E,b=30,x=t.x,_=t.y,S=t.z?t.z:0;if(p=!1,e=Math.sqrt(x*x+_*_),r=Math.sqrt(x*x+_*_+S*S),e/this.a<E){if(p=!0,g=0,r/this.a<E)return y=i,void(v=-this.b)}else g=Math.atan2(_,x);n=S/r,o=e/r,a=1/Math.sqrt(1-this.es*(2-this.es)*o*o),u=o*(1-this.es)*a,c=n*a,m=0;do m++,l=this.a/Math.sqrt(1-this.es*c*c),v=e*u+S*c-l*(1-this.es*c*c),s=this.es*l/(l+v),a=1/Math.sqrt(1-s*(2-s)*o*o),h=o*(1-s)*a,f=n*a,d=f*u-h*c,u=h,c=f;while(d*d>w&&b>m);return y=Math.atan(f/Math.abs(h)),t.x=g,t.y=y,t.z=v,t},geocentric_to_geodetic_noniter:function(t){var e,r,n,o,a,s,l,u,f,d,p,m,g,y,v,E,w,b=t.x,x=t.y,_=t.z?t.z:0;if(b=parseFloat(b),x=parseFloat(x),_=parseFloat(_),w=!1,0!==b)e=Math.atan2(x,b);else if(x>0)e=i;else if(0>x)e=-i;else if(w=!0,e=0,_>0)r=i;else{if(!(0>_))return r=i,void(n=-this.b);r=-i}return a=b*b+x*x,o=Math.sqrt(a),s=_*c,u=Math.sqrt(s*s+a),d=s/u,m=o/u,p=d*d*d,l=_+this.b*this.ep2*p,E=o-this.a*this.es*m*m*m,f=Math.sqrt(l*l+E*E),g=l/f,y=E/f,v=this.a/Math.sqrt(1-this.es*g*g),n=y>=h?o/y-v:-h>=y?o/-y-v:_/g+v*(this.es-1),w===!1&&(r=Math.atan(g/y)),t.x=e,t.y=r,t.z=n,t},geocentric_to_wgs84:function(t){if(this.datum_type===n)t.x+=this.datum_params[0],t.y+=this.datum_params[1],t.z+=this.datum_params[2];else if(this.datum_type===o){var e=this.datum_params[0],r=this.datum_params[1],i=this.datum_params[2],a=this.datum_params[3],s=this.datum_params[4],l=this.datum_params[5],u=this.datum_params[6],c=u*(t.x-l*t.y+s*t.z)+e,h=u*(l*t.x+t.y-a*t.z)+r,f=u*(-s*t.x+a*t.y+t.z)+i;t.x=c,t.y=h,t.z=f}},geocentric_from_wgs84:function(t){if(this.datum_type===n)t.x-=this.datum_params[0],t.y-=this.datum_params[1],t.z-=this.datum_params[2];else if(this.datum_type===o){var e=this.datum_params[0],r=this.datum_params[1],i=this.datum_params[2],a=this.datum_params[3],s=this.datum_params[4],l=this.datum_params[5],u=this.datum_params[6],c=(t.x-e)/u,h=(t.y-r)/u,f=(t.z-i)/u;t.x=c+l*h-s*f,t.y=-l*c+h+a*f,t.z=s*c-a*h+f}}},e.exports=f},{}],30:[function(t,e,r){var i=1,n=2,o=3,a=5,s=6378137,l=.006694379990141316;e.exports=function(t,e,r){function u(t){return t===i||t===n}var c,h,f;if(t.compare_datums(e))return r;if(t.datum_type===a||e.datum_type===a)return r;var d=t.a,p=t.es,m=e.a,g=e.es,y=t.datum_type;if(y===o)if(0===this.apply_gridshift(t,0,r))t.a=s,t.es=l;else{if(!t.datum_params)return t.a=d,t.es=t.es,r;for(c=1,h=0,f=t.datum_params.length;f>h;h++)c*=t.datum_params[h];if(0===c)return t.a=d,t.es=t.es,r;y=t.datum_params.length>3?n:i}return e.datum_type===o&&(e.a=s,e.es=l),(t.es!==e.es||t.a!==e.a||u(y)||u(e.datum_type))&&(t.geodetic_to_geocentric(r),u(t.datum_type)&&t.geocentric_to_wgs84(r),u(e.datum_type)&&e.geocentric_from_wgs84(r),e.geocentric_to_geodetic(r)),e.datum_type===o&&this.apply_gridshift(e,1,r),t.a=d,t.es=p,e.a=m,e.es=g,r}},{}],31:[function(t,e,r){function i(t){var e=this;if(2===arguments.length){var r=arguments[1];"string"==typeof r?"+"===r.charAt(0)?i[t]=o(arguments[1]):i[t]=a(arguments[1]):i[t]=r}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?i.apply(e,t):i(t)});if("string"==typeof t){if(t in i)return i[t]}else"EPSG"in t?i["EPSG:"+t.EPSG]=t:"ESRI"in t?i["ESRI:"+t.ESRI]=t:"IAU2000"in t?i["IAU2000:"+t.IAU2000]=t:console.log(t);return}}var n=t("./global"),o=t("./projString"),a=t("./wkt");n(i),e.exports=i},{"./global":34,"./projString":37,"./wkt":65}],32:[function(t,e,r){var i=t("./constants/Datum"),n=t("./constants/Ellipsoid"),o=t("./extend"),a=t("./datum"),s=1e-10,l=.16666666666666666,u=.04722222222222222,c=.022156084656084655;e.exports=function(t){if(t.datumCode&&"none"!==t.datumCode){var e=i[t.datumCode];e&&(t.datum_params=e.towgs84?e.towgs84.split(","):null,t.ellps=e.ellipse,t.datumName=e.datumName?e.datumName:t.datumCode)}if(!t.a){var r=n[t.ellps]?n[t.ellps]:n.WGS84;o(t,r)}return t.rf&&!t.b&&(t.b=(1-1/t.rf)*t.a),(0===t.rf||Math.abs(t.a-t.b)<s)&&(t.sphere=!0,t.b=t.a),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=(t.a2-t.b2)/t.a2,t.e=Math.sqrt(t.es),t.R_A&&(t.a*=1-t.es*(l+t.es*(u+t.es*c)),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=0),t.ep2=(t.a2-t.b2)/t.b2,t.k0||(t.k0=1),t.axis||(t.axis="enu"),t.datum||(t.datum=a(t)),t}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":29,"./extend":33}],33:[function(t,e,r){e.exports=function(t,e){t=t||{};var r,i;if(!e)return t;for(i in e)r=e[i],void 0!==r&&(t[i]=r);return t}},{}],34:[function(t,e,r){e.exports=function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}},{}],35:[function(t,e,r){var i=t("./core");i.defaultDatum="WGS84",i.Proj=t("./Proj"),i.WGS84=new i.Proj("WGS84"),i.Point=t("./Point"),i.toPoint=t("./common/toPoint"),i.defs=t("./defs"),i.transform=t("./transform"),i.mgrs=t("mgrs"),i.version=t("../package.json").version,t("./includedProjections")(i),e.exports=i},{"../package.json":67,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":28,"./defs":31,"./includedProjections":"gWUPNW","./transform":64,mgrs:66}],36:[function(t,e,r){function i(t){return"string"==typeof t}function n(t){return t in l}function o(t){var e=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return e.reduce(function(e,r){return e+1+t.indexOf(r)},0)}function a(t){return"+"===t[0]}function s(t){return i(t)?n(t)?l[t]:o(t)?u(t):a(t)?c(t):void 0:t}var l=t("./defs"),u=t("./wkt"),c=t("./projString");e.exports=s},{"./defs":31,"./projString":37,"./wkt":65}],37:[function(t,e,r){var i=.017453292519943295,n=t("./constants/PrimeMeridian");e.exports=function(t){var e={},r={};t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).forEach(function(t){var e=t.split("=");e.push(!0),r[e[0].toLowerCase()]=e[1]});var o,a,s,l={proj:"projName",datum:"datumCode",rf:function(t){e.rf=parseFloat(t)},lat_0:function(t){e.lat0=t*i},lat_1:function(t){e.lat1=t*i},lat_2:function(t){e.lat2=t*i},lat_ts:function(t){e.lat_ts=t*i},lon_0:function(t){e.long0=t*i},lon_1:function(t){e.long1=t*i},lon_2:function(t){e.long2=t*i},alpha:function(t){e.alpha=parseFloat(t)*i},lonc:function(t){e.longc=t*i},x_0:function(t){e.x0=parseFloat(t)},y_0:function(t){e.y0=parseFloat(t)},k_0:function(t){e.k0=parseFloat(t)},k:function(t){e.k0=parseFloat(t)},a:function(t){e.a=parseFloat(t)},b:function(t){e.b=parseFloat(t)},r_a:function(){e.R_A=!0},zone:function(t){e.zone=parseInt(t,10)},south:function(){e.utmSouth=!0},towgs84:function(t){e.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){e.to_meter=parseFloat(t)},from_greenwich:function(t){e.from_greenwich=t*i},pm:function(t){e.from_greenwich=(n[t]?n[t]:parseFloat(t))*i},nadgrids:function(t){"@null"===t?e.datumCode="none":e.nadgrids=t},axis:function(t){var r="ewnsud";3===t.length&&-1!==r.indexOf(t.substr(0,1))&&-1!==r.indexOf(t.substr(1,1))&&-1!==r.indexOf(t.substr(2,1))&&(e.axis=t)}};for(o in r)a=r[o],o in l?(s=l[o],"function"==typeof s?s(a):e[s]=a):e[o]=a;return"string"==typeof e.datumCode&&"WGS84"!==e.datumCode&&(e.datumCode=e.datumCode.toLowerCase()),e}},{"./constants/PrimeMeridian":27}],38:[function(t,e,r){function i(t,e){var r=a.length;return t.names?(a[r]=t,t.names.forEach(function(t){o[t.toLowerCase()]=r}),this):(console.log(e),!0)}var n=[t("./projections/merc"),t("./projections/longlat")],o={},a=[];r.add=i,r.get=function(t){if(!t)return!1;var e=t.toLowerCase();return"undefined"!=typeof o[e]&&a[o[e]]?a[o[e]]:void 0},r.start=function(){n.forEach(i)}},{"./projections/longlat":50,"./projections/merc":51}],39:[function(t,e,r){var i=1e-10,n=t("../common/msfnz"),o=t("../common/qsfnz"),a=t("../common/adjust_lon"),s=t("../common/asinz");r.init=function(){Math.abs(this.lat1+this.lat2)<i||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=n(this.e3,this.sin_po,this.cos_po),this.qs1=o(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=n(this.e3,this.sin_po,this.cos_po),this.qs2=o(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=o(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>i?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},r.forward=function(t){var e=t.x,r=t.y;this.sin_phi=Math.sin(r),this.cos_phi=Math.cos(r);var i=o(this.e3,this.sin_phi,this.cos_phi),n=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*a(e-this.long0),l=n*Math.sin(s)+this.x0,u=this.rh-n*Math.cos(s)+this.y0;return t.x=l,t.y=u,t},r.inverse=function(t){var e,r,i,n,o,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),n=0,0!==e&&(n=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-i*i)/(2*this.ns0)):(r=(this.c-i*i)/this.ns0,s=this.phi1z(this.e3,r)),o=a(n/this.ns0+this.long0),t.x=o,t.y=s,t},r.phi1z=function(t,e){var r,n,o,a,l,u=s(.5*e);if(i>t)return u;for(var c=t*t,h=1;25>=h;h++)if(r=Math.sin(u),n=Math.cos(u),o=t*r,a=1-o*o,l=.5*a*a/n*(e/(1-c)-r/a+.5/t*Math.log((1-o)/(1+o))),u+=l,Math.abs(l)<=1e-7)return u;return null},r.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],40:[function(t,e,r){var i=t("../common/adjust_lon"),n=Math.PI/2,o=1e-10,a=t("../common/mlfn"),s=t("../common/e0fn"),l=t("../common/e1fn"),u=t("../common/e2fn"),c=t("../common/e3fn"),h=t("../common/gN"),f=t("../common/asinz"),d=t("../common/imlfn");r.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},r.forward=function(t){var e,r,f,d,p,m,g,y,v,E,w,b,x,_,S,T,L,M,A,N,R,C,P,O=t.x,I=t.y,k=Math.sin(t.y),D=Math.cos(t.y),V=i(O-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=o?(t.x=this.x0+this.a*(n-I)*Math.sin(V),t.y=this.y0-this.a*(n-I)*Math.cos(V),t):Math.abs(this.sin_p12+1)<=o?(t.x=this.x0+this.a*(n+I)*Math.sin(V),t.y=this.y0+this.a*(n+I)*Math.cos(V),t):(M=this.sin_p12*k+this.cos_p12*D*Math.cos(V),T=Math.acos(M),L=T/Math.sin(T),t.x=this.x0+this.a*L*D*Math.sin(V),t.y=this.y0+this.a*L*(this.cos_p12*k-this.sin_p12*D*Math.cos(V)),t):(e=s(this.es),r=l(this.es),f=u(this.es),d=c(this.es),Math.abs(this.sin_p12-1)<=o?(p=this.a*a(e,r,f,d,n),m=this.a*a(e,r,f,d,I),t.x=this.x0+(p-m)*Math.sin(V),t.y=this.y0-(p-m)*Math.cos(V),t):Math.abs(this.sin_p12+1)<=o?(p=this.a*a(e,r,f,d,n),m=this.a*a(e,r,f,d,I),t.x=this.x0+(p+m)*Math.sin(V),t.y=this.y0+(p+m)*Math.cos(V),t):(g=k/D,y=h(this.a,this.e,this.sin_p12),v=h(this.a,this.e,k),E=Math.atan((1-this.es)*g+this.es*y*this.sin_p12/(v*D)),w=Math.atan2(Math.sin(V),this.cos_p12*Math.tan(E)-this.sin_p12*Math.cos(V)),A=0===w?Math.asin(this.cos_p12*Math.sin(E)-this.sin_p12*Math.cos(E)):Math.abs(Math.abs(w)-Math.PI)<=o?-Math.asin(this.cos_p12*Math.sin(E)-this.sin_p12*Math.cos(E)):Math.asin(Math.sin(V)*Math.cos(E)/Math.sin(w)),b=this.e*this.sin_p12/Math.sqrt(1-this.es),x=this.e*this.cos_p12*Math.cos(w)/Math.sqrt(1-this.es),_=b*x,S=x*x,N=A*A,R=N*A,C=R*A,P=C*A,T=y*A*(1-N*S*(1-S)/6+R/8*_*(1-2*S)+C/120*(S*(4-7*S)-3*b*b*(1-7*S))-P/48*_),t.x=this.x0+T*Math.sin(w),t.y=this.y0+T*Math.cos(w),t))},r.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,r,p,m,g,y,v,E,w,b,x,_,S,T,L,M,A,N,R,C,P,O,I;if(this.sphere){if(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*n*this.a)return;return r=e/this.a,p=Math.sin(r),m=Math.cos(r),g=this.long0,Math.abs(e)<=o?y=this.lat0:(y=f(m*this.sin_p12+t.y*p*this.cos_p12/e),v=Math.abs(this.lat0)-n,g=i(Math.abs(v)<=o?this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y):this.long0+Math.atan2(t.x*p,e*this.cos_p12*m-t.y*this.sin_p12*p))),t.x=g,t.y=y,t}return E=s(this.es),w=l(this.es),b=u(this.es),x=c(this.es),Math.abs(this.sin_p12-1)<=o?(_=this.a*a(E,w,b,x,n),e=Math.sqrt(t.x*t.x+t.y*t.y),S=_-e,y=d(S/this.a,E,w,b,x),g=i(this.long0+Math.atan2(t.x,-1*t.y)),t.x=g,t.y=y,t):Math.abs(this.sin_p12+1)<=o?(_=this.a*a(E,w,b,x,n),e=Math.sqrt(t.x*t.x+t.y*t.y),S=e-_,y=d(S/this.a,E,w,b,x),g=i(this.long0+Math.atan2(t.x,t.y)),t.x=g,t.y=y,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),M=Math.atan2(t.x,t.y),T=h(this.a,this.e,this.sin_p12),A=Math.cos(M),N=this.e*this.cos_p12*A,R=-N*N/(1-this.es),C=3*this.es*(1-R)*this.sin_p12*this.cos_p12*A/(1-this.es),P=e/T,O=P-R*(1+R)*Math.pow(P,3)/6-C*(1+3*R)*Math.pow(P,4)/24,I=1-R*O*O/2-P*O*O*O/6,L=Math.asin(this.sin_p12*Math.cos(O)+this.cos_p12*Math.sin(O)*A),g=i(this.long0+Math.asin(Math.sin(M)*Math.sin(O)/Math.cos(L))),y=Math.atan((1-this.es*I*this.sin_p12/Math.sin(L))*Math.tan(L)/(1-this.es)),t.x=g,t.y=y,t)},r.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],41:[function(t,e,r){var i=t("../common/mlfn"),n=t("../common/e0fn"),o=t("../common/e1fn"),a=t("../common/e2fn"),s=t("../common/e3fn"),l=t("../common/gN"),u=t("../common/adjust_lon"),c=t("../common/adjust_lat"),h=t("../common/imlfn"),f=Math.PI/2,d=1e-10;r.init=function(){this.sphere||(this.e0=n(this.es),this.e1=o(this.es),this.e2=a(this.es),this.e3=s(this.es),this.ml0=this.a*i(this.e0,this.e1,this.e2,this.e3,this.lat0))},r.forward=function(t){var e,r,n=t.x,o=t.y;if(n=u(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(o)*Math.sin(n)),r=this.a*(Math.atan2(Math.tan(o),Math.cos(n))-this.lat0);else{var a=Math.sin(o),s=Math.cos(o),c=l(this.a,this.e,a),h=Math.tan(o)*Math.tan(o),f=n*Math.cos(o),d=f*f,p=this.es*s*s/(1-this.es),m=this.a*i(this.e0,this.e1,this.e2,this.e3,o);e=c*f*(1-d*h*(1/6-(8-h+8*p)*d/120)),r=m-this.ml0+c*a/s*d*(.5+(5-h+6*p)*d/24)}return t.x=e+this.x0,t.y=r+this.y0,t},r.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,r,i=t.x/this.a,n=t.y/this.a;if(this.sphere){var o=n+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(i)),r=Math.atan2(Math.tan(i),Math.cos(o))}else{var a=this.ml0/this.a+n,s=h(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-f)<=d)return t.x=this.long0,t.y=f,0>n&&(t.y*=-1),t;var p=l(this.a,this.e,Math.sin(s)),m=p*p*p/this.a/this.a*(1-this.es),g=Math.pow(Math.tan(s),2),y=i*this.a/p,v=y*y;e=s-p*Math.tan(s)/m*y*y*(.5-(1+3*g)*y*y/24),r=y*(1-v*(g/3+(1+3*g)*g*v/15))/Math.cos(s)}return t.x=u(r+this.long0),t.y=c(e),t},r.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(t,e,r){var i=t("../common/adjust_lon"),n=t("../common/qsfnz"),o=t("../common/msfnz"),a=t("../common/iqsfnz");r.init=function(){this.sphere||(this.k0=o(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},r.forward=function(t){var e,r,o=t.x,a=t.y,s=i(o-this.long0);if(this.sphere)e=this.x0+this.a*s*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(a)/Math.cos(this.lat_ts);else{var l=n(this.e,Math.sin(a));e=this.x0+this.a*this.k0*s,r=this.y0+this.a*l*.5/this.k0}return t.x=e,t.y=r,t},r.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,r;return this.sphere?(e=i(this.long0+t.x/this.a/Math.cos(this.lat_ts)),r=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(r=a(this.e,2*t.y*this.k0/this.a),e=i(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=r,t},r.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],43:[function(t,e,r){var i=t("../common/adjust_lon"),n=t("../common/adjust_lat");r.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},r.forward=function(t){var e=t.x,r=t.y,o=i(e-this.long0),a=n(r-this.lat0);return t.x=this.x0+this.a*o*this.rc,t.y=this.y0+this.a*a,t},r.inverse=function(t){var e=t.x,r=t.y;return t.x=i(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=n(this.lat0+(r-this.y0)/this.a),t},r.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],44:[function(t,e,r){var i=t("../common/e0fn"),n=t("../common/e1fn"),o=t("../common/e2fn"),a=t("../common/e3fn"),s=t("../common/msfnz"),l=t("../common/mlfn"),u=t("../common/adjust_lon"),c=t("../common/adjust_lat"),h=t("../common/imlfn"),f=1e-10;r.init=function(){Math.abs(this.lat1+this.lat2)<f||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=i(this.es),this.e1=n(this.es),this.e2=o(this.es),this.e3=a(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=s(this.e,this.sinphi,this.cosphi),this.ml1=l(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<f?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=s(this.e,this.sinphi,this.cosphi),this.ml2=l(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=l(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},r.forward=function(t){var e,r=t.x,i=t.y;if(this.sphere)e=this.a*(this.g-i);else{var n=l(this.e0,this.e1,this.e2,this.e3,i);e=this.a*(this.g-n)}var o=this.ns*u(r-this.long0),a=this.x0+e*Math.sin(o),s=this.y0+this.rh-e*Math.cos(o);return t.x=a,t.y=s,t},r.inverse=function(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,r,i,n;this.ns>=0?(r=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(r=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(0!==r&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return n=u(this.long0+o/this.ns),i=c(this.g-r/this.a),t.x=n,t.y=i,t;var a=this.g-r/this.a;return i=h(a,this.e0,this.e1,this.e2,this.e3),n=u(this.long0+o/this.ns),t.x=n,t.y=i,t},r.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],45:[function(t,e,r){var i=Math.PI/4,n=t("../common/srat"),o=Math.PI/2,a=20;r.init=function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+i)/(Math.pow(Math.tan(.5*this.lat0+i),this.C)*n(this.e*t,this.ratexp))},r.forward=function(t){var e=t.x,r=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+i),this.C)*n(this.e*Math.sin(r),this.ratexp))-o,t.x=this.C*e,t},r.inverse=function(t){for(var e=1e-14,r=t.x/this.C,s=t.y,l=Math.pow(Math.tan(.5*s+i)/this.K,1/this.C),u=a;u>0&&(s=2*Math.atan(l*n(this.e*Math.sin(t.y),-.5*this.e))-o,!(Math.abs(s-t.y)<e));--u)t.y=s;return u?(t.x=r,t.y=s,t):null},r.names=["gauss"]},{"../common/srat":22}],46:[function(t,e,r){var i=t("../common/adjust_lon"),n=1e-10,o=t("../common/asinz");r.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},r.forward=function(t){var e,r,o,a,s,l,u,c,h=t.x,f=t.y;return o=i(h-this.long0),e=Math.sin(f),r=Math.cos(f),a=Math.cos(o),l=this.sin_p14*e+this.cos_p14*r*a,s=1,l>0||Math.abs(l)<=n?(u=this.x0+this.a*s*r*Math.sin(o)/l,c=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*r*a)/l):(u=this.x0+this.infinity_dist*r*Math.sin(o),c=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*r*a)),t.x=u,t.y=c,t},r.inverse=function(t){var e,r,n,a,s,l;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(a=Math.atan2(e,this.rc),r=Math.sin(a),n=Math.cos(a),l=o(n*this.sin_p14+t.y*r*this.cos_p14/e),s=Math.atan2(t.x*r,e*this.cos_p14*n-t.y*this.sin_p14*r),s=i(this.long0+s)):(l=this.phic0,s=0),t.x=s,t.y=l,t},r.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],47:[function(t,e,r){var i=t("../common/adjust_lon");r.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},r.forward=function(t){var e,r,n,o,a,s,l,u=t.x,c=t.y,h=i(u-this.long0);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),n=-h*this.alfa,o=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(n)),a=Math.asin(Math.cos(r)*Math.sin(n)/Math.cos(o)),s=this.n*a,l=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(o/2+this.s45),this.n),t.y=l*Math.cos(s)/1,t.x=l*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t},r.inverse=function(t){var e,r,i,n,o,a,s,l,u=t.x;t.x=t.y,t.y=u,this.czech||(t.y*=-1,t.x*=-1),a=Math.sqrt(t.x*t.x+t.y*t.y),o=Math.atan2(t.y,t.x),n=o/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),r=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(e)),t.x=this.long0-r/this.alfa,s=e,l=0;var c=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(l=1),s=t.y,c+=1;while(0===l&&15>c);return c>=15?null:t},r.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],48:[function(t,e,r){var i=Math.PI/2,n=Math.PI/4,o=1e-10,a=t("../common/qsfnz"),s=t("../common/adjust_lon");r.S_POLE=1,r.N_POLE=2,r.EQUIT=3,r.OBLIQ=4,r.init=function(){var t=Math.abs(this.lat0);if(Math.abs(t-i)<o?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<o?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=a(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=a(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},r.forward=function(t){var e,r,l,u,c,h,f,d,p,m,g=t.x,y=t.y;if(g=s(g-this.long0),this.sphere){if(c=Math.sin(y),m=Math.cos(y),l=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(r=this.mode===this.EQUIT?1+m*l:1+this.sinph0*c+this.cosph0*m*l,o>=r)return null;r=Math.sqrt(2/r),e=r*m*Math.sin(g),r*=this.mode===this.EQUIT?c:this.cosph0*c-this.sinph0*m*l}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(l=-l),Math.abs(y+this.phi0)<o)return null;r=n-.5*y,r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r)),e=r*Math.sin(g),r*=l}}else{switch(f=0,d=0,p=0,l=Math.cos(g),u=Math.sin(g),c=Math.sin(y),h=a(this.e,c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=h/this.qp,d=Math.sqrt(1-f*f)),this.mode){case this.OBLIQ:p=1+this.sinb1*f+this.cosb1*d*l;break;case this.EQUIT:p=1+d*l;break;case this.N_POLE:p=i+y,h=this.qp-h;break;case this.S_POLE:p=y-i,h=this.qp+h}if(Math.abs(p)<o)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:p=Math.sqrt(2/p),r=this.mode===this.OBLIQ?this.ymf*p*(this.cosb1*f-this.sinb1*d*l):(p=Math.sqrt(2/(1+d*l)))*f*this.ymf,e=this.xmf*p*d*u;break;case this.N_POLE:case this.S_POLE:h>=0?(e=(p=Math.sqrt(h))*u,r=l*(this.mode===this.S_POLE?p:-p)):e=r=0}}return t.x=this.a*e+this.x0,t.y=this.a*r+this.y0,t},r.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,r,n,a,l,u,c,h=t.x/this.a,f=t.y/this.a;if(this.sphere){var d,p=0,m=0;if(d=Math.sqrt(h*h+f*f),r=.5*d,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(r),p=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(d)<=o?0:Math.asin(f*m/d),h*=m,f=p*d;break;case this.OBLIQ:r=Math.abs(d)<=o?this.phi0:Math.asin(p*this.sinph0+f*m*this.cosph0/d),h*=m*this.cosph0,f=(p-Math.sin(r)*this.sinph0)*d;break;case this.N_POLE:f=-f,r=i-r;break;case this.S_POLE:r-=i}e=0!==f||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(h,f):0}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(h/=this.dd,f*=this.dd,u=Math.sqrt(h*h+f*f),o>u)return t.x=0,t.y=this.phi0,t;a=2*Math.asin(.5*u/this.rq),n=Math.cos(a),h*=a=Math.sin(a),this.mode===this.OBLIQ?(c=n*this.sinb1+f*a*this.cosb1/u,l=this.qp*c,f=u*this.cosb1*n-f*this.sinb1*a):(c=f*a/u,l=this.qp*c,f=u*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(f=-f),l=h*h+f*f,!l)return t.x=0,t.y=this.phi0,t;c=1-l/this.qp,this.mode===this.S_POLE&&(c=-c)}e=Math.atan2(h,f),r=this.authlat(Math.asin(c),this.apa)}return t.x=s(this.long0+e),t.y=r,t},r.P00=.3333333333333333,r.P01=.17222222222222222,r.P02=.10257936507936508,r.P10=.06388888888888888,r.P11=.0664021164021164,r.P20=.016415012942191543,r.authset=function(t){var e,r=[];return r[0]=t*this.P00,e=t*t,r[0]+=e*this.P01,r[1]=e*this.P10,e*=t,r[0]+=e*this.P02,r[1]+=e*this.P11,r[2]=e*this.P20,r},r.authlat=function(t,e){var r=t+t;return t+e[0]*Math.sin(r)+e[1]*Math.sin(r+r)+e[2]*Math.sin(r+r+r)},r.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],49:[function(t,e,r){var i=1e-10,n=t("../common/msfnz"),o=t("../common/tsfnz"),a=Math.PI/2,s=t("../common/sign"),l=t("../common/adjust_lon"),u=t("../common/phi2z");r.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<i)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),r=Math.cos(this.lat1),a=n(this.e,e,r),s=o(this.e,this.lat1,e),l=Math.sin(this.lat2),u=Math.cos(this.lat2),c=n(this.e,l,u),h=o(this.e,this.lat2,l),f=o(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>i?this.ns=Math.log(a/c)/Math.log(s/h):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=a/(this.ns*Math.pow(s,this.ns)),this.rh=this.a*this.f0*Math.pow(f,this.ns),this.title||(this.title="Lambert Conformal Conic")}},r.forward=function(t){var e=t.x,r=t.y;Math.abs(2*Math.abs(r)-Math.PI)<=i&&(r=s(r)*(a-2*i));var n,u,c=Math.abs(Math.abs(r)-a);if(c>i)n=o(this.e,r,Math.sin(r)),u=this.a*this.f0*Math.pow(n,this.ns);else{if(c=r*this.ns,0>=c)return null;u=0}var h=this.ns*l(e-this.long0);return t.x=this.k0*(u*Math.sin(h))+this.x0,t.y=this.k0*(this.rh-u*Math.cos(h))+this.y0,t},r.inverse=function(t){var e,r,i,n,o,s=(t.x-this.x0)/this.k0,c=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+c*c),r=1):(e=-Math.sqrt(s*s+c*c),r=-1);var h=0;if(0!==e&&(h=Math.atan2(r*s,r*c)),0!==e||this.ns>0){if(r=1/this.ns,i=Math.pow(e/(this.a*this.f0),r),n=u(this.e,i),-9999===n)return null}else n=-a;return o=l(h/this.ns+this.long0),t.x=o,t.y=n,t},r.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],50:[function(t,e,r){function i(t){return t}r.init=function(){},r.forward=i,r.inverse=i,r.names=["longlat","identity"]},{}],51:[function(t,e,r){var i=t("../common/msfnz"),n=Math.PI/2,o=1e-10,a=57.29577951308232,s=t("../common/adjust_lon"),l=Math.PI/4,u=t("../common/tsfnz"),c=t("../common/phi2z");r.init=function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=i(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},r.forward=function(t){var e=t.x,r=t.y;if(r*a>90&&-90>r*a&&e*a>180&&-180>e*a)return null;var i,c;if(Math.abs(Math.abs(r)-n)<=o)return null;if(this.sphere)i=this.x0+this.a*this.k0*s(e-this.long0),c=this.y0+this.a*this.k0*Math.log(Math.tan(l+.5*r));else{var h=Math.sin(r),f=u(this.e,r,h);i=this.x0+this.a*this.k0*s(e-this.long0),c=this.y0-this.a*this.k0*Math.log(f)}return t.x=i,t.y=c,t},r.inverse=function(t){var e,r,i=t.x-this.x0,o=t.y-this.y0;if(this.sphere)r=n-2*Math.atan(Math.exp(-o/(this.a*this.k0)));else{var a=Math.exp(-o/(this.a*this.k0));if(r=c(this.e,a),-9999===r)return null}return e=s(this.long0+i/(this.a*this.k0)),t.x=e,t.y=r,t},r.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],52:[function(t,e,r){var i=t("../common/adjust_lon");r.init=function(){},r.forward=function(t){var e=t.x,r=t.y,n=i(e-this.long0),o=this.x0+this.a*n,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;return t.x=o,t.y=a,t},r.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e=i(this.long0+t.x/this.a),r=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=r,t},r.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],53:[function(t,e,r){var i=t("../common/adjust_lon"),n=1e-10;r.init=function(){},r.forward=function(t){for(var e=t.x,r=t.y,o=i(e-this.long0),a=r,s=Math.PI*Math.sin(r),l=0;!0;l++){var u=-(a+Math.sin(a)-s)/(1+Math.cos(a));if(a+=u,Math.abs(u)<n)break}a/=2,Math.PI/2-Math.abs(r)<n&&(o=0);var c=.900316316158*this.a*o*Math.cos(a)+this.x0,h=1.4142135623731*this.a*Math.sin(a)+this.y0;return t.x=c,t.y=h,t},r.inverse=function(t){var e,r;t.x-=this.x0,t.y-=this.y0,r=t.y/(1.4142135623731*this.a),Math.abs(r)>.999999999999&&(r=.999999999999),e=Math.asin(r);var n=i(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),r=(2*e+Math.sin(2*e))/Math.PI,Math.abs(r)>1&&(r=1);var o=Math.asin(r);return t.x=n,t.y=o,t},r.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],54:[function(t,e,r){var i=484813681109536e-20;r.iterations=1,r.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,
this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},r.forward=function(t){var e,r=t.x,n=t.y,o=n-this.lat0,a=r-this.long0,s=o/i*1e-5,l=a,u=1,c=0;for(e=1;10>=e;e++)u*=s,c+=this.A[e]*u;var h,f,d=c,p=l,m=1,g=0,y=0,v=0;for(e=1;6>=e;e++)h=m*d-g*p,f=g*d+m*p,m=h,g=f,y=y+this.B_re[e]*m-this.B_im[e]*g,v=v+this.B_im[e]*m+this.B_re[e]*g;return t.x=v*this.a+this.x0,t.y=y*this.a+this.y0,t},r.inverse=function(t){var e,r,n,o=t.x,a=t.y,s=o-this.x0,l=a-this.y0,u=l/this.a,c=s/this.a,h=1,f=0,d=0,p=0;for(e=1;6>=e;e++)r=h*u-f*c,n=f*u+h*c,h=r,f=n,d=d+this.C_re[e]*h-this.C_im[e]*f,p=p+this.C_im[e]*h+this.C_re[e]*f;for(var m=0;m<this.iterations;m++){var g,y,v=d,E=p,w=u,b=c;for(e=2;6>=e;e++)g=v*d-E*p,y=E*d+v*p,v=g,E=y,w+=(e-1)*(this.B_re[e]*v-this.B_im[e]*E),b+=(e-1)*(this.B_im[e]*v+this.B_re[e]*E);v=1,E=0;var x=this.B_re[1],_=this.B_im[1];for(e=2;6>=e;e++)g=v*d-E*p,y=E*d+v*p,v=g,E=y,x+=e*(this.B_re[e]*v-this.B_im[e]*E),_+=e*(this.B_im[e]*v+this.B_re[e]*E);var S=x*x+_*_;d=(w*x+b*_)/S,p=(b*x-w*_)/S}var T=d,L=p,M=1,A=0;for(e=1;9>=e;e++)M*=T,A+=this.D[e]*M;var N=this.lat0+A*i*1e5,R=this.long0+L;return t.x=R,t.y=N,t},r.names=["New_Zealand_Map_Grid","nzmg"]},{}],55:[function(t,e,r){var i=t("../common/tsfnz"),n=t("../common/adjust_lon"),o=t("../common/phi2z"),a=Math.PI/2,s=Math.PI/4,l=1e-10;r.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),r=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-r*r);var o=i(this.e,this.lat0,t),a=this.bl/e*Math.sqrt((1-this.es)/(1-r*r));1>a*a&&(a=1);var s,l;if(isNaN(this.longc)){var u=i(this.e,this.lat1,Math.sin(this.lat1)),c=i(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(a+Math.sqrt(a*a-1))*Math.pow(o,this.bl):this.el=(a-Math.sqrt(a*a-1))*Math.pow(o,this.bl);var h=Math.pow(u,this.bl),f=Math.pow(c,this.bl);s=this.el/h,l=.5*(s-1/s);var d=(this.el*this.el-f*h)/(this.el*this.el+f*h),p=(f-h)/(f+h),m=n(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(d*Math.tan(.5*this.bl*m)/p)/this.bl,this.long0=n(this.long0);var g=n(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*g)/l),this.alpha=Math.asin(a*Math.sin(this.gamma0))}else s=this.lat0>=0?a+Math.sqrt(a*a-1):a-Math.sqrt(a*a-1),this.el=s*Math.pow(o,this.bl),l=.5*(s-1/s),this.gamma0=Math.asin(Math.sin(this.alpha)/a),this.long0=this.longc-Math.asin(l*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha))},r.forward=function(t){var e,r,o,u=t.x,c=t.y,h=n(u-this.long0);if(Math.abs(Math.abs(c)-a)<=l)o=c>0?-1:1,r=this.al/this.bl*Math.log(Math.tan(s+o*this.gamma0*.5)),e=-1*o*a*this.al/this.bl;else{var f=i(this.e,c,Math.sin(c)),d=this.el/Math.pow(f,this.bl),p=.5*(d-1/d),m=.5*(d+1/d),g=Math.sin(this.bl*h),y=(p*Math.sin(this.gamma0)-g*Math.cos(this.gamma0))/m;r=Math.abs(Math.abs(y)-1)<=l?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-y)/(1+y))/this.bl,e=Math.abs(Math.cos(this.bl*h))<=l?this.al*this.bl*h:this.al*Math.atan2(p*Math.cos(this.gamma0)+g*Math.sin(this.gamma0),Math.cos(this.bl*h))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+r):(e-=this.uc,t.x=this.x0+r*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-r*Math.sin(this.alpha)),t},r.inverse=function(t){var e,r;this.no_rot?(r=t.y-this.y0,e=t.x-this.x0):(r=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var i=Math.exp(-1*this.bl*r/this.al),s=.5*(i-1/i),u=.5*(i+1/i),c=Math.sin(this.bl*e/this.al),h=(c*Math.cos(this.gamma0)+s*Math.sin(this.gamma0))/u,f=Math.pow(this.el/Math.sqrt((1+h)/(1-h)),1/this.bl);return Math.abs(h-1)<l?(t.x=this.long0,t.y=a):Math.abs(h+1)<l?(t.x=this.long0,t.y=-1*a):(t.y=o(this.e,f),t.x=n(this.long0-Math.atan2(s*Math.cos(this.gamma0)-c*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},r.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],56:[function(t,e,r){var i=t("../common/e0fn"),n=t("../common/e1fn"),o=t("../common/e2fn"),a=t("../common/e3fn"),s=t("../common/adjust_lon"),l=t("../common/adjust_lat"),u=t("../common/mlfn"),c=1e-10,h=t("../common/gN"),f=20;r.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=i(this.es),this.e1=n(this.es),this.e2=o(this.es),this.e3=a(this.es),this.ml0=this.a*u(this.e0,this.e1,this.e2,this.e3,this.lat0)},r.forward=function(t){var e,r,i,n=t.x,o=t.y,a=s(n-this.long0);if(i=a*Math.sin(o),this.sphere)Math.abs(o)<=c?(e=this.a*a,r=-1*this.a*this.lat0):(e=this.a*Math.sin(i)/Math.tan(o),r=this.a*(l(o-this.lat0)+(1-Math.cos(i))/Math.tan(o)));else if(Math.abs(o)<=c)e=this.a*a,r=-1*this.ml0;else{var f=h(this.a,this.e,Math.sin(o))/Math.tan(o);e=f*Math.sin(i),r=this.a*u(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+f*(1-Math.cos(i))}return t.x=e+this.x0,t.y=r+this.y0,t},r.inverse=function(t){var e,r,i,n,o,a,l,h,d;if(i=t.x-this.x0,n=t.y-this.y0,this.sphere)if(Math.abs(n+this.a*this.lat0)<=c)e=s(i/this.a+this.long0),r=0;else{a=this.lat0+n/this.a,l=i*i/this.a/this.a+a*a,h=a;var p;for(o=f;o;--o)if(p=Math.tan(h),d=-1*(a*(h*p+1)-h-.5*(h*h+l)*p)/((h-a)/p-1),h+=d,Math.abs(d)<=c){r=h;break}e=s(this.long0+Math.asin(i*Math.tan(h)/this.a)/Math.sin(r))}else if(Math.abs(n+this.ml0)<=c)r=0,e=s(this.long0+i/this.a);else{a=(this.ml0+n)/this.a,l=i*i/this.a/this.a+a*a,h=a;var m,g,y,v,E;for(o=f;o;--o)if(E=this.e*Math.sin(h),m=Math.sqrt(1-E*E)*Math.tan(h),g=this.a*u(this.e0,this.e1,this.e2,this.e3,h),y=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),v=g/this.a,d=(a*(m*v+1)-v-.5*m*(v*v+l))/(this.es*Math.sin(2*h)*(v*v+l-2*a*v)/(4*m)+(a-v)*(m*y-2/Math.sin(2*h))-y),h-=d,Math.abs(d)<=c){r=h;break}m=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r),e=s(this.long0+Math.asin(i*m/this.a)/Math.sin(r))}return t.x=e,t.y=r,t},r.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],57:[function(t,e,r){var i=t("../common/adjust_lon"),n=t("../common/adjust_lat"),o=t("../common/pj_enfn"),a=20,s=t("../common/pj_mlfn"),l=t("../common/pj_inv_mlfn"),u=Math.PI/2,c=1e-10,h=t("../common/asinz");r.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=o(this.es)},r.forward=function(t){var e,r,n=t.x,o=t.y;if(n=i(n-this.long0),this.sphere){if(this.m)for(var l=this.n*Math.sin(o),u=a;u;--u){var h=(this.m*o+Math.sin(o)-l)/(this.m+Math.cos(o));if(o-=h,Math.abs(h)<c)break}else o=1!==this.n?Math.asin(this.n*Math.sin(o)):o;e=this.a*this.C_x*n*(this.m+Math.cos(o)),r=this.a*this.C_y*o}else{var f=Math.sin(o),d=Math.cos(o);r=this.a*s(o,f,d,this.en),e=this.a*n*d/Math.sqrt(1-this.es*f*f)}return t.x=e,t.y=r,t},r.inverse=function(t){var e,r,o,a;return t.x-=this.x0,o=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,o/=this.C_x*(this.m+Math.cos(e)),this.m?e=h((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=h(Math.sin(e)/this.n)),o=i(o+this.long0),e=n(e)):(e=l(t.y/this.a,this.es,this.en),a=Math.abs(e),u>a?(a=Math.sin(e),r=this.long0+t.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(e)),o=i(r)):u>a-c&&(o=this.long0)),t.x=o,t.y=e,t},r.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],58:[function(t,e,r){r.init=function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),r=this.a,i=this.rf,n=1/i,o=2*n-Math.pow(n,2),a=this.e=Math.sqrt(o);this.R=this.k0*r*Math.sqrt(1-o)/(1-o*Math.pow(e,2)),this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+t/2)),u=Math.log((1+a*e)/(1-a*e));this.K=s-this.alpha*l+this.alpha*a/2*u},r.forward=function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),r=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+r)+this.K,n=2*(Math.atan(Math.exp(i))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),a=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(n)+Math.cos(this.b0)*Math.cos(o))),s=Math.asin(Math.cos(this.b0)*Math.sin(n)-Math.sin(this.b0)*Math.cos(n)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*a+this.x0,t},r.inverse=function(t){for(var e=t.x-this.x0,r=t.y-this.y0,i=e/this.R,n=2*(Math.atan(Math.exp(r/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(n)+Math.sin(this.b0)*Math.cos(n)*Math.cos(i)),a=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(n))),s=this.lambda0+a/this.alpha,l=0,u=o,c=-1e3,h=0;Math.abs(u-c)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),c=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=s,t.y=u,t},r.names=["somerc"]},{}],59:[function(t,e,r){var i=Math.PI/2,n=1e-10,o=t("../common/sign"),a=t("../common/msfnz"),s=t("../common/tsfnz"),l=t("../common/phi2z"),u=t("../common/adjust_lon");r.ssfn_=function(t,e,r){return e*=r,Math.tan(.5*(i+t))*Math.pow((1-e)/(1+e),.5*r)},r.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=n&&(this.k0=.5*(1+o(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=n&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=n&&(this.k0=.5*this.cons*a(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/s(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=a(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-i,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},r.forward=function(t){var e,r,o,a,l,c,h=t.x,f=t.y,d=Math.sin(f),p=Math.cos(f),m=u(h-this.long0);return Math.abs(Math.abs(h-this.long0)-Math.PI)<=n&&Math.abs(f+this.lat0)<=n?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*d+this.coslat0*p*Math.cos(m)),t.x=this.a*e*p*Math.sin(m)+this.x0,t.y=this.a*e*(this.coslat0*d-this.sinlat0*p*Math.cos(m))+this.y0,t):(r=2*Math.atan(this.ssfn_(f,d,this.e))-i,a=Math.cos(r),o=Math.sin(r),Math.abs(this.coslat0)<=n?(l=s(this.e,f*this.con,this.con*d),c=2*this.a*this.k0*l/this.cons,t.x=this.x0+c*Math.sin(h-this.long0),t.y=this.y0-this.con*c*Math.cos(h-this.long0),t):(Math.abs(this.sinlat0)<n?(e=2*this.a*this.k0/(1+a*Math.cos(m)),t.y=e*o):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*a*Math.cos(m))),t.y=e*(this.cosX0*o-this.sinX0*a*Math.cos(m))+this.y0),t.x=e*a*Math.sin(m)+this.x0,t))},r.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,r,o,a,s,c=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var h=2*Math.atan(c/(.5*this.a*this.k0));return e=this.long0,r=this.lat0,n>=c?(t.x=e,t.y=r,t):(r=Math.asin(Math.cos(h)*this.sinlat0+t.y*Math.sin(h)*this.coslat0/c),e=u(Math.abs(this.coslat0)<n?this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y):this.long0+Math.atan2(t.x*Math.sin(h),c*this.coslat0*Math.cos(h)-t.y*this.sinlat0*Math.sin(h))),t.x=e,t.y=r,t)}if(Math.abs(this.coslat0)<=n){if(n>=c)return r=this.lat0,e=this.long0,t.x=e,t.y=r,t;t.x*=this.con,t.y*=this.con,o=c*this.cons/(2*this.a*this.k0),r=this.con*l(this.e,o),e=this.con*u(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else a=2*Math.atan(c*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,n>=c?s=this.X0:(s=Math.asin(Math.cos(a)*this.sinX0+t.y*Math.sin(a)*this.cosX0/c),e=u(this.long0+Math.atan2(t.x*Math.sin(a),c*this.cosX0*Math.cos(a)-t.y*this.sinX0*Math.sin(a)))),r=-1*l(this.e,Math.tan(.5*(i+s)));return t.x=e,t.y=r,t},r.names=["stere"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],60:[function(t,e,r){var i=t("./gauss"),n=t("../common/adjust_lon");r.init=function(){i.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},r.forward=function(t){var e,r,o,a;return t.x=n(t.x-this.long0),i.forward.apply(this,[t]),e=Math.sin(t.y),r=Math.cos(t.y),o=Math.cos(t.x),a=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*r*o),t.x=a*r*Math.sin(t.x),t.y=a*(this.cosc0*e-this.sinc0*r*o),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},r.inverse=function(t){var e,r,o,a,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=Math.sqrt(t.x*t.x+t.y*t.y)){var l=2*Math.atan2(s,this.R2);e=Math.sin(l),r=Math.cos(l),a=Math.asin(r*this.sinc0+t.y*e*this.cosc0/s),o=Math.atan2(t.x*e,s*this.cosc0*r-t.y*this.sinc0*e)}else a=this.phic0,o=0;return t.x=o,t.y=a,i.inverse.apply(this,[t]),t.x=n(t.x+this.long0),t},r.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":45}],61:[function(t,e,r){var i=t("../common/e0fn"),n=t("../common/e1fn"),o=t("../common/e2fn"),a=t("../common/e3fn"),s=t("../common/mlfn"),l=t("../common/adjust_lon"),u=Math.PI/2,c=1e-10,h=t("../common/sign"),f=t("../common/asinz");r.init=function(){this.e0=i(this.es),this.e1=n(this.es),this.e2=o(this.es),this.e3=a(this.es),this.ml0=this.a*s(this.e0,this.e1,this.e2,this.e3,this.lat0)},r.forward=function(t){var e,r,i,n=t.x,o=t.y,a=l(n-this.long0),u=Math.sin(o),c=Math.cos(o);if(this.sphere){var h=c*Math.sin(a);if(Math.abs(Math.abs(h)-1)<1e-10)return 93;r=.5*this.a*this.k0*Math.log((1+h)/(1-h)),e=Math.acos(c*Math.cos(a)/Math.sqrt(1-h*h)),0>o&&(e=-e),i=this.a*this.k0*(e-this.lat0)}else{var f=c*a,d=Math.pow(f,2),p=this.ep2*Math.pow(c,2),m=Math.tan(o),g=Math.pow(m,2);e=1-this.es*Math.pow(u,2);var y=this.a/Math.sqrt(e),v=this.a*s(this.e0,this.e1,this.e2,this.e3,o);r=this.k0*y*f*(1+d/6*(1-g+p+d/20*(5-18*g+Math.pow(g,2)+72*p-58*this.ep2)))+this.x0,i=this.k0*(v-this.ml0+y*m*(d*(.5+d/24*(5-g+9*p+4*Math.pow(p,2)+d/30*(61-58*g+Math.pow(g,2)+600*p-330*this.ep2)))))+this.y0}return t.x=r,t.y=i,t},r.inverse=function(t){var e,r,i,n,o,a,s=6;if(this.sphere){var d=Math.exp(t.x/(this.a*this.k0)),p=.5*(d-1/d),m=this.lat0+t.y/(this.a*this.k0),g=Math.cos(m);e=Math.sqrt((1-g*g)/(1+p*p)),o=f(e),0>m&&(o=-o),a=0===p&&0===g?this.long0:l(Math.atan2(p,g)+this.long0)}else{var y=t.x-this.x0,v=t.y-this.y0;for(e=(this.ml0+v/this.k0)/this.a,r=e,n=0;!0&&(i=(e+this.e1*Math.sin(2*r)-this.e2*Math.sin(4*r)+this.e3*Math.sin(6*r))/this.e0-r,r+=i,!(Math.abs(i)<=c));n++)if(n>=s)return 95;if(Math.abs(r)<u){var E=Math.sin(r),w=Math.cos(r),b=Math.tan(r),x=this.ep2*Math.pow(w,2),_=Math.pow(x,2),S=Math.pow(b,2),T=Math.pow(S,2);e=1-this.es*Math.pow(E,2);var L=this.a/Math.sqrt(e),M=L*(1-this.es)/e,A=y/(L*this.k0),N=Math.pow(A,2);o=r-L*b*N/M*(.5-N/24*(5+3*S+10*x-4*_-9*this.ep2-N/30*(61+90*S+298*x+45*T-252*this.ep2-3*_))),a=l(this.long0+A*(1-N/6*(1+2*S+x-N/20*(5-2*x+28*S-3*_+8*this.ep2+24*T)))/w)}else o=u*h(v),a=this.long0}return t.x=a,t.y=o,t},r.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],62:[function(t,e,r){var i=.017453292519943295,n=t("./tmerc");r.dependsOn="tmerc",r.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*i,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,n.init.apply(this),this.forward=n.forward,this.inverse=n.inverse)},r.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":61}],63:[function(t,e,r){var i=t("../common/adjust_lon"),n=Math.PI/2,o=1e-10,a=t("../common/asinz");r.init=function(){this.R=this.a},r.forward=function(t){var e,r,s=t.x,l=t.y,u=i(s-this.long0);Math.abs(l)<=o&&(e=this.x0+this.R*u,r=this.y0);var c=a(2*Math.abs(l/Math.PI));(Math.abs(u)<=o||Math.abs(Math.abs(l)-n)<=o)&&(e=this.x0,r=l>=0?this.y0+Math.PI*this.R*Math.tan(.5*c):this.y0+Math.PI*this.R*-Math.tan(.5*c));var h=.5*Math.abs(Math.PI/u-u/Math.PI),f=h*h,d=Math.sin(c),p=Math.cos(c),m=p/(d+p-1),g=m*m,y=m*(2/d-1),v=y*y,E=Math.PI*this.R*(h*(m-v)+Math.sqrt(f*(m-v)*(m-v)-(v+f)*(g-v)))/(v+f);0>u&&(E=-E),e=this.x0+E;var w=f+m;return E=Math.PI*this.R*(y*w-h*Math.sqrt((v+f)*(f+1)-w*w))/(v+f),r=l>=0?this.y0+E:this.y0-E,t.x=e,t.y=r,t},r.inverse=function(t){var e,r,n,a,s,l,u,c,h,f,d,p,m;return t.x-=this.x0,t.y-=this.y0,d=Math.PI*this.R,n=t.x/d,a=t.y/d,s=n*n+a*a,l=-Math.abs(a)*(1+s),u=l-2*a*a+n*n,c=-2*l+1+2*a*a+s*s,m=a*a/c+(2*u*u*u/c/c/c-9*l*u/c/c)/27,h=(l-u*u/3/c)/c,f=2*Math.sqrt(-h/3),d=3*m/h/f,Math.abs(d)>1&&(d=d>=0?1:-1),p=Math.acos(d)/3,r=t.y>=0?(-f*Math.cos(p+Math.PI/3)-u/3/c)*Math.PI:-(-f*Math.cos(p+Math.PI/3)-u/3/c)*Math.PI,e=Math.abs(n)<o?this.long0:i(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(n*n-a*a)+s*s))/2/n),t.x=e,t.y=r,t},r.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],64:[function(t,e,r){var i=.017453292519943295,n=57.29577951308232,o=1,a=2,s=t("./datum_transform"),l=t("./adjust_axis"),u=t("./Proj"),c=t("./common/toPoint");e.exports=function h(t,e,r){function f(t,e){return(t.datum.datum_type===o||t.datum.datum_type===a)&&"WGS84"!==e.datumCode}var d;return Array.isArray(r)&&(r=c(r)),t.datum&&e.datum&&(f(t,e)||f(e,t))&&(d=new u("WGS84"),h(t,d,r),t=d),"enu"!==t.axis&&l(t,!1,r),"longlat"===t.projName?(r.x*=i,r.y*=i):(t.to_meter&&(r.x*=t.to_meter,r.y*=t.to_meter),t.inverse(r)),t.from_greenwich&&(r.x+=t.from_greenwich),r=s(t.datum,e.datum,r),e.from_greenwich&&(r.x-=e.from_greenwich),"longlat"===e.projName?(r.x*=n,r.y*=n):(e.forward(r),e.to_meter&&(r.x/=e.to_meter,r.y/=e.to_meter)),"enu"!==e.axis&&l(e,!0,r),r}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":30}],65:[function(t,e,r){function i(t,e,r){t[e]=r.map(function(t){var e={};return n(t,e),e}).reduce(function(t,e){return u(t,e)},{})}function n(t,e){var r;return Array.isArray(t)?(r=t.shift(),"PARAMETER"===r&&(r=t.shift()),1===t.length?Array.isArray(t[0])?(e[r]={},n(t[0],e[r])):e[r]=t[0]:t.length?"TOWGS84"===r?e[r]=t:(e[r]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(r)>-1?(e[r]={name:t[0].toLowerCase(),convert:t[1]},3===t.length&&(e[r].auth=t[2])):"SPHEROID"===r?(e[r]={name:t[0],a:t[1],rf:t[2]},4===t.length&&(e[r].auth=t[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(r)>-1?(t[0]=["name",t[0]],i(e,r,t)):t.every(function(t){return Array.isArray(t)})?i(e,r,t):n(t,e[r])):e[r]=!0,void 0):void(e[t]=!0)}function o(t,e){var r=e[0],i=e[1];!(r in t)&&i in t&&(t[r]=t[i],3===e.length&&(t[r]=e[2](t[r])))}function a(t){return t*l}function s(t){function e(e){var r=t.to_meter||1;return parseFloat(e,10)*r}"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&(t.to_meter=parseFloat(t.UNIT.convert,10))),t.GEOGCS&&(t.GEOGCS.DATUM?t.datumCode=t.GEOGCS.DATUM.name.toLowerCase():t.datumCode=t.GEOGCS.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===t.datumCode||"new_zealand_1949"===t.datumCode)&&(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),t.GEOGCS.DATUM&&t.GEOGCS.DATUM.SPHEROID&&(t.ellps=t.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=t.GEOGCS.DATUM.SPHEROID.a,t.rf=parseFloat(t.GEOGCS.DATUM.SPHEROID.rf,10)),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36")),t.b&&!isFinite(t.b)&&(t.b=t.a);var r=function(e){return o(t,e)},i=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",a],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",a],["x0","false_easting",e],["y0","false_northing",e],["long0","central_meridian",a],["lat0","latitude_of_origin",a],["lat0","standard_parallel_1",a],["lat1","standard_parallel_1",a],["lat2","standard_parallel_2",a],["alpha","azimuth",a],["srsCode","name"]];i.forEach(r),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.PROJECTION&&"Lambert_Azimuthal_Equal_Area"!==t.PROJECTION||(t.long0=t.longc)}var l=.017453292519943295,u=t("./extend");e.exports=function(t,e){var r=JSON.parse((","+t).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),i=r.shift(),o=r.shift();r.unshift(["name",o]),r.unshift(["type",i]),r.unshift("output");var a={};return n(r,a),s(a.output),u(e,a.output)}},{"./extend":33}],66:[function(t,e,r){function i(t){return t*(Math.PI/180)}function n(t){return 180*(t/Math.PI)}function o(t){var e,r,n,o,a,l,u,c,h,f=t.lat,d=t.lon,p=6378137,m=.00669438,g=.9996,y=i(f),v=i(d);h=Math.floor((d+180)/6)+1,180===d&&(h=60),f>=56&&64>f&&d>=3&&12>d&&(h=32),f>=72&&84>f&&(d>=0&&9>d?h=31:d>=9&&21>d?h=33:d>=21&&33>d?h=35:d>=33&&42>d&&(h=37)),e=6*(h-1)-180+3,c=i(e),r=m/(1-m),n=p/Math.sqrt(1-m*Math.sin(y)*Math.sin(y)),o=Math.tan(y)*Math.tan(y),a=r*Math.cos(y)*Math.cos(y),l=Math.cos(y)*(v-c),u=p*((1-m/4-3*m*m/64-5*m*m*m/256)*y-(3*m/8+3*m*m/32+45*m*m*m/1024)*Math.sin(2*y)+(15*m*m/256+45*m*m*m/1024)*Math.sin(4*y)-35*m*m*m/3072*Math.sin(6*y));var E=g*n*(l+(1-o+a)*l*l*l/6+(5-18*o+o*o+72*a-58*r)*l*l*l*l*l/120)+5e5,w=g*(u+n*Math.tan(y)*(l*l/2+(5-o+9*a+4*a*a)*l*l*l*l/24+(61-58*o+o*o+600*a-330*r)*l*l*l*l*l*l/720));return 0>f&&(w+=1e7),{northing:Math.round(w),easting:Math.round(E),zoneNumber:h,zoneLetter:s(f)}}function a(t){var e=t.northing,r=t.easting,i=t.zoneLetter,o=t.zoneNumber;if(0>o||o>60)return null;var s,l,u,c,h,f,d,p,m,g,y=.9996,v=6378137,E=.00669438,w=(1-Math.sqrt(1-E))/(1+Math.sqrt(1-E)),b=r-5e5,x=e;"N">i&&(x-=1e7),p=6*(o-1)-180+3,s=E/(1-E),d=x/y,m=d/(v*(1-E/4-3*E*E/64-5*E*E*E/256)),g=m+(3*w/2-27*w*w*w/32)*Math.sin(2*m)+(21*w*w/16-55*w*w*w*w/32)*Math.sin(4*m)+151*w*w*w/96*Math.sin(6*m),l=v/Math.sqrt(1-E*Math.sin(g)*Math.sin(g)),u=Math.tan(g)*Math.tan(g),c=s*Math.cos(g)*Math.cos(g),h=v*(1-E)/Math.pow(1-E*Math.sin(g)*Math.sin(g),1.5),f=b/(l*y);var _=g-l*Math.tan(g)/h*(f*f/2-(5+3*u+10*c-4*c*c-9*s)*f*f*f*f/24+(61+90*u+298*c+45*u*u-252*s-3*c*c)*f*f*f*f*f*f/720);_=n(_);var S=(f-(1+2*u+c)*f*f*f/6+(5-2*c+28*u-3*c*c+8*s+24*u*u)*f*f*f*f*f/120)/Math.cos(g);S=p+n(S);var T;if(t.accuracy){var L=a({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});T={top:L.lat,right:L.lon,bottom:_,left:S}}else T={lat:_,lon:S};return T}function s(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function l(t,e){var r=""+t.easting,i=""+t.northing;return t.zoneNumber+t.zoneLetter+u(t.easting,t.northing,t.zoneNumber)+r.substr(r.length-5,e)+i.substr(i.length-5,e)}function u(t,e,r){var i=c(r),n=Math.floor(t/1e5),o=Math.floor(e/1e5)%20;return h(n,o,i)}function c(t){var e=t%g;return 0===e&&(e=g),e}function h(t,e,r){var i=r-1,n=y.charCodeAt(i),o=v.charCodeAt(i),a=n+t-1,s=o+e,l=!1;a>_&&(a=a-_+E-1,l=!0),(a===w||w>n&&a>w||(a>w||w>n)&&l)&&a++,(a===b||b>n&&a>b||(a>b||b>n)&&l)&&(a++,a===w&&a++),a>_&&(a=a-_+E-1),s>x?(s=s-x+E-1,l=!0):l=!1,(s===w||w>o&&s>w||(s>w||w>o)&&l)&&s++,(s===b||b>o&&s>b||(s>b||b>o)&&l)&&(s++,s===w&&s++),s>x&&(s=s-x+E-1);var u=String.fromCharCode(a)+String.fromCharCode(s);return u}function f(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,r=t.length,i=null,n="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;n+=e,o++}var a=parseInt(n,10);if(0===o||o+3>r)throw"MGRSPoint bad conversion from: "+t;var s=t.charAt(o++);if("A">=s||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+t;i=t.substring(o,o+=2);for(var l=c(a),u=d(i.charAt(0),l),h=p(i.charAt(1),l);h<m(s);)h+=2e6;var f=r-o;if(f%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var g,y,v,E,w,b=f/2,x=0,_=0;return b>0&&(g=1e5/Math.pow(10,b),y=t.substring(o,o+b),x=parseFloat(y)*g,v=t.substring(o+b),_=parseFloat(v)*g),E=x+u,w=_+h,{easting:E,northing:w,zoneLetter:s,zoneNumber:a,accuracy:g}}function d(t,e){for(var r=y.charCodeAt(e-1),i=1e5,n=!1;r!==t.charCodeAt(0);){if(r++,r===w&&r++,r===b&&r++,r>_){if(n)throw"Bad character: "+t;r=E,n=!0}i+=1e5}return i}function p(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var r=v.charCodeAt(e-1),i=0,n=!1;r!==t.charCodeAt(0);){if(r++,r===w&&r++,r===b&&r++,r>x){if(n)throw"Bad character: "+t;r=E,n=!0}i+=1e5}return i}function m(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}var g=6,y="AJSAJS",v="AFAFAF",E=65,w=73,b=79,x=86,_=90;r.forward=function(t,e){return e=e||5,l(o({lat:t[1],lon:t[0]}),e)},r.inverse=function(t){var e=a(f(t.toUpperCase()));return[e.left,e.bottom,e.right,e.top]},r.toPoint=function(t){var e=r.inverse(t);return[(e[2]+e[0])/2,(e[3]+e[1])/2]}},{}],67:[function(t,e,r){e.exports={name:"proj4",version:"2.3.3",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(t,e,r){e.exports=t("gWUPNW")},{}],gWUPNW:[function(t,e,r){var i=[t("./lib/projections/tmerc"),t("./lib/projections/utm"),t("./lib/projections/sterea"),t("./lib/projections/stere"),t("./lib/projections/somerc"),t("./lib/projections/omerc"),t("./lib/projections/lcc"),t("./lib/projections/krovak"),t("./lib/projections/cass"),t("./lib/projections/laea"),t("./lib/projections/aea"),t("./lib/projections/gnom"),t("./lib/projections/cea"),t("./lib/projections/eqc"),t("./lib/projections/poly"),t("./lib/projections/nzmg"),t("./lib/projections/mill"),t("./lib/projections/sinu"),t("./lib/projections/moll"),t("./lib/projections/eqdc"),t("./lib/projections/vandg"),t("./lib/projections/aeqd")];e.exports=function(t){i.forEach(function(e){t.Proj.projections.add(e)})}},{"./lib/projections/aea":39,"./lib/projections/aeqd":40,"./lib/projections/cass":41,"./lib/projections/cea":42,"./lib/projections/eqc":43,"./lib/projections/eqdc":44,"./lib/projections/gnom":46,"./lib/projections/krovak":47,"./lib/projections/laea":48,"./lib/projections/lcc":49,"./lib/projections/mill":52,"./lib/projections/moll":53,"./lib/projections/nzmg":54,"./lib/projections/omerc":55,"./lib/projections/poly":56,"./lib/projections/sinu":57,"./lib/projections/somerc":58,"./lib/projections/stere":59,"./lib/projections/sterea":60,"./lib/projections/tmerc":61,"./lib/projections/utm":62,"./lib/projections/vandg":63}]},{},[35])(35)}),i("../src/worldwind/formats/geojson/GeoJSONCRS",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger","../../util/proj4-src"],function(t,e,r,i){"use strict";var n=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONCRS","constructor","missingType"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONCRS","constructor","missingProperties"));this._type=e,this._properties=i,this._projectionString=null};return Object.defineProperties(n.prototype,{type:{get:function(){return this._type}},properties:{get:function(){return this._properties}},projectionString:{get:function(){return this._projectionString}}}),n.prototype.isDefault=function(){return!this.isNamed()||this._projectionString!==e.EPSG4326_CRS&&this._projectionString!==e.WGS84_CRS?!1:!0},n.prototype.isNamed=function(){return this._type===e.FIELD_CRS_NAME},n.prototype.isLinked=function(){return this._type===e.FIELD_CRS_LINK},n.prototype.isCRSSupported=function(){try{i(this._projectionString,e.EPSG4326_CRS)}catch(t){return r.log(r.LEVEL_WARNING,"Unknown GeoJSON coordinate reference system ("+t+"): "+this._properties.name),!1}return!0},n.prototype.getLinkedCRSString=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="text",i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(this._projectionString=i.response,e()):r.log(r.LEVEL_WARNING,"GeoJSON Linked CRS retrieval failed ("+i.statusText+"): "+t))}.bind(this),i.onerror=function(){r.log(r.LEVEL_WARNING,"GeoJSON Linked CRS retrieval failed: "+t)},i.ontimeout=function(){r.log(r.LEVEL_WARNING,"GeoJSON Linked CRS retrieval timed out: "+t)},i.send(null)},n.prototype.setCRSString=function(t){this.isNamed()?(this._projectionString=this._properties.name,t()):this.isLinked()&&this.getLinkedCRSString(this._properties.href,t)},n}),i("../src/worldwind/formats/geojson/GeoJSONFeature",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o,a){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingGeometry"));if(!i[e.FIELD_TYPE])throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingFeatureGeometryType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingProperties"));this._geometry=i,this._properties=n,this._id=o,this._bbox=a};return Object.defineProperties(i.prototype,{geometry:{get:function(){return this._geometry}},properties:{
get:function(){return this._properties}},id:{get:function(){return this._id}},bbox:{get:function(){return this._bbox}}}),i}),i("../src/worldwind/formats/geojson/GeoJSONFeatureCollection",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(t,e,r){"use strict";var i=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeatureCollection","constructor","missingFeatures"));if("[object Array]"!==Object.prototype.toString.call(e))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeatureCollection","constructor","invalidFeatures"));this._features=e,this._bbox=i};return Object.defineProperties(i.prototype,{features:{get:function(){return this._features}},bbox:{get:function(){return this._bbox}}}),i}),i("../src/worldwind/shapes/PlacemarkAttributes",["../util/Color","../util/Font","../util/Offset","../shapes/ShapeAttributes","../shapes/TextAttributes"],function(t,e,r,i,n){"use strict";var o=function(e){this._imageColor=e?e._imageColor:new t(1,1,1,1),this._imageOffset=e?e._imageOffset:new r(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),this._imageScale=e?e._imageScale:1,this._imageSource=e?e._imageSource:null,this._depthTest=e?e._depthTest:!0,this._labelAttributes=e?e._labelAttributes:new n(null),this._drawLeaderLine=e?e._drawLeaderLine:!1,this._leaderLineAttributes=e?e._leaderLineAttributes:new i(null),this.stateKeyInvalid=!0};return o.prototype.computeStateKey=function(){return"ic "+this._imageColor.toHexString(!0)+" io "+this._imageOffset.toString()+" is "+this._imageScale+" ip "+this._imageSource+" dt "+this._depthTest+" la "+this._labelAttributes.stateKey+" dll "+this._drawLeaderLine+" lla "+this._leaderLineAttributes.stateKey},Object.defineProperties(o.prototype,{stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}},imageColor:{get:function(){return this._imageColor},set:function(t){this._imageColor=t,this.stateKeyInvalid=!0}},imageOffset:{get:function(){return this._imageOffset},set:function(t){this._imageOffset=t,this.stateKeyInvalid=!0}},imageScale:{get:function(){return this._imageScale},set:function(t){this._imageScale=t,this.stateKeyInvalid=!0}},imageSource:{get:function(){return this._imageSource},set:function(t){this._imageSource=t,this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(t){this._depthTest=t,this.stateKeyInvalid=!0}},labelAttributes:{get:function(){return this._labelAttributes},set:function(t){this._labelAttributes=t,this.stateKeyInvalid=!0}},drawLeaderLine:{get:function(){return this._drawLeaderLine},set:function(t){this._drawLeaderLine=t,this.stateKeyInvalid=!0}},leaderLineAttributes:{get:function(){return this._leaderLineAttributes},set:function(t){this._leaderLineAttributes=t,this.stateKeyInvalid=!0}}}),o}),i("../src/worldwind/shapes/Placemark",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Logger","../geom/Matrix","../pick/PickedObject","../shapes/PlacemarkAttributes","../render/Renderable","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h){"use strict";var f=function(e,r,i){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"Placemark","constructor","missingPosition"));l.call(this),this.attributes=i?i:new s(null),this.highlightAttributes=null,this.highlighted=!1,this.position=e,this.eyeDistanceScaling=r,this.eyeDistanceScalingThreshold=1e6,this.eyeDistanceScalingLabelThreshold=1.5*this.eyeDistanceScalingThreshold,this.label=null,this.altitudeMode=WorldWind.ABSOLUTE,this.alwaysOnTop=!1,this.enableLeaderLinePicking=!1,this.updateImage=!0,this.declutterGroup=2,this.targetVisibility=1,this.currentVisibility=1,this.imageRotation=0,this.imageTilt=0,this.imageRotationReference=WorldWind.RELATIVE_TO_SCREEN,this.imageTiltReference=WorldWind.RELATIVE_TO_SCREEN,this.activeAttributes=null,this.activeTexture=null,this.labelTexture=null,this.placePoint=new c(0,0,0),this.groundPoint=new c(0,0,0),this.imageTransform=o.fromIdentity(),this.labelTransform=o.fromIdentity(),this.texCoordMatrix=o.fromIdentity(),this.imageBounds=null,this.layer=null,this.depthOffset=-.003};return f.screenPoint=new c(0,0,0),f.matrix=o.fromIdentity(),f.scratchPoint=new c(0,0,0),f.prototype=Object.create(l.prototype),Object.defineProperties(f.prototype,{screenBounds:{get:function(){return this.labelBounds}}}),f.prototype.copy=function(t){return this.position=t.position,this.attributes=t.attributes,this.highlightAttributes=t.highlightAttributes,this.highlighted=t.highlighted,this.enabled=t.enabled,this.label=t.label,this.altitudeMode=t.altitudeMode,this.pickDelegate=t.pickDelegate,this.alwaysOnTop=t.alwaysOnTop,this.depthOffset=t.depthOffset,this.targetVisibility=t.targetVisibility,this.currentVisibility=t.currentVisibility,this.imageRotation=t.imageRotation,this.imageTilt=t.imageTilt,this.imageRotationReference=t.imageRotationReference,this.imageTiltReference=t.imageTiltReference,this},f.prototype.clone=function(){var t=new f(this.position);return t.copy(this),t.pickDelegate=this.pickDelegate?this.pickDelegate:this,t},f.prototype.render=function(t){if(this.enabled&&t.accumulateOrderedRenderables&&(!t.globe.projectionLimits||t.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude))){var e;if(this.lastFrameTime!==t.timestamp)e=this.makeOrderedRenderable(t);else{var r=this.clone();e=r.makeOrderedRenderable(t)}e&&e.isVisible(t)&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e))}},f.prototype.renderOrdered=function(t){if(this.drawOrderedPlacemark(t),t.pickingMode){var e=new a(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,this.position,this.layer,!1);t.pickPoint&&this.mustDrawLabel()&&this.labelBounds.containsPoint(t.navigatorState.convertPointToViewport(t.pickPoint,f.scratchPoint))&&(e.labelPicked=!0),t.resolvePick(e)}},f.prototype.makeOrderedRenderable=function(t){var e,r,i,n;if(this.determineActiveAttributes(t),!this.activeAttributes)return null;if(t.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint),this.eyeDistance=this.alwaysOnTop?0:t.navigatorState.eyePoint.distanceTo(this.placePoint),this.mustDrawLeaderLine(t)&&t.surfacePointForMode(this.position.latitude,this.position.longitude,0,this.altitudeMode,this.groundPoint),!t.navigatorState.projectWithDepth(this.placePoint,this.depthOffset,f.screenPoint))return null;var o=this.eyeDistanceScaling?Math.max(0,Math.min(1,this.eyeDistanceScalingThreshold/this.eyeDistance)):1;if(this.activeTexture?(e=this.activeTexture.originalImageWidth,r=this.activeTexture.originalImageHeight,i=this.activeAttributes.imageScale*o,n=this.activeAttributes.imageOffset.offsetForSize(e,r),this.imageTransform.setTranslation(f.screenPoint[0]-n[0]*i,f.screenPoint[1]-n[1]*i,f.screenPoint[2]),this.imageTransform.setScale(e*i,r*i,1)):(i=this.activeAttributes.imageScale*o,n=this.activeAttributes.imageOffset.offsetForSize(i,i),this.imageTransform.setTranslation(f.screenPoint[0]-n[0],f.screenPoint[1]-n[1],f.screenPoint[2]),this.imageTransform.setScale(i,i,1)),this.imageBounds=h.boundingRectForUnitQuad(this.imageTransform),this.mustDrawLabel()){var a=this.activeAttributes.labelAttributes.font,s=this.label+a.toString();this.labelTexture=t.gpuResourceCache.resourceForKey(s),this.labelTexture||(this.labelTexture=t.textSupport.createTexture(t,this.label,a,!0),t.gpuResourceCache.putResource(s,this.labelTexture,this.labelTexture.size)),e=this.labelTexture.imageWidth,r=this.labelTexture.imageHeight,i=this.activeAttributes.labelAttributes.scale*o,n=this.activeAttributes.labelAttributes.offset.offsetForSize(e,r),this.labelTransform.setTranslation(f.screenPoint[0]-n[0]*i,f.screenPoint[1]-n[1]*i,f.screenPoint[2]),this.labelTransform.setScale(e*i,r*i,1),this.labelBounds=h.boundingRectForUnitQuad(this.labelTransform)}return this},f.prototype.determineActiveAttributes=function(t){this.highlighted&&this.highlightAttributes?this.activeAttributes=this.highlightAttributes:this.activeAttributes=this.attributes,this.activeAttributes&&this.activeAttributes.imageSource&&(this.activeTexture=t.gpuResourceCache.resourceForKey(this.activeAttributes.imageSource),(!this.activeTexture||this.updateImage)&&(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.activeAttributes.imageSource),this.updateImage=!1))},f.prototype.isVisible=function(t){return t.pickingMode?t.pickRectangle&&(this.imageBounds.intersects(t.pickRectangle)||this.mustDrawLabel()&&this.labelBounds.intersects(t.pickRectangle)||this.mustDrawLeaderLine(t)&&t.pickFrustum.intersectsSegment(this.groundPoint,this.placePoint)):this.imageBounds.intersects(t.navigatorState.viewport)||this.mustDrawLabel()&&this.labelBounds.intersects(t.navigatorState.viewport)||this.mustDrawLeaderLine(t)&&t.navigatorState.frustumInModelCoordinates.intersectsSegment(this.groundPoint,this.placePoint)},f.prototype.drawOrderedPlacemark=function(t){this.beginDrawing(t);try{this.doDrawOrderedPlacemark(t),t.pickingMode||this.drawBatchOrderedPlacemarks(t)}finally{this.endDrawing(t)}},f.prototype.drawBatchOrderedPlacemarks=function(t){for(var e;(e=t.peekOrderedRenderable())&&e.doDrawOrderedPlacemark;){t.popOrderedRenderable();try{e.doDrawOrderedPlacemark(t)}catch(r){n.logMessage(n.LEVEL_WARNING,"Placemark","drawBatchOrderedPlacemarks","Error occurred while rendering placemark using batching: "+r.message)}}},f.prototype.beginDrawing=function(t){var r,i=t.currentGlContext;t.findAndBindProgram(e),r=t.currentProgram,i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer()),i.vertexAttribPointer(r.vertexTexCoordLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.vertexPointLocation),i.enableVertexAttribArray(r.vertexTexCoordLocation),r.loadTextureUnit(i,i.TEXTURE0),r.loadModulateColor(i,t.pickingMode)},f.prototype.endDrawing=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null)},f.prototype.doDrawOrderedPlacemark=function(t){var e,r=t.currentGlContext,i=t.currentProgram,n=!0;if(t.pickingMode&&(this.pickColor=t.uniquePickColor()),this.eyeDistanceScaling&&this.eyeDistance>this.eyeDistanceScalingLabelThreshold&&(this.targetVisibility=0),!t.pickingMode&&this.mustDrawLabel()&&this.currentVisibility!=this.targetVisibility){var o=(t.timestamp-t.previousRedrawTimestamp)/t.fadeTime;this.currentVisibility<this.targetVisibility?this.currentVisibility=Math.min(1,this.currentVisibility+o):this.currentVisibility=Math.max(0,this.currentVisibility-o),t.redrawRequested=!0}if(i.loadOpacity(r,t.pickingMode?1:this.layer.opacity),this.mustDrawLeaderLine(t)){this.leaderLinePoints||(this.leaderLinePoints=new Float32Array(6)),this.leaderLinePoints[0]=this.groundPoint[0],this.leaderLinePoints[1]=this.groundPoint[1],this.leaderLinePoints[2]=this.groundPoint[2],this.leaderLinePoints[3]=this.placePoint[0],this.leaderLinePoints[4]=this.placePoint[1],this.leaderLinePoints[5]=this.placePoint[2],this.leaderLineCacheKey||(this.leaderLineCacheKey=t.gpuResourceCache.generateCacheKey());var a=t.gpuResourceCache.resourceForKey(this.leaderLineCacheKey);a||(a=r.createBuffer(),t.gpuResourceCache.putResource(this.leaderLineCacheKey,a,4*this.leaderLinePoints.length)),i.loadTextureEnabled(r,!1),i.loadColor(r,t.pickingMode?this.pickColor:this.activeAttributes.leaderLineAttributes.outlineColor),f.matrix.copy(t.navigatorState.modelviewProjection),i.loadModelviewProjection(r,f.matrix),this.activeAttributes.leaderLineAttributes.depthTest||r.disable(r.DEPTH_TEST),r.lineWidth(this.activeAttributes.leaderLineAttributes.outlineWidth),r.bindBuffer(r.ARRAY_BUFFER,a),r.bufferData(r.ARRAY_BUFFER,this.leaderLinePoints,r.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),r.vertexAttribPointer(i.vertexPointLocation,3,r.FLOAT,!1,0,0),r.drawArrays(r.LINES,0,2)}this.activeAttributes.depthTest||(n=!1,r.disable(r.DEPTH_TEST)),r.bindBuffer(r.ARRAY_BUFFER,t.unitQuadBuffer3()),r.vertexAttribPointer(i.vertexPointLocation,3,r.FLOAT,!1,0,0),f.matrix.copy(t.screenProjection),f.matrix.multiplyMatrix(this.imageTransform);var s=this.imageRotationReference===WorldWind.RELATIVE_TO_GLOBE?t.navigatorState.heading-this.imageRotation:-this.imageRotation;f.matrix.multiplyByTranslation(.5,.5,0),f.matrix.multiplyByRotation(0,0,1,s),f.matrix.multiplyByTranslation(-.5,-.5,0);var l=this.imageTiltReference===WorldWind.RELATIVE_TO_GLOBE?t.navigatorState.tilt+this.imageTilt:this.imageTilt;f.matrix.multiplyByRotation(-1,0,0,l),i.loadModelviewProjection(r,f.matrix),i.loadTextureEnabled(r,!0),t.pickingMode?i.loadColor(r,this.pickColor):i.loadColor(r,this.activeAttributes.imageColor),this.texCoordMatrix.setToIdentity(),this.activeTexture&&this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture),i.loadTextureMatrix(r,this.texCoordMatrix),this.activeTexture?(e=this.activeTexture.bind(t),i.loadTextureEnabled(r,e)):i.loadTextureEnabled(r,!1),r.drawArrays(r.TRIANGLE_STRIP,0,4),this.mustDrawLabel()&&this.currentVisibility>0&&(i.loadOpacity(r,t.pickingMode?1:this.layer.opacity*this.currentVisibility),f.matrix.copy(t.screenProjection),f.matrix.multiplyMatrix(this.labelTransform),i.loadModelviewProjection(r,f.matrix),!t.pickingMode&&this.labelTexture?(this.texCoordMatrix.setToIdentity(),this.texCoordMatrix.multiplyByTextureTransform(this.labelTexture),i.loadTextureMatrix(r,this.texCoordMatrix),i.loadColor(r,this.activeAttributes.labelAttributes.color),e=this.labelTexture.bind(t),i.loadTextureEnabled(r,e)):(i.loadTextureEnabled(r,!1),i.loadColor(r,this.pickColor)),this.activeAttributes.labelAttributes.depthTest?n||(n=!0,r.enable(r.DEPTH_TEST)):(n=!1,r.disable(r.DEPTH_TEST)),r.drawArrays(r.TRIANGLE_STRIP,0,4)),n||r.enable(r.DEPTH_TEST)},f.prototype.mustDrawLabel=function(){return this.label&&this.label.length>0&&this.activeAttributes.labelAttributes},f.prototype.mustDrawLeaderLine=function(t){return this.activeAttributes.drawLeaderLine&&this.activeAttributes.leaderLineAttributes&&(!t.pickingMode||this.enableLeaderLinePicking)},f});var a={};a.DEBUG=!1,a.assert=function(t,e){if(a.DEBUG&&!t)throw new Error("Assertion failed"+(e?": "+e:""))},a.GLU_TESS_MAX_COORD=1e150,a.TRUE_PROJECT=!1,a.TESS_MAX_CACHE=100,a.GLU_TESS_DEFAULT_TOLERANCE=0,a.windingRule={GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},a.primitiveType={GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},a.errorType={GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},a.gluEnum={GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},a.PQHandle,a.PQKey,a.geom={},a.geom.vertEq=function(t,e){return t.s===e.s&&t.t===e.t},a.geom.vertLeq=function(t,e){return t.s<e.s||t.s===e.s&&t.t<=e.t},a.geom.edgeEval=function(t,e,r){var i=e.s-t.s,n=r.s-e.s;return i+n>0?n>i?e.t-t.t+(t.t-r.t)*(i/(i+n)):e.t-r.t+(r.t-t.t)*(n/(i+n)):0},a.geom.edgeSign=function(t,e,r){var i=e.s-t.s,n=r.s-e.s;return i+n>0?(e.t-r.t)*i+(e.t-t.t)*n:0},a.geom.transLeq=function(t,e){return t.t<e.t||t.t===e.t&&t.s<=e.s},a.geom.transEval=function(t,e,r){var i=e.t-t.t,n=r.t-e.t;return i+n>0?n>i?e.s-t.s+(t.s-r.s)*(i/(i+n)):e.s-r.s+(r.s-t.s)*(n/(i+n)):0},a.geom.transSign=function(t,e,r){var i=e.t-t.t,n=r.t-e.t;return i+n>0?(e.s-r.s)*i+(e.s-t.s)*n:0},a.geom.edgeGoesLeft=function(t){return a.geom.vertLeq(t.dst(),t.org)},a.geom.edgeGoesRight=function(t){return a.geom.vertLeq(t.org,t.dst())},a.geom.vertL1dist=function(t,e){return Math.abs(t.s-e.s)+Math.abs(t.t-e.t)},a.geom.vertCCW=function(t,e,r){return t.s*(e.t-r.t)+e.s*(r.t-t.t)+r.s*(t.t-e.t)>=0},a.geom.interpolate_=function(t,e,r,i){return t=0>t?0:t,r=0>r?0:r,r>=t?0===r?(e+i)/2:e+(i-e)*(t/(t+r)):i+(e-i)*(r/(t+r))},a.geom.edgeIntersect=function(t,e,r,i,n){var o,s,l;a.geom.vertLeq(t,e)||(l=t,t=e,e=l),a.geom.vertLeq(r,i)||(l=r,r=i,i=l),a.geom.vertLeq(t,r)||(l=t,t=r,r=l,l=e,e=i,i=l),a.geom.vertLeq(r,e)?a.geom.vertLeq(e,i)?(o=a.geom.edgeEval(t,r,e),s=a.geom.edgeEval(r,e,i),0>o+s&&(o=-o,s=-s),n.s=a.geom.interpolate_(o,r.s,s,e.s)):(o=a.geom.edgeSign(t,r,e),s=-a.geom.edgeSign(t,i,e),0>o+s&&(o=-o,s=-s),n.s=a.geom.interpolate_(o,r.s,s,i.s)):n.s=(r.s+e.s)/2,a.geom.transLeq(t,e)||(l=t,t=e,e=l),a.geom.transLeq(r,i)||(l=r,r=i,i=l),a.geom.transLeq(t,r)||(l=t,t=r,r=l,l=e,e=i,i=l),a.geom.transLeq(r,e)?a.geom.transLeq(e,i)?(o=a.geom.transEval(t,r,e),s=a.geom.transEval(r,e,i),0>o+s&&(o=-o,s=-s),n.t=a.geom.interpolate_(o,r.t,s,e.t)):(o=a.geom.transSign(t,r,e),s=-a.geom.transSign(t,i,e),0>o+s&&(o=-o,s=-s),n.t=a.geom.interpolate_(o,r.t,s,i.t)):n.t=(r.t+e.t)/2},a.mesh={},a.mesh.makeEdge=function(t){var e=a.mesh.makeEdgePair_(t.eHead);return a.mesh.makeVertex_(e,t.vHead),a.mesh.makeVertex_(e.sym,t.vHead),a.mesh.makeFace_(e,t.fHead),e},a.mesh.meshSplice=function(t,e){var r=!1,i=!1;t!==e&&(e.org!==t.org&&(i=!0,a.mesh.killVertex_(e.org,t.org)),e.lFace!==t.lFace&&(r=!0,a.mesh.killFace_(e.lFace,t.lFace)),a.mesh.splice_(e,t),i||(a.mesh.makeVertex_(e,t.org),t.org.anEdge=t),r||(a.mesh.makeFace_(e,t.lFace),t.lFace.anEdge=t))},a.mesh.deleteEdge=function(t){var e=t.sym,r=!1;t.lFace!==t.rFace()&&(r=!0,a.mesh.killFace_(t.lFace,t.rFace())),t.oNext===t?a.mesh.killVertex_(t.org,null):(t.rFace().anEdge=t.oPrev(),t.org.anEdge=t.oNext,a.mesh.splice_(t,t.oPrev()),r||a.mesh.makeFace_(t,t.lFace)),e.oNext===e?(a.mesh.killVertex_(e.org,null),a.mesh.killFace_(e.lFace,null)):(t.lFace.anEdge=e.oPrev(),e.org.anEdge=e.oNext,a.mesh.splice_(e,e.oPrev())),a.mesh.killEdge_(t)},a.mesh.addEdgeVertex=function(t){var e=a.mesh.makeEdgePair_(t),r=e.sym;return a.mesh.splice_(e,t.lNext),e.org=t.dst(),a.mesh.makeVertex_(r,e.org),e.lFace=r.lFace=t.lFace,e},a.mesh.splitEdge=function(t){var e=a.mesh.addEdgeVertex(t),r=e.sym;return a.mesh.splice_(t.sym,t.sym.oPrev()),a.mesh.splice_(t.sym,r),t.sym.org=r.org,r.dst().anEdge=r.sym,r.sym.lFace=t.rFace(),r.winding=t.winding,r.sym.winding=t.sym.winding,r},a.mesh.connect=function(t,e){var r=!1,i=a.mesh.makeEdgePair_(t),n=i.sym;return e.lFace!==t.lFace&&(r=!0,a.mesh.killFace_(e.lFace,t.lFace)),a.mesh.splice_(i,t.lNext),a.mesh.splice_(n,e),i.org=t.dst(),n.org=e.org,i.lFace=n.lFace=t.lFace,t.lFace.anEdge=n,r||a.mesh.makeFace_(i,t.lFace),i},a.mesh.zapFace=function(t){var e,r=t.anEdge,i=r.lNext;do if(e=i,i=e.lNext,e.lFace=null,null===e.rFace()){e.oNext===e?a.mesh.killVertex_(e.org,null):(e.org.anEdge=e.oNext,a.mesh.splice_(e,e.oPrev()));var n=e.sym;n.oNext===n?a.mesh.killVertex_(n.org,null):(n.org.anEdge=n.oNext,a.mesh.splice_(n,n.oPrev())),a.mesh.killEdge_(e)}while(e!==r);var o=t.prev,s=t.next;s.prev=o,o.next=s},a.mesh.meshUnion=function(t,e){var r=t.fHead,i=t.vHead,n=t.eHead,o=e.fHead,a=e.vHead,s=e.eHead;return o.next!==o&&(r.prev.next=o.next,o.next.prev=r.prev,o.prev.next=r,r.prev=o.prev),a.next!==a&&(i.prev.next=a.next,a.next.prev=i.prev,a.prev.next=i,i.prev=a.prev),s.next!==s&&(n.sym.next.sym.next=s.next,s.next.sym.next=n.sym.next,s.sym.next.sym.next=n,n.sym.next=s.sym.next),t},a.mesh.deleteMesh=function(t){},a.mesh.makeEdgePair_=function(t){var e=new a.GluHalfEdge,r=new a.GluHalfEdge,i=t.sym.next;return r.next=i,i.sym.next=e,e.next=t,t.sym.next=r,e.sym=r,e.oNext=e,e.lNext=r,r.sym=e,r.oNext=r,r.lNext=e,e},a.mesh.splice_=function(t,e){var r=t.oNext,i=e.oNext;r.sym.lNext=e,i.sym.lNext=t,t.oNext=i,e.oNext=r},a.mesh.makeVertex_=function(t,e){var r=e.prev,i=new a.GluVertex(e,r);r.next=i,e.prev=i,i.anEdge=t;var n=t;do n.org=i,n=n.oNext;while(n!==t)},a.mesh.makeFace_=function(t,e){var r=e.prev,i=new a.GluFace(e,r);r.next=i,e.prev=i,i.anEdge=t,i.inside=e.inside;var n=t;do n.lFace=i,n=n.lNext;while(n!==t)},a.mesh.killEdge_=function(t){var e=t.next,r=t.sym.next;e.sym.next=r,r.sym.next=e},a.mesh.killVertex_=function(t,e){var r=t.anEdge,i=r;do i.org=e,i=i.oNext;while(i!==r);var n=t.prev,o=t.next;o.prev=n,n.next=o},a.mesh.killFace_=function(t,e){var r=t.anEdge,i=r;do i.lFace=e,i=i.lNext;while(i!==r);var n=t.prev,o=t.next;o.prev=n,n.next=o},a.normal={},a.normal.S_UNIT_X_=1,a.normal.S_UNIT_Y_=0,a.normal.projectPolygon=function(t){var e=!1,r=[t.normal[0],t.normal[1],t.normal[2]];0===r[0]&&0===r[1]&&0===r[2]&&(a.normal.computeNormal_(t,r),e=!0);var i=t.sUnit,n=t.tUnit,o=a.normal.longAxis_(r);if(a.TRUE_PROJECT){a.normal.normalize_(r),i[o]=0,i[(o+1)%3]=a.normal.S_UNIT_X_,i[(o+2)%3]=a.normal.S_UNIT_Y_;var s=a.normal.dot_(i,r);i[0]-=s*r[0],i[1]-=s*r[1],i[2]-=s*r[2],a.normal.normalize_(i),n[0]=r[1]*i[2]-r[2]*i[1],n[1]=r[2]*i[0]-r[0]*i[2],n[2]=r[0]*i[1]-r[1]*i[0],a.normal.normalize_(n)}else i[o]=0,i[(o+1)%3]=a.normal.S_UNIT_X_,i[(o+2)%3]=a.normal.S_UNIT_Y_,n[o]=0,n[(o+1)%3]=r[o]>0?-a.normal.S_UNIT_Y_:a.normal.S_UNIT_Y_,n[(o+2)%3]=r[o]>0?a.normal.S_UNIT_X_:-a.normal.S_UNIT_X_;for(var l=t.mesh.vHead,u=l.next;u!==l;u=u.next)u.s=a.normal.dot_(u.coords,i),u.t=a.normal.dot_(u.coords,n);e&&a.normal.checkOrientation_(t)},a.normal.dot_=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.normal.normalize_=function(t){var e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];e=Math.sqrt(e),t[0]/=e,t[1]/=e,t[2]/=e},a.normal.longAxis_=function(t){var e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e},a.normal.computeNormal_=function(t,e){var r,i=[-2*a.GLU_TESS_MAX_COORD,-2*a.GLU_TESS_MAX_COORD,-2*a.GLU_TESS_MAX_COORD],n=[2*a.GLU_TESS_MAX_COORD,2*a.GLU_TESS_MAX_COORD,2*a.GLU_TESS_MAX_COORD],o=[],s=[],l=t.mesh.vHead;for(r=l.next;r!==l;r=r.next)for(var u=0;3>u;++u){var c=r.coords[u];c<n[u]&&(n[u]=c,s[u]=r),c>i[u]&&(i[u]=c,o[u]=r)}var h=0;if(i[1]-n[1]>i[0]-n[0]&&(h=1),i[2]-n[2]>i[h]-n[h]&&(h=2),n[h]>=i[h])return e[0]=0,e[1]=0,void(e[2]=1);var f=0,d=s[h],p=o[h],m=[0,0,0],g=[d.coords[0]-p.coords[0],d.coords[1]-p.coords[1],d.coords[2]-p.coords[2]],y=[0,0,0];for(r=l.next;r!==l;r=r.next){y[0]=r.coords[0]-p.coords[0],y[1]=r.coords[1]-p.coords[1],y[2]=r.coords[2]-p.coords[2],m[0]=g[1]*y[2]-g[2]*y[1],m[1]=g[2]*y[0]-g[0]*y[2],m[2]=g[0]*y[1]-g[1]*y[0];var v=m[0]*m[0]+m[1]*m[1]+m[2]*m[2];v>f&&(f=v,e[0]=m[0],e[1]=m[1],e[2]=m[2])}0>=f&&(e[0]=e[1]=e[2]=0,e[a.normal.longAxis_(g)]=1)},a.normal.checkOrientation_=function(t){for(var e=0,r=t.mesh.fHead,i=r.next;i!==r;i=i.next){var n=i.anEdge;if(!(n.winding<=0))do e+=(n.org.s-n.dst().s)*(n.org.t+n.dst().t),n=n.lNext;while(n!==i.anEdge)}if(0>e){for(var o=t.mesh.vHead,a=o.next;a!==o;a=a.next)a.t=-a.t;t.tUnit[0]=-t.tUnit[0],t.tUnit[1]=-t.tUnit[1],t.tUnit[2]=-t.tUnit[2]}},a.render={},a.render.renderMesh=function(t,e,r){for(var i=!1,n=-1,o=e.fHead.prev;o!==e.fHead;o=o.prev)if(o.inside){i||(t.callBeginOrBeginData(a.primitiveType.GL_TRIANGLES),i=!0);var s=o.anEdge;do{if(r){var l=s.rFace().inside?0:1;n!==l&&(n=l,t.callEdgeFlagOrEdgeFlagData(!!n))}t.callVertexOrVertexData(s.org.data),s=s.lNext}while(s!==o.anEdge)}i&&t.callEndOrEndData()},a.render.renderBoundary=function(t,e){for(var r=e.fHead.next;r!==e.fHead;r=r.next)if(r.inside){t.callBeginOrBeginData(a.primitiveType.GL_LINE_LOOP);var i=r.anEdge;do t.callVertexOrVertexData(i.org.data),i=i.lNext;while(i!==r.anEdge);t.callEndOrEndData()}},a.sweep={},a.sweep.SENTINEL_COORD_=4*a.GLU_TESS_MAX_COORD,a.sweep.TOLERANCE_NONZERO_=!1,a.sweep.computeInterior=function(t){t.fatalError=!1,a.sweep.removeDegenerateEdges_(t),a.sweep.initPriorityQ_(t),a.sweep.initEdgeDict_(t);for(var e;null!==(e=t.pq.extractMin());){for(;;){var r=t.pq.minimum();if(null===r||!a.geom.vertEq(r,e))break;r=t.pq.extractMin(),a.sweep.spliceMergeVertices_(t,e.anEdge,r.anEdge)}a.sweep.sweepEvent_(t,e)}var i=t.dict.getMin().getKey();t.event=i.eUp.org,a.sweep.doneEdgeDict_(t),a.sweep.donePriorityQ_(t),a.sweep.removeDegenerateFaces_(t.mesh),t.mesh.checkMesh()},a.sweep.addWinding_=function(t,e){t.winding+=e.winding,t.sym.winding+=e.sym.winding},a.sweep.edgeLeq_=function(t,e,r){var i=t.event,n=e.eUp,o=r.eUp;if(n.dst()===i)return o.dst()===i?a.geom.vertLeq(n.org,o.org)?a.geom.edgeSign(o.dst(),n.org,o.org)<=0:a.geom.edgeSign(n.dst(),o.org,n.org)>=0:a.geom.edgeSign(o.dst(),i,o.org)<=0;if(o.dst()===i)return a.geom.edgeSign(n.dst(),i,n.org)>=0;var s=a.geom.edgeEval(n.dst(),i,n.org),l=a.geom.edgeEval(o.dst(),i,o.org);return s>=l},a.sweep.deleteRegion_=function(t,e){e.fixUpperEdge,e.eUp.activeRegion=null,t.dict.deleteNode(e.nodeUp),e.nodeUp=null},a.sweep.fixUpperEdge_=function(t,e){a.mesh.deleteEdge(t.eUp),t.fixUpperEdge=!1,t.eUp=e,e.activeRegion=t},a.sweep.topLeftRegion_=function(t){var e=t.eUp.org;do t=t.regionAbove();while(t.eUp.org===e);if(t.fixUpperEdge){var r=a.mesh.connect(t.regionBelow().eUp.sym,t.eUp.lNext);a.sweep.fixUpperEdge_(t,r),t=t.regionAbove()}return t},a.sweep.topRightRegion_=function(t){var e=t.eUp.dst();do t=t.regionAbove();while(t.eUp.dst()===e);return t},a.sweep.addRegionBelow_=function(t,e,r){var i=new a.ActiveRegion;return i.eUp=r,i.nodeUp=t.dict.insertBefore(e.nodeUp,i),r.activeRegion=i,i},a.sweep.isWindingInside_=function(t,e){switch(t.windingRule){case a.windingRule.GLU_TESS_WINDING_ODD:return 0!==(1&e);case a.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==e;case a.windingRule.GLU_TESS_WINDING_POSITIVE:return e>0;case a.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>e;case a.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return e>=2||-2>=e}return!1},a.sweep.computeWinding_=function(t,e){e.windingNumber=e.regionAbove().windingNumber+e.eUp.winding,e.inside=a.sweep.isWindingInside_(t,e.windingNumber)},a.sweep.finishRegion_=function(t,e){var r=e.eUp,i=r.lFace;i.inside=e.inside,i.anEdge=r,a.sweep.deleteRegion_(t,e)},a.sweep.finishLeftRegions_=function(t,e,r){for(var i=e,n=e.eUp;i!==r;){i.fixUpperEdge=!1;var o=i.regionBelow(),s=o.eUp;if(s.org!==n.org){if(!o.fixUpperEdge){a.sweep.finishRegion_(t,i);break}s=a.mesh.connect(n.lPrev(),s.sym),a.sweep.fixUpperEdge_(o,s)}n.oNext!==s&&(a.mesh.meshSplice(s.oPrev(),s),a.mesh.meshSplice(n,s)),a.sweep.finishRegion_(t,i),n=o.eUp,i=o}return n},a.sweep.addRightEdges_=function(t,e,r,i,n,o){var s=!0,l=r;do a.sweep.addRegionBelow_(t,e,l.sym),l=l.oNext;while(l!==i);null===n&&(n=e.regionBelow().eUp.rPrev());for(var u,c=e,h=n;u=c.regionBelow(),l=u.eUp.sym,l.org===h.org;)l.oNext!==h&&(a.mesh.meshSplice(l.oPrev(),l),a.mesh.meshSplice(h.oPrev(),l)),u.windingNumber=c.windingNumber-l.winding,u.inside=a.sweep.isWindingInside_(t,u.windingNumber),c.dirty=!0,!s&&a.sweep.checkForRightSplice_(t,c)&&(a.sweep.addWinding_(l,h),a.sweep.deleteRegion_(t,c),a.mesh.deleteEdge(h)),s=!1,c=u,h=l;c.dirty=!0,o&&a.sweep.walkDirtyRegions_(t,c)},a.sweep.callCombine_=function(t,e,r,i,n){var o=[e.coords[0],e.coords[1],e.coords[2]];e.data=null,e.data=t.callCombineOrCombineData(o,r,i),null===e.data&&(n?t.fatalError||(t.callErrorOrErrorData(a.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),t.fatalError=!0):e.data=r[0])},a.sweep.spliceMergeVertices_=function(t,e,r){var i=[null,null,null,null],n=[.5,.5,0,0];i[0]=e.org.data,i[1]=r.org.data,a.sweep.callCombine_(t,e.org,i,n,!1),a.mesh.meshSplice(e,r)},a.sweep.vertexWeights_=function(t,e,r,i,n){var o=a.geom.vertL1dist(e,t),s=a.geom.vertL1dist(r,t),l=n,u=n+1;i[l]=.5*s/(o+s),i[u]=.5*o/(o+s),t.coords[0]+=i[l]*e.coords[0]+i[u]*r.coords[0],t.coords[1]+=i[l]*e.coords[1]+i[u]*r.coords[1],t.coords[2]+=i[l]*e.coords[2]+i[u]*r.coords[2]},a.sweep.getIntersectData_=function(t,e,r,i,n,o){var s=[0,0,0,0],l=[r.data,i.data,n.data,o.data];e.coords[0]=e.coords[1]=e.coords[2]=0,a.sweep.vertexWeights_(e,r,i,s,0),a.sweep.vertexWeights_(e,n,o,s,2),a.sweep.callCombine_(t,e,l,s,!0)},a.sweep.checkForRightSplice_=function(t,e){var r=e.regionBelow(),i=e.eUp,n=r.eUp;if(a.geom.vertLeq(i.org,n.org)){if(a.geom.edgeSign(n.dst(),i.org,n.org)>0)return!1;a.geom.vertEq(i.org,n.org)?i.org!==n.org&&(t.pq.remove(i.org.pqHandle),a.sweep.spliceMergeVertices_(t,n.oPrev(),i)):(a.mesh.splitEdge(n.sym),a.mesh.meshSplice(i,n.oPrev()),e.dirty=r.dirty=!0)}else{if(a.geom.edgeSign(i.dst(),n.org,i.org)<0)return!1;e.regionAbove().dirty=e.dirty=!0,a.mesh.splitEdge(i.sym),a.mesh.meshSplice(n.oPrev(),i)}return!0},a.sweep.checkForLeftSplice_=function(t,e){var r,i=e.regionBelow(),n=e.eUp,o=i.eUp;if(a.geom.vertLeq(n.dst(),o.dst())){if(a.geom.edgeSign(n.dst(),o.dst(),n.org)<0)return!1;e.regionAbove().dirty=e.dirty=!0,r=a.mesh.splitEdge(n),a.mesh.meshSplice(o.sym,r),r.lFace.inside=e.inside}else{if(a.geom.edgeSign(o.dst(),n.dst(),o.org)>0)return!1;e.dirty=i.dirty=!0,r=a.mesh.splitEdge(o),a.mesh.meshSplice(n.lNext,o.sym),r.rFace().inside=e.inside}return!0},a.sweep.checkForIntersect_=function(t,e){var r=e.regionBelow(),i=e.eUp,n=r.eUp,o=i.org,s=n.org,l=i.dst(),u=n.dst(),c=new a.GluVertex;if(o===s)return!1;var h=Math.min(o.t,l.t),f=Math.max(s.t,u.t);if(h>f)return!1;if(a.geom.vertLeq(o,s)){if(a.geom.edgeSign(u,o,s)>0)return!1}else if(a.geom.edgeSign(l,s,o)<0)return!1;a.geom.edgeIntersect(l,o,u,s,c),a.geom.vertLeq(c,t.event)&&(c.s=t.event.s,c.t=t.event.t);var d=a.geom.vertLeq(o,s)?o:s;if(a.geom.vertLeq(d,c)&&(c.s=d.s,c.t=d.t),a.geom.vertEq(c,o)||a.geom.vertEq(c,s))return a.sweep.checkForRightSplice_(t,e),!1;if(!a.geom.vertEq(l,t.event)&&a.geom.edgeSign(l,t.event,c)>=0||!a.geom.vertEq(u,t.event)&&a.geom.edgeSign(u,t.event,c)<=0){if(u===t.event)return a.mesh.splitEdge(i.sym),a.mesh.meshSplice(n.sym,i),e=a.sweep.topLeftRegion_(e),i=e.regionBelow().eUp,a.sweep.finishLeftRegions_(t,e.regionBelow(),r),a.sweep.addRightEdges_(t,e,i.oPrev(),i,i,!0),!0;if(l===t.event){a.mesh.splitEdge(n.sym),a.mesh.meshSplice(i.lNext,n.oPrev()),r=e,e=a.sweep.topRightRegion_(e);var p=e.regionBelow().eUp.rPrev();return r.eUp=n.oPrev(),n=a.sweep.finishLeftRegions_(t,r,null),a.sweep.addRightEdges_(t,e,n.oNext,i.rPrev(),p,!0),!0}return a.geom.edgeSign(l,t.event,c)>=0&&(e.regionAbove().dirty=e.dirty=!0,a.mesh.splitEdge(i.sym),i.org.s=t.event.s,i.org.t=t.event.t),a.geom.edgeSign(u,t.event,c)<=0&&(e.dirty=r.dirty=!0,a.mesh.splitEdge(n.sym),n.org.s=t.event.s,n.org.t=t.event.t),!1}return a.mesh.splitEdge(i.sym),a.mesh.splitEdge(n.sym),a.mesh.meshSplice(n.oPrev(),i),i.org.s=c.s,i.org.t=c.t,i.org.pqHandle=t.pq.insert(i.org),a.sweep.getIntersectData_(t,i.org,o,l,s,u),e.regionAbove().dirty=e.dirty=r.dirty=!0,!1},a.sweep.walkDirtyRegions_=function(t,e){for(var r=e.regionBelow();;){for(;r.dirty;)e=r,r=r.regionBelow();if(!e.dirty&&(r=e,e=e.regionAbove(),null===e||!e.dirty))return;e.dirty=!1;var i=e.eUp,n=r.eUp;if(i.dst()!==n.dst()&&a.sweep.checkForLeftSplice_(t,e)&&(r.fixUpperEdge?(a.sweep.deleteRegion_(t,r),a.mesh.deleteEdge(n),r=e.regionBelow(),n=r.eUp):e.fixUpperEdge&&(a.sweep.deleteRegion_(t,e),a.mesh.deleteEdge(i),e=r.regionAbove(),i=e.eUp)),i.org!==n.org)if(i.dst()===n.dst()||e.fixUpperEdge||r.fixUpperEdge||i.dst()!==t.event&&n.dst()!==t.event)a.sweep.checkForRightSplice_(t,e);else if(a.sweep.checkForIntersect_(t,e))return;i.org===n.org&&i.dst()===n.dst()&&(a.sweep.addWinding_(n,i),a.sweep.deleteRegion_(t,e),a.mesh.deleteEdge(i),e=r.regionAbove())}},a.sweep.connectRightVertex_=function(t,e,r){var i=r.oNext,n=e.regionBelow(),o=e.eUp,s=n.eUp,l=!1;if(o.dst()!==s.dst()&&a.sweep.checkForIntersect_(t,e),a.geom.vertEq(o.org,t.event)&&(a.mesh.meshSplice(i.oPrev(),o),e=a.sweep.topLeftRegion_(e),i=e.regionBelow().eUp,a.sweep.finishLeftRegions_(t,e.regionBelow(),n),l=!0),a.geom.vertEq(s.org,t.event)&&(a.mesh.meshSplice(r,s.oPrev()),r=a.sweep.finishLeftRegions_(t,n,null),l=!0),l)return void a.sweep.addRightEdges_(t,e,r.oNext,i,i,!0);var u;u=a.geom.vertLeq(s.org,o.org)?s.oPrev():o,u=a.mesh.connect(r.lPrev(),u),a.sweep.addRightEdges_(t,e,u,u.oNext,u.oNext,!1),u.sym.activeRegion.fixUpperEdge=!0,a.sweep.walkDirtyRegions_(t,e)},a.sweep.connectLeftDegenerate_=function(t,e,r){
var i=e.eUp;if(a.geom.vertEq(i.org,r))return void(a.sweep.TOLERANCE_NONZERO_&&a.sweep.spliceMergeVertices_(t,i,r.anEdge));if(!a.geom.vertEq(i.dst(),r))return a.mesh.splitEdge(i.sym),e.fixUpperEdge&&(a.mesh.deleteEdge(i.oNext),e.fixUpperEdge=!1),a.mesh.meshSplice(r.anEdge,i),void a.sweep.sweepEvent_(t,r);if(a.sweep.TOLERANCE_NONZERO_){e=a.sweep.topRightRegion_(e);var n=e.regionBelow(),o=n.eUp.sym,s=o.oNext,l=s;n.fixUpperEdge&&(a.sweep.deleteRegion_(t,n),a.mesh.deleteEdge(o),o=s.oPrev()),a.mesh.meshSplice(r.anEdge,o),a.geom.edgeGoesLeft(s)||(s=null),a.sweep.addRightEdges_(t,e,o.oNext,l,s,!0)}},a.sweep.connectLeftVertex_=function(t,e){var r=new a.ActiveRegion;r.eUp=e.anEdge.sym;var i=t.dict.search(r).getKey(),n=i.regionBelow(),o=i.eUp,s=n.eUp;if(0===a.geom.edgeSign(o.dst(),e,o.org))return void a.sweep.connectLeftDegenerate_(t,i,e);var l,u=a.geom.vertLeq(s.dst(),o.dst())?i:n;if(i.inside||u.fixUpperEdge){if(u===i)l=a.mesh.connect(e.anEdge.sym,o.lNext);else{var c=a.mesh.connect(s.dNext(),e.anEdge);l=c.sym}u.fixUpperEdge?a.sweep.fixUpperEdge_(u,l):a.sweep.computeWinding_(t,a.sweep.addRegionBelow_(t,i,l)),a.sweep.sweepEvent_(t,e)}else a.sweep.addRightEdges_(t,i,e.anEdge,e.anEdge,null,!0)},a.sweep.sweepEvent_=function(t,e){t.event=e;for(var r=e.anEdge;null===r.activeRegion;)if(r=r.oNext,r===e.anEdge)return void a.sweep.connectLeftVertex_(t,e);var i=a.sweep.topLeftRegion_(r.activeRegion),n=i.regionBelow(),o=n.eUp,s=a.sweep.finishLeftRegions_(t,n,null);s.oNext===o?a.sweep.connectRightVertex_(t,i,s):a.sweep.addRightEdges_(t,i,s.oNext,o,o,!0)},a.sweep.addSentinel_=function(t,e){var r=new a.ActiveRegion,i=a.mesh.makeEdge(t.mesh);i.org.s=a.sweep.SENTINEL_COORD_,i.org.t=e,i.dst().s=-a.sweep.SENTINEL_COORD_,i.dst().t=e,t.event=i.dst(),r.eUp=i,r.windingNumber=0,r.inside=!1,r.fixUpperEdge=!1,r.sentinel=!0,r.dirty=!1,r.nodeUp=t.dict.insert(r)},a.sweep.initEdgeDict_=function(t){t.dict=new a.Dict(t,a.sweep.edgeLeq_),a.sweep.addSentinel_(t,-a.sweep.SENTINEL_COORD_),a.sweep.addSentinel_(t,a.sweep.SENTINEL_COORD_)},a.sweep.doneEdgeDict_=function(t){for(var e;null!==(e=t.dict.getMin().getKey());)!e.sentinel,a.sweep.deleteRegion_(t,e);t.dict=null},a.sweep.removeDegenerateEdges_=function(t){for(var e,r=t.mesh.eHead,i=r.next;i!==r;i=e){e=i.next;var n=i.lNext;a.geom.vertEq(i.org,i.dst())&&i.lNext.lNext!==i&&(a.sweep.spliceMergeVertices_(t,n,i),a.mesh.deleteEdge(i),i=n,n=i.lNext),n.lNext===i&&(n!==i&&((n===e||n===e.sym)&&(e=e.next),a.mesh.deleteEdge(n)),(i===e||i===e.sym)&&(e=e.next),a.mesh.deleteEdge(i))}},a.sweep.initPriorityQ_=function(t){var e=new a.PriorityQ(a.geom.vertLeq);t.pq=e;var r,i=t.mesh.vHead;for(r=i.next;r!==i;r=r.next)r.pqHandle=e.insert(r);e.init()},a.sweep.donePriorityQ_=function(t){t.pq.deleteQ(),t.pq=null},a.sweep.removeDegenerateFaces_=function(t){for(var e,r=t.fHead.next;r!==t.fHead;r=e){e=r.next;var i=r.anEdge;i.lNext.lNext===i&&(a.sweep.addWinding_(i.oNext,i),a.mesh.deleteEdge(i))}},a.tessmono={},a.tessmono.tessellateMonoRegion_=function(t){for(var e=t.anEdge;a.geom.vertLeq(e.dst(),e.org);e=e.lPrev());for(;a.geom.vertLeq(e.org,e.dst());e=e.lNext);for(var r,i=e.lPrev();e.lNext!==i;)if(a.geom.vertLeq(e.dst(),i.org)){for(;i.lNext!==e&&(a.geom.edgeGoesLeft(i.lNext)||a.geom.edgeSign(i.org,i.dst(),i.lNext.dst())<=0);)r=a.mesh.connect(i.lNext,i),i=r.sym;i=i.lPrev()}else{for(;i.lNext!==e&&(a.geom.edgeGoesRight(e.lPrev())||a.geom.edgeSign(e.dst(),e.org,e.lPrev().org)>=0);)r=a.mesh.connect(e,e.lPrev()),e=r.sym;e=e.lNext}for(;i.lNext.lNext!==e;)r=a.mesh.connect(i.lNext,i),i=r.sym},a.tessmono.tessellateInterior=function(t){for(var e,r=t.fHead.next;r!==t.fHead;r=e)e=r.next,r.inside&&a.tessmono.tessellateMonoRegion_(r)},a.tessmono.discardExterior=function(t){for(var e,r=t.fHead.next;r!==t.fHead;r=e)e=r.next,r.inside||a.mesh.zapFace(r)},a.tessmono.setWindingNumber=function(t,e,r){for(var i,n=t.eHead.next;n!==t.eHead;n=i)i=n.next,n.rFace().inside!==n.lFace.inside?n.winding=n.lFace.inside?e:-e:r?a.mesh.deleteEdge(n):n.winding=0},a.Dict=function(t,e){this.head_=new a.DictNode,this.frame_=t,this.leq_=e},a.Dict.prototype.deleteDict_=function(){},a.Dict.prototype.insertBefore=function(t,e){do t=t.prev;while(null!==t.key&&!this.leq_(this.frame_,t.key,e));var r=new a.DictNode(e,t.next,t);return t.next.prev=r,t.next=r,r},a.Dict.prototype.insert=function(t){return this.insertBefore(this.head_,t)},a.Dict.prototype.deleteNode=function(t){t.next.prev=t.prev,t.prev.next=t.next},a.Dict.prototype.search=function(t){var e=this.head_;do e=e.next;while(null!==e.key&&!this.leq_(this.frame_,t,e.key));return e},a.Dict.prototype.getMin=function(){return this.head_.next},a.Dict.prototype.getMax=function(){return this.head_.prev},a.DictNode=function(t,e,r){this.key=t||null,this.next=e||this,this.prev=r||this},a.DictNode.prototype.getKey=function(){return this.key},a.DictNode.prototype.getSuccessor=function(){return this.next},a.DictNode.prototype.getPredecessor=function(){return this.prev},a.CachedVertex=function(){this.coords=[0,0,0],this.data=null},a.GluTesselator=function(){this.state=a.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.callError_=null,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.relTolerance=a.GLU_TESS_DEFAULT_TOLERANCE,this.windingRule=a.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.callCombine_=null,this.boundaryOnly=!1,this.callBegin_=null,this.callEdgeFlag_=null,this.callVertex_=null,this.callEnd_=null,this.callMesh_=null,this.callBeginData_=null,this.callEdgeFlagData_=null,this.callVertexData_=null,this.callEndData_=null,this.callErrorData_=null,this.callCombineData_=null,this.polygonData_=null,this.emptyCache=!1,this.cacheCount=0,this.cache=new Array(a.TESS_MAX_CACHE);for(var t=0;t<a.TESS_MAX_CACHE;t++)this.cache[t]=new a.CachedVertex},a.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},a.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(a.GluTesselator.tessState_.T_DORMANT)},a.GluTesselator.prototype.gluTessProperty=function(t,e){switch(t){case a.gluEnum.GLU_TESS_TOLERANCE:if(0>e||e>1)break;return void(this.relTolerance=e);case a.gluEnum.GLU_TESS_WINDING_RULE:var r=e;switch(r){case a.windingRule.GLU_TESS_WINDING_ODD:case a.windingRule.GLU_TESS_WINDING_NONZERO:case a.windingRule.GLU_TESS_WINDING_POSITIVE:case a.windingRule.GLU_TESS_WINDING_NEGATIVE:case a.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=r)}break;case a.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly=!!e);default:return void this.callErrorOrErrorData(a.gluEnum.GLU_INVALID_ENUM)}this.callErrorOrErrorData(a.gluEnum.GLU_INVALID_VALUE)},a.GluTesselator.prototype.gluGetTessProperty=function(t){switch(t){case a.gluEnum.GLU_TESS_TOLERANCE:return this.relTolerance;case a.gluEnum.GLU_TESS_WINDING_RULE:var e=this.windingRule;return e;case a.gluEnum.GLU_TESS_BOUNDARY_ONLY:return this.boundaryOnly;default:this.callErrorOrErrorData(a.gluEnum.GLU_INVALID_ENUM)}return!1},a.GluTesselator.prototype.gluTessNormal=function(t,e,r){this.normal[0]=t,this.normal[1]=e,this.normal[2]=r},a.GluTesselator.prototype.gluTessCallback=function(t,e){var r=e?e:null;switch(t){case a.gluEnum.GLU_TESS_BEGIN:return void(this.callBegin_=r);case a.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.callBeginData_=r);case a.gluEnum.GLU_TESS_EDGE_FLAG:return void(this.callEdgeFlag_=r);case a.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.callEdgeFlagData_=r);case a.gluEnum.GLU_TESS_VERTEX:return void(this.callVertex_=r);case a.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.callVertexData_=r);case a.gluEnum.GLU_TESS_END:return void(this.callEnd_=r);case a.gluEnum.GLU_TESS_END_DATA:return void(this.callEndData_=r);case a.gluEnum.GLU_TESS_ERROR:return void(this.callError_=r);case a.gluEnum.GLU_TESS_ERROR_DATA:return void(this.callErrorData_=r);case a.gluEnum.GLU_TESS_COMBINE:return void(this.callCombine_=r);case a.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.callCombineData_=r);case a.gluEnum.GLU_TESS_MESH:return void(this.callMesh_=r);default:return void this.callErrorOrErrorData(a.gluEnum.GLU_INVALID_ENUM)}},a.GluTesselator.prototype.gluTessVertex=function(t,e){var r=!1,i=[0,0,0];this.requireState_(a.GluTesselator.tessState_.T_IN_CONTOUR),this.emptyCache&&(this.emptyCache_(),this.lastEdge_=null);for(var n=0;3>n;++n){var o=t[n];o<-a.GLU_TESS_MAX_COORD&&(o=-a.GLU_TESS_MAX_COORD,r=!0),o>a.GLU_TESS_MAX_COORD&&(o=a.GLU_TESS_MAX_COORD,r=!0),i[n]=o}if(r&&this.callErrorOrErrorData(a.errorType.GLU_TESS_COORD_TOO_LARGE),null===this.mesh){if(this.cacheCount<a.TESS_MAX_CACHE)return void this.cacheVertex_(i,e);this.emptyCache_()}this.addVertex_(i,e)},a.GluTesselator.prototype.gluTessBeginPolygon=function(t){this.requireState_(a.GluTesselator.tessState_.T_DORMANT),this.state=a.GluTesselator.tessState_.T_IN_POLYGON,this.cacheCount=0,this.emptyCache=!1,this.mesh=null,this.polygonData_=t},a.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(a.GluTesselator.tessState_.T_IN_POLYGON),this.state=a.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null,this.cacheCount>0&&(this.emptyCache=!0)},a.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(a.GluTesselator.tessState_.T_IN_CONTOUR),this.state=a.GluTesselator.tessState_.T_IN_POLYGON},a.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(a.GluTesselator.tessState_.T_IN_POLYGON),this.state=a.GluTesselator.tessState_.T_DORMANT,null===this.mesh&&this.emptyCache_(),a.normal.projectPolygon(this),a.sweep.computeInterior(this),!this.fatalError){var t=this.mesh;if(this.boundaryOnly?a.tessmono.setWindingNumber(t,1,!0):a.tessmono.tessellateInterior(t),this.mesh.checkMesh(),this.callBegin_||this.callEnd_||this.callVertex_||this.callEdgeFlag_||this.callBeginData_||this.callEndData_||this.callVertexData_||this.callEdgeFlagData_)if(this.boundaryOnly)a.render.renderBoundary(this,this.mesh);else{var e=!(!this.callEdgeFlag_&&!this.callEdgeFlagData_);a.render.renderMesh(this,this.mesh,e)}if(this.callMesh_)return a.tessmono.discardExterior(this.mesh),this.callMesh_(this.mesh),this.mesh=null,void(this.polygonData_=null)}a.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},a.GluTesselator.prototype.makeDormant_=function(){this.mesh&&a.mesh.deleteMesh(this.mesh),this.state=a.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null},a.GluTesselator.prototype.requireState_=function(t){this.state!==t&&this.gotoState_(t)},a.GluTesselator.prototype.gotoState_=function(t){for(;this.state!==t;)if(this.state<t)switch(this.state){case a.GluTesselator.tessState_.T_DORMANT:this.callErrorOrErrorData(a.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case a.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(a.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state){case a.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorOrErrorData(a.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case a.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(a.errorType.GLU_TESS_MISSING_END_POLYGON),this.makeDormant_()}},a.GluTesselator.prototype.addVertex_=function(t,e){var r=this.lastEdge_;null===r?(r=a.mesh.makeEdge(this.mesh),a.mesh.meshSplice(r,r.sym)):(a.mesh.splitEdge(r),r=r.lNext),r.org.data=e,r.org.coords[0]=t[0],r.org.coords[1]=t[1],r.org.coords[2]=t[2],r.winding=1,r.sym.winding=-1,this.lastEdge_=r},a.GluTesselator.prototype.cacheVertex_=function(t,e){var r=this.cache[this.cacheCount];r.data=e,r.coords[0]=t[0],r.coords[1]=t[1],r.coords[2]=t[2],++this.cacheCount},a.GluTesselator.prototype.emptyCache_=function(){this.mesh=new a.GluMesh;for(var t=0;t<this.cacheCount;t++){var e=this.cache[t];this.addVertex_(e.coords,e.data)}this.cacheCount=0,this.emptyCache=!1},a.GluTesselator.prototype.callBeginOrBeginData=function(t){this.callBeginData_?this.callBeginData_(t,this.polygonData_):this.callBegin_&&this.callBegin_(t)},a.GluTesselator.prototype.callVertexOrVertexData=function(t){this.callVertexData_?this.callVertexData_(t,this.polygonData_):this.callVertex_&&this.callVertex_(t)},a.GluTesselator.prototype.callEdgeFlagOrEdgeFlagData=function(t){this.callEdgeFlagData_?this.callEdgeFlagData_(t,this.polygonData_):this.callEdgeFlag_&&this.callEdgeFlag_(t)},a.GluTesselator.prototype.callEndOrEndData=function(){this.callEndData_?this.callEndData_(this.polygonData_):this.callEnd_&&this.callEnd_()},a.GluTesselator.prototype.callCombineOrCombineData=function(t,e,r){var i;return this.callCombineData_?i=this.callCombineData_(t,e,r,this.polygonData_):this.callCombine_&&(i=this.callCombine_(t,e,r)),void 0===i&&(i=null),i},a.GluTesselator.prototype.callErrorOrErrorData=function(t){this.callErrorData_?this.callErrorData_(t,this.polygonData_):this.callError_&&this.callError_(t)},a.GluFace=function(t,e){this.next=t||this,this.prev=e||this,this.anEdge=null,this.data=null,this.inside=!1},a.GluHalfEdge=function(t){this.next=t||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},a.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},a.GluHalfEdge.prototype.dst=function(){return this.sym.org},a.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},a.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},a.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},a.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},a.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},a.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},a.GluMesh=function(){this.vHead=new a.GluVertex,this.fHead=new a.GluFace,this.eHead=new a.GluHalfEdge,this.eHeadSym=new a.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},a.GluMesh.prototype.checkMesh=function(){if(a.DEBUG){var t,e,r=this.fHead,i=this.vHead,n=this.eHead,o=r;for(o=r;(e=o.next)!==r;o=e){t=e.anEdge;do t=t.lNext;while(t!==e.anEdge)}var s,l=i;for(l=i;(s=l.next)!==i;l=s){t=s.anEdge;do t=t.oNext;while(t!==s.anEdge)}var u=n;for(u=n;(t=u.next)!==n;u=t);}},a.GluVertex=function(t,e){this.next=t||this,this.prev=e||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=null},a.PQHandleElem=function(){this.key=null,this.node=0},a.PQHandleElem.realloc=function(t,e){var r=new Array(e),i=0;if(null!==t)for(;i<t.length;i++)r[i]=t[i];for(;e>i;i++)r[i]=new a.PQHandleElem;return r},a.PQNode=function(){this.handle=0},a.PQNode.realloc=function(t,e){var r=new Array(e),i=0;if(null!==t)for(;i<t.length;i++)r[i]=t[i];for(;e>i;i++)r[i]=new a.PQNode;return r},a.PriorityQ=function(t){this.keys_=a.PriorityQ.prototype.PQKeyRealloc_(null,a.PriorityQ.INIT_SIZE_),this.order_=null,this.size_=0,this.max_=a.PriorityQ.INIT_SIZE_,this.initialized_=!1,this.leq_=t,this.heap_=new a.PriorityQHeap(this.leq_)},a.PriorityQ.INIT_SIZE_=32,a.PriorityQ.prototype.deleteQ=function(){this.heap_.deleteHeap(),this.heap_=null,this.order_=null,this.keys_=null},a.PriorityQ.prototype.init=function(){this.order_=[];for(var t=0;t<this.size_;t++)this.order_[t]=t;var e=function(t,e){return function(r,i){return e(t[r],t[i])?1:-1}}(this.keys_,this.leq_);if(this.order_.sort(e),this.max_=this.size_,this.initialized_=!0,this.heap_.init(),a.DEBUG){var r=0,i=r+this.size_-1;for(t=r;i>t;++t);}},a.PriorityQ.prototype.insert=function(t){if(this.initialized_)return this.heap_.insert(t);var e=this.size_;return++this.size_>=this.max_&&(this.max_*=2,this.keys_=a.PriorityQ.prototype.PQKeyRealloc_(this.keys_,this.max_)),this.keys_[e]=t,-(e+1)},a.PriorityQ.prototype.PQKeyRealloc_=function(t,e){var r=new Array(e),i=0;if(null!==t)for(;i<t.length;i++)r[i]=t[i];for(;e>i;i++)r[i]=null;return r},a.PriorityQ.prototype.keyLessThan_=function(t,e){var r=this.keys_[t],i=this.keys_[e];return!this.leq_(i,r)},a.PriorityQ.prototype.keyGreaterThan_=function(t,e){var r=this.keys_[t],i=this.keys_[e];return!this.leq_(r,i)},a.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var t=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(this.leq_(e,t))return this.heap_.extractMin()}do--this.size_;while(this.size_>0&&null===this.keys_[this.order_[this.size_-1]]);return t},a.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var t=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(this.leq_(e,t))return e}return t},a.PriorityQ.prototype.isEmpty_=function(){return 0===this.size_&&this.heap_.isEmpty()},a.PriorityQ.prototype.remove=function(t){if(t>=0)return void this.heap_.remove(t);for(t=-(t+1),this.keys_[t]=null;this.size_>0&&null===this.keys_[this.order_[this.size_-1]];)--this.size_},a.PriorityQHeap=function(t){this.nodes_=a.PQNode.realloc(null,a.PriorityQHeap.INIT_SIZE_+1),this.handles_=a.PQHandleElem.realloc(null,a.PriorityQHeap.INIT_SIZE_+1),this.size_=0,this.max_=a.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.leq_=t,this.nodes_[1].handle=1},a.PriorityQHeap.INIT_SIZE_=32,a.PriorityQHeap.prototype.deleteHeap=function(){this.handles_=null,this.nodes_=null},a.PriorityQHeap.prototype.init=function(){for(var t=this.size_;t>=1;--t)this.floatDown_(t);this.initialized_=!0},a.PriorityQHeap.prototype.insert=function(t){var e=++this.size_;2*e>this.max_&&(this.max_*=2,this.nodes_=a.PQNode.realloc(this.nodes_,this.max_+1),this.handles_=a.PQHandleElem.realloc(this.handles_,this.max_+1));var r;return 0===this.freeList_?r=e:(r=this.freeList_,this.freeList_=this.handles_[r].node),this.nodes_[e].handle=r,this.handles_[r].node=e,this.handles_[r].key=t,this.initialized_&&this.floatUp_(e),r},a.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},a.PriorityQHeap.prototype.minimum=function(){return this.handles_[this.nodes_[1].handle].key},a.PriorityQHeap.prototype.extractMin=function(){var t=this.nodes_,e=this.handles_,r=t[1].handle,i=e[r].key;return this.size_>0&&(t[1].handle=t[this.size_].handle,e[t[1].handle].node=1,e[r].key=null,e[r].node=this.freeList_,this.freeList_=r,--this.size_>0&&this.floatDown_(1)),i},a.PriorityQHeap.prototype.remove=function(t){var e=this.nodes_,r=this.handles_,i=r[t].node;e[i].handle=e[this.size_].handle,r[e[i].handle].node=i,i<=--this.size_&&(1>=i||this.leq_(r[e[i>>1].handle].key,r[e[i].handle].key)?this.floatDown_(i):this.floatUp_(i)),r[t].key=null,r[t].node=this.freeList_,this.freeList_=t},a.PriorityQHeap.prototype.floatDown_=function(t){for(var e=this.nodes_,r=this.handles_,i=e[t].handle;;){var n=t<<1;n<this.size_&&this.leq_(r[e[n+1].handle].key,r[e[n].handle].key)&&++n;var o=e[n].handle;if(n>this.size_||this.leq_(r[i].key,r[o].key)){e[t].handle=i,r[i].node=t;break}e[t].handle=o,r[o].node=t,t=n}},a.PriorityQHeap.prototype.floatUp_=function(t){for(var e=this.nodes_,r=this.handles_,i=e[t].handle;;){var n=t>>1,o=e[n].handle;if(0===n||this.leq_(r[o].key,r[i].key)){e[t].handle=i,r[i].node=t;break}e[t].handle=o,r[o].node=t,t=n}},a.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},a.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},a.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},"undefined"!=typeof module&&(module.exports=a),i("../src/worldwind/util/libtess",function(){}),i("../src/worldwind/shapes/Polygon",["../shapes/AbstractShape","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolygon","../geom/Vec2","../geom/Vec3","../util/libtess"],function(t,e,r,i,n,o,s,l,u,c,h,f,d,p,m,g){"use strict";var y=function(r,i){if(!r)throw new e(l.logMessage(l.LEVEL_SEVERE,"Polygon","constructor","missingBoundaries"));t.call(this,i),r.length>0&&r[0].latitude&&(r=[r],this._boundariesSpecifiedSimply=!0),this._boundaries=r,this._textureCoordinates=null,this.referencePosition=this.determineReferencePosition(this._boundaries),this._extrude=!1,this.scratchPoint=new m(0,0,0)};return y.prototype=Object.create(t.prototype),Object.defineProperties(y.prototype,{boundaries:{get:function(){return this._boundariesSpecifiedSimply?this._boundaries[0]:this._boundaries},set:function(t){if(!t)throw new e(l.logMessage(l.LEVEL_SEVERE,"Polygon","boundaries","missingBoundaries"));t.length>0&&t[0].latitude&&(t=[t],this._boundariesSpecifiedSimply=!0),this._boundaries=t,this.referencePosition=this.determineReferencePosition(this._boundaries),this.reset()}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(t){this._textureCoordinates=t,this.reset()}},extrude:{get:function(){return this._extrude},set:function(t){this._extrude=t,this.reset()}}}),y.prototype.determineReferencePosition=function(t){return t.length>0&&t[0].length>2?t[0][0]:null},y.prototype.mustGenerateGeometry=function(t){return this.currentData.boundaryPoints?this.currentData.drawInterior!==this.activeAttributes.drawInterior?!0:this.altitudeMode===WorldWind.ABSOLUTE?!1:this.currentData.isExpired:!0},y.prototype.hasCapTexture=function(){return this.textureCoordinates&&this.capImageSource()},y.prototype.capImageSource=function(){return this.activeAttributes.imageSource?"string"==typeof this.activeAttributes.imageSource||this.activeAttributes.imageSource instanceof o?this.activeAttributes.imageSource:Array.isArray(this.activeAttributes.imageSource)&&this.activeAttributes.imageSource[0]&&("string"==typeof this.activeAttributes.imageSource[0]||this.activeAttributes.imageSource instanceof o)?this.activeAttributes.imageSource[0]:null:null},y.prototype.hasSideTextures=function(){return this.activeAttributes.imageSource&&Array.isArray(this.activeAttributes.imageSource)&&this.activeAttributes.imageSource.length>1},y.prototype.sideImageSource=function(t){if(0===t||2===this.activeAttributes.imageSource.length)return this.activeAttributes.imageSource[1];var e=this.activeAttributes.imageSource.length-1;return t=Math.min(t+1,e),this.activeAttributes.imageSource[t]},y.prototype.createSurfaceShape=function(){return new d(this.boundaries,null)},y.prototype.doMakeOrderedRenderable=function(t){if(!this.referencePosition)return null;if(!this.activeAttributes.drawInterior&&!this.activeAttributes.drawOutline)return null;if(!this.mustGenerateGeometry(t))return this;var e=this.currentData,r=e.referencePoint;t.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude,this._altitudeMode,r),e.transformationMatrix.setToTranslation(r[0],r[1],r[2]);for(var n=[],o=0;o<this._boundaries.length;o++)n[o]=this._boundaries[o].slice(0),n[o].push(this._boundaries[o][0]);var a=this.computeBoundaryPoints(t,n);if(this.activeAttributes.drawInterior){var s=this.tessellatePolygon(t,a);if(s){e.capTriangles=new Float32Array(s.length);for(var l=0,u=s.length;u>l;l++)e.capTriangles[l]=s[l]}}if(e.boundaryPoints=a,e.drawInterior=this.activeAttributes.drawInterior,this.resetExpiration(e),e.refreshBuffers=!0,e.extent||(e.extent=new i),1===a.length)e.extent.setToPoints(a[0]);else{var c=[];for(o=0;o<a.length;o++)for(var h=0;h<a[o].length;h++)c.push(a[o][h]);e.extent.setToPoints(c)}return e.extent.translate(e.referencePoint),this},y.prototype.computeBoundaryPoints=function(t,e){for(var r,i,n,o,a=Number.MAX_VALUE,s=t.navigatorState.eyePoint,l=[],u=this._extrude?6:3,c=new m(0,0,0),h=0;h<e.length;h++){r=(this._extrude?2:1)*e[h].length,l[h]=new Float32Array(3*r);for(var f=0,d=e[h].length;d>f;f++)i=e[h][f],t.surfacePointForMode(i.latitude,i.longitude,i.altitude,this.altitudeMode,c),o=c.distanceToSquared(s),a>o&&(a=o),c.subtract(this.currentData.referencePoint),n=u*f,l[h][n]=c[0],l[h][n+1]=c[1],l[h][n+2]=c[2],this._extrude&&(t.surfacePointForMode(i.latitude,i.longitude,0,WorldWind.CLAMP_TO_GROUND,c),o=c.distanceToSquared(s),a>o&&(a=o),c.subtract(this.currentData.referencePoint),l[h][n+3]=c[0],l[h][n+4]=c[1],l[h][n+5]=c[2])}return this.currentData.eyeDistance=0,l},y.prototype.tessellatePolygon=function(t,e){var r,i,n=[],o=0,s=this._extrude?6:3,u=this.hasCapTexture();this.polygonTessellator||(this.polygonTessellator=new a.GluTesselator,this.polygonTessellator.gluTessCallback(a.gluEnum.GLU_TESS_VERTEX_DATA,function(t,e){e[e.length]=t[0],e[e.length]=t[1],e[e.length]=t[2],u&&(e[e.length]=t[3],e[e.length]=t[4])}),this.polygonTessellator.gluTessCallback(a.gluEnum.GLU_TESS_COMBINE,function(t,e,r){var i=[t[0],t[1],t[2]];if(u)for(var n=3;4>=n;n++){for(var o=0,a=0;4>a;a++)r[a]>0&&(o+=r[a]*e[a][n]);i[n]=o}return i}),this.polygonTessellator.gluTessCallback(a.gluEnum.GLU_TESS_ERROR,function(t){o=t,l.logMessage(l.LEVEL_WARNING,"Polygon","tessellatePolygon","Tessellation error "+t+".")})),i=m.computeBufferNormal(e[0],s),i||(i=new m(0,0,0),t.globe.surfaceNormalAtLocation(this.referencePosition.latitude,this.referencePosition.longitude,i)),this.polygonTessellator.gluTessNormal(i[0],i[1],i[2]),this.currentData.capNormal=i,this.polygonTessellator.gluTessBeginPolygon(n);for(var c=0;c<e.length;c++){var h=0;this.polygonTessellator.gluTessBeginContour();for(var f=e[c],d=0;d<f.length;d+=s)r=[f[d],f[d+1],f[d+2]],u&&(h<this.textureCoordinates[c].length?(r[3]=this.textureCoordinates[c][h][0],r[4]=this.textureCoordinates[c][h][1]):(r[3]=this.textureCoordinates[c][0][0],r[4]=this.textureCoordinates[c][1][1]),++h),this.polygonTessellator.gluTessVertex(r,r);this.polygonTessellator.gluTessEndContour()}return this.polygonTessellator.gluTessEndPolygon(),0===o?n:null},y.prototype.mustDrawVerticals=function(t){return this._extrude&&this.activeAttributes.drawOutline&&this.activeAttributes.drawVerticals&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND},y.prototype.doRenderOrdered=function(t){var e,r=this.currentData;if(t.pickingMode&&(e=t.uniquePickColor()),this.activeAttributes.drawInterior&&r.capTriangles&&r.capTriangles.length>0&&this.drawCap(t,e),this._extrude&&this.activeAttributes.drawInterior&&this.drawSides(t,e),this.activeAttributes.drawOutline&&this.drawOutline(t,e),r.refreshBuffers=!1,t.pickingMode){var i=new c(e,this.pickDelegate?this.pickDelegate:this,null,t.currentLayer,!1);t.resolvePick(i)}},y.prototype.drawCap=function(t,e){var r,i,n,o,a,s,l=t.currentGlContext,u=t.currentProgram,c=this.currentData,h=c.refreshBuffers,f=!!this.hasCapTexture(),d=this.activeAttributes.applyLighting,p=c.capTriangles.length/(f?5:3);u.loadTextureEnabled(l,!1),this.applyMvpMatrix(t),c.capVboCacheKey||(c.capVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(c.capVboCacheKey),r||(r=l.createBuffer(),t.gpuResourceCache.putResource(c.capVboCacheKey,r,4*c.capTriangles.length),h=!0),l.bindBuffer(l.ARRAY_BUFFER,r),h&&(s=d?this.makeCapBufferWithNormals():c.capTriangles,l.bufferData(l.ARRAY_BUFFER,s,l.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),n=this.activeAttributes.interiorColor,i=n.alpha*t.currentLayer.opacity,l.depthMask(i>=1||t.pickingMode),u.loadColor(l,t.pickingMode?e:n),u.loadOpacity(l,t.pickingMode?i>0?1:0:i),o=12+(f?8:0)+(d?12:0),f&&!t.pickingMode&&(this.activeTexture=t.gpuResourceCache.resourceForKey(this.capImageSource()),this.activeTexture||(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.capImageSource())),a=this.activeTexture&&this.activeTexture.bind(t),a&&(l.enableVertexAttribArray(u.vertexTexCoordLocation),l.vertexAttribPointer(u.vertexTexCoordLocation,2,l.FLOAT,!1,o,12),this.scratchMatrix.setToIdentity(),this.scratchMatrix.multiplyByTextureTransform(this.activeTexture),u.loadTextureEnabled(l,!0),u.loadTextureUnit(l,l.TEXTURE0),u.loadTextureMatrix(l,this.scratchMatrix),u.loadModulateColor(l,t.pickingMode))),d&&!t.pickingMode&&(u.loadApplyLighting(l,!0),l.enableVertexAttribArray(u.normalVectorLocation),l.vertexAttribPointer(u.normalVectorLocation,3,l.FLOAT,!1,o,o-12)),l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,o,0),l.drawArrays(l.TRIANGLES,0,p)},y.prototype.makeCapBufferWithNormals=function(){for(var t=this.currentData,e=t.capNormal,r=this.hasCapTexture()?5:3,i=r+3,n=t.capTriangles.length/r,o=t.capTriangles,a=new Float32Array(n*i),s=0,l=0;n>l;l++){for(var u=0;r>u;u++)a[s++]=o[l*r+u];a[s++]=e[0],a[s++]=e[1],a[s++]=e[2]}return a},y.prototype.drawSides=function(t,e){var r,i,n,o,a,s,l=t.currentGlContext,u=t.currentProgram,c=this.currentData,h=c.refreshBuffers,f=this.hasSideTextures(),d=this.activeAttributes.applyLighting,p=3+(f?2:0)+(d?3:0),m=4*p;s=0;for(var g=0;g<c.boundaryPoints.length;g++)s+=c.boundaryPoints[g].length/6-1;if(c.sidesVboCacheKey||(c.sidesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(c.sidesVboCacheKey),!r||h?(a=this.makeSidesBuffer(s),c.numSideVertices=a.length/p,r||(r=l.createBuffer()),t.gpuResourceCache.putResource(c.sidesVboCacheKey,r,4*a.length),l.bindBuffer(l.ARRAY_BUFFER,r),l.bufferData(l.ARRAY_BUFFER,a,l.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)):l.bindBuffer(l.ARRAY_BUFFER,r),n=this.activeAttributes.interiorColor,i=n.alpha*t.currentLayer.opacity,l.depthMask(i>=1||t.pickingMode),u.loadColor(l,t.pickingMode?e:n),u.loadOpacity(l,t.pickingMode?i>0?1:0:i),f&&!t.pickingMode){this.activeTexture=t.gpuResourceCache.resourceForKey(this.capImageSource()),this.activeTexture||(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.capImageSource())),d?(u.loadApplyLighting(l,!0),l.enableVertexAttribArray(u.normalVectorLocation)):u.loadApplyLighting(l,!1);for(var y=0;s>y;y++){var v=this.sideImageSource(y),E=t.gpuResourceCache.resourceForKey(v),w=6*y*m;v&&!E&&(E=t.gpuResourceCache.retrieveTexture(t.currentGlContext,v)),o=E&&E.bind(t),o?(l.enableVertexAttribArray(u.vertexTexCoordLocation),l.vertexAttribPointer(u.vertexTexCoordLocation,2,l.FLOAT,!1,m,w+12),this.scratchMatrix.setToIdentity(),this.scratchMatrix.multiplyByTextureTransform(this.activeTexture),u.loadTextureEnabled(l,!0),u.loadTextureUnit(l,l.TEXTURE0),u.loadTextureMatrix(l,this.scratchMatrix)):(u.loadTextureEnabled(l,!1),l.disableVertexAttribArray(u.vertexTexCoordLocation)),d&&l.vertexAttribPointer(u.normalVectorLocation,3,l.FLOAT,!1,m,w+20),l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,m,w),l.drawArrays(l.TRIANGLES,0,6)}}else u.loadTextureEnabled(l,!1),d&&!t.pickingMode?(u.loadApplyLighting(l,!0),l.enableVertexAttribArray(u.normalVectorLocation),l.vertexAttribPointer(u.normalVectorLocation,3,l.FLOAT,!1,m,m-12)):u.loadApplyLighting(l,!1),l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,m,0),l.drawArrays(l.TRIANGLES,0,c.numSideVertices)},y.prototype.makeSidesBuffer=function(t){var e,r,i,n,o,a,s,l,u,c,h,f=this.currentData,d=this.hasSideTextures(),g=this.activeAttributes.applyLighting,y=3+(d?2:0)+(g?3:0);i=2*t*3*y,e=new Float32Array(i),r=0,n=new m(0,0,0),o=new m(0,0,0),a=new m(0,0,0),s=new m(0,0,0),d?(l=new p(0,1),u=new p(0,0),c=new p(1,1),h=new p(1,0)):l=u=c=h=null;for(var v=0;v<f.boundaryPoints.length;v++)for(var E,w=f.boundaryPoints[v],b=0;b<w.length-6;b+=6)n[0]=w[b],n[1]=w[b+1],n[2]=w[b+2],o[0]=w[b+3],o[1]=w[b+4],o[2]=w[b+5],a[0]=w[b+6],a[1]=w[b+7],a[2]=w[b+8],s[0]=w[b+9],s[1]=w[b+10],s[2]=w[b+11],E=g?m.computeTriangleNormal(n,o,a):null,this.addVertexToBuffer(n,l,E,e,r),r+=y,this.addVertexToBuffer(o,u,E,e,r),r+=y,this.addVertexToBuffer(a,c,E,e,r),r+=y,this.addVertexToBuffer(o,u,E,e,r),r+=y,this.addVertexToBuffer(s,h,E,e,r),r+=y,this.addVertexToBuffer(a,c,E,e,r),r+=y;return e},y.prototype.addVertexToBuffer=function(t,e,r,i,n){i[n++]=t[0],i[n++]=t[1],i[n++]=t[2],e&&(i[n++]=e[0],i[n++]=e[1]),r&&(i[n++]=r[0],i[n++]=r[1],i[n]=r[2])},y.prototype.drawOutline=function(t,e){var r,i,n,o,a,s,l=t.currentGlContext,u=t.currentProgram,c=this.currentData,h=c.refreshBuffers;u.loadTextureEnabled(l,!1),u.loadApplyLighting(l,!1),this.hasCapTexture()&&l.disableVertexAttribArray(u.vertexTexCoordLocation),this.activeAttributes.applyLighting&&l.disableVertexAttribArray(u.normalVectorLocation),
c.boundaryVboCacheKeys||(this.currentData.boundaryVboCacheKeys=[]),this.applyMvpMatrixForOutline(t),u.loadTextureEnabled(l,!1),l.disableVertexAttribArray(u.vertexTexCoordLocation);for(var f=0;f<c.boundaryPoints.length;f++)r=c.boundaryPoints[f].length/3,c.boundaryVboCacheKeys[f]||(c.boundaryVboCacheKeys[f]=t.gpuResourceCache.generateCacheKey()),i=t.gpuResourceCache.resourceForKey(c.boundaryVboCacheKeys[f]),i||(i=l.createBuffer(),t.gpuResourceCache.putResource(c.boundaryVboCacheKeys[f],i,12*r),h=!0),l.bindBuffer(l.ARRAY_BUFFER,i),h&&(l.bufferData(l.ARRAY_BUFFER,c.boundaryPoints[f],l.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),o=this.activeAttributes.outlineColor,n=o.alpha*t.currentLayer.opacity,l.depthMask(n>=1||t.pickingMode),u.loadColor(l,t.pickingMode?e:o),u.loadOpacity(l,t.pickingMode?1:n),l.lineWidth(this.activeAttributes.outlineWidth),this._extrude?(a=24,s=r/2):(a=12,s=r),l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,a,0),l.drawArrays(l.LINE_STRIP,0,s),this.mustDrawVerticals(t)&&(l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,0,0),l.drawArrays(l.LINES,0,r-2))},y.prototype.beginDrawing=function(t){var e=t.currentGlContext;this.activeAttributes.drawInterior&&e.disable(e.CULL_FACE),t.findAndBindProgram(r),e.enableVertexAttribArray(t.currentProgram.vertexPointLocation);var i=!t.pickMode&&this.activeAttributes.applyLighting;i&&t.currentProgram.loadModelviewInverse(e,t.navigatorState.modelviewNormalTransform)},y.prototype.endDrawing=function(t){var e=t.currentGlContext;e.disableVertexAttribArray(t.currentProgram.vertexPointLocation),e.disableVertexAttribArray(t.currentProgram.normalVectorLocation),e.depthMask(!0),e.lineWidth(1),e.enable(e.CULL_FACE)},y}),i("../src/worldwind/shapes/SurfacePolyline",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(t,e,r,i){"use strict";var n=function(r,o){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfacePolyline","constructor","The specified locations array is null or undefined."));i.call(this,o),this._boundaries=r,this._stateId=n.stateId++,this._isInteriorInhibited=!0};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{boundaries:{get:function(){return this._boundaries},set:function(r){if(!Array.isArray(r))throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfacePolyline","set boundaries","The specified value is not an array."));this._boundaries=r,this._stateId=n.stateId++,this.isPrepared=!1,this.stateKeyInvalid=!0}}}),n.stateId=Number.MIN_SAFE_INTEGER,n.staticStateKey=function(t){var e=i.staticStateKey(t);return e+" pl "+t._stateId},n.prototype.computeStateKey=function(){return n.staticStateKey(this)},n}),i("../src/worldwind/formats/geojson/GeoJSONParser",["../../error/ArgumentError","../../util/Color","./GeoJSONConstants","./GeoJSONCRS","./GeoJSONFeature","./GeoJSONFeatureCollection","./GeoJSONGeometry","./GeoJSONGeometryCollection","./GeoJSONGeometryLineString","./GeoJSONGeometryMultiLineString","./GeoJSONGeometryMultiPoint","./GeoJSONGeometryMultiPolygon","./GeoJSONGeometryPoint","./GeoJSONGeometryPolygon","../../geom/Location","../../util/Logger","../../shapes/Placemark","../../shapes/PlacemarkAttributes","../../shapes/Polygon","../../geom/Position","../../util/proj4-src","../../layer/RenderableLayer","../../shapes/ShapeAttributes","../../shapes/SurfacePolygon","../../shapes/SurfacePolyline"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m,g,y,v,E,w,b,x,_,S){"use strict";var T=function(e){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","constructor","missingDataSource"));this._dataSource=e,this._geoJSONObject=null,this._geoJSONType=null,this._crs=null,this._layer=null,this._parserCompletionCallback=null,this._shapeConfigurationCallback=this.defaultShapeConfigurationCallback,this.defaultPlacemarkAttributes=new y(null),this.defaultShapeAttributes=new x(null),this.setProj4jsAliases()};return Object.defineProperties(T.prototype,{dataSource:{get:function(){return this._dataSource}},geoJSONObject:{get:function(){return this._geoJSONObject}},geoJSONType:{get:function(){return this._geoJSONType}},crs:{get:function(){return this._crs}},layer:{get:function(){return this._layer}},parserCompletionCallback:{get:function(){return this._parserCompletionCallback}},shapeConfigurationCallback:{get:function(){return this._shapeConfigurationCallback}}}),T.prototype.load=function(t,e,r){t&&(this._parserCompletionCallback=t),e&&(this._shapeConfigurationCallback=e),this._layer=r||new b,this.isDataSourceJson()?this.parse(this.dataSource):this.requestUrl(this.dataSource)},T.prototype.defaultShapeConfigurationCallback=function(t,e){var r={},i=e.name||e.Name||e.NAME;return i&&(r.name=i),t.isPointType()||t.isMultiPointType()?r.attributes=this.defaultPlacemarkAttributes:t.isLineStringType()||t.isMultiLineStringType()?r.attributes=this.defaultShapeAttributes:(t.isPolygonType()||t.isMultiPolygonType())&&(r.attributes=this.defaultShapeAttributes),r},T.prototype.requestUrl=function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="text",e.onreadystatechange=function(){4===e.readyState&&(200===e.status?this.parse(e.response):m.log(m.LEVEL_WARNING,"GeoJSON retrieval failed ("+e.statusText+"): "+t))}.bind(this),e.onerror=function(){m.log(m.LEVEL_WARNING,"GeoJSON retrieval failed: "+t)},e.ontimeout=function(){m.log(m.LEVEL_WARNING,"GeoJSON retrieval timed out: "+t)},e.send(null)},T.prototype.parse=function(e){try{this._geoJSONObject=JSON.parse(e)}catch(i){m.logMessage(m.LEVEL_SEVERE,"GeoJSON","parse","invalidGeoJSONObject")}finally{if(this.geoJSONObject){if("[object Array]"===Object.prototype.toString.call(this.geoJSONObject))throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","parse","invalidGeoJSONObjectLength"));if(!this.geoJSONObject.hasOwnProperty(r.FIELD_TYPE))throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","parse","missingGeoJSONType"));this.setGeoJSONType(),this.setGeoJSONCRS(),this._parserCompletionCallback&&"function"==typeof this._parserCompletionCallback&&this._parserCompletionCallback(this.layer)}}},T.prototype.setGeoJSONCRS=function(){if(this.geoJSONObject[r.FIELD_CRS]){this._crs=new i(this.geoJSONObject[r.FIELD_CRS][r.FIELD_TYPE],this.geoJSONObject[r.FIELD_CRS][r.FIELD_PROPERTIES]);var t=function(){this.addRenderablesForGeoJSON(this.layer)}.bind(this);this.crs.setCRSString(t)}else this.addRenderablesForGeoJSON(this.layer)},T.prototype.addRenderablesForGeoJSON=function(e){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeoJSON","missingLayer"));switch(this.geoJSONType){case r.TYPE_FEATURE:var i=new n(this.geoJSONObject[r.FIELD_GEOMETRY],this.geoJSONObject[r.FIELD_PROPERTIES],this.geoJSONObject[r.FIELD_ID],this.geoJSONObject[r.FIELD_BBOX]);this.addRenderablesForFeature(e,i);break;case r.TYPE_FEATURE_COLLECTION:var a=new o(this.geoJSONObject[r.FIELD_FEATURES],this.geoJSONObject[r.FIELD_BBOX]);this.addRenderablesForFeatureCollection(e,a);break;case r.TYPE_GEOMETRY_COLLECTION:var l=new s(this.geoJSONObject[r.FIELD_GEOMETRIES],this.geoJSONObject[r.FIELD_BBOX]);this.addRenderablesForGeometryCollection(e,l,null);break;default:this.addRenderablesForGeometry(e,this.geoJSONObject,null)}},T.prototype.addRenderablesForGeometry=function(e,i,n){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometry","missingLayer"));if(!i)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometry","missingGeometry"));switch(i[r.FIELD_TYPE]){case r.TYPE_POINT:var o=new f(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForPoint(e,o,n?n:null);break;case r.TYPE_MULTI_POINT:var a=new c(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForMultiPoint(e,a,n?n:null);break;case r.TYPE_LINE_STRING:var s=new l(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForLineString(e,s,n?n:null);break;case r.TYPE_MULTI_LINE_STRING:var p=new u(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForMultiLineString(e,p,n?n:null);break;case r.TYPE_POLYGON:var g=new d(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForPolygon(e,g,n?n:null);break;case r.TYPE_MULTI_POLYGON:var y=new h(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForMultiPolygon(e,y,n?n:null)}},T.prototype.addRenderablesForPoint=function(e,r,i){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForPoint","missingLayer"));if(!r)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForPoint","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported()){var o=r.coordinates[0],a=r.coordinates[1],s=r.coordinates[2]?r.coordinates[2]:0,l=this.getReprojectedIfRequired(a,o,this.crs),u=new E(l[1],l[0],s),c=new g(u,!1,n&&n.attributes?n.attributes:null);c.altitudeMode=WorldWind.RELATIVE_TO_GROUND,n&&n.name&&(c.label=n.name),n.highlightAttributes&&(c.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(c.pickDelegate=n.pickDelegate),n&&n.userProperties&&(c.userProperties=n.userProperties),e.addRenderable(c)}},T.prototype.addRenderablesForMultiPoint=function(e,r,i){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPoint","missingLayer"));if(!r)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPoint","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported())for(var o=0,a=r.coordinates.length;a>o;o+=1){var s=r.coordinates[o][0],l=r.coordinates[o][1],u=r.coordinates[o][2]?r.coordinates[o][2]:0,c=this.getReprojectedIfRequired(l,s,this.crs),h=new E(c[1],c[0],u),f=new g(h,!1,n&&n.attributes?n.attributes:null);f.altitudeMode=WorldWind.RELATIVE_TO_GROUND,n&&n.name&&(f.label=n.name),n.highlightAttributes&&(f.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(f.pickDelegate=n.pickDelegate),n&&n.userProperties&&(f.userProperties=n.userProperties),e.addRenderable(f)}},T.prototype.addRenderablesForLineString=function(e,r,i){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForLineString","missingLayer"));if(!r)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForLineString","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported()){for(var o=[],a=0,s=r.coordinates;a<s.length;a++){var l=s[a][0],u=s[a][1],c=this.getReprojectedIfRequired(u,l,this.crs),h=new p(c[1],c[0]);o.push(h)}var f;f=new S(o,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(f.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(f.pickDelegate=n.pickDelegate),n&&n.userProperties&&(f.userProperties=n.userProperties),e.addRenderable(f)}},T.prototype.addRenderablesForMultiLineString=function(e,r,i){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiLineString","missingLayer"));if(!r)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiLineString","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported())for(var o=0,a=r.coordinates;o<a.length;o++){for(var s=[],l=0,u=a[o];l<u.length;l++){var c=u[l][0],h=u[l][1],f=this.getReprojectedIfRequired(h,c,this.crs),d=new p(f[1],f[0]);s.push(d)}var g;g=new S(s,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(g.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(g.pickDelegate=n.pickDelegate),n&&n.userProperties&&(g.userProperties=n.userProperties),e.addRenderable(g)}},T.prototype.addRenderablesForPolygon=function(e,r,i){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingLayer"));if(!r)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported())for(var o=0,a=r.coordinates;o<a.length;o++){for(var s=[],l=0,u=a[o];l<u.length;l++){var c=u[l][0],h=u[l][1],f=this.getReprojectedIfRequired(h,c,this.crs),d=new p(f[1],f[0]);s.push(d)}var g;g=new _(s,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(g.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(g.pickDelegate=n.pickDelegate),n&&n.userProperties&&(g.userProperties=n.userProperties),e.addRenderable(g)}},T.prototype.addRenderablesForMultiPolygon=function(e,r,i){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingLayer"));if(!r)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported())for(var o=0,a=r.coordinates;o<a.length;o++){for(var s=[],l=0;l<a[o].length;l++){for(var u=[],c=0,h=a[o][l];c<h.length;c++){var f=h[c][0],d=h[c][1],g=this.getReprojectedIfRequired(d,f,this.crs),y=new p(g[1],g[0]);u.push(y)}s.push(u)}var v;v=new _(s,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(v.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(v.pickDelegate=n.pickDelegate),n&&n.userProperties&&(v.userProperties=n.userProperties),e.addRenderable(v)}},T.prototype.addRenderablesForGeometryCollection=function(e,i,n){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometryCollection","missingLayer"));if(!i)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometryCollection","missingGeometryCollection"));for(var o=0,a=i.geometries;o<a.length;o++)a[o].hasOwnProperty(r.FIELD_TYPE)&&this.addRenderablesForGeometry(e,a[o],n)},T.prototype.addRenderablesForFeature=function(e,i){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeature","missingLayer"));if(!i)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeature","missingFeature"));if(i.geometry.type===r.TYPE_GEOMETRY_COLLECTION){var n=new s(i.geometry.geometries,i.bbox);this.addRenderablesForGeometryCollection(e,n,i.properties)}else this.addRenderablesForGeometry(e,i.geometry,i.properties)},T.prototype.addRenderablesForFeatureCollection=function(e,i){if(!e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeatureCollection","missingLayer"));if(!i)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeatureCollection","missingFeatureCollection"));if(i.features.length>0)for(var o=0;o<i.features.length;o++){var a=new n(i.features[o][r.FIELD_GEOMETRY],i.features[o][r.FIELD_PROPERTIES],i.features[o][r.FIELD_ID],i.features[o][r.FIELD_BBOX]);this.addRenderablesForFeature(e,a)}},T.prototype.setGeoJSONType=function(){switch(this.geoJSONObject[r.FIELD_TYPE]){case r.TYPE_POINT:this._geoJSONType=r.TYPE_POINT;break;case r.TYPE_MULTI_POINT:this._geoJSONType=r.TYPE_MULTI_POINT;break;case r.TYPE_LINE_STRING:this._geoJSONType=r.TYPE_LINE_STRING;break;case r.TYPE_MULTI_LINE_STRING:this._geoJSONType=r.TYPE_MULTI_LINE_STRING;break;case r.TYPE_POLYGON:this._geoJSONType=r.TYPE_POLYGON;break;case r.TYPE_MULTI_POLYGON:this._geoJSONType=r.TYPE_MULTI_POLYGON;break;case r.TYPE_GEOMETRY_COLLECTION:this._geoJSONType=r.TYPE_GEOMETRY_COLLECTION;break;case r.TYPE_FEATURE:this._geoJSONType=r.TYPE_FEATURE;break;case r.TYPE_FEATURE_COLLECTION:this._geoJSONType=r.TYPE_FEATURE_COLLECTION;break;default:throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","setGeoJSONType","invalidGeoJSONType"))}},T.prototype.getReprojectedIfRequired=function(e,i,n){if(!e&&0!==e)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","getReprojectedIfRequired","missingLatitude"));if(!i&&0!==i)throw new t(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","getReprojectedIfRequired","missingLongitude"));return!n||n.isDefault()?[i,e]:w(n.projectionString,r.EPSG4326_CRS,[i,e])},T.prototype.setProj4jsAliases=function(){w.defs([["urn:ogc:def:crs:OGC:1.3:CRS84",w.defs("EPSG:4326")],["urn:ogc:def:crs:EPSG::3857",w.defs("EPSG:3857")]])},T.prototype.isDataSourceJson=function(){try{JSON.parse(this.dataSource)}catch(t){return!1}return!0},T}),i("../src/worldwind/formats/geotiff/GeoTiffConstants",[],function(){"use strict";var t={Tag:{MODEL_PIXEL_SCALE:33550,MODEL_TRANSFORMATION:34264,MODEL_TIEPOINT:33922,GEO_KEY_DIRECTORY:34735,GEO_DOUBLE_PARAMS:34736,GEO_ASCII_PARAMS:34737,GDAL_NODATA:42113,GDAL_METADATA:42112},Key:{GTModelTypeGeoKey:1024,GTRasterTypeGeoKey:1025,GTCitationGeoKey:1026,GeographicTypeGeoKey:2048,GeogCitationGeoKey:2049,GeogGeodeticDatumGeoKey:2050,GeogPrimeMeridianGeoKey:2051,GeogLinearUnitsGeoKey:2052,GeogLinearUnitSizeGeoKey:2053,GeogAngularUnitsGeoKey:2054,GeogAngularUnitSizeGeoKey:2055,GeogEllipsoidGeoKey:2056,GeogSemiMajorAxisGeoKey:2057,GeogSemiMinorAxisGeoKey:2058,GeogInvFlatteningGeoKey:2059,GeogAzimuthUnitsGeoKey:2060,GeogPrimeMeridianLongGeoKey:2061,GeogTOWGS84GeoKey:2062,ProjectedCSTypeGeoKey:3072,PCSCitationGeoKey:3073,ProjectionGeoKey:3074,ProjCoordTransGeoKey:3075,ProjLinearUnitsGeoKey:3076,ProjLinearUnitSizeGeoKey:3077,ProjStdParallel1GeoKey:3078,ProjStdParallel2GeoKey:3079,ProjNatOriginLongGeoKey:3080,ProjNatOriginLatGeoKey:3081,ProjFalseEastingGeoKey:3082,ProjFalseNorthingGeoKey:3083,ProjFalseOriginLongGeoKey:3084,ProjFalseOriginLatGeoKey:3085,ProjFalseOriginEastingGeoKey:3086,ProjFalseOriginNorthingGeoKey:3087,ProjCenterLongGeoKey:3088,ProjCenterLatGeoKey:3089,ProjCenterEastingGeoKey:3090,ProjCenterNorthingGeoKey:3091,ProjScaleAtNatOriginGeoKey:3092,ProjScaleAtCenterGeoKey:3093,ProjAzimuthAngleGeoKey:3094,ProjStraightVertPoleLongGeoKey:3095,VerticalCSTypeGeoKey:4096,VerticalCitationGeoKey:4097,VerticalDatumGeoKey:4098,VerticalUnitsGeoKey:4099}};return t}),i("../src/worldwind/formats/geotiff/GeoTiffKeyEntry",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffConstants","../../util/Logger"],function(t,e,r,i){"use strict";var n=function(t,r,n,o){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingKeyId"));if(null===r||void 0===r)throw new e(i.logMessage(i.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingTiffTagLocation"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingCount"));if(null===o||void 0===o)throw new e(i.logMessage(i.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingValueOffset"));this._keyId=t,this._tiffTagLocation=r,this._count=n,this._valueOffset=o};return Object.defineProperties(n.prototype,{keyId:{get:function(){return this._keyId}},tiffTagLocation:{get:function(){return this._tiffTagLocation}},count:{get:function(){return this._count}},valueOffset:{get:function(){return this._valueOffset}}}),n.prototype.getGeoKeyValue=function(t,e){var i;if(0===this.tiffTagLocation)i=this.valueOffset;else if(this.tiffTagLocation===r.Tag.GEO_ASCII_PARAMS){var n="";if(e){for(var o=this.valueOffset;o<this.count-1;o++)n+=e[o];"|"!=e[this.count-1]&&(n+=e[this.count-1]),i=n}}else this.tiffTagLocation===r.Tag.GEO_DOUBLE_PARAMS&&t&&(i=t[this.valueOffset]);return i},n}),i("../src/worldwind/formats/geotiff/GeoTiffMetadata",[],function(){"use strict";var t=function(){this._bitsPerSample=null,this._colorMap=null,this._compression=null,this._extraSamples=null,this._imageLength=null,this._imageWidth=null,this._maxSampleValue=null,this._minSampleValue=null,this._orientation=0,this._photometricInterpretation=null,this._planarConfiguration=null,this._resolutionUnit=null,this._rowsPerStrip=null,this._samplesPerPixel=null,this._sampleFormat=null,this._software=null,this._stripByteCounts=null,this._stripOffsets=null,this._tileByteCounts=null,this._tileOffsets=null,this._tileLength=null,this._tileWidth=null,this._xResolution=null,this._yResolution=null,this._geoAsciiParams=null,this._geoDoubleParams=null,this._geoKeyDirectory=null,this._modelPixelScale=null,this._modelTiepoint=null,this._modelTransformation=null,this._noData=null,this._bbox=null,this._gtModelTypeGeoKey=null,this._gtRasterTypeGeoKey=null,this._gtCitationGeoKey=null,this._geographicTypeGeoKey=null,this._geogCitationGeoKey=null,this._geogAngularUnitsGeoKey=null,this._geogAngularUnitSizeGeoKey=null,this._geogSemiMajorAxisGeoKey=null,this._geogInvFlatteningGeoKey=null,this._projectedCSType=null};return Object.defineProperties(t.prototype,{bitsPerSample:{get:function(){return this._bitsPerSample},set:function(t){this._bitsPerSample=t}},colorMap:{get:function(){return this._colorMap},set:function(t){this._colorMap=t}},compression:{get:function(){return this._compression},set:function(t){this._compression=t}},extraSamples:{get:function(){return this._extraSamples},set:function(t){this._extraSamples=t}},imageLength:{get:function(){return this._imageLength},set:function(t){this._imageLength=t}},imageWidth:{get:function(){return this._imageWidth},set:function(t){this._imageWidth=t}},maxSampleValue:{get:function(){return this._maxSampleValue},set:function(t){this._maxSampleValue=t}},minSampleValue:{get:function(){return this._minSampleValue},set:function(t){this._minSampleValue=t}},orientation:{get:function(){return this._orientation},set:function(t){this._orientation=t}},photometricInterpretation:{get:function(){return this._photometricInterpretation},set:function(t){this._photometricInterpretation=t}},planarConfiguration:{get:function(){return this._planarConfiguration},set:function(t){this._planarConfiguration=t}},resolutionUnit:{get:function(){return this._resolutionUnit},set:function(t){this._resolutionUnit=t}},rowsPerStrip:{get:function(){return this._rowsPerStrip},set:function(t){this._rowsPerStrip=t}},samplesPerPixel:{get:function(){return this._samplesPerPixel},set:function(t){this._samplesPerPixel=t}},sampleFormat:{get:function(){return this._sampleFormat},set:function(t){this._sampleFormat=t}},software:{get:function(){return this._software},set:function(t){this._software=t}},stripByteCounts:{get:function(){return this._stripByteCounts},set:function(t){this._stripByteCounts=t}},stripOffsets:{get:function(){return this._stripOffsets},set:function(t){this._stripOffsets=t}},tileByteCounts:{get:function(){return this._tileByteCounts},set:function(t){this._tileByteCounts=t}},tileOffsets:{get:function(){return this._tileOffsets},set:function(t){this._tileOffsets=t}},tileLength:{get:function(){return this._tileLength},set:function(t){this._tileLength=t}},tileWidth:{get:function(){return this._tileWidth},set:function(t){this._tileWidth=t}},geoAsciiParams:{get:function(){return this._geoAsciiParams},set:function(t){this._geoAsciiParams=t}},geoDoubleParams:{get:function(){return this._geoDoubleParams},set:function(t){this._geoDoubleParams=t}},geoKeyDirectory:{get:function(){return this._geoKeyDirectory},set:function(t){this._geoKeyDirectory=t}},modelPixelScale:{get:function(){return this._modelPixelScale},set:function(t){this._modelPixelScale=t}},modelTiepoint:{get:function(){return this._modelTiepoint},set:function(t){this._modelTiepoint=t}},modelTransformation:{get:function(){return this._modelTransformation},set:function(t){this._modelTransformation=t}},noData:{get:function(){return this._noData},set:function(t){this._noData=t}},bbox:{get:function(){return this._bbox},set:function(t){this._bbox=t}},gtModelTypeGeoKey:{get:function(){return this._gtModelTypeGeoKey},set:function(t){this._gtModelTypeGeoKey=t}},gtRasterTypeGeoKey:{get:function(){return this._gtRasterTypeGeoKey},set:function(t){this._gtRasterTypeGeoKey=t}},gtCitationGeoKey:{get:function(){return this._gtCitationGeoKey},set:function(t){this._gtCitationGeoKey=t}},geographicTypeGeoKey:{get:function(){return this._geographicTypeGeoKey},set:function(t){this._geographicTypeGeoKey=t}},geogCitationGeoKey:{get:function(){return this._geogCitationGeoKey},set:function(t){this._geogCitationGeoKey=t}},geogAngularUnitsGeoKey:{get:function(){return this._geogAngularUnitsGeoKey},set:function(t){this._geogAngularUnitsGeoKey=t}},geogAngularUnitSizeGeoKey:{get:function(){return this._geogAngularUnitSizeGeoKey},set:function(t){this._geogAngularUnitSizeGeoKey=t}},geogSemiMajorAxisGeoKey:{get:function(){return this._geogSemiMajorAxisGeoKey},set:function(t){this._geogSemiMajorAxisGeoKey=t}},geogInvFlatteningGeoKey:{get:function(){return this._geogInvFlatteningGeoKey},set:function(t){this._geogInvFlatteningGeoKey=t}},projectedCSType:{get:function(){return this._projectedCSType},set:function(t){this._projectedCSType=t}},xResolution:{get:function(){return this._xResolution},set:function(t){this._xResolution=t}},yResolution:{get:function(){return this._yResolution},set:function(t){this._yResolution=t}}}),t}),i("../src/worldwind/formats/geotiff/TiffConstants",[],function(){"use strict";var t={Tag:{NEW_SUBFILE_TYPE:254,SUBFILE_TYPE:255,IMAGE_WIDTH:256,IMAGE_LENGTH:257,BITS_PER_SAMPLE:258,COMPRESSION:259,PHOTOMETRIC_INTERPRETATION:262,THRESHHOLDING:263,CELL_WIDTH:264,CELL_LENGTH:265,FILL_ORDER:266,DOCUMENT_NAME:269,IMAGE_DESCRIPTION:270,MAKE:271,MODEL:272,STRIP_OFFSETS:273,ORIENTATION:274,SAMPLES_PER_PIXEL:277,ROWS_PER_STRIP:278,STRIP_BYTE_COUNTS:279,MIN_SAMPLE_VALUE:280,MAX_SAMPLE_VALUE:281,X_RESOLUTION:282,Y_RESOLUTION:283,PLANAR_CONFIGURATION:284,PAGE_NAME:285,X_POSITION:286,Y_POSITION:287,FREE_OFFSETS:288,FREE_BYTE_COUNTS:289,GRAY_RESPONSE_UNIT:290,GRAY_RESPONSE_CURVE:291,T4_OPTIONS:292,T6_PTIONS:293,RESOLUTION_UNIT:296,PAGE_NUMBER:297,TRANSFER_FUNCTION:301,SOFTWARE:305,DATE_TIME:306,ARTIST:315,HOST_COMPUTER:316,PREDICTOR:317,WHITE_POINT:318,PRIMARY_CHROMATICITIES:319,COLOR_MAP:320,HALFTONE_HINTS:321,TILE_WIDTH:322,TILE_LENGTH:323,TILE_OFFSETS:324,TILE_BYTE_COUNTS:325,INK_SET:332,INK_NAMES:333,NUMBER_OF_INKS:334,DOT_RANGE:336,TARGET_PRINTER:337,EXTRA_SAMPLES:338,SAMPLE_FORMAT:339,S_MIN_SAMPLE_VALUE:340,S_MAX_SAMPLE_VALUE:341,TRANSFER_RANGE:342,JPEG_PROC:512,JPEG_INTERCHANGE_FORMAT:513,JPEG_INTERCHANGE_FORMAT_LENGTH:514,JPEG_RESTART_INTERVAL:515,JPEG_LOSSLESS_PREDICTORS:517,JPEG_POINT_TRANSFORMS:518,JPEG_Q_TABLES:519,JPEG_DC_TABLES:520,JPEG_AC_TABLES:521,Y_Cb_Cr_COEFFICIENTS:529,Y_Cb_Cr_SUB_SAMPLING:530,Y_Cb_Cr_POSITIONING:531,REFERENCE_BLACK_WHITE:532,COPYRIGHT:33432},Compression:{UNCOMPRESSED:1,CCITT_1D:2,GROUP_3_FAX:3,GROUP_4_FAX:4,LZW:5,JPEG:6,PACK_BITS:32773},Orientation:{Row0_IS_TOP__Col0_IS_LHS:1,Row0_IS_TOP__Col0_IS_RHS:2,Row0_IS_BOTTOM__Col0_IS_RHS:3,Row0_IS_BOTTOM__Col0_IS_LHS:4,Row0_IS_LHS__Col0_IS_TOP:5,Row0_IS_RHS__Col0_IS_TOP:6,Row0_IS_RHS__Col0_IS_BOTTOM:7,Row0_IS_LHS__Col0_IS_BOTTOM:8},PhotometricInterpretation:{WHITE_IS_ZERO:0,BLACK_IS_ZERO:1,RGB:2,RGB_PALETTE:3,TRANSPARENCY_MASK:4,CMYK:5,Y_Cb_Cr:6,CIE_LAB:7},PlanarConfiguration:{CHUNKY:1,PLANAR:2},ResolutionUnit:{NONE:1,INCH:2,CENTIMETER:3},SampleFormat:{UNSIGNED:1,SIGNED:2,IEEE_FLOAT:3,UNDEFINED:4,DEFAULT:1},Type:{BYTE:1,ASCII:2,SHORT:3,LONG:4,RATIONAL:5,SBYTE:6,UNDEFINED:7,SSHORT:8,SLONG:9,SRATIONAL:10,FLOAT:11,DOUBLE:12}};return t}),i("../src/worldwind/formats/geotiff/GeoTiffUtil",["../../error/ArgumentError","../../util/Logger","./TiffConstants"],function(t,e,r){"use strict";var i={getBytes:function(r,i,n,o,a){if(0>=n)throw new t(e.logMessage(e.LEVEL_SEVERE,"GeoTiffReader","getBytes","noBytesRequested"));if(1>=n)return a?r.getInt8(i,o):r.getUint8(i,o);if(2>=n)return a?r.getInt16(i,o):r.getUint16(i,o);if(3>=n)return a?r.getInt32(i,o)>>>8:r.getUint32(i,o)>>>8;if(4>=n)return a?r.getInt32(i,o):r.getUint32(i,o);if(8>=n)return r.getFloat64(i,o);throw new t(e.logMessage(e.LEVEL_SEVERE,"GeoTiffReader","getBytes","tooManyBytesRequested"))},getSampleBytes:function(t,i,n,o,a){var s;switch(o){case r.SampleFormat.UNSIGNED:s=this.getBytes(t,i,n,a,!1);break;case r.SampleFormat.SIGNED:s=this.getBytes(t,i,n,a,!0);break;case r.SampleFormat.IEEE_FLOAT:3==n?s=t.getFloat32(i,a)>>>8:4==n?s=t.getFloat32(i,a):8==n?s=t.getFloat64(i,a):e.log(e.LEVEL_WARNING,"Do not attempt to parse the data  not handled: "+n);break;case r.SampleFormat.UNDEFINED:default:s=this.getBytes(t,i,n,a,!1)}return s},canvasToTiffImage:function(t){var e=new Image;return e.src=t.toDataURL(),e},getRGBAFillValue:function(t,e,r,i){return"undefined"==typeof i&&(i=1),"rgba("+t+", "+e+", "+r+", "+i+")"},getTagValueAsString:function(t,e){for(var r in t)if(t[r]===e)return r},clampColorSample:function(t,e){var r=Math.pow(2,8-e);return Math.floor(t*r+(r-1))},clampColorSampleForElevation:function(t,e,r){var i=255/(r-e);return Math.round(i*(t-e))},getMinMaxGeotiffSamples:function(t,e){for(var r=1/0,i=-(1/0),n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++)for(var a=0;a<t[n][o].length;a++)t[n][o][a]!=e&&(t[n][o][a]>i&&(i=t[n][o][a]),t[n][o][a]<r&&(r=t[n][o][a]));return{max:i,min:r}}};return i}),i("../src/worldwind/formats/geotiff/TiffIFDEntry",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffUtil","../../util/Logger","./TiffConstants"],function(t,e,r,i,n){"use strict";var o=function(t,r,n,o,a,s){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingTag"));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingType"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingCount"));if(null===o||void 0===o)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingValueOffset"));if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingGeoTiffData"));if(null===s||void 0===s)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingIsLittleEndian"));this._tag=t,this._type=r,this._count=n,this._valueOffset=o,this._geoTiffData=a,this._isLittleEndian=s};return Object.defineProperties(o.prototype,{tag:{get:function(){return this._tag}},type:{get:function(){return this._type}},count:{get:function(){return this._count}},valueOffset:{get:function(){return this._valueOffset}},geoTiffData:{get:function(){return this._geoTiffData}},isLittleEndian:{get:function(){return this._isLittleEndian}}}),o.prototype.getIFDTypeLength=function(){switch(this.type){case n.Type.BYTE:case n.Type.ASCII:case n.Type.SBYTE:case n.Type.UNDEFINED:return 1;case n.Type.SHORT:case n.Type.SSHORT:return 2;case n.Type.LONG:case n.Type.SLONG:case n.Type.FLOAT:return 4;case n.Type.RATIONAL:case n.Type.SRATIONAL:case n.Type.DOUBLE:return 8;default:return-1}},o.prototype.getIFDEntryValue=function(){var e=[],o=null,a=this.getIFDTypeLength(),s=a*this.count;if(4>=s)o=this.isLittleEndian===!1?this.valueOffset>>>8*(4-a):this.valueOffset,e.push(o);else for(var l=0;l<this.count;l++){var u=a*l;if(a>=8)if(this.type===n.Type.RATIONAL||this.type===n.Type.SRATIONAL)e.push(r.getBytes(this.geoTiffData,this.valueOffset+u,4,this.isLittleEndian)),e.push(r.getBytes(this.geoTiffData,this.valueOffset+u+4,4,this.isLittleEndian));else{if(this.type!==n.Type.DOUBLE)throw new t(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","parse","invalidTypeOfIFD"));e.push(r.getBytes(this.geoTiffData,this.valueOffset+u,8,this.isLittleEndian))}else e.push(r.getBytes(this.geoTiffData,this.valueOffset+u,a,this.isLittleEndian))}return this.type===n.Type.ASCII?(e.forEach(function(t,e,r){0===t?r.splice(e,1):r[e]=String.fromCharCode(t)}),e.join("")):e},o}),i("../src/worldwind/formats/geotiff/GeoTiffReader",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffConstants","./GeoTiffKeyEntry","./GeoTiffMetadata","./GeoTiffUtil","../../geom/Location","../../geom/Sector","../../util/Logger","../../util/proj4-src","./TiffConstants","./TiffIFDEntry","../../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c,h,f){"use strict";var d=function(t){if(!t)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","constructor","missingUrl"));this._url=t,this._isLittleEndian=!1,this._imageFileDirectories=[],this._geoTiffData=null,this._metadata=new n};return Object.defineProperties(d.prototype,{url:{get:function(){return this._url}},isLittleEndian:{get:function(){return this._isLittleEndian}},imageFileDirectories:{get:function(){return this._imageFileDirectories}},geoTiffData:{get:function(){return this._geoTiffData}},metadata:{get:function(){return this._metadata}}}),d.prototype.requestUrl=function(t,e){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var i=r.response;i&&(this.parse(i),e())}else l.log(l.LEVEL_WARNING,"GeoTiff retrieval failed ("+r.statusText+"): "+t);
}.bind(this),r.onerror=function(){l.log(l.LEVEL_WARNING,"GeoTiff retrieval failed: "+t)},r.ontimeout=function(){l.log(l.LEVEL_WARNING,"GeoTiff retrieval timed out: "+t)},r.send(null)},d.prototype.parse=function(e){if(this._geoTiffData=new DataView(e),this.getEndianness(),!this.isTiffFileType())throw new t(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","parse","invalidTiffFileType"));var r=o.getBytes(this.geoTiffData,4,4,this.isLittleEndian);this.parseImageFileDirectory(r),this.getMetadataFromImageFileDirectory(),this.parseGeoKeys(),this.setBBox()},d.prototype.getEndianness=function(){var e=o.getBytes(this.geoTiffData,0,2,this.isLittleEndian);if(18761===e)this._isLittleEndian=!0;else{if(19789!==e)throw new t(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","getEndianness","invalidByteOrderValue"));this._isLittleEndian=!1}},d.prototype.isTiffFileType=function(){var t=o.getBytes(this.geoTiffData,2,2,this.isLittleEndian);return 42===t?!0:!1},d.prototype.isGeoTiff=function(){return this.getIFDByTag(r.Tag.GEO_KEY_DIRECTORY)?!0:!1},d.prototype.readAsImage=function(t){this.requestUrl(this.url,function(){var e=this.metadata.bitsPerSample,r=this.metadata.samplesPerPixel,i=this.metadata.photometricInterpretation,n=this.metadata.imageLength,o=this.metadata.imageWidth;if(this.metadata.colorMap)var a=this.metadata.colorMap,s=Math.pow(2,e[0]);var l=document.createElement("canvas");l.width=o,l.height=n;var u=l.getContext("2d");if(this.metadata.stripOffsets){var c=this.parseStrips(!1);if(this.metadata.rowsPerStrip)var h=this.metadata.rowsPerStrip;else var h=n;for(var f=c.length,d=0,p=h,m=n%h,g=0===m?h:m,y=0;f>y;y++){y+1===f&&(p=g);for(var v=c[y].length,E=d*y,w=0,b=0;v>b;w++)for(var x=0;o>x;x++,b++){var _=c[y][b];u.fillStyle=this.getFillStyle(_,i,e,r,a,s),u.fillRect(x,E+w,1,1)}d=h}}else if(this.metadata.tileOffsets)for(var S=this.parseTiles(!1),T=this.metadata.tileWidth,L=this.metadata.tileLength,M=Math.ceil(o/T),w=0;n>w;w++)for(var x=0;o>x;x++){var A=Math.floor(x/T),N=Math.floor(w/L),R=N*M+A,C=x%T,P=w%L,O=P*T+C,_=S[R][O];u.fillStyle=this.getFillStyle(_,i,e,r,a,s),u.fillRect(x,w,1,1)}this._geoTiffData=null,t(l)}.bind(this))},d.prototype.getFillStyle=function(t,e,r,i,n,a){var s=0,u=0,h=0,f=1;switch(this.metadata.noData&&t[0]==this.metadata.noData&&(f=0),e){case c.PhotometricInterpretation.WHITE_IS_ZERO:var d=Math.pow(2,r)-1;t[0]=d-t[0];case c.PhotometricInterpretation.BLACK_IS_ZERO:s=u=h=o.clampColorSample(t[0],r[0]);break;case c.PhotometricInterpretation.RGB:if(s=o.clampColorSample(t[0],r[0]),u=o.clampColorSample(t[1],r[1]),h=o.clampColorSample(t[2],r[2]),4===i&&2===this.metadata.extraSamples[0]){var p=Math.pow(2,r[3]);f=t[3]/p}break;case c.PhotometricInterpretation.RGB_PALETTE:if(n){var m=t[0];s=o.clampColorSample(n[m],16),u=o.clampColorSample(n[a+m],16),h=o.clampColorSample(n[2*a+m],16)}break;case c.PhotometricInterpretation.TRANSPARENCY_MASK:l.log(l.LEVEL_WARNING,"Photometric interpretation not yet implemented: TRANSPARENCY_MASK");break;case c.PhotometricInterpretation.CMYK:l.log(l.LEVEL_WARNING,"Photometric interpretation not yet implemented: CMYK");break;case c.PhotometricInterpretation.Y_Cb_Cr:l.log(l.LEVEL_WARNING,"Photometric interpretation not yet implemented: Y_Cb_Cr");break;case c.PhotometricInterpretation.CIE_LAB:l.log(l.LEVEL_WARNING,"Photometric interpretation not yet implemented: CIE_LAB");break;default:l.log("Unknown photometric interpretation: "+e)}return o.getRGBAFillValue(s,u,h,f)},d.prototype.createTypedElevationArray=function(){var t,e=[],r=this.metadata.bitsPerSample[0];if(this.metadata.stripOffsets)for(var i=this.parseStrips(!0),n=0;n<i.length;n++)e=e.concat(i[n]);else if(this.metadata.tileOffsets)for(var o=this.parseTiles(!0),a=this.metadata.imageWidth,s=this.metadata.imageLength,l=this.metadata.tileWidth,u=this.metadata.tileLength,h=Math.ceil(a/l),f=0;s>f;f++)for(var d=0;a>d;d++){var p=Math.floor(d/l),m=Math.floor(f/u),g=m*h+p,y=d%l,v=f%u,E=v*l+y,w=o[g][E];e.push(w)}if(this.metadata.sampleFormat)var b=this.metadata.sampleFormat[0];else var b=c.SampleFormat.UNSIGNED;switch(r){case 8:t=b===c.SampleFormat.SIGNED?new Int8Array(e):new Uint8Array(e);break;case 16:t=b===c.SampleFormat.SIGNED?new Int16Array(e):new Uint16Array(e);break;case 32:t=b===c.SampleFormat.SIGNED?new Int32Array(e):b===c.SampleFormat.IEEE_FLOAT?new Float32Array(e):new Uint32Array(e);break;case 64:t=new Float64Array(e)}return t},d.prototype.readAsData=function(t){this.requestUrl(this.url,function(){t(this.createTypedElevationArray())}.bind(this))},d.prototype.parseStrips=function(t){var e=this.metadata.samplesPerPixel,r=this.metadata.bitsPerSample,i=this.metadata.stripOffsets,n=this.metadata.stripByteCounts,o=this.metadata.compression;if(this.metadata.sampleFormat)var a=this.metadata.sampleFormat;else var a=c.SampleFormat.UNSIGNED;for(var s=e*r[0],l=s/8,u=[],h=0;h<i.length;h++){var f=i[h],d=n[h];u[h]=this.parseBlock(t,o,l,d,f,r,a)}return u},d.prototype.parseBlock=function(t,e,r,i,n,a,s){var u=[];switch(e){case c.Compression.UNCOMPRESSED:for(var h=0,f=r;i>h;h+=f){for(var d=0,p=[];d<a.length;d++){var m=a[d]/8,g=d*m;p.push(o.getSampleBytes(this.geoTiffData,n+h+g,m,s[d],this.isLittleEndian))}t?u.push(p[0]):u.push(p)}break;case c.Compression.CCITT_1D:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: CCITT_1D");break;case c.Compression.GROUP_3_FAX:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: GROUP_3_FAX");break;case c.Compression.GROUP_4_FAX:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: GROUP_4_FAX");break;case c.Compression.LZW:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: LZW");break;case c.Compression.JPEG:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: JPEG");break;case c.Compression.PACK_BITS:if(this.metadata.tileOffsets)var y=this.metadata.tileWidth,v=this.metadata.tileWidth,E=new ArrayBuffer(y*v*r);else var w=this.metadata.rowsPerStrip,b=this.metadata.imageWidth,E=new ArrayBuffer(w*b*r);for(var x=new DataView(E),_=!0,p=[],S=0,T=0,L=0,h=0;i>h;h+=1)if(_){S=1,T=1,_=!1;var M=this.geoTiffData.getInt8(n+h,this.isLittleEndian);M>=0&&127>=M?S=M+1:M>=-127&&-1>=M?T=-M+1:_=!0}else{for(var A=o.getBytes(this.geoTiffData,n+h,1,this.isLittleEndian),N=0;T>N;N++)x.setInt8(L,A),L++;S--,0===S&&(_=!0)}for(var h=0,f=r;h<E.byteLength;h+=f){for(var d=0,p=[];d<a.length;d++){var m=a[d]/8,g=d*m;p.push(o.getSampleBytes(x,h+g,m,s[d],this.isLittleEndian))}t?u.push(p[0]):u.push(p)}}return u},d.prototype.parseTiles=function(t){var e=this.metadata.samplesPerPixel,r=this.metadata.bitsPerSample,i=this.metadata.compression;if(this.metadata.sampleFormat)var n=this.metadata.sampleFormat;else{var n=new Array(e);f.fillArray(n,c.SampleFormat.UNSIGNED)}for(var o=e*r[0],a=o/8,s=this.metadata.tileWidth,l=this.metadata.tileLength,u=this.metadata.tileOffsets,h=this.metadata.tileByteCounts,d=this.metadata.imageLength,p=this.metadata.imageWidth,m=Math.ceil(p/s),g=Math.ceil(d/l),y=[],v=0;g>v;v++)for(var E=0;m>E;E++){var w=m*v+E,b=u[w],x=h[w];y[w]=this.parseBlock(t,i,a,x,b,r,n)}return y},d.prototype.geoTiffImageToPCS=function(t,r){if(null===t||void 0===t)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","geoTiffImageToPCS","missingXValue"));if(null===r||void 0===r)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","geoTiffImageToPCS","missingYValue"));var i=[t,r],n=this.metadata.modelTiepoint,o=this.metadata.modelPixelScale,s=this.metadata.modelTransformation,c=n?n.length:0,h=o?o.length:0,f=s?s.length:0;if(c>6&&0===h);else if(16===f){var d=t,p=r;t=d*s[0]+p*s[1]+s[3],r=d*s[4]+p*s[5]+s[7],i=[t,r]}else 3>h||6>c?i=[t,r]:(t=(t-n[0])*o[0]+n[3],r=(r-n[1])*(-1*o[1])+n[4],i=[t,r]);return u.defs([["EPSG:26771","+proj=tmerc +lat_0=36.66666666666666 +lon_0=-88.33333333333333 +k=0.9999749999999999 +x_0=152400.3048006096 +y_0=0 +ellps=clrk66 +datum=NAD27 +to_meter=0.3048006096012192 +no_defs "],["EPSG:32633","+proj=utm +zone=33 +datum=WGS84 +units=m +no_defs"]]),this.metadata.projectedCSType&&(i=u("EPSG:"+this.metadata.projectedCSType,"EPSG:4326",i)),new a(i[1],i[0])},d.prototype.setBBox=function(){var t=this.geoTiffImageToPCS(0,0),e=this.geoTiffImageToPCS(this.metadata.imageWidth,0),r=this.geoTiffImageToPCS(0,this.metadata.imageLength);this.geoTiffImageToPCS(this.metadata.imageWidth,this.metadata.imageLength);this.metadata.bbox=new s(r.latitude,t.latitude,t.longitude,e.longitude)},d.prototype.getMetadataFromImageFileDirectory=function(){for(var t=0;t<this.imageFileDirectories[0].length;t++)switch(this.imageFileDirectories[0][t].tag){case c.Tag.BITS_PER_SAMPLE:this.metadata.bitsPerSample=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.COLOR_MAP:this.metadata.colorMap=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.COMPRESSION:this.metadata.compression=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.EXTRA_SAMPLES:this.metadata.extraSamples=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.IMAGE_LENGTH:this.metadata.imageLength=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.IMAGE_WIDTH:this.metadata.imageWidth=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.MAX_SAMPLE_VALUE:this.metadata.maxSampleValue=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.MIN_SAMPLE_VALUE:this.metadata.minSampleValue=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.ORIENTATION:this.metadata.orientation=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.PHOTOMETRIC_INTERPRETATION:this.metadata.photometricInterpretation=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.PLANAR_CONFIGURATION:this.metadata.planarConfiguration=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.ROWS_PER_STRIP:this.metadata.rowsPerStrip=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.RESOLUTION_UNIT:this.metadata.resolutionUnit=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.SAMPLES_PER_PIXEL:this.metadata.samplesPerPixel=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.SAMPLE_FORMAT:this.metadata.sampleFormat=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.SOFTWARE:this.metadata.software=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.STRIP_BYTE_COUNTS:this.metadata.stripByteCounts=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.STRIP_OFFSETS:this.metadata.stripOffsets=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.TILE_BYTE_COUNTS:this.metadata.tileByteCounts=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.TILE_OFFSETS:this.metadata.tileOffsets=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.TILE_LENGTH:this.metadata.tileLength=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.TILE_WIDTH:this.metadata.tileWidth=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.X_RESOLUTION:this.metadata.xResolution=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.Y_RESOLUTION:this.metadata.tileWidth=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.GEO_ASCII_PARAMS:this.metadata.geoAsciiParams=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.GEO_DOUBLE_PARAMS:this.metadata.geoDubleParams=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.GEO_KEY_DIRECTORY:this.metadata.geoKeyDirectory=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.MODEL_PIXEL_SCALE:this.metadata.modelPixelScale=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.MODEL_TIEPOINT:this.metadata.modelTiepoint=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.GDAL_NODATA:this.metadata.noData=this.imageFileDirectories[0][t].getIFDEntryValue();break;default:l.log(l.LEVEL_WARNING,"Ignored GeoTiff tag: "+this.imageFileDirectories[0][t].tag)}},d.prototype.getMetadataFromGeoKeys=function(){for(var t=0;t<this.geoKeys.length;t++){var e=o.getTagValueAsString(r.Key,this.geoKeys[t].keyId);e?this._metadata.geotiff.geoKeys[e]=this.geoKeys[t].getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams):l.log(l.LEVEL_WARNING,"Unknown GeoTiff key: "+this.geoKeys[t].keyId)}},d.prototype.parseGeoKeys=function(){if(!this.isGeoTiff())throw new t(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","parse","invalidGeoTiffFile"));var e=this.metadata.geoKeyDirectory;if(!e)throw new t(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","parseGeoKeys","missingGeoKeyDirectoryTag"));for(var n=(e[0],e[1],e[2],e[3]),o=0;n>o;o++){var a=e[4+4*o],s=e[5+4*o],u=e[6+4*o],c=e[7+4*o];switch(a){case r.Key.GTModelTypeGeoKey:this.metadata.gtModelTypeGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GTRasterTypeGeoKey:this.metadata.gtRasterTypeGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GTCitationGeoKey:this.metadata.gtCitationGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeographicTypeGeoKey:this.metadata.geographicTypeGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogCitationGeoKey:this.metadata.geogCitationGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogAngularUnitsGeoKey:this.metadata.geogAngularUnitsGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogAngularUnitSizeGeoKey:this.metadata.geogAngularUnitSizeGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogSemiMajorAxisGeoKey:this.metadata.geogSemiMajorAxisGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogInvFlatteningGeoKey:this.metadata.geogInvFlatteningGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.ProjectedCSTypeGeoKey:this.metadata.projectedCSType=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;default:l.log(l.LEVEL_WARNING,"Ignored GeoTiff key: "+a)}}},d.prototype.parseImageFileDirectory=function(t){if(!t)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","parseImageFileDirectory","missingOffset"));for(var r=o.getBytes(this.geoTiffData,t,2,this.isLittleEndian),i=[],n=t+2,a=0;r>a;n+=12,a++){var s=o.getBytes(this.geoTiffData,n,2,this.isLittleEndian),u=o.getBytes(this.geoTiffData,n+2,2,this.isLittleEndian),c=o.getBytes(this.geoTiffData,n+4,4,this.isLittleEndian),f=o.getBytes(this.geoTiffData,n+8,4,this.isLittleEndian);i.push(new h(s,u,c,f,this.geoTiffData,this.isLittleEndian))}this._imageFileDirectories.push(i);var d=o.getBytes(this.geoTiffData,n,4,this.isLittleEndian);0!==d&&this.parseImageFileDirectory(d)},d.prototype.getIFDByTag=function(t){if(!t)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","getIFDByTag","missingTag"));for(var r=0;r<this.imageFileDirectories[0].length;r++)if(this.imageFileDirectories[0][r].tag===t)return this.imageFileDirectories[0][r];return null},d}),i("../src/worldwind/projections/ProjectionEquirectangular",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Vec3"],function(t,e,r,i,n){"use strict";var o=function(){r.call(this,"Equirectangular",!0,null)};return o.prototype=Object.create(r.prototype),Object.defineProperties(o.prototype,{stateKey:{get:function(){return"projection equirectangular "}}}),o.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesian","missingResult"));return l[0]=r.equatorialRadius*o*t.DEGREES_TO_RADIANS+(s?s[0]:0),l[1]=r.equatorialRadius*n*t.DEGREES_TO_RADIANS,l[2]=a,l},o.prototype.geographicToCartesianGrid=function(r,o,a,s,l,u,c,h){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingGlobe"));if(!o)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingSector"));if(!l||l.length<a*s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!h)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingResult"));var f,d,p,m,g,y=r.equatorialRadius,v=o.minLatitude*t.DEGREES_TO_RADIANS,E=o.maxLatitude*t.DEGREES_TO_RADIANS,w=o.minLongitude*t.DEGREES_TO_RADIANS,b=o.maxLongitude*t.DEGREES_TO_RADIANS,x=(E-v)/(a>1?a-1:1),_=(b-w)/(s>1?s-1:1),S=u?u:new n(0,0,0),T=c?c[0]:0,L=0,M=0;for(f=0,p=v;a>f;f++,p+=x)for(f===a-1&&(p=E),g=y*p-S[1],d=0,m=w;s>d;d++,m+=_)d===s-1&&(m=b),h[M++]=y*m-S[0]+T,h[M++]=g,h[M++]=l[L++]-S[2];return h},o.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","cartesianToGeographic","missingResult"));return l.latitude=o/r.equatorialRadius*t.RADIANS_TO_DEGREES,l.longitude=(n-(s?s[0]:0))/r.equatorialRadius*t.RADIANS_TO_DEGREES,l.altitude=a,l},o}),i("../src/worldwind/globe/ZeroElevationModel",["../error/ArgumentError","../globe/ElevationModel","../geom/Location","../util/Logger","../geom/Sector"],function(t,e,r,i,n){"use strict";var o=function(){e.call(this,n.FULL_SPHERE,new r(45,45),1," "," ",150,150),this.displayName="Zero Elevations",this.timestamp=Date.now(),this.minElevation=0,this.maxElevation=0};return o.prototype=Object.create(e.prototype),o.prototype.minAndMaxElevationsForSector=function(t){return[0,0]},o.prototype.elevationAtLocation=function(t,e){return 0},o.prototype.elevationsForGrid=function(e,r,n,o,a){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"ZeroElevationModel","elevationsForSector","missingSector"));if(0>=r||0>=n)throw new t(i.logMessage(i.LEVEL_SEVERE,"ZeroElevationModel","elevationsForSector","numLat or numLon is less than 1"));if(!a||a.length<r*n)throw new t(i.logMessage(i.LEVEL_SEVERE,"ZeroElevationModel","elevationsForSector","missingArray"));for(var s=0,l=a.length;l>s;s++)a[s]=0;return 0},o}),i("../src/worldwind/globe/Globe2D",["../globe/Globe","../projections/ProjectionEquirectangular","../globe/ZeroElevationModel"],function(t,e,r){"use strict";var i=function(){t.call(this,new r,new e)};return i.prototype=Object.create(t.prototype),i}),i("../src/worldwind/util/GoToAnimator",["../geom/Location","../util/Logger","../navigate/LookAt","../geom/Position","../geom/Vec3"],function(t,e,r,i,n){"use strict";var o=function(t){if(!t)throw new ArgumentError(e.logMessage(e.LEVEL_SEVERE,"GoToAnimator","constructor","missingWorldWindow"));this.wwd=t,this.animationFrequency=20,this.travelTime=3e3,this.cancelled=!1};return o.prototype.cancel=function(){this.cancelled=!0},o.prototype.goTo=function(o,a){if(!o)throw new ArgumentError(e.logMessage(e.LEVEL_SEVERE,"GoToAnimator","goTo","missingPosition"));var s=new r;this.wwd.navigator.getAsLookAt(this.wwd.globe,s),this.completionCallback=a,this.cancelled=!1,this.targetPosition=new i(o.latitude,o.longitude,o.altitude||s.range),this.startPosition=new i(s.latitude,s.longitude,s.range),this.startTime=Date.now();var l,u=this.travelTime,c=t.greatCircleDistance(this.startPosition,this.targetPosition),h=this.wwd.globe.computePointFromLocation(this.startPosition.latitude,this.startPosition.longitude,new n(0,0,0)),f=this.wwd.globe.computePointFromLocation(this.targetPosition.latitude,this.targetPosition.longitude,new n(0,0,0));this.maxAltitude=h.distanceTo(f);var d=this.wwd.navigator.currentState().pixelSizeAtDistance(this.startPosition.altitude)*this.wwd.canvas.clientWidth/this.wwd.globe.equatorialRadius;2*d>=c&&(this.maxAltitude=this.startPosition.altitude),this.maxAltitudeReachedTime=this.maxAltitude<=s.range?Date.now():null,this.maxAltitude>this.startPosition.altitude?(l=Math.max(0,this.maxAltitude-this.startPosition.altitude),l+=Math.abs(this.targetPosition.altitude-this.maxAltitude)):l=Math.abs(this.targetPosition.altitude-this.startPosition.altitude);var p=Math.max(c,l/this.wwd.globe.equatorialRadius);if(0!==p){2*d>p&&(u=Math.min(p/d*this.travelTime,this.travelTime)),u=Math.max(1,u),this.panVelocity=c/u,this.rangeVelocity=l/u;var m=this,g=function(){return m.cancelled?void(m.completionCallback&&m.completionCallback(m)):void(m.update()?setTimeout(g,m.animationFrequency):m.completionCallback&&m.completionCallback(m))};setTimeout(g,this.animationFrequency)}},o.prototype.update=function(){var t=new r;this.wwd.navigator.getAsLookAt(this.wwd.globe,t);var e=new i(t.latitude,t.longitude,t.range),n=this.updateRange(e);return n=this.updateLocation(e)||n,this.wwd.redraw(),n},o.prototype.updateRange=function(t){var e,i,n=!1,o=new r;return this.wwd.navigator.getAsLookAt(this.wwd.globe,o),this.maxAltitudeReachedTime?(i=Date.now()-this.maxAltitudeReachedTime,this.maxAltitude>this.targetPosition.altitude?(e=this.maxAltitude-this.rangeVelocity*i,e=Math.max(e,this.targetPosition.altitude)):(e=this.maxAltitude+this.rangeVelocity*i,e=Math.min(e,this.targetPosition.altitude)),o.range=e,this.wwd.navigator.setAsLookAt(this.wwd.globe,o),n=Math.abs(o.range-this.targetPosition.altitude)>1):(i=Date.now()-this.startTime,e=Math.min(this.startPosition.altitude+this.rangeVelocity*i,this.maxAltitude),Math.abs(o.range-e)<1&&(this.maxAltitudeReachedTime=Date.now()),o.range=e,this.wwd.navigator.setAsLookAt(this.wwd.globe,o),n=!0),n},o.prototype.updateLocation=function(e){var i=Date.now()-this.startTime,n=t.greatCircleDistance(this.startPosition,e),o=t.greatCircleDistance(e,this.targetPosition),a=t.greatCircleAzimuth(e,this.targetPosition),s=this.panVelocity*i,l=Math.min(s-n,o),u=t.greatCircleLocation(e,a,l,new t(0,0)),c=!1,h=new r;return this.wwd.navigator.getAsLookAt(this.wwd.globe,h),h.latitude=u.latitude,h.longitude=u.longitude,this.wwd.navigator.setAsLookAt(this.wwd.globe,h),l<1/this.wwd.globe.equatorialRadius&&(c=!0),!c},o}),i("../src/worldwind/util/HighlightController",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"HighlightController","constructor","missingWorldWindow"));this.worldWindow=r;var i=[],n=function(t){for(var e=t.clientX,n=t.clientY,o=i.length>0,a=0;a<i.length;a++)i[a].highlighted=!1;i=[];var s=r.pick(r.canvasCoordinates(e,n));if(s.objects.length>0&&(o=!0),s.objects.length>0)for(var l=0;l<s.objects.length;l++)s.objects[l].isTerrain||(s.objects[l].userObject.highlighted=!0,i.push(s.objects[l].userObject));o&&r.redraw()};this.worldWindow.addEventListener("mousemove",n);new WorldWind.TapRecognizer(this.worldWindow,n)};return r}),i("../src/worldwind/formats/kml/KmlElements",[],function(){"use strict";var t={keys:{},addKey:function(t,e){this.keys[t]=e},getKey:function(t){return this.keys[t]}};return t}),i("../src/worldwind/formats/kml/util/Attribute",[],function(){"use strict";var t=function(t,e){this.node=t,this.name=e};return t.prototype.value=function(){return this.node.attributes&&this.node.attributes.getNamedItem(this.name)&&this.node.attributes.getNamedItem(this.name).value||null},t.prototype.exists=function(){return null!=this.value()},t.prototype.save=function(t){this.node.setAttribute(this.name,t)},t}),i("../src/worldwind/formats/kml/util/NodeTransformers",["./Attribute","../KmlElements","../../../geom/Position","../../../util/WWUtil"],function(t,e,r,i){function n(t){var e;return null!=t&&t.childNodes[0]?e=t.childNodes[0].nodeValue:null!=t&&(e=""),e}var o=function(){};return o.string=function(t){return String(n(t))},o.number=function(t){return Number(n(t))},o["boolean"]=function(t){return i.transformToBoolean(n(t))},o.date=function(t){return i.date(n(t))},o.kmlObject=function(t,r,i){var n=t.nodeName,o=e.getKey(n);return o?new o({objectNode:t,parent:r,controls:i}):null},o.linearRing=function(t,r,i){var n=e.getKey("LinearRing");if(!n)return null;var o=null;return Array.prototype.forEach.call(t.childNodes,function(t){t.nodeName.toUpperCase()=="LinearRing".toUpperCase()&&(o=t)}),new n({objectNode:o,parent:r,controls:i})},o.positions=function(t){var e=[],i=n(t).trim().replace(/\s+/g," ").split(" ");return i.forEach(function(t){t=t.split(","),e.push(new r(Number(t[1]),Number(t[0]),Number(t[2]||0)))}),e},o.attribute=function(e){return function(r){return new t(r,e).value()}},o}),i("../src/worldwind/formats/kml/util/KmlElementsFactory",["./NodeTransformers"],function(t){"use strict";var e=function(t){this.options=t||{},this.options.controls=this.options.controls||[]};e.prototype.specific=function(t,e){var r=t.node,i=null,n=this;return[].forEach.call(r.childNodes,function(r){r.nodeName==e.name&&(i=e.transformer(r,t,n.options.controls))}),i},e.prototype.any=function(e,r){var i=e.node,n=null,o=this;return[].forEach.call(i.childNodes,function(i){-1!=r.name.indexOf(i.nodeName)&&(n=t.kmlObject(i,e,o.options.controls))}),n},e.prototype.all=function(e){var r=e.node,i=[],n=this;return[].forEach.call(r.childNodes,function(r){var o=t.kmlObject(r,e,n.options.controls);o&&i.push(o)}),i};var r=new e;return e.applicationWide=function(){return r},e}),i("../src/worldwind/formats/kml/util/TreeKeyValueCache",["../../../util/WWUtil"],function(t){"use strict";var e=function(){this.map={}};e.prototype.add=function(t,e,r){this.map[t]||(this.map[t]={}),this.map[t][e]=r},e.prototype.value=function(e,r){if(!this.map[e])return null;if(-1==r.indexOf("#")){var i=this.level(e);for(var n in i)if(i.hasOwnProperty(n)&&t.startsWith(n,r))return i[n]}return this.map[e][r]||null},e.prototype.level=function(t){return this.map[t]},e.prototype.remove=function(t,e){delete this.map[t][e]};var r=new e;return e.applicationLevelCache=function(){return r},e}),i("../src/worldwind/formats/kml/util/KmlElementsFactoryCached",["./Attribute","./KmlElementsFactory","./TreeKeyValueCache","../../../util/WWUtil"],function(t,e,r,i){"use strict";var n=function(t){this.internalFactory=new e(t),this.cache=r.applicationLevelCache()};n.prototype.all=function(t){var e=t.node,r=this.cache.level(this.cacheKey(t.node,"All"));if(r){var i=[];for(var n in r)r.hasOwnProperty(n)&&i.push(r[n]);return i}var o=this.internalFactory.all(t);if(o&&o.length){var a=this;o.forEach(function(t){a.cache.add(a.cacheKey(e,"All"),a.cacheKey(t.node),t)})}return o},n.prototype.specific=function(t,e){var r=t.node,i=e.name;e.attribute&&(i=e.attribute+i);var n=this.cache.value(this.cacheKey(r),i);if(n)return n;var o=this.internalFactory.specific(t,e);return o&&o.node?this.cache.add(this.cacheKey(r),this.cacheKey(o.node),o):o&&this.cache.add(this.cacheKey(r),i,o),o},n.prototype.any=function(t,e){var r,i=t.node,n=this,o=null;if(e.name.forEach(function(t){r=n.cache.value(n.cacheKey(i),t),r&&(o=r)}),o)return o;var a=this.internalFactory.any(t,e);return a&&this.cache.add(n.cacheKey(i),n.cacheKey(a.node),a),a},n.prototype.cacheKey=function(e,r){var n=new t(e,"id");n.exists()||n.save(i.guid());var o=e.nodeName+"#"+n.value();return r&&(o=r+o),o};var o=new n;return n.applicationWide=function(){return o},n}),function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){return"object"==typeof t&&null!==t}function o(t){j=t}function a(t){H=t}function s(){return function(){process.nextTick(f)}}function l(){return function(){U(f)}}function u(){var t=0,e=new X(f),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}function c(){var t=new MessageChannel;return t.port1.onmessage=f,function(){t.port2.postMessage(0)}}function h(){return function(){setTimeout(f,1)}}function f(){for(var t=0;q>t;t+=2){var e=Q[t],r=Q[t+1];e(r),Q[t]=void 0,Q[t+1]=void 0}q=0}function d(){try{var t=r,e=t("vertx");return U=e.runOnLoop||e.runOnContext,l()}catch(i){return h()}}function p(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function y(t){try{return t.then}catch(e){return it.error=e,it}}function v(t,e,r,i){try{t.call(e,r,i)}catch(n){return n}}function E(t,e,r){H(function(t){var i=!1,n=v(r,e,function(r){i||(i=!0,e!==r?x(t,r):S(t,r))},function(e){i||(i=!0,T(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&n&&(i=!0,T(t,n))},t)}function w(t,e){e._state===et?S(t,e._result):e._state===rt?T(t,e._result):L(e,void 0,function(e){x(t,e)},function(e){T(t,e)})}function b(t,r){if(r.constructor===t.constructor)w(t,r);else{var i=y(r);i===it?T(t,it.error):void 0===i?S(t,r):e(i)?E(t,r,i):S(t,r)}}function x(e,r){e===r?T(e,m()):t(r)?b(e,r):S(e,r)}function _(t){t._onerror&&t._onerror(t._result),M(t)}function S(t,e){t._state===tt&&(t._result=e,t._state=et,0!==t._subscribers.length&&H(M,t))}function T(t,e){t._state===tt&&(t._state=rt,t._result=e,H(_,t))}function L(t,e,r,i){var n=t._subscribers,o=n.length;t._onerror=null,n[o]=e,n[o+et]=r,n[o+rt]=i,0===o&&t._state&&H(M,t)}function M(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var i,n,o=t._result,a=0;a<e.length;a+=3)i=e[a],n=e[a+r],i?R(r,i,n,o):n(o);t._subscribers.length=0}}function A(){this.error=null}function N(t,e){try{return t(e)}catch(r){return nt.error=r,nt}}function R(t,r,i,n){var o,a,s,l,u=e(i);if(u){if(o=N(i,n),o===nt?(l=!0,a=o.error,o=null):s=!0,r===o)return void T(r,g())}else o=n,s=!0;r._state!==tt||(u&&s?x(r,o):l?T(r,a):t===et?S(r,o):t===rt&&T(r,o))}function C(t,e){try{e(function(e){x(t,e)},function(e){T(t,e)})}catch(r){T(t,r)}}function P(t,e){var r=this;r._instanceConstructor=t,r.promise=new t(p),r._validateInput(e)?(r._input=e,r.length=e.length,r._remaining=e.length,r._init(),0===r.length?S(r.promise,r._result):(r.length=r.length||0,r._enumerate(),0===r._remaining&&S(r.promise,r._result))):T(r.promise,r._validationError())}function O(t){return new ot(this,t).promise}function I(t){function e(t){x(n,t)}function r(t){T(n,t)}var i=this,n=new i(p);if(!K(t))return T(n,new TypeError("You must pass an array to race.")),n;for(var o=t.length,a=0;n._state===tt&&o>a;a++)L(i.resolve(t[a]),void 0,e,r);return n}function k(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var r=new e(p);return x(r,t),r}function D(t){var e=this,r=new e(p);return T(r,t),r}function V(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function G(t){this._id=ct++,this._state=void 0,this._result=void 0,this._subscribers=[],p!==t&&(e(t)||V(),this instanceof G||F(),C(this,t))}function B(){var t;if("undefined"!=typeof pt)t=pt;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=t.Promise;(!r||"[object Promise]"!==Object.prototype.toString.call(r.resolve())||r.cast)&&(t.Promise=ht)}var W;W=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var U,j,z,K=W,q=0,H=({}.toString,function(t,e){Q[q]=t,Q[q+1]=e,q+=2,2===q&&(j?j(f):z())}),Y="undefined"!=typeof window?window:void 0,$=Y||{},X=$.MutationObserver||$.WebKitMutationObserver,J="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Z="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Q=new Array(1e3);z=J?s():X?u():Z?c():void 0===Y&&"function"==typeof r?d():h();var tt=void 0,et=1,rt=2,it=new A,nt=new A;P.prototype._validateInput=function(t){
return K(t)},P.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},P.prototype._init=function(){this._result=new Array(this.length)};var ot=P;P.prototype._enumerate=function(){for(var t=this,e=t.length,r=t.promise,i=t._input,n=0;r._state===tt&&e>n;n++)t._eachEntry(i[n],n)},P.prototype._eachEntry=function(t,e){var r=this,i=r._instanceConstructor;n(t)?t.constructor===i&&t._state!==tt?(t._onerror=null,r._settledAt(t._state,e,t._result)):r._willSettleAt(i.resolve(t),e):(r._remaining--,r._result[e]=t)},P.prototype._settledAt=function(t,e,r){var i=this,n=i.promise;n._state===tt&&(i._remaining--,t===rt?T(n,r):i._result[e]=r),0===i._remaining&&S(n,i._result)},P.prototype._willSettleAt=function(t,e){var r=this;L(t,void 0,function(t){r._settledAt(et,e,t)},function(t){r._settledAt(rt,e,t)})};var at=O,st=I,lt=k,ut=D,ct=0,ht=G;G.all=at,G.race=st,G.resolve=lt,G.reject=ut,G._setScheduler=o,G._setAsap=a,G._asap=H,G.prototype={constructor:G,then:function(t,e){var r=this,i=r._state;if(i===et&&!t||i===rt&&!e)return this;var n=new this.constructor(p),o=r._result;if(i){var a=arguments[i-1];H(function(){R(i,n,a,o)})}else L(r,n,t,e);return n},"catch":function(t){return this.then(null,t)}};var ft=B,dt={Promise:ht,polyfill:ft};"function"==typeof i&&i.amd?i("../src/worldwind/util/es6-promise",[],function(){return dt}):"undefined"!=typeof module&&module.exports?module.exports=dt:"undefined"!=typeof this&&(this.ES6Promise=dt);var pt={};ft()}.call(this),i("../src/worldwind/util/Promise",["./es6-promise"],function(t){"use strict";return window.Promise?window.Promise:t.Promise}),i("../src/worldwind/formats/kml/KmlObject",["../../error/ArgumentError","./util/Attribute","./KmlElements","./util/KmlElementsFactoryCached","../../util/Logger","../../util/Promise","../../render/Renderable"],function(t,e,r,i,n,o,a){"use strict";var s=function(e){if(a.call(this),e=e||{},!e.objectNode)throw new t(n.logMessage(n.LEVEL_SEVERE,"KmlObject","constructor","Passed node isn't defined."));this._node=e.objectNode,this._cache={},this._controls=e.controls||[],this._factory=new i({controls:this._controls}),this.hook(this._controls,e)};return s.prototype=Object.create(a.prototype),Object.defineProperties(s.prototype,{id:{get:function(){return new e(this.node,"id").value()}},node:{get:function(){return this._node}}}),s.prototype.hook=function(t,e){var r=this;t.forEach(function(t){t.hook(r,e)})},s.prototype.render=function(t){},s.prototype.getTagNames=function(){return[]},s}),i("../src/worldwind/formats/kml/util/ImagePyramid",["../KmlElements","../KmlObject","../util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlTileSize:{get:function(){return this._factory.specific(this,{name:"tileSize",transformer:r.number})}},kmlMaxWidth:{get:function(){return this._factory.specific(this,{name:"maxWidth",transformer:r.number})}},kmlMaxHeight:{get:function(){return this._factory.specific(this,{name:"maxHeight",transformer:r.number})}},kmlGridOrigin:{get:function(){return this._factory.specific(this,{name:"gridOrigin",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["ImagePyramid"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/util/ItemIcon",["./../KmlElements","../KmlObject","./NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlState:{get:function(){return this._factory.specific(this,{name:"state",transformer:r.string})}},kmlHref:{get:function(){return this._factory.specific(this,{name:"href",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["ItemIcon"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/KmlTimePrimitive",["./KmlObject"],function(t){"use strict";var e=function(e){t.call(this,e)};return e.prototype=Object.create(t.prototype),e.prototype.timeRange=function(){var t,e;return this.kmlBegin&&(e=t=this.kmlBegin.valueOf()),this.kmlEnd&&(e=this.kmlEnd.valueOf(),t||(t=e)),this.kmlWhen&&(e=t=this.kmlWhen.valueOf()),{from:t,to:e}},e.prototype.getTagNames=function(){return["TimeSpan","TimeStamp"]},e}),i("../src/worldwind/formats/kml/KmlAbstractView",["./KmlObject","./KmlElements","./KmlTimePrimitive"],function(t,e,r){"use strict";var i=function(e){t.call(this,e)};return i.prototype=Object.create(t.prototype),Object.defineProperties(i.prototype,{kmlTimePrimitive:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}}}),i.prototype.getTagNames=function(){return["Camera","LookAt"]},i}),i("../src/worldwind/formats/kml/styles/KmlSubStyle",["./../KmlObject"],function(t){"use strict";var e=function(e){t.call(this,e)};return e.prototype=Object.create(t.prototype),e.prototype.getTagNames=function(){return["LineStyle","PolyStyle","IconStyle","LabelStyle","BalloonStyle","ListStyle"]},e}),i("../src/worldwind/formats/kml/styles/KmlBalloonStyle",["../KmlElements","./KmlSubStyle","../util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlBgColor:{get:function(){return this._factory.specific(this,{name:"bgColor",transformer:r.string})}},kmlTextColor:{get:function(){return this._factory.specific(this,{name:"textColor",transformer:r.string})}},kmlText:{get:function(){return this._factory.specific(this,{name:"text",transformer:r.string})}},kmlDisplayMode:{get:function(){return this._factory.specific(this,{name:"displayMode",transformer:r.string})}}}),i.update=function(){},i.prototype.getTagNames=function(){return["BalloonStyle"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/KmlCamera",["./KmlElements","./KmlAbstractView","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:r.string})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:r.string})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:r.string})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:r.string})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:r.string})}},kmlRoll:{get:function(){return this._factory.specific(this,{name:"roll",transformer:r.string})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["Camera"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/styles/KmlColorStyle",["./KmlSubStyle","../util/NodeTransformers"],function(t,e){"use strict";var r=function(e){t.call(this,e)};return r.prototype=Object.create(t.prototype),Object.defineProperties(r.prototype,{kmlColor:{get:function(){return this._factory.specific(this,{name:"color",transformer:e.string})}},kmlColorMode:{get:function(){return this._factory.specific(this,{name:"colorMode",transformer:e.string})}}}),r.prototype.getTagNames=function(){return["LineStyle","PolyStyle","IconStyle","LabelStyle"]},r}),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof i&&i.amd)i("../src/worldwind/util/jszip",[],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.JSZip=t()}}(function(){return function t(e,i,n){function o(s,l){if(!i[s]){if(!e[s]){var u="function"==typeof r&&r;if(!l&&u)return u(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var r=e[s][1][t];return o(r?r:t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var a="function"==typeof r&&r,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,r){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(t,e){for(var r,n,o,a,s,l,u,c="",h=0;h<t.length;)r=t.charCodeAt(h++),n=t.charCodeAt(h++),o=t.charCodeAt(h++),a=r>>2,s=(3&r)<<4|n>>4,l=(15&n)<<2|o>>6,u=63&o,isNaN(n)?l=u=64:isNaN(o)&&(u=64),c=c+i.charAt(a)+i.charAt(s)+i.charAt(l)+i.charAt(u);return c},r.decode=function(t,e){var r,n,o,a,s,l,u,c="",h=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<t.length;)a=i.indexOf(t.charAt(h++)),s=i.indexOf(t.charAt(h++)),l=i.indexOf(t.charAt(h++)),u=i.indexOf(t.charAt(h++)),r=a<<2|s>>4,n=(15&s)<<4|l>>2,o=(3&l)<<6|u,c+=String.fromCharCode(r),64!=l&&(c+=String.fromCharCode(n)),64!=u&&(c+=String.fromCharCode(o));return c}},{}],2:[function(t,e,r){function i(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}i.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},e.exports=i},{}],3:[function(t,e,r){r.STORE={magic:"\x00\x00",compress:function(t,e){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},r.DEFLATE=t("./flate")},{"./flate":8}],4:[function(t,e,r){var i=t("./utils"),n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];e.exports=function(t,e){if("undefined"==typeof t||!t.length)return 0;var r="string"!==i.getTypeOf(t);"undefined"==typeof e&&(e=0);var o=0,a=0,s=0;e=-1^e;for(var l=0,u=t.length;u>l;l++)s=r?t[l]:t.charCodeAt(l),a=255&(e^s),o=n[a],e=e>>>8^o;return-1^e}},{"./utils":21}],5:[function(t,e,r){function i(t){this.data=null,this.length=0,this.index=0}var n=t("./utils");i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<t||0>t)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,r=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)r=(r<<8)+this.byteAt(e);return this.index+=t,r},readString:function(t){return n.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}},e.exports=i},{"./utils":21}],6:[function(t,e,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!1,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],7:[function(t,e,r){var i=t("./utils");r.string2binary=function(t){return i.string2binary(t)},r.string2Uint8Array=function(t){return i.transformTo("uint8array",t)},r.uint8Array2String=function(t){return i.transformTo("string",t)},r.string2Blob=function(t){var e=i.transformTo("arraybuffer",t);return i.arrayBuffer2Blob(e)},r.arrayBuffer2Blob=function(t){return i.arrayBuffer2Blob(t)},r.transformTo=function(t,e){return i.transformTo(t,e)},r.getTypeOf=function(t){return i.getTypeOf(t)},r.checkSupport=function(t){return i.checkSupport(t)},r.MAX_VALUE_16BITS=i.MAX_VALUE_16BITS,r.MAX_VALUE_32BITS=i.MAX_VALUE_32BITS,r.pretty=function(t){return i.pretty(t)},r.findCompression=function(t){return i.findCompression(t)},r.isRegExp=function(t){return i.isRegExp(t)}},{"./utils":21}],8:[function(t,e,r){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=t("pako");r.uncompressInputType=i?"uint8array":"array",r.compressInputType=i?"uint8array":"array",r.magic="\b\x00",r.compress=function(t,e){return n.deflateRaw(t,{level:e.level||-1})},r.uncompress=function(t){return n.inflateRaw(t)}},{pako:24}],9:[function(t,e,r){function i(t,e){return this instanceof i?(this.files={},this.comment=null,this.root="",t&&this.load(t,e),void(this.clone=function(){var t=new i;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t})):new i(t,e)}var n=t("./base64");i.prototype=t("./object"),i.prototype.load=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.utils=t("./deprecatedPublicUtils"),i.base64={encode:function(t){return n.encode(t)},decode:function(t){return n.decode(t)}},i.compressions=t("./compressions"),e.exports=i},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(t,e,r){var i=t("./base64"),n=t("./zipEntries");e.exports=function(t,e){var r,o,a,s;for(e=e||{},e.base64&&(t=i.decode(t)),o=new n(t,e),r=o.files,a=0;a<r.length;a++)s=r[a],this.file(s.fileName,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileComment.length?s.fileComment:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:e.createFolders});return o.zipComment.length&&(this.comment=o.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(t,e,r){(function(t){e.exports=function(e,r){return new t(e,r)},e.exports.test=function(e){return t.isBuffer(e)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(t,e,r){function i(t){this.data=t,this.length=this.data.length,this.index=0}var n=t("./uint8ArrayReader");i.prototype=new n,i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./uint8ArrayReader":18}],13:[function(t,e,r){var i=t("./support"),n=t("./utils"),o=t("./crc32"),a=t("./signature"),s=t("./defaults"),l=t("./base64"),u=t("./compressions"),c=t("./compressedObject"),h=t("./nodeBuffer"),f=t("./utf8"),d=t("./stringWriter"),p=t("./uint8ArrayWriter"),m=function(t){if(t._data instanceof c&&(t._data=t._data.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===n.getTypeOf(t._data))){var e=t._data;t._data=new Uint8Array(e.length),0!==e.length&&t._data.set(e,0)}return t._data},g=function(t){var e=m(t),r=n.getTypeOf(e);return"string"===r?!t.options.binary&&i.nodebuffer?h(e,"utf-8"):t.asBinary():e},y=function(t){var e=m(this);return null===e||"undefined"==typeof e?"":(this.options.base64&&(e=l.decode(e)),e=t&&this.options.binary?R.utf8decode(e):n.transformTo("string",e),t||this.options.binary||(e=n.transformTo("string",R.utf8encode(e))),e)},v=function(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this.options=r,this._initialMetadata={dir:r.dir,date:r.date}};v.prototype={asText:function(){return y.call(this,!0)},asBinary:function(){return y.call(this,!1)},asNodeBuffer:function(){var t=g(this);return n.transformTo("nodebuffer",t)},asUint8Array:function(){var t=g(this);return n.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var E=function(t,e){var r,i="";for(r=0;e>r;r++)i+=String.fromCharCode(255&t),t>>>=8;return i},w=function(){var t,e,r={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&"undefined"==typeof r[e]&&(r[e]=arguments[t][e]);return r},b=function(t){return t=t||{},t.base64!==!0||null!==t.binary&&void 0!==t.binary||(t.binary=!0),t=w(t,s),t.date=t.date||new Date,null!==t.compression&&(t.compression=t.compression.toUpperCase()),t},x=function(t,e,r){var i,o=n.getTypeOf(e);if(r=b(r),"string"==typeof r.unixPermissions&&(r.unixPermissions=parseInt(r.unixPermissions,8)),r.unixPermissions&&16384&r.unixPermissions&&(r.dir=!0),r.dosPermissions&&16&r.dosPermissions&&(r.dir=!0),r.dir&&(t=S(t)),r.createFolders&&(i=_(t))&&T.call(this,i,!0),r.dir||null===e||"undefined"==typeof e)r.base64=!1,r.binary=!1,e=null,o=null;else if("string"===o)r.binary&&!r.base64&&r.optimizedBinaryString!==!0&&(e=n.string2binary(e));else{if(r.base64=!1,r.binary=!0,!(o||e instanceof c))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===o&&(e=n.transformTo("uint8array",e))}var a=new v(t,e,r);return this.files[t]=a,a},_=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},S=function(t){return"/"!=t.slice(-1)&&(t+="/"),t},T=function(t,e){return e="undefined"!=typeof e?e:!1,t=S(t),this.files[t]||x.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]},L=function(t,e,r){var i,a=new c;return t._data instanceof c?(a.uncompressedSize=t._data.uncompressedSize,a.crc32=t._data.crc32,0===a.uncompressedSize||t.dir?(e=u.STORE,a.compressedContent="",a.crc32=0):t._data.compressionMethod===e.magic?a.compressedContent=t._data.getCompressedContent():(i=t._data.getContent(),a.compressedContent=e.compress(n.transformTo(e.compressInputType,i),r))):(i=g(t),(!i||0===i.length||t.dir)&&(e=u.STORE,i=""),a.uncompressedSize=i.length,a.crc32=o(i),a.compressedContent=e.compress(n.transformTo(e.compressInputType,i),r)),a.compressedSize=a.compressedContent.length,a.compressionMethod=e.magic,a},M=function(t,e){var r=t;return t||(r=e?16893:33204),(65535&r)<<16},A=function(t,e){return 63&(t||0)},N=function(t,e,r,i,s){var l,u,c,h,d=(r.compressedContent,n.transformTo("string",f.utf8encode(e.name))),p=e.comment||"",m=n.transformTo("string",f.utf8encode(p)),g=d.length!==e.name.length,y=m.length!==p.length,v=e.options,w="",b="",x="";c=e._initialMetadata.dir!==e.dir?e.dir:v.dir,h=e._initialMetadata.date!==e.date?e.date:v.date;var _=0,S=0;c&&(_|=16),"UNIX"===s?(S=798,_|=M(e.unixPermissions,c)):(S=20,_|=A(e.dosPermissions,c)),l=h.getHours(),l<<=6,l|=h.getMinutes(),l<<=5,l|=h.getSeconds()/2,u=h.getFullYear()-1980,u<<=4,u|=h.getMonth()+1,u<<=5,u|=h.getDate(),g&&(b=E(1,1)+E(o(d),4)+d,w+="up"+E(b.length,2)+b),y&&(x=E(1,1)+E(this.crc32(m),4)+m,w+="uc"+E(x.length,2)+x);var T="";T+="\n\x00",T+=g||y?"\x00\b":"\x00\x00",T+=r.compressionMethod,T+=E(l,2),T+=E(u,2),T+=E(r.crc32,4),T+=E(r.compressedSize,4),T+=E(r.uncompressedSize,4),T+=E(d.length,2),T+=E(w.length,2);var L=a.LOCAL_FILE_HEADER+T+d+w,N=a.CENTRAL_FILE_HEADER+E(S,2)+T+E(m.length,2)+"\x00\x00\x00\x00"+E(_,4)+E(i,4)+d+w+m;return{fileRecord:L,dirRecord:N,compressedObject:r}},R={load:function(t,e){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(t){var e,r,i,n,o=[];for(e in this.files)this.files.hasOwnProperty(e)&&(i=this.files[e],n=new v(i.name,i._data,w(i.options)),r=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(r,n)&&o.push(n));return o},file:function(t,e,r){if(1===arguments.length){if(n.isRegExp(t)){var i=t;return this.filter(function(t,e){return!e.dir&&i.test(t)})}return this.filter(function(e,r){return!r.dir&&e===t})[0]||null}return t=this.root+t,x.call(this,t,e,r),this},folder:function(t){if(!t)return this;if(n.isRegExp(t))return this.filter(function(e,r){return r.dir&&t.test(e)});var e=this.root+t,r=T.call(this,e),i=this.clone();return i.root=r.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!=t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var r=this.filter(function(e,r){return r.name.slice(0,t.length)===t}),i=0;i<r.length;i++)delete this.files[r[i].name];return this},generate:function(t){t=w(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip"}),n.checkSupport(t.type),("darwin"===t.platform||"freebsd"===t.platform||"linux"===t.platform||"sunos"===t.platform)&&(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var e,r,i=[],o=0,s=0,c=n.transformTo("string",this.utf8encode(t.comment||this.comment||""));for(var h in this.files)if(this.files.hasOwnProperty(h)){var f=this.files[h],m=f.options.compression||t.compression.toUpperCase(),g=u[m];if(!g)throw new Error(m+" is not a valid compression method !");var y=f.options.compressionOptions||t.compressionOptions||{},v=L.call(this,f,g,y),b=N.call(this,h,f,v,o,t.platform);o+=b.fileRecord.length+v.compressedSize,s+=b.dirRecord.length,i.push(b)}var x="";x=a.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+E(i.length,2)+E(i.length,2)+E(s,4)+E(o,4)+E(c.length,2)+c;var _=t.type.toLowerCase();for(e="uint8array"===_||"arraybuffer"===_||"blob"===_||"nodebuffer"===_?new p(o+s+x.length):new d(o+s+x.length),r=0;r<i.length;r++)e.append(i[r].fileRecord),e.append(i[r].compressedObject.compressedContent);for(r=0;r<i.length;r++)e.append(i[r].dirRecord);e.append(x);var S=e.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return n.transformTo(t.type.toLowerCase(),S);case"blob":return n.arrayBuffer2Blob(n.transformTo("arraybuffer",S),t.mimeType);case"base64":return t.base64?l.encode(S):S;default:return S}},crc32:function(t,e){return o(t,e)},utf8encode:function(t){return n.transformTo("string",f.utf8encode(t))},utf8decode:function(t){return f.utf8decode(t)}};e.exports=R},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(t,e,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],15:[function(t,e,r){function i(t,e){this.data=t,e||(this.data=o.string2binary(this.data)),this.length=this.data.length,this.index=0}var n=t("./dataReader"),o=t("./utils");i.prototype=new n,i.prototype.byteAt=function(t){return this.data.charCodeAt(t)},i.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)},i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./dataReader":5,"./utils":21}],16:[function(t,e,r){var i=t("./utils"),n=function(){this.data=[]};n.prototype={append:function(t){t=i.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}},e.exports=n},{"./utils":21}],17:[function(t,e,r){(function(t){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof t,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var e=new ArrayBuffer(0);try{r.blob=0===new Blob([e],{type:"application/zip"}).size}catch(i){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new n;o.append(e),r.blob=0===o.getBlob("application/zip").size}catch(i){r.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(t,e,r){function i(t){t&&(this.data=t,this.length=this.data.length,this.index=0)}var n=t("./dataReader");i.prototype=new n,i.prototype.byteAt=function(t){return this.data[t]},i.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===e&&this.data[o+1]===r&&this.data[o+2]===i&&this.data[o+3]===n)return o;return-1},i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./dataReader":5}],19:[function(t,e,r){var i=t("./utils"),n=function(t){this.data=new Uint8Array(t),this.index=0};n.prototype={append:function(t){0!==t.length&&(t=i.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}},e.exports=n},{"./utils":21}],20:[function(t,e,r){for(var i=t("./utils"),n=t("./support"),o=t("./nodeBuffer"),a=new Array(256),s=0;256>s;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;a[254]=a[254]=1;var l=function(t){var e,r,i,o,a,s=t.length,l=0;for(o=0;s>o;o++)r=t.charCodeAt(o),55296===(64512&r)&&s>o+1&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),o++)),l+=128>r?1:2048>r?2:65536>r?3:4;for(e=n.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;l>a;o++)r=t.charCodeAt(o),55296===(64512&r)&&s>o+1&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),o++)),128>r?e[a++]=r:2048>r?(e[a++]=192|r>>>6,e[a++]=128|63&r):65536>r?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|63&r):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|63&r);return e},u=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&128===(192&t[r]);)r--;return 0>r?e:0===r?e:r+a[t[r]]>e?r:e},c=function(t){var e,r,n,o,s=t.length,l=new Array(2*s);for(r=0,e=0;s>e;)if(n=t[e++],128>n)l[r++]=n;else if(o=a[n],o>4)l[r++]=65533,e+=o-1;else{for(n&=2===o?31:3===o?15:7;o>1&&s>e;)n=n<<6|63&t[e++],o--;o>1?l[r++]=65533:65536>n?l[r++]=n:(n-=65536,l[r++]=55296|n>>10&1023,l[r++]=56320|1023&n)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),i.applyFromCharCode(l)};r.utf8encode=function(t){return n.nodebuffer?o(t,"utf-8"):l(t)},r.utf8decode=function(t){if(n.nodebuffer)return i.transformTo("nodebuffer",t).toString("utf-8");t=i.transformTo(n.uint8array?"uint8array":"array",t);for(var e=[],r=0,o=t.length,a=65536;o>r;){var s=u(t,Math.min(r+a,o));n.uint8array?e.push(c(t.subarray(r,s))):e.push(c(t.slice(r,s))),r=s}return e.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(t,e,r){function i(t){return t}function n(t,e){for(var r=0;r<t.length;++r)e[r]=255&t.charCodeAt(r);return e}function o(t){var e=65536,i=[],n=t.length,o=r.getTypeOf(t),a=0,s=!0;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,u(0))}}catch(l){s=!1}if(!s){for(var c="",h=0;h<t.length;h++)c+=String.fromCharCode(t[h]);return c}for(;n>a&&e>1;)try{"array"===o||"nodebuffer"===o?i.push(String.fromCharCode.apply(null,t.slice(a,Math.min(a+e,n)))):i.push(String.fromCharCode.apply(null,t.subarray(a,Math.min(a+e,n)))),a+=e}catch(l){e=Math.floor(e/2)}return i.join("")}function a(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}var s=t("./support"),l=t("./compressions"),u=t("./nodeBuffer");r.string2binary=function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(255&t.charCodeAt(r));return e},r.arrayBuffer2Blob=function(t,e){r.checkSupport("blob"),e=e||"application/zip";try{return new Blob([t],{type:e})}catch(i){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new n;return o.append(t),o.getBlob(e)}catch(i){throw new Error("Bug : can't construct the Blob.")}}},r.applyFromCharCode=o;var c={};c.string={string:i,array:function(t){return n(t,new Array(t.length))},arraybuffer:function(t){return c.string.uint8array(t).buffer},uint8array:function(t){return n(t,new Uint8Array(t.length))},nodebuffer:function(t){return n(t,u(t.length))}},c.array={string:o,array:i,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return u(t)}},c.arraybuffer={string:function(t){return o(new Uint8Array(t))},array:function(t){return a(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:i,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return u(new Uint8Array(t))}},c.uint8array={string:o,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:i,nodebuffer:function(t){return u(t)}},c.nodebuffer={string:o,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return c.nodebuffer.uint8array(t).buffer},uint8array:function(t){return a(t,new Uint8Array(t.length))},nodebuffer:i},r.transformTo=function(t,e){if(e||(e=""),!t)return e;r.checkSupport(t);var i=r.getTypeOf(e),n=c[i][t](e);return n},r.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":s.nodebuffer&&u.test(t)?"nodebuffer":s.uint8array&&t instanceof Uint8Array?"uint8array":s.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(t){var e=s[t.toLowerCase()];if(!e)throw new Error(t+" is not supported by this browser")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(t){var e,r,i="";for(r=0;r<(t||"").length;r++)e=t.charCodeAt(r),i+="\\x"+(16>e?"0":"")+e.toString(16).toUpperCase();return i},r.findCompression=function(t){for(var e in l)if(l.hasOwnProperty(e)&&l[e].magic===t)return l[e];return null},r.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(t,e,r){function i(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}var n=t("./stringReader"),o=t("./nodeBufferReader"),a=t("./uint8ArrayReader"),s=t("./utils"),l=t("./signature"),u=t("./zipEntry"),c=t("./support"),h=t("./object");i.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+s.pretty(e)+", expected "+s.pretty(t)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),
this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=h.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,r,i=this.zip64EndOfCentralSize-44,n=0;i>n;)t=this.reader.readInt(2),e=this.reader.readInt(4),r=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===l.CENTRAL_FILE_HEADER;)t=new u({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(-1===t){var e=!0;try{this.reader.setIndex(0),this.checkSignature(l.LOCAL_FILE_HEADER),e=!1}catch(r){}throw e?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory")}if(this.reader.setIndex(t),this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),-1===t)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(t),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(t){var e=s.getTypeOf(t);"string"!==e||c.uint8array?"nodebuffer"===e?this.reader=new o(t):this.reader=new a(s.transformTo("uint8array",t)):this.reader=new n(t,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=i},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(t,e,r){function i(t,e){this.options=t,this.loadOptions=e}var n=t("./stringReader"),o=t("./utils"),a=t("./compressedObject"),s=t("./object"),l=0,u=3;i.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},prepareCompressedContent:function(t,e,r){return function(){var i=t.index;t.setIndex(e);var n=t.readData(r);return t.setIndex(i),n}},prepareContent:function(t,e,r,i,n){return function(){var t=o.transformTo(i.uncompressInputType,this.getCompressedContent()),e=i.uncompress(t);if(e.length!==n)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(t){var e,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readString(this.fileNameLength),t.skip(r),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(e=o.findCompression(this.compressionMethod),null===e)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new a,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,e),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,e,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),s.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readString(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readString(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=16&this.externalFileAttributes?!0:!1,t===l&&(this.dosPermissions=63&this.externalFileAttributes),t===u&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileName.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=new n(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,r,i,n=t.index;for(this.extraFields=this.extraFields||{};t.index<n+this.extraFieldsLength;)e=t.readInt(2),r=t.readInt(2),i=t.readString(r),this.extraFields[e]={id:e,length:r,value:i}},handleUTF8:function(){if(this.useUTF8())this.fileName=s.utf8decode(this.fileName),this.fileComment=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();null!==t&&(this.fileName=t);var e=this.findExtraFieldUnicodeComment();null!==e&&(this.fileComment=e)}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=new n(t.value);return 1!==e.readInt(1)?null:s.crc32(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=new n(t.value);return 1!==e.readInt(1)?null:s.crc32(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null}},e.exports=i},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(t,e,r){var i=t("./lib/utils/common").assign,n=t("./lib/deflate"),o=t("./lib/inflate"),a=t("./lib/zlib/constants"),s={};i(s,n,o,a),e.exports=s},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(t,e,r){function i(t,e){var r=new v(e);if(r.push(t,!0),r.err)throw r.msg;return r.result}function n(t,e){return e=e||{},e.raw=!0,i(t,e)}function o(t,e){return e=e||{},e.gzip=!0,i(t,e)}var a=t("./zlib/deflate.js"),s=t("./utils/common"),l=t("./utils/strings"),u=t("./zlib/messages"),c=t("./zlib/zstream"),h=0,f=4,d=0,p=1,m=-1,g=0,y=8,v=function(t){this.options=s.assign({level:m,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var r=a.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==d)throw new Error(u[r]);e.header&&a.deflateSetHeader(this.strm,e.header)};v.prototype.push=function(t,e){var r,i,n=this.strm,o=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:e===!0?f:h,"string"==typeof t?n.input=l.string2buf(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new s.Buf8(o),n.next_out=0,n.avail_out=o),r=a.deflate(n,i),r!==p&&r!==d)return this.onEnd(r),this.ended=!0,!1;(0===n.avail_out||0===n.avail_in&&i===f)&&("string"===this.options.to?this.onData(l.buf2binstring(s.shrinkBuf(n.output,n.next_out))):this.onData(s.shrinkBuf(n.output,n.next_out)))}while((n.avail_in>0||0===n.avail_out)&&r!==p);return i===f?(r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===d):!0},v.prototype.onData=function(t){this.chunks.push(t)},v.prototype.onEnd=function(t){t===d&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Deflate=v,r.deflate=i,r.deflateRaw=n,r.gzip=o},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(t,e,r){function i(t,e){var r=new f(e);if(r.push(t,!0),r.err)throw r.msg;return r.result}function n(t,e){return e=e||{},e.raw=!0,i(t,e)}var o=t("./zlib/inflate.js"),a=t("./utils/common"),s=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),c=t("./zlib/zstream"),h=t("./zlib/gzheader"),f=function(t){this.options=a.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var r=o.inflateInit2(this.strm,e.windowBits);if(r!==l.Z_OK)throw new Error(u[r]);this.header=new h,o.inflateGetHeader(this.strm,this.header)};f.prototype.push=function(t,e){var r,i,n,u,c,h=this.strm,f=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:e===!0?l.Z_FINISH:l.Z_NO_FLUSH,"string"==typeof t?h.input=s.binstring2buf(t):h.input=t,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new a.Buf8(f),h.next_out=0,h.avail_out=f),r=o.inflate(h,l.Z_NO_FLUSH),r!==l.Z_STREAM_END&&r!==l.Z_OK)return this.onEnd(r),this.ended=!0,!1;h.next_out&&(0===h.avail_out||r===l.Z_STREAM_END||0===h.avail_in&&i===l.Z_FINISH)&&("string"===this.options.to?(n=s.utf8border(h.output,h.next_out),u=h.next_out-n,c=s.buf2string(h.output,n),h.next_out=u,h.avail_out=f-u,u&&a.arraySet(h.output,h.output,n,u,0),this.onData(c)):this.onData(a.shrinkBuf(h.output,h.next_out)))}while(h.avail_in>0&&r!==l.Z_STREAM_END);return r===l.Z_STREAM_END&&(i=l.Z_FINISH),i===l.Z_FINISH?(r=o.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===l.Z_OK):!0},f.prototype.onData=function(t){this.chunks.push(t)},f.prototype.onEnd=function(t){t===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Inflate=f,r.inflate=i,r.inflateRaw=n,r.ungzip=i},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(t,e,r){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}}return t},r.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var n={arraySet:function(t,e,r,i,n){if(e.subarray&&t.subarray)return void t.set(e.subarray(r,r+i),n);for(var o=0;i>o;o++)t[n+o]=e[r+o]},flattenChunks:function(t){var e,r,i,n,o,a;for(i=0,e=0,r=t.length;r>e;e++)i+=t[e].length;for(a=new Uint8Array(i),n=0,e=0,r=t.length;r>e;e++)o=t[e],a.set(o,n),n+=o.length;return a}},o={arraySet:function(t,e,r,i,n){for(var o=0;i>o;o++)t[n+o]=e[r+o]},flattenChunks:function(t){return[].concat.apply([],t)}};r.setTyped=function(t){t?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,n)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(i)},{}],28:[function(t,e,r){function i(t,e){if(65537>e&&(t.subarray&&a||!t.subarray&&o))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var r="",i=0;e>i;i++)r+=String.fromCharCode(t[i]);return r}var n=t("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(s){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s){a=!1}for(var l=new n.Buf8(256),u=0;256>u;u++)l[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;l[254]=l[254]=1,r.string2buf=function(t){var e,r,i,o,a,s=t.length,l=0;for(o=0;s>o;o++)r=t.charCodeAt(o),55296===(64512&r)&&s>o+1&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),o++)),l+=128>r?1:2048>r?2:65536>r?3:4;for(e=new n.Buf8(l),a=0,o=0;l>a;o++)r=t.charCodeAt(o),55296===(64512&r)&&s>o+1&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),o++)),128>r?e[a++]=r:2048>r?(e[a++]=192|r>>>6,e[a++]=128|63&r):65536>r?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|63&r):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|63&r);return e},r.buf2binstring=function(t){return i(t,t.length)},r.binstring2buf=function(t){for(var e=new n.Buf8(t.length),r=0,i=e.length;i>r;r++)e[r]=t.charCodeAt(r);return e},r.buf2string=function(t,e){var r,n,o,a,s=e||t.length,u=new Array(2*s);for(n=0,r=0;s>r;)if(o=t[r++],128>o)u[n++]=o;else if(a=l[o],a>4)u[n++]=65533,r+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&s>r;)o=o<<6|63&t[r++],a--;a>1?u[n++]=65533:65536>o?u[n++]=o:(o-=65536,u[n++]=55296|o>>10&1023,u[n++]=56320|1023&o)}return i(u,n)},r.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&128===(192&t[r]);)r--;return 0>r?e:0===r?e:r+l[t[r]]>e?r:e}},{"./common":27}],29:[function(t,e,r){function i(t,e,r,i){for(var n=65535&t|0,o=t>>>16&65535|0,a=0;0!==r;){a=r>2e3?2e3:r,r-=a;do n=n+e[i++]|0,o=o+n|0;while(--a);n%=65521,o%=65521}return n|o<<16|0}e.exports=i},{}],30:[function(t,e,r){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(t,e,r){function i(){for(var t,e=[],r=0;256>r;r++){t=r;for(var i=0;8>i;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}function n(t,e,r,i){var n=o,a=i+r;t=-1^t;for(var s=i;a>s;s++)t=t>>>8^n[255&(t^e[s])];return-1^t}var o=i();e.exports=n},{}],32:[function(t,e,r){function i(t,e){return t.msg=P[e],e}function n(t){return(t<<1)-(t>4?9:0)}function o(t){for(var e=t.length;--e>=0;)t[e]=0}function a(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(A.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function s(t,e){N._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,a(t.strm)}function l(t,e){t.pending_buf[t.pending++]=e}function u(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function c(t,e,r,i){var n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,A.arraySet(e,t.input,t.next_in,n,r),1===t.state.wrap?t.adler=R(t.adler,e,n,r):2===t.state.wrap&&(t.adler=C(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)}function h(t,e){var r,i,n=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-ut?t.strstart-(t.w_size-ut):0,u=t.window,c=t.w_mask,h=t.prev,f=t.strstart+lt,d=u[o+a-1],p=u[o+a];t.prev_length>=t.good_match&&(n>>=2),s>t.lookahead&&(s=t.lookahead);do if(r=e,u[r+a]===p&&u[r+a-1]===d&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do;while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&f>o);if(i=lt-(f-o),o=f-lt,i>a){if(t.match_start=e,a=i,i>=s)break;d=u[o+a-1],p=u[o+a]}}while((e=h[e&c])>l&&0!==--n);return a<=t.lookahead?a:t.lookahead}function f(t){var e,r,i,n,o,a=t.w_size;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=a+(a-ut)){A.arraySet(t.window,t.window,a,a,0),t.match_start-=a,t.strstart-=a,t.block_start-=a,r=t.hash_size,e=r;do i=t.head[--e],t.head[e]=i>=a?i-a:0;while(--r);r=a,e=r;do i=t.prev[--e],t.prev[e]=i>=a?i-a:0;while(--r);n+=a}if(0===t.strm.avail_in)break;if(r=c(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=r,t.lookahead+t.insert>=st)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+st-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<st)););}while(t.lookahead<ut&&0!==t.strm.avail_in)}function d(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(f(t),0===t.lookahead&&e===O)return vt;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+r;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,s(t,!1),0===t.strm.avail_out))return vt;if(t.strstart-t.block_start>=t.w_size-ut&&(s(t,!1),0===t.strm.avail_out))return vt}return t.insert=0,e===D?(s(t,!0),0===t.strm.avail_out?wt:bt):t.strstart>t.block_start&&(s(t,!1),0===t.strm.avail_out)?vt:vt}function p(t,e){for(var r,i;;){if(t.lookahead<ut){if(f(t),t.lookahead<ut&&e===O)return vt;if(0===t.lookahead)break}if(r=0,t.lookahead>=st&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-ut&&(t.match_length=h(t,r)),t.match_length>=st)if(i=N._tr_tally(t,t.strstart-t.match_start,t.match_length-st),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=st){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=N._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(s(t,!1),0===t.strm.avail_out))return vt}return t.insert=t.strstart<st-1?t.strstart:st-1,e===D?(s(t,!0),0===t.strm.avail_out?wt:bt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?vt:Et}function m(t,e){for(var r,i,n;;){if(t.lookahead<ut){if(f(t),t.lookahead<ut&&e===O)return vt;if(0===t.lookahead)break}if(r=0,t.lookahead>=st&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=st-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-ut&&(t.match_length=h(t,r),t.match_length<=5&&(t.strategy===z||t.match_length===st&&t.strstart-t.match_start>4096)&&(t.match_length=st-1)),t.prev_length>=st&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-st,i=N._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-st),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(0!==--t.prev_length);if(t.match_available=0,t.match_length=st-1,t.strstart++,i&&(s(t,!1),0===t.strm.avail_out))return vt}else if(t.match_available){if(i=N._tr_tally(t,0,t.window[t.strstart-1]),i&&s(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return vt}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=N._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<st-1?t.strstart:st-1,e===D?(s(t,!0),0===t.strm.avail_out?wt:bt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?vt:Et}function g(t,e){for(var r,i,n,o,a=t.window;;){if(t.lookahead<=lt){if(f(t),t.lookahead<=lt&&e===O)return vt;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=st&&t.strstart>0&&(n=t.strstart-1,i=a[n],i===a[++n]&&i===a[++n]&&i===a[++n])){o=t.strstart+lt;do;while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&o>n);t.match_length=lt-(o-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=st?(r=N._tr_tally(t,1,t.match_length-st),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=N._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(s(t,!1),0===t.strm.avail_out))return vt}return t.insert=0,e===D?(s(t,!0),0===t.strm.avail_out?wt:bt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?vt:Et}function y(t,e){for(var r;;){if(0===t.lookahead&&(f(t),0===t.lookahead)){if(e===O)return vt;break}if(t.match_length=0,r=N._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(s(t,!1),0===t.strm.avail_out))return vt}return t.insert=0,e===D?(s(t,!0),0===t.strm.avail_out?wt:bt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?vt:Et}function v(t){t.window_size=2*t.w_size,o(t.head),t.max_lazy_match=M[t.level].max_lazy,t.good_match=M[t.level].good_length,t.nice_match=M[t.level].nice_length,t.max_chain_length=M[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=st-1,t.match_available=0,t.ins_h=0}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=X,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new A.Buf16(2*ot),this.dyn_dtree=new A.Buf16(2*(2*it+1)),this.bl_tree=new A.Buf16(2*(2*nt+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new A.Buf16(at+1),this.heap=new A.Buf16(2*rt+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new A.Buf16(2*rt+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function w(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=$,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?ht:gt,t.adler=2===e.wrap?0:1,e.last_flush=O,N._tr_init(e),F):i(t,B)}function b(t){var e=w(t);return e===F&&v(t.state),e}function x(t,e){return t&&t.state?2!==t.state.wrap?B:(t.state.gzhead=e,F):B}function _(t,e,r,n,o,a){if(!t)return B;var s=1;if(e===j&&(e=6),0>n?(s=0,n=-n):n>15&&(s=2,n-=16),1>o||o>J||r!==X||8>n||n>15||0>e||e>9||0>a||a>H)return i(t,B);8===n&&(n=9);var l=new E;return t.state=l,l.strm=t,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+st-1)/st),l.window=new A.Buf8(2*l.w_size),l.head=new A.Buf16(l.hash_size),l.prev=new A.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new A.Buf8(l.pending_buf_size),l.d_buf=l.lit_bufsize>>1,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=r,b(t)}function S(t,e){return _(t,e,X,Z,Q,Y)}function T(t,e){var r,s,c,h;if(!t||!t.state||e>V||0>e)return t?i(t,B):B;if(s=t.state,!t.output||!t.input&&0!==t.avail_in||s.status===yt&&e!==D)return i(t,0===t.avail_out?U:B);if(s.strm=t,r=s.last_flush,s.last_flush=e,s.status===ht)if(2===s.wrap)t.adler=0,l(s,31),l(s,139),l(s,8),s.gzhead?(l(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),l(s,255&s.gzhead.time),l(s,s.gzhead.time>>8&255),l(s,s.gzhead.time>>16&255),l(s,s.gzhead.time>>24&255),l(s,9===s.level?2:s.strategy>=K||s.level<2?4:0),l(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(l(s,255&s.gzhead.extra.length),l(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(t.adler=C(t.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=ft):(l(s,0),l(s,0),l(s,0),l(s,0),l(s,0),l(s,9===s.level?2:s.strategy>=K||s.level<2?4:0),l(s,xt),s.status=gt);else{var f=X+(s.w_bits-8<<4)<<8,d=-1;d=s.strategy>=K||s.level<2?0:s.level<6?1:6===s.level?2:3,f|=d<<6,0!==s.strstart&&(f|=ct),f+=31-f%31,s.status=gt,u(s,f),0!==s.strstart&&(u(s,t.adler>>>16),u(s,65535&t.adler)),t.adler=1}if(s.status===ft)if(s.gzhead.extra){for(c=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>c&&(t.adler=C(t.adler,s.pending_buf,s.pending-c,c)),a(t),c=s.pending,s.pending!==s.pending_buf_size));)l(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>c&&(t.adler=C(t.adler,s.pending_buf,s.pending-c,c)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=dt)}else s.status=dt;if(s.status===dt)if(s.gzhead.name){c=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>c&&(t.adler=C(t.adler,s.pending_buf,s.pending-c,c)),a(t),c=s.pending,s.pending===s.pending_buf_size)){h=1;break}h=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,l(s,h)}while(0!==h);s.gzhead.hcrc&&s.pending>c&&(t.adler=C(t.adler,s.pending_buf,s.pending-c,c)),0===h&&(s.gzindex=0,s.status=pt)}else s.status=pt;if(s.status===pt)if(s.gzhead.comment){c=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>c&&(t.adler=C(t.adler,s.pending_buf,s.pending-c,c)),a(t),c=s.pending,s.pending===s.pending_buf_size)){h=1;break}h=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,l(s,h)}while(0!==h);s.gzhead.hcrc&&s.pending>c&&(t.adler=C(t.adler,s.pending_buf,s.pending-c,c)),0===h&&(s.status=mt)}else s.status=mt;if(s.status===mt&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&a(t),s.pending+2<=s.pending_buf_size&&(l(s,255&t.adler),l(s,t.adler>>8&255),t.adler=0,s.status=gt)):s.status=gt),0!==s.pending){if(a(t),0===t.avail_out)return s.last_flush=-1,F}else if(0===t.avail_in&&n(e)<=n(r)&&e!==D)return i(t,U);if(s.status===yt&&0!==t.avail_in)return i(t,U);if(0!==t.avail_in||0!==s.lookahead||e!==O&&s.status!==yt){var p=s.strategy===K?y(s,e):s.strategy===q?g(s,e):M[s.level].func(s,e);if((p===wt||p===bt)&&(s.status=yt),p===vt||p===wt)return 0===t.avail_out&&(s.last_flush=-1),F;if(p===Et&&(e===I?N._tr_align(s):e!==V&&(N._tr_stored_block(s,0,0,!1),e===k&&(o(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),a(t),0===t.avail_out))return s.last_flush=-1,F}return e!==D?F:s.wrap<=0?G:(2===s.wrap?(l(s,255&t.adler),l(s,t.adler>>8&255),l(s,t.adler>>16&255),l(s,t.adler>>24&255),l(s,255&t.total_in),l(s,t.total_in>>8&255),l(s,t.total_in>>16&255),l(s,t.total_in>>24&255)):(u(s,t.adler>>>16),u(s,65535&t.adler)),a(t),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?F:G)}function L(t){var e;return t&&t.state?(e=t.state.status,e!==ht&&e!==ft&&e!==dt&&e!==pt&&e!==mt&&e!==gt&&e!==yt?i(t,B):(t.state=null,e===gt?i(t,W):F)):B}var M,A=t("../utils/common"),N=t("./trees"),R=t("./adler32"),C=t("./crc32"),P=t("./messages"),O=0,I=1,k=3,D=4,V=5,F=0,G=1,B=-2,W=-3,U=-5,j=-1,z=1,K=2,q=3,H=4,Y=0,$=2,X=8,J=9,Z=15,Q=8,tt=29,et=256,rt=et+1+tt,it=30,nt=19,ot=2*rt+1,at=15,st=3,lt=258,ut=lt+st+1,ct=32,ht=42,ft=69,dt=73,pt=91,mt=103,gt=113,yt=666,vt=1,Et=2,wt=3,bt=4,xt=3,_t=function(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n};M=[new _t(0,0,0,0,d),new _t(4,4,8,4,p),new _t(4,5,16,8,p),new _t(4,6,32,32,p),new _t(4,4,16,16,m),new _t(8,16,32,32,m),new _t(8,16,128,128,m),new _t(8,32,128,256,m),new _t(32,128,258,1024,m),new _t(32,258,258,4096,m)],r.deflateInit=S,r.deflateInit2=_,r.deflateReset=b,r.deflateResetKeep=w,r.deflateSetHeader=x,r.deflate=T,r.deflateEnd=L,r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(t,e,r){function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=i},{}],34:[function(t,e,r){var i=30,n=12;e.exports=function(t,e){var r,o,a,s,l,u,c,h,f,d,p,m,g,y,v,E,w,b,x,_,S,T,L,M,A;r=t.state,o=t.next_in,M=t.input,a=o+(t.avail_in-5),s=t.next_out,A=t.output,l=s-(e-t.avail_out),u=s+(t.avail_out-257),c=r.dmax,h=r.wsize,f=r.whave,d=r.wnext,p=r.window,m=r.hold,g=r.bits,y=r.lencode,v=r.distcode,E=(1<<r.lenbits)-1,w=(1<<r.distbits)-1;t:do{15>g&&(m+=M[o++]<<g,g+=8,m+=M[o++]<<g,g+=8),b=y[m&E];e:for(;;){if(x=b>>>24,m>>>=x,g-=x,x=b>>>16&255,0===x)A[s++]=65535&b;else{if(!(16&x)){if(0===(64&x)){b=y[(65535&b)+(m&(1<<x)-1)];continue e}if(32&x){r.mode=n;break t}t.msg="invalid literal/length code",r.mode=i;break t}_=65535&b,x&=15,x&&(x>g&&(m+=M[o++]<<g,g+=8),_+=m&(1<<x)-1,m>>>=x,g-=x),15>g&&(m+=M[o++]<<g,g+=8,m+=M[o++]<<g,g+=8),b=v[m&w];r:for(;;){if(x=b>>>24,m>>>=x,g-=x,x=b>>>16&255,!(16&x)){if(0===(64&x)){b=v[(65535&b)+(m&(1<<x)-1)];continue r}t.msg="invalid distance code",r.mode=i;break t}if(S=65535&b,x&=15,x>g&&(m+=M[o++]<<g,g+=8,x>g&&(m+=M[o++]<<g,g+=8)),S+=m&(1<<x)-1,S>c){t.msg="invalid distance too far back",r.mode=i;break t}if(m>>>=x,g-=x,x=s-l,S>x){if(x=S-x,x>f&&r.sane){t.msg="invalid distance too far back",r.mode=i;break t}if(T=0,L=p,0===d){if(T+=h-x,_>x){_-=x;do A[s++]=p[T++];while(--x);T=s-S,L=A}}else if(x>d){if(T+=h+d-x,x-=d,_>x){_-=x;do A[s++]=p[T++];while(--x);if(T=0,_>d){x=d,_-=x;do A[s++]=p[T++];while(--x);T=s-S,L=A}}}else if(T+=d-x,_>x){_-=x;do A[s++]=p[T++];while(--x);T=s-S,L=A}for(;_>2;)A[s++]=L[T++],A[s++]=L[T++],A[s++]=L[T++],_-=3;_&&(A[s++]=L[T++],_>1&&(A[s++]=L[T++]))}else{T=s-S;do A[s++]=A[T++],A[s++]=A[T++],A[s++]=A[T++],_-=3;while(_>2);_&&(A[s++]=A[T++],_>1&&(A[s++]=A[T++]))}break}}break}}while(a>o&&u>s);_=g>>3,o-=_,g-=_<<3,m&=(1<<g)-1,t.next_in=o,t.next_out=s,t.avail_in=a>o?5+(a-o):5-(o-a),t.avail_out=u>s?257+(u-s):257-(s-u),r.hold=m,r.bits=g}},{}],35:[function(t,e,r){function i(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function n(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,
t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=D,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new y.Buf32(pt),e.distcode=e.distdyn=new y.Buf32(mt),e.sane=1,e.back=-1,A):C}function a(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,o(t)):C}function s(t,e){var r,i;return t&&t.state?(i=t.state,0>e?(r=0,e=-e):(r=(e>>4)+1,48>e&&(e&=15)),e&&(8>e||e>15)?C:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,a(t))):C}function l(t,e){var r,i;return t?(i=new n,t.state=i,i.window=null,r=s(t,e),r!==A&&(t.state=null),r):C}function u(t){return l(t,yt)}function c(t){if(vt){var e;for(m=new y.Buf32(512),g=new y.Buf32(32),e=0;144>e;)t.lens[e++]=8;for(;256>e;)t.lens[e++]=9;for(;280>e;)t.lens[e++]=7;for(;288>e;)t.lens[e++]=8;for(b(_,t.lens,0,288,m,0,t.work,{bits:9}),e=0;32>e;)t.lens[e++]=5;b(S,t.lens,0,32,g,0,t.work,{bits:5}),vt=!1}t.lencode=m,t.lenbits=9,t.distcode=g,t.distbits=5}function h(t,e,r,i){var n,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new y.Buf8(o.wsize)),i>=o.wsize?(y.arraySet(o.window,e,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(n=o.wsize-o.wnext,n>i&&(n=i),y.arraySet(o.window,e,r-i,n,o.wnext),i-=n,i?(y.arraySet(o.window,e,r-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=n,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=n))),0}function f(t,e){var r,n,o,a,s,l,u,f,d,p,m,g,pt,mt,gt,yt,vt,Et,wt,bt,xt,_t,St,Tt,Lt=0,Mt=new y.Buf8(4),At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return C;r=t.state,r.mode===H&&(r.mode=Y),s=t.next_out,o=t.output,u=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,f=r.hold,d=r.bits,p=l,m=u,_t=A;t:for(;;)switch(r.mode){case D:if(0===r.wrap){r.mode=Y;break}for(;16>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(2&r.wrap&&35615===f){r.check=0,Mt[0]=255&f,Mt[1]=f>>>8&255,r.check=E(r.check,Mt,2,0),f=0,d=0,r.mode=V;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&f)<<8)+(f>>8))%31){t.msg="incorrect header check",r.mode=ht;break}if((15&f)!==k){t.msg="unknown compression method",r.mode=ht;break}if(f>>>=4,d-=4,xt=(15&f)+8,0===r.wbits)r.wbits=xt;else if(xt>r.wbits){t.msg="invalid window size",r.mode=ht;break}r.dmax=1<<xt,t.adler=r.check=1,r.mode=512&f?K:H,f=0,d=0;break;case V:for(;16>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(r.flags=f,(255&r.flags)!==k){t.msg="unknown compression method",r.mode=ht;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=ht;break}r.head&&(r.head.text=f>>8&1),512&r.flags&&(Mt[0]=255&f,Mt[1]=f>>>8&255,r.check=E(r.check,Mt,2,0)),f=0,d=0,r.mode=F;case F:for(;32>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.head&&(r.head.time=f),512&r.flags&&(Mt[0]=255&f,Mt[1]=f>>>8&255,Mt[2]=f>>>16&255,Mt[3]=f>>>24&255,r.check=E(r.check,Mt,4,0)),f=0,d=0,r.mode=G;case G:for(;16>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.head&&(r.head.xflags=255&f,r.head.os=f>>8),512&r.flags&&(Mt[0]=255&f,Mt[1]=f>>>8&255,r.check=E(r.check,Mt,2,0)),f=0,d=0,r.mode=B;case B:if(1024&r.flags){for(;16>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.length=f,r.head&&(r.head.extra_len=f),512&r.flags&&(Mt[0]=255&f,Mt[1]=f>>>8&255,r.check=E(r.check,Mt,2,0)),f=0,d=0}else r.head&&(r.head.extra=null);r.mode=W;case W:if(1024&r.flags&&(g=r.length,g>l&&(g=l),g&&(r.head&&(xt=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),y.arraySet(r.head.extra,n,a,g,xt)),512&r.flags&&(r.check=E(r.check,n,g,a)),l-=g,a+=g,r.length-=g),r.length))break t;r.length=0,r.mode=U;case U:if(2048&r.flags){if(0===l)break t;g=0;do xt=n[a+g++],r.head&&xt&&r.length<65536&&(r.head.name+=String.fromCharCode(xt));while(xt&&l>g);if(512&r.flags&&(r.check=E(r.check,n,g,a)),l-=g,a+=g,xt)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=j;case j:if(4096&r.flags){if(0===l)break t;g=0;do xt=n[a+g++],r.head&&xt&&r.length<65536&&(r.head.comment+=String.fromCharCode(xt));while(xt&&l>g);if(512&r.flags&&(r.check=E(r.check,n,g,a)),l-=g,a+=g,xt)break t}else r.head&&(r.head.comment=null);r.mode=z;case z:if(512&r.flags){for(;16>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(f!==(65535&r.check)){t.msg="header crc mismatch",r.mode=ht;break}f=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=H;break;case K:for(;32>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}t.adler=r.check=i(f),f=0,d=0,r.mode=q;case q:if(0===r.havedict)return t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=l,r.hold=f,r.bits=d,R;t.adler=r.check=1,r.mode=H;case H:if(e===L||e===M)break t;case Y:if(r.last){f>>>=7&d,d-=7&d,r.mode=lt;break}for(;3>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}switch(r.last=1&f,f>>>=1,d-=1,3&f){case 0:r.mode=$;break;case 1:if(c(r),r.mode=et,e===M){f>>>=2,d-=2;break t}break;case 2:r.mode=Z;break;case 3:t.msg="invalid block type",r.mode=ht}f>>>=2,d-=2;break;case $:for(f>>>=7&d,d-=7&d;32>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if((65535&f)!==(f>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ht;break}if(r.length=65535&f,f=0,d=0,r.mode=X,e===M)break t;case X:r.mode=J;case J:if(g=r.length){if(g>l&&(g=l),g>u&&(g=u),0===g)break t;y.arraySet(o,n,a,g,s),l-=g,a+=g,u-=g,s+=g,r.length-=g;break}r.mode=H;break;case Z:for(;14>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(r.nlen=(31&f)+257,f>>>=5,d-=5,r.ndist=(31&f)+1,f>>>=5,d-=5,r.ncode=(15&f)+4,f>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ht;break}r.have=0,r.mode=Q;case Q:for(;r.have<r.ncode;){for(;3>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.lens[At[r.have++]]=7&f,f>>>=3,d-=3}for(;r.have<19;)r.lens[At[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,St={bits:r.lenbits},_t=b(x,r.lens,0,19,r.lencode,0,r.work,St),r.lenbits=St.bits,_t){t.msg="invalid code lengths set",r.mode=ht;break}r.have=0,r.mode=tt;case tt:for(;r.have<r.nlen+r.ndist;){for(;Lt=r.lencode[f&(1<<r.lenbits)-1],gt=Lt>>>24,yt=Lt>>>16&255,vt=65535&Lt,!(d>=gt);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(16>vt)f>>>=gt,d-=gt,r.lens[r.have++]=vt;else{if(16===vt){for(Tt=gt+2;Tt>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(f>>>=gt,d-=gt,0===r.have){t.msg="invalid bit length repeat",r.mode=ht;break}xt=r.lens[r.have-1],g=3+(3&f),f>>>=2,d-=2}else if(17===vt){for(Tt=gt+3;Tt>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}f>>>=gt,d-=gt,xt=0,g=3+(7&f),f>>>=3,d-=3}else{for(Tt=gt+7;Tt>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}f>>>=gt,d-=gt,xt=0,g=11+(127&f),f>>>=7,d-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ht;break}for(;g--;)r.lens[r.have++]=xt}}if(r.mode===ht)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=ht;break}if(r.lenbits=9,St={bits:r.lenbits},_t=b(_,r.lens,0,r.nlen,r.lencode,0,r.work,St),r.lenbits=St.bits,_t){t.msg="invalid literal/lengths set",r.mode=ht;break}if(r.distbits=6,r.distcode=r.distdyn,St={bits:r.distbits},_t=b(S,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,St),r.distbits=St.bits,_t){t.msg="invalid distances set",r.mode=ht;break}if(r.mode=et,e===M)break t;case et:r.mode=rt;case rt:if(l>=6&&u>=258){t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=l,r.hold=f,r.bits=d,w(t,m),s=t.next_out,o=t.output,u=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,f=r.hold,d=r.bits,r.mode===H&&(r.back=-1);break}for(r.back=0;Lt=r.lencode[f&(1<<r.lenbits)-1],gt=Lt>>>24,yt=Lt>>>16&255,vt=65535&Lt,!(d>=gt);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(yt&&0===(240&yt)){for(Et=gt,wt=yt,bt=vt;Lt=r.lencode[bt+((f&(1<<Et+wt)-1)>>Et)],gt=Lt>>>24,yt=Lt>>>16&255,vt=65535&Lt,!(d>=Et+gt);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}f>>>=Et,d-=Et,r.back+=Et}if(f>>>=gt,d-=gt,r.back+=gt,r.length=vt,0===yt){r.mode=st;break}if(32&yt){r.back=-1,r.mode=H;break}if(64&yt){t.msg="invalid literal/length code",r.mode=ht;break}r.extra=15&yt,r.mode=it;case it:if(r.extra){for(Tt=r.extra;Tt>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=nt;case nt:for(;Lt=r.distcode[f&(1<<r.distbits)-1],gt=Lt>>>24,yt=Lt>>>16&255,vt=65535&Lt,!(d>=gt);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(0===(240&yt)){for(Et=gt,wt=yt,bt=vt;Lt=r.distcode[bt+((f&(1<<Et+wt)-1)>>Et)],gt=Lt>>>24,yt=Lt>>>16&255,vt=65535&Lt,!(d>=Et+gt);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}f>>>=Et,d-=Et,r.back+=Et}if(f>>>=gt,d-=gt,r.back+=gt,64&yt){t.msg="invalid distance code",r.mode=ht;break}r.offset=vt,r.extra=15&yt,r.mode=ot;case ot:if(r.extra){for(Tt=r.extra;Tt>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ht;break}r.mode=at;case at:if(0===u)break t;if(g=m-u,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ht;break}g>r.wnext?(g-=r.wnext,pt=r.wsize-g):pt=r.wnext-g,g>r.length&&(g=r.length),mt=r.window}else mt=o,pt=s-r.offset,g=r.length;g>u&&(g=u),u-=g,r.length-=g;do o[s++]=mt[pt++];while(--g);0===r.length&&(r.mode=rt);break;case st:if(0===u)break t;o[s++]=r.length,u--,r.mode=rt;break;case lt:if(r.wrap){for(;32>d;){if(0===l)break t;l--,f|=n[a++]<<d,d+=8}if(m-=u,t.total_out+=m,r.total+=m,m&&(t.adler=r.check=r.flags?E(r.check,o,m,s-m):v(r.check,o,m,s-m)),m=u,(r.flags?f:i(f))!==r.check){t.msg="incorrect data check",r.mode=ht;break}f=0,d=0}r.mode=ut;case ut:if(r.wrap&&r.flags){for(;32>d;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(f!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=ht;break}f=0,d=0}r.mode=ct;case ct:_t=N;break t;case ht:_t=P;break t;case ft:return O;case dt:default:return C}return t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=l,r.hold=f,r.bits=d,(r.wsize||m!==t.avail_out&&r.mode<ht&&(r.mode<lt||e!==T))&&h(t,t.output,t.next_out,m-t.avail_out)?(r.mode=ft,O):(p-=t.avail_in,m-=t.avail_out,t.total_in+=p,t.total_out+=m,r.total+=m,r.wrap&&m&&(t.adler=r.check=r.flags?E(r.check,o,m,t.next_out-m):v(r.check,o,m,t.next_out-m)),t.data_type=r.bits+(r.last?64:0)+(r.mode===H?128:0)+(r.mode===et||r.mode===X?256:0),(0===p&&0===m||e===T)&&_t===A&&(_t=I),_t)}function d(t){if(!t||!t.state)return C;var e=t.state;return e.window&&(e.window=null),t.state=null,A}function p(t,e){var r;return t&&t.state?(r=t.state,0===(2&r.wrap)?C:(r.head=e,e.done=!1,A)):C}var m,g,y=t("../utils/common"),v=t("./adler32"),E=t("./crc32"),w=t("./inffast"),b=t("./inftrees"),x=0,_=1,S=2,T=4,L=5,M=6,A=0,N=1,R=2,C=-2,P=-3,O=-4,I=-5,k=8,D=1,V=2,F=3,G=4,B=5,W=6,U=7,j=8,z=9,K=10,q=11,H=12,Y=13,$=14,X=15,J=16,Z=17,Q=18,tt=19,et=20,rt=21,it=22,nt=23,ot=24,at=25,st=26,lt=27,ut=28,ct=29,ht=30,ft=31,dt=32,pt=852,mt=592,gt=15,yt=gt,vt=!0;r.inflateReset=a,r.inflateReset2=s,r.inflateResetKeep=o,r.inflateInit=u,r.inflateInit2=l,r.inflate=f,r.inflateEnd=d,r.inflateGetHeader=p,r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(t,e,r){var i=t("../utils/common"),n=15,o=852,a=592,s=0,l=1,u=2,c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,r,p,m,g,y,v){var E,w,b,x,_,S,T,L,M,A=v.bits,N=0,R=0,C=0,P=0,O=0,I=0,k=0,D=0,V=0,F=0,G=null,B=0,W=new i.Buf16(n+1),U=new i.Buf16(n+1),j=null,z=0;for(N=0;n>=N;N++)W[N]=0;for(R=0;p>R;R++)W[e[r+R]]++;for(O=A,P=n;P>=1&&0===W[P];P--);if(O>P&&(O=P),0===P)return m[g++]=20971520,m[g++]=20971520,v.bits=1,0;for(C=1;P>C&&0===W[C];C++);for(C>O&&(O=C),D=1,N=1;n>=N;N++)if(D<<=1,D-=W[N],0>D)return-1;if(D>0&&(t===s||1!==P))return-1;for(U[1]=0,N=1;n>N;N++)U[N+1]=U[N]+W[N];for(R=0;p>R;R++)0!==e[r+R]&&(y[U[e[r+R]]++]=R);if(t===s?(G=j=y,S=19):t===l?(G=c,B-=257,j=h,z-=257,S=256):(G=f,j=d,S=-1),F=0,R=0,N=C,_=g,I=O,k=0,b=-1,V=1<<O,x=V-1,t===l&&V>o||t===u&&V>a)return 1;for(var K=0;;){K++,T=N-k,y[R]<S?(L=0,M=y[R]):y[R]>S?(L=j[z+y[R]],M=G[B+y[R]]):(L=96,M=0),E=1<<N-k,w=1<<I,C=w;do w-=E,m[_+(F>>k)+w]=T<<24|L<<16|M|0;while(0!==w);for(E=1<<N-1;F&E;)E>>=1;if(0!==E?(F&=E-1,F+=E):F=0,R++,0===--W[N]){if(N===P)break;N=e[r+y[R]]}if(N>O&&(F&x)!==b){for(0===k&&(k=O),_+=C,I=N-k,D=1<<I;P>I+k&&(D-=W[I+k],!(0>=D));)I++,D<<=1;if(V+=1<<I,t===l&&V>o||t===u&&V>a)return 1;b=F&x,m[b]=O<<24|I<<16|_-g|0}}return 0!==F&&(m[_+F]=N-k<<24|64<<16|0),v.bits=O,0}},{"../utils/common":27}],37:[function(t,e,r){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(t,e,r){function i(t){for(var e=t.length;--e>=0;)t[e]=0}function n(t){return 256>t?at[t]:at[256+(t>>>7)]}function o(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function a(t,e,r){t.bi_valid>H-r?(t.bi_buf|=e<<t.bi_valid&65535,o(t,t.bi_buf),t.bi_buf=e>>H-t.bi_valid,t.bi_valid+=r-H):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function s(t,e,r){a(t,r[2*e],r[2*e+1])}function l(t,e){var r=0;do r|=1&t,t>>>=1,r<<=1;while(--e>0);return r>>>1}function u(t){16===t.bi_valid?(o(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function c(t,e){var r,i,n,o,a,s,l=e.dyn_tree,u=e.max_code,c=e.stat_desc.static_tree,h=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,d=e.stat_desc.extra_base,p=e.stat_desc.max_length,m=0;for(o=0;q>=o;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;K>r;r++)i=t.heap[r],o=l[2*l[2*i+1]+1]+1,o>p&&(o=p,m++),l[2*i+1]=o,i>u||(t.bl_count[o]++,a=0,i>=d&&(a=f[i-d]),s=l[2*i],t.opt_len+=s*(o+a),h&&(t.static_len+=s*(c[2*i+1]+a)));if(0!==m){do{for(o=p-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(i=t.bl_count[o];0!==i;)n=t.heap[--r],n>u||(l[2*n+1]!==o&&(t.opt_len+=(o-l[2*n+1])*l[2*n],l[2*n+1]=o),i--)}}function h(t,e,r){var i,n,o=new Array(q+1),a=0;for(i=1;q>=i;i++)o[i]=a=a+r[i-1]<<1;for(n=0;e>=n;n++){var s=t[2*n+1];0!==s&&(t[2*n]=l(o[s]++,s))}}function f(){var t,e,r,i,n,o=new Array(q+1);for(r=0,i=0;B-1>i;i++)for(lt[i]=r,t=0;t<1<<Q[i];t++)st[r++]=i;for(st[r-1]=i,n=0,i=0;16>i;i++)for(ut[i]=n,t=0;t<1<<tt[i];t++)at[n++]=i;for(n>>=7;j>i;i++)for(ut[i]=n<<7,t=0;t<1<<tt[i]-7;t++)at[256+n++]=i;for(e=0;q>=e;e++)o[e]=0;for(t=0;143>=t;)nt[2*t+1]=8,t++,o[8]++;for(;255>=t;)nt[2*t+1]=9,t++,o[9]++;for(;279>=t;)nt[2*t+1]=7,t++,o[7]++;for(;287>=t;)nt[2*t+1]=8,t++,o[8]++;for(h(nt,U+1,o),t=0;j>t;t++)ot[2*t+1]=5,ot[2*t]=l(t,5);ct=new dt(nt,Q,W+1,U,q),ht=new dt(ot,tt,0,j,q),ft=new dt(new Array(0),et,0,z,Y)}function d(t){var e;for(e=0;U>e;e++)t.dyn_ltree[2*e]=0;for(e=0;j>e;e++)t.dyn_dtree[2*e]=0;for(e=0;z>e;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*$]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function p(t){t.bi_valid>8?o(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function m(t,e,r,i){p(t),i&&(o(t,r),o(t,~r)),R.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function g(t,e,r,i){var n=2*e,o=2*r;return t[n]<t[o]||t[n]===t[o]&&i[e]<=i[r]}function y(t,e,r){for(var i=t.heap[r],n=r<<1;n<=t.heap_len&&(n<t.heap_len&&g(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!g(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i}function v(t,e,r){var i,o,l,u,c=0;if(0!==t.last_lit)do i=t.pending_buf[t.d_buf+2*c]<<8|t.pending_buf[t.d_buf+2*c+1],o=t.pending_buf[t.l_buf+c],c++,0===i?s(t,o,e):(l=st[o],s(t,l+W+1,e),u=Q[l],0!==u&&(o-=lt[l],a(t,o,u)),i--,l=n(i),s(t,l,r),u=tt[l],0!==u&&(i-=ut[l],a(t,i,u)));while(c<t.last_lit);s(t,$,e)}function E(t,e){var r,i,n,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=K,r=0;l>r;r++)0!==o[2*r]?(t.heap[++t.heap_len]=u=r,t.depth[r]=0):o[2*r+1]=0;for(;t.heap_len<2;)n=t.heap[++t.heap_len]=2>u?++u:0,o[2*n]=1,t.depth[n]=0,t.opt_len--,s&&(t.static_len-=a[2*n+1]);for(e.max_code=u,r=t.heap_len>>1;r>=1;r--)y(t,o,r);n=l;do r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],y(t,o,1),i=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=i,o[2*n]=o[2*r]+o[2*i],t.depth[n]=(t.depth[r]>=t.depth[i]?t.depth[r]:t.depth[i])+1,o[2*r+1]=o[2*i+1]=n,t.heap[1]=n++,y(t,o,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],c(t,e),h(o,u,t.bl_count)}function w(t,e,r){var i,n,o=-1,a=e[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),e[2*(r+1)+1]=65535,i=0;r>=i;i++)n=a,a=e[2*(i+1)+1],++s<l&&n===a||(u>s?t.bl_tree[2*n]+=s:0!==n?(n!==o&&t.bl_tree[2*n]++,t.bl_tree[2*X]++):10>=s?t.bl_tree[2*J]++:t.bl_tree[2*Z]++,s=0,o=n,0===a?(l=138,u=3):n===a?(l=6,u=3):(l=7,u=4))}function b(t,e,r){var i,n,o=-1,l=e[1],u=0,c=7,h=4;for(0===l&&(c=138,h=3),i=0;r>=i;i++)if(n=l,l=e[2*(i+1)+1],!(++u<c&&n===l)){if(h>u){do s(t,n,t.bl_tree);while(0!==--u)}else 0!==n?(n!==o&&(s(t,n,t.bl_tree),u--),s(t,X,t.bl_tree),a(t,u-3,2)):10>=u?(s(t,J,t.bl_tree),a(t,u-3,3)):(s(t,Z,t.bl_tree),a(t,u-11,7));u=0,o=n,0===l?(c=138,h=3):n===l?(c=6,h=3):(c=7,h=4)}}function x(t){var e;for(w(t,t.dyn_ltree,t.l_desc.max_code),w(t,t.dyn_dtree,t.d_desc.max_code),E(t,t.bl_desc),e=z-1;e>=3&&0===t.bl_tree[2*rt[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function _(t,e,r,i){var n;for(a(t,e-257,5),a(t,r-1,5),a(t,i-4,4),n=0;i>n;n++)a(t,t.bl_tree[2*rt[n]+1],3);b(t,t.dyn_ltree,e-1),b(t,t.dyn_dtree,r-1)}function S(t){var e,r=4093624447;for(e=0;31>=e;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return P;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return O;for(e=32;W>e;e++)if(0!==t.dyn_ltree[2*e])return O;return P}function T(t){mt||(f(),mt=!0),t.l_desc=new pt(t.dyn_ltree,ct),t.d_desc=new pt(t.dyn_dtree,ht),t.bl_desc=new pt(t.bl_tree,ft),t.bi_buf=0,t.bi_valid=0,d(t)}function L(t,e,r,i){a(t,(k<<1)+(i?1:0),3),m(t,e,r,!0)}function M(t){a(t,D<<1,3),s(t,$,nt),u(t)}function A(t,e,r,i){var n,o,s=0;t.level>0?(t.strm.data_type===I&&(t.strm.data_type=S(t)),E(t,t.l_desc),E(t,t.d_desc),s=x(t),n=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,n>=o&&(n=o)):n=o=r+5,n>=r+4&&-1!==e?L(t,e,r,i):t.strategy===C||o===n?(a(t,(D<<1)+(i?1:0),3),v(t,nt,ot)):(a(t,(V<<1)+(i?1:0),3),_(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),v(t,t.dyn_ltree,t.dyn_dtree)),d(t),i&&p(t)}function N(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(st[r]+W+1)]++,t.dyn_dtree[2*n(e)]++),t.last_lit===t.lit_bufsize-1}var R=t("../utils/common"),C=4,P=0,O=1,I=2,k=0,D=1,V=2,F=3,G=258,B=29,W=256,U=W+1+B,j=30,z=19,K=2*U+1,q=15,H=16,Y=7,$=256,X=16,J=17,Z=18,Q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],tt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],et=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],it=512,nt=new Array(2*(U+2));i(nt);var ot=new Array(2*j);i(ot);var at=new Array(it);i(at);var st=new Array(G-F+1);i(st);var lt=new Array(B);i(lt);var ut=new Array(j);i(ut);var ct,ht,ft,dt=function(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length},pt=function(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e},mt=!1;r._tr_init=T,r._tr_stored_block=L,r._tr_flush_block=A,r._tr_tally=N,r._tr_align=M},{"../utils/common":27}],39:[function(t,e,r){function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=i},{}]},{},[9])(9)}),i("../src/worldwind/formats/kml/KmlFileCache",[],function(){"use strict";var t=function(){this._rootFile=null,this._map={}};return t.prototype.retrieve=function(t){if(0==t.indexOf("#")||null==t||0!=t.indexOf("http"))return this._rootFile;var e=t;return-1!=t.indexOf("#")&&(e=t.substr(0,t.indexOf("#")-1)),this._map[e]?this._map[e]:null},t.prototype.add=function(t,e){this._rootFile?this._map[t]=e:this._rootFile=e},t}),i("../src/worldwind/formats/kml/styles/KmlStyleSelector",["./../KmlObject"],function(t){"use strict";var e=function(e){t.call(this,e)};return e.prototype=Object.create(t.prototype),e.prototype.getTagNames=function(){return["Style","StyleMap"]},e}),i("../src/worldwind/formats/kml/styles/KmlPolyStyle",["../../../util/Color","./KmlColorStyle","./../KmlElements","../util/NodeTransformers"],function(t,e,r,i){"use strict";var n=function(t){e.call(this,t)};return n.prototype=Object.create(e.prototype),Object.defineProperties(n.prototype,{kmlFill:{get:function(){return this._factory.specific(this,{name:"fill",transformer:i["boolean"]})}},kmlOutline:{get:function(){return this._factory.specific(this,{name:"outline",transformer:i["boolean"]})}}}),n.update=function(e,r){e=e||{};var i=r||{};return i._drawInterior=e.kmlFill||!0,i._drawOutline=e.kmlOutline||!1,i._outlineColor=r._outlineColor||t.WHITE,i._interiorColor=e.kmlColor&&t.colorFromKmlHex(e.kmlColor)||t.WHITE,i._colorMode=e.kmlColorMode||"normal",i},n.prototype.getTagNames=function(){return["PolyStyle"]},r.addKey(n.prototype.getTagNames()[0],n),n}),i("../src/worldwind/formats/kml/KmlLink",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t),this.onChangeListeners=[]};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlHref:{get:function(){return this._factory.specific(this,{name:"href",transformer:r.string})}},kmlRefreshMode:{get:function(){return this._factory.specific(this,{name:"refreshMode",transformer:r.string})}},kmlRefreshInterval:{get:function(){return this._factory.specific(this,{name:"refreshInterval",transformer:r.number})}},kmlViewRefreshMode:{get:function(){return this._factory.specific(this,{name:"viewRefreshMode",transformer:r.string})}},kmlViewRefreshTime:{get:function(){return this._factory.specific(this,{name:"viewRefreshTime",transformer:r.number})}},kmlViewBoundScale:{get:function(){return this._factory.specific(this,{name:"viewBoundScale",transformer:r.number})}},kmlViewFormat:{get:function(){return this._factory.specific(this,{name:"viewFormat",transformer:r.string})}},kmlHttpQuery:{get:function(){return this._factory.specific(this,{name:"httpQuery",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["Link"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/KmlIcon",["./KmlLink","./KmlElements","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(e){t.call(this,e)};return i.prototype=Object.create(t.prototype),Object.defineProperties(i.prototype,{kmlX:{get:function(){return this._factory.specific(this,{name:"gx:x",transformer:r.number})}},kmlY:{get:function(){return this._factory.specific(this,{name:"gx:y",transformer:r.number})}},kmlW:{get:function(){return this._factory.specific(this,{name:"gx:w",transformer:r.number})}},kmlH:{get:function(){return this._factory.specific(this,{name:"gx:h",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["Icon"]},e.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/styles/KmlIconStyle",["./KmlColorStyle","./../KmlElements","../KmlIcon","../util/NodeTransformers"],function(t,e,r,i){"use strict";var n=function(e){t.call(this,e)};return n.prototype=Object.create(t.prototype),Object.defineProperties(n.prototype,{kmlScale:{get:function(){return this._factory.specific(this,{name:"scale",transformer:i.number})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:i.number})}},kmlIcon:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}},kmlHotSpotX:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:i.attribute("x")})}},kmlHotSpotY:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:i.attribute("y")})}},kmlHotSpotXUnits:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:i.attribute("xunits")})}},kmlHotSpotYUnits:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:i.attribute("yunits")})}}}),n.update=function(t,e){t=t||{};var r=e||{};return r._imageScale=t.kmlScale||1,r._imageSource=t.kmlIcon&&t.kmlIcon.kmlHref||null,r},n.prototype.getTagNames=function(){return["IconStyle"]},e.addKey(n.prototype.getTagNames()[0],n),n}),i("../src/worldwind/formats/kml/styles/KmlLabelStyle",["./KmlColorStyle","../KmlElements","../util/NodeTransformers"],function(t,e,r){"use strict";var i=function(e){t.call(this,e)};return i.prototype=Object.create(t.prototype),Object.defineProperties(i.prototype,{kmlScale:{get:function(){return this._factory.specific(this,{name:"scale",transformer:r.number})}}}),i.update=function(){},i.prototype.getTagNames=function(){return["LabelStyle"]},e.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/styles/KmlLineStyle",["../../../util/Color","./KmlColorStyle","./../KmlElements","../util/NodeTransformers"],function(t,e,r,i){"use strict";var n=function(t){e.call(this,t)};return n.prototype=Object.create(e.prototype),Object.defineProperties(n.prototype,{kmlWidth:{get:function(){return this._factory.specific(this,{name:"width",transformer:i.number})}},kmlOuterColor:{get:function(){return this._factory.specific(this,{name:"gx:outerColor",transformer:i.string})}},kmlOuterWidth:{get:function(){return this._factory.specific(this,{name:"gx:outerWidth",transformer:i.number})}},kmlPhysicalWidth:{get:function(){return this._factory.specific(this,{name:"gx:physicalWidth",transformer:i.number})}},kmlLabelVisibility:{get:function(){return this._factory.specific(this,{name:"gx:labelVisibility",transformer:i["boolean"]})}}}),n.update=function(e,r){var i=r||{};return e=e||{},i._outlineColor=e.kmlColor&&t.colorFromKmlHex(e.kmlColor)||t.WHITE,i._outlineWidth=e.kmlWidth||10,i},n.prototype.getTagNames=function(){return["LineStyle"]},r.addKey(n.prototype.getTagNames()[0],n),n}),i("../src/worldwind/formats/kml/styles/KmlListStyle",["../util/ItemIcon","../KmlElements","./KmlSubStyle","../util/NodeTransformers"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,t)};return n.prototype=Object.create(r.prototype),Object.defineProperties(n.prototype,{kmlBgColor:{get:function(){return this._factory.specific(this,{name:"bgColor",transformer:i.string})}},kmlListItemType:{get:function(){return this._factory.specific(this,{name:"listItemType",transformer:i.string})}},kmlItemIcon:{get:function(){return this._factory.any(this,{name:t.prototype.getTagNames()})}}}),n.update=function(t){},n.prototype.getTagNames=function(){return["ListStyle"]},e.addKey(n.prototype.getTagNames()[0],n),n}),i("../src/worldwind/formats/kml/styles/KmlStyle",["../../../util/Color","../../../util/Font","./KmlStyleSelector","./../KmlElements","./KmlPolyStyle","./KmlIconStyle","./KmlLabelStyle","./KmlLineStyle","./KmlListStyle","./KmlBalloonStyle","../../../util/Offset","../../../util/Promise","../../../shapes/ShapeAttributes","../../../shapes/TextAttributes"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d){"use strict";var p=function(t){r.call(this,t)};return p.prototype=Object.create(r.prototype),Object.defineProperties(p.prototype,{kmlIconStyle:{get:function(){return this._factory.any(this,{name:o.prototype.getTagNames()})}},kmlLabelStyle:{get:function(){return this._factory.any(this,{name:a.prototype.getTagNames()})}},kmlLineStyle:{get:function(){return this._factory.any(this,{name:s.prototype.getTagNames()})}},kmlPolyStyle:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}},kmlBalloonStyle:{get:function(){return this._factory.any(this,{name:u.prototype.getTagNames()})}},kmlListStyle:{get:function(){return this._factory.any(this,{name:l.prototype.getTagNames()})}}}),p.prototype.generate=function(t){t=t||{};var e=this||{};return e.kmlIconStyle&&o.update(e.kmlIconStyle,t),e.kmlListStyle&&l.update(e.kmlListStyle,t),e.kmlBalloonStyle&&u.update(e.kmlBalloonStyle,t),e.kmlLabelStyle&&a.update(e.kmlLabelStyle,t),e.kmlPolyStyle&&n.update(e.kmlPolyStyle,t),e.kmlLineStyle&&s.update(e.kmlLineStyle,t),t},p.prototype.getStyle=function(){var t=this;return new h(function(e){window.setTimeout(function(){e(t)},0)})},p.prototype.getTagNames=function(){return["Style"]},i.addKey(p.prototype.getTagNames()[0],p),p.placemarkAttributes=function(e){return e=e||{},e._imageColor=e._imageColor||new t(1,1,1,1),e._imageOffset=e._imageOffset||new c(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),e._imageScale=e._imageScale||1,e._imageSource=e._imageSource||null,e._depthTest=e._depthTest||!0,e._labelAttributes=e._labelAttributes||new d(p.textAttributes()),e._drawLeaderLine=e._drawLeaderLine||!1,e._leaderLineAttributes=e._leaderLineAttributes||new f(p.shapeAttributes()),e},p.textAttributes=function(r){return r=r||{},r._color=r._color||new t(1,1,1,1),r._font=r._font||new e(14),r._offset=r._offset||new c(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0),r._scale=r._scale||1,r._depthTest=r._depthTest||!1,r},p.shapeAttributes=function(e){return e=e||{},e._drawInterior=e._drawInterior||!0,e._drawOutline=e._drawOutline||!0,e._enableLighting=e._enableLighting||!1,e._interiorColor=e._interiorColor||t.WHITE,e._outlineColor=e._outlineColor||t.RED,e._outlineWidth=e._outlineWidth||1,e._outlineStippleFactor=e._outlineStippleFactor||0,e._outlineStipplePattern=e._outlineStipplePattern||61680,e._imageSource=e._imageSource||null,e._depthTest=e._depthTest||!0,e._drawVerticals=e._drawVerticals||!1,e._applyLighting=e._applyLighting||!1,e},p}),i("../src/worldwind/formats/kml/util/StyleResolver",["../KmlFile","../../../util/Logger"],function(t,e){"use strict";var r=function(t){this._fileCache=t};return r.prototype.handleRemoteStyle=function(t,r,i,n,o){t?this.handleStyleUrl(t,i,n,o):r?this.handleStyleSelector(r,i,n):e.logMessage(e.LEVEL_WARNING,"StyleResolver","handleRemoteStyle","Style was null.")},r.prototype.handleStyleUrl=function(t,e,r,i){var n=this;i=this.handlePromiseOfFile(t,i),i.then(function(r){r.resolveStyle(t).then(function(t){t.isMap?t.resolve(e,n):e({normal:t,highlight:null})})})},r.prototype.handlePromiseOfFile=function(t,e){return e||(e=this._fileCache.retrieve(t),e||(e=new WorldWind.KmlFile({url:t}),this._fileCache.add(e))),e},r.prototype.handleStyleSelector=function(t,e,r){t.isMap?t.resolve(e,this):window.setTimeout(function(){e({normal:t,highlight:null})},0)},r}),i("../src/worldwind/formats/kml/util/Pair",["./../KmlElements","../KmlObject","../styles/KmlStyleSelector","./NodeTransformers","../../../util/Promise","../util/StyleResolver"],function(t,e,r,i,n,o){"use strict";var a=function(t){e.call(this,t)};return a.prototype=Object.create(e.prototype),Object.defineProperties(a.prototype,{kmlKey:{get:function(){return this._factory.specific(this,{name:"key",transformer:i.string})}},kmlStyleUrl:{get:function(){return this._factory.specific(this,{name:"styleUrl",transformer:i.string})}},kmlStyleSelector:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}}}),a.prototype.getTagNames=function(){return["Pair"]},a.prototype.getStyle=function(t){var e=this;return new n(function(r,i){window.setTimeout(function(){t.handleRemoteStyle(e.kmlStyleUrl,e.kmlStyleSelector,r,i)},0)})},t.addKey(a.prototype.getTagNames()[0],a),a}),i("../src/worldwind/formats/kml/styles/KmlStyleMap",["../KmlElements","./KmlSubStyle","../util/Pair","../../../util/Promise"],function(t,e,r,i){"use strict";var n=function(t){e.call(this,t)};return n.prototype=Object.create(e.prototype),Object.defineProperties(n.prototype,{kmlPairs:{get:function(){return this._factory.all(this)}},isMap:{get:function(){return!0}}}),n.prototype.resolve=function(t,e){var r=this,n={},o=[],a=r.kmlPairs;a.forEach(function(t){var r=t.kmlKey,i=t.getStyle(e);o.push(i),i.then(function(t){n[r]=t.normal})});var s=i.all(o);s.then(function(){n.normal||(n.normal=null),n.highlight||(n.highlight=null),
t(n)})},n.prototype.getTagNames=function(){return["StyleMap"]},t.addKey(n.prototype.getTagNames()[0],n),n}),i("../src/worldwind/formats/kml/KmlTimeSpan",["./KmlElements","./KmlTimePrimitive","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){t.isTimeSpan=!0,e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlBegin:{get:function(){return this._factory.specific(this,{name:"begin",transformer:r.date})}},kmlEnd:{get:function(){return this._factory.specific(this,{name:"end",transformer:r.date})}}}),i.prototype.getTagNames=function(){return["TimeSpan"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/KmlTimeStamp",["./KmlElements","./KmlTimePrimitive","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){t.isTimeStamp=!0,e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlWhen:{get:function(){return this._factory.specific(this,{name:"when",transformer:r.date})}}}),i.prototype.getTagNames=function(){return["TimeStamp"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/util/RefreshListener",[],function(){var t=function(){this.currentActiveEvents=[]};return t.prototype.addEvent=function(t){var e=this;setTimeout(function(){e.currentActiveEvents.push(t)},t.time)},t.prototype.getActiveEvents=function(){var t=this.currentActiveEvents.slice();return this.currentActiveEvents=[],t},t.Event=function(t,e,r){this.type=t,this.payload=r,this.time=e},t}),i("../src/worldwind/formats/kml/util/RemoteFile",["../../../error/ArgumentError","../../../util/Logger","../../../util/Promise"],function(t,e,r){"use strict";var i=function(r){if(!r.ajax&&!r.zip)throw new t(e.logMessage(e.LEVEL_SEVERE,"RemoteDocument","constructor","Invalid option for retrieval specified. Use either ajax or zip option."));this.options=r};return i.prototype.get=function(){var r=this.options;if(r.ajax)return this.ajax(r.url,r);if(r.zip)return r.responseType=r.responseType||"arraybuffer",this.ajax(r.url,r);throw new t(e.logMessage(e.LEVEL_SEVERE,"RemoteDocument","constructor","Invalid option for retrieval specified. Use either ajax or zip option."))},i.prototype.ajax=function(t,i){return new r(function(r,n){var o=new XMLHttpRequest;o.open("GET",t,!0),i.responseType&&(o.responseType=i.responseType),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var n;n="arraybuffer"==i.responseType?this.response:this.responseText,r({text:n,headers:o.getAllResponseHeaders()})}else e.log(e.LEVEL_WARNING,"KmlFile retrieval failed ("+o.statusText+"): "+t)},o.onerror=function(){e.log(e.LEVEL_WARNING,"Remote file retrieval failed: "+t),n()}.bind(this),o.ontimeout=function(){e.log(e.LEVEL_WARNING,"Remote file retrieval timed out: "+t),n()}.bind(this),o.send(null)})},i}),i("../src/worldwind/util/XmlDocument",["../error/ArgumentError","../util/Logger"],function(t,e){var r=function(t){this._document=t};return r.prototype.dom=function(){if(DOMParser){var r=new DOMParser,i=r.parseFromString(this._document,"text/xml");if(i.getElementsByTagName("parsererror").length||!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"XmlDocument","dom","Invalid XML document. "+i.getElementsByTagName("parsererror")[0].innerHTML));return i}var n=new ActiveXObject("Microsoft.XMLDOM");return n.async=!1,n.loadXML(text),n},r.isValid=function(t){try{return new r(t).dom(),!0}catch(e){return!1}},r}),i("../src/worldwind/formats/kml/KmlFile",["../../error/ArgumentError","../../util/jszip","./KmlElements","./KmlFileCache","./KmlObject","./styles/KmlStyle","./styles/KmlStyleMap","./KmlTimeSpan","./KmlTimeStamp","../../util/Logger","../../util/Promise","./util/RefreshListener","./util/RemoteFile","./util/StyleResolver","../../util/XmlDocument","../../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m){"use strict";var g=function(r,o){var a=this;if(!r)throw new t(u.logMessage(u.LEVEL_SEVERE,"KmlFile","constructor","invalidDocumentPassed"));this._controls=o||null,this._fileCache=new i,this._styleResolver=new d(this._fileCache),this._listener=new h,this._headers=null;var s;return s=new c(function(t){var i=a.requestRemote(r);i.then(function(i){var s=null,l=i.text;if(a._headers=i.headers,a.hasExtension("kmz",r)){var u=new e;u.load(l);for(var c in u.files){var h=u.files[c];null==s&&a.hasExtension("kml",h.name)&&(s=h.asText())}}else s=l;a._document=new p(s).dom(),n.call(a,{objectNode:a._document.documentElement,controls:o}),window.setTimeout(function(){t(a)},0)})}),this._fileCache.add(r,s),s};return g.prototype=Object.create(n.prototype),Object.defineProperties(g.prototype,{shapes:{get:function(){return this._factory.all(this)}}}),g.prototype.render=function(t,e){var r=this;e=e||{},this.shapes.forEach(function(i){i.render(t,{lastStyle:e.lastStyle||null,lastVisibility:e.lastVisibility||null,currentTimeInterval:e.currentTimeInterval||null,regionInvisible:e.regionInvisible||null,fileCache:r._fileCache,styleResolver:r._styleResolver,listener:r._listener,activeEvents:r._listener.getActiveEvents()})})},g.prototype.hasExtension=function(t,e){return m.endsWith(e,"."+t)},g.prototype.requestRemote=function(t){var e={};return e.url=t,this.hasExtension("kmz",t)?e.zip=!0:e.ajax=!0,new f(e).get()},g.prototype.resolveStyle=function(t){var e=this,r=t.substring(t.indexOf("#")+1,t.length);return new c(function(t,i){var n;n=e._document.querySelector?e._document.querySelector("*[id='"+r+"']"):e._document.getElementById(r),n&&null!=n||i(),n.nodeName==o.prototype.getTagNames()[0]?t(new o({objectNode:n},{styleResolver:e._styleResolver})):n.nodeName==a.prototype.getTagNames()[0]?t(new a({objectNode:n},{styleResolver:e._styleResolver})):u.logMessage(u.LEVEL_WARNING,"KmlFile","resolveStyle","Style must contain either Style node or StyleMap node.")})},g.prototype.getExpired=function(){var t=new Date(this._headers.getRequestHeader("Expires")),e=new Date;return e.getTime-t.getTime()},g}),i("../src/worldwind/formats/kml/KmlLatLonAltBox",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlNorth:{get:function(){return this._factory.specific(this,{name:"north",transformer:r.number})}},kmlSouth:{get:function(){return this._factory.specific(this,{name:"south",transformer:r.number})}},kmlEast:{get:function(){return this._factory.specific(this,{name:"east",transformer:r.number})}},kmlWest:{get:function(){return this._factory.specific(this,{name:"west",transformer:r.number})}},kmlMinAltitude:{get:function(){return this._factory.specific(this,{name:"minAltitude",transformer:r.number})}},kmlMaxAltitude:{get:function(){return this._factory.specific(this,{name:"maxAltitude",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["LatLonAltBox"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/KmlLod",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlMinLodPixels:{get:function(){return this._factory.specific(this,{name:"minLodPixels",transformer:r.number})}},kmlMaxLodPixels:{get:function(){return this._factory.specific(this,{name:"maxLodPixels",transformer:r.number})}},kmlMinFadeExtent:{get:function(){return this._factory.specific(this,{name:"minFadeExtent",transformer:r.number})}},kmlMaxFadeExtent:{get:function(){return this._factory.specific(this,{name:"maxFadeExtent",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["Lod"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/KmlRegion",["../../geom/BoundingBox","../../util/Color","./KmlElements","./KmlLatLonAltBox","./KmlLod","./KmlObject","./styles/KmlStyle","./util/NodeTransformers","../../geom/Sector"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(t){o.call(this,t)};return u.prototype=Object.create(o.prototype),Object.defineProperties(u.prototype,{kmlLatLonAltBox:{get:function(){return this._factory.specific(this,{name:i.prototype.getTagNames(),transformer:s.kmlObject})}},kmlLod:{get:function(){return this._factory.specific(this,{name:n.prototype.getTagNames(),transformer:s.kmlObject})}}}),u.prototype.intersectsVisible=function(e){var r=this.kmlLatLonAltBox,i=new t;return i.setToSector(new l(r.kmlSouth,r.kmlNorth,r.kmlWest,r.kmlEast),e.globe,r.kmlMinAltitude,r.kmlMaxAltitude),i.intersectsFrustum(e.navigatorState.frustumInModelCoordinates)&&(!r.kmlMinAltitude||e.eyePosition.altitude>r.kmlMinAltitude)&&(!r.kmlMaxAltitude||e.eyePosition.altitude<r.kmlMaxAltitude)},u.prototype.getTagNames=function(){return["Region"]},r.addKey(u.prototype.getTagNames()[0],u),u}),i("../src/worldwind/formats/kml/features/KmlFeature",["./../KmlObject","../KmlAbstractView","../KmlFile","../styles/KmlStyleMap","../styles/KmlStyleSelector","../KmlRegion","../KmlTimePrimitive","../util/NodeTransformers","../../../util/Promise"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(e){this.isFeature=e.isFeature=!0,t.call(this,e),this._pStyle=null,this.controlledVisibility=null};return u.prototype=Object.create(t.prototype),Object.defineProperties(u.prototype,{style:{get:function(){return this._pStyle}},kmlName:{get:function(){return this._factory.specific(this,{name:"name",transformer:s.string})}},kmlVisibility:{get:function(){return this._factory.specific(this,{name:"visibility",transformer:s["boolean"]})}},kmlOpen:{get:function(){return this._factory.specific(this,{name:"open",transformer:s["boolean"]})}},kmlAddress:{get:function(){return this._factory.specific(this,{name:"address",transformer:s.string})}},kmlPhoneNumber:{get:function(){return this._factory.specific(this,{name:"phoneNumber",transformer:s.string})}},kmlDescription:{get:function(){return this._factory.specific(this,{name:"description",transformer:s.string})}},kmlStyleUrl:{get:function(){return this._factory.specific(this,{name:"styleUrl",transformer:s.string})}},kmlSnippet:{get:function(){return this._factory.specific(this,{name:"Snippet",transformer:s.string})}},kmlAbstractView:{get:function(){return this._factory.any(this,{name:e.prototype.getTagNames()})}},kmlTimePrimitive:{get:function(){return this._factory.any(this,{name:a.prototype.getTagNames()})}},kmlStyleSelector:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}},kmlRegion:{get:function(){return this._factory.any(this,{name:o.prototype.getTagNames()})}}}),u.prototype.render=function(e,r){t.prototype.render.call(this,e,r),this.solveStyle(e,r),this.solveVisibility(e,r)},u.prototype.solveStyle=function(t,e){this.getStyle(t,e),null!=this.style&&(e.lastStyle=this.style)},u.prototype.solveRegion=function(t){return this.kmlRegion?this.kmlRegion.intersectsVisible(t):!0},u.prototype.solveVisibility=function(t,e){var r=e.lastVisibility!==!1,i=this.solveTimeVisibility(t),n=this.solveRegion(t),o=this.kmlVisibility!==!1,a=this.controlledVisibility!==!1;this.enabled=r&&i&&n&&o&&a,e.lastVisibility=this.enabled,this._renderable&&(this._renderable.enabled=this.enabled)},u.prototype.solveTimeVisibility=function(t){var e=this.kmlTimePrimitive&&this.kmlTimePrimitive.timeRange();if(t.currentLayer.currentTimeInterval&&e){var r=t.currentLayer.currentTimeInterval[0],i=t.currentLayer.currentTimeInterval[1];if(e&&(e.from<r||e.from>i||e.to>i))return!1}return!0},u.prototype.getStyle=function(t,e){if(!this._pStyle&&(this.kmlStyleUrl||this.kmlStyleSelector)){var r=this;new l(function(t,i){window.setTimeout(function(){e.styleResolver.handleRemoteStyle(r.kmlStyleUrl,r.kmlStyleSelector,t,i)},0)}).then(function(e){r._pStyle=e,t.redrawRequested=!0})}},u.prototype.getTagNames=function(){return["NetworkLink","Placemark","PhotoOverlay","ScreenOverlay","GroundOverlay","Folder","Document"]},u}),i("../src/worldwind/formats/kml/features/KmlContainer",["./KmlFeature"],function(t){"use strict";var e=function(e){t.call(this,e)};return e.prototype=Object.create(t.prototype),Object.defineProperties(e.prototype,{kmlShapes:{get:function(){var t=this._factory.all(this);return t.filter(function(t){return t.isFeature})}}}),e.prototype.render=function(e,r){t.prototype.render.call(this,e,r);var i=this;this.kmlShapes.forEach(function(t){t.render(e,{lastStyle:r.lastStyle,lastVisibility:i.enabled,currentTimeInterval:r.currentTimeInterval,regionInvisible:r.regionInvisible,fileCache:r.fileCache,styleResolver:r.styleResolver,listener:r.listener,activeEvents:r.activeEvents})})},e.prototype.getTagNames=function(){return["Folder","Document"]},e}),i("../src/worldwind/formats/kml/util/Schema",["./../KmlElements","../KmlObject"],function(t,e){"use strict";var r=function(t){e.call(this,t)};return r.prototype=Object.create(e.prototype),r.prototype.getTagNames=function(){return["Schema"]},t.addKey(r.prototype.getTagNames()[0],r),r}),i("../src/worldwind/formats/kml/features/KmlDocument",["./KmlContainer","../KmlElements","./KmlFeature","../util/Schema"],function(t,e,r,i){"use strict";var n=function(e){t.call(this,e)};return n.prototype=Object.create(t.prototype),Object.defineProperties(n.prototype,{kmlSchemas:{get:function(){var t=this._factory.all(this);return t.filter(function(t){return t instanceof i})}}}),n.prototype.getTagNames=function(){return["Document"]},e.addKey(n.prototype.getTagNames()[0],n),n}),i("../src/worldwind/formats/kml/features/KmlFolder",["./KmlContainer","./../KmlElements"],function(t,e){"use strict";var r=function(e){t.call(this,e)};return r.prototype=Object.create(t.prototype),r.prototype.getTagNames=function(){return["Folder"]},e.addKey(r.prototype.getTagNames()[0],r),r}),i("../src/worldwind/formats/kml/geom/KmlGeometry",["../KmlObject"],function(t){"use strict";var e=function(e){t.call(this,e),this._renderable=null};return e.prototype=Object.create(t.prototype),e.prototype.render=function(e,r){t.prototype.render.call(this,e,r),this.enabled=r.lastVisibility},e.prototype.getTagNames=e.getTagNames=function(){return["Point","LinearRing","LineString","MultiGeometry","Polygon"]},e}),i("../src/worldwind/formats/kml/KmlLatLonBox",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlNorth:{get:function(){return this._factory.specific(this,{name:"north",transformer:r.number})}},kmlSouth:{get:function(){return this._factory.specific(this,{name:"south",transformer:r.number})}},kmlEast:{get:function(){return this._factory.specific(this,{name:"east",transformer:r.number})}},kmlWest:{get:function(){return this._factory.specific(this,{name:"west",transformer:r.number})}},kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["LatLonBox"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/KmlLatLonQuad",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlCoordinates:{get:function(){return this._factory.specific(this,{name:"coordinates",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["gx:LatLonQuad"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/features/KmlOverlay",["./KmlFeature","./../KmlIcon","../util/NodeTransformers"],function(t,e,r){"use strict";var i=function(e){t.call(this,e)};return i.prototype=Object.create(t.prototype),Object.defineProperties(i.prototype,{kmlColor:{get:function(){return this._factory.specific(this,{name:"color",transformer:r.string})}},kmlDrawOrder:{get:function(){return this._factory.specific(this,{name:"drawOrder",transformer:r.string})}},kmlIcon:{get:function(){return this._factory.any(this,{name:e.prototype.getTagNames()})}}}),i.prototype.getTagNames=function(){return["PhotoOverlay","ScreenOverlay","GroundOverlay"]},i}),i("../src/worldwind/formats/kml/features/KmlGroundOverlay",["./../KmlElements","./KmlFeature","../KmlLatLonBox","../KmlLatLonQuad","./KmlOverlay","../util/NodeTransformers","../../../geom/Sector","../../../shapes/SurfaceImage"],function(t,e,r,i,n,o,a,s){"use strict";var l=function(t){this.isGroundOverlay=!0,n.call(this,t)};return l.prototype=Object.create(n.prototype),Object.defineProperties(l.prototype,{kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:o.string})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:o.string})}},kmlLatLonBox:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}},kmlLatLonQuad:{get:function(){return this._factory.any(this,{name:i.prototype.getTagNames()})}}}),l.prototype.render=function(t,r){e.prototype.render.call(this,t,r),!this._renderable&&this.enabled&&this.kmlIcon&&this.kmlLatLonBox&&(this._renderable=new s(new a(this.kmlLatLonBox.kmlSouth,this.kmlLatLonBox.kmlNorth,this.kmlLatLonBox.kmlWest,this.kmlLatLonBox.kmlEast),this.kmlIcon.kmlHref),t.redrawRequested=!0),this._renderable&&this._renderable.render(t)},l.prototype.getTagNames=function(){return["GroundOverlay"]},t.addKey(l.prototype.getTagNames()[0],l),l}),i("../src/worldwind/shapes/Path",["../shapes/AbstractShape","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolyline","../geom/Vec2","../geom/Vec3"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d){"use strict";var p=function(r,i){if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Path","constructor","missingPositions"));t.call(this,i),this._positions=r,this._pathType=WorldWind.GREAT_CIRCLE,this._terrainConformance=10,this._numSubSegments=10,this.referencePosition=this.determineReferencePosition(this._positions),this.scratchPoint=new d(0,0,0)};return p.prototype=Object.create(t.prototype),Object.defineProperties(p.prototype,{positions:{get:function(){return this._positions},set:function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Path","constructor","missingPositions"));this._positions=t,this.referencePosition=this.determineReferencePosition(this._positions),this.reset()}},followTerrain:{get:function(){return this._followTerrain},set:function(t){this._followTerrain=t,this.reset()}},terrainConformance:{get:function(){return this._terrainConformance},set:function(t){this._terrainConformance=t,this.reset()}},numSubSegments:{get:function(){return this._numSubSegments},set:function(t){this._numSubSegments=t>=0?t:0,this.reset()}},pathType:{get:function(){return this._pathType},set:function(t){this._pathType=t,this.reset()}},extrude:{get:function(){return this._extrude},set:function(t){this._extrude=t,this.reset()}}}),p.prototype.determineReferencePosition=function(t){return t.length>0?t[0]:null},p.prototype.mustGenerateGeometry=function(t){return this.currentData.tessellatedPoints?this.currentData.drawInterior!==this.activeAttributes.drawInterior||this.currentData.drawVerticals!==this.activeAttributes.drawVerticals?!0:this.followTerrain||this.currentData.numSubSegments===this.numSubSegments?this.followTerrain&&this.currentData.terrainConformance!==this.terrainConformance?!0:this.altitudeMode===WorldWind.ABSOLUTE?!1:this.currentData.isExpired:!0:!0},p.prototype.createSurfaceShape=function(){return new h(this.positions,null)},p.prototype.doMakeOrderedRenderable=function(t){if(!this.referencePosition)return null;if(!this.mustGenerateGeometry(t))return this;var e=this.currentData.referencePoint;t.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude,this._altitudeMode,e),this.currentData.transformationMatrix.setToTranslation(e[0],e[1],e[2]);var r=this.makeTessellatedPositions(t);if(r.length<2)return null;var n=this.computeRenderedPath(t,r);return this.currentData.tessellatedPoints=n,this.currentData.drawInterior=this.activeAttributes.drawInterior,this.currentData.drawVerticals=this.activeAttributes.drawVerticals,this.currentData.numSubSegments=this.numSubSegments,this.currentData.terrainConformance=this.terrainConformance,this.resetExpiration(this.currentData),this.currentData.fillVbo=!0,this.currentData.extent||(this.currentData.extent=new i),this.currentData.extent.setToPoints(n),this.currentData.extent.translate(this.currentData.referencePoint),this},p.prototype.makeTessellatedPositions=function(t){var e,r,i,n=[],o=t.navigatorState,a=this.mustDrawVerticals(t),s=new d(0,0,0),l=new d(0,0,0),u=this._positions[0];a&&(this.currentData.verticalIndices=new Int16Array(2*this.positions.length),this.currentData.verticalIndices[0]=0,this.currentData.verticalIndices[1]=1),n.push(u),t.surfacePointForMode(u.latitude,u.longitude,u.altitude,this._altitudeMode,s);for(var c=1,h=this._positions.length;h>c;c++)if(e=this._positions[c],t.surfacePointForMode(e.latitude,e.longitude,e.altitude,this._altitudeMode,l),r=o.eyePoint.distanceTo(s),i=o.pixelSizeAtDistance(r),s.distanceTo(l)<8*i&&this.altitudeMode!==WorldWind.ABSOLUTE?n.push(e):this.makeSegment(t,u,e,s,l,n),u=e,s.copy(l),a){var f=2*(n.length-1);this.currentData.verticalIndices[2*c]=f,this.currentData.verticalIndices[2*c+1]=f+1}return n},p.prototype.makeSegment=function(t,e,r,i,n,a){var s,l,c,h,f,d,p=t.navigatorState,m=p.eyePoint,g=new o(0,0),y=0;if(this._pathType===WorldWind.LINEAR&&!this._followTerrain)return void(i.equals(n)||a.push(r));if(c=this._pathType===WorldWind.LINEAR?o.linearDistance(e,r):this._pathType===WorldWind.RHUMB_LINE?o.rhumbDistance(e,r):o.greatCircleDistance(e,r),this._altitudeMode!==WorldWind.CLAMP_TO_GROUND&&(y=.5*(e.altitude+r.altitude)),s=c*(t.globe.equatorialRadius+y*t.verticalExaggeration),!(0>=s)){for(l=this._pathType===WorldWind.LINEAR?o.linearAzimuth(e,r):this._pathType===WorldWind.RHUMB_LINE?o.rhumbAzimuth(e,r):o.greatCircleAzimuth(e,r),this.scratchPoint.copy(i),h=0,f=0;1>h&&(f+=this._followTerrain?this._terrainConformance*p.pixelSizeAtDistance(this.scratchPoint.distanceTo(m)):s/this._numSubSegments,!(f>s||1e-9>s-f));)h=f/s,d=h*c,this._pathType===WorldWind.LINEAR?o.linearLocation(e,l,d,g):this._pathType===WorldWind.RHUMB_LINE?o.rhumbLocation(e,l,d,g):o.greatCircleLocation(e,l,d,g),g.altitude=(1-h)*e.altitude+h*r.altitude,a.push(new u(g.latitude,g.longitude,g.altitude)),this._followTerrain&&t.surfacePointForMode(g.latitude,g.longitude,g.altitude,WorldWind.CLAMP_TO_GROUND,this.scratchPoint);a.push(r)}},p.prototype.computeRenderedPath=function(t,e){var r,i,n,o,a=this.mustDrawInterior(t)||this.mustDrawVerticals(t),s=Number.MAX_VALUE,l=t.navigatorState.eyePoint,u=(a?2:1)*e.length,c=new Float32Array(3*u),h=a?6:3,f=new d(0,0,0);r=this._followTerrain&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND?WorldWind.RELATIVE_TO_GROUND:this.altitudeMode;for(var p=0,m=e.length;m>p;p++)i=e[p],t.surfacePointForMode(i.latitude,i.longitude,i.altitude,r,f),o=f.distanceToSquared(l),s>o&&(s=o),f.subtract(this.currentData.referencePoint),n=h*p,c[n]=f[0],c[n+1]=f[1],c[n+2]=f[2],a&&(t.surfacePointForMode(i.latitude,i.longitude,0,WorldWind.CLAMP_TO_GROUND,f),o=f.distanceToSquared(l),s>o&&(s=o),f.subtract(this.currentData.referencePoint),c[n+3]=f[0],c[n+4]=f[1],c[n+5]=f[2]);return this.currentData.pointBufferHasExtrusionPoints=a,this.currentData.eyeDistance=Math.sqrt(s),c},p.prototype.mustDrawInterior=function(t){return this.activeAttributes.drawInterior&&this._extrude&&this._altitudeMode!==WorldWind.CLAMP_TO_GROUND},p.prototype.mustDrawVerticals=function(t){return this.activeAttributes.drawOutline&&this.activeAttributes.drawVerticals&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND},p.prototype.doRenderOrdered=function(t){var e,r,i,n,o,a,s=t.currentGlContext,u=t.currentProgram,c=this.currentData,h=c.tessellatedPoints.length/3;if(this.applyMvpMatrix(t),c.vboCacheKey||(c.vboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(c.vboCacheKey),e||(e=s.createBuffer(),t.gpuResourceCache.putResource(this.currentData.vboCacheKey,e,4*c.tessellatedPoints.length),c.fillVbo=!0),s.bindBuffer(s.ARRAY_BUFFER,e),c.fillVbo&&(s.bufferData(s.ARRAY_BUFFER,c.tessellatedPoints,s.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),u.loadTextureEnabled(s,!1),t.pickingMode&&(n=t.uniquePickColor()),this.mustDrawInterior(t)&&(i=this.activeAttributes.interiorColor,r=i.alpha*t.currentLayer.opacity,1>r&&!t.pickingMode&&s.depthMask(!1),u.loadColor(s,t.pickingMode?n:i),u.loadOpacity(s,t.pickingMode?r>0?1:0:r),s.vertexAttribPointer(u.vertexPointLocation,3,s.FLOAT,!1,0,0),s.drawArrays(s.TRIANGLE_STRIP,0,h)),this.activeAttributes.drawOutline&&((this.mustDrawVerticals(t)&&this.mustDrawInterior(t)||this.altitudeMode===WorldWind.CLAMP_TO_GROUND)&&this.applyMvpMatrixForOutline(t),i=this.activeAttributes.outlineColor,r=i.alpha*t.currentLayer.opacity,1>r&&!t.pickingMode&&s.depthMask(!1),u.loadColor(s,t.pickingMode?n:i),u.loadOpacity(s,t.pickingMode?1:r),s.lineWidth(this.activeAttributes.outlineWidth),this.currentData.pointBufferHasExtrusionPoints?(o=24,a=h/2):(o=12,a=h),s.vertexAttribPointer(u.vertexPointLocation,3,s.FLOAT,!1,o,0),s.drawArrays(s.LINE_STRIP,0,a),this.mustDrawVerticals(t)&&(c.verticalIndicesVboCacheKey||(c.verticalIndicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(c.verticalIndicesVboCacheKey),e||(e=s.createBuffer(),t.gpuResourceCache.putResource(c.verticalIndicesVboCacheKey,e,4*c.verticalIndices.length),c.fillVbo=!0),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e),c.fillVbo&&(s.bufferData(s.ELEMENT_ARRAY_BUFFER,c.verticalIndices,s.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),s.vertexAttribPointer(u.vertexPointLocation,3,s.FLOAT,!1,0,0),s.drawElements(s.LINES,c.verticalIndices.length,s.UNSIGNED_SHORT,0))),c.fillVbo=!1,t.pickingMode){var f=new l(n,this.pickDelegate?this.pickDelegate:this,null,t.currentLayer,!1);t.resolvePick(f)}},p.prototype.beginDrawing=function(t){var e=t.currentGlContext;this.mustDrawInterior(t)&&e.disable(e.CULL_FACE),t.findAndBindProgram(r),e.enableVertexAttribArray(t.currentProgram.vertexPointLocation)},p.prototype.endDrawing=function(t){var e=t.currentGlContext;e.disableVertexAttribArray(t.currentProgram.vertexPointLocation),e.depthMask(!0),e.lineWidth(1),e.enable(e.CULL_FACE)},p}),i("../src/worldwind/formats/kml/geom/KmlLineString",["../../../util/Color","../KmlElements","./KmlGeometry","../styles/KmlStyle","../../../geom/Location","../util/NodeTransformers","../../../shapes/Path","../../../geom/Position","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolyline","../../../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(t){r.call(this,t),this._style=null};return h.prototype=Object.create(r.prototype),Object.defineProperties(h.prototype,{kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:o["boolean"]})||!1}},kmlTessellate:{get:function(){return this._factory.specific(this,{name:"tessellate",transformer:o["boolean"]})||!1}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:o.string})||WorldWind.ABSOLUTE}},kmlPositions:{get:function(){return this._factory.specific(this,{name:"coordinates",transformer:o.positions})}},kmlCenter:{get:function(){var t=this.kmlPositions,e=0,r=0,i=0;return t.forEach(function(t){e+=t.latitude,r+=t.longitude,i+=t.altitude}),new s(e/this.kmlPositions.length,r/this.kmlPositions.length,i/this.kmlPositions.length)}}}),h.prototype.createPath=function(t){this.kmlAltitudeMode==WorldWind.CLAMP_TO_GROUND?this._renderable=new u(this.prepareLocations(),this.prepareAttributes(t.normal)):this._renderable=new a(this.prepareLocations(),this.prepareAttributes(t.normal)),t.highlight&&(this._renderable.highlightAttributes=this.prepareAttributes(t.highlight)),this.moveValidProperties()},h.prototype.render=function(t,e){r.prototype.render.call(this,t,e),e.lastStyle&&!this._renderable&&(this.createPath(e.lastStyle),t.redrawRequested=!0),this._renderable&&(this._renderable.enabled=this.enabled,this._renderable.render(t))},h.prototype.prepareAttributes=function(t){var e=t&&t.generate()||{};return e._applyLighting=!0,e._drawOutline=!0,e._drawInterior=!0,e._drawVerticals=this.kmlExtrude||!1,e._outlineStippleFactor=0,e._outlineStipplePattern=61680,e._enableLighting=!0,new l(i.shapeAttributes(e))},h.prototype.prepareLocations=function(){return this.kmlPositions},h.prototype.moveValidProperties=function(){this._renderable.extrude=this.kmlExtrude||!1,this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.ABSOLUTE,this._renderable.tesselate=this.kmlTesselate||!1},h.prototype.equals=function(t){if(!t)return!1;var e=c.arrayEquals(t.kmlPositions,this.kmlPositions);return e&&t.kmlExtrude==this.kmlExtrude&&t.kmlTessellate==this.kmlTessellate&&t.kmlAltitudeMode==this.kmlAltitudeMode},h.prototype.getTagNames=function(){return["LineString"]},e.addKey(h.prototype.getTagNames()[0],h),h}),i("../src/worldwind/formats/kml/geom/KmlLinearRing",["./KmlLineString","../KmlElements"],function(t,e){"use strict";var r=function(e){t.call(this,e)};return r.prototype=Object.create(t.prototype),r.prototype.getTagNames=function(){return["LinearRing"]},e.addKey(r.prototype.getTagNames()[0],r),r}),i("../src/worldwind/formats/kml/KmlLocation",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:r.string})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:r.string})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["Location"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/KmlLookAt",["./KmlAbstractView","./KmlElements","./util/NodeTransformers","../../geom/Position"],function(t,e,r,i){"use strict";var n=function(e){t.call(this,e)};return n.prototype=Object.create(t.prototype),Object.defineProperties(n.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:r.number})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:r.number})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:r.number})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:r.number})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:r.number})}},kmlRange:{get:function(){return this._factory.specific(this,{name:"range",transformer:r.number})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:r.string})}}}),n.prototype.update=function(t){if(t.wwd){var e=this.kmlAltitude||4e3;t.wwd.goTo(new i(this.kmlLatitude,this.kmlLongitude,e))}},n.prototype.getTagNames=function(){return["LookAt"]},e.addKey(n.prototype.getTagNames()[0],n),n}),i("../src/worldwind/formats/kml/geom/KmlMultiGeometry",["./../KmlElements","./KmlGeometry","../../../geom/Position"],function(t,e,r){"use strict";var i=function(t){e.call(this,t),this._style=t.style};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlShapes:{get:function(){return this._factory.all(this)}},kmlCenter:{get:function(){var t=this.kmlShapes.map(function(t){return t.kmlCenter}),e=0,i=0,n=0;return t.forEach(function(t){e+=t.latitude,i+=t.longitude,n+=t.altitude}),new r(e/t.length,i/t.length,n/t.length)}}}),i.prototype.render=function(t,r){e.prototype.render.call(this,t,r),this.kmlShapes.forEach(function(e){
e.render(t,r)})},i.prototype.getTagNames=function(){return["MultiGeometry"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/features/KmlNetworkLink",["./../KmlElements","./KmlFeature","../KmlFile","../KmlLink","../util/NodeTransformers","../util/RefreshListener"],function(t,e,r,i,n,o){"use strict";var a="refreshNetworkLinkEvent",s=function(t){e.call(this,t),this.isFeature=!0,this.resolvedFile=null,this.displayed=!1,this.isDownloading=!1};return s.prototype=Object.create(e.prototype),Object.defineProperties(s.prototype,{kmlRefreshVisibility:{get:function(){return this._factory.specific(this,{name:"refreshVisibility",transformer:n["boolean"]})}},kmlFlyToView:{get:function(){return this._factory.specific(this,{name:"flyToView",transformer:n["boolean"]})}},kmlLink:{get:function(){return this._factory.any(this,{name:i.prototype.getTagNames()})}}}),s.prototype.getTagNames=function(){return["NetworkLink"]},s.prototype.render=function(t,i){if(e.prototype.render.call(this,t,i),i.lastVisibility||this.displayed){if(!this.isDownloading&&!this.resolvedFile){this.isDownloading=!0;var n=this;new r(n.buildUrl()).then(function(t){n.resolvedFile=t,n.isDownloading=!1,n.fireEvent(i)})}this.resolvedFile&&!this.displayed&&(this.resolvedFile.render(t,i),this.handleRefresh(i))}},s.prototype.buildUrl=function(){return this.kmlLink.kmlHref},s.prototype.handleRefresh=function(t){var e=t.activeEvents;if(e=e.filter(function(t){return t.type==a}),e.length>0){var i=this;new r(i.buildUrl()).then(function(e){i.resolvedFile=e,i.fireEvent(t)})}},s.prototype.fireEvent=function(t){var e=0;if("onInterval"==this.kmlLink.kmlRefreshMode)e=1e3*this.kmlLink.kmlRefreshInterval;else{if("onExpire"!=this.kmlLink.kmlRefreshMode)return;if(!this.resolvedFile)return;e=this.resolvedFile.getExpired()}t.listener.addEvent(new o.Event(a,e,null))},t.addKey(s.prototype.getTagNames()[0],s),s}),i("../src/worldwind/formats/kml/KmlOrientation",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:r.number})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:r.number})}},kmlRoll:{get:function(){return this._factory.specific(this,{name:"roll",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["Orientation"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/geom/KmlPoint",["../../../util/Color","../KmlElements","./KmlGeometry","../../../geom/Location","../util/NodeTransformers","../../../shapes/Polygon","../../../geom/Position"],function(t,e,r,i,n,o,a){"use strict";var s=function(t){r.call(this,t),this._shape=null};return s.prototype=Object.create(r.prototype),Object.defineProperties(s.prototype,{kmlPosition:{get:function(){var t=this._factory.specific(this,{name:"coordinates",transformer:n.string}).split(",");return new a(t[1],t[0],t[2]||0)}},kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:n["boolean"]})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:n.string})}},kmlCenter:{get:function(){return this.kmlPosition}}}),s.prototype.getTagNames=function(){return["Point"]},e.addKey(s.prototype.getTagNames()[0],s),s}),i("../src/worldwind/formats/kml/util/ViewVolume",["../KmlElements","../KmlObject","./NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlLeftFov:{get:function(){return this._factory.specific(this,{name:"leftFov",transformer:r.number})}},kmlRightFov:{get:function(){return this._factory.specific(this,{name:"rightFov",transformer:r.number})}},kmlBottomFov:{get:function(){return this._factory.specific(this,{name:"bottomFov",transformer:r.number})}},kmlTopFov:{get:function(){return this._factory.specific(this,{name:"topFov",transformer:r.number})}},kmlNear:{get:function(){return this._factory.specific(this,{name:"near",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["ViewVolume"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/formats/kml/features/KmlPhotoOverlay",["../util/ImagePyramid","./../KmlElements","./KmlOverlay","../geom/KmlPoint","../util/NodeTransformers","../util/ViewVolume"],function(t,e,r,i,n,o){"use strict";var a=function(t){r.call(this,t)};return a.prototype=Object.create(r.prototype),Object.defineProperties(a.prototype,{kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:n.string})}},kmlShape:{get:function(){return this._factory.specific(this,{name:"shape",transformer:n.string})}},kmlPoint:{get:function(){return this._factory.any(this,{name:i.prototype.getTagNames()})}},kmlViewVolume:{get:function(){return this._factory.any(this,{name:o.prototype.getTagNames()})}},kmlImagePyramid:{get:function(){return this._factory.any(this,{name:t.prototype.getTagNames()})}}}),a.prototype.getTagNames=function(){return["PhotoOverlay"]},e.addKey(a.prototype.getTagNames[0],a),a}),i("../src/worldwind/formats/kml/features/KmlPlacemark",["./../KmlElements","./KmlFeature","../geom/KmlGeometry","../styles/KmlStyle","../KmlTimeSpan","../KmlTimeStamp","../../../shapes/PlacemarkAttributes","../../../shapes/Placemark","../../../util/Color","../../../shapes/ShapeAttributes","../../../shapes/TextAttributes","../../../util/Offset","../../../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c,h,f){"use strict";var d=function(t){e.call(this,t)};return d.prototype=Object.create(e.prototype),Object.defineProperties(d.prototype,{kmlGeometry:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}}}),d.prototype.render=function(t,r){e.prototype.render.call(this,t,r),r=f.clone(r),r.lastStyle&&!this._renderable&&this.kmlGeometry&&(this._renderable=new s(this.kmlGeometry.kmlCenter,!1,this.prepareAttributes(r.lastStyle.normal)),r.lastStyle.highlight&&(this._renderable.highlightAttributes=this.prepareAttributes(r.lastStyle.highlight)),this.moveValidProperties(),t.redrawRequested=!0),this._renderable&&this.kmlGeometry&&(this.kmlGeometry.render(t,r),this._renderable.render(t))},d.prototype.prepareAttributes=function(t){var e=t&&t.generate()||{normal:{},highlight:{}},r=new a(i.placemarkAttributes(e));return r.imageOffset=new h(WorldWind.OFFSET_FRACTION,.3,WorldWind.OFFSET_FRACTION,0),r.imageColor=l.WHITE,r.labelAttributes=new c(i.textAttributes({_offset:new h(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,1),_color:l.YELLOW})),r.drawLeaderLine=!0,r.leaderLineAttributes=new u(i.shapeAttributes({outlineColor:l.RED})),r},d.prototype.moveValidProperties=function(){this._renderable.label=this.kmlName||"",this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.RELATIVE_TO_GROUND,this._renderable.enableLeaderLinePicking=!0},d.prototype.getTagNames=function(){return["Placemark"]},t.addKey(d.prototype.getTagNames()[0],d),d}),i("../src/worldwind/formats/kml/geom/KmlPolygon",["../../../util/Color","../KmlElements","./KmlGeometry","./KmlLinearRing","../styles/KmlStyle","../../../geom/Location","../util/NodeTransformers","../../../shapes/Polygon","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolygon"],function(t,e,r,i,n,o,a,s,l,u){"use strict";var c=function(t){r.call(this,t),this.initialized=!1};return c.prototype=Object.create(r.prototype),Object.defineProperties(c.prototype,{kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:a["boolean"]})}},kmlTessellate:{get:function(){return this._factory.specific(this,{name:"tessellate",transformer:a["boolean"]})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:a.string})}},kmlOuterBoundary:{get:function(){return this._factory.specific(this,{name:"outerBoundaryIs",transformer:a.linearRing})}},kmlInnerBoundary:{get:function(){return this._factory.specific(this,{name:"innerBoundaryIs",transformer:a.linearRing})}},kmlCenter:{get:function(){return this.kmlOuterBoundary.kmlCenter}}}),c.prototype.createPolygon=function(t){this.kmlAltitudeMode==WorldWind.CLAMP_TO_GROUND?this._renderable=new u(this.prepareLocations(),this.prepareAttributes(t.normal)):this._renderable=new s(this.prepareLocations(),this.prepareAttributes(t.normal)),t.highlight&&(this._renderable.highlightAttributes=this.prepareAttributes(t.highlight)),this.moveValidProperties()},c.prototype.render=function(t,e){r.prototype.render.call(this,t,e),e.lastStyle&&!this._renderable&&(this.createPolygon(e.lastStyle),t.redrawRequested=!0),this._renderable&&(this._renderable.enabled=this.enabled,this._renderable.render(t))},c.prototype.moveValidProperties=function(){this._renderable.extrude=this.kmlExtrude||!0,this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.CLAMP_TO_GROUND},c.prototype.prepareAttributes=function(t){var e=t&&t.generate()||{};return e._drawVerticals=this.kmlExtrude||!1,e._applyLighting=!0,e._depthTest=!0,e._outlineStippleFactor=0,e._outlineStipplePattern=61680,e._enableLighting=!0,new l(n.shapeAttributes(e))},c.prototype.prepareLocations=function(){var t=[];return null!=this.kmlInnerBoundary?(t[0]=this.kmlInnerBoundary.kmlPositions,t[1]=this.kmlOuterBoundary.kmlPositions):t=this.kmlOuterBoundary.kmlPositions,t},c.prototype.getStyle=function(){return this._style},c.prototype.getTagNames=function(){return["Polygon"]},e.addKey(c.prototype.getTagNames()[0],c),c}),i("../src/worldwind/formats/kml/features/KmlScreenOverlay",["./../KmlElements","./KmlFeature","./KmlOverlay","../util/NodeTransformers","../../../util/Offset","../../../shapes/ScreenImage","../../../util/WWUtil"],function(t,e,r,i,n,o,a){"use strict";var s=function(t){r.call(this,t),console.log("Create Screen Overlay",this)};return s.prototype=Object.create(r.prototype),Object.defineProperties(s.prototype,{kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:i.number})}},kmlOverlayXYx:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:i.attribute("x"),attribute:"kmlOverlayXYx"})}},kmlOverlayXYy:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:i.attribute("y"),attribute:"kmlOverlayXYy"})}},kmlOverlayXYxunits:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:i.attribute("xunits"),attribute:"kmlOverlayXYxunits"})}},kmlOverlayXYyunits:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:i.attribute("yunits"),attribute:"kmlOverlayXYyunits"})}},kmlScreenXYx:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:i.attribute("x"),attribute:"kmlScreenXYx"})}},kmlScreenXYy:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:i.attribute("y"),attribute:"kmlScreenXYy"})}},kmlScreenXYxunits:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:i.attribute("xunits"),attribute:"kmlScreenXYxunits"})}},kmlScreenXYyunits:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:i.attribute("yunits"),attribute:"kmlScreenXYyunits"})}},kmlRotationXYx:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:i.attribute("x"),attribute:"kmlRotationXYx"})}},kmlRotationXYy:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:i.attribute("y"),attribute:"kmlRotationXYy"})}},kmlRotationXYxunits:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:i.attribute("xunits"),attribute:"kmlRotationXYxunits"})}},kmlRotationXYyunits:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:i.attribute("yunits"),attribute:"kmlRotationXYyunits"})}},kmlSizex:{get:function(){return this._factory.specific(this,{name:"size",transformer:i.attribute("x"),attribute:"kmlSizex"})}},kmlSizey:{get:function(){return this._factory.specific(this,{name:"size",transformer:i.attribute("y"),attribute:"kmlSizey"})}},kmlSizexunits:{get:function(){return this._factory.specific(this,{name:"size",transformer:i.attribute("xunits"),attribute:"kmlSizexunits"})}},kmlSizeyunits:{get:function(){return this._factory.specific(this,{name:"size",transformer:i.attribute("yunits"),attribute:"kmlSizeyunits"})}}}),s.prototype.render=function(t,r){e.prototype.render.call(this,t,r),this._renderable||this.kmlIcon&&(this._renderable=new o(new n(this.kmlScreenXYxunits,this.kmlScreenXYx,this.kmlScreenXYyunits,this.kmlScreenXYy),this.kmlIcon.kmlHref),this._renderable.imageOffset=new n(this.kmlOverlayXYxunits,this.kmlOverlayXYx,this.kmlOverlayXYyunits,this.kmlOverlayXYy),t.redrawRequested=!0),this._renderable&&this._renderable.render(t)},s.prototype.getTagNames=function(){return["ScreenOverlay"]},t.addKey(s.prototype.getTagNames()[0],s),s}),i("../src/worldwind/formats/kml/features/KmlTour",["./../KmlElements","./KmlFeature"],function(t,e){"use strict";var r=function(t){e.call(this,t)};return r.prototype=Object.create(e.prototype),r.prototype.getTagNames=function(){return["gx:Tour"]},t.addKey(r.prototype.getTagNames()[0],r),r}),i("../src/worldwind/formats/kml/geom/KmlTrack",["./../KmlElements","./KmlGeometry"],function(t,e){"use strict";var r=function(t){e.call(this,t)};return r.prototype=Object.create(e.prototype),r.prototype.getTagNames=function(){return["gx:Track"]},t.addKey(r.prototype.getTagNames()[0],r),r}),i("../src/worldwind/layer/LandsatRestLayer",["../error/ArgumentError","../geom/Location","../util/Logger","../geom/Sector","../layer/TiledImageLayer","../util/LevelRowColumnUrlBuilder","../util/WWUtil"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,s){var l=a.urlPath(t+"/"+r);n.call(this,i.FULL_SPHERE,new e(36,36),10,"image/png",l,512,512),this.displayName=s,this.pickEnabled=!1,this.urlBuilder=new o(t,r)};return s.prototype=Object.create(n.prototype),s}),i("../src/worldwind/util/measure/LengthMeasurer",["../../error/ArgumentError","../../geom/Location","../Logger","./MeasurerUtils","../../geom/Position","../../geom/Vec3"],function(t,e,r,i,n,o){var a=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"LengthMeasurer","constructor","missingWorldWindow"));this.wwd=e,this.DEFAULT_MIN_SEGMENT_LENGTH=30,this._maxSegmentLength=1e5,this._lengthTerrainSamplingSteps=128,this.subdividedPositions=null};return Object.defineProperties(a.prototype,{maxSegmentLength:{get:function(){return this._maxSegmentLength},set:function(t){this._maxSegmentLength=t}},lengthTerrainSamplingSteps:{get:function(){return this._lengthTerrainSamplingSteps},set:function(t){this._lengthTerrainSamplingSteps=t}}}),a.prototype.getLength=function(t,e,r){return r=r||WorldWind.GREAT_CIRCLE,this.subdividedPositions=null,this.computeLength(t,e,r)},a.prototype.getPathLength=function(t){return this.subdividedPositions=null,this.computeLength(t.positions,t.followTerrain,t.pathType)},a.prototype.getGeographicDistance=function(t,r){if(t instanceof WorldWind.Path)var i=t.positions,n=t.pathType;else Array.isArray(t)&&(i=t,n=r||WorldWind.GREAT_CIRCLE);if(!i||i.length<2)return-1;var o=e.greatCircleDistance;n===WorldWind.RHUMB_LINE?o=e.rhumbDistance:n===WorldWind.LINEAR&&(o=e.linearDistance);for(var a=0,s=0,l=i.length-1;l>s;s++){var u=i[s],c=i[s+1];a+=o(u,c)}return a*this.wwd.globe.equatorialRadius},a.prototype.computeLength=function(t,e,r){if(!t||t.length<2)return-1;var n=this.wwd.globe;if(null==this.subdividedPositions){var a=this._maxSegmentLength;if(e){var s=this.computeLength(t,!1,r);a=s/this._lengthTerrainSamplingSteps,a=Math.min(Math.max(a,this.DEFAULT_MIN_SEGMENT_LENGTH),this._maxSegmentLength)}this.subdividedPositions=i.subdividePositions(n,t,e,r,a)}var l=0,u=this.subdividedPositions[0],c=new o(0,0,0),h=new o(0,0,0);c=n.computePointFromPosition(u.latitude,u.longitude,u.altitude,c);for(var f=1,d=this.subdividedPositions.length;d>f;f++){var p=this.subdividedPositions[f];h=n.computePointFromPosition(p.latitude,p.longitude,p.altitude,h),l+=c.distanceTo(h),c.copy(h)}return l},a}),i("../src/worldwind/cache/MemoryCacheListener",["../util/Logger","../error/UnsupportedOperationError"],function(t,e){"use strict";var r=function(){};return r.prototype.entryRemoved=function(r,i){throw new e(t.logMessage(t.LEVEL_SEVERE,"MemoryCacheListener","entryRemoved","abstractInvocation"))},r.prototype.removalError=function(r,i,n){throw new e(t.logMessage(t.LEVEL_SEVERE,"MemoryCacheListener","removalError","abstractInvocation"))},r}),i("../src/worldwind/util/NominatimGeocoder",["../util/Logger"],function(t){"use strict";var e=function(){this.service="https://open.mapquestapi.com/nominatim/v1/search/"};return e.prototype.lookup=function(t,e,r){var i=this.service+t.replace(" ","%20")+"?format=json",n=new XMLHttpRequest,o=this;i+="&key="+(r||"lUvVRchXGGDh5Xwk3oidrXeIDAAevOUS"),n.open("GET",i,!0),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var t=JSON.parse(n.responseText);e(o,t)}},n.send(null)},e}),i("../src/worldwind/layer/OpenStreetMapImageLayer",["../geom/Angle","../util/Color","../geom/Location","../geom/Sector","../layer/MercatorTiledImageLayer"],function(t,e,r,i,n){"use strict";var o=function(t){this.imageSize=256,t=t||"Open Street Map",n.call(this,new i(-85.05,85.05,-180,180),new r(85.05,180),19,"image/png",t,this.imageSize,this.imageSize),this.displayName=t,this.pickEnabled=!1,this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d"),this.urlBuilder={urlForTile:function(t,e){return"http://otile1.mqcdn.com/tiles/1.0.0/osm/"+(t.level.levelNumber+1)+"/"+t.column+"/"+t.row+".png"}}};return o.prototype=Object.create(n.prototype),o.prototype.doRender=function(t){n.prototype.doRender.call(this,t),this.inCurrentFrame&&(t.screenCreditController.addStringCredit("©OpenStreetMap",e.DARK_GRAY),t.screenCreditController.addStringCredit("Tiles Courtesy of MapQuest",e.DARK_GRAY))},o.prototype.createTopLevelTiles=function(t){this.topLevelTiles=[],this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))},o.prototype.mapSizeForLevel=function(t){return 256<<t+1},o}),i("../src/worldwind/projections/ProjectionGnomonic",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Sector","../util/WWMath"],function(t,e,r,i,n,o){"use strict";var a=function(t){this.north=!("South"===t);var e=this.north?new n(30,90,-180,180):new n(-90,-30,-180,180);r.call(this,"Polar Gnomonic",!1,e),this._pole=t,this.displayName=this.north?"North Gnomonic":"South Gnomonic",this._stateKey="projection polar gnomonic "+this._pole+" "};return a.prototype=Object.create(r.prototype),Object.defineProperties(a.prototype,{pole:{get:function(){return this._pole},set:function(t){this._pole=t,this.north=!("South"===this._pole),this.projectionLimits=this.north?new n(30,90,-180,180):new n(-90,-30,-180,180),this._stateKey="projection polar gnomonic "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}}),a.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesian","missingResult"));if(this.north&&90===n||!this.north&&-90===n)l[0]=0,l[1]=0,l[2]=a;else{var u=this.north?1:-1,c=r.equatorialRadius/Math.tan(n*t.DEGREES_TO_RADIANS);l[0]=c*Math.sin(o*t.DEGREES_TO_RADIANS)*u,l[1]=c*-Math.cos(o*t.DEGREES_TO_RADIANS),l[2]=a}return l},a.prototype.geographicToCartesianGrid=function(r,n,a,s,l,u,c,h){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingGlobe"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingSector"));if(!l||l.length<a*s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!h)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingResult"));var f,d,p,m,g,y,v=n.minLatitude*t.DEGREES_TO_RADIANS,E=n.maxLatitude*t.DEGREES_TO_RADIANS,w=n.minLongitude*t.DEGREES_TO_RADIANS,b=n.maxLongitude*t.DEGREES_TO_RADIANS,x=(E-v)/(a>1?a-1:1),_=(b-w)/(s>1?s-1:1),S=this.projectionLimits.minLatitude*t.DEGREES_TO_RADIANS,T=this.projectionLimits.maxLatitude*t.DEGREES_TO_RADIANS,L=this.north?1:-1,M=u?u:new Vec3(0,0,0),A=0,N=0;for(f=0,p=v;a>f;f++,p+=x)for(f===a-1&&(p=E),g=o.clamp(p,S,T),y=r.equatorialRadius/Math.tan(g),(this.north&&g===Math.PI/2||!this.north&&g===-Math.PI/2)&&(y=0),d=0,m=w;s>d;d++,m+=_)d===s-1&&(m=b),h[N++]=y*Math.sin(m)*L-M[0],h[N++]=y*-Math.cos(m)-M[1],h[N++]=l[A++]-M[2];return h},a.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","cartesianToGeographic","missingResult"));var u,c=Math.sqrt(n*n+o*o);return 1e-4>c?(l.latitude=this.north?90:-90,l.longitude=0,l.altitude=a):(u=Math.atan2(c,r.equatorialRadius),u>Math.PI&&(u=Math.PI),l.latitude=Math.asin(Math.cos(u)*(this.north?1:-1))*t.RADIANS_TO_DEGREES,l.longitude=Math.atan2(n,o*(this.north?-1:1))*t.RADIANS_TO_DEGREES,l.altitude=a),l},a.prototype.northTangentAtLocation=function(r,n,o,a){if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","northTangentAtLocation","missingResult"));return a[0]=Math.sin(o*t.DEGREES_TO_RADIANS)*(this.north?-1:1),a[1]=Math.cos(o*t.DEGREES_TO_RADIANS),a[2]=0,a},a.prototype.northTangentAtPoint=function(t,r,n,o,a,s){if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","northTangentAtLocation","missingResult"));var l=Math.sqrt(r*r+n*n);return 1e-4>l?(s[0]=0,s[1]=1,s[2]=0):(s[0]=r/l*(this.north?-1:1),s[1]=n/l*(this.north?-1:1),s[2]=0),s},a}),i("../src/worldwind/projections/ProjectionMercator",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Sector","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(){r.call(this,"Mercator",!0,new n(-78,78,-180,180))};return s.prototype=Object.create(r.prototype),s.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesian","missingResult"));n>this.projectionLimits.maxLatitude&&(n=this.projectionLimits.maxLatitude),n<this.projectionLimits.minLatitude&&(n=this.projectionLimits.minLatitude);var u=Math.sqrt(r.eccentricitySquared),c=Math.sin(n*t.DEGREES_TO_RADIANS),h=(1+c)/(1-c)*Math.pow((1-u*c)/(1+u*c),u);return l[0]=r.equatorialRadius*o*t.DEGREES_TO_RADIANS+(s?s[0]:0),l[1]=.5*r.equatorialRadius*Math.log(h),l[2]=a,l},Object.defineProperties(s.prototype,{stateKey:{get:function(){return"projection mercator "}}}),s.prototype.geographicToCartesianGrid=function(r,n,s,l,u,c,h,f){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingGlobe"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingSector"));if(!u||u.length<s*l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!f)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingResult"));var d,p,m,g,y,v,E,w,b=r.equatorialRadius,x=Math.sqrt(r.eccentricitySquared),_=n.minLatitude*t.DEGREES_TO_RADIANS,S=n.maxLatitude*t.DEGREES_TO_RADIANS,T=n.minLongitude*t.DEGREES_TO_RADIANS,L=n.maxLongitude*t.DEGREES_TO_RADIANS,M=(S-_)/(s>1?s-1:1),A=(L-T)/(l>1?l-1:1),N=this.projectionLimits.minLatitude*t.DEGREES_TO_RADIANS,R=this.projectionLimits.maxLatitude*t.DEGREES_TO_RADIANS,C=c?c:new o(0,0,0),P=h?h[0]:0,O=0,I=0;for(d=0,m=_;s>d;d++,m+=M)for(d===s-1&&(m=S),y=a.clamp(m,N,R),v=Math.sin(y),E=(1+v)/(1-v)*Math.pow((1-x*v)/(1+x*v),x),w=b*Math.log(E)*.5-C[1],p=0,g=T;l>p;p++,g+=A)p===l-1&&(g=L),f[I++]=b*g-C[0]+P,f[I++]=w,f[I++]=u[O++]-C[2];return f},s.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","cartesianToGeographic","missingResult"));var u=r.eccentricitySquared,c=u*u,h=c*u,f=h*u,d=Math.pow(Math.E,-o/r.equatorialRadius),p=Math.PI/2-2*Math.atan(d),m=u/2+5*c/24+h/12+13*f/360,g=7*c/48+29*h/240+811*f/11520,y=7*h/120+81*f/1120,v=4279*f/161280,E=p-g+v,w=m-3*y,b=2*g-8*v,x=4*y,_=8*v,S=Math.sin(2*p),T=E+S*(w+S*(b+S*(x+_*S)));return l.latitude=T*t.RADIANS_TO_DEGREES,l.longitude=(n-(s?s[0]:0))/r.equatorialRadius*t.RADIANS_TO_DEGREES,l.altitude=a,l},s}),i("../src/worldwind/projections/ProjectionPolarEquidistant",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,"Polar Equidistant",!1,null),this._pole=t,this.north=!("South"===t),this.displayName=this.north?"North Polar":"South Polar",this._stateKey="projection polar equidistant "+this._pole+" "};return n.prototype=Object.create(r.prototype),Object.defineProperties(n.prototype,{pole:{get:function(){return this._pole},set:function(t){this._pole=t,this.north=!("South"===this._pole),this._stateKey="projection polar equidistant "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}}),n.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesian","missingResult"));if(this.north&&90===n||!this.north&&-90===n)l[0]=0,l[1]=0,l[2]=a;else{var u=this.north?-1:1,c=r.equatorialRadius*(Math.PI/2+n*t.DEGREES_TO_RADIANS*u);l[0]=c*Math.sin(o*t.DEGREES_TO_RADIANS),l[1]=c*Math.cos(o*t.DEGREES_TO_RADIANS)*u,l[2]=a}return l},n.prototype.geographicToCartesianGrid=function(r,n,o,a,s,l,u,c){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingGlobe"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingSector"));if(!s||s.length<o*a)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!c)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingResult"));var h,f,d,p,m,g=r.equatorialRadius,y=n.minLatitude*t.DEGREES_TO_RADIANS,v=n.maxLatitude*t.DEGREES_TO_RADIANS,E=n.minLongitude*t.DEGREES_TO_RADIANS,w=n.maxLongitude*t.DEGREES_TO_RADIANS,b=(v-y)/(o>1?o-1:1),x=(w-E)/(a>1?a-1:1),_=this.north?-1:1,S=l?l:new Vec3(0,0,0),T=Math.PI/2,L=0,M=0,A=new Float64Array(a),N=new Float64Array(a);for(f=0,p=E;a>f;f++,p+=x)f===a-1&&(p=w),A[f]=Math.cos(p),N[f]=Math.sin(p);for(h=0,d=y;o>h;h++,d+=b)for(h===o-1&&(d=v),m=g*(T+d*_),(this.north&&d===T||!this.north&&d===-T)&&(m=0),f=0;a>f;f++)c[M++]=m*N[f]-S[0],c[M++]=m*A[f]*_-S[1],c[M++]=s[L++]-S[2];return c},n.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","cartesianToGeographic","missingResult"));var u,c=Math.sqrt(n*n+o*o);return 1e-4>c?(l.latitude=this.north?90:-90,l.longitude=0,l.altitude=a):(u=c/r.equatorialRadius,u>Math.PI&&(u=Math.PI),l.latitude=Math.asin(Math.cos(u)*(this.north?1:-1))*t.RADIANS_TO_DEGREES,l.longitude=Math.atan2(n,o*(this.north?-1:1))*t.RADIANS_TO_DEGREES,l.altitude=a),l},n.prototype.northTangentAtLocation=function(r,n,o,a){if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));return a[0]=Math.sin(o*t.DEGREES_TO_RADIANS)*(this.north?-1:1),a[1]=Math.cos(o*t.DEGREES_TO_RADIANS),a[2]=0,a},n.prototype.northTangentAtPoint=function(t,r,n,o,a,s){if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));var l=Math.sqrt(r*r+n*n);return 1e-4>l?(s[0]=0,s[1]=1,s[2]=0):(s[0]=r/l*(this.north?-1:1),s[1]=n/l*(this.north?-1:1),s[2]=0),s},n}),i("../src/worldwind/projections/ProjectionUPS",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Sector","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(t){this.north=!("South"===t);var e=this.north?new n(0,90,-180,180):new n(-90,0,-180,180);r.call(this,"Uniform Polar Stereographic",!1,e),this._pole=t,this.displayName=this.north?"North UPS":"South UPS",this._stateKey="projection ups "+this._pole+" "};return s.prototype=Object.create(r.prototype),Object.defineProperties(s.prototype,{pole:{get:function(){return this._pole},set:function(t){this._pole=t,this.north=!("South"===this._pole),this.projectionLimits=this.north?new n(0,90,-180,180):new n(-90,0,-180,180),this._stateKey="projection ups "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}}),s.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesian","missingResult"));if(this.north&&90===n||!this.north&&-90===n)l[0]=0,l[1]=0,l[2]=a;else{var u,c,h,f=this.north?1:-1,d=n*t.DEGREES_TO_RADIANS,p=o*t.DEGREES_TO_RADIANS,m=.994,g=Math.sqrt(r.eccentricitySquared),y=Math.sqrt(Math.pow(1+g,1+g)*Math.pow(1-g,1-g));(this.north&&0>d||!this.north&&d>0)&&(d=0),u=Math.sin(d*f),c=Math.sqrt((1-u)/(1+u)*Math.pow((1+g*u)/(1-g*u),g)),h=2*r.equatorialRadius*m*c/y,l[0]=h*Math.sin(p),l[1]=-h*Math.cos(p)*f,l[2]=a}return l},s.prototype.geographicToCartesianGrid=function(r,n,s,l,u,c,h,f){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingGlobe"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingSector"));if(!u||u.length<s*l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!f)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingResult"));var d,p,m,g,y,v,E,w,b=r.equatorialRadius,x=n.minLatitude*t.DEGREES_TO_RADIANS,_=n.maxLatitude*t.DEGREES_TO_RADIANS,S=n.minLongitude*t.DEGREES_TO_RADIANS,T=n.maxLongitude*t.DEGREES_TO_RADIANS,L=(_-x)/(s>1?s-1:1),M=(T-S)/(l>1?l-1:1),A=this.projectionLimits.minLatitude*t.DEGREES_TO_RADIANS,N=this.projectionLimits.maxLatitude*t.DEGREES_TO_RADIANS,R=.994,C=Math.sqrt(r.eccentricitySquared),P=Math.sqrt(Math.pow(1+C,1+C)*Math.pow(1-C,1-C)),O=this.north?1:-1,I=c?c:new o(0,0,0),k=0,D=0;for(d=0,m=x;s>d;d++,m+=L)for(d===s-1&&(m=_),y=a.clamp(m,A,N),v=Math.sin(y*O),E=Math.sqrt((1-v)/(1+v)*Math.pow((1+C*v)/(1-C*v),C)),w=2*b*R*E/P,p=0,g=S;l>p;p++,g+=M)p===l-1&&(g=T),f[D++]=w*Math.sin(g)-I[0],f[D++]=-w*Math.cos(g)*O-I[1],f[D++]=u[k++]-I[2];return f},s.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","cartesianToGeographic","missingResult"));
var u=Math.atan2(n,o*(this.north?-1:1)),c=.994,h=Math.sqrt(r.eccentricitySquared),f=Math.sqrt(n*n+o*o),d=Math.sqrt(Math.pow(1+h,1+h)*Math.pow(1-h,1-h)),p=f*d/(2*r.equatorialRadius*c),m=r.eccentricitySquared,g=m*m,y=g*m,v=y*m,E=Math.PI/2-2*Math.atan(p),w=m/2+5*g/24+y/12+13*v/360,b=7*g/48+29*y/240+811*v/11520,x=7*y/120+81*v/1120,_=4279*v/161280,S=E-b+_,T=w-3*x,L=2*b-8*_,M=4*x,A=8*_,N=Math.sin(2*E),R=S+N*(T+N*(L+N*(M+A*N)));return R*=this.north?1:-1,l.latitude=R*t.RADIANS_TO_DEGREES,l.longitude=u*t.RADIANS_TO_DEGREES,l.altitude=a,l},s.prototype.northTangentAtLocation=function(r,n,o,a){if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","northTangentAtLocation","missingResult"));return a[0]=Math.sin(o*t.DEGREES_TO_RADIANS)*(this.north?-1:1),a[1]=Math.cos(o*t.DEGREES_TO_RADIANS),a[2]=0,a},s.prototype.northTangentAtPoint=function(t,r,n,o,a,s){if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));var l=Math.sqrt(r*r+n*n);return 1e-4>l?(s[0]=0,s[1]=1,s[2]=0):(s[0]=r/l*(this.north?-1:1),s[1]=n/l*(this.north?-1:1),s[2]=0),s},s}),i("../src/worldwind/formats/kml/util/Scale",["./../KmlElements","../KmlObject","./NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlX:{get:function(){return this._factory.specific(this,{name:"x",transformer:r.number})}},kmlY:{get:function(){return this._factory.specific(this,{name:"y",transformer:r.number})}},kmlZ:{get:function(){return this._factory.specific(this,{name:"z",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["Scale"]},t.addKey(i.prototype.getTagNames()[0],i),i}),i("../src/worldwind/util/ByteBuffer",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"ByteBuffer","constructor","missingArray"));this.array=i,this.data=new DataView(i),this.position=0,this._order=r.LITTLE_ENDIAN};return r.prototype.getByte=function(){var t=this.data.getUint8(this.position);return this.position+=r.BYTE_SIZE,t},r.prototype.getByteArray=function(t){var e=new Uint8Array(this.array,this.position,t);return this.position+=r.BYTE_SIZE*t,e},r.prototype.getInt16=function(){var t=this.data.getInt16(this.position,this._order);return this.position+=r.INT16_SIZE,t},r.prototype.getInt16Array=function(t){var e=new Int16Array(this.array,this.position,t);return this.position+=r.INT16_SIZE*t,e},r.prototype.getInt32=function(){var t=this.data.getInt32(this.position,this._order);return this.position+=r.INT32_SIZE,t},r.prototype.getInt32Array=function(t){var e=new Int32Array(this.array,this.position,t);return this.position+=r.INT32_SIZE*t,e},r.prototype.getFloat=function(){var t=this.data.getFloat32(this.position,this._order);return this.position+=r.FLOAT_SIZE,t},r.prototype.getFloatArray=function(t){var e=new Float32Array(this.array,this.position,t);return this.position+=r.FLOAT_SIZE*t,e},r.prototype.getDouble=function(){var t=this.data.getFloat64(this.position,this._order);return this.position+=r.DOUBLE_SIZE,t},r.prototype.getDoubleArray=function(t){var e;if(this.position%8!=0){var i=this.array.slice(this.position,this.position+t*r.DOUBLE_SIZE);e=new Float64Array(i)}else e=new Float64Array(this.array,this.position,t);return this.position+=r.DOUBLE_SIZE*t,e},r.prototype.skipBytes=function(t){this.position+=t*r.BYTE_SIZE},r.prototype.skipInt16s=function(t){this.position+=t*r.INT16_SIZE},r.prototype.skipInt32s=function(t){this.position+=t*r.INT32_SIZE},r.prototype.skipFloats=function(t){this.position+=t*r.FLOAT_SIZE},r.prototype.skipDoubles=function(t){this.position+=t*r.DOUBLE_SIZE},r.prototype.seek=function(t){this.position=t},r.prototype.order=function(t){this._order=t},r.prototype.limit=function(){return this.data.byteLength},r.prototype.hasRemaining=function(){return this.position<this.data.byteLength},r.BIG_ENDIAN=!1,r.LITTLE_ENDIAN=!0,r.BYTE_SIZE=1,r.INT16_SIZE=2,r.INT32_SIZE=4,r.FLOAT_SIZE=4,r.DOUBLE_SIZE=8,r}),i("../src/worldwind/formats/shapefile/DBaseField",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseFile","../../util/Logger"],function(t,e,r,i){"use strict";var n=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"DBaseField","constructor","missingAttributeName"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"DBaseField","constructor","missingBuffer"));this.name=null,this.type=null,this.typeCode=-1,this.length=-1,this.decimals=-1,this.readFieldDescriptor(e,r)};return n.prototype.getName=function(){return this.name},n.prototype.getType=function(){return this.type},n.prototype.getLength=function(){return this.length},n.prototype.getDecimals=function(){return this.decimals},n.prototype.readFieldDescriptor=function(t,r){r.order(e.LITTLE_ENDIAN);var o=r.position;if(this.name=t.readNullTerminatedString(r,n.FIELD_NAME_LENGTH),r.seek(o+n.FIELD_NAME_LENGTH),this.typeCode=String.fromCharCode(r.getByte()),this.type=n.getFieldType(this.typeCode),null==this.type)throw new Error(i.log(i.LEVEL_SEVERE,"Shapefile dBase encountered unsupported field type: "+this.typeCode));r.skipBytes(4),this.length=r.getByte(),this.decimals=r.getByte(),r.seek(o+n.FIELD_DESCRIPTOR_LENGTH)},n.getFieldType=function(t){switch(t){case"C":return n.TYPE_CHAR;case"D":return n.TYPE_DATE;case"F":return n.TYPE_NUMBER;case"L":return n.TYPE_BOOLEAN;case"N":return n.TYPE_NUMBER;default:return null}},n.prototype.toString=function(){return this.name+"("+this.typeCode+")"},n.TYPE_CHAR="DBase.FieldTypeChar",n.TYPE_NUMBER="DBase.FieldTypeNumber",n.TYPE_DATE="DBase.FieldTypeDate",n.TYPE_BOOLEAN="DBase.FieldTypeBoolean",n.FIELD_NAME_LENGTH=11,n.FIELD_DESCRIPTOR_LENGTH=32,n}),i("../src/worldwind/formats/shapefile/DBaseRecord",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseField","../../formats/shapefile/DBaseFile","../../util/Logger"],function(t,e,r,i,n){"use strict";var o=function(e,r,i){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"DBaseRecord","constructor","missingAttributeName"));if(!r)throw new t(n.logMessage(n.LEVEL_SEVERE,"DBaseRecord","constructor","missingBuffer"));this.deleted=!1,this.recordNumber=i,this.values=null,this.readFromBuffer(e,r,i)};return o.prototype.isDeleted=function(){return this.deleted},o.prototype.getRecordNumber=function(){return this.recordNumber},o.prototype.readFromBuffer=function(t,i,o){i.order(e.LITTLE_ENDIAN),this.recordNumber=o;var a=i.getByte();this.deleted=42==a;var s=t.getFields();this.values={};for(var l=0,u=s.length;u>l;l+=1){var c=s[l],h=c.getName(),f=t.readNullTerminatedString(i,c.getLength()).trim();try{if(c.getType()==r.TYPE_BOOLEAN){var d=f.charAt(0);this.values[h]="t"==d||"T"==d||"Y"==d||"y"==d}else c.getType()==r.TYPE_CHAR?this.values[h]=f:c.getType()==r.TYPE_DATE?this.values[h]=new Date(f):c.getType()==r.TYPE_NUMBER&&(this.values[h]=+f)}catch(p){n.log(n.LEVEL_WARNING,"Shapefile attribute parsing error:"+c.toString()+" -> "+f.toString()+" ["+p+"]")}}},o}),i("../src/worldwind/formats/shapefile/DBaseFile",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseField","../../formats/shapefile/DBaseRecord","../../util/Logger"],function(t,e,r,i,n){"use strict";var o=function(e){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"DBaseFile","constructor","missingUrl"));this.url=e,this.header=null,this.fields=null,this.buffer=null,this["boolean"]=!0,this.numRecordsRead=0,this._completionCallback=null};return o.prototype.getLastModificationDate=function(){return this.header.lastModificationDate},o.prototype.getNumberOfRecords=function(){return this.header.numberOfRecords},o.prototype.getHeaderLength=function(){return this.header.headerLength},o.prototype.getRecordLength=function(){return this.header.recordLength},o.prototype.getNumberOfFields=function(){return(this.header.headerLength-1-o.FIXED_HEADER_LENGTH)/o.FIELD_DESCRIPTOR_LENGTH},o.prototype.getFields=function(){return this.fields},o.prototype.hasNext=function(){return this.numRecordsRead<this.header.numberOfRecords},o.prototype.nextRecord=function(){return this.numRecordsRead>=this.getNumberOfRecords()?null:this.readNextRecord(this._buffer,++this.numRecordsRead)},o.prototype.load=function(t){this._completionCallback=t,this.requestUrl(this.url)},o.prototype.requestUrl=function(t){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){4===r.readyState&&(200===r.status?(this._buffer=new e(r.response),this.parse(),this._completionCallback&&this._completionCallback(this)):(n.log(n.LEVEL_WARNING,"DBaseFile retrieval failed ("+r.statusText+"): "+t),this._completionCallback&&this._completionCallback(this)))}.bind(this),r.onerror=function(){n.log(n.LEVEL_WARNING,"DBaseFile retrieval failed: "+t),this._completionCallback&&this._completionCallback(this)},r.ontimeout=function(){n.log(n.LEVEL_WARNING,"DBaseFile retrieval timed out: "+t),this._completionCallback&&this._completionCallback(this)},r.send(null)},o.prototype.parse=function(){this.header=this.readHeader(this._buffer),this.fields=this.readFieldDescriptors(this._buffer,this.getNumberOfFields())},o.prototype.readHeader=function(t){var r=t.position;t.order(e.LITTLE_ENDIAN);var i=t.getByte();if(i>5)throw new Error("???");var n=t.getByte(),a=t.getByte(),s=t.getByte(),l=t.getInt32(),u=t.getInt16(),c=t.getInt16(),h={year:1900+n,month:a-1,day:s},f={fileCode:i,lastModificationDate:h,numberOfRecords:l,headerLength:u,recordLength:c};return t.seek(r+o.FIXED_HEADER_LENGTH),f},o.prototype.readFieldDescriptors=function(t,e){for(var i=t.position,n=[],a=0;e>a;a+=1)n[a]=new r(this,t);var s=this.header.headerLength-o.FIXED_HEADER_LENGTH;return t.seek(i+s),n},o.prototype.readNextRecord=function(t,e){return new i(this,t,e)},o.prototype.readNullTerminatedString=function(t,e){if(0>=e)return 0;for(var r="",i=0;e>i;i+=1){var n=t.getByte();if(0==n)break;r+=String.fromCharCode(n)}return this.isStringEmpty(r)?"":r},o.prototype.isStringEmpty=function(t){return t.length<=0||o.isStringFilled(t,32)||o.isStringFilled(t,42)},o.isStringFilled=function(t,e){if(t.length<=0)return!1;for(var r=0;r<t.length;r++)if(t.charAt(r)!=e)return!1;return!0},o.FIXED_HEADER_LENGTH=32,o.FIELD_DESCRIPTOR_LENGTH=32,o}),i("../src/worldwind/formats/shapefile/PrjFile",["../../error/ArgumentError","../../util/Logger","../../error/NotYetImplementedError"],function(t,e,r){"use strict";var i=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"DBaseFile","constructor","missingUrl"));this._url=r,this._completionCallback=null,this._params=null};return Object.defineProperties(i.prototype,{url:{get:function(){return this._url}},coordinateSystem:{get:function(){return this.params?this.params[i.COORDINATE_SYSTEM]:null}},params:{get:function(){return this._params}}}),i.prototype.load=function(t){this._completionCallback=t,this.requestUrl(this._url)},i.prototype.requestUrl=function(t){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var i=String.fromCharCode.apply(null,new Uint8Array(r.response));this._params=this.decodeOGCCoordinateSystem(i)}else e.log(e.LEVEL_WARNING,"PrjFile retrieval failed ("+r.statusText+"): "+t);this._completionCallback&&this._completionCallback(this)}}.bind(this),r.onerror=function(){e.log(e.LEVEL_WARNING,"PrjFile retrieval failed: "+t),this._completionCallback&&this._completionCallback(this)}.bind(this),r.ontimeout=function(){e.log(e.LEVEL_WARNING,"PrjFile retrieval timed out: "+t),this._completionCallback&&this._completionCallback(this)}.bind(this),r.send(null)},i.prototype.decodeOGCCoordinateSystem=function(n){n||new t(e.logMessage(e.LEVEL_SEVERE,"PrjFile","decodeOGCCoordinateSystem","missingText"));var o={};if(n=n.trim().toUpperCase(),i.GEOGCS_WKT_PATTERN.test(n))o[i.COORDINATE_SYSTEM]=i.COORDINATE_SYSTEM_GEOGRAPHIC;else{var a=n.match(i.PROJCS_WKT_PATTERN);if(a)throw o[PrfFile.COORDINATE_SYSTEM]=i.COORDINATE_SYSTEM_PROJECTED,new r(e.log(e.LEVEL_SEVERE,"PrjFile implementation  for projected coordinate systems in incomplete."));o[i.COORDINATE_SYSTEM]=i.COORDINATE_SYSTEM_UNKNOWN}return o},i.prototype.isUnknownCoordinateSystem=function(){return!this.params||this.params.coordinateSystem===i.COORDINATE_SYSTEM_UNKNOWN},i.prototype.isKnownCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem!==i.COORDINATE_SYSTEM_UNKNOWN},i.prototype.isGeographicCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem===i.COORDINATE_SYSTEM_GEOGRAPHIC},i.prototype.isProjectedCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem===i.COORDINATE_SYSTEM_PROJECTED},i.GEOGCS_WKT_PATTERN=new RegExp("\\{*GEOGCS[\\[\\(](.*)[\\]\\)]\\}*"),i.PROJCS_WKT_PATTERN=new RegExp("\\{*PROJCS[\\[\\(](.*)[\\]\\)]\\}*"),i.UTM_NAME_WKT_PATTERN=new RegExp(".*UTM.*ZONE.*?(\\d+).*?([\\w\\s]+).*?"),i.COORDINATE_SYSTEM="Coordinate_system",i.COORDINATE_SYSTEM_GEOGRAPHIC="Coordinate_system_geographic",i.COORDINATE_SYSTEM_PROJECTED="Coordinate_system_projected",i.COORDINATE_SYSTEM_UNKNOWN="Coordinate_system_unknown",i.PROJECTION_NAME="Projection_name",i.PROJECTION_UTM="Projection_UTM",i.PROJECTION_ZONE="Projection_zone",i.PROJECTION_HEMISPHERE="Projection_hemisphere",i.PROJECTION_HEMISPHERE_NORTH="Projection_hemisphere_north",i.PROJECTION_HEMISPHERE_SOUTH="Projection_hemisphere_south",i}),i("../src/worldwind/formats/shapefile/ShapefileRecord",["../../geom/Angle","../../error/ArgumentError","../../util/ByteBuffer","../../geom/Location","../../util/Logger","../../formats/shapefile/Shapefile"],function(t,e,r,i,n,o){"use strict";var a=function(t,r){if(!t)throw new e(n.logMessage(n.LEVEL_SEVERE,"ShapefileRecord","constructor","The specified shapefile is null or undefined"));if(!r)throw new e(n.logMessage(n.LEVEL_SEVERE,"ShapefileRecord","constructor","The specified buffer is null or undefined"));this._shapefile=t,this._recordNumber=-1,this._attributes={},this._numberOfParts=0,this._firstPartNumber=0,this._lastPartNumber=0,this._numberOfPoints=0,this._boundingRectangle=[],this._zRange=null,this._zValues=null,this._mRange=null,this._mValues=null,this._contentLengthInBytes=-1,this._buffer=r,this._isNormalized=!1,this._parts=[],this.readRecord()};return Object.defineProperties(a.prototype,{shapefile:{get:function(){return this._shapefile}},recordNumber:{get:function(){return this._recordNumber}},attributes:{get:function(){return this._attributes}},numberOfParts:{get:function(){return this._numberOfParts}},firstPartNumber:{get:function(){return this._firstPartNumber}},lastPartNumber:{get:function(){return this._lastPartNumber}},numberOfPoints:{get:function(){return this._numberOfPoints}},boundingRectangle:{get:function(){return this._boundingRectangle}},zRange:{get:function(){return this._zRange}},zValues:{get:function(){return this._zValues}},mRange:{get:function(){return this._mRange}},mValues:{get:function(){return this._mValues}}}),a.prototype.pointBuffer=function(t){return t>=0&&t<this._parts.length?this._parts[t]:null},a.prototype.readRecord=function(){this.readHeader(),this._buffer.order(r.LITTLE_ENDIAN);var t=this._buffer.getInt32(),e=this.shapefile.getShapeType(t);this.validateShapeType(e),this.readContents()},a.prototype.readHeader=function(){this._buffer.order(r.BIG_ENDIAN),this._recordNumber=this._buffer.getInt32(),this._contentLengthInBytes=2*this._buffer.getInt32()},a.prototype.validateShapeType=function(t){if(t!==this.shapefile.NULL&&t!==this.shapefile.shapeType)throw new Error(n.log(n.LEVEL_SEVERE,"Shapefile record is not supported."))},a.prototype.readNullContents=function(){this._numberOfParts=0,this._numberOfPoints=0,this._parts=null,this._boundingRectangle=null,this._buffer.seek(this._contentLengthInBytes-r.INT32_SIZE)},a.prototype.readPointContents=function(){this._numberOfParts=1,this._firstPartNumber=0,this._lastPartNumber=this._numberOfParts-1,this._numberOfPoints=1,this._parts=[this._buffer.getDoubleArray(2)];var t=this._parts[0][1],e=this._parts[0][0];this._boundingRectangle=[t,t,e,e],this.isZType()&&this.readZ(!0),this.isMeasureType()&&this.readOptionalMeasures(!0)},a.prototype.readPolylineContents=function(){var t=this.shapefile.readBoundingRectangle(this._buffer);if(this._boundingRectangle=t.coords,this._isNormalized=t.isNormalized,this._numberOfParts=this._buffer.getInt32(),this._firstPartNumber=0,this._lastPartNumber=this._numberOfParts-1,this._numberOfPoints=this._buffer.getInt32(),this._numberOfParts>0&&this._numberOfPoints>0)for(var e=this._buffer.getInt32Array(this.numberOfParts),r=0;r<this.numberOfParts;r+=1){var i=r==this.numberOfParts-1?this._numberOfPoints-e[r]:e[r+1]-e[r];this._parts[r]=this._buffer.getDoubleArray(2*i),a.normalizeLocations(this._parts[r])}this.isZType()&&this.readZ(!1),this.isMeasureType()&&this.readOptionalMeasures(!1)},a.prototype.readMultiPointContents=function(){var t=this.shapefile.readBoundingRectangle(this._buffer);this._boundingRectangle=t.coords,this._isNormalized=t.isNormalized,this._numberOfParts=1,this._numberOfPoints=this._buffer.getInt32(),this._parts=[this._buffer.getDoubleArray(2*this._numberOfPoints)],a.normalizeLocations(this._parts[0]),this.isZType()&&this.readZ(!1),this.isMeasureType()&&this.readOptionalMeasures(!1)},a.prototype.readZ=function(t){if(t){this._zValues=this._buffer.getDoubleArray(1);var e=this._zValues[0];this._zRange=[e,e]}else this._zRange=this._buffer.getDoubleArray(2),this._zValues=this._buffer.getDoubleArray(this.numberOfPoints)},a.prototype.readOptionalMeasures=function(t){if(this._buffer.hasRemaining()&&this._buffer.limit()-this._buffer.position>=8*this.numberOfPoints)if(t){this._mValues=this._buffer.getDoubleArray(1);var e=this._mValues[0];this._mRange=[e,e]}else this._mRange=this._buffer.getDoubleArray(2),this._mValues=this._buffer.getDoubleArray(this.numberOfPoints)},a.normalizeLocations=function(e){for(var r=0,i=e.length;i>r;r+=2){var n=e[r],o=e[r+1];e[r]=t.normalizedDegreesLongitude(n),e[r+1]=t.normalizedDegreesLatitude(o)}},a.prototype.isPointType=function(){return this.shapefile.isPointType()},a.prototype.isMultiPointType=function(){return this.shapefile.isMultiPointType()},a.prototype.isPolylineType=function(){return this.shapefile.isPolylineType()},a.prototype.isPolygonType=function(){return this.shapefile.isPolygonType()},a.prototype.isZType=function(){return this.shapefile.isZType()},a.prototype.isMeasureType=function(){return this.shapefile.isMeasureType()},a.prototype.setAttributes=function(t){this._attributes=t},a.RECORD_HEADER_LENGTH=8,a}),i("../src/worldwind/formats/shapefile/ShapefileRecordMultiPoint",["../../util/ByteBuffer","../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e,r){"use strict";var i=function(t,e){r.call(this,t,e)};return i.prototype=Object.create(r.prototype),i.prototype.readContents=function(){this.readMultiPointContents()},i}),i("../src/worldwind/formats/shapefile/ShapefileRecordNull",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r)};return r.prototype=Object.create(e.prototype),r.prototype.readContents=function(){this.readNullContents()},r}),i("../src/worldwind/formats/shapefile/ShapefileRecordPoint",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r)};return r.prototype=Object.create(e.prototype),r.prototype.readContents=function(){this.readPointContents()},r}),i("../src/worldwind/formats/shapefile/ShapefileRecordPolygon",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r)};return r.prototype=Object.create(e.prototype),r.prototype.readContents=function(){this.readPolylineContents()},r}),i("../src/worldwind/formats/shapefile/ShapefileRecordPolyline",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r)};return r.prototype=Object.create(e.prototype),r.prototype.readContents=function(){this.readPolylineContents()},r}),i("../src/worldwind/formats/shapefile/Shapefile",["../../geom/Angle","../../error/ArgumentError","../../util/ByteBuffer","../../util/Color","../../formats/shapefile/DBaseFile","../../geom/Location","../../util/Logger","../../error/NotYetImplementedError","../../shapes/Path","../../shapes/Placemark","../../shapes/PlacemarkAttributes","../../shapes/Polygon","../../geom/Position","../../formats/shapefile/PrjFile","../../layer/RenderableLayer","../../shapes/ShapeAttributes","../../formats/shapefile/ShapefileRecord","../../formats/shapefile/ShapefileRecordMultiPoint","../../formats/shapefile/ShapefileRecordNull","../../formats/shapefile/ShapefileRecordPoint","../../formats/shapefile/ShapefileRecordPolygon","../../formats/shapefile/ShapefileRecordPolyline","../../shapes/SurfacePolygon","../../shapes/SurfacePolyline"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m,g,y,v,E,w,b,x,_){"use strict";var S=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","constructor","missingUrl"));this._url=t,this._shapeType=null,this._layer=null,this._shapeConfigurationCallback=this.defaultShapeConfigurationCallback,this._parserCompletionCallback=this.defaultParserCompletionCallback,this._buffer=null,this.attributeFile=new n(t.replace(".shp",".dbf")),this.projectionFile=new d(t.replace(".shp",".prj")),this.defaultPlacemarkAttributes=new c(null),this.defaultShapeAttributes=new m(null)};return Object.defineProperties(S.prototype,{url:{get:function(){return this._url}},shapeType:{get:function(){return this._shapeType}},layer:{get:function(){return this._layer}},parserCompletionCallback:{get:function(){return this._parserCompletionCallback}},shapeConfigurationCallback:{get:function(){return this._shapeConfigurationCallback}}}),S.prototype.load=function(t,e,r){t&&(this._parserCompletionCallback=t),e&&(this._shapeConfigurationCallback=e),this._layer=r||new p;var i=function(){var t=function(){this.requestUrl(this.url)}.bind(this);this.attributeFile.load(t)}.bind(this);this.projectionFile.load(i)},S.prototype.defaultParserCompletionCallback=function(t){this.addRenderablesForShapefile(this.layer)},S.prototype.defaultShapeConfigurationCallback=function(t,e){var r={},i=t.values.name||t.values.Name||t.values.NAME;if(i&&(r.name=i),e.isPointType())r.attributes=this.defaultPlacemarkAttributes;else if(e.isMultiPointType())r.attributes=this.defaultPlacemarkAttributes;else if(e.isPolylineType())r.attributes=this.defaultShapeAttributes;else if(e.isPolygonType()){r.attributes=this.defaultShapeAttributes;var n=t.values.height||t.values.Height||t.values.HEIGHT;n&&(r.height=n)}return r},S.prototype.addRenderablesForShapefile=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForShapefile","missingLayer"));this.isPointType()?this.addRenderablesForPoints(t):this.isMultiPointType()?this.addRenderablesForMultiPoints(t):this.isPolylineType()?this.addRenderablesForPolylines(t):this.isPolygonType()&&this.addRenderablesForPolygons(t)},S.prototype.addRenderablesForPoints=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForPoints","missingLayer"));for(var r=this.next();r;r=this.next()){var i=this.shapeConfigurationCallback(r.attributes,r),n=i&&i.altitude?i.altitude:0;if(i)for(var o=0,s=r.numberOfParts;s>o;o+=1)for(var l=r.pointBuffer(o),c=0,h=l.length;h>c;c+=2){var d=l[c],p=l[c+1],m=new f(p,d,n),g=new u(m,!1,i.attributes);g.altitudeMode=i.altitudeMode||WorldWind.RELATIVE_TO_GROUND,i.highlightAttributes&&(g.highlightAttributes=i.highlightAttributes),i.name&&(g.label=i.name),i.pickDelegate&&(g.pickDelegate=i.pickDelegate),i.userProperties&&(g.userProperties=i.userProperties),t.addRenderable(g)}}},S.prototype.addRenderablesForMultiPoints=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForMultiPoints","missingLayer"));for(var r=this.next();r;r=this.next()){var i=this.shapeConfigurationCallback(r.attributes,r),n=i&&i.altitude?i.altitude:0;if(i)for(var o=0,s=r.numberOfParts;s>o;o+=1)for(var l=r.pointBuffer(o),c=0,h=l.length;h>c;c+=2){var d=l[c],p=l[c+1],m=new f(p,d,n),g=new u(m,!1,i.attributes);g.altitudeMode=i.altitudeMode||WorldWind.RELATIVE_TO_GROUND,i.highlightAttributes&&(g.highlightAttributes=i.highlightAttributes),i.name&&(g.label=i.name),i.pickDelegate&&(g.pickDelegate=i.pickDelegate),i.userProperties&&(g.userProperties=i.userProperties),t.addRenderable(g)}}},S.prototype.addRenderablesForPolylines=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForPolylines","missingLayer"));for(var r=this.next();r;r=this.next()){var i=this.shapeConfigurationCallback(r.attributes,r),n=i&&i.altitude?i.altitude:0;if(i)for(var s=0,u=r.numberOfParts;u>s;s+=1){for(var c=r.pointBuffer(s),h=[],d=0,p=c.length;p>d;d+=2){var m=c[d],g=c[d+1],y=n?new f(g,m,n):new o(g,m);h.push(y)}var v;n?(v=new l(h,i.attributes),v.altitudeMode=i.altitudeMode||WorldWind.RELATIVE_TO_GROUND):v=new _(h,i.attributes),i.highlightAttributes&&(v.highlightAttributes=i.highlightAttributes),i.name&&(v.displayName=i.name),i.pickDelegate&&(v.pickDelegate=i.pickDelegate),i.userProperties&&(v.userProperties=i.userProperties),t.addRenderable(v)}}},S.prototype.addRenderablesForPolygons=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForPolygons","missingLayer"));for(var r=this.next();r;r=this.next()){for(var i,n=this.shapeConfigurationCallback(r.attributes,r),s=[],l=n.height,u=n.altitude,c=0,d=r.numberOfParts;d>c;c+=1){for(var p=r.pointBuffer(c),m=[],g=0,y=p.length-2;y>g;g+=2){var v=p[g],E=p[g+1];i=l?new f(E,v,l):u?new f(E,v,u):new o(E,v),m.push(i)}s.push(m)}var w;l?(w=new h(s,n.attributes),w.extrude=!0,w.altitudeMode=n.altitudeMode||WorldWind.RELATIVE_TO_GROUND):u?(w=new h(s,n.attributes),w.altitudeMode=n.altitudeMode||WorldWind.RELATIVE_TO_GROUND):w=new x(s,n.attributes),n.highlightAttributes&&(w.highlightAttributes=n.highlightAttributes),n.name&&(w.displayName=n.name),n.pickDelegate&&(w.pickDelegate=n.pickDelegate),n.userProperties&&(w.userProperties=n.userProperties),t.addRenderable(w)}},S.prototype.next=function(){for(;this._buffer.position<this._buffer.limit();){var t=this.readRecord(this._buffer);if(!(t instanceof v))return t}return null},S.prototype.requestUrl=function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onreadystatechange=function(){4===e.readyState&&(200===e.status?(this._buffer=new r(e.response),this.parse()):a.log(a.LEVEL_WARNING,"Shapefile retrieval failed ("+e.statusText+"): "+t),this._parserCompletionCallback&&this._parserCompletionCallback(this))}.bind(this),e.onerror=function(){a.log(a.LEVEL_WARNING,"Shapefile retrieval failed: "+t),this._parserCompletionCallback&&this._parserCompletionCallback(this)},e.ontimeout=function(){a.log(a.LEVEL_WARNING,"Shapefile retrieval timed out: "+t),this._parserCompletionCallback&&this._parserCompletionCallback(this)},e.send(null)},S.prototype.parse=function(){try{var t=this.readHeader(this._buffer);this._shapeType=t.shapeType}catch(e){console.log(e)}finally{}},S.prototype.readHeader=function(t){t.order(r.BIG_ENDIAN);var e=t.getInt32();if(e!=S.FILE_CODE)throw new Error(a.log(a.LEVEL_SEVERE,"Shapefile header is invalid"));t.skipInt32s(5);var i=t.getInt32();t.order(r.LITTLE_ENDIAN);var n=t.getInt32(),o=t.getInt32(),s=this.readBoundingRectangle(t),l=this.getShapeType(o);if(null==l)throw new Error(a.log(a.LEVEL_SEVERE,"Shapefile type is unsupported: "+o.toString()));var u={fileLength:2*i,version:n,shapeType:l,boundingRectangle:s.coords,normalizePoints:s.isNormalized};return t.skipDoubles(4),u},S.prototype.readBoundingRectangle=function(t){return this.projectionFile?this.projectionFile.isGeographicCoordinateSystem()?this.readGeographicBoundingRectangle(t):this.projectionFile.isProjectedCoordinateSystem()?this.readProjectedBoundingRectangle(t):this.readUnspecifiedBoundingRectangle(t):this.readUnspecifiedBoundingRectangle(t)},S.prototype.readUnspecifiedBoundingRectangle=function(t){var e=this.readBoundingRectangleCoordinates(t);return{coords:e,isNormalized:!1}},S.prototype.readGeographicBoundingRectangle=function(e){var r=this.readBoundingRectangleCoordinates(e),i=!1,n=0;return r[0]<-90&&(n=t.normalizedDegreesLatitude(r[0]),r[0]=90,i=!0,r[1]<n&&(r[1]=n)),r[1]>90&&(n=t.normalizedDegreesLatitude(r[1]),r[1]=90,i=!0,r[0]>n&&(r[0]=n)),(r[2]<-180||r[3]>180)&&(r[2]=-180,r[3]=180,i=!0),{coords:r,isNormalized:i}},S.prototype.readProjectedBoundingRectangle=function(t){throw new s(a.log(a.LEVEL_SEVERE,"Shapefile.readProjectedBoundingRectangle() not yet implemented"))},S.prototype.readBoundingRectangleCoordinates=function(t){var e=t.getDouble(),r=t.getDouble(),i=t.getDouble(),n=t.getDouble();return[r,n,e,i]},S.prototype.readRecord=function(t){var e=this.createRecord(t);if(null!=e&&null!=this.attributeFile&&this.attributeFile.hasNext()){var r=this.attributeFile.nextRecord();e.setAttributes(r)}return e},S.prototype.createRecord=function(t){return this.isNullType()?this.createNull(t):this.isPointType()?this.createPoint(t):this.isMultiPointType()?this.createMultiPoint(t):this.isPolygonType()?this.createPolygon(t):this.isPolylineType()?this.createPolyline(t):null},S.prototype.createNull=function(t){return new v(this,t)},S.prototype.createPoint=function(t){return new E(this,t)},S.prototype.createMultiPoint=function(t){return new y(this,t)},S.prototype.createPolyline=function(t){return new b(this,t)},S.prototype.createPolygon=function(t){return new w(this,t)},S.prototype.getShapeType=function(t){switch(t){case 0:return S.NULL;case 1:return S.POINT;case 3:return S.POLYLINE;case 5:return S.POLYGON;case 8:return S.MULTI_POINT;case 11:return S.POINT_Z;case 13:return S.POLYLINE_Z;case 15:return S.POLYGON_Z;case 18:return S.MULTI_POINT_Z;case 21:return S.POINT_M;case 23:return S.POLYLINE_M;case 25:return S.POLYGON_M;case 28:return S.MULTI_POINT_M;default:return null}},S.prototype.isMeasureType=function(){return S.measureTypes.hasOwnProperty(this._shapeType)},S.prototype.isZType=function(){return S.zTypes.hasOwnProperty(this._shapeType)},S.prototype.isNullType=function(){return this._shapeType===S.NULL},S.prototype.isPointType=function(){return S.pointTypes.hasOwnProperty(this._shapeType)},S.prototype.isMultiPointType=function(){return S.multiPointTypes.hasOwnProperty(this._shapeType)},S.prototype.isPolylineType=function(){return S.polylineTypes.hasOwnProperty(this._shapeType)},S.prototype.isPolygonType=function(){return S.polygonTypes.hasOwnProperty(this._shapeType)},S.NULL="null",S.POINT="point",S.MULTI_POINT="multiPoint",S.POLYLINE="polyline",S.POLYGON="polygon",S.POINT_M=S.POINT+"M",S.MULTI_POINT_M=S.MULTI_POINT+"M",S.POLYLINE_M=S.POLYLINE+"M",S.POLYGON_M=S.POLYGON+"M",S.POINT_Z=S.POINT+"Z",S.MULTI_POINT_Z=S.MULTI_POINT+"Z",S.POLYLINE_Z=S.POLYLINE+"Z",S.POLYGON_Z=S.POLYGON+"Z",S.SHAPE_MULTI_PATCH="multiPatch",S.measureTypes={pointM:S.POINT_M,pointZ:S.POINT_Z,multiPointM:S.MULTI_POINT_M,multiPointZ:S.MULTI_POINT_Z,polylineM:S.POLYLINE_M,polylineZ:S.POLYLINE_Z,polygonM:S.POLYGON_M,polygonZ:S.POLYGON_Z},S.zTypes={pointZ:S.POINT_Z,multiPointZ:S.MULTI_POINT_Z,polylineZ:S.POLYLINE_Z,polygonZ:S.POLYGON_Z},S.pointTypes={point:S.POINT,pointZ:S.POINT_Z,pointM:S.POINT_M},S.multiPointTypes={multiPoint:S.MULTI_POINT,multiPointZ:S.MULTI_POINT_Z,multiPointM:S.MULTI_POINT_M},S.polylineTypes={polyline:S.POLYLINE,polylineZ:S.POLYLINE_Z,polylineM:S.POLYLINE_M},S.polygonTypes={polygon:S.POLYGON,polygonZ:S.POLYGON_Z,polygonM:S.POLYGON_M},S.FILE_CODE=9994,S}),i("../src/worldwind/layer/ShowTessellationLayer",["../shaders/BasicProgram","../layer/Layer"],function(t,e){"use strict";var r=function(){e.call(this,"Show Tessellation"),this.enableTerrainGeometry=!0,this.enableTerrainExtent=!1};return r.prototype=Object.create(e.prototype),r.prototype.doRender=function(t){
try{this.beginRendering(t),this.enableTerrainGeometry&&this.drawTerrainGeometry(t),this.enableTerrainExtent&&this.drawTerrainExtent(t)}finally{this.endRendering(t)}},r.prototype.beginRendering=function(t){var e=t.currentGlContext;e.depthMask(!1)},r.prototype.endRendering=function(t){var e=t.currentGlContext;e.depthMask(!0)},r.prototype.drawTerrainGeometry=function(e){if(e.terrain&&e.terrain.tessellator){var r,i,n=e.currentGlContext,o=e.terrain,a=o.tessellator,s=o.surfaceGeometry;try{r=e.findAndBindProgram(t),a.beginRendering(e);for(var l=0,u=s.length;u>l;l++)i=s[l],a.beginRenderingTile(e,i),r.loadColorComponents(n,1,1,1,.3),a.renderWireframeTile(e,i),r.loadColorComponents(n,1,0,0,.6),a.renderTileOutline(e,i),a.endRenderingTile(e,i)}finally{a.endRendering(e)}}},r.prototype.drawTerrainExtent=function(t){for(var e,r=t.terrain.surfaceGeometry,i=0,n=r.length;n>i;i++)e=r[i],e.extent.render(t)},r}),i("../src/worldwind/shaders/StarFieldProgram",["../error/ArgumentError","../shaders/GpuProgram","../util/Logger"],function(t,e,r){"use strict";var i=function(t){var r="attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nuniform float numDays;\nuniform vec2 magnitudeRange;\nvarying float magnitudeWeight;\nfloat normalizeAngle(float angle) {\n   float angleDivisions = angle / 360.0;\n   return 360.0 * (angleDivisions - floor(angleDivisions));\n}\nvec3 computePosition(float dec, float ra) {\n   float GMST = normalizeAngle(280.46061837 + 360.98564736629 * numDays);\n   float GHA = normalizeAngle(GMST - ra);\n   float lon = -GHA + 360.0 * step(180.0, GHA);\n   float latRad = radians(dec);\n   float lonRad = radians(lon);\n   float radCosLat = cos(latRad);\n   return vec3(radCosLat * sin(lonRad), sin(latRad), radCosLat * cos(lonRad));\n}\nfloat normalizeScalar(float value, float minValue, float maxValue){\n   return (value - minValue) / (maxValue - minValue);\n}\nvoid main() {\n   vec3 vertexPosition = computePosition(vertexPoint.x, vertexPoint.y);\n   gl_Position = mvpMatrix * vec4(vertexPosition.xyz, 1.0);\n   gl_Position.z = gl_Position.w - 0.00001;\n   gl_PointSize = vertexPoint.z;\n   magnitudeWeight = normalizeScalar(vertexPoint.w, magnitudeRange.x, magnitudeRange.y);\n}",i="precision mediump float;\nuniform sampler2D textureSampler;\nuniform int textureEnabled;\nvarying float magnitudeWeight;\nconst vec4 white = vec4(1.0, 1.0, 1.0, 1.0);\nconst vec4 grey = vec4(0.5, 0.5, 0.5, 1.0);\nvoid main() {\n   if (textureEnabled == 1) {\n       gl_FragColor = texture2D(textureSampler, gl_PointCoord);\n   }\n   else {\n       gl_FragColor = mix(white, grey, magnitudeWeight);\n   }\n}";e.call(this,t,r,i,["vertexPoint"]),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.numDaysLocation=this.uniformLocation(t,"numDays"),this.magnitudeRangeLocation=this.uniformLocation(t,"magnitudeRange"),this.textureUnitLocation=this.uniformLocation(t,"textureSampler"),this.textureEnabledLocation=this.uniformLocation(t,"textureEnabled")};return i.key="WorldWindGpuStarFieldProgram",i.prototype=Object.create(e.prototype),i.prototype.loadModelviewProjection=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"StarFieldProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,i,this.mvpMatrixLocation)},i.prototype.loadNumDays=function(e,i){if(null==i)throw new t(r.logMessage(r.LEVEL_SEVERE,"StarFieldProgram","loadNumDays","missingNumDays"));e.uniform1f(this.numDaysLocation,i)},i.prototype.loadMagnitudeRange=function(e,i,n){if(null==i)throw new t(r.logMessage(r.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMinMag"));if(null==n)throw new t(r.logMessage(r.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMaxMag"));e.uniform2f(this.magnitudeRangeLocation,i,n)},i.prototype.loadTextureUnit=function(t,e){t.uniform1i(this.textureUnitLocation,e-t.TEXTURE0)},i.prototype.loadTextureEnabled=function(t,e){t.uniform1i(this.textureEnabledLocation,e?1:0)},i}),i("../src/worldwind/util/SunPosition",["../geom/Angle","../error/ArgumentError","./Logger","./WWMath"],function(t,e,r,i){"use strict";var n={getAsGeographicLocation:function(t){if(t instanceof Date==!1)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","getAsGeographicLocation","missingDate"));var i=this.getAsCelestialLocation(t);return this.celestialToGeographic(i,t)},getAsCelestialLocation:function(n){if(n instanceof Date==!1)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","getAsCelestialLocation","missingDate"));var o=this.computeJulianDate(n),a=o-2451545,s=i.normalizeAngle360(280.46+.9856474*a),l=i.normalizeAngle360(357.528+.9856003*a)*t.DEGREES_TO_RADIANS,u=s+1.915*Math.sin(l)+.02*Math.sin(2*l),c=u*t.DEGREES_TO_RADIANS,h=(23.439-4e-7*a)*t.DEGREES_TO_RADIANS,f=Math.asin(Math.sin(h)*Math.sin(c))*t.RADIANS_TO_DEGREES,d=Math.atan(Math.cos(h)*Math.tan(c))*t.RADIANS_TO_DEGREES;return u>=90&&270>u&&(d+=180),d=i.normalizeAngle360(d),{declination:f,rightAscension:d}},celestialToGeographic:function(n,o){if(!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingCelestialLocation"));if(o instanceof Date==!1)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingDate"));var a=this.computeJulianDate(o),s=a-2451545,l=i.normalizeAngle360(280.46061837+360.98564736629*s),u=i.normalizeAngle360(l-n.rightAscension),c=t.normalizedDegreesLongitude(-u);return{latitude:n.declination,longitude:c}},computeJulianDate:function(t){if(t instanceof Date==!1)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","computeJulianDate","missingDate"));var i=t.getUTCFullYear(),n=t.getUTCMonth()+1,o=t.getUTCDate(),a=t.getUTCHours(),s=t.getUTCMinutes(),l=t.getUTCSeconds(),u=(a+s/60+l/3600)/24;2>=n&&(i-=1,n+=12);var c=Math.floor(i/100),h=2-c+Math.floor(c/4),f=Math.floor(365.25*(i+4716))+Math.floor(30.6001*(n+1))+o+h-1524.5;return f+u}};return n}),i("../src/worldwind/layer/StarFieldLayer",["./Layer","../util/Logger","../geom/Matrix","../shaders/StarFieldProgram","../util/SunPosition"],function(t,e,r,i,n){"use strict";var o=function(e){t.call(this,"StarField"),this.pickEnabled=!1,this.sunSize=128,this.showSun=!0,this._starDataSource=e||WorldWind.configuration.baseUrl+"images/stars.json",this._sunImageSource=WorldWind.configuration.baseUrl+"images/sunTexture.png",this._matrix=r.fromIdentity(),this._starsPositionsVboCacheKey=null,this._numStars=0,this._starData=null,this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE,this._loadStarted=!1,this._minScale=1e7,this._sunPositionsCacheKey="",this._sunBufferView=new Float32Array(4),this._MAX_GL_POINT_SIZE=0};return o.prototype=Object.create(t.prototype),Object.defineProperties(o.prototype,{starDataSource:{get:function(){return this._starDataSource},set:function(t){this._starDataSource=t,this.invalidateStarData()}},sunImageSource:{get:function(){return this._sunImageSource},set:function(t){this._sunImageSource=t}}}),o.prototype.doRender=function(t){if(!t.globe.is2D()){if(!this.haveResources(t))return void this.loadResources(t);this.beginRendering(t);try{this.doDraw(t)}finally{this.endRendering(t)}}},o.prototype.haveResources=function(t){var e=t.gpuResourceCache.resourceForKey(this._sunImageSource);return null!=this._starData&&null!=e},o.prototype.loadResources=function(t){var e=t.currentGlContext,r=t.gpuResourceCache;this._starData||this.fetchStarData();var i=r.resourceForKey(this._sunImageSource);i||r.retrieveTexture(e,this._sunImageSource)},o.prototype.beginRendering=function(t){var e=t.currentGlContext;t.findAndBindProgram(i),e.enableVertexAttribArray(0),e.depthMask(!1)},o.prototype.doDraw=function(t){this.loadCommonUniforms(t),this.renderStars(t),this.showSun&&this.renderSun(t)},o.prototype.loadCommonUniforms=function(t){var e=t.currentGlContext,r=t.currentProgram,i=t.navigatorState.eyePoint,o=t.globe.computePositionFromPoint(i[0],i[1],i[2],{}),a=Math.max(1.5*o.altitude,this._minScale);this._matrix.copy(t.navigatorState.modelviewProjection),this._matrix.multiplyByScale(a,a,a),r.loadModelviewProjection(e,this._matrix);var s=n.computeJulianDate(this.time||new Date);r.loadNumDays(e,s-2451545)},o.prototype.renderStars=function(t){var e=t.currentGlContext,r=t.gpuResourceCache,i=t.currentProgram;this._starsPositionsVboCacheKey||(this._starsPositionsVboCacheKey=r.generateCacheKey());var n=r.resourceForKey(this._starsPositionsVboCacheKey);if(n)e.bindBuffer(e.ARRAY_BUFFER,n);else{n=e.createBuffer();var o=this.createStarsGeometry();r.putResource(this._starsPositionsVboCacheKey,n,4*o.length),e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW)}t.frameStatistics.incrementVboLoadCount(1),e.vertexAttribPointer(0,4,e.FLOAT,!1,0,0),i.loadMagnitudeRange(e,this._minMagnitude,this._maxMagnitude),i.loadTextureEnabled(e,!1),e.drawArrays(e.POINTS,0,this._numStars)},o.prototype.renderSun=function(t){var r=t.currentGlContext,i=t.currentProgram,o=t.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&e.log(e.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE);var a=n.getAsCelestialLocation(this.time||new Date);this._sunBufferView[0]=a.declination,this._sunBufferView[1]=a.rightAscension,this._sunBufferView[2]=Math.min(this.sunSize,this._MAX_GL_POINT_SIZE),this._sunBufferView[3]=1,this._sunPositionsCacheKey||(this._sunPositionsCacheKey=o.generateCacheKey());var s=o.resourceForKey(this._sunPositionsCacheKey);s?(r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferSubData(r.ARRAY_BUFFER,0,this._sunBufferView)):(s=r.createBuffer(),o.putResource(this._sunPositionsCacheKey,s,4*this._sunBufferView.length),r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferData(r.ARRAY_BUFFER,this._sunBufferView,r.DYNAMIC_DRAW)),t.frameStatistics.incrementVboLoadCount(1),r.vertexAttribPointer(0,4,r.FLOAT,!1,0,0),i.loadTextureEnabled(r,!0);var l=t.gpuResourceCache.resourceForKey(this._sunImageSource);l.bind(t),r.drawArrays(r.POINTS,0,1)},o.prototype.endRendering=function(t){var e=t.currentGlContext;e.depthMask(!0),e.disableVertexAttribArray(0)},o.prototype.fetchStarData=function(){if(!this._loadStarted){this._loadStarted=!0;var t=this,r=new XMLHttpRequest;r.onload=function(){if(this.status>=200&&this.status<300)try{t._starData=JSON.parse(this.response),t.sendRedrawRequest()}catch(r){e.log(e.LEVEL_SEVERE,"StarFieldLayer unable to parse JSON for star data "+r.toString())}else e.log(e.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data. Status: "+this.status+" "+this.statusText);t._loadStarted=!1},r.onerror=function(){e.log(e.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data"),t._loadStarted=!1},r.ontimeout=function(){e.log(e.LEVEL_SEVERE,"StarFieldLayer fetch star data has timeout"),t._loadStarted=!1},r.open("GET",this._starDataSource,!0),r.send()}},o.prototype.createStarsGeometry=function(){var t=this.parseStarsMetadata(this._starData.metadata);if(-1===t.raIndex)throw new Error(e.logMessage(e.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing ra field in star data."));if(-1===t.decIndex)throw new Error(e.logMessage(e.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing dec field in star data."));if(-1===t.magIndex)throw new Error(e.logMessage(e.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing vmag field in star data."));var r=this._starData.data,i=[];this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE;for(var n=0,o=r.length;o>n;n++){var a=r[n],s=a[t.decIndex],l=a[t.raIndex],u=a[t.magIndex],c=2>u?2:1;i.push(s,l,c,u),this._minMagnitude=Math.min(this._minMagnitude,u),this._maxMagnitude=Math.max(this._maxMagnitude,u)}return this._numStars=Math.floor(i.length/4),i},o.prototype.parseStarsMetadata=function(t){for(var e=-1,r=-1,i=-1,n=0,o=t.length;o>n;n++){var a=t[n];"ra"===a.name&&(e=n),"dec"===a.name&&(r=n),"vmag"===a.name&&(i=n)}return{raIndex:e,decIndex:r,magIndex:i}},o.prototype.invalidateStarData=function(){this._starData=null,this._starsPositionsVboCacheKey=null},o.prototype.sendRedrawRequest=function(){var t=document.createEvent("Event");t.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(t)},o}),i("../src/worldwind/shapes/SurfaceEllipse",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,n,a,l){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"SurfaceEllipse","constructor","missingLocation"));if(0>r||0>n)throw new e(i.logMessage(i.LEVEL_SEVERE,"SurfaceEllipse","constructor","Radius is negative."));o.call(this,l),this._center=t,this._majorRadius=r,this._minorRadius=n,this._heading=a,this._intervals=s.DEFAULT_NUM_INTERVALS};return s.prototype=Object.create(o.prototype),Object.defineProperties(s.prototype,{center:{get:function(){return this._center},set:function(t){this.stateKeyInvalid=!0,this._center=t}},majorRadius:{get:function(){return this._majorRadius},set:function(t){this.stateKeyInvalid=!0,this._majorRadius=t}},minorRadius:{get:function(){return this._minorRadius},set:function(t){this.stateKeyInvalid=!0,this._minorRadius=t}},heading:{get:function(){return this._heading},set:function(t){this.stateKeyInvalid=!0,this._heading=t}},intervals:{get:function(){return this._intervals},set:function(t){this.stateKeyInvalid=!0,this._intervals=t}}}),s.staticStateKey=function(t){var e=o.staticStateKey(t);return e+" ce "+t.center.toString()+" ma "+t.majorRadius.toString()+" mi "+t.minorRadius.toString()+" he "+t.heading.toString()+" in "+t.intervals.toString()},s.prototype.computeStateKey=function(){return s.staticStateKey(this)},s.prototype.computeBoundaries=function(e){if(0==this.majorRadius&&0==this.minorRadius)return null;var i=e.globe,n=1+Math.max(s.MIN_NUM_INTERVALS,this.intervals),o=2*Math.PI/(n-1),l=i.radiusAt(this.center.latitude,this.center.longitude);this._boundaries=new Array(n);for(var u=0;n>u;u++){var c=u!=n-1?u*o:0,h=this.majorRadius*Math.cos(c),f=this.minorRadius*Math.sin(c),d=Math.sqrt(h*h+f*f),p=Math.PI/2-(Math.acos(h/d)*a.signum(f)-this.heading*t.DEGREES_TO_RADIANS);this._boundaries[u]=r.greatCircleLocation(this.center,p*t.RADIANS_TO_DEGREES,d/l,new r(0,0))}},s.MIN_NUM_INTERVALS=8,s.DEFAULT_NUM_INTERVALS=64,s}),i("../src/worldwind/shapes/SurfaceCircle",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceEllipse"],function(t,e,r,i){"use strict";var n=function(r,n,o){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceCircle","constructor","missingLocation"));if(0>n)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceCircle","constructor","Radius is negative"));i.call(this,r,n,n,0,o),this._radius=n};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{radius:{get:function(){return this._radius},set:function(t){this.stateKeyInvalid=!0,this._radius=t}}}),n.staticStateKey=function(t){var e=i.staticStateKey(t);return e+" ra "+t.radius.toString()},n.prototype.computeStateKey=function(){return n.staticStateKey(this)},n}),i("../src/worldwind/shapes/SurfaceRectangle",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,n,a,s){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"SurfaceRectangle","constructor","missingLocation"));if(0>r||0>n)throw new e(i.logMessage(i.LEVEL_SEVERE,"SurfaceRectangle","constructor","Size is negative."));o.call(this,s),this._center=t,this._width=r,this._height=n,this._heading=a};return s.prototype=Object.create(o.prototype),Object.defineProperties(s.prototype,{center:{get:function(){return this._center},set:function(t){this.stateKeyInvalid=!0,this._center=t}},width:{get:function(){return this._width},set:function(t){this.stateKeyInvalid=!0,this._width=t}},height:{get:function(){return this._height},set:function(t){this.stateKeyInvalid=!0,this._height=t}},heading:{get:function(){return this._heading},set:function(t){this.stateKeyInvalid=!0,this._heading=t}}}),s.staticStateKey=function(t){var e=o.staticStateKey(t);return e+" ce "+t.center.toString()+" wi "+t.width.toString()+" he "+t.height.toString()+" hd "+t.heading.toString()},s.prototype.computeStateKey=function(){return s.staticStateKey(this)},s.prototype.computeBoundaries=function(t){var e=.5*this.width,r=.5*this.height,i=t.globe.radiusAt(this.center.latitude,this.center.longitude);this._boundaries=new Array(4),this.addLocation(0,-e,-r,i),this.addLocation(1,e,-r,i),this.addLocation(2,e,r,i),this.addLocation(3,-e,r,i)},s.prototype.addLocation=function(e,i,n,o){var s=Math.sqrt(i*i+n*n),l=Math.PI/2-(Math.acos(i/s)*a.signum(n)-this.heading*t.DEGREES_TO_RADIANS);this._boundaries[e]=r.greatCircleLocation(this.center,l*t.RADIANS_TO_DEGREES,s/o,new r(0,0))},s}),i("../src/worldwind/render/SurfaceRenderable",["../util/Logger","../error/UnsupportedOperationError"],function(t,e){"use strict";var r=function(){throw this.displayName="Renderable",this.enabled=!0,new e(t.logMessage(t.LEVEL_SEVERE,"SurfaceRenderable","constructor","abstractInvocation"))};return r.prototype.renderSurface=function(r){throw new e(t.logMessage(t.LEVEL_SEVERE,"SurfaceRenderable","renderSurface","abstractInvocation"))},r}),i("../src/worldwind/shapes/SurfaceSector",["../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(t,e,r,i,n){"use strict";var o=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"SurfaceSector","constructor","missingSector"));n.call(this,i),this._sector=e};return o.prototype=Object.create(n.prototype),o.staticStateKey=function(t){var e=n.staticStateKey(t);return e},o.prototype.computeStateKey=function(){return o.staticStateKey(this)},o.prototype.computeBoundaries=function(t){var r=this._sector;this._boundaries=new Array(4),this._boundaries[0]=new e(r.minLatitude,r.minLongitude),this._boundaries[1]=new e(r.maxLatitude,r.minLongitude),this._boundaries[2]=new e(r.maxLatitude,r.maxLongitude),this._boundaries[3]=new e(r.minLatitude,r.maxLongitude)},o}),i("../src/worldwind/gesture/TapRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.numberOfTaps=1,this.numberOfTouches=1,this.maxTouchMovement=20,this.maxTapDuration=500,this.maxTapInterval=400,this.taps=[],this.timeout=null};return e.prototype=Object.create(t.prototype),e.prototype.reset=function(){t.prototype.reset.call(this),this.taps=[],this.cancelFailAfterDelay()},e.prototype.mouseDown=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.touchStart=function(t){if(this.state==WorldWind.POSSIBLE){var e;this.touchCount>this.numberOfTouches?this.state=WorldWind.FAILED:1==this.touchCount?(e={touchCount:this.touchCount,clientX:this.clientX,clientY:this.clientY},this.taps.push(e),this.failAfterDelay(this.maxTapDuration)):(e=this.taps[this.taps.length-1],e.touchCount=this.touchCount,e.clientX=this.clientX,e.clientY=this.clientY)}},e.prototype.touchMove=function(t){if(this.state==WorldWind.POSSIBLE){var e=this.translationX,r=this.translationY,i=Math.sqrt(e*e+r*r);i>this.maxTouchMovement&&(this.state=WorldWind.FAILED)}},e.prototype.touchEnd=function(t){if(this.state==WorldWind.POSSIBLE&&0==this.touchCount){var e=this.taps.length,r=this.taps[e-1];r.touchCount!=this.numberOfTouches?this.state=WorldWind.FAILED:e==this.numberOfTaps?(this.clientX=this.taps[0].clientX,this.clientY=this.taps[0].clientY,this.state=WorldWind.RECOGNIZED):this.failAfterDelay(this.maxTapInterval)}},e.prototype.touchCancel=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.failAfterDelay=function(t){var e=this;e.timeout&&window.clearTimeout(e.timeout),e.timeout=window.setTimeout(function(){e.timeout=null,e.state==WorldWind.POSSIBLE&&(e.state=WorldWind.FAILED)},t)},e.prototype.cancelFailAfterDelay=function(){var t=this;t.timeout&&(window.clearTimeout(t.timeout),t.timeout=null)},e}),i("../src/worldwind/layer/TectonicPlatesLayer",["../error/ArgumentError","../util/Color","../geom/Location","../util/Logger","../layer/RenderableLayer","../shapes/ShapeAttributes","../shapes/SurfacePolygon"],function(t,e,r,i,n,o,a){"use strict";var s=function(t){n.call(this,"Tectonic Plates"),t?this._attributes=t:(this._attributes=new o(null),this._attributes.drawInterior=!1,this._attributes.drawOutline=!0,this._attributes.outlineColor=e.RED),this.loadPlateData()};return s.prototype=Object.create(n.prototype),Object.defineProperties(a.prototype,{attributes:{get:function(){return this._attributes},set:function(t){t&&this.renderables.map(function(e,r,i){e.attributes=t})}}}),s.prototype.loadPlateData=function(){var t="http://worldwindserver.net/webworldwind/data/TectonicPlates.json",e=new XMLHttpRequest;e.open("GET",t,!0),e.onreadystatechange=function(){4===e.readyState&&(200===e.status?this.parse(e.responseText):i.log(i.LEVEL_WARNING,"Tectonic plate data retrieval failed ("+e.statusText+"): "+t))}.bind(this),e.onerror=function(){i.log(i.LEVEL_WARNING,"Tectonic plate data retrieval failed: "+t)},e.ontimeout=function(){i.log(i.LEVEL_WARNING,"Tectonic plate data retrieval timed out: "+t)},e.send(null)},s.prototype.parse=function(t){var e=JSON.parse(t),i=this;e.features.map(function(t,e,n){var o=[];t.geometry.coordinates.map(function(t,e,i){o.push(new r(t[1],t[0]))});var s=new a(o,i._attributes);i.addRenderable(s)})},s}),i("../src/worldwind/util/TileFactory",["../util/Logger","../error/UnsupportedOperationError"],function(t,e){"use strict";var r=function(){};return r.prototype.createTile=function(r,i,n,o){throw new e(t.logMessage(t.LEVEL_SEVERE,"TileFactory","createTile","abstractInvocation"))},r}),i("../src/worldwind/shapes/TriangleMesh",["../shapes/AbstractMesh","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolygon","../geom/Vec2","../geom/Vec3"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p){"use strict";var m=function(r,i,n){if(!r)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","missingPositions"));if(r.length<1)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","missingPositions"));if(r.length>65536)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","Too many positions. Must be fewer than 65537. Use TriangleMesh.split to split the shape."));if(!i)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","Indices array is null or undefined"));if(i.length<3)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","Too few indices."));t.call(this,n),this._positions=r,this._indices=i,this.referencePosition=this._positions[0]};return m.prototype=Object.create(t.prototype),Object.defineProperties(m.prototype,{positions:{get:function(){return this._positions},set:function(t){if(!t)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","positions","missingPositions"));this._positions=t,this.referencePosition=this._positions[0],this.reset()}},indices:{get:function(){return this._indices},set:function(t){if(!t)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","indices","Indices array is null or undefined"));this._indices=t,this.meshIndices=null,this.reset()}},outlineIndices:{get:function(){return this._outlineIndices},set:function(t){this._outlineIndices=t,this.meshOutlineIndices=null,this.reset()}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(t){if(t&&t.length!=this._positions.length)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","textureCoordinates","Number of texture coordinates is inconsistent with the currently specified positions."));this._textureCoordinates=t,this.reset(),this.texCoords=null}}}),m.prototype.createSurfaceShape=function(){if(this._outlineIndices){for(var t=[],e=0;e<this._outlineIndices.length;e++)t.push(this._positions[this._outlineIndices[e]]);return new f(t,null)}return null},m.prototype.computeMeshPoints=function(t,e){for(var r,i,n=Number.MAX_VALUE,o=t.navigatorState.eyePoint,a=new Float32Array(3*this._positions.length),s=new p(0,0,0),l=0,u=0;u<this._positions.length;u++)r=this._positions[u],t.surfacePointForMode(r.latitude,r.longitude,r.altitude*this._altitudeScale,this.altitudeMode,s),i=s.distanceToSquared(o),n>i&&(n=i),s.subtract(this.currentData.referencePoint),a[l++]=s[0],a[l++]=s[1],a[l++]=s[2];return e.eyeDistance=Math.sqrt(n),a},m.prototype.computeTexCoords=function(){if(this._textureCoordinates){for(var t=new Float32Array(2*this._textureCoordinates.length),e=0,r=0,i=this._textureCoordinates.length;i>r;r++){var n=this._textureCoordinates[r];t[e++]=n[0],t[e++]=n[1]}return t}return null},m.prototype.computeMeshIndices=function(){for(var t=new Uint16Array(this._indices.length),e=0,r=this._indices.length;r>e;e++)t[e]=this._indices[e];return t},m.prototype.computeOutlineIndices=function(){if(this._outlineIndices){for(var t=new Uint16Array(this._outlineIndices.length),e=0;e<this._outlineIndices.length;e++)t[e]=this._outlineIndices[e];return t}return null},m.split=function(t,e,r,i){for(var n,o,a=[],s=[],l=[],u=[],c=[],h=0;h<=e.length;h++){if(h===e.length||a.length>65533&&l.length%3===0){if(a.length>0){var f={positions:a,indices:l};if(r&&(f.textureCoords=s),i){for(var d=[],p=0;p<i.length;p++)n=i[p],o=u[n],o&&d.push(u[i[p]]);f.outlineIndices=d}c.push(f)}if(h===e.length)break;a=[],l=[],u=[]}n=e[h],o=u[n],o||(o=a.length,u[n]=o,a.push(t[n]),r&&s.push(r[n])),l.push(o)}return c},m}),i("../src/worldwind/layer/ViewControlsLayer",["../geom/Angle","../error/ArgumentError","../layer/Layer","../geom/Location","../navigate/LookAt","../util/Logger","../util/Offset","../shapes/ScreenImage","../geom/Vec2","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u){"use strict";var c=function(t){if(!t)throw new e(o.logMessage(o.LEVEL_SEVERE,"ViewControlsLayer","constructor","missingWorldWindow"));r.call(this,"View Controls"),this.wwd=t,this.placement=new a(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0),this.alignment=new a(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0),this.exaggerationIncrement=.01,this.zoomIncrement=.04,this.headingIncrement=1,this.tiltIncrement=1,this.fieldOfViewIncrement=.1,this.panIncrement=.001,this._inactiveOpacity=.5,this._activeOpacity=1;var i=new a(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0),n=WorldWind.configuration.baseUrl+"images/view/";this.panControl=new s(i.clone(),n+"view-pan-64x64.png"),this.zoomInControl=new s(i.clone(),n+"view-zoom-in-32x32.png"),this.zoomOutControl=new s(i.clone(),n+"view-zoom-out-32x32.png"),this.headingLeftControl=new s(i.clone(),n+"view-heading-left-32x32.png"),this.headingRightControl=new s(i.clone(),n+"view-heading-right-32x32.png"),this.tiltUpControl=new s(i.clone(),n+"view-pitch-up-32x32.png"),this.tiltDownControl=new s(i.clone(),n+"view-pitch-down-32x32.png"),this.exaggerationUpControl=new s(i.clone(),n+"view-elevation-up-32x32.png"),this.exaggerationDownControl=new s(i.clone(),n+"view-elevation-down-32x32.png"),this.fovNarrowControl=new s(i.clone(),n+"view-fov-narrow-32x32.png"),this.fovWideControl=new s(i.clone(),n+"view-fov-wide-32x32.png"),this.fovNarrowControl.enabled=!1,this.fovWideControl.enabled=!1,this.controls=[this.panControl,this.zoomInControl,this.zoomOutControl,this.headingLeftControl,this.headingRightControl,this.tiltUpControl,this.tiltDownControl,this.exaggerationUpControl,this.exaggerationDownControl,this.fovNarrowControl,this.fovWideControl];for(var u=0;u<this.controls.length;u++)this.controls[u].imageOffset=i.clone(),this.controls[u].opacity=this._inactiveOpacity,this.controls[u]===this.panControl?this.controls[u].size=64:this.controls[u].size=32;this.panControlCenter=new l(0,0),this.isTouchDevice=!1,this.pickEnabled=!1,this.setupInteraction()};return c.prototype=Object.create(r.prototype),Object.defineProperties(c.prototype,{showPanControl:{get:function(){return this.panControl.enabled},set:function(t){this.panControl.enabled=t}},showZoomControl:{get:function(){return this.zoomInControl.enabled},set:function(t){this.zoomInControl.enabled=t,this.zoomOutControl.enabled=t}},showHeadingControl:{get:function(){return this.headingLeftControl.enabled},set:function(t){this.headingLeftControl.enabled=t,this.headingRightControl.enabled=t}},showTiltControl:{get:function(){return this.tiltUpControl.enabled},set:function(t){this.tiltUpControl.enabled=t,this.tiltDownControl.enabled=t}},showExaggerationControl:{get:function(){return this.exaggerationUpControl.enabled},set:function(t){this.exaggerationUpControl.enabled=t,this.exaggerationDownControl.enabled=t}},showFieldOfViewControl:{get:function(){return this.fovNarrowControl.enabled},set:function(t){this.fovNarrowControl.enabled=t,this.fovWideControl.enabled=t}},inactiveOpacity:{get:function(){return this._inactiveOpacity},set:function(t){this._inactiveOpacity=t;for(var e=0;e<this.controls.length;e++)this.controls[e].opacity=t}},activeOpacity:{get:function(){return this._activeOpacity},set:function(t){this._activeOpacity=t;for(var e=0;e<this.controls.length;e++)this.controls[e].opacity=t}}}),c.prototype.doRender=function(t){var e,r,i,n,o=0,a=64;this.inCurrentFrame=!1,this.showPanControl&&(o+=this.panControl.size,this.inCurrentFrame=!0),this.showZoomControl&&(o+=this.zoomInControl.size,this.inCurrentFrame=!0),this.showHeadingControl&&(o+=this.headingLeftControl.size,this.inCurrentFrame=!0),this.showTiltControl&&(o+=this.tiltDownControl.size,this.inCurrentFrame=!0),this.showExaggerationControl&&(o+=this.exaggerationDownControl.size,this.inCurrentFrame=!0),this.showFieldOfViewControl&&(o+=this.fovNarrowControl.size,this.inCurrentFrame=!0),r=this.placement.offsetForSize(t.navigatorState.viewport.width,t.navigatorState.viewport.height),e=this.alignment.offsetForSize(o,a),i=r[0]-e[0],n=r[1]-e[1],this.showPanControl&&(this.panControl.screenOffset.x=i,this.panControl.screenOffset.y=n,this.panControl.render(t),this.panControlCenter[0]=i+this.panControl.size/2,this.panControlCenter[1]=n+this.panControl.size/2,i+=this.panControl.size),this.showZoomControl&&(this.zoomOutControl.screenOffset.x=i,this.zoomOutControl.screenOffset.y=n,this.zoomInControl.screenOffset.x=i,this.zoomInControl.screenOffset.y=n+this.zoomOutControl.size,this.zoomOutControl.render(t),this.zoomInControl.render(t),i+=this.zoomOutControl.size),this.showHeadingControl&&(this.headingRightControl.screenOffset.x=i,this.headingRightControl.screenOffset.y=n,this.headingLeftControl.screenOffset.x=i,this.headingLeftControl.screenOffset.y=n+this.headingLeftControl.size,this.headingRightControl.render(t),this.headingLeftControl.render(t),i+=this.headingLeftControl.size),this.showTiltControl&&(this.tiltDownControl.screenOffset.x=i,this.tiltDownControl.screenOffset.y=n,this.tiltUpControl.screenOffset.x=i,this.tiltUpControl.screenOffset.y=n+this.tiltDownControl.size,this.tiltDownControl.render(t),this.tiltUpControl.render(t),i+=this.tiltDownControl.size),this.showExaggerationControl&&(this.exaggerationDownControl.screenOffset.x=i,this.exaggerationDownControl.screenOffset.y=n,this.exaggerationUpControl.screenOffset.x=i,this.exaggerationUpControl.screenOffset.y=n+this.exaggerationDownControl.size,this.exaggerationUpControl.render(t),this.exaggerationDownControl.render(t),i+=this.exaggerationDownControl.size),this.showFieldOfViewControl&&(this.fovNarrowControl.screenOffset.x=i,this.fovNarrowControl.screenOffset.y=n,this.fovWideControl.screenOffset.x=i,this.fovWideControl.screenOffset.y=n+this.fovNarrowControl.size,this.fovNarrowControl.render(t),this.fovWideControl.render(t))},c.prototype.setupInteraction=function(){var t=this.wwd,e=this,r=function(r){if(e.enabled&&!e.isTouchDevice){var i,n;e.highlightedControl&&(e.highlight(e.highlightedControl,!1),e.wwd.redraw()),r.type&&"mouseup"===r.type&&1===r.which&&e.activeControl?(e.activeControl=null,
e.activeOperation=null,r.preventDefault()):(e.activeOperation?(e.activeOperation.call(e,r,null),r.preventDefault()):(i=e.pickControl(t.canvasCoordinates(r.clientX,r.clientY)),n=e.determineOperation(r,i),n&&n.call(e,r,i)),e.handleHighlight(r,i),e.wwd.redraw())}};t.addEventListener("mousedown",r),t.addEventListener("mouseup",r),t.addEventListener("mousemove",r),window.addEventListener("mouseup",r),window.addEventListener("mousemove",r);var i=function(r){if(this.isTouchDevice=!0,e.enabled){if(e.highlightedControl&&(e.highlight(e.highlightedControl,!1),e.wwd.redraw()),!r.type||"touchend"!==r.type&&"touchcancel"!==r.type)if(e.activeOperation)e.activeOperation.call(e,r,null),r.preventDefault();else{var i,n,o=r.changedTouches.item(0);i=e.pickControl(t.canvasCoordinates(o.clientX,o.clientY)),n=e.determineOperation(r,i),n&&n.call(e,r,i)}else e.activeControl&&e.isCurrentTouch(r)&&(e.activeControl=null,e.activeOperation=null,r.preventDefault());e.handleHighlight(r,i),e.wwd.redraw()}};t.addEventListener("touchstart",i),t.addEventListener("touchend",i),t.addEventListener("touchcancel",i),t.addEventListener("touchmove",i)},c.prototype.isControl=function(t){for(var e=0;e<this.controls.length;e++)if(this.controls[e]==t)return!0;return!1},c.prototype.pickControl=function(t){for(var e,r=t[0],i=this.wwd.canvas.height-t[1],n=0;n<this.controls.length;n++)if(e=this.controls[n],e.enabled&&r>=e.screenOffset.x&&r<=e.screenOffset.x+e.size&&i>=e.screenOffset.y&&i<=e.screenOffset.y+e.size)return e;return null},c.prototype.determineOperation=function(t,e){var r=null;return e&&e instanceof s&&(e===this.panControl?r=this.handlePan:e===this.zoomInControl||e===this.zoomOutControl?r=this.handleZoom:e===this.headingLeftControl||e===this.headingRightControl?r=this.handleHeading:e===this.tiltUpControl||e===this.tiltDownControl?r=this.handleTilt:e===this.exaggerationUpControl||e===this.exaggerationDownControl?r=this.handleExaggeration:(e===this.fovNarrowControl||e===this.fovWideControl)&&(r=this.handleFov)),r},c.prototype.isCurrentTouch=function(t){for(var e=0;e<t.changedTouches.length;e++)if(t.changedTouches.item(e).identifier===this.currentTouchId)return!0;return!1},c.prototype.handlePan=function(e,r){if("mousedown"===e.type||"mousemove"===e.type)this.currentEventPoint=this.wwd.canvasCoordinates(e.clientX,e.clientY);else if("touchstart"===e.type||"touchmove"===e.type){var o=e.changedTouches.item(0);this.currentEventPoint=this.wwd.canvasCoordinates(o.clientX,o.clientY)}if("mousedown"===e.type&&1===e.which||"touchstart"===e.type){this.activeControl=r,this.activeOperation=this.handlePan,e.preventDefault(),"touchstart"===e.type&&(this.currentTouchId=e.changedTouches.item(0).identifier);var a=new n;this.wwd.navigator.getAsLookAt(this.wwd.globe,a);var s=this,l=function(){if(s.activeControl){var e=s.panControlCenter[0]-s.currentEventPoint[0],r=s.panControlCenter[1]-(s.wwd.viewport.height-s.currentEventPoint[1]),n=a.latitude,o=a.longitude,u=s.panIncrement*(a.range/s.wwd.globe.radiusAt(n,o)),c=a.heading+Math.atan2(e,r)*t.RADIANS_TO_DEGREES,h=u*Math.sqrt(e*e+r*r);i.greatCircleLocation(a,c,-h,a),s.wwd.navigator.setAsLookAt(s.wwd.globe,a),s.wwd.redraw(),setTimeout(l,50)}};setTimeout(l,50)}},c.prototype.handleZoom=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleZoom,t.preventDefault();var r=new n;this.wwd.navigator.getAsLookAt(this.wwd.globe,r),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var i=this,o=function(){i.activeControl&&(i.activeControl===i.zoomInControl?r.range*=1-i.zoomIncrement:i.activeControl===i.zoomOutControl&&(r.range*=1+i.zoomIncrement),i.wwd.navigator.setAsLookAt(i.wwd.globe,r),i.wwd.redraw(),setTimeout(o,50))};setTimeout(o,50)}},c.prototype.handleHeading=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleHeading,t.preventDefault();var r=new n;this.wwd.navigator.getAsLookAt(this.wwd.globe,r),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var i=this,o=function(){i.activeControl&&(i.activeControl===i.headingLeftControl?r.heading+=i.headingIncrement:i.activeControl===i.headingRightControl&&(r.heading-=i.headingIncrement),i.wwd.navigator.setAsLookAt(i.wwd.globe,r),i.wwd.redraw(),setTimeout(o,50))};setTimeout(o,50)}},c.prototype.handleTilt=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleTilt,t.preventDefault();var r=new n;this.wwd.navigator.getAsLookAt(this.wwd.globe,r),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var i=this,o=function(){i.activeControl&&(i.activeControl===i.tiltUpControl?r.tilt=Math.max(0,r.tilt-i.tiltIncrement):i.activeControl===i.tiltDownControl&&(r.tilt=Math.min(90,r.tilt+i.tiltIncrement)),i.wwd.navigator.setAsLookAt(i.wwd.globe,r),i.wwd.redraw(),setTimeout(o,50))};setTimeout(o,50)}},c.prototype.handleExaggeration=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleExaggeration,t.preventDefault(),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var r=this,i=function(){r.activeControl&&(r.activeControl===r.exaggerationUpControl?r.wwd.verticalExaggeration+=r.exaggerationIncrement:r.activeControl===r.exaggerationDownControl&&(r.wwd.verticalExaggeration=Math.max(1,r.wwd.verticalExaggeration-r.exaggerationIncrement)),r.wwd.redraw(),setTimeout(i,50))};setTimeout(i,50)}},c.prototype.handleFov=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleFov,t.preventDefault(),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var r=this,i=function(){r.activeControl&&(r.activeControl===r.fovWideControl?r.wwd.navigator.fieldOfView=Math.max(90,r.wwd.navigator.fieldOfView+r.fieldOfViewIncrement):r.activeControl===r.fovNarrowControl&&(r.wwd.navigator.fieldOfView=Math.min(0,r.wwd.navigator.fieldOfView-r.fieldOfViewIncrement)),r.wwd.redraw(),setTimeout(i,50))};setTimeout(i,50)}},c.prototype.handleHighlight=function(t,e){this.activeControl?this.highlight(this.activeControl,!0):e&&this.isControl(e)&&this.highlight(e,!0)},c.prototype.highlight=function(t,e){t.opacity=e?this._activeOpacity:this._inactiveOpacity,e?this.highlightedControl=t:this.highlightedControl=null},c}),i("../src/worldwind/util/WcsTileUrlBuilder",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i,n){if(!r||0===r.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsTileUrlBuilder","constructor","The WCS service address is missing."));if(!i||0===i.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsTileUrlBuilder","constructor","The WCS coverage name is missing."));this.serviceAddress=r,this.coverageName=i,this.wcsVersion=n&&n.length>0?n:"1.0.0",this.crs="EPSG:4326"};return r.prototype.urlForTile=function(i,n){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsUrlBuilder","urlForTile","missingTile"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsUrlBuilder","urlForTile","The coverage format is null or undefined."));var o=i.sector,a=r.fixGetCoverageString(this.serviceAddress);return a.search(/service=wcs/i)<0&&(a+="service=WCS"),a+="&request=GetCoverage",a=a+"&version="+this.wcsVersion,a=a+"&coverage="+this.coverageName,a=a+"&format="+n,a=a+"&width="+i.tileWidth,a=a+"&height="+i.tileHeight,a=a+"&crs="+this.crs,a+="&bbox=",a=a+o.minLongitude+","+o.minLatitude+",",a=a+o.maxLongitude+","+o.maxLatitude,a=a.replace(" ","%20")},r.fixGetCoverageString=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsTileUrlBuilder","fixGetCoverageString","The specified service address is null or undefined."));var i=r.indexOf("?");return 0>i?r+="?":i!==r.length-1&&(i=r.search(/&$/),0>i&&(r+="&")),r},r}),i("../src/worldwind/ogc/wmts/OwsLanguageString",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"LanguageString","constructor","missingDomElement"));this.value=r.textContent,this.lang;var i=r.getAttribute("lang");i&&(this.lang=i)};return r}),i("../src/worldwind/ogc/wmts/OwsConstraint",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsConstraint","constructor","missingDomElement"));this.name=r.getAttribute("name");for(var i=r.children,n=0;n<i.length;n++){var o=i[n];if("AllowedValues"===o.localName){this.allowedValues=this.allowedValues||[];for(var a=0;a<o.children.length;a++)"Value"===o.children[a].localName&&this.allowedValues.push(o.children[a].textContent)}else"AnyValue"===o.localName?this.anyValue=!0:"NoValues"===o.localName&&(this.noValues=!0)}};return r}),i("../src/worldwind/ogc/wmts/OwsOperationsMetadata",["../../error/ArgumentError","../../util/Logger","../../ogc/wmts/OwsConstraint"],function(t,e,r){"use strict";var i=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsOperationsMetadata","constructor","missingDomElement"));for(var n=r.children,o=0;o<n.length;o++){var a=n[o];"Operation"===a.localName&&(this.operation=this.operation||[],this.operation.push(i.assembleOperation(a)))}};return i.prototype.getGetCapabilities=function(){return this.getOperationMetadataByName("GetCapabilities")},i.prototype.getGetTile=function(){return this.getOperationMetadataByName("GetTile")},i.prototype.getOperationMetadataByName=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsOperationsMetadata","getOperationsMetadataByName","missingName"));for(var i=0;i<this.operation.length;i++)if(this.operation[i].name===r)return this.operation[i];return null},i.assembleOperation=function(t){var e={};e.name=t.getAttribute("name");for(var r=t.children,n=0;n<r.length;n++){var o=r[n];"DCP"===o.localName&&(e.dcp=e.dcp||[],e.dcp.push(i.assembleDcp(o)))}return e},i.assembleDcp=function(t){for(var e={},r=t.children,n=0;n<r.length;n++){var o=r[n];if("HTTP"===o.localName)for(var a=o.children||o.childNodes,s=0;s<a.length;s++){var l=a[s];"Get"===l.localName?(e.getMethods=e.getMethods||[],e.getMethods.push(i.assembleMethod(l))):"Post"===l.localName&&(e.postMethods=e.postMethods||[],e.postMethods.push(i.assembleMethod(l)))}}return e},i.assembleMethod=function(t){var e={};e.url=t.getAttribute("xlink:href");for(var i=t.children,n=0;n<i.length;n++){var o=i[n];"Constraint"===o.localName&&(e.constraint=e.constraint||[],e.constraint.push(new r(o)))}return e},i}),i("../src/worldwind/ogc/wmts/OwsDescription",["../../error/ArgumentError","../../util/Logger","../../ogc/wmts/OwsLanguageString"],function(t,e,r){"use strict";var i=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsDescription","assembleDescriptions","missingDomElement"));for(var n=i.children||i.childNodes,o=0;o<n.length;o++){var a=n[o];if("Title"===a.localName)this.titles=this.titles||[],this.titles.push(new r(a));else if("Abstract"===a.localName)this.abstracts=this.abstracts||[],this.abstracts.push(new r(a));else if("Keywords"===a.localName){this.keywords=this.keywords||[];for(var s=a.children||a.childNodes,l=0;l<s.length;l++){var u=s[l];this.keywords.push(new r(u))}}}};return i}),i("../src/worldwind/ogc/wmts/OwsServiceIdentification",["../../error/ArgumentError","../../util/Logger","../../ogc/wmts/OwsDescription"],function(t,e,r){"use strict";var i=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceIdentification","constructor","missingDomElement"));r.call(this,i);for(var n=i.children,o=0;o<n.length;o++){var a=n[o];"ServiceType"===a.localName?this.serviceType=a.textContent:"ServiceTypeVersion"===a.localName?(this.serviceTypeVersions=this.serviceTypeVersions||[],this.serviceTypeVersions.push(a.textContent)):"Profile"===a.localName?(this.profile=this.profiles||[],this.profile.push(a.textContent)):"Fees"===a.localName?this.fees=a.textContent:"AccessConstraints"===a.localName&&(this.accessConstraints=this.accessConstraints||[],this.accessConstraints.push(a.textContent))}};return i.prototype=Object.create(r.prototype),i}),i("../src/worldwind/ogc/wmts/OwsServiceProvider",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","constructor","missingDomElement"));for(var n=i.children||i.childNodes,o=0;o<n.length;o++){var a=n[o];"ProviderName"===a.localName?this.providerName=a.textContent:"ProviderSite"===a.localName?this.providerSiteUrl=a.getAttribute("xlink:href"):"ServiceContact"===a.localName&&(this.serviceContact=r.assembleServiceContact(a))}};return r.assembleServiceContact=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assembleServiceContact","missingDomElement"));for(var n={},o=i.children||i.childNodes,a=0;a<o.length;a++){var s=o[a];"IndividualName"===s.localName?n.individualName=s.textContent:"PositionName"===s.localName?n.positionName=s.textContent:"ContactInfo"===s.localName&&(n.contactInfo=r.assembleContacts(s))}return n},r.assembleContacts=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assembleContacts","missingDomElement"));for(var n={},o=i.children||i.childNodes,a=0;a<o.length;a++){var s=o[a];"HoursOfService"===s.localName?n.hoursOfService=s.textContent:"ContactInstructions"===s.localName?n.contactInstructions=s.textContent:"Phone"===s.localName?n.phone=r.assemblePhone(s):"Address"===s.localName&&(n.address=r.assembleAddress(s))}return n},r.assemblePhone=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assemblePhone","missingDomElement"));for(var i={},n=r.children||r.childNodes,o=0;o<n.length;o++){var a=n[o];"Voice"===a.localName?i.voice=a.textContent:"Facsimile"===a.localName&&(i.facsimile=a.textContent)}return i},r.assembleAddress=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assembleAddress","missingDomElement"));for(var i={},n=r.children||r.childNodes,o=0;o<n.length;o++){var a=n[o];"DeliveryPoint"===a.localName?(i.deliveryPoints=i.deliveryPoints||[],i.deliveryPoints.push(a.textContent)):"City"===a.localName?i.city=a.textContent:"AdministrativeArea"===a.localName?i.administrativeArea=a.textContent:"PostalCode"===a.localName?(i.postalCodes=i.postalCodes||[],i.postalCodes.push(a.textContent)):"Country"===a.localName?(i.countries=i.countries||[],i.countries.push(a.textContent)):"ElectronicMailAddress"===a.localName&&(i.electronicMailAddresses=i.electronicMailAddresses||[],i.electronicMailAddresses.push(a.textContent))}return i},r}),i("../src/worldwind/ogc/WfsCapabilities",["../error/ArgumentError","../util/Logger","../ogc/wmts/OwsLanguageString","../ogc/wmts/OwsOperationsMetadata","../ogc/wmts/OwsServiceIdentification","../ogc/wmts/OwsServiceProvider"],function(t,e,r,i,n,o){"use strict";var a=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WfsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(r)};return a.prototype.assembleDocument=function(t){var e=t.documentElement;this.version=e.getAttribute("version"),this.updateSequence=e.getAttribute("updateSequence");for(var r=e.children||e.childNodes,a=0;a<r.length;a++){var s=r[a];"ServiceIdentification"===s.localName?this.serviceIdentification=new n(s):"ServiceProvider"===s.localName?this.serviceProvider=new o(s):"OperationsMetadata"===s.localName?this.operationsMetadata=new i(s):"FeatureTypeList"===s.localName?this.featureTypeList=this.assembleFeatureTypeList(s):"Filter_Capabilities"===s.localName&&(this.filterCapabilities=this.assembleFilterCapabilities(s))}},a.prototype.assembleFeatureTypeList=function(t){for(var r={},i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];if("Operations"==o.localName){r.operations=r.operations||[];try{r.operations=a.assembleOperations(o)}catch(s){e.logMessage(e.LEVEL_SEVERE,"WfsCapabilities","constructor","Exception reading WFS operations description: "+s.message)}}else if("FeatureType"==o.localName){r.featureType=r.featureType||[];try{r.featureType.push(a.assembleFeatureType(o))}catch(s){e.logMessage(e.LEVEL_SEVERE,"WfsCapabilities","constructor","Exception reading WFS operations description: "+s.message)}}}return r},a.prototype.assembleFilterCapabilities=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Conformance"===n.localName?e.conformance=a.assembleConformance(n):"Id_Capabilities"===n.localName?e.idCapabilities=a.assembleIdCapabilities(n):"Scalar_Capabilities"===n.localName?e.scalarCapabilities=a.assembleScalarCapabilities(n):"Spatial_Capabilities"===n.localName?e.spatialCapabilities=a.assembleSpatialCapabilities(n):"Functions"===n.localName&&(e.functions=a.assembleFunctions(n))}return e},a.assembleOperations=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Operation"==n.localName&&e.push(n.textContent)}return e},a.assembleFeatureType=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Name"==n.localName?e.name=n.textContent:"Title"==n.localName?e.title=n.textContent:"Abstract"==n.localName?e["abstract"]=n.textContent:"Keywords"==n.localName?(e.keywords=e.keywords||[],e.keywords=a.assembleKeywords(n)):"DefaultSRS"==n.localName?e.defaultSRS=n.textContent:"OtherSRS"==n.localName?(e.otherSRS=e.otherSRS||[],e.otherSRS.push(n.textContent)):"WGS84BoundingBox"==n.localName?e.wgs84BoundingBox=a.assembleBoundingBox(n):"DefaultCRS"==n.localName?e.defaultCRS=n.textContent:"OtherCRS"==n.localName?(e.otherCRS=e.otherCRS||[],e.otherCRS.push(n.textContent)):"OutputFormats"==n.localName?e.outputFormats=a.assembleOutputFormats(n):"MetadataURL"==n.localName&&(e.metadataUrl=a.assembleMetadataUrl(n))}return e},a.assembleBoundingBox=function(t){var e={},r=t.getAttribute("crs");r&&(e.crs=r);for(var i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];if("LowerCorner"===o.localName){var a=o.textContent.split(" ");e.lowerCorner=[parseFloat(a[0]),parseFloat(a[1])]}else if("UpperCorner"===o.localName){var s=o.textContent.split(" ");e.upperCorner=[parseFloat(s[0]),parseFloat(s[1])]}}return e},a.assembleOutputFormats=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Format"===n.localName&&e.push(n.textContent)}return e},a.assembleMetadataUrl=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];e.format=n.getAttribute("format"),e.type=n.getAttribute("type")}return outputFormats},a.assembleKeywords=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Keyword"===n.localName&&e.push(n.textContent)}return e},a.assembleConformance=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];if("Constraint"===n.localName){var o;o=a.assembleConstraint(n),o.name=n.getAttribute("name"),e.push(o)}}return e},a.assembleConstraint=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"DefaultValue"===n.localName&&(e.defaultValue=n.textContent)}return e},a.assembleIdCapabilities=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"ResourceIdentifier"===n.localName&&(e.resourceIdentifier=n.getAttribute("name"))}return e},a.assembleScalarCapabilities=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"ComparisonOperators"===n.localName?e.comparisonOperators=a.assembleComparisonOperators(n):"ArithmeticOperators"===n.localName&&(e.arithmeticOperators=a.assembleArithmeticOperators(n))}return e},a.assembleComparisonOperators=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"ComparisonOperator"===n.localName&&e.push(n.textContent)}return e},a.assembleArithmeticOperators=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Functions"===n.localName&&(e.functions=a.assembleArithmeticFunctions(n))}return e},a.assembleArithmeticFunctions=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"FunctionNames"===n.localName&&(e=a.assembleFunctionNames(n))}return e},a.assembleFunctionNames=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];if("FunctionName"===n.localName){var o={name:n.textContent,nArgs:n.getAttribute("nArgs")};e.push(o)}}return e},a.assembleSpatialCapabilities=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"GeometryOperands"===n.localName?e.geometryOperands=a.assembleGeometryOperands(n):"SpatialOperators"===n.localName&&(e.spatialOperators=a.assembleSpatialOperators(n))}return e},a.assembleGeometryOperands=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"GeometryOperand"===n.localName&&e.push(n.getAttribute("name"))}return e},a.assembleSpatialOperators=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"SpatialOperator"===n.localName&&e.push(n.getAttribute("name"))}return e},a.assembleFunctions=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Function"===n.localName&&e.push(a.assembleFunction(n))}return e},a.assembleFunction=function(t){var e={};e.name=t.getAttribute("name");for(var r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Returns"===n.localName?e.returns=n.textContent:"Arguments"===n.localName&&(e.arguments=a.assembleArguments(n))}return e},a.assembleArguments=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Argument"===n.localName&&e.push(a.assembleArgument(n))}return e},a.assembleArgument=function(t){var e={};e.name=t.getAttribute("name");for(var r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Type"===n.localName&&(e.type=n.textContent)}return e},a}),i("../src/worldwind/ogc/wms/WmsLayerCapabilities",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(r,i){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsLayerCapabilities","constructor","Layer element is null or undefined."));this.parent=i,this.layers,this.name,this.title,this["abstract"],this.keywordList,this.identifiers,this.metadataUrls,this.dataUrls,this.featureListUrls,this.assembleLayer(r)};return Object.defineProperties(r.prototype,{capability:{get:function(){for(var t=this;t&&t instanceof r;)t=t.parent;return t}},queryable:{get:function(){return r.replace(this,"_queryable")}},cascaded:{get:function(){return r.replace(this,"_cascaded")}},opaque:{get:function(){return r.replace(this,"_opaque")}},noSubsets:{get:function(){return r.replace(this,"_noSubsets")}},fixedWidth:{get:function(){return r.replace(this,"_fixedWidth")}},fixedHeight:{get:function(){return r.replace(this,"_fixedHeight")}},styles:{get:function(){return r.accumulate(this,"_styles",[])}},crses:{get:function(){return r.accumulate(this,"_crses",[])}},srses:{get:function(){return r.accumulate(this,"_srses",[])}},geographicBoundingBox:{get:function(){return r.replace(this,"_geographicBoundingBox")}},latLonBoundingBox:{get:function(){return r.replace(this,"_latLonBoundingBox")}},boundingBoxes:{get:function(){return r.replace(this,"_boundingBoxes")}},dimensions:{get:function(){for(var t=[],e=this;e&&e instanceof r;)e._dimensions&&e._dimensions.length>0&&e._dimensions.forEach(function(e){var r=e.name,i=!0;t.forEach(function(t){t.name===r&&(i=!1)}),i&&t.push(e)}),e=e.parent;return t.length>0?t:void 0}},extents:{get:function(){for(var t=[],e=this;e&&e instanceof r;)e._extents&&e._extents.length>0&&e._extents.forEach(function(e){var r=e.name,i=!0;t.forEach(function(t){t.name===r&&(i=!1)}),i&&t.push(e)}),e=e.parent;return t.length>0?t:void 0}},attribution:{get:function(){return r.replace(this,"_attribution")}},authorityUrls:{get:function(){return r.accumulate(this,"_authorityUrls",[])}},minScaleDenominator:{get:function(){return r.replace(this,"_minScaleDenominator")}},maxScaleDenominator:{get:function(){return r.replace(this,"_maxScaleDenominator")}},scaleHint:{get:function(){return r.replace(this,"_scaleHint")}}}),r.prototype.style=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsLayerCapabilities","style","Style name is null or undefined."));var i=this.styles;if(!i)return null;for(var n,o=0,a=i.length;a>o;o++)if(n=i[o],n.name===r)return n},r.accumulate=function(t,e,i){for(;t&&t instanceof r;){var n=t[e];if(n)for(var o=0;o<n.length;o++)i.push(n[o]);t=t.parent}return i.length>0?i:null},r.replace=function(t,e){for(;t&&t instanceof r;){var i=t[e];if(i)return i;t=t.parent}},r.prototype.assembleLayer=function(t){var e,i;e=t.getAttribute("queryable"),e&&(this._queryable="1"===e||"true"===e),e=t.getAttribute("opaque"),e&&(this._opaque="1"===e||"true"===e),e=t.getAttribute("noSubsets"),e&&(this._noSubsets="1"===e||"true"===e),e=t.getAttribute("cascaded"),e&&(this._cascaded=parseInt("10")),e=t.getAttribute("fixedWidth"),e&&(this._fixedWidth=parseInt("10")),e=t.getAttribute("fixedHeight"),e&&(this._fixedHeight=parseInt("10"));var n=t.children||t.childNodes;for(i=0;i<n.length;i++){var o=n[i];if("Layer"===o.localName)this.layers||(this.layers=[]),this.layers.push(new r(o,this));else if("Name"===o.localName)this.name=o.textContent;else if("Title"===o.localName)this.title=o.textContent;else if("Abstract"===o.localName)this["abstract"]=o.textContent;else if("KeywordList"===o.localName){this.keywordList=this.keywordList||[];for(var a=o.children||o.childNodes,s=0;s<a.length;s++){var l=a[s];"Keyword"===l.localName&&this.keywordList.push(l.textContent)}}else"Style"===o.localName?(this._styles||(this._styles=[]),this._styles.push(r.assembleStyle(o))):"CRS"===o.localName?(this._crses||(this._crses=[]),this._crses.push(o.textContent)):"SRS"===o.localName?(this._srses||(this._srses=[]),this._srses.push(o.textContent)):"EX_GeographicBoundingBox"===o.localName?this._geographicBoundingBox=r.assembleGeographicBoundingBox(o):"LatLonBoundingBox"===o.localName?this._geographicBoundingBox=r.assembleLatLonBoundingBox(o):"BoundingBox"===o.localName?(this._boundingBoxes||(this._boundingBoxes=[]),this._boundingBoxes.push(r.assembleBoundingBox(o))):"Dimension"===o.localName?(this._dimensions||(this._dimensions=[]),this._dimensions.push(r.assembleDimension(o))):"Extent"===o.localName?(this._extents||(this._extents=[]),this._extents.push(r.assembleDimension(o))):"Attribution"===o.localName?this._attribution=r.assembleAttribution(o):"AuthorityURL"===o.localName?(this._authorityUrls||(this._authorityUrls=[]),this._authorityUrls.push(r.assembleAuthorityUrl(o))):"Identifier"===o.localName?(this.identifiers||(this.identifiers=[]),this.identifiers.push(r.assembleIdentifier(o))):"MetadataURL"===o.localName?(this.metadataUrls||(this.metadataUrls=[]),this.metadataUrls.push(r.assembleMetadataUrl(o))):"DataURL"===o.localName?(this.dataUrls||(this.dataUrls=[]),this.dataUrls.push(r.assembleUrl(o))):"FeatureListURL"===o.localName?(this.featureListUrls||(this.featureListUrls=[]),this.featureListUrls.push(r.assembleUrl(o))):"MinScaleDenominator"===o.localName?this._minScaleDenominator=parseFloat(o.textContent):"MaxScaleDenominator"===o.localName?this._maxScaleDenominator=parseFloat(o.textContent):"ScaleHint"===o.localName&&(this._scaleHint={},this._scaleHint.min=r.getFloatAttribute(o,"min"),this._scaleHint.max=r.getFloatAttribute(o,"max"))}},r.assembleStyle=function(t){for(var e={},i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Name"===o.localName?e.name=o.textContent:"Title"===o.localName?e.title=o.textContent:"Abstract"===o.localName?e["abstract"]=o.textContent:"LegendURL"===o.localName?(e.legendUrls||(e.legendUrls=[]),e.legendUrls.push(r.assembleLegendUrl(o))):"StyleSheetURL"===o.localName?e.styleSheetUrl=r.assembleUrl(o):"StyleURL"===o.localName&&(e.styleUrl=r.assembleUrl(o))}return e},r.assembleGeographicBoundingBox=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"westBoundLongitude"===n.localName?e.westBoundLongitude=parseFloat(n.textContent):"eastBoundLongitude"===n.localName?e.eastBoundLongitude=parseFloat(n.textContent):"southBoundLatitude"===n.localName?e.southBoundLatitude=parseFloat(n.textContent):"northBoundLatitude"===n.localName&&(e.northBoundLatitude=parseFloat(n.textContent))}return e},r.assembleLatLonBoundingBox=function(t){var e={};return e.minx=r.getFloatAttribute(t,"minx"),e.miny=r.getFloatAttribute(t,"miny"),e.maxx=r.getFloatAttribute(t,"maxx"),e.maxy=r.getFloatAttribute(t,"maxy"),e},r.assembleBoundingBox=function(t){var e={};return e.crs=t.getAttribute("CRS"),e.minx=r.getFloatAttribute(t,"minx"),e.miny=r.getFloatAttribute(t,"miny"),e.maxx=r.getFloatAttribute(t,"maxx"),e.maxy=r.getFloatAttribute(t,"maxy"),e.resx=r.getFloatAttribute(t,"resx"),e.resy=r.getFloatAttribute(t,"resy"),e},r.assembleDimension=function(t){var e={};return e.name=t.getAttribute("name"),e.units=t.getAttribute("units"),e.unitSymbol=t.getAttribute("unitSymbol"),e["default"]=t.getAttribute("default"),e.multipleValues=t.getAttribute("multipleValues"),e.multipleValues&&(e.multipleValues="true"===e.multipleValues||"1"===e.multipleValues),e.nearestValue=t.getAttribute("nearestValue"),e.nearestValue&&(e.nearestValue="true"===e.nearestValue||"1"===e.nearestValue),e.current=t.getAttribute("current"),e.current&&(e.current="true"===e.current||"1"===e.current),e.content=t.textContent,e},r.assembleAttribution=function(t){for(var e={},i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Title"===o.localName?e.title=o.textContent:"OnlineResource"===o.localName?e.url=o.getAttribute("xlink:href"):"LogoUrul"===o.localName&&(e.logoUrl=r.assembleLogoUrl(o))}return e},r.assembleAuthorityUrl=function(t){var e={};e.name=t.getAttribute("name");for(var r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"OnlineResource"===n.localName&&(e.url=n.getAttribute("xlink:href"))}return e},r.assembleIdentifier=function(t){var e={};return e.authority=t.getAttribute("authority"),e.content=t.textContent,e},r.assembleMetadataUrl=function(t){var e={};e.type=t.getAttribute("type");for(var r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Format"===n.localName?e.format=n.textContent:"OnlineResource"===n.localName&&(e.url=n.getAttribute("xlink:href"))}return e},r.assembleLegendUrl=function(t){var e={};e.width=r.getIntegerAttribute(t,"width"),e.height=r.getIntegerAttribute(t,"height");for(var i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Format"===o.localName?e.format=o.textContent:"OnlineResource"===o.localName&&(e.url=o.getAttribute("xlink:href"))}return e},r.assembleLogoUrl=function(t){var e={};e.width=r.getIntegerAttribute(t,"width"),e.height=r.getIntegerAttribute(t,"height");for(var i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Format"===o.localName?e.format=o.textContent:"OnlineResource"===o.localName&&(e.url=o.getAttribute("xlink:href"))}return e},r.assembleUrl=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Format"===n.localName?e.format=n.textContent:"OnlineResource"===n.localName&&(e.url=n.getAttribute("xlink:href"))}return e},r.getIntegerAttribute=function(t,e){var r=t.getAttribute(e);return r=r?parseInt(r):void 0},r.getFloatAttribute=function(t,e){var r=t.getAttribute(e);return r=r?parseFloat(r):void 0},r}),i("../src/worldwind/ogc/wms/WmsCapabilities",["../../error/ArgumentError","../../util/Logger","../../ogc/wms/WmsLayerCapabilities"],function(t,e,r){"use strict";var i=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(r)};return i.prototype.getNamedLayers=function(){return this.accumulateNamedLayers(this.capability.layers)},i.prototype.accumulateNamedLayers=function(t,e){var r=e||[];if(!t)return r;for(var i=0,n=t.length;n>i;i++){var o=t[i];o.name&&r.push(o),o.layers&&this.accumulateNamedLayers(o.layers,r)}return r},i.prototype.getNamedLayer=function(r){if(!r||0===r.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsCapabilities","getNamedLayer","No WMS layer name provided."));
for(var i=this.getNamedLayers(),n=0,o=i.length;o>n;n++)if(r===i[n].name)return i[n];return null},i.prototype.assembleDocument=function(t){var e=t.documentElement;this.version=e.getAttribute("version"),this.updateSequence=e.getAttribute("updateSequence");for(var r=e.children||e.childNodes,i=0;i<r.length;i++){var n=r[i];"Service"===n.localName?this.service=this.assembleService(n):"Capability"===n.localName&&(this.capability=this.assembleCapability(n))}},i.prototype.assembleService=function(t){for(var e={capsDoc:this},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Name"===n.localName?e.name=n.textContent:"Title"===n.localName?e.title=n.textContent:"Abstract"===n.localName?e["abstract"]=n.textContent:"KeywordList"===n.localName?e.keywordList=this.assembleKeywordList(n):"OnlineResource"===n.localName?e.url=n.getAttribute("xlink:href"):"Fees"===n.localName?e.fees=n.textContent:"AccessConstraints"===n.localName?e.accessConstraints=n.textContent:"LayerLimit"==n.localName?e.layerLimit=parseInt(n.textContent):"MaxWidth"==n.localName?e.maxWidth=parseInt(n.textContent):"MaxHeight"==n.localName?e.maxHeight=parseInt(n.textContent):"ContactInformation"===n.localName&&(e.contactInformation=this.assembleContactInformation(n))}return e},i.prototype.assembleKeywordList=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Keyword"===n.localName&&e.push(n.textContent)}return e},i.prototype.assembleContactInformation=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"ContactPersonPrimary"===n.localName?e.contactPersonPrimary=this.assembleContactPersonPrimary(n):"ContactPosition"===n.localName?e.contactPosition=n.textContent:"ContactVoiceTelephone"===n.localName?e.contactVoiceTelephone=n.textContent:"ContactFacsimileTelephone"===n.localName?e.contactFacsimileTelephone=n.textContent:"ContactElectronicMailAddress"===n.localName?e.contactElectronicMailAddress=n.textContent:"ContactAddress"===n.localName&&(e.contactAddress=this.assembleContactAddress(n))}return e},i.prototype.assembleContactPersonPrimary=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"ContactPerson"===n.localName?e.contactPerson=n.textContent:"ContactOrganization"===n.localName&&(e.contactOrganization=n.textContent)}return e},i.prototype.assembleContactAddress=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"AddressType"===n.localName?e.addressType=n.textContent:"Address"===n.localName?e.address=n.textContent:"City"===n.localName?e.city=n.textContent:"StateOrProvince"===n.localName?e.stateOrProvince=n.textContent:"PostCode"===n.localName?e.postCode=n.textContent:"Country"===n.localName&&(e.country=n.textContent)}return e},i.prototype.assembleCapability=function(t){for(var e={capsDoc:this},i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Request"===o.localName?e.request=this.assembleRequests(o):"Exception"===o.localName?e.exception=this.assembleException(o):"Layer"===o.localName&&(e.layers=e.layers||[],e.layers.push(new r(o,e)))}return e},i.prototype.assembleRequests=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"GetCapabilities"===n.localName?e.getCapabilities=this.assembleRequest(n):"GetMap"===n.localName?e.getMap=this.assembleRequest(n):"GetFeatureInfo"===n.localName&&(e.getFeatureInfo=this.assembleRequest(n))}return e},i.prototype.assembleRequest=function(t){for(var e={name:t.localName},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];if("Format"===n.localName)e.formats=e.formats||[],e.formats.push(n.textContent);else if("DCPType"===n.localName)for(var o=n.children||n.childNodes,a=0;a<o.length;a++){var s=o[a];if("HTTP"===s.localName)for(var l=s.children||s.childNodes,u=0;u<l.length;u++){var c=l[u];if("Get"===c.localName)for(var h=c.children||c.childNodes,f=0;f<h.length;f++){var d=h[f];"OnlineResource"===d.localName&&(e.getUrl=d.getAttribute("xlink:href"))}}}}return e},i.prototype.assembleException=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Format"===n.localName&&(e.formats=e.formats||[],e.formats.push(n.textContent))}return e},i}),i("../src/worldwind/layer/WmsLayer",["../error/ArgumentError","../geom/Location","../util/Logger","../util/PeriodicTimeSequence","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(t,e,r,i,n,o,a){"use strict";var s=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"WmsLayer","constructor","No configuration specified."));var n=e.service+e.layerNames+e.styleNames;i&&(n+=i),o.call(this,e.sector,e.levelZeroDelta,e.numLevels,e.format,n,e.size,e.size),this.displayName=e.title,this.pickEnabled=!1,this.urlBuilder=new a(e.service,e.layerNames,e.styleNames,e.version,i),e.coordinateSystem&&(this.urlBuilder.crs=e.coordinateSystem),this.timeString=i};return s.prototype=Object.create(o.prototype),s.formLayerConfiguration=function(t){var r={title:t.title,version:t.capability.capsDoc.version},i=t.geographicBoundingBox||t.latLonBoundingBox;i&&i.westBoundLongitude?r.sector=new n(i.southBoundLatitude,i.northBoundLatitude,i.westBoundLongitude,i.eastBoundLongitude):i&&i.minx?r.sector=new n(i.miny,i.maxy,i.minx,i.maxx):r.sector=n.FULL_SPHERE,r.levelZeroDelta=new e(36,36),r.numLevels=19,r.size=256,r.layerNames=t.name;var o=t.capability.request.getMap,a=o.formats;a.indexOf("image/png")>=0?r.format="image/png":a.indexOf("image/jpeg")>=0?r.format="image/jpeg":a.indexOf("image/tiff")>=0?r.format="image/tiff":a.indexOf("image/gif")>=0&&(r.format="image/gif"),r.service=o.getUrl;var l=t.crses;l||(l=t.srses),l&&(l.indexOf("EPSG:4326")>=0||l.indexOf("epsg:4326")>=0?r.coordinateSystem="EPSG:4326":(l.indexOf("CRS84")>=0||l.indexOf("CRS:84")>=0)&&(r.coordinateSystem="CRS:84"));var u=s.parseTimeDimensions(t);return u&&u.length>0&&(r.timeSequences=u),r},s.parseTimeDimensions=function(t){var e=t.extents||t.dimensions,r=null;if(e){r=[];for(var n=0;n<e.length;n++){var o=e[n];if("time"===o.name.toLowerCase()&&(!o.units||"iso8601"===o.units.toLowerCase()))for(var a=o.content.split(","),s=0;s<a.length;s++){var l=a[s],u=l.split("/");1===u.length?r.push(new Date(l)):3===u.length&&r.push(new i(l))}}}return r},s}),i("../src/worldwind/layer/WmsTimeDimensionedLayer",["../error/ArgumentError","../layer/Layer","../util/Logger","../layer/WmsLayer"],function(t,e,r,i){"use strict";var n=function(i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"WmsTimeDimensionedLayer","constructor","No configuration specified."));e.call(this,"WMS Time Dimensioned Layer"),this.config=i,this.displayName=i.title,this.pickEnabled=!1,this.layers={}};return n.prototype=Object.create(e.prototype),n.prototype.doRender=function(t){if(this.time){var e=this.time.toISOString(),r=this.layers[e];r||(r=new i(this.config,e),this.layers[e]=r),r.opacity=this.opacity,r.doRender(t),this.inCurrentFrame=r.inCurrentFrame}},n}),i("../src/worldwind/ogc/wmts/WmtsLayerCapabilities",["../../error/ArgumentError","../../geom/Sector","../../ogc/wmts/OwsDescription","../../util/Logger"],function(t,e,r,i){"use strict";var n=function(e,n){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"WmtsLayerCapabilities","constructor","missingDomElement"));r.call(this,e),this.capabilities=n,this.identifier,this.title,this["abstract"],this.keywords,this.wgs84BoundingBox,this.boundingBox,this.styles,this.formats,this.infoFormat,this.dimension,this.metadata,this.tileMatrixSetLink,this.resourceUrl,this.assembleLayer(e)};return n.prototype=Object.create(r.prototype),n.prototype.getLayerSupportedTileMatrixSets=function(){for(var t=[],e=0,r=this.tileMatrixSetLink.length;r>e;e++)for(var i=this.tileMatrixSetLink[e].tileMatrixSet,n=0,o=this.capabilities.contents.tileMatrixSet.length;o>n;n++){var a=this.capabilities.contents.tileMatrixSet[n].identifier;a===i&&t.push(this.capabilities.contents.tileMatrixSet[n])}return t},n.prototype.assembleLayer=function(t){for(var e=t.children||t.childNodes,r=0;r<e.length;r++){var i=e[r];"Identifier"===i.localName?this.identifier=i.textContent:"WGS84BoundingBox"===i.localName?this.wgs84BoundingBox=n.assembleBoundingBox(i):"BoundingBox"===i.localName?(this.boundingBox=this.boundingBox||[],this.boundingBox.push(n.assembleBoundingBox(i))):"Style"===i.localName?(this.style=this.style||[],this.style.push(n.assembleStyle(i))):"Format"===i.localName?(this.format=this.format||[],this.format.push(i.textContent)):"InfoFormat"===i.localName?(this.infoFormat=this.infoFormat||[],this.infoFormat.push(i.textContent)):"Dimension"===i.localName?(this.dimension=this.dimension||[],this.dimension.push(n.assembleDimension(i))):"Metadata"===i.localName?(this.metadata=this.metadata||[],this.metadata.push(n.assembleMetadata(i))):"ResourceURL"===i.localName?(this.resourceUrl=this.resourceUrl||[],this.resourceUrl.push(n.assembleResourceUrl(i))):"TileMatrixSetLink"===i.localName&&(this.tileMatrixSetLink=this.tileMatrixSetLink||[],this.tileMatrixSetLink.push(n.assembleTileMatrixSetLink(i)))}},n.assembleStyle=function(t){var e=new r(t);e.isDefault=t.getAttribute("isDefault");for(var i=t.children||t.childNodes,o=0;o<i.length;o++){var a=i[o];"Identifier"===a.localName?e.identifier=a.textContent:"LegendURL"===a.localName&&(e.legendUrl=e.legendUrl||[],e.legendUrl.push(n.assembleLegendUrl(a)))}return e},n.assembleBoundingBox=function(t){var r={},i=t.getAttribute("crs");i&&(r.crs=i);for(var n=t.children||t.childNodes,o=0;o<n.length;o++){var a=n[o];if("LowerCorner"===a.localName){var s=a.textContent.split(" ");r.lowerCorner=[parseFloat(s[0]),parseFloat(s[1])]}else if("UpperCorner"===a.localName){var l=a.textContent.split(" ");r.upperCorner=[parseFloat(l[0]),parseFloat(l[1])]}}return"WGS84BoundingBox"===t.localName&&(r.getSector=function(){return new e(r.lowerCorner[1],r.upperCorner[1],r.lowerCorner[0],r.upperCorner[0])}),r},n.assembleDimension=function(t){for(var e=new r(t),i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Identifier"===o.localName?e.identifier=o.textContent:"UOM"===o.localName?e.uom={name:o.getAttribute("name"),reference:o.getAttribute("reference")}:"UnitSymbol"==o.localName?e.unitSymbol=o.textContent:"Default"===o.localName?e["default"]=o.textContent:"Current"===o.localName?e.current="true"===o.textContent:"Value"===o.localName&&(e.value=e.value||[],e.value.push(o.textContent))}return e},n.assembleMetadata=function(t){var e={},r=t.getAttribute("xlink:href");r&&(e.url=r);var i=t.getAttribute("about");r&&(e.about=i);var n=t.getAttribute("xlink:type");n&&(e.type=n);var o=t.getAttribute("xlink:role");o&&(e.role=o);var a=t.getAttribute("xlink:title");a&&(e.title=a);for(var s=t.children||t.childNodes,l=0;l<s.length;l++){var u=s[l];"Metadata"===u.localName&&(e.metadata=WmsLayerCapabilities.assembleMetadata(u))}return e},n.assembleResourceUrl=function(t){var e={};return e.format=t.getAttribute("format"),e.resourceType=t.getAttribute("resourceType"),e.template=t.getAttribute("template"),e},n.assembleLegendUrl=function(t){var e={};return e.format=t.getAttribute("format"),e.minScaleDenominator=t.getAttribute("minScaleDenominator"),e.maxScaleDenominator=t.getAttribute("maxScaleDenominator"),e.href=t.getAttribute("xlink:href"),e.width=t.getAttribute("width"),e.height=t.getAttribute("height"),e},n.assembleTileMatrixSetLink=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var o=r[i];"TileMatrixSet"===o.localName?e.tileMatrixSet=o.textContent:"TileMatrixSetLimits"===o.localName&&(e.tileMatrixSetLimits=n.assembleTileMatrixSetLimits(o))}return e},n.assembleTileMatrixSetLimits=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var o=r[i];"TileMatrixLimits"===o.localName&&(e.tileMatrixLimits=e.tileMatrixLimits||[],e.tileMatrixLimits.push(n.assembleTileMatrixLimits(o)))}return e},n.assembleTileMatrixLimits=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"TileMatrix"===n.localName?e.tileMatrix=n.textContent:"MinTileRow"===n.localName?e.minTileRow=parseInt(n.textContent):"MaxTileRow"===n.localName?e.maxTileRow=parseInt(n.textContent):"MinTileCol"===n.localName?e.minTileCol=parseInt(n.textContent):"maxTileCol"===n.localName&&(e.maxTileCol=parseInt(n.textContent))}return e},n}),i("../src/worldwind/ogc/wmts/WmtsCapabilities",["../../error/ArgumentError","../../util/Logger","../../ogc/wmts/OwsDescription","../../ogc/wmts/OwsLanguageString","../../ogc/wmts/OwsOperationsMetadata","../../ogc/wmts/OwsServiceIdentification","../../ogc/wmts/OwsServiceProvider","../../ogc/wms/WmsCapabilities","../../ogc/wmts/WmtsLayerCapabilities"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmtsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(r)};return u.prototype.getLayers=function(){return this.contents.layer},u.prototype.getLayer=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmtsCapabilities","getLayer","empty identifier"));for(var i=0,n=this.contents.layer.length;n>i;i++){var o=this.contents.layer[i];if(o.identifier===r)return o}return null},u.prototype.assembleDocument=function(t){var e=t.documentElement;this.version=e.getAttribute("version"),this.updateSequence=e.getAttribute("updateSequence");for(var r=e.children||e.childNodes,i=0;i<r.length;i++){var s=r[i];"ServiceIdentification"===s.localName?this.serviceIdentification=new o(s):"ServiceProvider"===s.localName?this.serviceProvider=new a(s):"OperationsMetadata"===s.localName?this.operationsMetadata=new n(s):"Contents"===s.localName?this.contents=this.assembleContents(s):"Themes"===s.localName?this.themes=u.assembleThemes(s):"ServiceMetadataURL"===s.localName&&(this.serviceMetadataUrls=this.serviceMetadataUrls||[],this.serviceMetadataUrls.push(u.assembleServiceMetadataURL(s)))}},u.prototype.assembleContents=function(t){for(var r={},i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];if("Layer"===o.localName){r.layer=r.layer||[];try{r.layer.push(new l(o,this))}catch(a){e.logMessage(e.LEVEL_SEVERE,"WmtsCapabilities","constructor","Exception reading WMTS layer description: "+a.message)}}else if("TileMatrixSet"===o.localName){r.tileMatrixSet=r.tileMatrixSet||[];try{r.tileMatrixSet.push(u.assembleTileMatrixSet(o))}catch(a){e.logMessage(e.LEVEL_SEVERE,"WmtsCapabilities","constructor","Exception reading WMTS tile matrix set description: "+a.message)}}}return r},u.assembleTileMatrixSet=function(t){for(var e=new r(t),i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Identifier"===o.localName?e.identifier=o.textContent:"SupportedCRS"===o.localName?e.supportedCRS=o.textContent:"WellKnownScaleSet"===o.localName?e.wellKnownScaleSet=o.textContent:"BoundingBox"===o.localName?e.boundingBox=l.assembleBoundingBox(o):"TileMatrix"===o.localName&&(e.tileMatrix=e.tileMatrix||[],e.tileMatrix.push(u.assembleTileMatrix(o)))}u.sortTileMatrices(e);for(var a=0;a<e.tileMatrix.length;a++)e.tileMatrix[a].levelNumber=a;return e},u.assembleTileMatrix=function(t){for(var e=new r(t),i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];if("Identifier"===o.localName)e.identifier=o.textContent;else if("ScaleDenominator"===o.localName)e.scaleDenominator=parseFloat(o.textContent);else if("TileWidth"===o.localName)e.tileWidth=parseFloat(o.textContent);else if("TileHeight"===o.localName)e.tileHeight=parseFloat(o.textContent);else if("MatrixWidth"===o.localName)e.matrixWidth=parseFloat(o.textContent);else if("MatrixHeight"===o.localName)e.matrixHeight=parseFloat(o.textContent);else if("TopLeftCorner"===o.localName){var a=o.textContent.split(" ");e.topLeftCorner=[parseFloat(a[0]),parseFloat(a[1])]}}return e},u.assembleThemes=function(t){for(var e,r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Theme"===n.localName&&(e=e||[],e.push(u.assembleTheme(n)))}return e},u.assembleTheme=function(t){for(var e=new r(t),i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Identifier"===o.localName?e.identifier=o.textContent:"LayerRef"===o.localName?(e.layerRef=e.layerRef||[],e.layerRef.push(o.textContent)):"Theme"===o.localName&&(e.themes=e.themes||[],e.themes.push(u.assembleTheme(o)))}return e},u.assembleServiceMetadataURL=function(t){var e={},r=t.getAttribute("xlink:href");return r&&(e.url=r),e},u.sortTileMatrices=function(t){t.tileMatrix.sort(function(t,e){return e.scaleDenominator-t.scaleDenominator})},u.prototype.getGetTileKvpAddress=function(){for(var t=0;t<this.operationsMetadata.operation.length;t++){var e=this.operationsMetadata.operation[t];if("GetTile"===e.name)return e.dcp[0].getMethods[0].url}return null},u}),i("../src/worldwind/layer/WmtsLayerTile",["../geom/Angle","../error/ArgumentError","../geom/BoundingBox","../util/Logger","../geom/Vec3","../util/WWUtil"],function(t,e,r,i,n,o){"use strict";var a=function(e,r,i,n,o){this.sector=e,this.tileMatrix=r,this.row=i,this.column=n,this.imagePath=o,this.texelSize=e.deltaLatitude()*t.DEGREES_TO_RADIANS/r.tileHeight,this.tileKey=r.levelNumber.toString()+"."+i.toString()+"."+n.toString(),this.gpuCacheKey=o};return a.prototype.isEqual=function(t){return t&&t.tileKey?this.tileKey==t.tileKey:!1},a.prototype.distanceTo=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Tile","distanceTo","missingVector"));for(var r,n,o,a=t[0],s=t[1],l=t[2],u=this.samplePoints,c=Number.POSITIVE_INFINITY,h=0,f=u.length;f>h;h+=3)r=a-u[h],n=s-u[h+1],o=l-u[h+2],c=Math.min(c,r*r+n*n+o*o);return Math.sqrt(c)},a.prototype.subdivide=function(t,r){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WmtsLayerTile","subdivide","The specified tile matrix is null or undefined."));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WmtsLayerTile","subdivide","The specified tile factory is null or undefined."));for(var n,o,a=[],s=t.matrixHeight/this.tileMatrix.matrixHeight,l=t.matrixWidth/this.tileMatrix.matrixWidth,u=0;s>u;u++)for(var c=0;l>c;c++)n=s*this.row+u,o=l*this.column+c,a.push(r.createTile(t,n,o));return a},a.prototype.subdivideToCache=function(t,r,n){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile matrix is null or undefined."));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile factory is null or undefined."));var o=n?n.entryForKey(this.tileKey):null;return o||(o=this.subdivide(t,r),o&&n&&n.putEntry(this.tileKey,o,o.length)),o},a.prototype.mustSubdivide=function(t,e){var r=t.globe.equatorialRadius*this.texelSize,i=this.distanceTo(t.navigatorState.eyePoint),n=t.navigatorState.pixelSizeAtDistance(i);return r>Math.max(e*n,.5)},a.prototype.update=function(t){var e=t.globe.elevationTimestamp(),r=t.verticalExaggeration,i=t.globeStateKey;(this.updateTimestamp!=e||this.updateVerticalExaggeration!=r||this.updateGlobeStateKey!=i)&&(this.doUpdate(t),t.frameStatistics.incrementTileUpdateCount(1),this.updateTimestamp=e,this.updateVerticalExaggeration=r,this.updateGlobeStateKey=i)},a.prototype.doUpdate=function(t){var e=t.globe,i=t.verticalExaggeration,a=e.minAndMaxElevationsForSector(this.sector),s=a?a[0]*i:0,l=a?a[1]*i:0;s==l&&(s=l+10),this.extent||(this.extent=new r),this.extent.setToSector(this.sector,e,s,l),this.samplePoints||(this.sampleElevations=new Float64Array(9),this.samplePoints=new Float64Array(3*this.sampleElevations.length)),o.fillArray(this.sampleElevations,.5*(s+l)),e.computePointsForGrid(this.sector,3,3,this.sampleElevations,n.ZERO,this.samplePoints),this.referencePoint||(this.referencePoint=new n(0,0,0)),e.computePointFromPosition(this.sector.centroidLatitude(),this.sector.centroidLongitude(),0,this.referencePoint)},a.prototype.bind=function(t){var e=t.gpuResourceCache.resourceForKey(this.gpuCacheKey);return e&&e.bind(t)?!0:this.fallbackTile?this.fallbackTile.bind(t):!1},a.prototype.applyInternalTransform=function(t,e){},a}),i("../src/worldwind/layer/WmtsLayer",["../util/AbsentResourceList","../error/ArgumentError","../util/Logger","../geom/Sector","../layer/Layer","../cache/MemoryCache","../render/Texture","../util/WmsUrlBuilder","../layer/WmtsLayerTile","../util/WWMath","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(a,s){if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","No layer configuration specified."));if(n.call(this,"WMTS Layer"),this.layerIdentifier=a.identifier,this.styleIdentifier=a.style,this.timeString=s,this.imageFormat=a.format,this.resourceUrl=a.resourceUrl,this.serviceUrl=a.service,this.tileMatrixSet=a.tileMatrixSet,a.wgs84BoundingBox||a.boundingBox){if(a.wgs84BoundingBox)this.sector=a.wgs84BoundingBox.getSector();else if(this.tileMatrixSet.boundingBox&&h.isEpsg4326Crs(this.tileMatrixSet.boundingBox.crs))this.sector=new i(this.tileMatrixSet.boundingBox.lowerCorner[1],this.tileMatrixSet.boundingBox.upperCorner[1],this.tileMatrixSet.boundingBox.lowerCorner[0],this.tileMatrixSet.boundingBox.upperCorner[0]);else if(h.isEpsg4326Crs(this.tileMatrixSet.supportedCRS))throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","No EPSG:4326 bounding box was specified in the layer or tile matrix set capabilities."))}else{if(!this.tileMatrixSet.boundingBox)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","No bounding box was specified in the layer or tile matrix set capabilities."));this.sector=new i(a.tileMatrixSet.boundingBox.lowerCorner[1],a.tileMatrixSet.boundingBox.upperCorner[1],a.tileMatrixSet.boundingBox.lowerCorner[0],a.tileMatrixSet.boundingBox.upperCorner[0])}var l,u=a.tileMatrixSet.tileMatrix,c=[],f=[];u.forEach(function(t){c.push(t.matrixWidth),f.push(t.matrixHeight)}),0!==h.checkTileSubdivision(c)?(l=h.checkTileSubdivision(c),r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","Tile subdivision not supported for layer : "+a.identifier+". Display until level "+(l-1)),u.splice(l)):0!==h.checkTileSubdivision(f)&&(l=h.checkTileSubdivision(f),r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","Tile subdivision not supported for layer : "+a.identifier+". Display until level "+(l-1)),u.splice(l)),this.cachePath=(this.resourceUrl||this.serviceUrl)+this.layerIdentifier+this.styleIdentifier+this.tileMatrixSet.identifier,s&&(this.cachePath=this.cachePath+s),this.displayName=a.title,this.currentTiles=[],this.currentTilesInvalid=!0,this.tileCache=new o(500,400),this.currentRetrievals=[],this.absentResourceList=new t(3,5e4),this.pickEnabled=!1,this.detailControl=1.75};return h.checkTileSubdivision=function(t){if(t.length<1)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","checkTileSubdivision","Empty dimension array"));for(var i,n=0,o=0;++o<t.length&&0==n;){var a=t[o]/t[o-1];t[o]%t[o-1]!==0?n=o:i&&i!==a&&(n=o),i=a}return n},h.createTileMatrixSet=function(t){if(!t.matrixSet)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No matrixSet provided."));if(!t.projection)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No projection provided."));if(!t.extent||4!=t.extent.length)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No extent provided."));var i={lowerCorner:[t.extent[0],t.extent[1]],upperCorner:[t.extent[2],t.extent[3]]};if(!t.resolutions)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No resolutions provided."));if(!t.tileSize)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No tile size provided."));if(!t.topLeftCorner||2!=t.topLeftCorner.length)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No extent provided."));if(void 0===t.prefix)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","Prefix not provided."));if(!(h.isEpsg4326Crs(t.projection)||h.isOGCCrs84(t.projection)||h.isEpsg3857Crs(t.projection)))throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","Projection provided not supported."));for(var n,o=[],a=0;a<t.resolutions.length;a++){h.isEpsg4326Crs(t.projection)||h.isOGCCrs84(t.projection)?n=6378137*t.resolutions[a]*2*Math.PI/360/28e-5:h.isEpsg3857Crs(t.projection)&&(n=t.resolutions[a]/28e-5);var s=t.tileSize*t.resolutions[a],l=t.tileSize*t.resolutions[a],u=Math.ceil((t.extent[2]-t.extent[0]-.01*s)/s),c=Math.ceil((t.extent[3]-t.extent[1]-.01*l)/l),f={identifier:t.prefix?t.matrixSet+":"+a:a,levelNumber:a,matrixHeight:c,matrixWidth:u,tileHeight:t.tileSize,tileWidth:t.tileSize,topLeftCorner:t.topLeftCorner,scaleDenominator:n};o.push(f)}return{identifier:t.matrixSet,supportedCRS:t.projection,boundingBox:i,tileMatrix:o}},h.formLayerConfiguration=function(t,i,n,o){var a={};if(a.identifier=t.identifier,o){for(var l=!1,u=0;u<t.format.length;u++)if(t.format[u]===o){l=!0,a.format=t.format[u];break}l||(r.logMessage(r.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","The specified image format is not available. Another one will be used."),a.format=null)}if(a.format||(t.format.indexOf("image/png")>=0?a.format="image/png":t.format.indexOf("image/jpeg")>=0?a.format="image/jpeg":t.format.indexOf("image/tiff")>=0?a.format="image/tiff":t.format.indexOf("image/gif")>=0?a.format="image/gif":a.format=t.format[0]),!a.format)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","formLayerConfiguration","Layer does not provide a supported image format."));if(t.resourceUrl&&t.resourceUrl.length>=1){for(var u=0;u<t.resourceUrl.length;u++)if(a.format===t.resourceUrl[u].format){a.resourceUrl=t.resourceUrl[u].template;break}}else a.service=t.capabilities.getGetTileKvpAddress(),a.service&&(a.service=s.fixGetMapString(a.service));if(!a.resourceUrl&&!a.service)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","formLayerConfiguration","No resource URL or KVP GetTile service URL specified in WMTS capabilities."));if(i){for(var c=!1,u=0;u<t.style.length;u++)if(t.style[u].identifier===i){c=!0,a.style=t.style[u].identifier;break}c||(r.logMessage(r.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","The specified style identifier is not available. The server's default style will be used."),a.style=null)}if(!a.style)for(u=0;u<t.style.length;u++)if(t.style[u].isDefault){a.style=t.style[u].identifier;break}a.styleIdentifier||r.logMessage(r.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","No default style available. A style will not be specified in tile requests.");var f=t.getLayerSupportedTileMatrixSets();if(n){for(var d=!1,u=0,p=f.length;p>u;u++)if(f[u].identifier===n){d=!0,a.tileMatrixSet=f[u];break}d||(r.logMessage(r.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","The specified tileMatrixSet is not available. Another one will be used."),a.tileMatrixSet=null)}if(!a.tileMatrixSet){for(var m,g=null,y=null,v=null,u=0,p=f.length;p>u;u++)m=f[u],h.isEpsg4326Crs(m.supportedCRS)?g=g||m:h.isEpsg3857Crs(m.supportedCRS)?y=y||m:h.isOGCCrs84(m.supportedCRS)&&(v=v||m);a.tileMatrixSet=g||y||v}if(!a.tileMatrixSet)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","formLayerConfiguration","No supported Tile Matrix Set could be found."));return a.boundingBox=t.boundingBox,a.wgs84BoundingBox=t.wgs84BoundingBox,t.titles.length>0?a.title=t.titles[0].value:a.title=t.identifier,a},h.prototype=Object.create(n.prototype),h.prototype.doRender=function(t){t.terrain&&(!this.currentTilesInvalid&&this.lasTtMVP&&t.navigatorState.modelviewProjection.equals(this.lasTtMVP)&&t.globeStateKey==this.lastGlobeStateKey||(this.currentTilesInvalid=!1,this.assembleTiles(t)),this.lasTtMVP=t.navigatorState.modelviewProjection,this.lastGlobeStateKey=t.globeStateKey,this.currentTiles.length>0&&(t.surfaceTileRenderer.renderTiles(t,this.currentTiles,this.opacity),t.frameStatistics.incrementImageTileCount(this.currentTiles.length),this.inCurrentFrame=!0))},h.prototype.isLayerInView=function(t){return t.terrain&&t.terrain.sector&&t.terrain.sector.intersects(this.sector)},h.prototype.isTileVisible=function(t,e){return t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits)?!1:e.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)},h.prototype.assembleTiles=function(t){this.currentTiles=[],this.topLevelTiles&&0!==this.topLevelTiles.length||this.createTopLevelTiles(t);for(var e=0,r=this.topLevelTiles.length;r>e;e++){var i=this.topLevelTiles[e];i.update(t),this.currentAncestorTile=null,this.isTileVisible(t,i)&&this.addTileOrDescendants(t,i)}},h.prototype.addTileOrDescendants=function(t,e){if(e.column>=e.tileMatrix.matrixWidth&&(e.column=e.column-e.tileMatrix.matrixWidth),e.column<0&&(e.column=e.column+e.tileMatrix.matrixWidth),this.tileMeetsRenderingCriteria(t,e))return void this.addTile(t,e);var r=null;try{(this.isTileTextureInMemory(t,e)||0===e.tileMatrix.levelNumber)&&(r=this.currentAncestorTile,this.currentAncestorTile=e);for(var i=this.tileMatrixSet.tileMatrix[e.tileMatrix.levelNumber+1],n=e.subdivideToCache(i,this,this.tileCache),o=0,a=n.length;a>o;o++){var s=n[o];s.update(t),this.sector.intersects(s.sector)&&this.isTileVisible(t,s)&&this.addTileOrDescendants(t,s)}}finally{r&&(this.currentAncestorTile=r)}},h.prototype.addTile=function(t,e){e.fallbackTile=null;var r=t.gpuResourceCache.resourceForKey(e.imagePath);return r?(this.currentTiles.push(e),void(this.expiration&&this.isTextureExpired(r)&&this.retrieveTileImage(t,e))):(this.retrieveTileImage(t,e),void(this.currentAncestorTile&&this.isTileTextureInMemory(t,this.currentAncestorTile)&&this.currentTiles.push(this.currentAncestorTile)))},h.prototype.isTextureExpired=function(t){return this.expiration&&t.creationTime.getTime()<=this.expiration.getTime()},h.prototype.isTileTextureInMemory=function(t,e){return t.gpuResourceCache.containsResource(e.imagePath)},h.prototype.tileMeetsRenderingCriteria=function(t,e){var r=this.detailControl;return(e.sector.minLatitude>=75||e.sector.maxLatitude<=-75)&&(r*=1.2),e.tileMatrix.levelNumber===this.tileMatrixSet.tileMatrix.length-1||!e.mustSubdivide(t,r)},h.prototype.retrieveTileImage=function(t,e){if(this.currentRetrievals.indexOf(e.imagePath)<0){if(this.absentResourceList.isResourceAbsent(e.imagePath))return;var i=this.resourceUrlForTile(e,this.imageFormat),n=new Image,o=e.imagePath,a=t.gpuResourceCache,s=t.currentGlContext.canvas,l=this;if(!i)return void(this.currentTilesInvalid=!0);n.onload=function(){r.log(r.LEVEL_INFO,"Image retrieval succeeded: "+i);var u=l.createTexture(t,e,n);if(l.removeFromCurrentRetrievals(o),u){a.putResource(o,u,u.size),l.currentTilesInvalid=!0,l.absentResourceList.unmarkResourceAbsent(o);var c=document.createEvent("Event");c.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),s.dispatchEvent(c)}},n.onerror=function(){l.removeFromCurrentRetrievals(o),l.absentResourceList.markResourceAbsent(o),r.log(r.LEVEL_WARNING,"Image retrieval failed: "+i)},this.currentRetrievals.push(o),n.crossOrigin="anonymous",n.src=i}},h.prototype.resourceUrlForTile=function(t,e){var r;return this.resourceUrl?(r=this.resourceUrl.replace("{Style}",this.styleIdentifier).replace("{TileMatrixSet}",this.tileMatrixSet.identifier).replace("{TileMatrix}",t.tileMatrix.identifier).replace("{TileCol}",t.column).replace("{TileRow}",t.row),this.timeString&&(r=r.replace("{Time}",this.timeString))):(r=this.serviceUrl+"service=WMTS&request=GetTile&version=1.0.0",r+="&Layer="+this.layerIdentifier,this.styleIdentifier&&(r+="&Style="+this.styleIdentifier),r+="&Format="+e,this.timeString&&(r+="&Time="+this.timeString),r+="&TileMatrixSet="+this.tileMatrixSet.identifier,r+="&TileMatrix="+t.tileMatrix.identifier,r+="&TileRow="+t.row,r+="&TileCol="+t.column),r},h.prototype.removeFromCurrentRetrievals=function(t){var e=this.currentRetrievals.indexOf(t);e>-1&&this.currentRetrievals.splice(e,1)},h.prototype.createTopLevelTiles=function(t){var e=this.tileMatrixSet.tileMatrix[0];this.topLevelTiles=[];for(var r=0;r<e.matrixHeight;r++)for(var i=0;i<e.matrixWidth;i++)this.topLevelTiles.push(this.createTile(e,r,i))},h.prototype.createTile=function(t,e,r){return h.isEpsg4326Crs(this.tileMatrixSet.supportedCRS)?this.createTile4326(t,e,r):h.isEpsg3857Crs(this.tileMatrixSet.supportedCRS)?this.createTile3857(t,e,r):h.isOGCCrs84(this.tileMatrixSet.supportedCRS)?this.createTileCrs84(t,e,r):void 0},h.prototype.createTileCrs84=function(t,e,r){var n=this.sector.deltaLatitude()/t.matrixHeight,o=this.sector.deltaLongitude()/t.matrixWidth,a=t.topLeftCorner[1]-e*n,s=a-n,l=t.topLeftCorner[0]+o*r,u=l+o,c=new i(s,a,l,u);
return this.makeTile(c,t,e,r)},h.prototype.createTile4326=function(t,e,r){var n=this.sector.deltaLatitude()/t.matrixHeight,o=this.sector.deltaLongitude()/t.matrixWidth,a=t.topLeftCorner[0]-e*n,s=a-n,l=t.topLeftCorner[1]+o*r,u=l+o,c=new i(s,a,l,u);return this.makeTile(c,t,e,r)},h.prototype.createTile3857=function(t,e,r){t.mapWidth||this.computeTileMatrixValues3857(t);var n,o,a,s,l,c,h=u.clamp(r*t.tileWidth-.5,0,t.mapWidth),f=u.clamp(e*t.tileHeight-.5,0,t.mapHeight),d=u.clamp(h+t.tileWidth+.5,0,t.mapWidth),p=u.clamp(f+t.tileHeight+.5,0,t.mapHeight);n=h/t.mapWidth,o=p/t.mapHeight,s=t.topLeftCorner[0]+n*t.tileMatrixDeltaX,a=t.topLeftCorner[1]-o*t.tileMatrixDeltaY;var m=u.epsg3857ToEpsg4326(s,a);n=d/t.mapWidth,o=f/t.mapHeight,c=t.topLeftCorner[0]+n*t.tileMatrixDeltaX,l=t.topLeftCorner[1]-o*t.tileMatrixDeltaY;var g=u.epsg3857ToEpsg4326(c,l),y=new i(m[0],g[0],m[1],g[1]);return this.makeTile(y,t,e,r)},h.prototype.computeTileMatrixValues3857=function(t){var e=28e-5*t.scaleDenominator,r=t.tileWidth*e,i=t.tileHeight*e,n=t.topLeftCorner[0]+r*t.matrixWidth,o=t.topLeftCorner[1]-i*t.matrixHeight,a=[n,o],s=t.topLeftCorner;t.tileMatrixDeltaX=a[0]-s[0],t.tileMatrixDeltaY=s[1]-a[1],t.mapWidth=t.tileWidth*t.matrixWidth,t.mapHeight=t.tileHeight*t.matrixHeight},h.prototype.makeTile=function(t,e,r,i){var n=this.cachePath+"-layer/"+e.identifier+"/"+r+"/"+i+"."+c.suffixForMimeType(this.imageFormat);return new l(t,e,r,i,n)},h.prototype.createTexture=function(t,e,r){return h.isEpsg4326Crs(this.tileMatrixSet.supportedCRS)?new a(t.currentGlContext,r):h.isEpsg3857Crs(this.tileMatrixSet.supportedCRS)?this.createTexture3857(t,e,r):h.isOGCCrs84(this.tileMatrixSet.supportedCRS)?new a(t.currentGlContext,r):void 0},h.prototype.createTexture3857=function(t,e,r){this.destCanvas||(this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d"));var i,n,o,s,l,c,h,f,d=t.canvas2D,p=t.ctx2D,m=this.destCanvas,g=this.destContext,y=g.createImageData(r.width,r.height),v=e.sector,E=u.gudermannianInverse(v.minLatitude),w=u.gudermannianInverse(v.maxLatitude);d.width=r.width,d.height=r.height,m.width=r.width,m.height=r.height,p.drawImage(r,0,0,r.width,r.height),i=p.getImageData(0,0,r.width,r.height);for(var b=0;1>b;b++)for(var x=0;x<r.height;x++){h=1-x/(r.height-1),n=h*v.deltaLatitude()+v.minLatitude,o=u.gudermannianInverse(n),f=1-(o-E)/(w-E),f=u.clamp(f,0,1),s=Math.floor(f*(r.height-1));for(var _=0;_<r.width;_++)l=4*(_+s*r.width),c=4*(_+x*r.width),y.data[c]=i.data[l],y.data[c+1]=i.data[l+1],y.data[c+2]=i.data[l+2],y.data[c+3]=i.data[l+3]}return g.putImageData(y,0,0),new a(t.currentGlContext,m)},h.isEpsg4326Crs=function(t){return t.indexOf("EPSG")>=0&&t.indexOf("4326")>=0},h.isEpsg3857Crs=function(t){return t.indexOf("EPSG")>=0&&(t.indexOf("3857")>=0||t.indexOf("900913")>=0)},h.isOGCCrs84=function(t){return t.indexOf("OGC")>=0&&t.indexOf("CRS84")>=0},h}),i("../src/worldwind/WorldWindow",["./error/ArgumentError","./navigate/Camera","./render/DrawContext","./globe/EarthElevationModel","./util/FrameStatistics","./globe/Globe","./globe/Globe2D","./util/GoToAnimator","./cache/GpuResourceCache","./util/Logger","./navigate/Navigator","./navigate/NavigatorState","./pick/PickedObjectList","./geom/Rectangle","./geom/Sector","./shapes/SurfaceShape","./shapes/SurfaceShapeTileBuilder","./globe/Terrain","./geom/Vec2","./navigate/WorldWindowController","./util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m,g,y,v,E,w){"use strict";var b=function(a,l,h){function f(t){v.handleContextLost(t)}function p(t){v.handleContextRestored(t)}function m(t){v.handleRedrawEvent(t)}if(!window.WebGLRenderingContext)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","constructor","The specified canvas does not support WebGL."));var g=document.getElementById(a);if(!g)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","constructor","The specified canvas name is not in the document."));var y=this.createContext(g);this.drawContext=new r(y),this.eventListeners={},this.redrawRequested=!0,this.redrawRequestId=null,this.scratchCamera=new e,this.canvas=g,this.depthBits=y.getParameter(y.DEPTH_BITS),this.viewport=new d(0,0,y.drawingBufferWidth,y.drawingBufferHeight),this.globe=new o(l||new i),this.layers=[],this.navigator=new c(this),this.controller=h&&new h(this)||new E(this),this.verticalExaggeration=1,this.deepPicking=!1,this.subsurfaceMode=!1,this.surfaceOpacity=1,this.frameStatistics=new n,this.fieldOfView=45,this.goToAnimator=new s(this),this._redrawCallbacks=[],this._orderedRenderingFilters=[function(t){v.declutter(t,1)},function(t){v.declutter(t,2)}],this.pixelScale=1;var v=this;this.canvas.addEventListener("webglcontextlost",f,!1),this.canvas.addEventListener("webglcontextrestored",p,!1),this.canvas.addEventListener(WorldWind.REDRAW_EVENT_TYPE,m,!1),window.addEventListener(WorldWind.REDRAW_EVENT_TYPE,m,!1),this.animationFrameLoop()};return Object.defineProperties(b.prototype,{orderedRenderingFilters:{get:function(){return this._orderedRenderingFilters}},redrawCallbacks:{get:function(){return this._redrawCallbacks}}}),b.prototype.canvasCoordinates=function(t,e){var r=this.canvas.getBoundingClientRect(),i=t-(r.left+this.canvas.clientLeft),n=e-(r.top+this.canvas.clientTop);return new v(i,n)},b.prototype.addEventListener=function(e,r){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","addEventListener","missingType"));if(!r)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","addEventListener","missingListener"));var i=this,n=this.eventListeners[e];n||(n={listeners:[],callback:function(t){t.worldWindow=i;for(var e=0,r=n.listeners.length;r>e;e++)n.listeners[e](t)}},this.eventListeners[e]=n);var o=n.listeners.indexOf(r);-1==o&&(n.listeners.splice(0,0,r),1==n.listeners.length&&this.canvas.addEventListener(e,n.callback,!1))},b.prototype.removeEventListener=function(e,r){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingType"));if(!r)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingListener"));var i=this.eventListeners[e];if(i){var n=i.listeners.indexOf(r);-1!=n&&(i.listeners.splice(n,1),0==i.listeners.length&&this.canvas.removeEventListener(e,i.callback,!1))}},b.prototype.redraw=function(){this.redrawRequested=!0},b.prototype.pick=function(e){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","pick","missingPoint"));return this.drawContext.currentGlContext.isContextLost()?new f:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.pickPoint=e,this.drawFrame(),this.drawContext.objectsAtPickPoint)},b.prototype.pickTerrain=function(e){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","pickTerrain","missingPoint"));return this.drawContext.currentGlContext.isContextLost()?new f:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.pickTerrainOnly=!0,this.drawContext.pickPoint=e,this.drawFrame(),this.drawContext.objectsAtPickPoint)},b.prototype.pickShapesInRegion=function(e){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","pickShapesInRegion","missingRectangle"));return this.drawContext.currentGlContext.isContextLost()?new f:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.regionPicking=!0,this.drawContext.pickRectangle=new d(e.x,this.canvas.height-e.y,e.width,e.height),this.drawFrame(),this.drawContext.objectsAtPickPoint)},b.prototype.createContext=function(t){var e={antialias:!1,stencil:!0},r=t.getContext("webgl",e);r||(r=t.getContext("experimental-webgl",e));var i=r.getContextAttributes();return this.hasStencilBuffer=i.stencil,r},b.prototype.handleContextLost=function(t){u.log(u.LEVEL_INFO,"WebGL context event: "+t.statusMessage),t.preventDefault(),this.drawContext.contextLost(),window.cancelAnimationFrame(this.redrawRequestId)},b.prototype.handleContextRestored=function(t){u.log(u.LEVEL_INFO,"WebGL context event: "+t.statusMessage),this.drawContext.contextRestored(),this.redraw(),this.animationFrameLoop()},b.prototype.handleRedrawEvent=function(t){this.redraw()},b.prototype.animationFrameLoop=function(){function t(){e.animationFrameLoop()}this.redrawIfNeeded();var e=this;this.redrawRequestId=window.requestAnimationFrame(t)},b.prototype.redrawIfNeeded=function(){if(this.resize(),this.redrawRequested)try{this.redrawRequested=!1,this.drawContext.previousRedrawTimestamp=this.drawContext.timestamp,this.callRedrawCallbacks(WorldWind.BEFORE_REDRAW),this.resetDrawContext(),this.drawFrame()}catch(t){u.logMessage(u.LEVEL_SEVERE,"WorldWindow","redrawIfNeeded","Exception occurred during redrawing.\n"+t.toString())}finally{this.callRedrawCallbacks(WorldWind.AFTER_REDRAW),this.drawContext.redrawRequested&&(this.redrawRequested=!0)}},b.prototype.resize=function(){var t=this.drawContext.currentGlContext,e=t.canvas.clientWidth*this.pixelScale,r=t.canvas.clientHeight*this.pixelScale;(t.canvas.width!=e||t.canvas.height!=r)&&(t.canvas.width=e,t.canvas.height=r,t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),this.viewport=new d(0,0,t.drawingBufferWidth,t.drawingBufferHeight),this.redrawRequested=!0)},b.prototype.resetDrawContext=function(){this.globe.offset=0;var t=this.drawContext;t.reset(),t.globe=this.globe,t.layers=this.layers,t.navigatorState=this.navigator.currentState(this.globe),t.verticalExaggeration=this.verticalExaggeration,t.surfaceOpacity=this.surfaceOpacity,t.deepPicking=this.deepPicking,t.frameStatistics=this.frameStatistics,t.pixelScale=this.pixelScale,t.update()},b.prototype.drawFrame=function(){try{this.drawContext.frameStatistics.beginFrame(),this.beginFrame(),this.drawContext.globe.is2D()&&this.drawContext.globe.continuous?this.do2DContiguousRepaint():this.doNormalRepaint()}finally{this.endFrame(),this.drawContext.frameStatistics.endFrame()}},b.prototype.doNormalRepaint=function(){this.createTerrain(),this.clearFrame(),this.deferOrderedRendering=!1,this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.doPick(),this.resolvePick()):(this.doDraw(),this.subsurfaceMode&&this.hasStencilBuffer&&(this.redrawSurface(),this.drawScreenRenderables()))},b.prototype.do2DContiguousRepaint=function(){this.createTerrain2DContiguous(),this.clearFrame(),this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.pick2DContiguous(),this.resolvePick()):this.draw2DContiguous()},b.prototype.resolvePick=function(){this.drawContext.pickTerrainOnly?this.resolveTerrainPick():this.drawContext.regionPicking?this.resolveRegionPick():this.resolveTopPick()},b.prototype.beginFrame=function(){var t=this.drawContext.currentGlContext;t.enable(t.BLEND),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.depthFunc(t.LEQUAL),this.drawContext.pickingMode&&(this.drawContext.makePickFramebuffer(),this.drawContext.bindFramebuffer(this.drawContext.pickFramebuffer))},b.prototype.endFrame=function(){var t=this.drawContext.currentGlContext;t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.blendFunc(t.ONE,t.ZERO),t.depthFunc(t.LESS),t.clearColor(0,0,0,1),this.drawContext.bindFramebuffer(null),this.drawContext.bindProgram(null)},b.prototype.clearFrame=function(){var t=this.drawContext,e=t.currentGlContext;e.clearColor(t.clearColor.red,t.clearColor.green,t.clearColor.blue,t.clearColor.alpha),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)},b.prototype.doDraw=function(){this.drawContext.renderShapes=!0,this.subsurfaceMode&&this.hasStencilBuffer?(this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables(),this.drawContext.screenCreditController.drawCredits(this.drawContext))):(this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables()),this.drawContext.screenCreditController.drawCredits(this.drawContext))},b.prototype.redrawSurface=function(){this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.EQUAL,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.KEEP,this.drawContext.currentGlContext.KEEP,this.drawContext.currentGlContext.KEEP),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!1),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST)},b.prototype.doPick=function(){this.drawContext.terrain&&this.drawContext.terrain.pick(this.drawContext),this.drawContext.pickTerrainOnly||(this.subsurfaceMode&&this.hasStencilBuffer?(this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables(),this.drawContext.terrain.pick(this.drawContext),this.drawScreenRenderables())):(this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables())))},b.prototype.createTerrain=function(){var t=this.drawContext;t.terrain=this.globe.tessellator.tessellate(t),t.frameStatistics.setTerrainTileCount(t.terrain?t.terrain.surfaceGeometry.length:0)},b.prototype.makeCurrent=function(t){var e=this.drawContext;switch(e.globe.offset=t,e.globeStateKey=e.globe.stateKey,t){case-1:e.terrain=this.terrainLeft;break;case 0:e.terrain=this.terrainCenter;break;case 1:e.terrain=this.terrainRight}},b.prototype.createTerrain2DContiguous=function(){var t=this.drawContext;this.terrainCenter=null,t.globe.offset=0,t.globeStateKey=t.globe.stateKey,t.globe.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)&&(this.terrainCenter=t.globe.tessellator.tessellate(t)),this.terrainRight=null,t.globe.offset=1,t.globeStateKey=t.globe.stateKey,t.globe.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)&&(this.terrainRight=t.globe.tessellator.tessellate(t)),this.terrainLeft=null,t.globe.offset=-1,t.globeStateKey=t.globe.stateKey,t.globe.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)&&(this.terrainLeft=t.globe.tessellator.tessellate(t))},b.prototype.draw2DContiguous=function(){var t="";this.terrainCenter&&(t+=" 0 ",this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doDraw()),this.terrainRight&&(t+=" 1 ",this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doDraw()),this.deferOrderedRendering=!1,this.terrainLeft&&(t+=" -1 ",this.makeCurrent(-1),this.doDraw()),this.subsurfaceMode&&this.hasStencilBuffer&&(this.deferOrderedRendering=!0,this.terrainCenter&&(t+=" 0 ",this.makeCurrent(0),this.redrawSurface()),this.terrainRight&&(t+=" 1 ",this.makeCurrent(1),this.redrawSurface()),this.terrainLeft&&(t+=" -1 ",this.makeCurrent(-1),this.redrawSurface())),this.drawScreenRenderables()},b.prototype.pick2DContiguous=function(){this.terrainCenter&&(this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doPick()),this.terrainRight&&(this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doPick()),this.deferOrderedRendering=!1,this.terrainLeft&&(this.makeCurrent(-1),this.doPick())},b.prototype.drawLayers=function(t){var e,r=Date.now(),i=this.drawContext,n=i.layers;i.accumulateOrderedRenderables=t;for(var o=0,a=n.length;a>o;o++)if(e=n[o]){i.currentLayer=e;try{e.render(i)}catch(s){u.log(u.LEVEL_SEVERE,"Error while rendering layer "+e.displayName+".\n"+s.toString())}}var l=Date.now();i.frameStatistics.layerRenderingTime=l-r},b.prototype.addLayer=function(t){this.layers.push(t)},b.prototype.removeLayer=function(t){if(t){for(var e=-1,r=0,i=this.layers.length;i>r;r++)if(this.layers[r]==t){e=r;break}e>=0&&this.layers.splice(e,1)}},b.prototype.insertLayer=function(t,e){e&&this.layers.splice(t,0,e)},b.prototype.drawSurfaceRenderables=function(){var t,e=this.drawContext;for(e.reverseSurfaceRenderables();t=e.popSurfaceRenderable();)try{t.renderSurface(e)}catch(r){u.logMessage(u.LEVEL_WARNING,"WorldWindow","drawSurfaceRenderables","Error while rendering a surface renderable.\n"+r.message)}},b.prototype.drawOrderedRenderables=function(){var t,e=Date.now(),r=this.drawContext;if(r.sortOrderedRenderables(),this._orderedRenderingFilters)for(var i=0;i<this._orderedRenderingFilters.length;i++)this._orderedRenderingFilters[i](this.drawContext);for(r.orderedRenderingMode=!0;t=r.popOrderedRenderable();)try{t.renderOrdered(r)}catch(n){u.logMessage(u.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering an ordered renderable.\n"+n.message)}r.orderedRenderingMode=!1,r.frameStatistics.orderedRenderingTime=Date.now()-e},b.prototype.drawScreenRenderables=function(){for(var t,e=this.drawContext;t=e.nextScreenRenderable();)try{t.renderOrdered(e)}catch(r){u.logMessage(u.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering a screen renderable.\n"+r.message)}},b.prototype.resolveTopPick=function(){if(0!=this.drawContext.objectsAtPickPoint.objects.length){var t=this.drawContext.objectsAtPickPoint,e=this.drawContext.readPickColor(this.drawContext.pickPoint),r=null,i=null;if(e){for(var n=0,o=t.objects.length;o>n;n++){var a=t.objects[n];if(a.isTerrain&&(i=a),a.color.equals(e)&&(a.isOnTop=!0,r=a,i))break}this.drawContext.deepPicking||(t.clear(),r&&t.add(r),i&&i!=r&&t.add(i))}else t.clear()}},b.prototype.resolveTerrainPick=function(){for(var t,e=this.drawContext.objectsAtPickPoint,r=0,i=e.objects.length;i>r;r++)if(t=e.objects[r],t.isTerrain){t.isOnTop=!0;break}},b.prototype.resolveRegionPick=function(){if(0!=this.drawContext.objectsAtPickPoint.objects.length)for(var t,e,r=this.drawContext.objectsAtPickPoint,i=this.drawContext.readPickColors(this.drawContext.pickRectangle),n=0,o=r.objects.length;o>n;n++)if(t=r.objects[n]){var a=t.color.toByteString();e=i[a],e?t.isOnTop=!0:t.userObject instanceof m&&(r.objects.splice(n,1),n-=1)}},b.prototype.callRedrawCallbacks=function(t){for(var e=0,r=this._redrawCallbacks.length;r>e;e++)try{this._redrawCallbacks[e](this,t)}catch(i){u.log(u.LEVEL_SEVERE,"Exception calling redraw callback.\n"+i.toString())}},b.prototype.goTo=function(t,e){this.goToAnimator.goTo(t,e)},b.prototype.declutter=function(e,r){if(!r)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","declutter","Group ID is null, undefined or 0."));for(var i=[],n=0;n<e.orderedRenderables.length;n++){var o=e.orderedRenderables[n].orderedRenderable;o.declutterGroup===r&&i.push(o)}for(var a=[],s=0;s<i.length;s++){var l=i[s],c=l.screenBounds;c&&c.intersectsRectangles(a)?l.targetVisibility=0:(l.targetVisibility=1,c&&a.push(c))}},b.prototype.computeViewingTransform=function(t,e){var r=.5*this.navigator.altitude,i=this.globe.horizonDistance(this.navigator.altitude);if(0!=this.depthBits){var n=(1<<this.depthBits)-1,o=10,a=i/(n/(1-o/i)-n+1);r>a&&(r=a)}t.setToPerspectiveProjection(this.viewport.width,this.viewport.height,this.fieldOfView,r,i),this.navigator.getAsCamera(this.globe,this.scratchCamera),this.globe.cameraToCartesianTransform(this.scratchCamera,e).invertOrthonormal(e)},b.prototype.distanceToViewGlobeExtents=function(){var t=Math.sin(w.toRadians(.5*this.fieldOfView)),e=this.globe.equatorialRadius;return e/t-e},b}),i("../src/worldwind/util/WWMessage",[],function(){"use strict";var t=function(t,e){this.type=t,this.source=e};return t}),i("../src/worldwind/WorldWind",["./error/AbstractError","./geom/Angle","./shapes/Annotation","./shapes/AnnotationAttributes","./util/measure/AreaMeasurer","./error/ArgumentError","./layer/AtmosphereLayer","./shaders/AtmosphereProgram","./shaders/BasicProgram","./shaders/BasicTextureProgram","./util/BasicTimeSequence","./navigate/WorldWindowController","./layer/BingAerialLayer","./layer/BingAerialWithLabelsLayer","./layer/BingRoadsLayer","./layer/BingWMSLayer","./layer/BMNGLandsatLayer","./layer/BMNGLayer","./layer/BMNGOneImageLayer","./layer/BMNGRestLayer","./geom/BoundingBox","./navigate/Camera","./gesture/ClickRecognizer","./formats/collada/ColladaLoader","./util/Color","./shapes/Compass","./layer/CompassLayer","./layer/CoordinatesDisplayLayer","./util/Date","./layer/DigitalGlobeTiledImageLayer","./gesture/DragRecognizer","./render/DrawContext","./globe/EarthElevationModel","./globe/EarthRestElevationModel","./globe/ElevationModel","./util/Font","./util/FrameStatistics","./layer/FrameStatisticsLayer","./render/FramebufferTexture","./render/FramebufferTile","./render/FramebufferTileController","./geom/Frustum","./shapes/GeographicMesh","./projections/GeographicProjection","./shapes/GeographicText","./formats/geojson/GeoJSONGeometry","./formats/geojson/GeoJSONGeometryCollection","./formats/geojson/GeoJSONGeometryLineString","./formats/geojson/GeoJSONGeometryMultiLineString","./formats/geojson/GeoJSONGeometryMultiPoint","./formats/geojson/GeoJSONGeometryMultiPolygon","./formats/geojson/GeoJSONGeometryPoint","./formats/geojson/GeoJSONGeometryPolygon","./formats/geojson/GeoJSONParser","./formats/geotiff/GeoTiffReader","./gesture/GestureRecognizer","./globe/Globe","./globe/Globe2D","./util/GoToAnimator","./shaders/GpuProgram","./cache/GpuResourceCache","./shaders/GpuShader","./shaders/GroundProgram","./util/HashMap","./util/HighlightController","./formats/kml/util/ImagePyramid","./util/ImageSource","./render/ImageTile","./util/Insets","./formats/kml/util/ItemIcon","./formats/kml/KmlAbstractView","./formats/kml/styles/KmlBalloonStyle","./formats/kml/KmlCamera","./formats/kml/styles/KmlColorStyle","./formats/kml/features/KmlContainer","./formats/kml/features/KmlDocument","./formats/kml/KmlElements","./formats/kml/features/KmlFeature","./formats/kml/KmlFile","./formats/kml/features/KmlFolder","./formats/kml/geom/KmlGeometry","./formats/kml/features/KmlGroundOverlay","./formats/kml/KmlIcon","./formats/kml/styles/KmlIconStyle","./formats/kml/styles/KmlLabelStyle","./formats/kml/KmlLatLonAltBox","./formats/kml/KmlLatLonBox","./formats/kml/KmlLatLonQuad","./formats/kml/geom/KmlLinearRing","./formats/kml/geom/KmlLineString","./formats/kml/styles/KmlLineStyle","./formats/kml/KmlLink","./formats/kml/styles/KmlListStyle","./formats/kml/KmlLocation","./formats/kml/KmlLod","./formats/kml/KmlLookAt","./formats/kml/geom/KmlMultiGeometry","./formats/kml/features/KmlNetworkLink","./formats/kml/KmlObject","./formats/kml/KmlOrientation","./formats/kml/features/KmlOverlay","./formats/kml/features/KmlPhotoOverlay","./formats/kml/features/KmlPlacemark","./formats/kml/geom/KmlPoint","./formats/kml/geom/KmlPolygon","./formats/kml/styles/KmlPolyStyle","./formats/kml/KmlRegion","./formats/kml/features/KmlScreenOverlay","./formats/kml/styles/KmlStyle","./formats/kml/styles/KmlStyleMap","./formats/kml/styles/KmlStyleSelector","./formats/kml/styles/KmlSubStyle","./formats/kml/KmlTimePrimitive","./formats/kml/KmlTimeSpan","./formats/kml/KmlTimeStamp","./formats/kml/features/KmlTour","./formats/kml/geom/KmlTrack","./layer/LandsatRestLayer","./layer/Layer","./util/measure/LengthMeasurer","./util/Level","./util/LevelRowColumnUrlBuilder","./util/LevelSet","./geom/Line","./geom/Location","./util/Logger","./navigate/LookAt","./geom/Matrix","./util/measure/MeasurerUtils","./cache/MemoryCache","./cache/MemoryCacheListener","./layer/MercatorTiledImageLayer","./navigate/Navigator","./navigate/NavigatorState","./util/NominatimGeocoder","./error/NotYetImplementedError","./util/Offset","./layer/OpenStreetMapImageLayer","./formats/kml/util/Pair","./gesture/PanRecognizer","./shapes/Path","./util/PeriodicTimeSequence","./pick/PickedObject","./pick/PickedObjectList","./gesture/PinchRecognizer","./shapes/Placemark","./shapes/PlacemarkAttributes","./geom/Plane","./shapes/Polygon","./util/PolygonSplitter","./geom/Position","./projections/ProjectionEquirectangular","./projections/ProjectionGnomonic","./projections/ProjectionMercator","./projections/ProjectionPolarEquidistant","./projections/ProjectionUPS","./projections/ProjectionWgs84","./geom/Rectangle","./render/Renderable","./layer/RenderableLayer","./layer/RestTiledImageLayer","./gesture/RotationRecognizer","./formats/kml/util/Scale","./formats/kml/util/Schema","./shapes/ScreenImage","./shapes/ScreenText","./geom/Sector","./shapes/ShapeAttributes","./formats/shapefile/Shapefile","./layer/ShowTessellationLayer","./shaders/SkyProgram","./layer/StarFieldLayer","./shaders/StarFieldProgram","./util/SunPosition","./shapes/SurfaceImage","./shapes/SurfaceCircle","./shapes/SurfaceEllipse","./shapes/SurfacePolygon","./shapes/SurfacePolyline","./shapes/SurfaceRectangle","./render/SurfaceRenderable","./shapes/SurfaceSector","./shapes/SurfaceShape","./shapes/SurfaceShapeTile","./shapes/SurfaceShapeTileBuilder","./render/SurfaceTile","./render/SurfaceTileRenderer","./shaders/SurfaceTileRendererProgram","./gesture/TapRecognizer","./layer/TectonicPlatesLayer","./globe/Terrain","./globe/TerrainTile","./globe/TerrainTileList","./globe/Tessellator","./shapes/Text","./shapes/TextAttributes","./render/TextSupport","./render/Texture","./render/TextureTile","./util/Tile","./layer/TiledImageLayer","./util/TileFactory","./gesture/TiltRecognizer","./gesture/Touch","./shapes/TriangleMesh","./error/UnsupportedOperationError","./geom/Vec2","./geom/Vec3","./layer/ViewControlsLayer","./formats/kml/util/ViewVolume","./util/WcsTileUrlBuilder","./ogc/WfsCapabilities","./ogc/wms/WmsCapabilities","./layer/WmsLayer","./ogc/wms/WmsLayerCapabilities","./layer/WmsTimeDimensionedLayer","./util/WmsUrlBuilder","./ogc/wmts/WmtsCapabilities","./layer/WmtsLayer","./ogc/wmts/WmtsLayerCapabilities","./WorldWindow","./navigate/WorldWindowController","./util/WWMath","./util/WWMessage","./util/WWUtil","./util/XmlDocument","./globe/ZeroElevationModel"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,m,g,y,v,E,w,b,x,_,S,T,L,M,A,N,R,C,P,O,I,k,D,V,F,G,B,W,U,j,z,K,q,H,Y,$,X,J,Z,Q,tt,et,rt,it,nt,ot,at,st,lt,ut,ct,ht,ft,dt,pt,mt,gt,yt,vt,Et,wt,bt,xt,_t,St,Tt,Lt,Mt,At,Nt,Rt,Ct,Pt,Ot,It,kt,Dt,Vt,Ft,Gt,Bt,Wt,Ut,jt,zt,Kt,qt,Ht,Yt,$t,Xt,Jt,Zt,Qt,te,ee,re,ie,ne,oe,ae,se,le,ue,ce,he,fe,de,pe,me,ge,ye,ve,Ee,we,be,xe,_e,Se,Te,Le,Me,Ae,Ne,Re,Ce,Pe,Oe,Ie,ke,De,Ve,Fe,Ge,Be,We,Ue,je,ze,Ke,qe,He,Ye,$e,Xe,Je,Ze,Qe,tr,er,rr,ir,nr,or,ar,sr,lr,ur,cr,hr,fr,dr,pr,mr,gr,yr,vr,Er,wr,br,xr,_r,Sr,Tr,Lr,Mr,Ar,Nr,Rr,Cr,Pr,Or,Ir,kr,Dr,Vr,Fr,Gr,Br,Wr,Ur,jr,zr,Kr,qr,Hr,Yr,$r,Xr,Jr,Zr,Qr,ti,ei,ri,ii,ni,oi,ai,si,li,ui,ci){"use strict";var hi={VERSION:"0.0.0",ABSOLUTE:"absolute",AFTER_REDRAW:"afterRedraw",BEFORE_REDRAW:"beforeRedraw",BEGAN:"began",CANCELLED:"cancelled",CHANGED:"changed",CLAMP_TO_GROUND:"clampToGround",EARTH_RADIUS:6371e3,EAST:"east",ENDED:"ended",FAILED:"failed",GREAT_CIRCLE:"greatCircle",LINEAR:"linear",MULTI_POINT:"multiPoint",NORTH:"north",NULL:"null",OFFSET_FRACTION:"fraction",OFFSET_INSET_PIXELS:"insetPixels",OFFSET_PIXELS:"pixels",POINT:"point",POLYLINE:"polyline",POLYGON:"polygon",POSSIBLE:"possible",RECOGNIZED:"recognized",REDRAW_EVENT_TYPE:"WorldWindRedraw",RELATIVE_TO_GLOBE:"relativeToGlobe",RELATIVE_TO_GROUND:"relativeToGround",RELATIVE_TO_SCREEN:"relativeToScreen",RHUMB_LINE:"rhumbLine",SOUTH:"south",WEST:"west"};return hi.AbstractError=t,hi.Angle=e,hi.Annotation=r,hi.AnnotationAttributes=i,hi.AreaMeasurer=n,hi.ArgumentError=o,hi.AtmosphereLayer=a,hi.AtmosphereProgram=s,hi.BasicProgram=l,hi.BasicTextureProgram=u,hi.BasicTimeSequence=c,hi.BasicWorldWindowController=h,hi.BingAerialLayer=f,hi.BingAerialWithLabelsLayer=d,hi.BingRoadsLayer=p,hi.BingWMSLayer=m,hi.BMNGLandsatLayer=g,hi.BMNGLayer=y,hi.BMNGOneImageLayer=v,hi.BMNGRestLayer=E,hi.BoundingBox=w,hi.Camera=b,hi.ClickRecognizer=x,hi.ColladaLoader=_,hi.Color=S,hi.Compass=T,hi.CompassLayer=L,hi.CoordinatesDisplayLayer=M,hi.DateWW=A,hi.DigitalGlobeTiledImageLayer=N,hi.DragRecognizer=R,hi.DrawContext=C,hi.EarthElevationModel=P,hi.EarthRestElevationModel=O,hi.ElevationModel=I,hi.Font=k,hi.FrameStatistics=D,hi.FrameStatisticsLayer=V,hi.FramebufferTexture=F,hi.FramebufferTile=G,hi.FramebufferTileController=B,hi.Frustum=W,hi.GeographicMesh=U,hi.GeographicProjection=j,hi.GeographicText=z,hi.GeoJSONGeometry=K,hi.GeoJSONGeometryCollection=q,hi.GeoJSONGeometryLineString=H,hi.GeoJSONGeometryMultiLineString=Y,hi.GeoJSONGeometryMultiPoint=$,hi.GeoJSONGeometryMultiPolygon=X,hi.GeoJSONGeometryPoint=J,hi.GeoJSONGeometryPolygon=Z,hi.GeoJSONParser=Q,hi.GeoTiffReader=tt,hi.GestureRecognizer=et,hi.Globe=rt,hi.Globe2D=it,hi.GoToAnimator=nt,hi.GpuProgram=ot,hi.GpuResourceCache=at,hi.GpuShader=st,hi.GroundProgram=lt,hi.HashMap=ut,hi.HighlightController=ct,hi.ImageSource=ft,hi.ImageTile=dt,hi.Insets=pt,hi.KmlFile=St,hi.LandsatRestLayer=ue,hi.Layer=ce,hi.LengthMeasurer=he,hi.Level=fe,hi.LevelRowColumnUrlBuilder=de,hi.LevelSet=pe,hi.Line=me,hi.Location=ge,hi.Logger=ye,hi.LookAt=ve,hi.Matrix=Ee,hi.MeasurerUtils=we,hi.MemoryCache=be,hi.MemoryCacheListener=xe,hi.MercatorTiledImageLayer=_e,hi.Navigator=Se,hi.NavigatorState=Te,hi.NominatimGeocoder=Le,hi.NotYetImplementedError=Me,hi.Offset=Ae,hi.OpenStreetMapImageLayer=Ne,hi.PanRecognizer=Ce,hi.Path=Pe,hi.PeriodicTimeSequence=Oe,hi.PickedObject=Ie,hi.PickedObjectList=ke,hi.PinchRecognizer=De,hi.Placemark=Ve,hi.PlacemarkAttributes=Fe,hi.Plane=Ge,hi.Polygon=Be,hi.PolygonSplitter=We,hi.Position=Ue,hi.ProjectionEquirectangular=je,hi.ProjectionGnomonic=ze,hi.ProjectionMercator=Ke,hi.ProjectionPolarEquidistant=qe,hi.ProjectionUPS=He,hi.ProjectionWgs84=Ye,hi.Rectangle=$e,hi.Renderable=Xe,hi.RenderableLayer=Je,hi.RestTiledImageLayer=Ze,hi.RotationRecognizer=Qe,hi.ScreenText=ir,hi.ScreenImage=rr,hi.Sector=nr,hi.ShapeAttributes=or,hi.Shapefile=ar,hi.ShowTessellationLayer=sr,hi.SkyProgram=lr,hi.StarFieldLayer=ur,hi.StarFieldProgram=cr,hi.SunPosition=hr,hi.SurfaceImage=fr,hi.SurfaceCircle=dr,hi.SurfaceEllipse=pr,hi.SurfacePolygon=mr,hi.SurfacePolyline=gr,hi.SurfaceRectangle=yr,hi.SurfaceRenderable=vr,hi.SurfaceSector=Er,hi.SurfaceShape=wr,hi.SurfaceShapeTile=br,hi.SurfaceShapeTileBuilder=xr,hi.SurfaceTile=_r,hi.SurfaceTileRenderer=Sr,hi.SurfaceTileRendererProgram=Tr,hi.TapRecognizer=Lr,hi.TectonicPlatesLayer=Mr,hi.Terrain=Ar,hi.TerrainTile=Nr,hi.TerrainTileList=Rr,hi.Tessellator=Cr,hi.Text=Pr,hi.TextAttributes=Or,hi.TextSupport=Ir,hi.Texture=kr,hi.TextureTile=Dr,hi.Tile=Vr,hi.TiledImageLayer=Fr,hi.TileFactory=Gr,hi.TiltRecognizer=Br,hi.Touch=Wr,hi.TriangleMesh=Ur,hi.UnsupportedOperationError=jr,hi.Vec2=zr,hi.Vec3=Kr,hi.ViewControlsLayer=qr,hi.WcsTileUrlBuilder=Yr,hi.WfsCapabilities=$r,hi.WmsCapabilities=Xr,hi.WmsLayer=Jr,hi.WmsLayerCapabilities=Zr,
hi.WmsTimeDimensionedLayer=Qr,hi.WmsUrlBuilder=ti,hi.WmtsCapabilities=ei,hi.WmtsLayer=ri,hi.WmtsLayerCapabilities=ii,hi.WWMath=ai,hi.WWMessage=si,hi.WWUtil=li,hi.WorldWindow=ni,hi.WorldWindowController=oi,hi.ZeroElevationModel=ci,hi.configuration={gpuCacheSize:25e7,baseUrl:li.worldwindlibLocation()||li.currentUrlSansFilePart()+"/../"},hi.BingMapsKey=null,window.WorldWind=hi,hi}),i("../src/scripts/Layer",["../worldwind/WorldWind"],function(t){var e=t.RenderableLayer,r=function(e){t.RenderableLayer.call(this,e)};return r.prototype=Object.create(e.prototype),r}),i("../src/scripts/LayerGroup",["./Layer"],function(t){var e=function(){this.layers=[]};return e.prototype.addLayer=function(e,r){this.layers[e]=new t(r)},e.prototype.pushLayer=function(e){this.layers.push(new t(e))},e.prototype.setAll=function(t){this.layers.forEach(function(e){$.each(t,function(t,r){e[t]=r})})},e.prototype.setAllRend=function(t){var e=this;this.layers.forEach(function(r){r.renderables.forEach(function(r){$.each(t,function(t,i){e.setValue(r,t,i)})})})},e.prototype.setValue=function(t,e,r){"string"==typeof e&&(e=e.split(".")),e.length>1?this.setValue(t[e.shift()],e,r):t[e[0]]=r},e});var s;i("../src/scripts/AppConstructor",["./DataLoader","./GlobeHelper","./csvToGrid/Converter","./LayerGroup"],function(t,e,r,i){var n=function(){this.helper=e};return n.prototype.cleanAll=function(t){e.clean(t.smallVoxels,t.bigVoxels,t.gridlayer,t.globe)},n.prototype.init=function(t,e){e.init(t,this),this.cleanAll(e),(t.isCSV||t.isUrl)&&this.initCSV(t,e)},n.prototype.initCSV=function(t,i,n,o){e.clean(i.smallVoxels.layers,i.bigVoxels.layers,i.gridLayer,i.globe);var a=[];i.options=t,a[0]=t.config_0,a[0].data=t.csv.data,a[0].time=t.csv.time,a[0].delimiter=t.csv.delimiter;var s=t.sub,l=this,u=new Promise(function(e){n||t.isUrl?n&&!t.isUrl?e(i.allData):t.isUrl&&l.prepareWCS(t.config_0,e):r.loadData(t.csv.csvUrl,e,a[0].delimiter)});u.then(function(e){if(i.allData=e,n){for(n=i._navigator.getVisibleAreaBoundaries();n._top-n._bottom>40;)n._top-=1,n._bottom+=1;for(;n._right-n._left>40;)n._right-=1,n._left+=1;for(;(n._right-n._left)/(n._top-n._bottom)>1.3;)n._right-=.2,n._left+=.2,n._top+=.1,n._bottom-=.1;for(;(n._top-n._bottom)/(n._right-n._left)>1.3;)n._top-=.2,n._bottom+=.2,n._right+=.1,n._left-=.1}else n=i._navigator.getVisibleAreaBoundaries();t.isUrl&&(a[0].data=[0],a[0].time=3,a[0].lat=1,a[0].lng=2);try{if(o&&(e=r.filterData(e,a[0],n,o)),e.length>0){var l=r.initData(e,a[0],0);e.bounds=r.getDataBounds(e,a[0],0),a[0].heightExtrusion&&(e.bounds1=r.getDataBounds(e,a[0],1));var u=JSON.stringify(r.initJson(l,t.csv.zone,t.csv.quadSub,t.csv.source)),c=new Promise(function(t){i.gridLayer=i.loadGrid(u,1,t)})}c.then(function(){var t,n=i.createRect(s,i.gridLayer);if("undefined"!=typeof Worker)var o=new Promise(function(e){t=new Worker("src/scripts/workers/setGridtoData.js"),t.postMessage([u,l.times,a[0]]),t.onmessage=function(t){e(t.data)}});else l.times=r.setGridtoData(u,l.times,a[0]);o.then(function(t){l.times=JSON.parse(t),i.myData[0]=e,i.doxelFromData(l.allTime,l.times,a),i.allTime=l.allTime,i.times=l.times,i.rectInit(n),i.tiling=!1})})}catch(h){$("#loading").hide(),alert("Error occurred"),i.tiling=!1,console.log(h+"Error in parsing file")}})},n.prototype.initGridData=function(e,r){var i=[];i[0]=e.config_0;var n=e.sub,o=[],a=new t(this,0);r.dataLoaded=0;var s=new Promise(function(t){var i=e.gridUrl;if(e.isLocal){var n=new FileReader;n.onload=function(){i=n.result},n.readAsText(e.gridUrl),n.onloadend=function(){r.gridLayer=r.loadGrid(i,1,t)}}else r.gridLayer=r.loadGrid(i,0,t)}),l=new Promise(function(t){s.then(function(){a.getData(i[0].url,t,i[0])})});l.then(function(t){r.myData[0]=t;var e=[],n={},o=r.dataParser(t,e,n,i[0],0);r.allTime=o.allTime,r.times=o.times,r.doxelFromData(o.allTime,o.times,i)}),i[0].half&&new Promise(function(t){o[1].getData(i[1].url,t,i[0])}),Promise.all([l,s]).then(function(){var t=r.createRect(n,r.gridLayer);r.rectInit(t)})},n.prototype.newData=function(r,n){for(var o=n.globe.layers.length,a=4;o>=a;a++)n.globe.removeLayer(n.globe.layers[a]);e.clean(n.smallVoxels.layers,n.bigVoxels.layers,n.gridLayer,n.globe),n.smallVoxels=new i,n.config[1]=r;var s=new t(this,1),l=new Promise(function(t){s.getData(r.url,t,r)});l.then(function(t){n.myData[1]=t;var e=n.dataParser(t,n.allTime,n.times,r,1);n.allTime=e.allTime,n.times=e.times,[n.allTime,n.times]=n.sliceTime(n.allTime,n.times),n.doxelFromData(n.allTime,n.times,n.config,1)})},n.prototype.addCsv=function(t){if(t.options&&t.autoTile&&!t.tiling){$("#loading").show(),t.tiling=!0;var r=e.getMaxTile();this.initCSV(t.options,t,1,r)}},n.prototype.prepareWCS=function(t,e){for(var r=l._navigator.getVisibleAreaBoundaries();r._top-r._bottom>40;)r._top-=1,r._bottom+=1;for(;r._right-r._left>40;)r._right-=1,r._left+=1;var i=t.monthRange1,n=t.monthRange2,o=new Promise(function(e){var o=t.url,a=t.coverage,s='<?xml version="1.0" encoding="UTF-8" ?><ProcessCoveragesRequest xmlns="http://www.opengis.net/wcps/1.0" service="WCPS" version="1.0.0">  <query>    <abstractSyntax>      for c in ('+a+") return encode(c[Lat("+r._bottom+":"+r._top+"), Long("+r._left+":"+r._right+'), ansi("2014-'+i+'":"2014-'+n+'")], "csv")    </abstractSyntax>  </query></ProcessCoveragesRequest>';$.ajax({type:"POST",url:o,data:s,contentType:"application/json; charset=utf-8",success:function(t){e(t)}})});o.then(function(t){var o=[],a=n-i+1;t=t.split("}},");for(var s=-.1,l=0;l<t.length;l++){var u=t[l].replace(/\{|\}/g,"");u=u.split(","),s+=.1;for(var c=-.1,h=0;h<u.length/a;h++){c+=.1;for(var f=0;a>f;f++){var d=Number(u[h+f]);999>d&&o.push([d,r._bottom+c,r._left+s,f+1])}}}e(o)})},n}),i("../src/scripts/Voxel",[],function(){var t=function(t,e){var r=[],i=[],n=[],o=[],a=[];n[0]=t[0].lat,o[0]=t[0].lng,n[1]=t[3].lat,o[1]=t[3].lng,n[2]=t[1].lat,o[2]=t[1].lng,n[3]=t[2].lat,o[3]=t[2].lng,a[0]=t.altitude,a[1]=a[0]+t.height;var s=[];r.push(new WorldWind.Position(n[1],o[1],a[0])),r.push(new WorldWind.Position(n[1],o[1],a[1])),r.push(new WorldWind.Position(n[0],o[0],a[0])),i.push(0),i.push(1),i.push(2),r.push(new WorldWind.Position(n[0],o[0],a[1])),r.push(new WorldWind.Position(n[0],o[0],a[0])),r.push(new WorldWind.Position(n[1],o[1],a[1])),i.push(3),i.push(4),i.push(5),r.push(new WorldWind.Position(n[1],o[1],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[1])),r.push(new WorldWind.Position(n[0],o[0],a[1])),i.push(6),i.push(7),i.push(8),r.push(new WorldWind.Position(n[1],o[1],a[1])),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[1])),i.push(9),i.push(10),i.push(11),r.push(new WorldWind.Position(n[1],o[1],a[1])),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[1],o[1],a[0])),i.push(12),i.push(13),i.push(14),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[3],o[3],a[0])),r.push(new WorldWind.Position(n[1],o[1],a[0])),i.push(15),i.push(16),i.push(17),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[0])),r.push(new WorldWind.Position(n[3],o[3],a[0])),i.push(18),i.push(19),i.push(20),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[0])),i.push(21),i.push(22),i.push(23),r.push(new WorldWind.Position(n[2],o[2],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[0])),r.push(new WorldWind.Position(n[0],o[0],a[1])),i.push(24),i.push(25),i.push(26),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),r.push(new WorldWind.Position(n[2],o[2],a[0])),r.push(new WorldWind.Position(n[0],o[0],a[0])),r.push(new WorldWind.Position(n[0],o[0],a[1])),i.push(27),i.push(28),i.push(29);var l=new WorldWind.ShapeAttributes(null);l.drawOutline=!1,l.applyLighting=!0;var u=new WorldWind.TriangleMesh(r,i,l);if(e.length>1){var c=document.createElement("canvas"),h=c.getContext("2d"),f=h.createLinearGradient(0,0,0,c.height);f.addColorStop(0,e[0]),f.addColorStop(.49,e[0]),f.addColorStop(.51,e[1]),f.addColorStop(1,e[1]),h.fillStyle=f,h.fillRect(0,0,c.width,c.height),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),l.imageSource=new WorldWind.ImageSource(c),u.textureCoordinates=s}else l.interiorColor=e;return u.point={0:n[0],1:o[0]},u};return t}),i("../src/scripts/GlobeInterface",["./Voxel","./GlobeHelper","../worldwind/WorldWind","./Layer","./LayerGroup"],function(t,e,r,i,n){var o=function(t){this.globe=t};return o.prototype.init=function(t,e){this.heightCube=t.heightCube,this.gridUrl=t.gridUrl,this.heightDim=t.heightDim,this.maxShown=t.maxShown,this.maxInApp=t.maxInApp,this.startHeight=t.startHeight,this.autoTime=t.autoTime,this.statIndex=t.statIndex,this.maxDownload=t.maxDownload,this.colors=t.colors,this.config=[],this.config[0]=t.config_0,this.sub=t.sub,this.times={},this.smallVoxels=new n,this.bigVoxels=new n,this.dim={},this.rect=[],this.minTime=0,this.activeLayers=0,this.compare=0,this.parent=e,this.myData=[]},o.prototype.updateOpt=function(t){this.UI.resetTime(t[0]),this.autoTime=t[1],this.statIndex=t[2]},o.prototype.setUI=function(t){this.UI=t},o.prototype.dataParser=function(t,e,r,i,n){for(var o=t.length,a=0;o>a;a++){var s=t[a],l=s[i.time];if(-1==e.indexOf(l)){if(e.length>=this.maxInApp)break;e.push(l)}r[l]||(r[l]=[]),r[l][n]||(r[l][n]=[]);var u=[s[i.id]];for(var c in i.data)u.push(s[i.data[c]]);r[l][n].push(u)}return{allTime:e,times:r}},o.prototype.sliceTime=function(t,e){var r;for(r in e)e[r].length<2&&delete e[r];for(r in t)e[t[r]]||t.splice(r);return[t,e]},o.prototype.doxelFromData=function(t,e,r){if(this.dataLoaded++,this.config[1]){l.maxShown=1;var i=this.config[1].reference}else var i=0;this.makeSmallLayers(t,e);var n=[this.colors,this.startHeight,this.heightCube];results=this.makeSmallDoxels(n,this.myData,this.gridLayer,t,e,r,i),this.resolveDoxel(results)},o.prototype.resolveDoxel=function(t){for(var e=0;e<t.length;e++)this.smallVoxels.layers[t[e][0]].addRenderables(t[e][1]);if(2==this.dataLoaded){this.UI.disableNewData(),this.UI.start();var r=this.createRect(this.sub,this.gridLayer);this.movingTemplate=r[0],this.rect=r[1],this.dim.x=r[2],this.dim.y=r[3],this.assignVoxels(r[1],this.gridLayer.renderables,this.smallVoxels.layers)}},o.prototype.loadGrid=function(t,e,i){var n=new r.RenderableLayer("GridLayer");return this.createJson(n,t,e,i),this.globe.addLayer(n),n},o.prototype.createJson=function(t,e,i,n){var o=function(t,e){var i={};return(t.isPolygonType()||t.isMultiPolygonType())&&(i.attributes=new r.ShapeAttributes(null),i.attributes.id=e.id,i.attributes.interiorColor=new r.Color(.3,.3,.3,.5),i.attributes.outlineColor=new r.Color(1,1,1,.8)),i},a=new r.GeoJSONParser(e);a.load(n,o,t)},o.prototype.makeBigDoxels=function(){var t,i,o=new n,a=this.heightDim,s=this.compare,l=this.smallVoxels.layers;l.forEach(function(t){t.renderables.forEach(function(t){t.enabled=!1,t.bigCubed=!0})}),a>this.maxShown&&(a=this.maxShown);var u={altitude:this.startHeight,height:this.activeLayers*this.heightCube/a};for(t=0;a>t;t++){this.bigVoxels&&this.bigVoxels.layers[t]&&this.globe.removeLayer(this.bigVoxels.layers[t]),o.pushLayer("bigVoxels_"+t),o.csv=!0,this.globe.addLayer(o.layers[t]);var c=this.rect;for(i=0;i<c.length;i++){var h=c[i],f=t+this.minTime,d=e.getStatistics(h,f,this.myData[s],this.statIndex,this.colors,this.config,this.compare),p=r.Color.colorFromBytes(d[0][0],d[0][1],d[0][2],d[0][3]),m=this.getBigVoxels(h,u,p);m.data=d[1],m.showAlt=!0,m.bigShow=!0,o.layers[t].addRenderable(m)}u.altitude=u.altitude+u.height}this.bigVoxels=o},o.prototype.makeSmallLayers=function(t,e){this.activeLayers=0;for(var r=this.smallVoxels,i=[],n=t.length,o=0;n>o&&-1==i.indexOf(o)&&(i.push(o),!this.config[1]||e[t[o]][0]&&e[t[o]][1]);o++)r.addLayer(o,o),r.layers[o].enabled=!0,r.layers[o].active=!0,this.activeLayers++,o>=this.maxShown&&(r.layers[o].enabled=!1,r.layers[o].active=!1,this.activeLayers--),r.layers[o].heightLayer=o,r.csv=!0,this.globe.addLayer(r.layers[o])},o.prototype.makeSmallDoxels=function(i,n,o,a,s,l,u,c){for(var h=[],f=i[0],d=i[1],p=i[2],m=a.length,g=0;m>g;g++){var y,v,E,w,b,x,_,S=[],T=s[a[g]][u],L=T.length;l[1]&&(L=Math.min(s[a[g]][0].length,s[a[g]][1].length));for(var M=0;M<o.renderables.length&&(!l[1]||s[a[g]][1][M]);M++){var A,N=o.renderables,R=N[M].attributes.id,C=!1,P=[];P.number=0,P.values=0,P.position=0;for(var O=0;L-1>O;O++){var I=T[O][0];if(R==I&&(A=N[M],A&&A._boundaries)){if(C=!0,l[1]&&(y=[],b=[]),s[a[g]][1]){v=s[a[g]][1][O][1].split(".").join("");var k=n[1].bounds[0],D=n[1].bounds[1],V=e.getColor((v-D)/(k-D)*100,f);y.push("rgb("+V[0]+","+V[1]+","+V[2]+")"),b.push(s[a[g]][1][O]),_=v}v=l[0].separator?s[a[g]][u][O][1].split(l[0].separator).join(""):s[a[g]][u][O][1],x=v,P.values+=Number(v),P.number++,x=P.values/P.number;var F=n[0].bounds[0],G=n[0].bounds[1],B=e.getColor((v-G)/(F-G)*100,f);if(l[1]?(y.push("rgb("+B[0]+","+B[1]+","+B[2]+")"),b.push(s[a[g]][0][O])):(y=r.Color.colorFromBytes(B[0],B[1],B[2],B[3]),b=s[a[g]][u][O]),E=e.getCoords(A),E.altitude=d+g*p,E.height=p,l[0].heightExtrusion){v=l[0].separator?s[a[g]][u][O][2].split(l[0].separator).join(""):s[a[g]][u][O][2];var F=n[0].bounds1[0],G=n[0].bounds1[1],W=(v-G)/(F-G)*100;E.height=p+W*p/10}w=A.attributes.id;var U=new t(E,y);U.enabled=!0,U.info=b,U.heightLayer=g,U.data=[],U.data.push(x),l[1]&&U.data.push(_),U.filtered=!1,U.latlongfilter=!1,U.id=w,P.position?S[P.position]=U:(P.position=S.length,S.push(U))}}}h.push([g,S])}return h},o.prototype.assignVoxels=function(t,e,r){for(var i in e)for(var n=0;n<t.length;n++)r.forEach(function(e){e.renderables[i]&&t[n].containsPoint(e.renderables[i].point)&&t[n].cubes.push(e.renderables[i])})},o.prototype.getBigVoxels=function(e,r,i){var n={},o=this.dim;n[0]={},n[1]={},n[2]={},n[3]={},n[0].lat=e.x,n[0].lng=e.y,n[1].lat=e.x+o.x,n[1].lng=e.y,n[2].lat=e.x+o.x,n[2].lng=e.y+o.y,n[3].lat=e.x,n[3].lng=e.y+o.y,n.altitude=r.altitude,n.height=r.height;var a=new t(n,i);return a.enabled=!0,a.active=!0,a.height=n.height,a},o.prototype.createRect=function(t,e){var i,n=1/0,o=1/0,a=-(1/0),s=-(1/0);e.renderables.forEach(function(t){o=Math.min(o,t._boundaries[0].longitude),o=Math.min(o,t._boundaries[1].longitude),n=Math.min(n,t._boundaries[0].latitude),n=Math.min(n,t._boundaries[1].latitude),s=Math.max(s,t._boundaries[1].longitude),s=Math.max(s,t._boundaries[2].longitude),a=Math.max(a,t._boundaries[1].latitude),a=Math.max(a,t._boundaries[3].latitude),t.point={0:t._boundaries[0].latitude,1:t._boundaries[0].longitude}}),e.bounds={},e.bounds.minLng=o,e.bounds.minLat=n,e.bounds.maxLng=s,e.bounds.maxLat=a;var l=(a-n)/t,u=(s-o)/t,c=0,h=n,f=o,d=[];for(i=0;t>i;i++){for(var p=0;t>p;p++)d[c]=new r.Rectangle(h,f,l,u),d[c].cubes=[],c++,h+=l;f+=u,h=n}var m=new r.Rectangle(n-1e-5,o-1e-5,l*t,u*t);return[m,d,l,u]},o.prototype.rectInit=function(t){this.movingTemplate=t[0],this.rect=t[1],this.dim.x=t[2],this.dim.y=t[3],this.assignVoxels(t[1],this.gridLayer.renderables,this.smallVoxels.layers),this.UI.start()},o.prototype.changeAltitude=function(t){this.smallVoxels.setAll.call(this.smallVoxels,{enabled:!1}),this.bigVoxels.setAllRend.call(this.bigVoxels,{enabled:!1,showAlt:!1});var e,r=[Math.floor(this.heightDim*t[0]/this.activeLayers),Math.floor(this.heightDim*t[1]/this.activeLayers)],i=this.bigVoxels.layers;for(e=r[0];e<r[1];e++)i[e]&&i[e].renderables.forEach(function(t){t.active?(t.bigShow&&(t.enabled=!0),t.showAlt=!0):t.showAlt=!1});var n=this.smallVoxels.layers;for(e=t[0]+this.minTime;e<t[1]+this.minTime;e++)n[e].active&&(n[e].enabled=!0);this.globe.redraw()},o.prototype.setOpacity=function(t){this.smallVoxels.setAllRend.call(this.smallVoxels,{"_attributes.interiorColor.alpha":t}),this.bigVoxels.setAllRend.call(this.bigVoxels,{"_attributes.interiorColor.alpha":t})},o.prototype.filterValues=function(t){var e=this.compare,r=this.smallVoxels.layers;r.forEach(function(r){r.renderables.forEach(function(r){var i=r.data[e];i<t[0]||i>t[1]?(r.enabled=!1,r.filtered=!0):r.filtered&&(r.filtered=!1,r.latlongfilter||r.bigCubed||(r.enabled=!0))})})},o.prototype.changeTime=function(t){this.minTime=t;var e,r=this.startHeight;for(s=this.smallVoxels.layers,s.forEach(function(e,i){e.renderables.forEach(function(n,o){var a=n.positions[0].altitude,s=n.positions[7].altitude,l=n.positions;l.forEach(function(e){var n=e.altitude,o=s-a,l=Number(r+o*Number(i)-t*o);l+=n==a?0:s-a,e.altitude=l}),e.renderables[o].reset()})}),s.forEach(function(t){t.enabled=!1,t.active=!1}),e=t;e<=this.activeLayers-1+t;e++)s[e].enabled=!0,s[e].active=!0;this.globe.redraw()},o.prototype.changeSize=function(t,e){var r,i=this.dim,n=this.movingTemplate,o=this.sub,a=this.gridLayer;e?(n.y=a.bounds.minLng+t[0],r=i.y*o-t[0],n.height=r,n.height=r-(i.y*o-t[1])):(n.x=a.bounds.minLat+t[0],r=i.x*o-t[0],n.width=r,n.width=r-(i.x*o-t[1]))},o.prototype.moveWindow=function(t){var e=this.rect,r=this.smallVoxels.layers,i=this.bigVoxels.layers,n=this.movingTemplate;t?r.forEach(function(t){t.renderables.forEach(function(t){n.containsPoint(t.point)&&t.enabled===!1&&e.forEach(function(e,r){t&&-1!==e.cubes.indexOf(t)&&n.intersects(e)&&(i.length>0?i.forEach(function(e){e.renderables[r].active?e.renderables[r].showAlt&&(e.renderables[r].enabled=!0,e.renderables[r].bigShow=!0):(t.latlongfilter=!1,t.filtered||(t.enabled=!0))}):(t.latlongfilter=!1,t.filtered||(t.enabled=!0)))})})}):r.forEach(function(t){t.renderables.forEach(function(t){n.containsPoint(t.point)||e.forEach(function(e,r){t&&-1!==e.cubes.indexOf(t)&&(i.length>0?i.forEach(function(e){e.renderables[r].active?(e.renderables[r].enabled=!1,e.renderables[r].bigShow=!1):(t.enabled=!1,t.latlongfilter=!0)}):(t.enabled=!1,t.latlongfilter=!0))})})})},o}),i("../src/scripts/Globe",["../worldwind/WorldWind"],function(t){"use strict";var e=window.WorldWind,r=function(r){e.WorldWindow.call(this,r.id),this.addLayer(new e.BingAerialWithLabelsLayer),t.configuration.baseUrl=t.configuration.baseUrl.split("../")[0];var i="images/dnb_land.png",n=new t.StarFieldLayer("images/stars.json");this.atmosphereLayer=new t.AtmosphereLayer(i),this.addLayer(n),this.addLayer(this.atmosphereLayer),n.time=new Date,this.atmosphereLayer.lightLocation=t.SunPosition.getAsGeographicLocation(n.time),this.addLayer(new e.CoordinatesDisplayLayer(this)),this.layers[0].detailControl=1,this.layers[1].detailControl=1};return r.prototype=Object.create(t.WorldWindow.prototype),r}),i("../src/scripts/Configurator",[],function(){var t=function(t){this.parent=t};return t.prototype.getConfig=function(t,e){Papa.parse(t,{worker:!1,download:!0,preview:1,fastMode:!0,complete:function(t){e(t.data[0])}})},t}),i("../src/scripts/Chart",[],function(){var t=function(){google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback()};return t.prototype.draw=function(t,e){this.chart=new google.visualization.AreaChart($("#chart_div")[0]),this.chart.draw(t,e),this.started=1},t.prototype.setPoint=function(t,e){this.chart.setSelection([{row:t,column:e+1}])},t}),i("../src/scripts/Correlation",[],function(){var t=function(){};return t.getCorrelationDatasets=function(t,e,r){var i,n,o,a,s=[],l=[],u=0,c=0;if(r[1]){for(i in e)if(e[i][0]&&e[i][1]){var h=Math.min(e[i][0].length,e[i][1].length);for(n=0;h>n;n++)o=e[i][0][n][0],a=r[0].separator?Number(e[i][0][n][1].split(r[0].separator).join("")):Number(e[i][0][n][1]),u+=a,o=e[i][1][n][0],a=r[0].separator?Number(e[i][1][n][1].split(r[1].separator).join("")):Number(e[i][1][n][1]),c+=a;s.push(u/e[i][0].length),l.push(c/e[i][1].length)}}else for(i in e){for(n=0;n<e[i][0].length;n++){if(o=e[i][0][n][0],e[i][0][n].length<3)return;a=r[0].separator?Number(e[i][0][n][1].split(r[0].separator).join("")):Number(e[i][0][n][1]),u+=a,a=r[0].separator?Number(e[i][0][n][2].split(r[0].separator).join("")):Number(e[i][0][n][2]),c+=a}s.push(u/e[i][0].length),l.push(c/e[i][0].length)}var f=[s,l],d=this.correlation(f,0,1);t(d)},t.getCorrelationVariables=function(t,e,r,i){var n,o,a,s,l,u,c=t.id,h=t.names,f=[h];for(n in e){var d=e[n];if(r[1]){if(d[0]&&d[1])for(o in d[0])if(d[0][o][0]==c){s=[],l=[n],u=d[0][o][1],r[0].separator&&(u=Number(u.split(r[0].separator).join(""))),l.push(Number(u));for(a in d[1])d[1][a][r[1].id]==c&&(u=d[1][o][r[1].data[0]],r[1].separator&&(u=Number(u.split(r[1].separator).join(""))));l.push(u),f.push(l)}}else for(o in d[0])if(d[0][o][0]==c){s=[],l=[n];for(var p=1;i+1>p;p++)u=d[0][o][p],r[0].separator&&(u=Number(u.split(r[0].separator).join(""))),l.push(Number(u));f.push(l)}}return f},t.correlation=function(t,e,r){var i=[];for(var n in t[e])t[r][n]&&i.push(n);var o=i.length;if(0===o)return 0;var a,s=0;for(a=0;a<i.length;a++)s+=t[e][i[a]];var l=0;for(a=0;a<i.length;a++)l+=t[r][i[a]];var u=0;for(a=0;a<i.length;a++)u+=Math.pow(t[e][i[a]],2);var c=0;for(a=0;a<i.length;a++)c+=Math.pow(t[r][i[a]],2);var h=0;for(a=0;a<i.length;a++)h+=t[e][i[a]]*t[r][i[a]];var f=h-s*l/o,d=Math.sqrt((u-Math.pow(s,2)/o)*(c-Math.pow(l,2)/o));return 0===d?0:f/d},t}),i("../src/scripts/HandlePicks",["./Chart","./Correlation"],function(t,e){var r=function(){this.chart=new t};return r.prototype.getBigDoxels=function(t,e,r){var i=function(i){var n,o=i.clientX,a=i.clientY,s=r.pick(r.canvasCoordinates(o,a));if(s.objects.length>0)for(var l=0;l<s.objects.length;l++)if(s.objects[l].isOnTop){for(o in t)if(-1!=t[o].cubes.indexOf(s.objects[l].userObject)){for(n in e)e[n].renderables[o].enabled=!0,e[n].renderables[o].active=!0;var u;for(u in t[o].cubes)t[o].cubes[u]&&(t[o].cubes[u].enabled=!1,t[o].cubes[u].bigCubed=!0);r.redraw();break}for(n in e)for(o in e[n].renderables)if(e[n].renderables[o]==s.objects[l].userObject){for(var c in e)e[c].renderables[o].enabled=!1,e[c].renderables[o].active=!1;for(var h in t[o].cubes)t[o].cubes[h]&&(t[o].cubes[h].enabled=!0,t[o].cubes[h].bigCubed=!1);r.redraw();break}}};return i},r.prototype.getDoxel=function(t){var r=this,i=t.globe,n=t.compare,o=t.config,a=function(a){var s=a.clientX,l=a.clientY,u=i.pick(i.canvasCoordinates(s,l));if(u.objects.length>0)for(var c=0;c<u.objects.length;c++)if(u.objects[c].isOnTop){if(r.highLighted&&r.highLighted.userObject==u.objects[c].userObject)r.resetSelected();else{r.resetSelected(),r.highLighted=u.objects[c];for(s in u.objects[c].userObject._positions)u.objects[c].userObject._positions[s].altitude+=500;var h=u.objects[c].userObject.id;if(void 0!==h){var f=["Time"],d=[o[0].data];if(o[1])f.push("Set 1","Set 2"),d=[o[0].data,o[1].data];else for(var p=0;p<o[0].data.length;p++)f.push("Variable "+(p+1));var m={names:f,values:d,id:h};$("#bottomMenu").show();var g=t.myData[n].bounds[1],y=t.config[0].data.length,v=e.getCorrelationVariables(m,t.times,t.config,y);if(v.length>0)var E=google.visualization.arrayToDataTable(v);var w={title:"Voxel Data",hAxis:{title:"Timestamp",titleTextStyle:{color:"#333"},slantedText:!1},vAxis:{minValue:g,format:"scientific"}};if(r.chart.draw(E,w),o[0]||o[1].data.length>0){var b=[];for(b[0]=[],b[1]=[],s=0;s<v.length;s++)0!==s&&(b[0].push(v[s][1]),b[1].push(v[s][2]));var x=e.correlation(b,0,1);x=Number(Math.round(x+"e5")+"e-5");var _="variables";o[0]&&(_="datasets"),$("#correlationVoxel").text("Correlation between "+_+" in selected voxel: "+x)}var S=t.allTime[t.UI.oldValTime],T=0;for(s in v)v[s][0]==S&&(T=s-1);r.chart.setPoint(T,n),u.objects[c].userObject.reset(),u.objects[c].userObject._attributes._outlineColor=new WorldWind.Color(1,1,1,.65),u.objects[c].userObject._attributes._drawOutline=!0,i.redraw()}else E=u.objects[c].userObject.data,E&&($("#correlationVoxel").text("Value of selected Big Doxel: "+E),$("#bottomMenu").show())}$("#chart_div").show();break}};return a},r.prototype.resetSelected=function(){try{if(this.highLighted){for(var t in this.highLighted.userObject._positions)this.highLighted.userObject._positions[t].altitude-=500;this.highLighted.userObject._attributes._drawOutline=!1,this.highLighted.userObject.reset()}this.highLighted=""}catch(e){}},r}),i("../src/scripts/UserInterface",["./Correlation"],function(t){var e=function(t){this.parent=t};return e.prototype.start=function(){var e=this.parent;this.oldValLng=[0,e.dim.y*e.sub],this.oldValLat=[0,e.dim.x*e.sub],this.oldValAlt=[0,e.activeLayers],this.oldValTime=0,this.startSlider(e),$("#minVal").html("Min: <br>"+e.myData[0].bounds[1]),$("#maxVal").html("Max: <br>"+e.myData[0].bounds[0]);if(e.config[0].data.length>1){var r=new Promise(function(r){t.getCorrelationDatasets(r,e.times,e.config)});r.then(function(t){var r=Number(Math.round(t+"e7")+"e-7");r||(r="unavailable");var i;i=e.config[1]?"datasets":"variables",$("#correlation").text("Correlation between "+i+": "+r)})}},e.prototype.disableNewData=function(){$("#compare").attr("disabled",!0),$("#compareOptions").hide()},e.prototype.resetTime=function(t){var e=this.parent;e.startHeight=t,e.changeAltitude(this.oldValAlt),e.changeTime(0),$("#sliderTime").slider("value",0),$("#timeSpan").html(e.allTime[0])},e.prototype.alert=function(t){var e=$("#alert");e.css("visibility","visible"),e.css("opacity",1),$("#alertContent").html(t)},e.prototype.startSlider=function(t){for(var e=this,r=t.rect,i=$("#sliderLng"),n=$("#LngSpan"),o=$("#sliderLat"),a=$("#LatSpan"),s=$("#sliderAlt"),l=$("#AltSpan"),u=$("#sliderTime"),h=$("#TimeSpan"),f=$("#sliderOpacity"),d=$("#OpacitySpan"),p=$("#sliderValues"),m=$("#ValuesSpan"),g=0,y=0;y<r.length;y++)g=Math.max(r[y].cubes.length,g);g=Math.floor(Math.sqrt(g)),i.slider({min:0,max:t.dim.y*t.sub,range:!0,step:t.dim.y/g,values:[0,t.dim.y*t.sub],slide:function(r,i){if(i.values[0]!=i.values[1]){n.html(Math.floor(i.values[0]/(t.dim.y*t.sub)*100)+" - "+Math.floor(i.values[1]/(t.dim.y*t.sub)*100)+"%"),t.changeSize(i.values,1);var o;o=i.values[0]>e.oldValLng[0]||i.values[1]<e.oldValLng[1]?0:1,t.moveWindow(o),t.globe.redraw(),e.oldValLng=i.values}}}),o.slider({min:0,max:t.dim.x*t.sub,range:!0,step:t.dim.x/g,values:[0,t.dim.x*t.sub],slide:function(r,i){if(i.values[0]!=i.values[1]){a.html(Math.floor(i.values[0]/(t.dim.x*t.sub)*100)+" - "+Math.floor(i.values[1]/(t.dim.x*t.sub)*100)+"%"),t.changeSize(i.values,0);var n;n=i.values[0]>e.oldValLat[0]||i.values[1]<e.oldValLat[1]?0:1,t.moveWindow(n),t.globe.redraw(),e.oldValLat=i.values}}}),m.html(t.myData[0].bounds[1]+" - "+t.myData[0].bounds[0]),p.slider({min:t.myData[0].bounds[1],max:t.myData[0].bounds[0],range:!0,step:(t.myData[0].bounds[0]-t.myData[0].bounds[1])/100,values:[t.myData[0].bounds[1],t.myData[0].bounds[0]],slide:function(e,r){r.values[0]!=r.values[1]&&(m.html(r.values[0]+" - "+r.values[1]),t.filterValues(r.values),t.globe.redraw())}}),s.slider({min:0,max:t.activeLayers,step:1,range:!0,values:[0,t.activeLayers],slide:function(r,i){i.values[0]!=i.values[1]&&(l.html(i.values[0]+" - "+i.values[1]),t.changeAltitude(i.values),e.oldValAlt=i.values)}});var v=t.smallVoxels.layers.length-t.allTime.slice(0,t.activeLayers).length,E=t.allTime[0];if(h.html(E),u.slider({min:0,max:v,range:!1,step:1,slide:function(r,i){var n=t.allTime[i.value];if(h.html(n),t.changeTime(i.value),t.autoTime){var o=$("#checkCompare").is(":checked")?1:0;t.compare=o,t.UI.resetValueFilter(),t.makeBigDoxels()}var a=t.allTime[i.value],s=0;for(y in t.allTime)t.allTime[y]==a&&(s=y-1);var o=$("#checkCompare").is(":checked")?1:0;e.handlePick.chart.started&&e.handlePick.chart.setPoint(s,o),t.changeAltitude(e.oldValAlt),e.oldValTime=i.value}}),f.slider({min:0,max:100,range:!1,step:1,value:0,slide:function(e,r){var i=r.value;r.value<100&&r.value>95&&(i=95),r.value<5&&r.value>0&&(i=0),d.html(100-r.value+"%"),t.setOpacity((100-i)/100),t.globe.redraw()}}),$("#loading").hide(),!t.started){t.started=1,t.globe.navigator.latitude=t.gridLayer.renderables[1].point[0],t.globe.navigator.longitude=t.gridLayer.renderables[1].point[1],t.globe.navigator.altitude=2e5;var w=$("#my-tour-id1").tourbus({}),b=$("#my-tour-id").tourbus({});b.trigger("stop.tourbus"),c&&w.trigger("depart.tourbus")}},e.prototype.resetValueFilter=function(){l=this.parent;var t=l.compare;l.filterValues([l.myData[t].bounds[1],l.myData[t].bounds[0]]),$("#sliderValues").slider("values",[l.myData[t].bounds[1],l.myData[t].bounds[0]]),$("#ValuesSpan").html(l.myData[t].bounds[1]+" - "+l.myData[t].bounds[0])},e}),i("../src/scripts/map/BoundingBox",[],function(){"use strict";var t=function(t,e,r,i){this._top=r,this._left=e,this._bottom=t,this._right=i};return Object.defineProperties(t.prototype,{top:{get:function(){return this._top}},left:{get:function(){return this._left}},bottom:{get:function(){return this._bottom}},right:{get:function(){return this._right}}}),t.prototype.isPartiallyInArea=function(t){return this.isFullyInArea(t)||this.isFullyInAreaCrossingDateline(t)||this.isEnclosedByArea(t)||this.isPartInArea(t)},t.prototype.isPartInArea=function(t){var e=!(this.left>=t.right||t.left>=this.right||this.top<=t.bottom||t.top<=this.bottom);return e},t.prototype.isFullyInArea=function(t){var e=this.top<t.top&&this.left>t.left&&this.right<t.right&&this.bottom>t.bottom;return e},t.prototype.isFullyInAreaCrossingDateline=function(t){var e=this.top<t.top&&this.bottom>t.bottom&&this.left>t.left&&this.right>t.right&&t.right<t.left||this.top<t.top&&this.bottom>t.bottom&&this.right<t.right&&this.left<t.left&&t.right<t.left;return e},t.prototype.isEnclosedByArea=function(t){var e=this.top>t.top&&this.left<t.left&&this.right>t.right&&this.bottom<t.bottom;return e},t.prototype.toString=function(){return"["+this.top+","+this.left+","+this.bottom+","+this.right+"]"},t}),i("../src/scripts/map/CoordConversions",[],function(){"use strict";var t=function(){};return t.prototype.isDatelineInViewport=function(t){for(var e=0,r=!1,i=0;i<t.length;i++)Math.abs(t[i][1]-e)>180&&(r=!0),e=t[i][1];return r},t.prototype.isPoleInViewport=function(t){var e=t.length,r=t[e/8],i=t[5*e/8];return Math.abs(r[1])+Math.abs(i[1])==180?r[0]>0&&i[0]>0?"north":r[0]<0&&i[0]<0?"south":"none":"none"},t.prototype.isPoleVisible=function(t){return t[0][1]-t[t.length/2][1]==0?"none":Math.abs(t[t.length/2][0])>=Math.abs(t[0][0])&&t[t.length/2][0]>0?"north":"south"},t.prototype.transformVisibleToBoundaries=function(t){return-180>t?360+t:t>180?-360+t:t},t.prototype.carto2geoConversion=function(t,e,r,i,n){t=t*Math.PI/180,e=e*Math.PI/180,i=i*Math.PI/180;var o,a=[],s=Math.asin(Math.sin(t)*Math.sin(r)-Math.cos(r)*Math.cos(t)*Math.cos(i));return o=this.poleVisibility(r,t)===!0&&t>=0?n===!0?Math.PI+Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e:-Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e:this.poleVisibility(r,t)===!0&&0>t?this.poleVisibility(r,t)===!0&&n===!0?Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e:Math.PI-Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e:-Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e,s=Math.round(180*s/Math.PI*10)/10,o=Math.round(180*o/Math.PI*10)/10,a.push(s,o),a},t.prototype.poleVisibility=function(t,e){var r=180*t/Math.PI,i=180*e/Math.PI;return i>=0?90-r+i>90:90-r-i>90},t}),i("../src/scripts/map/VisibleArea",["./BoundingBox","./CoordConversions","../../worldwind/WorldWind"],function(t,e){var r=WorldWind.Vec2,i=function(t){this._viewport=t.viewport,this._eyeGeoCoord=t.eyeGeoCoord,this._range=t.range,this._worldWindow=t.wwd,this._conversions=new e};return i.prototype.getPosition=function(t){var e=this._worldWindow.pickTerrain(t).objects;return e.length>0?e[0].position:null},i.prototype.visibilityStatus=function(){var t=this.getPosition([1,1]),e=this.getPosition([this._viewport().width-1,this._viewport().height/2]),r=this.getPosition([this._viewport().width/2,this._viewport().height-1]),i=this.getPosition([1,this._viewport().height/2]);
return null==t&&null==e&&null==r&&null==i?0:null!=t&&null!=e&&null!=r&&null!=i?2:1},i.prototype.getVisibleArea4FullViewport=function(){for(var t=this._viewport(),e=t.width-2,i=t.height-2,n=2,o=[],a=[],s=0;n>s;s++)o[s]=new r(1+s*(e/n),1),o[s+n]=new r(1+e,1+s*(i/n)),o[s+2*n]=new r(2+e-(1+s*(e/n)),1+i),o[s+3*n]=new r(1,2+i-(1+s*(i/n)));for(var l=0;l<o.length;l++){var u=this.getPosition(o[l]);null!=u&&a.push([Math.round(10*u.latitude)/10,Math.round(10*u.longitude)/10])}return this.inBoundingBox(a)},i.prototype.getVisibleArea4PartGlobe=function(){for(var t=this._viewport(),e=t.width-2,i=t.height-2,n=10,o=[],a=0;n+1>a;a++)for(var s=0;n+1>s;s++){var l=new r(1+s*(e/n),1+a*(i/n)),u=this.getPosition(l);null!=u&&o.push([Math.round(u.latitude),Math.round(u.longitude)])}return this.inBoundingBox(o)},i.prototype.getVisibleArea4FullGlobe=function(){for(var t=6378e3,e={lat:this._eyeGeoCoord().latitude,lon:this._eyeGeoCoord().longitude},r={lat:Math.asin(t/(t+this._range())),lon:[0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350]},i=[],n=!1,o=360,a=0;a<r.lon.length;a++)i[a]=this._conversions.carto2geoConversion(e.lat,e.lon,r.lat,r.lon[a],n),n=0==n?i[a][1]>o:i[a][1]<o,i[a]=this._conversions.carto2geoConversion(e.lat,e.lon,r.lat,r.lon[a],n),o=i[a][1],i[a][1]=this._conversions.transformVisibleToBoundaries(i[a][1]);return this.inBoundingBox(i)},i.prototype.inBoundingBox=function(e){var r=-90,i=90,n=180,o=-180,a=this.visibilityStatus();return this._conversions.isDatelineInViewport(e)?(n=180,o=-180,e.forEach(function(t){var e=t[0],a=t[1];e>r&&(r=e),i>e&&(i=e),n>a&&a>0&&(n=a),a>o&&0>a&&(o=a)})):e.forEach(function(t){var e=t[0],a=t[1];e>r&&(r=e),i>e&&(i=e),n>a&&(n=a),a>o&&(o=a)}),2==a?"north"==this._conversions.isPoleInViewport(e)?(r=90,n=-180,o=180):"south"==this._conversions.isPoleInViewport(e)&&(i=-90,n=-180,o=180):0==a?"north"==this._conversions.isPoleVisible(e)?(r=90,n=-180,o=180):"south"==this._conversions.isPoleVisible(e)&&(i=-90,n=-180,o=180):1==a&&(r+=5,i-=5,n-=5,o+=5,r>84?(r=90,n=-180,o=180):-84>i&&(i=-90,n=-180,o=180)),new t(i,n,r,o)},i}),i("../src/scripts/navigator/MoveNavigator",["../map/VisibleArea","../../worldwind/navigate/LookAt"],function(t,e){var r=e,i=function(e){r.call(this,e.wwd),this._lastRange=0,this._zoomLevelListeners=e.zoomLevelListeners||[],this._zoomLevel=10,this._viewPortChangeListeners=e.viewPortChangedListeners||[],this.range=23440143,this.worldWindow=e.wwd,this.lookAtLocation={},this.lookAtLocation.latitude=10,this.lookAtLocation.longitude=15;var i=this;this._visibleArea=new t({viewport:function(){return i.worldWindow.viewport},eyeGeoCoord:function(){return i.lookAtLocation},range:function(){return i.range},wwd:i.worldWindow})};return i.prototype=Object.create(r.prototype),i.prototype.handleWheelEvent=function(t){r.prototype.handleWheelEvent.apply(this,arguments);var e=this._zoomLevel;e!=this.getZoomLevel()&&this.callListeners(this._zoomLevelListeners),this._lastRange=this.range},i.prototype.getRange=function(){return this.range},i.prototype.getZoomLevel=function(){var t=1e6,e=[.8*t,2*t,5*t,10*t];return this.getRange()<e[0]&&this._lastRange>e[0]&&(this._zoomLevel=1),this.getRange()>e[0]&&this.getRange()<e[1]&&(this._lastRange<e[0]||this._lastRange>e[1])&&(this._zoomLevel=2),this.getRange()>e[1]&&this.getRange()<e[2]&&(this._lastRange<e[1]||this._lastRange>e[2])&&(this._zoomLevel=5),this.getRange()>e[2]&&this.getRange()<e[3]&&(this._lastRange<e[2]||this._lastRange>e[3])&&(this._zoomLevel=10),this.getRange()>e[e.length-1]&&this._lastRange<e[e.length-1]&&(this._zoomLevel=20),this._zoomLevel},r.prototype.handlePanOrDrag=function(t){this.worldWindow.globe.is2D()?this.handlePanOrDrag2D(t):this.handlePanOrDrag3D(t)},r.prototype.handlePanOrDrag3D=function(t){var e=t.state,r=t.translationX,i=t.translationY;if(e==WorldWind.BEGAN)this.lastPoint.set(0,0);else if(e==WorldWind.CHANGED){var n=this.worldWindow.canvas,o=this.worldWindow.globe,a=WorldWind.WWMath.max(o.equatorialRadius,o.polarRadius),s=WorldWind.WWMath.max(1,this.range),l=WorldWind.WWMath.perspectivePixelSize(n.clientWidth,n.clientHeight,s),u=(i-this.lastPoint[1])*l,c=-(r-this.lastPoint[0])*l,h=u/a*WorldWind.Angle.RADIANS_TO_DEGREES,f=c/a*WorldWind.Angle.RADIANS_TO_DEGREES,d=Math.sin(this.heading*WorldWind.Angle.DEGREES_TO_RADIANS),p=Math.cos(this.heading*WorldWind.Angle.DEGREES_TO_RADIANS);this.lookAtLocation.latitude+=h*p-f*d,this.lookAtLocation.longitude+=h*d+f*p,this.lastPoint.set(r,i),this.applyLimits(),this.worldWindow.redraw()}},r.prototype.handlePanOrDrag2D=function(t){var e=t.state,r=t.clientX,i=t.clientY,n=t.translationX,o=t.translationY;if(e==WorldWind.BEGAN)this.beginPoint.set(r,i),this.lastPoint.set(r,i);else if(e==WorldWind.CHANGED){var a=this.lastPoint[0],s=this.lastPoint[1],l=this.beginPoint[0]+n,u=this.beginPoint[1]+o;this.lastPoint.set(l,u);var c=this.currentState(),h=this.worldWindow.globe,f=c.rayFromScreenPoint(this.worldWindow.canvasCoordinates(a,s)),d=new Vec3(0,0,0),p=new Vec3(0,0,0),m=new Vec3(0,0,0);if(!h.intersectsLine(f,d))return;if(f=c.rayFromScreenPoint(this.worldWindow.canvasCoordinates(l,u)),!h.intersectsLine(f,p))return;var g=Matrix.fromIdentity();if(g.copy(c.modelview),g.multiplyByTranslation(p[0]-d[0],p[1]-d[1],p[2]-d[2]),g.extractEyePoint(f.origin),g.extractForwardVector(f.direction),!h.intersectsLine(f,m))return;var y=g.extractViewingParameters(m,this.roll,h,{});this.lookAtLocation.copy(y.origin),this.range=y.range,this.heading=y.heading,this.tilt=y.tilt,this.roll=y.roll,this.applyLimits(),this.worldWindow.redraw()}},i.prototype.getVisibleAreaBoundaries=function(){var t=this._visibleArea.visibilityStatus();return 0==t?this._visibleArea.getVisibleArea4FullGlobe():1==t?this._visibleArea.getVisibleArea4PartGlobe():this._visibleArea.getVisibleArea4FullViewport()},i.prototype.callListeners=function(t){t.forEach(function(t){t()})},i}),i("../src/scripts/Controls",["../worldwind/navigate/LookAt"],function(t){"use strict";var e=function(t){this.wwd=t,this.exaggerationIncrement=.01,this.zoomIncrement=.08,this.headingIncrement=1,this.tiltIncrement=1,this.fieldOfViewIncrement=.1,this.panIncrement=.001,this.setupInteraction()};return e.prototype.setupInteraction=function(){$("#zoom-plus-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleZoomIn),mouseup:this.handleMouseEvent.bind(this,this.handleZoomIn)}),$("#zoom-minus-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleZoomOut),mouseup:this.handleMouseEvent.bind(this,this.handleZoomOut)}),$("#tilt-less-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleTiltUp),mouseup:this.handleMouseEvent.bind(this,this.handleTiltUp)}),$("#tilt-more-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleTiltDown),mouseup:this.handleMouseEvent.bind(this,this.handleTiltDown)}),$("#rotate-right-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleHeadingRight),mouseup:this.handleMouseEvent.bind(this,this.handleHeadingRight)}),$("#rotate-left-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleHeadingLeft),mouseup:this.handleMouseEvent.bind(this,this.handleHeadingLeft)}),$("#rotate-needle-control").on({mouseup:this.handleHeadingReset.bind(this)}),this.wwd.addEventListener("mousemove",this.handleManualRedraw.bind(this))},e.prototype.handleMouseEvent=function(t,e){e.type&&("mouseup"===e.type&&1===e.which||"touchend"===e.type||"touchcancel"===e.type)?this.handleOperationEnd(e):this.handleOperationStart(t,e)},e.prototype.handleOperationStart=function(t,e){if("mousedown"===e.type&&1===e.which||"touchstart"===e.type){this.activeOperation=t,e.preventDefault();var r=this,i=function(){r.activeOperation&&(t.call(r),setTimeout(i,50))};setTimeout(i,50)}},e.prototype.handleOperationEnd=function(t){this.activeOperation=null,t.preventDefault()},e.prototype.handleZoomIn=function(){var e=new t;this.wwd.navigator.getAsLookAt(this.wwd.globe,e);var r=this,i=function(){e.range*=1-r.zoomIncrement,r.wwd.navigator.setAsLookAt(r.wwd.globe,e),r.wwd.redraw()};this.heatmap&&this.heatmap(e.range),setTimeout(i,5)},e.prototype.handleZoomOut=function(){var e=new t;this.wwd.navigator.getAsLookAt(this.wwd.globe,e);var r=this,i=function(){e.range*=1+r.zoomIncrement,r.wwd.navigator.setAsLookAt(r.wwd.globe,e),r.wwd.redraw()};this.heatmap&&this.heatmap(e.range),setTimeout(i,5)},e.prototype.handleHeadingRight=function(){this.wwd.navigator.heading-=this.headingIncrement,this.wwd.redraw(),this.redrawHeadingIndicator()},e.prototype.handleHeadingLeft=function(){this.wwd.navigator.heading+=this.headingIncrement,this.wwd.redraw(),this.redrawHeadingIndicator()},e.prototype.handleHeadingReset=function(){var t=1;Math.abs(this.wwd.navigator.heading)>60?t=2:Math.abs(this.wwd.navigator.heading)>120&&(t=3),this.wwd.navigator.heading>0&&(t=-t);var e=this,r=function(){Math.abs(e.wwd.navigator.heading)>Math.abs(t)?(e.wwd.navigator.heading+=t,e.wwd.redraw(),e.redrawHeadingIndicator(),setTimeout(r,10)):(e.wwd.navigator.heading=0,e.wwd.redraw(),e.redrawHeadingIndicator())};setTimeout(r,10)},e.prototype.redrawHeadingIndicator=function(){var t=45,e=this.wwd.navigator.heading,r=0-e-t;$("#rotate-needle-control").find("i").css("transform","rotate("+r+"deg)")},e.prototype.handleTiltUp=function(){this.wwd.navigator.tilt=Math.max(0,this.wwd.navigator.tilt-this.tiltIncrement),this.wwd.redraw()},e.prototype.handleTiltDown=function(){this.wwd.navigator.tilt=Math.min(90,this.wwd.navigator.tilt+this.tiltIncrement),this.wwd.redraw()},e.prototype.handleManualRedraw=function(t){t.which&&(this._lastHeading=this._lastHeading||0,this.wwd.navigator.heading!=this._lastHeading&&this.redrawHeadingIndicator(),this._lastHeading=this.wwd.navigator.heading)},e}),i("../src/scripts/util/ServersPanel",[],function(){"use strict";var t=function(t,e){var r=this;this.wwd=t,this.idCounter=1,this.legends={},$("#addServerBox").find("button").on("click",function(t){r.onAddServerButton(t)}),$("#addServerText").on("keypress",function(t){r.onAddServerTextKeyPress($(this),t)})};return t.prototype.onAddServerButton=function(t){this.attachServer($("#addServerText")[0].value),$("#addServerText").val("")},t.prototype.onAddServerTextKeyPress=function(t,e){13===e.keyCode&&(t.blur(),this.attachServer($("#addServerText")[0].value),$("#addServerText").val(""))},t.prototype.attachServer=function(t){if(t){t=t.trim(),t=t.replace("Http","http"),0!=t.lastIndexOf("http",0)&&(t="http://"+t);var e=this,r=new XMLHttpRequest,i=WorldWind.WmsUrlBuilder.fixGetMapString(t);i+="service=WMS&request=GetCapabilities&vers",r.open("GET",i,!0),r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var i=r.responseXML;if(i||0!==r.responseText.indexOf("<?xml")||(i=(new window.DOMParser).parseFromString(r.responseText,"text/xml")),!i)return void alert(t+" retrieval failed. It is probably not a WMS server.");var n=new WorldWind.WmsCapabilities(i);n.version?e.addServerPanel(t,n):alert(t+" WMS capabilities document invalid. The server is probably not a WMS server.")}else 4===r.readyState&&(r.statusText?alert(r.responseURL+" "+r.status+" ("+r.statusText+")"):alert("Failed to retrieve WMS capabilities from "+t+"."))},r.send(null)}},t.prototype.addServerPanel=function(t,e){var r=this.idCounter++,i=this.idCounter++,n=this.idCounter++,o=e.service,a=o.title&&o.title.length>0?o.title:t,s=$('<div class="panel panel-default"></div>'),l=$('<div class="panel-heading" role="tab" id="'+i+'"></div>'),u=$('<h4 class="panel-title wrap-panel-heading"></h4>'),c=$('<a data-toggle="collapse" href="#'+n+'" aria-expanded="true" aria-controls="'+n+'">'+a+"</a>"),h=$('<a href="#"><small><span class="pull-right  clickable_space"></span></small></a>'),f=$('<div id="'+n+'" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="'+i+'"></div>'),d=$('<div style="max-height: 250px; overflow-y: scroll; -webkit-overflow-scrolling: touch;"></div>'),p=this.makeTree(t,r);h.on("click",function(){s.remove()}),u.append(c),u.append(h),l.append(u),s.append(l),d.append(p),f.append(d),s.append(f);var m=$("#servers");m.append(s);var g=p.fancytree("getRootNode"),y=e.capability.layers;1!==y.length||!y[0].layers||y[0].title!==e.service.title||y[0].name&&y[0].name.length>0||(y=y[0].layers),g.addChildren(this.assembleLayers(y,[]));var v=0;g.visit(function(t){++v}),v>10&&g.visit(function(t){t.setExpanded(!1)})},t.prototype.makeTree=function(t,e){var r=this,i="treeDiv"+e,n="treeData"+e,o=$('<div id="'+i+'">'),a=$('<ul id="'+n+'style="display: none;">');return o.append(a),o.fancytree({click:function(t,e){var r=e.node,i=r.data.layer;return i?(r.setSelected(!1),!1):void 0},select:function(t,e){var i=e.node,n=i.data.layer;return n?i.selected||(i.data.layer=null,r.removeLayer(n)):i.selected&&i.data.layerCaps&&i.data.layerCaps.name&&(i.data.layer=r.addLayer(i.data.layerCaps)),r.wwd.redraw(),!1}}),o.fancytree("option","checkbox",!0),o.fancytree("option","icons",!1),$("form").submit(!1),o},t.prototype.assembleLayers=function(t,e){for(var r=0;r<t.length;r++){var i=t[r],n=null,o={title:i.title,tooltip:i.title,layerCaps:i};i.layers&&i.layers.length>0&&(n=this.assembleLayers(i.layers,[])),i.name||(o.expanded=!0,o.unselectable=!0,o.hideCheckbox=!0,o.folder=!0),n&&(o.children=n),e.push(o)}return e},t.prototype.addLayer=function(t){if(t.name){var e,r=WorldWind.WmsLayer.formLayerConfiguration(t,null);if(r.timeSequences&&r.timeSequences[r.timeSequences.length-1]instanceof WorldWind.PeriodicTimeSequence){var i=r.timeSequences[r.timeSequences.length-1];r.levelZeroDelta=new WorldWind.Location(180,180),e=new WorldWind.WmsTimeDimensionedLayer(r),e.opacity=.8,e.time=i.startTime,e.timeSequence=i}else r.timeSequences&&r.timeSequences[r.timeSequences.length-1]instanceof Date?(i=r.timeSequences[r.timeSequences.length-1],r.levelZeroDelta=new WorldWind.Location(180,180),e=new WorldWind.WmsTimeDimensionedLayer(r),e.opacity=.8,e.time=r.timeSequences[0],e.timeSequence=i):e=new WorldWind.WmsLayer(r,null);return t.styles&&t.styles.length>0&&t.styles[0].legendUrls&&t.styles[0].legendUrls.length>0&&(e.companionLayer=this.addLegend(t.styles[0].legendUrls[0])),e.enabled=!0,this.wwd.addLayer(e),this.wwd.redraw(),e}return null},t.prototype.removeLayer=function(t){this.removeLegend(t.companionLayer),this.wwd.removeLayer(t),this.timeSeriesPlayer&&this.timeSeriesPlayer.layer===t&&(this.timeSeriesPlayer.timeSequence=null,this.timeSeriesPlayer.layer=null),this.wwd.redraw()},t.prototype.addLegend=function(t){var e=this.legends[t.url];if(e)++e.refCount,e.layer.enabled=!0;else{e={refCount:1,legendCaps:t},e.layer=new WorldWind.RenderableLayer;var r=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0),i=new WorldWind.ScreenImage(r,t.url);i.imageOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_INSET_PIXELS,0),e.layer.addRenderable(i),e.layer.hide=!0,e.layer.refCount=0,this.wwd.addLayer(e.layer),this.legends[t.url]=e,this.updateLegendOffsets()}return++e.layer.refCount,e.layer},t.prototype.removeLegend=function(t){for(var e in this.legends)if(this.legends.hasOwnProperty(e)){var r=this.legends[e];if(r.layer===t){--r.refCount,--r.layer.refCount,r.refCount<=0&&(this.wwd.removeLayer(r.layer),delete this.legends[r.legendCaps.url]);break}}this.updateLegendOffsets()},t.prototype.updateLegendOffsets=function(){var t=0,e=5;for(var r in this.legends)if(this.legends.hasOwnProperty(r)){var i=this.legends[r],n=i.layer.renderables[0];n.screenOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_INSET_PIXELS,t),t+=i.legendCaps.height+e}},t}),i("../src/scripts/util/GeoJSONPanel",[],function(){var t=function(t){this.wwd=t,this.myJsons={};var e=this;this.index=0,$("#loadGeoJsonBtn").on("click",function(){e.addJSON(e.wwd)})};return t.prototype.addJSON=function(t){function e(e){var r=e.renderables[0].boundaries[0];t.goTo(r)}var r=new WorldWind.PlacemarkAttributes(null);r.imageScale=.05,r.imageColor=WorldWind.Color.WHITE,r.labelAttributes.offset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,1.5),r.imageSource=WorldWind.configuration.baseUrl+"images/white-dot.png";var i=function(t,e){var i={};if(t.isPointType()||t.isMultiPointType()){if(i.attributes=new WorldWind.PlacemarkAttributes(r),e&&(e.name||e.Name||e.NAME)&&(i.name=e.name||e.Name||e.NAME),e&&e.POP_MAX){var n=e.POP_MAX;i.attributes.imageScale=.01*Math.log(n)}}else t.isLineStringType()||t.isMultiLineStringType()?(i.attributes=new WorldWind.ShapeAttributes(null),i.attributes.drawOutline=!0,i.attributes.outlineColor=new WorldWind.Color(.1*i.attributes.interiorColor.red,.3*i.attributes.interiorColor.green,.7*i.attributes.interiorColor.blue,1),i.attributes.outlineWidth=1):(t.isPolygonType()||t.isMultiPolygonType())&&(i.attributes=new WorldWind.ShapeAttributes(null),i.attributes.interiorColor=new WorldWind.Color(.375+.5*Math.random(),.375+.5*Math.random(),.375+.5*Math.random(),.7),i.attributes.outlineColor=new WorldWind.Color(.5*i.attributes.interiorColor.red,.5*i.attributes.interiorColor.green,.5*i.attributes.interiorColor.blue,1));return i},n=new WorldWind.RenderableLayer("GeoJSON");n.index=this.index++,t.addLayer(n),this.myJsons[this.index]=n;var o=new WorldWind.GeoJSONParser(document.getElementById("geoJsonTxtArea").value);o.load(e,i,n),t.redraw(),this.createInterface(t)},t.prototype.createInterface=function(t){$("#GeoJSONList").html("");var e=this;for(var r in e.myJsons){var i=e.myJsons[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#GeoJSONList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myJsons[r]),$(this).remove(),delete e.myJsons[r],t.redraw()})}},t}),i("../src/scripts/util/GeoTIFFPanel",[],function(){var t=function(t){this.wwd=t,this.myTiff={};var e=this;this.index=0,$("#loadGeoTIFFBtn").on("click",function(){e.addTIFF(e.wwd)})};return t.prototype.addTIFF=function(t){var e=this,r=new WorldWind.RenderableLayer("GeoTiff");r.index=this.index++,this.myTiff[this.index]=r,$("#loading").show();var i=document.getElementById("geoTIFFTxtArea").value,n=new WorldWind.GeoTiffReader(i);try{n.readAsImage(function(i){var o=new WorldWind.SurfaceImage(n.metadata.bbox,new WorldWind.ImageSource(i));r.addRenderable(o),t.addLayer(r),t.redraw(),$("#loading").hide(),e.createInterface(t),t.goTo(new WorldWind.Position(n.metadata.bbox.minLatitude,n.metadata.bbox.minLongitude))})}catch(o){$("#loading").hide(),alert("Error occurred:"+o)}},t.prototype.createInterface=function(t){$("#GeoTIFFList").html("");var e=this;for(var r in e.myTiff){var i=e.myTiff[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#GeoTIFFList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myTiff[r]),$(this).remove(),delete e.myTiff[r],t.redraw()})}},t}),i("../src/scripts/util/KMLPanel",[],function(){var t=function(t,e){this.wwd=t,this.KmlFile=e,this.myKML={};var r=this;this.index=0,$("#loadKMLBtn").on("click",function(){r.addTIFF(r.wwd)})};return t.prototype.addTIFF=function(t){var e=this,r=new WorldWind.RenderableLayer("KML");r.index=this.index++,this.myKML[this.index]=r,$("#loading").show();try{var i=document.getElementById("KMLTxtArea").value,n=new this.KmlFile(i)}catch(o){$("#loading").hide(),alert("Error occurred:"+o)}n.then(function(i){r.addRenderable(i),t.addLayer(r),t.redraw(),$("#loading").hide(),e.createInterface(t);try{var n=i.node.children[0];n=$(n).find("Folder").children(),n=$(n).find("LookAt").children();var o=n[0].textContent,a=n[1].textContent;t.goTo(new WorldWind.Position(a,o))}catch(s){console.log("cannot find psoition of KML")}})},t.prototype.createInterface=function(t){$("#KMLList").html("");var e=this;for(var r in e.myKML){var i=e.myKML[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#KMLList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myKML[r]),$(this).remove(),delete e.myKML[r],t.redraw()})}},t}),i("../src/scripts/util/SurfaceImagePanel",[],function(){var t=function(t){this.wwd=t,this.mySurfaceImage={};var e=this;this.index=0,$("#loadSurfaceImageBtn").on("click",function(){e.addTIFF(e.wwd)})};return t.prototype.addTIFF=function(t){var e=this,r=new WorldWind.RenderableLayer("SurfaceImage");r.index=this.index++,this.mySurfaceImage[this.index]=r,$("#loading").show();try{var i=document.getElementById("SurfaceImageTxtArea").value,n=document.getElementById("minLat").value,o=document.getElementById("maxLat").value,a=document.getElementById("minLng").value,s=document.getElementById("maxLng").value,l=new WorldWind.SurfaceImage(new WorldWind.Sector(n,o,a,s),i);r.addRenderable(l),t.addLayer(r),t.redraw()}catch(u){$("#loading").hide(),alert("Error occurred:"+u)}$("#loading").hide(),e.createInterface(t),t.goTo(new WorldWind.Position(n,a))},t.prototype.createInterface=function(t){$("#SurfaceImageList").html("");var e=this;for(var r in e.mySurfaceImage){var i=e.mySurfaceImage[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#SurfaceImageList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.mySurfaceImage[r]),$(this).remove(),delete e.mySurfaceImage[r]})}},t}),i("../src/scripts/util/NDVIPanel",[],function(){var t=function(t,e){this.wwd=t,this.NDVILayers=[];var r=this;this.index=0,$("#loadNDVIBtn").on("click",function(){r.addSurface(r.wwd,e),$("#resetNDVIBtn").show(),$("#loadNDVIBtn").hide()}),$("#resetNDVIBtn").on("click",function(){for(var e in r.NDVILayers)t.removeLayer(r.NDVILayers[e]);$("#graph").hide(),$("#resetNDVIBtn").hide(),$("#loadNDVIBtn").show(),t.removeEventListener("click",r.handle),t.redraw()})};return t.prototype.addSurface=function(t,e){function r(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status){p=JSON.parse(e.response),$("#scene-date").val(c(p[0].filenameList[0]));for(var t=0;t<p.length;t++)p[t].paragraphId="p"+p[t].regionName,p[t].loadingStatus=0,i(p[t].paragraphId,p[t].regionName,p[t].loadingStatus,p[t].filenameList.length),o(p[t].url,p[t].regionName,p[t].filenameList[0],!0)}else console.log("retrieve failed")},e.onerror=function(){console.log("error")},e.ontimeout=function(){console.log("timeout")},e.send(null)}function i(t,e,r,i){var n=document.createElement("p");n.setAttribute("id",t),n.textContent=e+": "+r+"/"+i,document.getElementById("surfacesStatus").appendChild(n)}function n(t,e,r,i){$("#"+t).text("Loading "+e+": "+r+"/"+i)}function o(t,e,r,i){var t=t+r,n=new XMLHttpRequest;i?n.open("GET",t,!1):n.open("GET",t,!0),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var t=n.response.split("\n");if(0===b.filter(function(t){return t.regionName===e}).length){var i=Number(t.shift().replace(/  +/g," ").split(" ")[1]),o=Number(t.shift().replace(/  +/g," ").split(" ")[1]),s=Number(t.shift().replace(/  +/g," ").split(" ")[1]),l=Number(t.shift().replace(/  +/g," ").split(" ")[1]),c=Number(t.shift().replace(/  +/g," ").split(" ")[1]),h=Number(l+o*c),d=t.shift().replace(/  +/g," ").split(" ")[1],p=document.createElement("canvas");p.width=i,p.height=o;var m=p.getContext("2d"),g=m.createImageData(p.width,p.height);b.push({regionName:e,width:i,height:o,referenceX:s,referenceY:h,cellSize:c,noDataValue:d,imageList:[{filename:r,dataArray:t,imageData:g}],canvas:p,context2d:m,"loadingStatus:":0}),u(t,e,r,m,g,d)}else{t.splice(0,6);var y=f(b,"regionName",e),g=b[y].context2d.createImageData(b[y].canvas.width,b[y].canvas.height);b[y].imageList.push({filename:r,dataArray:t,imageData:g}),u(t,e,r,b[y].context2d,b[y].imageList[b[y].imageList.length-1].imageData,b[y].noDataValue),b[y].imageList.sort(a)}}else console.log("retrieve failed")},n.onerror=function(){console.log("error")},n.ontimeout=function(){console.log("timeout")},n.send(null)}function a(t,e){return t.filename<e.filename?-1:t.filename>e.filename?1:0}function s(t){for(var e=[],r=0;r<t.length;r++){var i=new WorldWind.RenderableLayer;i.displayName=t[r].regionName;var n=new WorldWind.SurfaceImage(new WorldWind.Sector(t[r].referenceY-t[r].height*t[r].cellSize,t[r].referenceY,t[r].referenceX,t[r].referenceX+t[r].width*t[r].cellSize),new WorldWind.ImageSource(t[r].canvas));n.displayName=t[r].regionName,i.addRenderable(n),e.push(i)}return e}function l(t,e){setTimeout(function(){o(p[t].url,p[t].regionName,p[t].filenameList[e],!1)},1e3*w++)}function u(e,r,i,o,a,u){var c=new Worker("src/scripts/util/CanvasWorker.js");c.onmessage=function(e){E++;var a=f(b,"regionName",r),u=f(b[a].imageList,"filename",i);if(b[a].imageList[u].imageData=e.data.imageData,b[a].imageList[u].dataArray=e.data.dataArray,p[a].loadingStatus++,n(p[a].paragraphId,p[a].regionName,p[a].loadingStatus,p[a].filenameList.length),E!==p.length||_)E<p.length&&!_&&o.putImageData(e.data.imageData,0,0);else{o.putImageData(e.data.imageData,0,0),x=s(b);for(var c=0;c<x.length;c++)$("#select-region").append($("<option>",{value:x[c].displayName,text:x[c].displayName})),m.NDVILayers.push(x[c]),t.addLayer(x[c]);t.goTo(new WorldWind.Position(41.77,12.77,4e4)),_=!0;for(var h=0;h<p.length;h++)for(var d=1;d<p[h].filenameList.length;d++)l(h,d)}},c.onerror=function(t){alert("Error: Line "+t.lineno+" in "+t.filename+": "+t.message)},c.postMessage({imageData:a,dataArray:e,colorPaletteArray:v,regionName:r,filename:i,noDataValue:u})}function c(t){var e=t.split("_")[4];return e.substring(0,4)+"/"+e.substring(4,6)+"/"+e.substring(6,8)}function h(e){for(var r=0;r<t.layers.length;r++)if(t.layers[r].displayName===$("#select-region").val())for(var i=0;i<t.layers[r].renderables.length;i++)t.layers[r].renderables[i].opacity=e;$("#transparency").val(e)}function f(t,e,r){return t.map(function(t){return t[e]}).indexOf(r)}function d(e){for(var r=0;r<t.layers.length;r++)if(t.layers[r].displayName===$("#select-region").val())try{var i=f(b,"regionName",t.layers[r].displayName);b[i].context2d.putImageData(b[i].imageList[e].imageData,0,0),t.layers[r].renderables[0].imageSource=new WorldWind.ImageSource(b[i].canvas);var n=b[i].imageList[e].filename;$("#scene-date").val(c(n)),t.redraw();break}catch(o){$("#loading").hide(),alert("Error occurred:"+o)}}var p,m=this,g=document.getElementById("NDVITxtArea").value,y=g,v=[0,25.5,.701,.921,1,1,25.5,51,1,1,.9412,1,51,76.5,1,1,.898,1,76.5,102,.9686,.9882,.7255,1,102,127.5,.851,.9412,.6392,1,127.5,153,.6784,.8667,.5569,1,153,175.5,.2549,.6706,.3647,1,175.5,204,.1373,.5176,.2627,1,204,229.5,0,.3529,.1608,1,229.5,255,0,.2706,.1608,1],E=0,w=0,b=[],x=[],_=!1;r(y);var S=function(e){var r=e.clientX,i=e.clientY,n=t.canvasCoordinates(r,i),o=t.pick(n);if(o.objects.length>0)for(var a=0;a<o.objects.length;a++)if(o.objects[a].userObject instanceof WorldWind.SurfaceImage&&o.objects[a].userObject.displayName===$("#select-region").val()){for(var s=f(b,"regionName",o.objects[a].userObject.displayName),l=b[s].referenceY,u=b[s].referenceX,h=b[s].cellSize,d=b[s].width,p=t.pickTerrain(n).terrainObject(),m=p.position.latitude,g=p.position.longitude,y=l-m,v=g-u,E=Math.round(v/h),w=Math.round(y/h),x=w*d+E,_=[],S=[],T=0;T<b[s].imageList.length;T++)b[s].imageList[T].dataArray[x]===b[s].noDataValue?_.push(0):_.push(b[s].imageList[T].dataArray[x]),S.push(c(b[s].imageList[T].filename));for(var L=[10,60,80,60],M=1e3-L[1]-L[3],A=300-L[0]-L[2],N=M/_.length,R=[],T=0;T<_.length;T++)R.push(T*N);var r=d3.scale.ordinal().domain(S).range(R),i=d3.scale.linear().domain([0,255]).range([A,0]),C=d3.svg.line().x(function(t,e){return r(e)}).y(function(t){return i(t)});d3.select("svg").remove(),d3.select("svg").remove();var P=d3.select("#graph").append("svg").attr("width",M+L[1]+L[3]).attr("height",A+L[0]+L[2]).append("svg:g").attr("transform","translate("+L[3]+","+L[0]+")"),O=d3.svg.axis().scale(r).tickSize(-A).tickSubdivide(!0);P.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+A+")").call(O).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-65)");var I=d3.svg.axis().scale(i).ticks(4).orient("left");P.append("svg:g").attr("class","y axis").attr("transform","translate(-25,0)").call(I),P.append("svg:path").attr("d",C(_)),$("#bottomMenu").show(),$("#graph").show()}};t.addEventListener("click",S),m.handle=S,$("#scene-slider").slider({orientation:"horizontal",range:"min",min:0,max:12,value:0,slide:function(t,e){d(e.value)}}),$("#transparency-slider").slider({orientation:"horizontal",range:"min",min:0,max:1,step:.01,value:1,slide:function(t,e){h(e.value)}}),$("#transparency").val(1),$("#select-region").change(function(){var t="";$("select option:selected").each(function(){t+=$(this).text()}),"Sicily"===t?e.goToAnimator.goTo(new WorldWind.Position(37.51,14,4e5)):"Rome"===t&&e.goToAnimator.goTo(new WorldWind.Position(41.77,12.77,4e4));for(var r=0;r<b.length;r++)if(b[r].regionName===t){$("#scene-slider").slider("option","max",b[r].imageList.length-1);break}}),m.createInterface(t)},t.prototype.createInterface=function(t){$("#NDVIList").html("");var e=this;for(var r in e.myNDVI){var i=e.myNDVI[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#NDVIList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myNDVI[r]),$(this).remove(),delete e.myNDVI[r]})}},t}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof i&&i.amd?i("../src/scripts/util/math",[],e):"object"==typeof exports?exports.math=e():t.math=e()}(this,function(){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){function i(t){var e=n.create(t);return e.create=i,e["import"](r(13)),e}var n=r(1);t.exports=i()},function(t,e,r){t.exports=r(2)},function(t,e,r){var i=r(3).isFactory,n=(r(3).deepExtend,r(4)),o=r(8),a=r(10),s=r(12);e.create=function(t){function e(t){if(!i(t))throw new Error("Factory object with properties `type`, `name`, and `factory` expected");var n,o=r.indexOf(t);return-1===o?(n=t.math===!0?t.factory(u.type,c,e,u.typed,u):t.factory(u.type,c,e,u.typed),r.push(t),l.push(n)):n=l[o],n}if("function"!=typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var r=[],l=[],u=o.mixin({});u.type={},u.expression={transform:Object.create(u)},u.typed=n.create(u.type);var c={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1};return u["import"]=e(a),u.config=e(s),t&&u.config(t),u}},function(t,e){"use strict";e.clone=function r(t){var e=typeof t;if("number"===e||"string"===e||"boolean"===e||null===t||void 0===t)return t;if("function"==typeof t.clone)return t.clone();if(Array.isArray(t))return t.map(function(t){return r(t)});if(t instanceof Number)return new Number(t.valueOf());if(t instanceof String)return new String(t.valueOf());if(t instanceof Boolean)return new Boolean(t.valueOf());if(t instanceof Date)return new Date(t.valueOf());if(t&&t.isBigNumber===!0)return t;if(t instanceof RegExp)throw new TypeError("Cannot clone "+t);var i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]=r(t[n]));return i},e.extend=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},e.deepExtend=function i(t,e){if(Array.isArray(e))throw new TypeError("Arrays are not supported by deepExtend");for(var r in e)if(e.hasOwnProperty(r))if(e[r]&&e[r].constructor===Object)void 0===t[r]&&(t[r]={}),t[r].constructor===Object?i(t[r],e[r]):t[r]=e[r];else{if(Array.isArray(e[r]))throw new TypeError("Arrays are not supported by deepExtend");t[r]=e[r]}return t},e.deepEqual=function(t,r){var i,n,o;if(Array.isArray(t)){if(!Array.isArray(r))return!1;if(t.length!=r.length)return!1;for(n=0,o=t.length;o>n;n++)if(!e.deepEqual(t[n],r[n]))return!1;return!0}if(t instanceof Object){if(Array.isArray(r)||!(r instanceof Object))return!1;for(i in t)if(!e.deepEqual(t[i],r[i]))return!1;for(i in r)if(!e.deepEqual(t[i],r[i]))return!1;
return!0}return typeof t==typeof r&&t==r},e.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},"x",{get:function(){}}),!0}catch(t){}return!1},e.lazy=function(t,r,i){if(e.canDefineProperty()){var n,o=!0;Object.defineProperty(t,r,{get:function(){return o&&(n=i(),o=!1),n},set:function(t){n=t,o=!1},configurable:!0,enumerable:!0})}else t[r]=i()},e.traverse=function(t,e){var r=t;if(e)for(var i=e.split("."),n=0;n<i.length;n++){var o=i[n];o in r||(r[o]={}),r=r[o]}return r},e.isFactory=function(t){return t&&"function"==typeof t.factory}},function(t,e,r){var i=r(5),n=r(6).digits,o=function(){return o=i.create,i};e.create=function(t){var e=o();return e.types=[{name:"number",test:function(t){return"number"==typeof t}},{name:"Complex",test:function(t){return t&&t.isComplex}},{name:"BigNumber",test:function(t){return t&&t.isBigNumber}},{name:"Fraction",test:function(t){return t&&t.isFraction}},{name:"Unit",test:function(t){return t&&t.isUnit}},{name:"string",test:function(t){return"string"==typeof t}},{name:"Array",test:Array.isArray},{name:"Matrix",test:function(t){return t&&t.isMatrix}},{name:"DenseMatrix",test:function(t){return t&&t.isDenseMatrix}},{name:"SparseMatrix",test:function(t){return t&&t.isSparseMatrix}},{name:"ImmutableDenseMatrix",test:function(t){return t&&t.isImmutableDenseMatrix}},{name:"Range",test:function(t){return t&&t.isRange}},{name:"Index",test:function(t){return t&&t.isIndex}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"ResultSet",test:function(t){return t&&t.isResultSet}},{name:"Help",test:function(t){return t&&t.isHelp}},{name:"function",test:function(t){return"function"==typeof t}},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],e.conversions=[{from:"number",to:"BigNumber",convert:function(e){if(n(e)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t.BigNumber(e)}},{from:"number",to:"Complex",convert:function(e){return new t.Complex(e,0)}},{from:"number",to:"string",convert:function(t){return t+""}},{from:"BigNumber",to:"Complex",convert:function(e){return new t.Complex(e.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return new t.Complex(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){if(n(e)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to Fraction (value: "+e+"). Use function fraction(x) to convert to Fraction.");return new t.Fraction(e)}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(e){return new t.BigNumber(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return new t.Fraction(+e)}},{from:"boolean",to:"string",convert:function(t){return+t}},{from:"null",to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},{from:"null",to:"BigNumber",convert:function(){return new t.BigNumber(0)}},{from:"null",to:"Fraction",convert:function(){return new t.Fraction(0)}},{from:"Array",to:"Matrix",convert:function(e){return new t.DenseMatrix(e)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}],e}},function(t,e,r){var i,n,o;!function(r,a){n=[],i=a,o="function"==typeof i?i.apply(e,n):i,!(void 0!==o&&(t.exports=o))}(this,function(){function t(){function e(t){for(var e,r=0;r<x.types.length;r++){var i=x.types[r];if(i.name===t){e=i.test;break}}if(!e){var n;for(r=0;r<x.types.length;r++)if(i=x.types[r],i.name.toLowerCase()==t.toLowerCase()){n=i.name;break}throw new Error('Unknown type "'+t+'"'+(n?'. Did you mean "'+n+'"?':""))}return e}function r(t){for(var e="",r=0;r<t.length;r++){var i=t[r];if(i.signatures&&""!=i.name)if(""==e)e=i.name;else if(e!=i.name){var n=new Error("Function names do not match (expected: "+e+", actual: "+i.name+")");throw n.data={actual:i.name,expected:e},n}}return e}function i(t,e,r,i,n){var o,a=p(i),s=n?n.split(","):null,l=t||"unnamed",u=s&&m(s,"any"),c={fn:t,index:r,actual:i,expected:s};o=s?e>r&&!u?"Unexpected type of argument in function "+l+" (expected: "+s.join(" or ")+", actual: "+a+", index: "+r+")":"Too few arguments in function "+l+" (expected: "+s.join(" or ")+", index: "+r+")":"Too many arguments in function "+l+" (expected: "+r+", actual: "+e+")";var h=new TypeError(o);return h.data=c,h}function n(t){this.name=t||"refs",this.categories={}}function o(t,e){if("string"==typeof t){var r=t.trim(),i="..."===r.substr(0,3);if(i&&(r=r.substr(3)),""===r)this.types=["any"];else{this.types=r.split("|");for(var n=0;n<this.types.length;n++)this.types[n]=this.types[n].trim()}}else{if(!Array.isArray(t)){if(t instanceof o)return t.clone();throw new Error("String or Array expected")}this.types=t}this.conversions=[],this.varArgs=i||e||!1,this.anyType=-1!==this.types.indexOf("any")}function a(t,e){var r;if("string"==typeof t)r=""!==t?t.split(","):[];else{if(!Array.isArray(t))throw new Error("string or Array expected");r=t}this.params=new Array(r.length);for(var i=0;i<r.length;i++){var n=new o(r[i]);if(this.params[i]=n,i===r.length-1)this.varArgs=n.varArgs;else if(n.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."')}this.fn=e}function s(t,e,r){this.path=t||[],this.param=t[t.length-1]||null,this.signature=e||null,this.childs=r||[]}function l(t){var e,r,i={},n=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];if(e=new a(o,s),e.ignore())continue;var l=e.expand();for(r=0;r<l.length;r++){var u=l[r],c=u.toString(),h=i[c];if(h){var f=a.compare(u,h);if(0>f)i[c]=u;else if(0===f)throw new Error('Signature "'+c+'" is defined twice')}else i[c]=u}}for(c in i)i.hasOwnProperty(c)&&n.push(i[c]);for(n.sort(function(t,e){return a.compare(t,e)}),r=0;r<n.length;r++)if(e=n[r],e.varArgs)for(var d=e.params.length-1,p=e.params[d],g=0;g<p.types.length;){if(p.conversions[g])for(var y=p.types[g],v=0;v<n.length;v++){var E=n[v],w=E.params[d];if(E!==e&&w&&m(w.types,y)&&!w.conversions[d]){p.types.splice(g,1),p.conversions.splice(g,1),g--;break}}g++}return n}function u(t){for(var e={},r=0;r<t.length;r++){var i=t[r];if(i.fn&&!i.hasConversions()){var n=i.params.join(",");e[n]=i.fn}}return e}function c(t,e){var r,i,n,a=e.length,l=[];for(r=0;r<t.length;r++)i=t[r],i.params.length!==a||n||(n=i),void 0!=i.params[a]&&l.push(i);l.sort(function(t,e){return o.compare(t.params[a],e.params[a])});var u=[];for(r=0;r<l.length;r++){i=l[r];var h=i.params[a],f=u.filter(function(t){return t.param.overlapping(h)})[0];if(f){if(f.param.varArgs)throw new Error('Conflicting types "'+f.param+'" and "'+h+'"');f.signatures.push(i)}else u.push({param:h,signatures:[i]})}var d=new Array(u.length);for(r=0;r<u.length;r++){var p=u[r];d[r]=c(p.signatures,e.concat(p.param))}return new s(e,n,d)}function h(t){for(var e=[],r=0;t>r;r++)e[r]="arg"+r;return e}function f(t,e){var r=new n,o=l(e);if(0==o.length)throw new Error("No signatures provided");var a=c(o,[]),s=[],f=t||"",p=h(d(o));s.push("function "+f+"("+p.join(", ")+") {"),s.push('  "use strict";'),s.push("  var name = '"+f+"';"),s.push(a.toCode(r,"  ")),s.push("}");var m=[r.toCode(),"return "+s.join("\n")].join("\n"),g=new Function(r.name,"createError",m),y=g(r,i);return y.signatures=u(o),y}function d(t){for(var e=0,r=0;r<t.length;r++){var i=t[r].params.length;i>e&&(e=i)}return e}function p(t){for(var e,r=0;r<x.types.length;r++){var i=x.types[r];if("Object"===i.name)e=i;else if(i.test(t))return i.name}return e&&e.test(t)?e.name:"unknown"}function m(t,e){return-1!==t.indexOf(e)}function g(t,e){if(!t.signatures)throw new TypeError("Function is no typed-function");var r;if("string"==typeof e){r=e.split(",");for(var i=0;i<r.length;i++)r[i]=r[i].trim()}else{if(!Array.isArray(e))throw new TypeError("String array or a comma separated string expected");r=e}var n=r.join(","),o=t.signatures[n];if(o)return o;throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+r.join(", ")+"))")}function y(t,e){var r=p(t);if(e===r)return t;for(var i=0;i<x.conversions.length;i++){var n=x.conversions[i];if(n.from===r&&n.to===e)return n.convert(t)}throw new Error("Cannot convert from "+r+" to "+e)}n.prototype.add=function(t,e){var r=e||"fn";this.categories[r]||(this.categories[r]=[]);var i=this.categories[r].indexOf(t);return-1==i&&(i=this.categories[r].length,this.categories[r].push(t)),r+i},n.prototype.toCode=function(){var t=[],e=this.name+".categories",r=this.categories;for(var i in r)if(r.hasOwnProperty(i))for(var n=r[i],o=0;o<n.length;o++)t.push("var "+i+o+" = "+e+"['"+i+"']["+o+"];");return t.join("\n")},o.compare=function(t,e){if(t.anyType)return 1;if(e.anyType)return-1;if(m(t.types,"Object"))return 1;if(m(e.types,"Object"))return-1;if(t.hasConversions()){if(e.hasConversions()){var r,i,n;for(r=0;r<t.conversions.length;r++)if(void 0!==t.conversions[r]){i=t.conversions[r];break}for(r=0;r<e.conversions.length;r++)if(void 0!==e.conversions[r]){n=e.conversions[r];break}return x.conversions.indexOf(i)-x.conversions.indexOf(n)}return 1}if(e.hasConversions())return-1;var o,a;for(r=0;r<x.types.length;r++)if(x.types[r].name===t.types[0]){o=r;break}for(r=0;r<x.types.length;r++)if(x.types[r].name===e.types[0]){a=r;break}return o-a},o.prototype.overlapping=function(t){for(var e=0;e<this.types.length;e++)if(m(t.types,this.types[e]))return!0;return!1},o.prototype.clone=function(){var t=new o(this.types.slice(),this.varArgs);return t.conversions=this.conversions.slice(),t},o.prototype.hasConversions=function(){return this.conversions.length>0},o.prototype.contains=function(t){for(var e=0;e<this.types.length;e++)if(t[this.types[e]])return!0;return!1},o.prototype.toString=function(t){for(var e=[],r={},i=0;i<this.types.length;i++){var n=this.conversions[i],o=t&&n?n.to:this.types[i];o in r||(r[o]=!0,e.push(o))}return(this.varArgs?"...":"")+e.join("|")},a.prototype.clone=function(){return new a(this.params.slice(),this.fn)},a.prototype.expand=function(){function t(r,i){if(i.length<r.params.length){var n,s,l,u=r.params[i.length];if(u.varArgs){for(s=u.clone(),n=0;n<x.conversions.length;n++)if(l=x.conversions[n],!m(u.types,l.from)&&m(u.types,l.to)){var c=s.types.length;s.types[c]=l.from,s.conversions[c]=l}t(r,i.concat(s))}else{for(n=0;n<u.types.length;n++)t(r,i.concat(new o(u.types[n])));for(n=0;n<x.conversions.length;n++)l=x.conversions[n],!m(u.types,l.from)&&m(u.types,l.to)&&(s=new o(l.from),s.conversions[0]=l,t(r,i.concat(s)))}}else e.push(new a(i,r.fn))}var e=[];return t(this,[]),e},a.compare=function(t,e){if(t.params.length>e.params.length)return 1;if(t.params.length<e.params.length)return-1;var r,i=t.params.length,n=0,a=0;for(r=0;i>r;r++)t.params[r].hasConversions()&&n++,e.params[r].hasConversions()&&a++;if(n>a)return 1;if(a>n)return-1;for(r=0;r<t.params.length;r++){var s=o.compare(t.params[r],e.params[r]);if(0!==s)return s}return 0},a.prototype.hasConversions=function(){for(var t=0;t<this.params.length;t++)if(this.params[t].hasConversions())return!0;return!1},a.prototype.ignore=function(){for(var t={},e=0;e<x.ignore.length;e++)t[x.ignore[e]]=!0;for(e=0;e<this.params.length;e++)if(this.params[e].contains(t))return!0;return!1},a.prototype.toCode=function(t,e){for(var r=[],i=new Array(this.params.length),n=0;n<this.params.length;n++){var o=this.params[n],a=o.conversions[0];o.varArgs?i[n]="varArgs":a?i[n]=t.add(a.convert,"convert")+"(arg"+n+")":i[n]="arg"+n}var s=this.fn?t.add(this.fn,"signature"):void 0;return s?e+"return "+s+"("+i.join(", ")+"); // signature: "+this.params.join(", "):r.join("\n")},a.prototype.toString=function(){return this.params.join(", ")},s.prototype.toCode=function(t,r,i){var n=[];if(this.param){var o=this.path.length-1,a=this.param.conversions[0],s="// type: "+(a?a.from+" (convert to "+a.to+")":this.param);if(this.param.varArgs)if(this.param.anyType)n.push(r+"if (arguments.length > "+o+") {"),n.push(r+"  var varArgs = [];"),n.push(r+"  for (var i = "+o+"; i < arguments.length; i++) {"),n.push(r+"    varArgs.push(arguments[i]);"),n.push(r+"  }"),n.push(this.signature.toCode(t,r+"  ")),n.push(r+"}");else{for(var l=function(r,i){for(var n=[],o=0;o<r.length;o++)n[o]=t.add(e(r[o]),"test")+"("+i+")";return n.join(" || ")}.bind(this),u=this.param.types,c=[],h=0;h<u.length;h++)void 0===this.param.conversions[h]&&c.push(u[h]);n.push(r+"if ("+l(u,"arg"+o)+") { "+s),n.push(r+"  var varArgs = [arg"+o+"];"),n.push(r+"  for (var i = "+(o+1)+"; i < arguments.length; i++) {"),n.push(r+"    if ("+l(c,"arguments[i]")+") {"),n.push(r+"      varArgs.push(arguments[i]);");for(var h=0;h<u.length;h++){var f=this.param.conversions[h];if(f){var d=t.add(e(u[h]),"test"),p=t.add(f.convert,"convert");n.push(r+"    }"),n.push(r+"    else if ("+d+"(arguments[i])) {"),n.push(r+"      varArgs.push("+p+"(arguments[i]));")}}n.push(r+"    } else {"),n.push(r+"      throw createError(name, arguments.length, i, arguments[i], '"+c.join(",")+"');"),n.push(r+"    }"),n.push(r+"  }"),n.push(this.signature.toCode(t,r+"  ")),n.push(r+"}")}else if(this.param.anyType)n.push(r+"// type: any"),n.push(this._innerCode(t,r,i));else{var m=this.param.types[0],d="any"!==m?t.add(e(m),"test"):null;n.push(r+"if ("+d+"(arg"+o+")) { "+s),n.push(this._innerCode(t,r+"  ",i)),n.push(r+"}")}}else n.push(this._innerCode(t,r,i));return n.join("\n")},s.prototype._innerCode=function(t,e,r){var i,n=[];this.signature&&(n.push(e+"if (arguments.length === "+this.path.length+") {"),n.push(this.signature.toCode(t,e+"  ")),n.push(e+"}"));var o;for(i=0;i<this.childs.length;i++)if(this.childs[i].param.anyType){o=this.childs[i];break}for(i=0;i<this.childs.length;i++)n.push(this.childs[i].toCode(t,e,o));r&&!this.param.anyType&&n.push(r.toCode(t,e,o));var a=this._exceptions(t,e);return a&&n.push(a),n.join("\n")},s.prototype._exceptions=function(t,e){var r=this.path.length;if(0===this.childs.length)return[e+"if (arguments.length > "+r+") {",e+"  throw createError(name, arguments.length, "+r+", arguments["+r+"]);",e+"}"].join("\n");for(var i={},n=[],o=0;o<this.childs.length;o++){var a=this.childs[o];if(a.param)for(var s=0;s<a.param.types.length;s++){var l=a.param.types[s];l in i||a.param.conversions[s]||(i[l]=!0,n.push(l))}}return e+"throw createError(name, arguments.length, "+r+", arguments["+r+"], '"+n.join(",")+"');"};var v=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],E={},w=[],b=[],x={config:E,types:v,conversions:w,ignore:b};return x=f("typed",{Object:function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(t[i]);var n=r(e);return f(n,t)},"string, Object":f,"...Function":function(t){for(var e,i=r(t),n={},o=0;o<t.length;o++){var a=t[o];if("object"!=typeof a.signatures)throw e=new TypeError("Function is no typed-function (index: "+o+")"),e.data={index:o},e;for(var s in a.signatures)if(a.signatures.hasOwnProperty(s))if(n.hasOwnProperty(s)){if(a.signatures[s]!==n[s])throw e=new Error('Signature "'+s+'" is defined twice'),e.data={signature:s},e}else n[s]=a.signatures[s]}return f(i,n)}}),x.config=E,x.types=v,x.conversions=w,x.ignore=b,x.create=t,x.find=g,x.convert=y,x.addType=function(t){if(!t||"string"!=typeof t.name||"function"!=typeof t.test)throw new TypeError("Object with properties {name: string, test: function} expected");x.types.push(t)},x.addConversion=function(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");x.conversions.push(t)},x}return t()})},function(t,e,r){"use strict";var i=r(7);e.isNumber=function(t){return"number"==typeof t},e.isInteger=function(t){return isFinite(t)?t==Math.round(t):!1},e.sign=Math.sign||function(t){return t>0?1:0>t?-1:0},e.format=function(t,r){if("function"==typeof r)return r(t);if(t===1/0)return"Infinity";if(t===-(1/0))return"-Infinity";if(isNaN(t))return"NaN";var i="auto",n=void 0;switch(r&&(r.notation&&(i=r.notation),e.isNumber(r)?n=r:r.precision&&(n=r.precision)),i){case"fixed":return e.toFixed(t,n);case"exponential":return e.toExponential(t,n);case"engineering":return e.toEngineering(t,n);case"auto":return e.toPrecision(t,n,r&&r.exponential).replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", or "fixed".')}},e.toExponential=function(t,e){return new i(t).toExponential(e)},e.toEngineering=function(t,e){return new i(t).toEngineering(e)},e.toFixed=function(t,e){return new i(t).toFixed(e)},e.toPrecision=function(t,e,r){return new i(t).toPrecision(e,r)},e.digits=function(t){return t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length},e.DBL_EPSILON=Number.EPSILON||2.220446049250313e-16,e.nearlyEqual=function(t,r,i){if(null==i)return t==r;if(t==r)return!0;if(isNaN(t)||isNaN(r))return!1;if(isFinite(t)&&isFinite(r)){var n=Math.abs(t-r);return n<e.DBL_EPSILON?!0:n<=Math.max(Math.abs(t),Math.abs(r))*i}return!1}},function(t,e){"use strict";function r(t){var e=String(t).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number");var r=e[1],i=e[2],n=parseFloat(e[4]||"0"),o=i.indexOf(".");n+=-1!==o?o-1:i.length-1,this.sign=r,this.coefficients=i.replace(".","").replace(/^0*/,function(t){return n-=t.length,""}).replace(/0*$/,"").split("").map(function(t){return parseInt(t)}),0===this.coefficients.length&&(this.coefficients.push(0),n++),this.exponent=n}function i(t){for(var e=[],r=0;t>r;r++)e.push(0);return e}r.prototype.toEngineering=function(t){var e=this.roundDigits(t),r=e.exponent,n=e.coefficients,o=r%3===0?r:0>r?r-3-r%3:r-r%3,a=r>=0?r:Math.abs(o);n.length-1<a&&(n=n.concat(i(a-(n.length-1))));for(var s=Math.abs(r-o),l=1,u="";--s>=0;)l++;var c=n.slice(l).join(""),h=c.match(/[1-9]/)?"."+c:"";return u=n.slice(0,l).join("")+h,u+="e"+(r>=0?"+":"")+o.toString(),e.sign+u},r.prototype.toFixed=function(t){var e=this.roundDigits(this.exponent+1+(t||0)),r=e.coefficients,n=e.exponent+1,o=n+(t||0);return r.length<o&&(r=r.concat(i(o-r.length))),0>n&&(r=i(-n+1).concat(r),n=1),t&&r.splice(n,0,0===n?"0.":"."),this.sign+r.join("")},r.prototype.toExponential=function(t){var e=t?this.roundDigits(t):this.clone(),r=e.coefficients,n=e.exponent;r.length<t&&(r=r.concat(i(t-r.length)));var o=r.shift();return this.sign+o+(r.length>0?"."+r.join(""):"")+"e"+(n>=0?"+":"")+n},r.prototype.toPrecision=function(t,e){var r=e&&void 0!==e.lower?e.lower:.001,n=e&&void 0!==e.upper?e.upper:1e5,o=Math.abs(Math.pow(10,this.exponent));if(r>o||o>=n)return this.toExponential(t);var a=t?this.roundDigits(t):this.clone(),s=a.coefficients,l=a.exponent;s.length<t&&(s=s.concat(i(t-s.length))),s=s.concat(i(l-s.length+1+(s.length<t?t-s.length:0))),s=i(-l).concat(s);var u=l>0?l:0;return u<s.length-1&&s.splice(u+1,0,"."),this.sign+s.join("")},r.prototype.clone=function(){var t=new r("0");return t.sign=this.sign,t.coefficients=this.coefficients.slice(0),t.exponent=this.exponent,t},r.prototype.roundDigits=function(t){for(var e=this.clone(),r=e.coefficients;0>=t;)r.unshift(0),e.exponent++,t++;if(r.length>t){var i=r.splice(t,r.length-t);if(i[0]>=5){var n=t-1;for(r[n]++;10===r[n];)r.pop(),0===n&&(r.unshift(0),e.exponent++,n++),n--,r[n]++}}return e},t.exports=r},function(t,e,r){var i=r(9);e.mixin=function(t){var e=new i;return t.on=e.on.bind(e),t.off=e.off.bind(e),t.once=e.once.bind(e),t.emit=e.emit.bind(e),t}},function(t,e){function r(){}r.prototype={on:function(t,e,r){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){function i(){n.off(t,i),e.apply(r,arguments)}var n=this;return i._=e,this.on(t,i,r)},emit:function(t){var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),i=0,n=r.length;for(i;n>i;i++)r[i].fn.apply(r[i].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),i=r[t],n=[];if(i&&e)for(var o=0,a=i.length;a>o;o++)i[o].fn!==e&&i[o].fn._!==e&&n.push(i[o]);return n.length?r[t]=n:delete r[t],this}},t.exports=r},function(t,e,r){"use strict";function i(t,e,r,i,l){function u(t,e){var r=arguments.length;if(1!=r&&2!=r)throw new s("import",r,1,2);if(e||(e={}),o(t))d(t,e);else if(Array.isArray(t))t.forEach(function(t){u(t,e)});else if("object"==typeof t){for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];p(n)?c(i,n,e):o(t)?d(t,e):u(n,e)}}else if(!e.silent)throw new TypeError("Factory, Object, or Array expected")}function c(t,e,r){if(r.wrap&&"function"==typeof e&&(e=f(e)),m(l[t])&&m(e))return e=r.override?i(t,e.signatures):i(l[t],e),l[t]=e,h(t,e),void l.emit("import",t,function(){return e});if(void 0===l[t]||r.override)return l[t]=e,h(t,e),void l.emit("import",t,function(){return e});if(!r.silent)throw new Error('Cannot import "'+t+'": already exists')}function h(t,e){e&&"function"==typeof e.transform&&(l.expression.transform[t]=e.transform)}function f(t){var e=function(){for(var e=[],r=0,i=arguments.length;i>r;r++){var n=arguments[r];e[r]=n&&n.valueOf()}return t.apply(l,e)};return t.transform&&(e.transform=t.transform),e}function d(t,e){if("string"==typeof t.name){var o=t.name,s=t.path?a(l,t.path):l,u=s.hasOwnProperty(o)?s[o]:void 0,c=function(){var n=r(t);if(m(u)&&m(n))return e.override||(n=i(u,n)),n;if(void 0===u||e.override)return n;if(!e.silent)throw new Error('Cannot import "'+o+'": already exists')};t.lazy!==!1?n(s,o,c):s[o]=c(),l.emit("import",o,c,t.path)}else r(t)}function p(t){return"function"==typeof t||"number"==typeof t||"string"==typeof t||"boolean"==typeof t||null===t||t&&t.isUnit===!0||t&&t.isComplex===!0||t&&t.isBigNumber===!0||t&&t.isFraction===!0||t&&t.isMatrix===!0||t&&Array.isArray(t)===!0}function m(t){return"function"==typeof t&&"object"==typeof t.signatures}return u}var n=r(3).lazy,o=r(3).isFactory,a=r(3).traverse,s=(r(3).extend,r(11));e.math=!0,e.name="import",e.factory=i,e.lazy=!0},function(t,e){"use strict";function r(t,e,i,n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=i,this.max=n,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+i+(void 0!=n?"-"+n:"")+" expected)",this.stack=(new Error).stack}r.prototype=new Error,r.prototype.constructor=Error,r.prototype.name="ArgumentsError",r.prototype.isArgumentsError=!0,t.exports=r},function(t,e,r){"use strict";function i(t,e,r,i,n){function o(t){if(t){var r=s.clone(e);a(t,"matrix",l),a(t,"number",u),s.deepExtend(e,t);var i=s.clone(e);return n.emit("config",i,r),i}return s.clone(e)}var l=["Matrix","Array"],u=["number","BigNumber","Fraction"];return o.MATRIX=l,o.NUMBER=u,o}function n(t,e){return-1!==t.indexOf(e)}function o(t,e){return t.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())}function a(t,e,r){if(void 0!==t[e]&&!n(r,t[e])){var i=o(r,t[e]);-1!==i?(console.warn('Warning: Wrong casing for configuration option "'+e+'", should be "'+r[i]+'" instead of "'+t[e]+'".'),t[e]=r[i]):console.warn('Warning: Unknown value "'+t[e]+'" for configuration option "'+e+'". Available options: '+r.map(JSON.stringify).join(", ")+".")}}var s=r(3);e.name="config",e.math=!0,e.factory=i},function(t,e,r){t.exports=[r(14),r(100),r(102),r(336),r(502),r(504)]},function(t,e,r){t.exports=[r(15),r(20),r(21),r(26),r(33),r(37),r(70),r(71),r(73),r(74)]},function(t,e,r){t.exports=[r(16),r(18)]},function(t,e,r){function i(t,e,r,i,o){var a=n.clone({precision:e.precision});return a.prototype.type="BigNumber",a.prototype.isBigNumber=!0,a.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},a.fromJSON=function(t){return new a(t.value)},o.on("config",function(t,e){t.precision!==e.precision&&a.config({precision:t.precision})}),a}var n=r(17);e.name="BigNumber",e.path="type",e.factory=i,e.math=!0},function(t,e,r){var i;!function(n){"use strict";function o(t){var e,r,i,n=t.length-1,o="",a=t[0];if(n>0){for(o+=a,e=1;n>e;e++)i=t[e]+"",r=kt-i.length,r&&(o+=g(r)),o+=i;a=t[e],i=a+"",r=kt-i.length,r&&(o+=g(r))}else if(0===a)return"0";for(;a%10===0;)a/=10;return o+a}function a(t,e,r){if(t!==~~t||e>t||t>r)throw Error(Lt+t)}function s(t,e,r,i){var n,o,a,s;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=kt,n=0):(n=Math.ceil((e+1)/kt),e%=kt),o=Nt(10,kt-e),s=t[n]%o|0,null==i?3>e?(0==e?s=s/100|0:1==e&&(s=s/10|0),a=4>r&&99999==s||r>3&&49999==s||5e4==s||0==s):a=(4>r&&s+1==o||r>3&&s+1==o/2)&&(t[n+1]/o/100|0)==Nt(10,e-2)-1||(s==o/2||0==s)&&0==(t[n+1]/o/100|0):4>e?(0==e?s=s/1e3|0:1==e?s=s/100|0:2==e&&(s=s/10|0),a=(i||4>r)&&9999==s||!i&&r>3&&4999==s):a=((i||4>r)&&s+1==o||!i&&r>3&&s+1==o/2)&&(t[n+1]/o/1e3|0)==Nt(10,e-3)-1,a}function l(t,e,r){for(var i,n,o=[0],a=0,s=t.length;s>a;){for(n=o.length;n--;)o[n]*=e;for(o[0]+=Et.indexOf(t.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(void 0===o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}function u(t,e){var r,i,n=e.d.length;32>n?(r=Math.ceil(n/3),i=Math.pow(4,-r).toString()):(r=16,i="2.3283064365386962890625e-10"),t.precision+=r,e=L(t,1,e.times(i),new t(1));for(var o=r;o--;){var a=e.times(e);e=a.times(a).minus(a).times(8).plus(1)}return t.precision-=r,e}function c(t,e,r,i){var n,o,a,s,l,u,c,h,f,d=t.constructor;t:if(null!=e){if(h=t.d,!h)return t;for(n=1,s=h[0];s>=10;s/=10)n++;if(o=e-n,0>o)o+=kt,a=e,c=h[f=0],l=c/Nt(10,n-a-1)%10|0;else if(f=Math.ceil((o+1)/kt),s=h.length,f>=s){if(!i)break t;for(;s++<=f;)h.push(0);c=l=0,n=1,o%=kt,a=o-kt+1}else{for(c=s=h[f],n=1;s>=10;s/=10)n++;o%=kt,a=o-kt+n,l=0>a?0:c/Nt(10,n-a-1)%10|0}if(i=i||0>e||void 0!==h[f+1]||(0>a?c:c%Nt(10,n-a-1)),u=4>r?(l||i)&&(0==r||r==(t.s<0?3:2)):l>5||5==l&&(4==r||i||6==r&&(o>0?a>0?c/Nt(10,n-a):0:h[f-1])%10&1||r==(t.s<0?8:7)),1>e||!h[0])return h.length=0,u?(e-=t.e+1,h[0]=Nt(10,(kt-e%kt)%kt),t.e=-e||0):h[0]=t.e=0,t;if(0==o?(h.length=f,s=1,f--):(h.length=f+1,s=Nt(10,kt-o),h[f]=a>0?(c/Nt(10,n-a)%Nt(10,a)|0)*s:0),u)for(;;){if(0==f){for(o=1,a=h[0];a>=10;a/=10)o++;for(a=h[0]+=s,s=1;a>=10;a/=10)s++;o!=s&&(t.e++,h[0]==It&&(h[0]=1));break}if(h[f]+=s,h[f]!=It)break;h[f--]=0,s=1}for(o=h.length;0===h[--o];)h.pop()}return St&&(t.e>d.maxE?(t.d=null,t.e=NaN):t.e<d.minE&&(t.e=0,t.d=[0])),t}function h(t,e,r){if(!t.isFinite())return x(t);var i,n=t.e,a=o(t.d),s=a.length;return e?(r&&(i=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+g(i):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):0>n?(a="0."+g(-n-1)+a,r&&(i=r-s)>0&&(a+=g(i))):n>=s?(a+=g(n+1-s),r&&(i=r-n-1)>0&&(a=a+"."+g(i))):((i=n+1)<s&&(a=a.slice(0,i)+"."+a.slice(i)),r&&(i=r-s)>0&&(n+1===s&&(a+="."),a+=g(i))),a}function f(t,e){for(var r=1,i=t[0];i>=10;i/=10)r++;return r+e*kt-1}function d(t,e,r){if(e>Vt)throw St=!0,r&&(t.precision=r),Error(Mt);return c(new t(wt),e,1,!0)}function p(t,e,r){if(e>Ft)throw Error(Mt);return c(new t(bt),e,r,!0)}function m(t){var e=t.length-1,r=e*kt+1;if(e=t[e]){for(;e%10==0;e/=10)r--;for(e=t[0];e>=10;e/=10)r++}return r}function g(t){for(var e="";t--;)e+="0";return e}function y(t,e,r,i){var n,o=new t(1),a=Math.ceil(i/kt+4);for(St=!1;;){if(r%2&&(o=o.times(e),N(o.d,a)&&(n=!0)),r=At(r/2),0===r){r=o.d.length-1,n&&0===o.d[r]&&++o.d[r];break}e=e.times(e),N(e.d,a)}return St=!0,o}function v(t){return 1&t.d[t.d.length-1]}function E(t,e,r){for(var i,n=new t(e[0]),o=0;++o<e.length;){if(i=new t(e[o]),!i.s){n=i;break}n[r](i)&&(n=i)}return n}function w(t,e){var r,i,n,a,l,u,h,f=0,d=0,p=0,m=t.constructor,g=m.rounding,y=m.precision;if(!t.d||!t.d[0]||t.e>17)return new m(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(St=!1,h=y):h=e,u=new m(.03125);t.e>-2;)t=t.times(u),p+=5;for(i=Math.log(Nt(2,p))/Math.LN10*2+5|0,h+=i,r=a=l=new m(1),m.precision=h;;){if(a=c(a.times(t),h,1),r=r.times(++d),u=l.plus(Bt(a,r,h,1)),o(u.d).slice(0,h)===o(l.d).slice(0,h)){for(n=p;n--;)l=c(l.times(l),h,1);if(null!=e)return m.precision=y,l;if(!(3>f&&s(l.d,h-i,g,f)))return c(l,m.precision=y,g,St=!0);m.precision=h+=10,r=a=u=new m(1),d=0,f++}l=u}}function b(t,e){var r,i,n,a,l,u,h,f,p,m,g,y=1,v=10,E=t,w=E.d,x=E.constructor,_=x.rounding,S=x.precision;if(E.s<0||!w||!w[0]||!E.e&&1==w[0]&&1==w.length)return new x(w&&!w[0]?-1/0:1!=E.s?NaN:w?0:E);if(null==e?(St=!1,p=S):p=e,x.precision=p+=v,r=o(w),i=r.charAt(0),!(Math.abs(a=E.e)<15e14))return f=d(x,p+2,S).times(a+""),E=b(new x(i+"."+r.slice(1)),p-v).plus(f),x.precision=S,null==e?c(E,S,_,St=!0):E;for(;7>i&&1!=i||1==i&&r.charAt(1)>3;)E=E.times(t),r=o(E.d),i=r.charAt(0),y++;for(a=E.e,i>1?(E=new x("0."+r),a++):E=new x(i+"."+r.slice(1)),m=E,h=l=E=Bt(E.minus(1),E.plus(1),p,1),g=c(E.times(E),p,1),n=3;;){if(l=c(l.times(g),p,1),f=h.plus(Bt(l,new x(n),p,1)),o(f.d).slice(0,p)===o(h.d).slice(0,p)){if(h=h.times(2),0!==a&&(h=h.plus(d(x,p+2,S).times(a+""))),h=Bt(h,new x(y),p,1),null!=e)return x.precision=S,h;if(!s(h.d,p-v,_,u))return c(h,x.precision=S,_,St=!0);x.precision=p+=v,f=l=E=Bt(m.minus(1),m.plus(1),p,1),g=c(E.times(E),p,1),n=u=1}h=f,n+=2}}function x(t){return String(t.s*t.s/0)}function _(t,e){var r,i,n;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(0>r&&(r=i),r+=+e.slice(i+1),e=e.substring(0,i)):0>r&&(r=e.length),i=0;48===e.charCodeAt(i);i++);for(n=e.length;48===e.charCodeAt(n-1);--n);if(e=e.slice(i,n)){if(n-=i,t.e=r=r-i-1,t.d=[],i=(r+1)%kt,0>r&&(i+=kt),n>i){for(i&&t.d.push(+e.slice(0,i)),n-=kt;n>i;)t.d.push(+e.slice(i,i+=kt));e=e.slice(i),i=kt-e.length}else i-=n;for(;i--;)e+="0";t.d.push(+e),St&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function S(t,e){var r,i,n,o,a,s,u,c,h;if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(Ct.test(e))r=16,e=e.toLowerCase();else if(Rt.test(e))r=2;else{if(!Pt.test(e))throw Error(Lt+e);r=8}for(o=e.search(/p/i),o>0?(u=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),o=e.indexOf("."),a=o>=0,i=t.constructor,a&&(e=e.replace(".",""),s=e.length,o=s-o,n=y(i,new i(r),o,2*o)),c=l(e,r,It),h=c.length-1,o=h;0===c[o];--o)c.pop();return 0>o?new i(0*t.s):(t.e=f(c,h),t.d=c,St=!1,a&&(t=Bt(t,n,4*s)),u&&(t=t.times(Math.abs(u)<54?Math.pow(2,u):xt.pow(2,u))),St=!0,t)}function T(t,e){var r,i=e.d.length;if(3>i)return L(t,2,e,e);r=1.4*Math.sqrt(i),r=r>16?16:0|r,e=e.times(Math.pow(5,-r)),e=L(t,2,e,e);for(var n,o=new t(5),a=new t(16),s=new t(20);r--;)n=e.times(e),e=e.times(o.plus(n.times(a.times(n).minus(s))));return e}function L(t,e,r,i,n){var o,a,s,l,u=1,c=t.precision,h=Math.ceil(c/kt);for(St=!1,l=r.times(r),s=new t(i);;){if(a=Bt(s.times(l),new t(e++*e++),c,1),s=n?i.plus(a):i.minus(a),i=Bt(a.times(l),new t(e++*e++),c,1),a=s.plus(i),void 0!==a.d[h]){for(o=h;a.d[o]===s.d[o]&&o--;);if(-1==o)break}o=s,s=i,i=a,a=o,u++}return St=!0,a.d.length=h+1,a}function M(t,e){var r,i=e.s<0,n=p(t,t.precision,1),o=n.times(.5);if(e=e.abs(),e.lte(o))return gt=i?4:1,e;if(r=e.divToInt(n),r.isZero())gt=i?3:2;else{if(e=e.minus(r.times(n)),e.lte(o))return gt=v(r)?i?2:3:i?4:1,e;gt=v(r)?i?1:4:i?3:2}return e.minus(n).abs()}function A(t,e,r,i){var n,o,s,u,c,f,d,p,m,g=t.constructor,y=void 0!==r;if(y?(a(r,1,vt),void 0===i?i=g.rounding:a(i,0,8)):(r=g.precision,i=g.rounding),t.isFinite()){for(d=h(t),s=d.indexOf("."),y?(n=2,16==e?r=4*r-3:8==e&&(r=3*r-2)):n=e,s>=0&&(d=d.replace(".",""),
m=new g(1),m.e=d.length-s,m.d=l(h(m),10,n),m.e=m.d.length),p=l(d,10,n),o=c=p.length;0==p[--c];)p.pop();if(p[0]){if(0>s?o--:(t=new g(t),t.d=p,t.e=o,t=Bt(t,m,r,i,0,n),p=t.d,o=t.e,f=mt),s=p[r],u=n/2,f=f||void 0!==p[r+1],f=4>i?(void 0!==s||f)&&(0===i||i===(t.s<0?3:2)):s>u||s===u&&(4===i||f||6===i&&1&p[r-1]||i===(t.s<0?8:7)),p.length=r,f)for(;++p[--r]>n-1;)p[r]=0,r||(++o,p.unshift(1));for(c=p.length;!p[c-1];--c);for(s=0,d="";c>s;s++)d+=Et.charAt(p[s]);if(y){if(c>1)if(16==e||8==e){for(s=16==e?4:3,--c;c%s;c++)d+="0";for(p=l(d,n,e),c=p.length;!p[c-1];--c);for(s=1,d="1.";c>s;s++)d+=Et.charAt(p[s])}else d=d.charAt(0)+"."+d.slice(1);d=d+(0>o?"p":"p+")+o}else if(0>o){for(;++o;)d="0"+d;d="0."+d}else if(++o>c)for(o-=c;o--;)d+="0";else c>o&&(d=d.slice(0,o)+"."+d.slice(o))}else d=y?"0p+0":"0";d=(16==e?"0x":2==e?"0b":8==e?"0o":"")+d}else d=x(t);return t.s<0?"-"+d:d}function N(t,e){return t.length>e?(t.length=e,!0):void 0}function R(t){return new this(t).abs()}function C(t){return new this(t).acos()}function P(t){return new this(t).acosh()}function O(t,e){return new this(t).plus(e)}function I(t){return new this(t).asin()}function k(t){return new this(t).asinh()}function D(t){return new this(t).atan()}function V(t){return new this(t).atanh()}function F(t,e){t=new this(t),e=new this(e);var r,i=this.precision,n=this.rounding,o=i+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(r=e.s<0?p(this,i,n):new this(0),r.s=t.s):!t.d||e.isZero()?(r=p(this,o,1).times(.5),r.s=t.s):e.s<0?(this.precision=o,this.rounding=1,r=this.atan(Bt(t,e,o,1)),e=p(this,o,1),this.precision=i,this.rounding=n,r=t.s<0?r.minus(e):r.plus(e)):r=this.atan(Bt(t,e,o,1)):(r=p(this,o,1).times(e.s>0?.25:.75),r.s=t.s):r=new this(NaN),r}function G(t){return new this(t).cbrt()}function B(t){return c(t=new this(t),t.e+1,2)}function W(t){if(!t||"object"!=typeof t)throw Error(Tt+"Object expected");var e,r,i,n=["precision",1,vt,"rounding",0,8,"toExpNeg",-yt,0,"toExpPos",0,yt,"maxE",0,yt,"minE",-yt,0,"modulo",0,9];for(e=0;e<n.length;e+=3)if(void 0!==(i=t[r=n[e]])){if(!(At(i)===i&&i>=n[e+1]&&i<=n[e+2]))throw Error(Lt+r+": "+i);this[r]=i}if(t.hasOwnProperty(r="crypto"))if(void 0===(i=t[r]))this[r]=i;else{if(i!==!0&&i!==!1&&0!==i&&1!==i)throw Error(Lt+r+": "+i);this[r]=!(!i||!_t||!_t.getRandomValues&&!_t.randomBytes)}return this}function U(t){return new this(t).cos()}function j(t){return new this(t).cosh()}function z(t){function e(t){var r,i,n,o=this;if(!(o instanceof e))return new e(t);if(o.constructor=e,t instanceof e)return o.s=t.s,o.e=t.e,void(o.d=(t=t.d)?t.slice():t);if(n=typeof t,"number"===n){if(0===t)return o.s=0>1/t?-1:1,o.e=0,void(o.d=[0]);if(0>t?(t=-t,o.s=-1):o.s=1,t===~~t&&1e7>t){for(r=0,i=t;i>=10;i/=10)r++;return o.e=r,void(o.d=[t])}return 0*t!==0?(t||(o.s=NaN),o.e=NaN,void(o.d=null)):_(o,t.toString())}if("string"!==n)throw Error(Lt+t);return 45===t.charCodeAt(0)?(t=t.slice(1),o.s=-1):o.s=1,Ot.test(t)?_(o,t):S(o,t)}var r,i,n;if(e.prototype=Gt,e.ROUND_UP=0,e.ROUND_DOWN=1,e.ROUND_CEIL=2,e.ROUND_FLOOR=3,e.ROUND_HALF_UP=4,e.ROUND_HALF_DOWN=5,e.ROUND_HALF_EVEN=6,e.ROUND_HALF_CEIL=7,e.ROUND_HALF_FLOOR=8,e.EUCLID=9,e.config=W,e.clone=z,e.abs=R,e.acos=C,e.acosh=P,e.add=O,e.asin=I,e.asinh=k,e.atan=D,e.atanh=V,e.atan2=F,e.cbrt=G,e.ceil=B,e.cos=U,e.cosh=j,e.div=K,e.exp=q,e.floor=H,e.fromJSON=Y,e.hypot=$,e.ln=X,e.log=J,e.log10=Q,e.log2=Z,e.max=tt,e.min=et,e.mod=rt,e.mul=it,e.pow=nt,e.random=ot,e.round=at,e.sign=st,e.sin=lt,e.sinh=ut,e.sqrt=ct,e.sub=ht,e.tan=ft,e.tanh=dt,e.trunc=pt,void 0===t&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<n.length;)t.hasOwnProperty(i=n[r++])||(t[i]=this[i]);return e.config(t),e}function K(t,e){return new this(t).div(e)}function q(t){return new this(t).exp()}function H(t){return c(t=new this(t),t.e+1,3)}function Y(t){var e,r,i,n;if("string"!=typeof t||!t)throw Error(Lt+t);if(i=t.length,n=Et.indexOf(t.charAt(0)),1===i)return new this(n>81?[-1/0,1/0,NaN][n-82]:n>40?-(n-41):n);if(64&n)r=16&n,e=r?(7&n)-3:(15&n)-7,i=1;else{if(2===i)return n=88*n+Et.indexOf(t.charAt(1)),new this(n>=2816?-(n-2816)-41:n+41);if(r=32&n,!(31&n))return t=l(t.slice(1),88,10).join(""),new this(r?"-"+t:t);e=15&n,i=e+1,e=1===e?Et.indexOf(t.charAt(1)):2===e?88*Et.indexOf(t.charAt(1))+Et.indexOf(t.charAt(2)):+l(t.slice(1,i),88,10).join(""),16&n&&(e=-e)}return t=l(t.slice(i),88,10).join(""),e=e-t.length+1,t=t+"e"+e,new this(r?"-"+t:t)}function $(){var t,e,r=new this(0);for(St=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)r.d&&(r=r.plus(e.times(e)));else{if(e.s)return St=!0,new this(1/0);r=e}return St=!0,r.sqrt()}function X(t){return new this(t).ln()}function J(t,e){return new this(t).log(e)}function Z(t){return new this(t).log(2)}function Q(t){return new this(t).log(10)}function tt(){return E(this,arguments,"lt")}function et(){return E(this,arguments,"gt")}function rt(t,e){return new this(t).mod(e)}function it(t,e){return new this(t).mul(e)}function nt(t,e){return new this(t).pow(e)}function ot(t){var e,r,i,n,o=0,s=new this(1),l=[];if(void 0===t?t=this.precision:a(t,1,vt),i=Math.ceil(t/kt),this.crypto===!1)for(;i>o;)l[o++]=1e7*Math.random()|0;else if(_t&&_t.getRandomValues)for(e=_t.getRandomValues(new Uint32Array(i));i>o;)n=e[o],n>=429e7?e[o]=_t.getRandomValues(new Uint32Array(1))[0]:l[o++]=n%1e7;else if(_t&&_t.randomBytes){for(e=_t.randomBytes(i*=4);i>o;)n=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((127&e[o+3])<<24),n>=214e7?_t.randomBytes(4).copy(e,o):(l.push(n%1e7),o+=4);o=i/4}else{if(this.crypto)throw Error(Tt+"crypto unavailable");for(;i>o;)l[o++]=1e7*Math.random()|0}for(i=l[--o],t%=kt,i&&t&&(n=Nt(10,kt-t),l[o]=(i/n|0)*n);0===l[o];o--)l.pop();if(0>o)r=0,l=[0];else{for(r=-1;0===l[0];r-=kt)l.shift();for(i=1,n=l[0];n>=10;n/=10)i++;kt>i&&(r-=kt-i)}return s.e=r,s.d=l,s}function at(t){return c(t=new this(t),t.e+1,this.rounding)}function st(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function lt(t){return new this(t).sin()}function ut(t){return new this(t).sinh()}function ct(t){return new this(t).sqrt()}function ht(t,e){return new this(t).sub(e)}function ft(t){return new this(t).tan()}function dt(t){return new this(t).tanh()}function pt(t){return c(t=new this(t),t.e+1,1)}var mt,gt,yt=9e15,vt=1e9,Et="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%()*+,-./:;=?@[]^_`{|}~",wt="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",bt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",xt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-yt,maxE:yt,crypto:void 0},_t="undefined"!=typeof crypto?crypto:null,St=!0,Tt="[DecimalError] ",Lt=Tt+"Invalid argument: ",Mt=Tt+"Precision limit exceeded",At=Math.floor,Nt=Math.pow,Rt=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Ct=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Pt=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ot=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,It=1e7,kt=7,Dt=9007199254740991,Vt=wt.length-1,Ft=bt.length-1,Gt={};Gt.absoluteValue=Gt.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),c(t)},Gt.ceil=function(){return c(new this.constructor(this),this.e+1,2)},Gt.comparedTo=Gt.cmp=function(t){var e,r,i,n,o=this,a=o.d,s=(t=new o.constructor(t)).d,l=o.s,u=t.s;if(!a||!s)return l&&u?l!==u?l:a===s?0:!a^0>l?1:-1:NaN;if(!a[0]||!s[0])return a[0]?l:s[0]?-u:0;if(l!==u)return l;if(o.e!==t.e)return o.e>t.e^0>l?1:-1;for(i=a.length,n=s.length,e=0,r=n>i?i:n;r>e;++e)if(a[e]!==s[e])return a[e]>s[e]^0>l?1:-1;return i===n?0:i>n^0>l?1:-1},Gt.cosine=Gt.cos=function(){var t,e,r=this,i=r.constructor;return r.d?r.d[0]?(t=i.precision,e=i.rounding,i.precision=t+Math.max(r.e,r.sd())+kt,i.rounding=1,r=u(i,M(i,r)),i.precision=t,i.rounding=e,c(2==gt||3==gt?r.neg():r,t,e,!0)):new i(1):new i(NaN)},Gt.cubeRoot=Gt.cbrt=function(){var t,e,r,i,n,a,s,l,u,h,f=this,d=f.constructor;if(!f.isFinite()||f.isZero())return new d(f);for(St=!1,a=f.s*Math.pow(f.s*f,1/3),a&&Math.abs(a)!=1/0?i=new d(a.toString()):(r=o(f.d),t=f.e,(a=(t-r.length+1)%3)&&(r+=1==a||-2==a?"0":"00"),a=Math.pow(r,1/3),t=At((t+1)/3)-(t%3==(0>t?-1:2)),a==1/0?r="5e"+t:(r=a.toExponential(),r=r.slice(0,r.indexOf("e")+1)+t),i=new d(r),i.s=f.s),s=(t=d.precision)+3;;)if(l=i,u=l.times(l).times(l),h=u.plus(f),i=Bt(h.plus(f).times(l),h.plus(u),s+2,1),o(l.d).slice(0,s)===(r=o(i.d)).slice(0,s)){if(r=r.slice(s-3,s+1),"9999"!=r&&(n||"4999"!=r)){(!+r||!+r.slice(1)&&"5"==r.charAt(0))&&(c(i,t+1,1),e=!i.times(i).times(i).eq(f));break}if(!n&&(c(l,t+1,0),l.times(l).times(l).eq(f))){i=l;break}s+=4,n=1}return St=!0,c(i,t,d.rounding,e)},Gt.decimalPlaces=Gt.dp=function(){var t,e=this.d,r=NaN;if(e){if(t=e.length-1,r=(t-At(this.e/kt))*kt,t=e[t])for(;t%10==0;t/=10)r--;0>r&&(r=0)}return r},Gt.dividedBy=Gt.div=function(t){return Bt(this,new this.constructor(t))},Gt.dividedToIntegerBy=Gt.divToInt=function(t){var e=this,r=e.constructor;return c(Bt(e,new r(t),0,1,1),r.precision,r.rounding)},Gt.equals=Gt.eq=function(t){return 0===this.cmp(t)},Gt.floor=function(){return c(new this.constructor(this),this.e+1,3)},Gt.greaterThan=Gt.gt=function(t){return this.cmp(t)>0},Gt.greaterThanOrEqualTo=Gt.gte=function(t){var e=this.cmp(t);return 1==e||0===e},Gt.hyperbolicCosine=Gt.cosh=function(){var t,e,r,i,n,o=this,a=o.constructor,s=new a(1);if(!o.isFinite())return new a(o.s?1/0:NaN);if(o.isZero())return s;r=a.precision,i=a.rounding,a.precision=r+Math.max(o.e,o.sd())+4,a.rounding=1,n=o.d.length,32>n?(t=Math.ceil(n/3),e=Math.pow(4,-t).toString()):(t=16,e="2.3283064365386962890625e-10"),o=L(a,1,o.times(e),new a(1),!0);for(var l,u=t,h=new a(8);u--;)l=o.times(o),o=s.minus(l.times(h.minus(l.times(h))));return c(o,a.precision=r,a.rounding=i,!0)},Gt.hyperbolicSine=Gt.sinh=function(){var t,e,r,i,n=this,o=n.constructor;if(!n.isFinite()||n.isZero())return new o(n);if(e=o.precision,r=o.rounding,o.precision=e+Math.max(n.e,n.sd())+4,o.rounding=1,i=n.d.length,3>i)n=L(o,2,n,n,!0);else{t=1.4*Math.sqrt(i),t=t>16?16:0|t,n=n.times(Math.pow(5,-t)),n=L(o,2,n,n,!0);for(var a,s=new o(5),l=new o(16),u=new o(20);t--;)a=n.times(n),n=n.times(s.plus(a.times(l.times(a).plus(u))))}return o.precision=e,o.rounding=r,c(n,e,r,!0)},Gt.hyperbolicTangent=Gt.tanh=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+7,i.rounding=1,Bt(r.sinh(),r.cosh(),i.precision=t,i.rounding=e)):new i(r.s)},Gt.inverseCosine=Gt.acos=function(){var t,e=this,r=e.constructor,i=e.abs().cmp(1),n=r.precision,o=r.rounding;return-1!==i?0===i?e.isNeg()?p(r,n,o):new r(0):new r(NaN):e.isZero()?p(r,n+4,o).times(.5):(r.precision=n+6,r.rounding=1,e=e.asin(),t=p(r,n+4,o).times(.5),r.precision=n,r.rounding=o,t.minus(e))},Gt.inverseHyperbolicCosine=Gt.acosh=function(){var t,e,r=this,i=r.constructor;return r.lte(1)?new i(r.eq(1)?0:NaN):r.isFinite()?(t=i.precision,e=i.rounding,i.precision=t+Math.max(Math.abs(r.e),r.sd())+4,i.rounding=1,St=!1,r=r.times(r).minus(1).sqrt().plus(r),St=!0,i.precision=t,i.rounding=e,r.ln()):new i(r)},Gt.inverseHyperbolicSine=Gt.asinh=function(){var t,e,r=this,i=r.constructor;return!r.isFinite()||r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+2*Math.max(Math.abs(r.e),r.sd())+6,i.rounding=1,St=!1,r=r.times(r).plus(1).sqrt().plus(r),St=!0,i.precision=t,i.rounding=e,r.ln())},Gt.inverseHyperbolicTangent=Gt.atanh=function(){var t,e,r,i,n=this,o=n.constructor;return n.isFinite()?n.e>=0?new o(n.abs().eq(1)?n.s/0:n.isZero()?n:NaN):(t=o.precision,e=o.rounding,i=n.sd(),Math.max(i,t)<2*-n.e-1?c(new o(n),t,e,!0):(o.precision=r=i-n.e,n=Bt(n.plus(1),new o(1).minus(n),r+t,1),o.precision=t+4,o.rounding=1,n=n.ln(),o.precision=t,o.rounding=e,n.times(.5))):new o(NaN)},Gt.inverseSine=Gt.asin=function(){var t,e,r,i,n=this,o=n.constructor;return n.isZero()?new o(n):(e=n.abs().cmp(1),r=o.precision,i=o.rounding,-1!==e?0===e?(t=p(o,r+4,i).times(.5),t.s=n.s,t):new o(NaN):(o.precision=r+6,o.rounding=1,n=n.div(new o(1).minus(n.times(n)).sqrt().plus(1)).atan(),o.precision=r,o.rounding=i,n.times(2)))},Gt.inverseTangent=Gt.atan=function(){var t,e,r,i,n,o,a,s,l,u=this,h=u.constructor,f=h.precision,d=h.rounding;if(u.isFinite()){if(u.isZero())return new h(u);if(u.abs().eq(1)&&Ft>=f+4)return a=p(h,f+4,d).times(.25),a.s=u.s,a}else{if(!u.s)return new h(NaN);if(Ft>=f+4)return a=p(h,f+4,d).times(.5),a.s=u.s,a}for(h.precision=s=f+10,h.rounding=1,r=Math.min(28,s/kt+2|0),t=r;t;--t)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(St=!1,e=Math.ceil(s/kt),i=1,l=u.times(u),a=new h(u),n=u;-1!==t;)if(n=n.times(l),o=a.minus(n.div(i+=2)),n=n.times(l),a=o.plus(n.div(i+=2)),void 0!==a.d[e])for(t=e;a.d[t]===o.d[t]&&t--;);return r&&(a=a.times(2<<r-1)),St=!0,c(a,h.precision=f,h.rounding=d,!0)},Gt.isFinite=function(){return!!this.d},Gt.isInteger=Gt.isInt=function(){return!!this.d&&At(this.e/kt)>this.d.length-2},Gt.isNaN=function(){return!this.s},Gt.isNegative=Gt.isNeg=function(){return this.s<0},Gt.isPositive=Gt.isPos=function(){return this.s>0},Gt.isZero=function(){return!!this.d&&0===this.d[0]},Gt.lessThan=Gt.lt=function(t){return this.cmp(t)<0},Gt.lessThanOrEqualTo=Gt.lte=function(t){return this.cmp(t)<1},Gt.logarithm=Gt.log=function(t){var e,r,i,n,a,l,u,h,f=this,p=f.constructor,m=p.precision,g=p.rounding,y=5;if(null==t)t=new p(10),e=!0;else{if(t=new p(t),r=t.d,t.s<0||!r||!r[0]||t.eq(1))return new p(NaN);e=t.eq(10)}if(r=f.d,f.s<0||!r||!r[0]||f.eq(1))return new p(r&&!r[0]?-1/0:1!=f.s?NaN:r?0:1/0);if(e)if(r.length>1)a=!0;else{for(n=r[0];n%10===0;)n/=10;a=1!==n}if(St=!1,u=m+y,l=b(f,u),i=e?d(p,u+10):b(t,u),h=Bt(l,i,u,1),s(h.d,n=m,g))do if(u+=10,l=b(f,u),i=e?d(p,u+10):b(t,u),h=Bt(l,i,u,1),!a){+o(h.d).slice(n+1,n+15)+1==1e14&&(h=c(h,m+1,0));break}while(s(h.d,n+=10,g));return St=!0,c(h,m,g)},Gt.minus=Gt.sub=function(t){var e,r,i,n,o,a,s,l,u,h,d,p,m=this,g=m.constructor;if(t=new g(t),!m.d||!t.d)return m.s&&t.s?m.d?t.s=-t.s:t=new g(t.d||m.s!==t.s?m:NaN):t=new g(NaN),t;if(m.s!=t.s)return t.s=-t.s,m.plus(t);if(u=m.d,p=t.d,s=g.precision,l=g.rounding,!u[0]||!p[0]){if(p[0])t.s=-t.s;else{if(!u[0])return new g(3===l?-0:0);t=new g(m)}return St?c(t,s,l):t}if(r=At(t.e/kt),h=At(m.e/kt),u=u.slice(),o=h-r){for(d=0>o,d?(e=u,o=-o,a=p.length):(e=p,r=h,a=u.length),i=Math.max(Math.ceil(s/kt),a)+2,o>i&&(o=i,e.length=1),e.reverse(),i=o;i--;)e.push(0);e.reverse()}else{for(i=u.length,a=p.length,d=a>i,d&&(a=i),i=0;a>i;i++)if(u[i]!=p[i]){d=u[i]<p[i];break}o=0}for(d&&(e=u,u=p,p=e,t.s=-t.s),a=u.length,i=p.length-a;i>0;--i)u[a++]=0;for(i=p.length;i>o;){if(u[--i]<p[i]){for(n=i;n&&0===u[--n];)u[n]=It-1;--u[n],u[i]+=It}u[i]-=p[i]}for(;0===u[--a];)u.pop();for(;0===u[0];u.shift())--r;return u[0]?(t.d=u,t.e=f(u,r),St?c(t,s,l):t):new g(3===l?-0:0)},Gt.modulo=Gt.mod=function(t){var e,r=this,i=r.constructor;return t=new i(t),!r.d||!t.s||t.d&&!t.d[0]?new i(NaN):!t.d||r.d&&!r.d[0]?c(new i(r),i.precision,i.rounding):(St=!1,9==i.modulo?(e=Bt(r,t.abs(),0,3,1),e.s*=t.s):e=Bt(r,t,0,i.modulo,1),e=e.times(t),St=!0,r.minus(e))},Gt.naturalExponential=Gt.exp=function(){return w(this)},Gt.naturalLogarithm=Gt.ln=function(){return b(this)},Gt.negated=Gt.neg=function(){var t=new this.constructor(this);return t.s=-t.s,c(t)},Gt.plus=Gt.add=function(t){var e,r,i,n,o,a,s,l,u,h,d=this,p=d.constructor;if(t=new p(t),!d.d||!t.d)return d.s&&t.s?d.d||(t=new p(t.d||d.s===t.s?d:NaN)):t=new p(NaN),t;if(d.s!=t.s)return t.s=-t.s,d.minus(t);if(u=d.d,h=t.d,s=p.precision,l=p.rounding,!u[0]||!h[0])return h[0]||(t=new p(d)),St?c(t,s,l):t;if(o=At(d.e/kt),i=At(t.e/kt),u=u.slice(),n=o-i){for(0>n?(r=u,n=-n,a=h.length):(r=h,i=o,a=u.length),o=Math.ceil(s/kt),a=o>a?o+1:a+1,n>a&&(n=a,r.length=1),r.reverse();n--;)r.push(0);r.reverse()}for(a=u.length,n=h.length,0>a-n&&(n=a,r=h,h=u,u=r),e=0;n;)e=(u[--n]=u[n]+h[n]+e)/It|0,u[n]%=It;for(e&&(u.unshift(e),++i),a=u.length;0==u[--a];)u.pop();return t.d=u,t.e=f(u,i),St?c(t,s,l):t},Gt.precision=Gt.sd=function(t){var e,r=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(Lt+t);return r.d?(e=m(r.d),t&&r.e+1>e&&(e=r.e+1)):e=NaN,e},Gt.round=function(){var t=this,e=t.constructor;return c(new e(t),t.e+1,e.rounding)},Gt.sine=Gt.sin=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+Math.max(r.e,r.sd())+kt,i.rounding=1,r=T(i,M(i,r)),i.precision=t,i.rounding=e,c(gt>2?r.neg():r,t,e,!0)):new i(NaN)},Gt.squareRoot=Gt.sqrt=function(){var t,e,r,i,n,a,s=this,l=s.d,u=s.e,h=s.s,f=s.constructor;if(1!==h||!l||!l[0])return new f(!h||0>h&&(!l||l[0])?NaN:l?s:1/0);for(St=!1,h=Math.sqrt(+s),0==h||h==1/0?(e=o(l),(e.length+u)%2==0&&(e+="0"),h=Math.sqrt(e),u=At((u+1)/2)-(0>u||u%2),h==1/0?e="1e"+u:(e=h.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),i=new f(e)):i=new f(h.toString()),r=(u=f.precision)+3;;)if(a=i,i=a.plus(Bt(s,a,r+2,1)).times(.5),o(a.d).slice(0,r)===(e=o(i.d)).slice(0,r)){if(e=e.slice(r-3,r+1),"9999"!=e&&(n||"4999"!=e)){(!+e||!+e.slice(1)&&"5"==e.charAt(0))&&(c(i,u+1,1),t=!i.times(i).eq(s));break}if(!n&&(c(a,u+1,0),a.times(a).eq(s))){i=a;break}r+=4,n=1}return St=!0,c(i,u,f.rounding,t)},Gt.tangent=Gt.tan=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+10,i.rounding=1,r=r.sin(),r.s=1,r=Bt(r,new i(1).minus(r.times(r)).sqrt(),t+10,0),i.precision=t,i.rounding=e,c(2==gt||4==gt?r.neg():r,t,e,!0)):new i(NaN)},Gt.times=Gt.mul=function(t){var e,r,i,n,o,a,s,l,u,h=this,d=h.constructor,p=h.d,m=(t=new d(t)).d;if(t.s*=h.s,!(p&&p[0]&&m&&m[0]))return new d(!t.s||p&&!p[0]&&!m||m&&!m[0]&&!p?NaN:p&&m?0*t.s:t.s/0);for(r=At(h.e/kt)+At(t.e/kt),l=p.length,u=m.length,u>l&&(o=p,p=m,m=o,a=l,l=u,u=a),o=[],a=l+u,i=a;i--;)o.push(0);for(i=u;--i>=0;){for(e=0,n=l+i;n>i;)s=o[n]+m[i]*p[n-i-1]+e,o[n--]=s%It|0,e=s/It|0;o[n]=(o[n]+e)%It|0}for(;!o[--a];)o.pop();for(e?++r:o.shift(),i=o.length;!o[--i];)o.pop();return t.d=o,t.e=f(o,r),St?c(t,d.precision,d.rounding):t},Gt.toBinary=function(t,e){return A(this,2,t,e)},Gt.toDecimalPlaces=Gt.toDP=function(t,e){var r=this,i=r.constructor;return r=new i(r),void 0===t?r:(a(t,0,vt),void 0===e?e=i.rounding:a(e,0,8),c(r,t+r.e+1,e))},Gt.toExponential=function(t,e){var r,i=this,n=i.constructor;return void 0===t?r=h(i,!0):(a(t,0,vt),void 0===e?e=n.rounding:a(e,0,8),i=c(new n(i),t+1,e),r=h(i,!0,t+1)),i.isNeg()&&!i.isZero()?"-"+r:r},Gt.toFixed=function(t,e){var r,i,n=this,o=n.constructor;return void 0===t?r=h(n):(a(t,0,vt),void 0===e?e=o.rounding:a(e,0,8),i=c(new o(n),t+n.e+1,e),r=h(i,!1,t+i.e+1)),n.isNeg()&&!n.isZero()?"-"+r:r},Gt.toFraction=function(t){var e,r,i,n,a,s,l,u,c,h,f,d,p=this,g=p.d,y=p.constructor;if(!g)return new y(p);if(c=r=new y(1),i=u=new y(0),e=new y(i),a=e.e=m(g)-p.e-1,s=a%kt,e.d[0]=Nt(10,0>s?kt+s:s),null==t)t=a>0?e:c;else{if(l=new y(t),!l.isInt()||l.lt(c))throw Error(Lt+l);t=l.gt(e)?a>0?e:c:l}for(St=!1,l=new y(o(g)),h=y.precision,y.precision=a=g.length*kt*2;f=Bt(l,e,0,1,1),n=r.plus(f.times(i)),1!=n.cmp(t);)r=i,i=n,n=c,c=u.plus(f.times(n)),u=n,n=e,e=l.minus(f.times(n)),l=n;return n=Bt(t.minus(r),i,0,1,1),u=u.plus(n.times(c)),r=r.plus(n.times(i)),u.s=c.s=p.s,d=Bt(c,i,a,1).minus(p).abs().cmp(Bt(u,r,a,1).minus(p).abs())<1?[c,i]:[u,r],y.precision=h,St=!0,d},Gt.toHexadecimal=Gt.toHex=function(t,e){return A(this,16,t,e)},Gt.toJSON=function(){var t,e,r,i,n,a,s,u,c=this,h=c.s<0;if(!c.d)return Et.charAt(c.s?h?82:83:84);if(e=c.e,1===c.d.length&&4>e&&e>=0&&(a=c.d[0],2857>a))return 41>a?Et.charAt(h?a+41:a):(a-=41,h&&(a+=2816),i=a/88|0,Et.charAt(i)+Et.charAt(a-88*i));if(u=o(c.d),s="",!h&&8>=e&&e>=-7)i=64+e+7;else if(h&&4>=e&&e>=-3)i=80+e+3;else if(u.length===e+1)i=32*h;else if(i=32*h+16*(0>e),e=Math.abs(e),88>e)i+=1,s=Et.charAt(e);else if(7744>e)i+=2,a=e/88|0,s=Et.charAt(a)+Et.charAt(e-88*a);else for(t=l(String(e),10,88),n=t.length,i+=n,r=0;n>r;r++)s+=Et.charAt(t[r]);for(s=Et.charAt(i)+s,t=l(u,10,88),n=t.length,r=0;n>r;r++)s+=Et.charAt(t[r]);return s},Gt.toNearest=function(t,e){var r=this,i=r.constructor;if(r=new i(r),null==t){if(!r.d)return r;t=new i(1),e=i.rounding}else{if(t=new i(t),void 0!==e&&a(e,0,8),!r.d)return t.s?r:t;if(!t.d)return t.s&&(t.s=r.s),t}return t.d[0]?(St=!1,4>e&&(e=[4,5,7,8][e]),r=Bt(r,t,0,e,1).times(t),St=!0,c(r)):(t.s=r.s,r=t),r},Gt.toNumber=function(){return+this},Gt.toOctal=function(t,e){return A(this,8,t,e)},Gt.toPower=Gt.pow=function(t){var e,r,i,n,a,l,u,h=this,f=h.constructor,d=+(t=new f(t));if(!(h.d&&t.d&&h.d[0]&&t.d[0]))return new f(Nt(+h,d));if(h=new f(h),h.eq(1))return h;if(i=f.precision,a=f.rounding,t.eq(1))return c(h,i,a);if(e=At(t.e/kt),r=t.d.length-1,u=e>=r,l=h.s,u){if((r=0>d?-d:d)<=Dt)return n=y(f,h,r,i),t.s<0?new f(1).div(n):c(n,i,a)}else if(0>l)return new f(NaN);return l=0>l&&1&t.d[Math.max(e,r)]?-1:1,r=Nt(+h,d),e=0!=r&&isFinite(r)?new f(r+"").e:At(d*(Math.log("0."+o(h.d))/Math.LN10+h.e+1)),e>f.maxE+1||e<f.minE-1?new f(e>0?l/0:0):(St=!1,f.rounding=h.s=1,r=Math.min(12,(e+"").length),n=w(t.times(b(h,i+r)),i),n=c(n,i+5,1),s(n.d,i,a)&&(e=i+10,n=c(w(t.times(b(h,e+r)),e),e+5,1),+o(n.d).slice(i+1,i+15)+1==1e14&&(n=c(n,i+1,0))),n.s=l,St=!0,f.rounding=a,c(n,i,a))},Gt.toPrecision=function(t,e){var r,i=this,n=i.constructor;return void 0===t?r=h(i,i.e<=n.toExpNeg||i.e>=n.toExpPos):(a(t,1,vt),void 0===e?e=n.rounding:a(e,0,8),i=c(new n(i),t,e),r=h(i,t<=i.e||i.e<=n.toExpNeg,t)),i.isNeg()&&!i.isZero()?"-"+r:r},Gt.toSignificantDigits=Gt.toSD=function(t,e){var r=this,i=r.constructor;return void 0===t?(t=i.precision,e=i.rounding):(a(t,1,vt),void 0===e?e=i.rounding:a(e,0,8)),c(new i(r),t,e)},Gt.toString=function(){var t=this,e=t.constructor,r=h(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+r:r},Gt.truncated=Gt.trunc=function(){return c(new this.constructor(this),this.e+1,1)},Gt.valueOf=function(){var t=this,e=t.constructor,r=h(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+r:r};var Bt=function(){function t(t,e,r){var i,n=0,o=t.length;for(t=t.slice();o--;)i=t[o]*e+n,t[o]=i%r|0,n=i/r|0;return n&&t.unshift(n),t}function e(t,e,r,i){var n,o;if(r!=i)o=r>i?1:-1;else for(n=o=0;r>n;n++)if(t[n]!=e[n]){o=t[n]>e[n]?1:-1;break}return o}function r(t,e,r,i){for(var n=0;r--;)t[r]-=n,n=t[r]<e[r]?1:0,t[r]=n*i+t[r]-e[r];for(;!t[0]&&t.length>1;)t.shift()}return function(i,n,o,a,s,l){var u,h,f,d,p,m,g,y,v,E,w,b,x,_,S,T,L,M,A,N,R=i.constructor,C=i.s==n.s?1:-1,P=i.d,O=n.d;if(!(P&&P[0]&&O&&O[0]))return new R(i.s&&n.s&&(P?!O||P[0]!=O[0]:O)?P&&0==P[0]||!O?0*C:C/0:NaN);for(l?(p=1,h=i.e-n.e):(l=It,p=kt,h=At(i.e/p)-At(n.e/p)),A=O.length,L=P.length,v=new R(C),E=v.d=[],f=0;O[f]==(P[f]||0);f++);if(O[f]>(P[f]||0)&&h--,null==o?(_=o=R.precision,a=R.rounding):_=s?o+(i.e-n.e)+1:o,0>_)E.push(1),m=!0;else{if(_=_/p+2|0,f=0,1==A){for(d=0,O=O[0],_++;(L>f||d)&&_--;f++)S=d*l+(P[f]||0),E[f]=S/O|0,d=S%O|0;m=d||L>f}else{for(d=l/(O[0]+1)|0,d>1&&(O=t(O,d,l),P=t(P,d,l),A=O.length,L=P.length),T=A,w=P.slice(0,A),b=w.length;A>b;)w[b++]=0;N=O.slice(),N.unshift(0),M=O[0],O[1]>=l/2&&++M;do d=0,u=e(O,w,A,b),0>u?(x=w[0],A!=b&&(x=x*l+(w[1]||0)),d=x/M|0,d>1?(d>=l&&(d=l-1),g=t(O,d,l),y=g.length,b=w.length,u=e(g,w,y,b),1==u&&(d--,r(g,y>A?N:O,y,l))):(0==d&&(u=d=1),g=O.slice()),y=g.length,b>y&&g.unshift(0),r(w,g,b,l),-1==u&&(b=w.length,u=e(O,w,A,b),1>u&&(d++,r(w,b>A?N:O,b,l))),b=w.length):0===u&&(d++,w=[0]),E[f++]=d,u&&w[0]?w[b++]=P[T]||0:(w=[P[T]],b=1);while((T++<L||void 0!==w[0])&&_--);m=void 0!==w[0]}E[0]||E.shift()}if(1==p)v.e=h,mt=m;else{for(f=1,d=E[0];d>=10;d/=10)f++;v.e=f+h*p-1,c(v,s?o+v.e+1:o,a,m)}return v}}();xt=z(xt),wt=new xt(wt),bt=new xt(bt),i=function(){return xt}.call(e,r,e,t),!(void 0!==i&&(t.exports=i))}(this)},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("bignumber",{"":function(){return new t.BigNumber(0)},number:function(e){return new t.BigNumber(e+"")},string:function(e){return new t.BigNumber(e)},BigNumber:function(t){return t},Fraction:function(e){return new t.BigNumber(e.n).div(e.d)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)"},o}var n=r(19);e.name="bignumber",e.factory=i},function(t,e){"use strict";t.exports=function r(t,e,i){return t&&"function"==typeof t.map?t.map(function(t){return r(t,e,i)}):e(t)}},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("bool",{"":function(){return!1},"boolean":function(t){return t},number:function(t){return!!t},BigNumber:function(t){return!t.isZero()},string:function(t){var e=t.toLowerCase();if("true"===e)return!0;if("false"===e)return!1;var r=Number(t);if(""!=t&&!isNaN(r))return!!r;throw new Error('Cannot convert "'+t+'" to a boolean')},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);e.name="boolean",e.factory=i},function(t,e,r){t.exports=[r(22),r(25)]},function(t,e,r){"use strict";function i(t,e,r,i,a){function s(t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");t&&t.isChain?this.value=t.value:this.value=t}function l(t,e){"function"==typeof e&&(s.prototype[t]=c(e))}function u(t,e){o(s.prototype,t,function(){var t=e();return"function"==typeof t?c(t):void 0})}function c(t){return function(){for(var e=[this.value],r=0;r<arguments.length;r++)e[r+1]=arguments[r];return new s(t.apply(t,e))}}return s.prototype.type="Chain",s.prototype.isChain=!0,s.prototype.done=function(){return this.value},s.prototype.valueOf=function(){return this.value},s.prototype.toString=function(){return n(this.value)},s.createProxy=function(t,e){if("string"==typeof t)l(t,e);else for(var r in t)t.hasOwnProperty(r)&&l(r,t[r])},s.createProxy(a),a.on("import",function(t,e,r){void 0===r&&u(t,e)}),s}var n=r(23).format,o=r(3).lazy;e.name="Chain",e.path="type",e.factory=i,e.math=!0,e.lazy=!1},function(t,e,r){"use strict";function i(t,r){if(Array.isArray(t)){for(var n="[",o=t.length,a=0;o>a;a++)0!=a&&(n+=", "),n+=i(t[a],r);return n+="]"}return e.format(t,r)}var n=r(6).format,o=r(24).format;e.isString=function(t){return"string"==typeof t},e.endsWith=function(t,e){var r=t.length-e.length,i=t.length;return t.substring(r,i)===e},e.format=function(t,r){if("number"==typeof t)return n(t,r);if(t&&t.isBigNumber===!0)return o(t,r);if(t&&t.isFraction===!0)return r&&"decimal"===r.fraction?t.toString():t.s*t.n+"/"+t.d;if(Array.isArray(t))return i(t,r);if(e.isString(t))return'"'+t+'"';if("function"==typeof t)return t.syntax?String(t.syntax):"function";if(t&&"object"==typeof t){if("function"==typeof t.format)return t.format(r);if(t&&t.toString()!=={}.toString())return t.toString();var a=[];for(var s in t)t.hasOwnProperty(s)&&a.push('"'+s+'": '+e.format(t[s],r));return"{"+a.join(", ")+"}"}return String(t)}},function(t,e){e.format=function(t,r){if("function"==typeof r)return r(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var i="auto",n=void 0;switch(void 0!==r&&(r.notation&&(i=r.notation),"number"==typeof r?n=r:r.precision&&(n=r.precision)),i){case"fixed":return e.toFixed(t,n);case"exponential":return e.toExponential(t,n);case"auto":var o=.001,a=1e5;r&&r.exponential&&(void 0!==r.exponential.lower&&(o=r.exponential.lower),void 0!==r.exponential.upper&&(a=r.exponential.upper));({toExpNeg:t.constructor.toExpNeg,toExpPos:t.constructor.toExpPos});if(t.constructor.config({toExpNeg:Math.round(Math.log(o)/Math.LN10),toExpPos:Math.round(Math.log(a)/Math.LN10)}),t.isZero())return"0";var s,l=t.abs();return s=l.gte(o)&&l.lt(a)?t.toSignificantDigits(n).toFixed():e.toExponential(t,n),s.replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", or "fixed".')}},e.toExponential=function(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()},e.toFixed=function(t,e){return t.toFixed(e||0)}},function(t,e){"use strict";function r(t,e,r,i){return i("chain",{"":function(){return new t.Chain},any:function(e){return new t.Chain(e)}})}e.name="chain",e.factory=r},function(t,e,r){t.exports=[r(27),r(31)]},function(t,e,r){function i(t,e,r,i,s){return n.prototype.type="Complex",n.prototype.isComplex=!0,n.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},n.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},n.prototype.format=function(t){var e="",r=this.im,i=this.re,n=o(this.re,t),s=o(this.im,t),l=a(t)?t:t?t.precision:null;if(null!==l){var u=Math.pow(10,-l);Math.abs(i/r)<u&&(i=0),Math.abs(r/i)<u&&(r=0)}return e=0==r?n:0==i?1==r?"i":-1==r?"-i":s+"i":r>0?1==r?n+" + i":n+" + "+s+"i":-1==r?n+" - i":n+" - "+s.substring(1)+"i"},n.fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return n(e);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var r=arguments[0],i=arguments[1];if(a(r)){if(i&&i.isUnit&&i.hasBase("ANGLE")&&(i=i.toNumber("rad")),a(i))return new n({r:r,phi:i});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},n.prototype.valueOf=n.prototype.toString,n.fromJSON=function(t){return new n(t)},n.EPSILON=e.epsilon,s.on("config",function(t,e){t.epsilon!==e.epsilon&&(n.EPSILON=t.epsilon)}),n}var n=r(28),o=r(6).format,a=r(6).isNumber;e.name="Complex",e.path="type",e.factory=i,e.math=!0},function(t,e,r){var i,n;(function(t){!function(o){"use strict";function a(t,e){var r=Math.abs(t),i=Math.abs(e);return 0===t?Math.log(i):0===e?Math.log(r):3e3>r&&3e3>i?.5*Math.log(t*t+e*e):Math.log(t/Math.cos(Math.atan2(e,t)))}function s(t,e){return this instanceof s?(c(t,e),this.re=l.re,void(this.im=l.im)):new s(t,e)}var l={re:0,im:0};Math.cosh=Math.cosh||function(t){return.5*(Math.exp(t)+Math.exp(-t))},Math.sinh=Math.sinh||function(t){return.5*(Math.exp(t)-Math.exp(-t))};var u=function(){throw SyntaxError("Invalid Param")},c=function(t,e){if(void 0===t||null===t)l.re=l.im=0;else if(void 0!==e)l.re=t,l.im=e;else switch(typeof t){case"object":"im"in t&&"re"in t?(l.re=t.re,l.im=t.im):"abs"in t&&"arg"in t?(l.re=t.abs*Math.cos(t.arg),l.im=t.abs*Math.sin(t.arg)):"r"in t&&"phi"in t?(l.re=t.r*Math.cos(t.phi),l.im=t.r*Math.sin(t.phi)):u();break;case"string":l.im=l.re=0;var r=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),i=1,n=0;null===r&&u();for(var o=0;o<r.length;o++){var a=r[o];" "===a||"	"===a||"\n"===a||("+"===a?i++:"-"===a?n++:"i"===a||"I"===a?(i+n===0&&u(),
" "===r[o+1]||isNaN(r[o+1])?l.im+=parseFloat((n%2?"-":"")+"1"):(l.im+=parseFloat((n%2?"-":"")+r[o+1]),o++),i=n=0):((i+n===0||isNaN(a))&&u(),"i"===r[o+1]||"I"===r[o+1]?(l.im+=parseFloat((n%2?"-":"")+a),o++):l.re+=parseFloat((n%2?"-":"")+a),i=n=0))}i+n>0&&u();break;case"number":l.im=0,l.re=t;break;default:u()}isNaN(l.re)||isNaN(l.im)};s.prototype={re:0,im:0,sign:function(){var t=this.abs();return new s(this.re/t,this.im/t)},add:function(t,e){return c(t,e),new s(this.re+l.re,this.im+l.im)},sub:function(t,e){return c(t,e),new s(this.re-l.re,this.im-l.im)},mul:function(t,e){return c(t,e),0===l.im&&0===this.im?new s(this.re*l.re,0):new s(this.re*l.re-this.im*l.im,this.re*l.im+this.im*l.re)},div:function(t,e){c(t,e),t=this.re,e=this.im;var r,i,n=l.re,o=l.im;return 0===n&&0===o?new s(0!==t?t/0:0,0!==e?e/0:0):0===o?new s(t/n,e/n):Math.abs(n)<Math.abs(o)?(i=n/o,r=n*i+o,new s((t*i+e)/r,(e*i-t)/r)):(i=o/n,r=o*i+n,new s((t+e*i)/r,(e-t*i)/r))},pow:function(t,e){if(c(t,e),t=this.re,e=this.im,0===t&&0===e)return new s(0,0);var r=Math.atan2(e,t),i=a(t,e);if(0===l.im){if(0===e&&t>=0)return new s(Math.pow(t,l.re),0);if(0===t)switch(l.re%4){case 0:return new s(Math.pow(e,l.re),0);case 1:return new s(0,Math.pow(e,l.re));case 2:return new s(-Math.pow(e,l.re),0);case 3:return new s(0,-Math.pow(e,l.re))}}return t=Math.exp(l.re*i-l.im*r),e=l.im*i+l.re*r,new s(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,r=this.re,i=this.im,n=this.abs();return r>=0&&0===i?new s(Math.sqrt(r),0):(t=r>=0?.5*Math.sqrt(2*(n+r)):Math.abs(i)/Math.sqrt(2*(n-r)),e=0>=r?.5*Math.sqrt(2*(n-r)):Math.abs(i)/Math.sqrt(2*(n+r)),new s(t,i>=0?e:-e))},exp:function(){var t=Math.exp(this.re);return 0===this.im,new s(t*Math.cos(this.im),t*Math.sin(this.im))},log:function(){var t=this.re,e=this.im;return new s(a(t,e),Math.atan2(e,t))},abs:function(){var t=Math.abs(this.re),e=Math.abs(this.im);return 3e3>t&&3e3>e?Math.sqrt(t*t+e*e):(e>t?(t=e,e=this.re/this.im):e=this.im/this.re,t*Math.sqrt(1+e*e))},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,e=this.im;return new s(Math.sin(t)*Math.cosh(e),Math.cos(t)*Math.sinh(e))},cos:function(){var t=this.re,e=this.im;return new s(Math.cos(t)*Math.cosh(e),-Math.sin(t)*Math.sinh(e))},tan:function(){var t=2*this.re,e=2*this.im,r=Math.cos(t)+Math.cosh(e);return new s(Math.sin(t)/r,Math.sinh(e)/r)},cot:function(){var t=2*this.re,e=2*this.im,r=Math.cos(t)-Math.cosh(e);return new s(-Math.sin(t)/r,Math.sinh(e)/r)},sec:function(){var t=this.re,e=this.im,r=.5*Math.cosh(2*e)+.5*Math.cos(2*t);return new s(Math.cos(t)*Math.cosh(e)/r,Math.sin(t)*Math.sinh(e)/r)},csc:function(){var t=this.re,e=this.im,r=.5*Math.cosh(2*e)-.5*Math.cos(2*t);return new s(Math.sin(t)*Math.cosh(e)/r,-Math.cos(t)*Math.sinh(e)/r)},asin:function(){var t=this.re,e=this.im,r=new s(e*e-t*t+1,-2*t*e).sqrt(),i=new s(r.re-e,r.im+t).log();return new s(i.im,-i.re)},acos:function(){var t=this.re,e=this.im,r=new s(e*e-t*t+1,-2*t*e).sqrt(),i=new s(r.re-e,r.im+t).log();return new s(Math.PI/2-i.im,i.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new s(0,1/0);if(-1===e)return new s(0,-(1/0))}var r=t*t+(1-e)*(1-e),i=new s((1-e*e-t*t)/r,-2*t/r).log();return new s(-.5*i.im,.5*i.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new s(Math.atan2(1,t),0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).atan():new s(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(0,1/0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).acos():new s(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(Math.PI/2,1/0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).asin():new s(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,e=this.im;return new s(Math.sinh(t)*Math.cos(e),Math.cosh(t)*Math.sin(e))},cosh:function(){var t=this.re,e=this.im;return new s(Math.cosh(t)*Math.cos(e),Math.sinh(t)*Math.sin(e))},tanh:function(){var t=2*this.re,e=2*this.im,r=Math.cosh(t)+Math.cos(e);return new s(Math.sinh(t)/r,Math.sin(e)/r)},coth:function(){var t=2*this.re,e=2*this.im,r=Math.cosh(t)-Math.cos(e);return new s(Math.sinh(t)/r,-Math.sin(e)/r)},csch:function(){var t=this.re,e=this.im,r=Math.cos(2*e)-Math.cosh(2*t);return new s(-2*Math.sinh(t)*Math.cos(e)/r,2*Math.cosh(t)*Math.sin(e)/r)},sech:function(){var t=this.re,e=this.im,r=Math.cos(2*e)+Math.cosh(2*t);return new s(2*Math.cosh(t)*Math.cos(e)/r,-2*Math.sinh(t)*Math.sin(e)/r)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t,e=this.acos();return e.im<=0?(t=e.re,e.re=-e.im,e.im=t):(t=e.im,e.im=-e.re,e.re=t),e},atanh:function(){var t=this.re,e=this.im,r=t>1&&0===e,i=1-t,n=1+t,o=i*i+e*e,l=0!==o?new s((n*i-e*e)/o,(e*i+n*e)/o):new s(-1!==t?t/0:0,0!==e?e/0:0),u=l.re;return l.re=a(l.re,l.im)/2,l.im=Math.atan2(l.im,u)/2,r&&(l.im=-l.im),l},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(0,Math.PI/2);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).atanh():new s(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new s(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).asinh():new s(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(1/0,0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).acosh():new s(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){var t=this.re,e=this.im,r=t*t+e*e;return new s(0!==t?t/r:0,0!==e?-e/r:0)},conjugate:function(){return new s(this.re,-this.im)},neg:function(){return new s(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new s(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new s(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new s(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){return c(t,e),Math.abs(l.re-this.re)<=s.EPSILON&&Math.abs(l.im-this.im)<=s.EPSILON},clone:function(){return new s(this.re,this.im)},toString:function(){var t=this.re,e=this.im,r="";return isNaN(t)||isNaN(e)?"NaN":(0!==t&&(r+=t),0!==e&&(0!==t?r+=0>e?" - ":" + ":0>e&&(r+="-"),e=Math.abs(e),1!==e&&(r+=e),r+="i"),r?r:"0")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)}},s.ZERO=new s(0,0),s.ONE=new s(1,0),s.I=new s(0,1),s.PI=new s(Math.PI,0),s.E=new s(Math.E,0),s.EPSILON=1e-16,r(30).amd?(i=[],n=function(){return s}.apply(e,i),!(void 0!==n&&(t.exports=n))):t.exports=s}(this)}).call(e,r(29)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=o("complex",{"":function(){return t.Complex.ZERO},number:function(e){return new t.Complex(e,0)},"number, number":function(e,r){return new t.Complex(e,r)},"BigNumber, BigNumber":function(e,r){return new t.Complex(e.toNumber(),r.toNumber())},Complex:function(t){return t.clone()},string:function(e){return t.Complex(e)},Object:function(e){if("re"in e&&"im"in e)return new t.Complex(e.re,e.im);if("r"in e&&"phi"in e)return new t.Complex(e);throw new Error("Expected object with either properties re and im, or properties r and phi.")},"Array | Matrix":function(t){return n(t,s)}});return s.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+"+a.symbols.i+"\\cdot\\left(${args[1]}\\right)\\right)"},s}var n=r(19);e.name="complex",e.factory=i},function(t,e){"use strict";e.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega","true":"\\mathrm{True}","false":"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},e.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},e.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var r={deg:"^\\circ"};e.toSymbol=function(t,i){if(i="undefined"==typeof i?!1:i)return r.hasOwnProperty(t)?r[t]:"\\mathrm{"+t+"}";if(e.symbols.hasOwnProperty(t))return e.symbols[t];if(-1!==t.indexOf("_")){var n=t.indexOf("_");return e.toSymbol(t.substring(0,n))+"_{"+e.toSymbol(t.substring(n+1))+"}"}return t}},function(t,e,r){t.exports=[r(34),r(36)]},function(t,e,r){function i(t,e,r,i){return n}var n=r(35);n.prototype.type="Fraction",n.prototype.isFraction=!0,n.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},n.fromJSON=function(t){return new n(t)},e.name="Fraction",e.path="type",e.factory=i},function(t,e,r){var i,n;(function(t){!function(o){"use strict";function a(t,e){return isNaN(t=parseInt(t,10))&&s(),t*e}function s(){throw"Invalid Param"}function l(t,e){return this instanceof l?(h(t,e),t=l.REDUCE?m(c.d,c.n):1,this.s=c.s,this.n=c.n/t,void(this.d=c.d/t)):new l(t,e)}var u=2e3,c={s:1,n:0,d:1},h=function(t,e){var r,i=0,n=1,o=1,l=0,u=0,h=0,f=1,d=1,p=0,m=1,g=1,y=1,v=1e7;if(void 0===t||null===t);else if(void 0!==e)i=t,n=e,o=i*n;else switch(typeof t){case"object":"d"in t&&"n"in t?(i=t.n,n=t.d,"s"in t&&(i*=t.s)):0 in t?(i=t[0],1 in t&&(n=t[1])):s(),o=i*n;break;case"number":if(0>t&&(o=t,t=-t),t%1===0)i=t;else if(t>0){for(t>=1&&(d=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)),t/=d);v>=m&&v>=y;){if(r=(p+g)/(m+y),t===r){v>=m+y?(i=p+g,n=m+y):y>m?(i=g,n=y):(i=p,n=m);break}t>r?(p+=g,m+=y):(g+=p,y+=m),m>v?(i=g,n=y):(i=p,n=m)}i*=d}else(isNaN(t)||isNaN(e))&&(n=i=NaN);break;case"string":if(m=t.match(/\d+|./g),"-"===m[p]?(o=-1,p++):"+"===m[p]&&p++,m.length===p+1?u=a(m[p++],o):"."===m[p+1]||"."===m[p]?("."!==m[p]&&(l=a(m[p++],o)),p++,(p+1===m.length||"("===m[p+1]&&")"===m[p+3]||"'"===m[p+1]&&"'"===m[p+3])&&(u=a(m[p],o),f=Math.pow(10,m[p].length),p++),("("===m[p]&&")"===m[p+2]||"'"===m[p]&&"'"===m[p+2])&&(h=a(m[p+1],o),d=Math.pow(10,m[p+1].length)-1,p+=3)):"/"===m[p+1]||":"===m[p+1]?(u=a(m[p],o),f=a(m[p+2],1),p+=3):"/"===m[p+3]&&" "===m[p+1]&&(l=a(m[p],o),u=a(m[p+2],o),f=a(m[p+4],1),p+=5),m.length<=p){n=f*d,o=i=h+n*l+d*u;break}default:s()}if(0===n)throw"DIV/0";c.s=0>o?-1:1,c.n=Math.abs(i),c.d=Math.abs(n)},f=function(t,e,r){for(var i=1;e>0;t=t*t%r,e>>=1)1&e&&(i=i*t%r);return i},d=function(t,e){for(;e%2===0;e/=2);for(;e%5===0;e/=5);if(1===e)return 0;for(var r=10%e,i=1;1!==r;i++)if(r=10*r%e,i>u)return 0;return i},p=function(t,e,r){for(var i=1,n=f(10,r,e),o=0;300>o;o++){if(i===n)return o;i=10*i%e,n=10*n%e}return 0},m=function(t,e){if(!t)return e;if(!e)return t;for(;;){if(t%=e,!t)return e;if(e%=t,!e)return t}};l.REDUCE=1,l.prototype={s:1,n:0,d:1,abs:function(){return new l(this.n,this.d)},neg:function(){return new l(-this.s*this.n,this.d)},add:function(t,e){return h(t,e),new l(this.s*this.n*c.d+c.s*this.d*c.n,this.d*c.d)},sub:function(t,e){return h(t,e),new l(this.s*this.n*c.d-c.s*this.d*c.n,this.d*c.d)},mul:function(t,e){return h(t,e),new l(this.s*c.s*this.n*c.n,this.d*c.d)},div:function(t,e){return h(t,e),new l(this.s*c.s*this.n*c.d,this.d*c.n)},clone:function(){return new l(this)},mod:function(t,e){return isNaN(this.n)||isNaN(this.d)?new l(NaN):void 0===t?new l(this.s*this.n%this.d,1):(h(t,e),0===c.n&&0===this.d&&l(0,0),new l(this.s*c.d*this.n%(c.n*this.d),c.d*this.d))},gcd:function(t,e){return h(t,e),new l(m(c.n,this.n),c.d*this.d/m(c.d,this.d))},lcm:function(t,e){return h(t,e),0===c.n&&0===this.n?new l:new l(c.n*this.n/m(c.n,this.n),m(c.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):new l(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):new l(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):new l(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return new l(this.s*this.d,this.n)},pow:function(t){return 0>t?new l(Math.pow(this.s*this.d,-t),Math.pow(this.n,-t)):new l(Math.pow(this.s*this.n,t),Math.pow(this.d,t))},equals:function(t,e){return h(t,e),this.s*this.n*c.d===c.s*c.n*this.d},compare:function(t,e){h(t,e);var r=this.s*this.n*c.d-c.s*c.n*this.d;return(r>0)-(0>r)},divisible:function(t,e){return h(t,e),!(!(c.n*this.d)||this.n*c.d%(c.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,r="",i=this.n,n=this.d;return this.s<0&&(r+="-"),1===n?r+=i:(t&&(e=Math.floor(i/n))>0&&(r+=e,r+=" ",i%=n),r+=i,r+="/",r+=n),r},toLatex:function(t){var e,r="",i=this.n,n=this.d;return this.s<0&&(r+="-"),1===n?r+=i:(t&&(e=Math.floor(i/n))>0&&(r+=e,i%=n),r+="\\frac{",r+=i,r+="}{",r+=n,r+="}"),r},toContinued:function(){var t,e=this.n,r=this.d,i=[];do i.push(Math.floor(e/r)),t=e%r,e=r,r=t;while(1!==e);return i},toString:function(){var t,e=this.n,r=this.d;if(isNaN(e)||isNaN(r))return"NaN";l.REDUCE||(t=m(e,r),e/=t,r/=t);for(var i=String(e).split(""),n=0,o=[~this.s?"":"-","",""],a="",s=d(e,r),u=p(e,r,s),c=-1,h=1,f=15+s+u+i.length,g=0;f>g;g++,n*=10){if(g<i.length?n+=Number(i[g]):(h=2,c++),s>0)if(c===u)o[h]+=a+"(",a="";else if(c===s+u){o[h]+=a+")";break}n>=r?(o[h]+=a+(n/r|0),a="",n%=r):h>1?a+="0":o[h]&&(o[h]+="0")}return o[0]+=o[1]||"0",o[2]?o[0]+"."+o[2]:o[0]}},r(30).amd?(i=[],n=function(){return l}.apply(e,i),!(void 0!==n&&(t.exports=n))):t.exports=l}(this)}).call(e,r(29)(t))},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new t.Fraction(e)},string:function(e){return new t.Fraction(e)},"number, number":function(e,r){return new t.Fraction(e,r)},BigNumber:function(e){return new t.Fraction(e.toString())},Fraction:function(t){return t},Object:function(e){return new t.Fraction(e)},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);e.name="fraction",e.factory=i},function(t,e,r){t.exports=[r(38),r(46),r(47),r(50),r(59),r(65),r(66),r(67),r(68),r(52),r(69)]},function(t,e,r){"use strict";function i(t,e,r,i){function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator")}return n.prototype.type="Matrix",n.prototype.isMatrix=!0,n.storage=function(t){if(!a(t))throw new TypeError("format must be a string value");var e=n._storage[t];if(!e)throw new SyntaxError("Unsupported matrix storage format: "+t);return e},n._storage={},n.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},n.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},n.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},n.prototype.subset=function(t,e,r){throw new Error("Cannot invoke subset on a Matrix interface")},n.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},n.prototype.set=function(t,e,r){throw new Error("Cannot invoke set on a Matrix interface")},n.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},n.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},n.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},n.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},n.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},n.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},n.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},n.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},n.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},n}var n=r(39),o=n.string,a=o.isString;e.name="Matrix",e.path="type",e.factory=i},function(t,e,r){"use strict";e.array=r(40),e["boolean"]=r(44),e["function"]=r(45),e.number=r(6),e.object=r(3),e.string=r(23),e.types=r(41),e.emitter=r(8)},function(t,e,r){"use strict";function i(t,e,r){var n,o=t.length;if(o!=e[r])throw new u(o,e[r]);if(r<e.length-1){var a=r+1;for(n=0;o>n;n++){var s=t[n];if(!Array.isArray(s))throw new u(e.length-1,e.length,"<");i(t[n],e,a)}}else for(n=0;o>n;n++)if(Array.isArray(t[n]))throw new u(e.length+1,e.length,">")}function n(t,r,i,o){var a,s,l=t.length,u=r[i],c=Math.min(l,u);if(t.length=u,i<r.length-1){var h=i+1;for(a=0;c>a;a++)s=t[a],Array.isArray(s)||(s=[s],t[a]=s),n(s,r,h,o);for(a=c;u>a;a++)s=[],t[a]=s,n(s,r,h,o)}else{for(a=0;c>a;a++)for(;Array.isArray(t[a]);)t[a]=t[a][0];if(o!==e.UNINITIALIZED)for(a=c;u>a;a++)t[a]=o}}function o(t,e,r){var i,n;if(e>r){var a=r+1;for(i=0,n=t.length;n>i;i++)t[i]=o(t[i],e,a)}else for(;Array.isArray(t);)t=t[0];return t}function a(t,e,r){var i,n;if(Array.isArray(t)){var o=r+1;for(i=0,n=t.length;n>i;i++)t[i]=a(t[i],e,o)}else for(var s=r;e>s;s++)t=[t];return t}var s=r(6),l=r(23),u=(r(3),r(41),r(42)),c=r(43);e.size=function(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e},e.validate=function(t,e){var r=0==e.length;if(r){if(Array.isArray(t))throw new u(t.length,0)}else i(t,e,0)},e.validateIndex=function(t,e){if(!s.isNumber(t)||!s.isInteger(t))throw new TypeError("Index must be an integer (value: "+t+")");if(0>t||"number"==typeof e&&t>=e)throw new c(t,e)},e.UNINITIALIZED={},e.resize=function(t,e,r){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");e.forEach(function(t){if(!s.isNumber(t)||!s.isInteger(t)||0>t)throw new TypeError("Invalid size, must contain positive integers (size: "+l.format(e)+")")});var i=void 0!==r?r:0;return n(t,e,0,i),t},e.squeeze=function(t,r){for(var i=r||e.size(t);Array.isArray(t)&&1===t.length;)t=t[0],i.shift();for(var n=i.length;1===i[n-1];)n--;return n<i.length&&(t=o(t,n,0),i.length=n),t},e.unsqueeze=function(t,r,i,n){var o=n||e.size(t);if(i)for(var s=0;i>s;s++)t=[t],o.unshift(1);for(t=a(t,r,0);o.length<r;)o.push(1);return t},e.flatten=function(t){if(!Array.isArray(t))return t;var e=[];return t.forEach(function r(t){Array.isArray(t)?t.forEach(r):e.push(t)}),e},e.isArray=Array.isArray},function(t,e){"use strict";e.type=function(t){var e=typeof t;return"object"===e?null===t?"null":t instanceof Boolean?"boolean":t instanceof Number?"number":t instanceof String?"string":Array.isArray(t)?"Array":t instanceof Date?"Date":t instanceof RegExp?"RegExp":"Object":"function"===e?"Function":e},e.isScalar=function(t){return!(t&&t.isMatrix||Array.isArray(t))}},function(t,e){"use strict";function r(t,e,i){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=i,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}r.prototype=new RangeError,r.prototype.constructor=RangeError,r.prototype.name="DimensionError",r.prototype.isDimensionError=!0,t.exports=r},function(t,e){"use strict";function r(t,e,i){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=i),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}r.prototype=new RangeError,r.prototype.constructor=RangeError,r.prototype.name="IndexError",r.prototype.isIndexError=!0,t.exports=r},function(t,e){"use strict";e.isBoolean=function(t){return"boolean"==typeof t}},function(t,e){e.memoize=function(t,e){return function r(){"object"!=typeof r.cache&&(r.cache={});for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var o=e?e(i):JSON.stringify(i);return o in r.cache?r.cache[o]:r.cache[o]=t.apply(t,i)}},e.maxArgumentCount=function(t){return Object.keys(t.signatures||{}).reduce(function(t,e){var r=(e.match(/,/g)||[]).length+1;return Math.max(t,r)},-1)}},function(t,e,r){"use strict";function i(t,e,i,u){function m(t,e){if(!(this instanceof m))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!d(e))throw new Error("Invalid datatype: "+e);if(t&&t.isMatrix===!0)"DenseMatrix"===t.type?(this._data=l.clone(t._data),this._size=l.clone(t._size),this._datatype=e||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=e||t._datatype);else if(t&&c(t.data)&&c(t.size))this._data=t.data,this._size=t.size,this._datatype=e||t.datatype;else if(c(t))this._data=b(t),this._size=s.size(this._data),s.validate(this._data,this._size),this._datatype=e;else{if(t)throw new TypeError("Unsupported type of data ("+n.types.type(t)+")");this._data=[],this._size=[0],this._datatype=e}}function g(t,e){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var r=e.isScalar();if(r)return t.get(e.min());var i=e.size();if(i.length!=t._size.length)throw new o(i.length,t._size.length);for(var n=e.min(),a=e.max(),s=0,l=t._size.length;l>s;s++)p(n[s],t._size[s]),p(a[s],t._size[s]);return new m(y(t._data,e,i.length,0),t._datatype)}function y(t,e,r,i){var n=i==r-1,o=e.dimension(i);return n?o.map(function(e){return t[e]}).valueOf():o.map(function(n){var o=t[n];return y(o,e,r,i+1)}).valueOf()}function v(t,e,r,i){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var n,a=e.size(),u=e.isScalar();if(r&&r.isMatrix===!0?(n=r.size(),r=r.valueOf()):n=s.size(r),u){if(0!==n.length)throw new TypeError("Scalar expected");t.set(e.min(),r,i)}else{if(a.length<t._size.length)throw new o(a.length,t._size.length,"<");if(n.length<a.length){for(var c=0,h=0;1===a[c]&&1===n[c];)c++;for(;1===a[c];)h++,c++;r=s.unsqueeze(r,a.length,h,n)}if(!l.deepEqual(a,n))throw new o(a,n,">");var f=e.max().map(function(t){return t+1});w(t,f,i);var d=a.length,p=0;E(t._data,e,r,d,p)}return t}function E(t,e,r,i,n){var o=n==i-1,a=e.dimension(n);o?a.forEach(function(e,i){p(e),t[e]=r[i[0]]}):a.forEach(function(o,a){p(o),E(t[o],e,r[a[0]],i,n+1)})}function w(t,e,r){for(var i=t._size.slice(0),n=!1;i.length<e.length;)i.push(0),n=!0;for(var o=0,a=e.length;a>o;o++)e[o]>i[o]&&(i[o]=e[o],n=!0);n&&_(t,i,r)}function b(t){for(var e=0,r=t.length;r>e;e++){var i=t[e];c(i)?t[e]=b(i):i&&i.isMatrix===!0&&(t[e]=b(i.valueOf()))}return t}var x=i(r(38));m.prototype=new x,m.prototype.type="DenseMatrix",m.prototype.isDenseMatrix=!0,m.prototype.storage=function(){return"dense"},m.prototype.datatype=function(){return this._datatype},m.prototype.create=function(t,e){return new m(t,e)},m.prototype.subset=function(t,e,r){switch(arguments.length){case 1:return g(this,t);case 2:case 3:return v(this,t,e,r);default:throw new SyntaxError("Wrong number of arguments")}},m.prototype.get=function(t){if(!c(t))throw new TypeError("Array expected");if(t.length!=this._size.length)throw new o(t.length,this._size.length);for(var e=0;e<t.length;e++)p(t[e],this._size[e]);for(var r=this._data,i=0,n=t.length;n>i;i++){var a=t[i];p(a,r.length),r=r[a]}return r},m.prototype.set=function(t,e,r){if(!c(t))throw new TypeError("Array expected");if(t.length<this._size.length)throw new o(t.length,this._size.length,"<");var i,n,a,s=t.map(function(t){return t+1});w(this,s,r);var l=this._data;for(i=0,n=t.length-1;n>i;i++)a=t[i],p(a,l.length),l=l[a];return a=t[t.length-1],p(a,l.length),l[a]=e,this},m.prototype.resize=function(t,e,r){if(!c(t))throw new TypeError("Array expected");var i=r?this.clone():this;return _(i,t,e)};var _=function(t,e,r){if(0===e.length){for(var i=t._data;c(i);)i=i[0];return i}return t._size=e.slice(0),t._data=s.resize(t._data,t._size,r),t};return m.prototype.clone=function(){var t=new m({data:l.clone(this._data),size:l.clone(this._size),datatype:this._datatype});return t},m.prototype.size=function(){return this._size.slice(0)},m.prototype.map=function(t){var e=this,r=function(i,n){return c(i)?i.map(function(t,e){return r(t,n.concat(e))}):t(i,n,e)};return new m({data:r(this._data,[]),size:l.clone(this._size),datatype:this._datatype})},m.prototype.forEach=function(t){var e=this,r=function(i,n){c(i)?i.forEach(function(t,e){r(t,n.concat(e))}):t(i,n,e)};r(this._data,[])},m.prototype.toArray=function(){return l.clone(this._data)},m.prototype.valueOf=function(){return this._data},m.prototype.format=function(t){return a.format(this._data,t)},m.prototype.toString=function(){return a.format(this._data)},m.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},m.prototype.diagonal=function(t){if(t){if(t.isBigNumber===!0&&(t=t.toNumber()),!h(t)||!f(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,r=0>t?-t:0,i=this._size[0],n=this._size[1],o=Math.min(i-r,n-e),a=[],s=0;o>s;s++)a[s]=this._data[s+r][s+e];return new m({data:a,size:[o],datatype:this._datatype})},m.diagonal=function(e,r,i,n,o){if(!c(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map(function(t){if(t&&t.isBigNumber===!0&&(t=t.toNumber()),!h(t)||!f(t)||1>t)throw new Error("Size values must be positive integers");return t}),i){if(i&&i.isBigNumber===!0&&(i=i.toNumber()),!h(i)||!f(i))throw new TypeError("The parameter k must be an integer number")}else i=0;n&&d(o)&&(n=u.convert(n,o));var a,l=i>0?i:0,p=0>i?-i:0,g=e[0],y=e[1],v=Math.min(g-p,y-l);if(c(r)){if(r.length!==v)throw new Error("Invalid value array length");a=function(t){return r[t]}}else if(r&&r.isMatrix===!0){var E=r.size();if(1!==E.length||E[0]!==v)throw new Error("Invalid matrix length");a=function(t){return r.get([t])}}else a=function(){return r};n||(n=a(0)&&a(0).isBigNumber===!0?new t.BigNumber(0):0);var w=[];if(e.length>0){w=s.resize(w,e,n);for(var b=0;v>b;b++)w[b+p][b+l]=a(b)}return new m({data:w,size:[g,y]})},m.fromJSON=function(t){return new m(t)},m.prototype.swapRows=function(t,e){if(!(h(t)&&f(t)&&h(e)&&f(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return p(t,this._size[0]),p(e,this._size[0]),m._swapRows(t,e,this._data),this},m._swapRows=function(t,e,r){var i=r[t];r[t]=r[e],r[e]=i},t.Matrix._storage.dense=m,t.Matrix._storage["default"]=m,m}var n=r(39),o=r(42),a=n.string,s=n.array,l=n.object,u=n.number,c=Array.isArray,h=u.isNumber,f=u.isInteger,d=a.isString,p=s.validateIndex;e.name="DenseMatrix",e.path="type",e.factory=i,e.lazy=!1},function(t,e,r){"use strict";function i(t,e,i,m){function g(t,e){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!d(e))throw new Error("Invalid datatype: "+e);if(t&&t.isMatrix===!0)E(this,t,e);else if(t&&c(t.index)&&c(t.ptr)&&c(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(c(t))w(this,t,e);else{if(t)throw new TypeError("Unsupported type of data ("+n.types.type(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}var y=i(r(38)),v=i(r(48)),E=function(t,e,r){"SparseMatrix"===e.type?(t._values=e._values?s.clone(e._values):void 0,t._index=s.clone(e._index),t._ptr=s.clone(e._ptr),t._size=s.clone(e._size),t._datatype=r||e._datatype):w(t,e.valueOf(),r||e._datatype)},w=function(t,e,r){t._values=[],t._index=[],t._ptr=[],t._datatype=r;var i=e.length,n=0,o=v,a=0;if(d(r)&&(o=m.find(v,[r,r])||v,a=m.convert(0,r)),i>0){var s=0;do{t._ptr.push(t._index.length);for(var l=0;i>l;l++){var u=e[l];if(c(u)){if(0===s&&n<u.length&&(n=u.length),s<u.length){var h=u[s];o(h,a)||(t._values.push(h),t._index.push(l))}}else 0===s&&1>n&&(n=1),o(u,a)||(t._values.push(u),t._index.push(l))}s++}while(n>s)}t._ptr.push(t._index.length),t._size=[i,n]};g.prototype=new y,g.prototype.type="SparseMatrix",g.prototype.isSparseMatrix=!0,g.prototype.storage=function(){return"sparse"},g.prototype.datatype=function(){return this._datatype},g.prototype.create=function(t,e){return new g(t,e)},g.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},g.prototype.subset=function(t,e,r){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return b(this,t);case 2:case 3:return x(this,t,e,r);default:throw new SyntaxError("Wrong number of arguments")}};var b=function(t,e){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var r=e.isScalar();if(r)return t.get(e.min());var i=e.size();if(i.length!=t._size.length)throw new o(i.length,t._size.length);var n,a,s,l,u=e.min(),c=e.max();for(n=0,a=t._size.length;a>n;n++)p(u[n],t._size[n]),p(c[n],t._size[n]);var h=t._values,f=t._index,d=t._ptr,m=e.dimension(0),y=e.dimension(1),v=[],E=[];m.forEach(function(t,e){E[t]=e[0],v[t]=!0});var w=h?[]:void 0,b=[],x=[];return y.forEach(function(t){for(x.push(b.length),s=d[t],l=d[t+1];l>s;s++)n=f[s],v[n]===!0&&(b.push(E[n]),w&&w.push(h[s]))}),x.push(b.length),new g({values:w,index:b,ptr:x,size:i,datatype:t._datatype})},x=function(t,e,r,i){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var n,l=e.size(),u=e.isScalar();if(r&&r.isMatrix===!0?(n=r.size(),r=r.toArray()):n=a.size(r),u){if(0!==n.length)throw new TypeError("Scalar expected");t.set(e.min(),r,i)}else{if(1!==l.length&&2!==l.length)throw new o(l.length,t._size.length,"<");if(n.length<l.length){for(var c=0,h=0;1===l[c]&&1===n[c];)c++;for(;1===l[c];)h++,c++;r=a.unsqueeze(r,l.length,h,n)}if(!s.deepEqual(l,n))throw new o(l,n,">");for(var f=e.min()[0],d=e.min()[1],p=n[0],m=n[1],g=0;p>g;g++)for(var y=0;m>y;y++){var v=r[g][y];t.set([g+f,y+d],v,i)}}return t};g.prototype.get=function(t){if(!c(t))throw new TypeError("Array expected");if(t.length!=this._size.length)throw new o(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=t[0],r=t[1];p(e,this._size[0]),p(r,this._size[1]);var i=_(e,this._ptr[r],this._ptr[r+1],this._index);return i<this._ptr[r+1]&&this._index[i]===e?this._values[i]:0},g.prototype.set=function(t,e,r){if(!c(t))throw new TypeError("Array expected");if(t.length!=this._size.length)throw new o(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var i=t[0],n=t[1],a=this._size[0],s=this._size[1],l=v,u=0;d(this._datatype)&&(l=m.find(v,[this._datatype,this._datatype])||v,u=m.convert(0,this._datatype)),(i>a-1||n>s-1)&&(L(this,Math.max(i+1,a),Math.max(n+1,s),r),a=this._size[0],s=this._size[1]),p(i,a),p(n,s);var h=_(i,this._ptr[n],this._ptr[n+1],this._index);return h<this._ptr[n+1]&&this._index[h]===i?l(e,u)?S(h,n,this._values,this._index,this._ptr):this._values[h]=e:T(h,i,n,e,this._values,this._index,this._ptr),
this};var _=function(t,e,r,i){if(r-e===0)return r;for(var n=e;r>n;n++)if(i[n]===t)return n;return e},S=function(t,e,r,i,n){r.splice(t,1),i.splice(t,1);for(var o=e+1;o<n.length;o++)n[o]--},T=function(t,e,r,i,n,o,a){n.splice(t,0,i),o.splice(t,0,e);for(var s=r+1;s<a.length;s++)a[s]++};g.prototype.resize=function(t,e,r){if(!c(t))throw new TypeError("Array expected");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");t.forEach(function(e){if(!u.isNumber(e)||!u.isInteger(e)||0>e)throw new TypeError("Invalid size, must contain positive integers (size: "+l.format(t)+")")});var i=r?this.clone():this;return L(i,t[0],t[1],e)};var L=function(t,e,r,i){var n=i||0,o=v,a=0;d(t._datatype)&&(o=m.find(v,[t._datatype,t._datatype])||v,a=m.convert(0,t._datatype),n=m.convert(n,t._datatype));var s,l,u,c=!o(n,a),h=t._size[0],f=t._size[1];if(r>f){for(l=f;r>l;l++)if(t._ptr[l]=t._values.length,c)for(s=0;h>s;s++)t._values.push(n),t._index.push(s);t._ptr[r]=t._values.length}else f>r&&(t._ptr.splice(r+1,f-r),t._values.splice(t._ptr[r],t._values.length),t._index.splice(t._ptr[r],t._index.length));if(f=r,e>h){if(c){var p=0;for(l=0;f>l;l++){t._ptr[l]=t._ptr[l]+p,u=t._ptr[l+1]+p;var g=0;for(s=h;e>s;s++,g++)t._values.splice(u+g,0,n),t._index.splice(u+g,0,s),p++}t._ptr[f]=t._values.length}}else if(h>e){var y=0;for(l=0;f>l;l++){t._ptr[l]=t._ptr[l]-y;var E=t._ptr[l],w=t._ptr[l+1]-y;for(u=E;w>u;u++)s=t._index[u],s>e-1&&(t._values.splice(u,1),t._index.splice(u,1),y++)}t._ptr[l]=t._values.length}return t._size[0]=e,t._size[1]=r,t};g.prototype.clone=function(){var t=new g({values:this._values?s.clone(this._values):void 0,index:s.clone(this._index),ptr:s.clone(this._ptr),size:s.clone(this._size),datatype:this._datatype});return t},g.prototype.size=function(){return this._size.slice(0)},g.prototype.map=function(t,e){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var r=this,i=this._size[0],n=this._size[1],o=function(e,i,n){return t(e,[i,n],r)};return M(this,0,i-1,0,n-1,o,e)};var M=function(t,e,r,i,n,o,a){var s=[],l=[],u=[],c=v,h=0;d(t._datatype)&&(c=m.find(v,[t._datatype,t._datatype])||v,h=m.convert(0,t._datatype));for(var f=function(t,e,r){t=o(t,e,r),c(t,h)||(s.push(t),l.push(e))},p=i;n>=p;p++){u.push(s.length);for(var y=t._ptr[p],E=t._ptr[p+1],w=e,b=y;E>b;b++){var x=t._index[b];if(x>=e&&r>=x){if(!a)for(var _=w;x>_;_++)f(0,_-e,p-i);f(t._values[b],x-e,p-i)}w=x+1}if(!a)for(var S=w;r>=S;S++)f(0,S-e,p-i)}return u.push(s.length),new g({values:s,index:l,ptr:u,size:[r-e+1,n-i+1]})};g.prototype.forEach=function(t,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var r=this,i=this._size[0],n=this._size[1],o=0;n>o;o++){for(var a=this._ptr[o],s=this._ptr[o+1],l=0,u=a;s>u;u++){var c=this._index[u];if(!e)for(var h=l;c>h;h++)t(0,[h,o],r);t(this._values[u],[c,o],r),l=c+1}if(!e)for(var f=l;i>f;f++)t(0,[f,o],r)}},g.prototype.toArray=function(){return A(this._values,this._index,this._ptr,this._size,!0)},g.prototype.valueOf=function(){return A(this._values,this._index,this._ptr,this._size,!1)};var A=function(t,e,r,i,n){var o,a,l=i[0],u=i[1],c=[];for(o=0;l>o;o++)for(c[o]=[],a=0;u>a;a++)c[o][a]=0;for(a=0;u>a;a++)for(var h=r[a],f=r[a+1],d=h;f>d;d++)o=e[d],c[o][a]=t?n?s.clone(t[d]):t[d]:1;return c};return g.prototype.format=function(t){for(var e=this._size[0],r=this._size[1],i=this.density(),n="Sparse Matrix ["+l.format(e,t)+" x "+l.format(r,t)+"] density: "+l.format(i,t)+"\n",o=0;r>o;o++)for(var a=this._ptr[o],s=this._ptr[o+1],u=a;s>u;u++){var c=this._index[u];n+="\n    ("+l.format(c,t)+", "+l.format(o,t)+") ==> "+(this._values?l.format(this._values[u],t):"X")}return n},g.prototype.toString=function(){return l.format(this.toArray())},g.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},g.prototype.diagonal=function(t){if(t){if(t.isBigNumber===!0&&(t=t.toNumber()),!h(t)||!f(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,r=0>t?-t:0,i=this._size[0],n=this._size[1],o=Math.min(i-r,n-e),a=[],s=[],l=[];l[0]=0;for(var u=e;n>u&&a.length<o;u++)for(var c=this._ptr[u],d=this._ptr[u+1],p=c;d>p;p++){var m=this._index[p];if(m===u-e+r){a.push(this._values[p]),s[a.length-1]=m-r;break}}return l.push(a.length),new g({values:a,index:s,ptr:l,size:[o,1]})},g.fromJSON=function(t){return new g(t)},g.diagonal=function(t,e,r,i,n){if(!c(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map(function(t){if(t&&t.isBigNumber===!0&&(t=t.toNumber()),!h(t)||!f(t)||1>t)throw new Error("Size values must be positive integers");return t}),r){if(r.isBigNumber===!0&&(r=r.toNumber()),!h(r)||!f(r))throw new TypeError("The parameter k must be an integer number")}else r=0;var o=v,a=0;d(n)&&(o=m.find(v,[n,n])||v,a=m.convert(0,n));var s,l=r>0?r:0,u=0>r?-r:0,p=t[0],y=t[1],E=Math.min(p-u,y-l);if(c(e)){if(e.length!==E)throw new Error("Invalid value array length");s=function(t){return e[t]}}else if(e&&e.isMatrix===!0){var w=e.size();if(1!==w.length||w[0]!==E)throw new Error("Invalid matrix length");s=function(t){return e.get([t])}}else s=function(){return e};for(var b=[],x=[],_=[],S=0;y>S;S++){_.push(b.length);var T=S-l;if(T>=0&&E>T){var L=s(T);o(L,a)||(x.push(T+u),b.push(L))}}return _.push(b.length),new g({values:b,index:x,ptr:_,size:[p,y]})},g.prototype.swapRows=function(t,e){if(!(h(t)&&f(t)&&h(e)&&f(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return p(t,this._size[0]),p(e,this._size[0]),g._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},g._forEachRow=function(t,e,r,i,n){for(var o=i[t],a=i[t+1],s=o;a>s;s++)n(r[s],e[s])},g._swapRows=function(t,e,r,i,n,o){for(var a=0;r>a;a++){var s=o[a],l=o[a+1],u=_(t,s,l,n),c=_(e,s,l,n);if(l>u&&l>c&&n[u]===t&&n[c]===e){if(i){var h=i[u];i[u]=i[c],i[c]=h}}else if(l>u&&n[u]===t&&(c>=l||n[c]!==e)){var f=i?i[u]:void 0;n.splice(c,0,e),i&&i.splice(c,0,f),n.splice(u>=c?u+1:u,1),i&&i.splice(u>=c?u+1:u,1)}else if(l>c&&n[c]===e&&(u>=l||n[u]!==t)){var d=i?i[c]:void 0;n.splice(u,0,t),i&&i.splice(u,0,d),n.splice(c>=u?c+1:c,1),i&&i.splice(c>=u?c+1:c,1)}}},t.Matrix._storage.sparse=g,g}var n=r(39),o=r(42),a=n.array,s=n.object,l=n.string,u=n.number,c=Array.isArray,h=u.isNumber,f=u.isInteger,d=l.isString,p=a.validateIndex;e.name="SparseMatrix",e.path="type",e.factory=i,e.lazy=!1},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("equalScalar",{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,r){return t===r||n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.eq(r)||o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){return t.equals(e)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return a(t.value,e.value)},"string, string":function(t,e){return t===e}});return a}var n=r(6).nearlyEqual,o=r(49);e.factory=i},function(t,e){"use strict";t.exports=function(t,e,r){if(null==r)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var i=t.minus(e).abs();if(i.isZero())return!0;var n=t.constructor.max(t.abs(),e.abs());return i.lte(n.times(r))}return!1}},function(t,e,r){"use strict";function i(t,e,i){function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new t.FibonacciHeap}var o=i(r(51)),a=i(r(48));return n.prototype.type="Spa",n.prototype.isSpa=!0,n.prototype.set=function(t,e){if(this._values[t])this._values[t].value=e;else{var r=this._heap.insert(t,e);this._values[t]=r}},n.prototype.get=function(t){var e=this._values[t];return e?e.value:0},n.prototype.accumulate=function(t,e){var r=this._values[t];r?r.value=o(r.value,e):(r=this._heap.insert(t,e),this._values[t]=r)},n.prototype.forEach=function(t,e,r){var i=this._heap,n=this._values,o=[],s=i.extractMinimum();for(s&&o.push(s);s&&s.key<=e;)s.key>=t&&(a(s.value,0)||r(s.key,s.value,this)),s=i.extractMinimum(),s&&o.push(s);for(var l=0;l<o.length;l++){var u=o[l];s=i.insert(u.key,u.value),n[s.key]=s}},n.prototype.swap=function(t,e){var r=this._values[t],i=this._values[e];if(!r&&i)r=this._heap.insert(t,i.value),this._heap.remove(i),this._values[t]=r,this._values[e]=void 0;else if(r&&!i)i=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=i,this._values[t]=void 0;else if(r&&i){var n=r.value;r.value=i.value,i.value=n}},n}e.name="Spa",e.path="type",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(52)),s=i(r(53)),l=r(32),u=i(r(54)),c=i(r(55)),h=i(r(56)),f=i(r(57)),d=i(r(58)),p=o("add",n({"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,s);break;default:r=u(e,t,s,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,s,!1);break;default:r=f(t,e,s)}}return r},"Array, Array":function(t,e){return p(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return p(a(t),e)},"Matrix, Array":function(t,e){return p(t,a(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,s,!1);break;default:r=d(t,e,s,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,s,!0);break;default:r=d(e,t,s,!0)}return r},"Array, any":function(t,e){return d(a(t),e,s,!1).valueOf()},"any, Array":function(t,e){return d(a(e),t,s,!0).valueOf()}},s.signatures));return p.toTex={2:"\\left(${args[0]}"+l.operators.add+"${args[1]}\\right)"},p}var n=r(3).extend;e.name="add",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){function n(e,r,i){var n=t.Matrix.storage(r||"default");return new n(e,i)}var o=i("matrix",{"":function(){return n([])},string:function(t){return n([],t)},"string, string":function(t,e){return n([],t,e)},Array:function(t){return n(t)},Matrix:function(t){return n(t,t.storage())},"Array | Matrix, string":n,"Array | Matrix, string, string":n});return o.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},o}e.name="matrix",e.factory=r},function(t,e){"use strict";function r(t,e,r,i){var n=i("add",{"number, number":function(t,e){return t+e},"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":function(t,e){if(null==t.value)throw new Error("Parameter x contains a unit with undefined value");if(null==e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var r=t.clone();return r.value=n(r.value,e.value),r.fixPrefix=!1,r}});return n}e.factory=r},function(t,e,r){"use strict";function i(t,e,r,i){var o=t.DenseMatrix,a=function(t,e,r,a){var s=t._data,l=t._size,u=t._datatype,c=e._values,h=e._index,f=e._ptr,d=e._size,p=e._datatype;if(l.length!==d.length)throw new n(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m,g,y=l[0],v=l[1],E="string"==typeof u&&u===p?u:void 0,w=E?i.find(r,[E,E]):r,b=[];for(m=0;y>m;m++)b[m]=[];var x=[],_=[];for(g=0;v>g;g++){for(var S=g+1,T=f[g],L=f[g+1],M=T;L>M;M++)m=h[M],x[m]=a?w(c[M],s[m][g]):w(s[m][g],c[M]),_[m]=S;for(m=0;y>m;m++)_[m]===S?b[m][g]=x[m]:b[m][g]=s[m][g]}return new o({data:b,size:[y,v],datatype:E})};return a}var n=r(42);e.name="algorithm01",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r){var i=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype,f=e._values,d=e._index,p=e._ptr,m=e._size,g=e._datatype;if(c.length!==m.length)throw new n(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");var y,v=c[0],E=c[1],w=a,b=0,x=r;"string"==typeof h&&h===g&&(y=h,w=o.find(a,[y,y]),b=o.convert(0,y),x=o.find(r,[y,y]));var _,S,T,L,M,A=i&&f?[]:void 0,N=[],R=[],C=new s({values:A,index:N,ptr:R,size:[v,E],datatype:y}),P=i&&f?[]:void 0,O=i&&f?[]:void 0,I=[],k=[];for(S=0;E>S;S++){R[S]=N.length;var D=S+1;for(L=u[S],M=u[S+1],T=L;M>T;T++)_=l[T],N.push(_),I[_]=D,P&&(P[_]=i[T]);for(L=p[S],M=p[S+1],T=L;M>T;T++)if(_=d[T],I[_]===D){if(P){var V=x(P[_],f[T]);w(V,b)?I[_]=null:P[_]=V}}else N.push(_),k[_]=D,O&&(O[_]=f[T]);if(P&&O)for(T=R[S];T<N.length;)_=N[T],I[_]===D?(A[T]=P[_],T++):k[_]===D?(A[T]=O[_],T++):N.splice(T,1)}return R[E]=N.length,C};return l}var n=r(42);e.name="algorithm04",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){var n=t.DenseMatrix,o=function(t,e,r,o){var a=t._values,s=t._index,l=t._ptr,u=t._size,c=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,f=u[0],d=u[1],p=r;"string"==typeof c&&(h=c,e=i.convert(e,h),p=i.find(r,[h,h]));for(var m=[],g=new n({data:m,size:[f,d],datatype:h}),y=[],v=[],E=0;d>E;E++){for(var w=E+1,b=l[E],x=l[E+1],_=b;x>_;_++){var S=s[_];y[S]=a[_],v[S]=w}for(var T=0;f>T;T++)0===E&&(m[T]=[]),v[T]===w?m[T][E]=o?p(e,y[T]):p(y[T],e):m[T][E]=e}return g};return o}e.name="algorithm10",e.factory=r},function(t,e,r){"use strict";function i(t,e,r,i){var n=t.DenseMatrix,a=function(t,e,r){var a=t._data,l=t._size,u=t._datatype,c=e._data,h=e._size,f=e._datatype,d=[];if(l.length!==h.length)throw new o(l.length,h.length);for(var p=0;p<l.length;p++){if(l[p]!==h[p])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+h+")");d[p]=l[p]}var m,g=r;"string"==typeof u&&u===f&&(m=u,e=i.convert(e,m),g=i.find(r,[m,m]));var y=d.length>0?s(g,0,d,d[0],a,c):[];return new n({data:y,size:d,datatype:m})},s=function(t,e,r,i,n,o){var a=[];if(e===r.length-1)for(var l=0;i>l;l++)a[l]=t(n[l],o[l]);else for(var u=0;i>u;u++)a[u]=s(t,e+1,r,r[e+1],n[u],o[u]);return a};return a}var n=r(39),o=r(42),a=n.string;a.isString;e.name="algorithm13",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=t.DenseMatrix,a=function(t,e,r,a){var l,u=t._data,c=t._size,h=t._datatype,f=r;"string"==typeof h&&(l=h,e=i.convert(e,l),f=i.find(r,[l,l]));var d=c.length>0?s(f,0,c,c[0],u,e,a):[];return new o({data:d,size:n(c),datatype:l})},s=function(t,e,r,i,n,o,a){var l=[];if(e===r.length-1)for(var u=0;i>u;u++)l[u]=a?t(o,n[u]):t(n[u],o);else for(var c=0;i>c;c++)l[c]=s(t,e+1,r,r[e+1],n[c],o,a);return l};return a}var n=r(3).clone;e.name="algorithm14",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}var a=i(r(60)),s=i(r(64)),l=1/Math.log((1+Math.sqrt(5))/2);o.prototype.type="FibonacciHeap",o.prototype.isFibonacciHeap=!0,o.prototype.insert=function(t,e){var r={key:t,value:e,degree:0};if(this._minimum){var i=this._minimum;r.left=i,r.right=i.right,i.right=r,r.right.left=r,a(t,i.key)&&(this._minimum=r)}else r.left=r,r.right=r,this._minimum=r;return this._size++,r},o.prototype.size=function(){return this._size},o.prototype.clear=function(){this._minimum=null,this._size=0},o.prototype.isEmpty=function(){return!!this._minimum},o.prototype.extractMinimum=function(){var t=this._minimum;if(null===t)return t;for(var e=this._minimum,r=t.degree,i=t.child;r>0;){var n=i.right;i.left.right=i.right,i.right.left=i.left,i.left=e,i.right=e.right,e.right=i,i.right.left=i,i.parent=null,i=n,r--}return t.left.right=t.right,t.right.left=t.left,t==t.right?e=null:(e=t.right,e=d(e,this._size)),this._size--,this._minimum=e,t},o.prototype.remove=function(t){this._minimum=u(this._minimum,t,-1),this.extractMinimum()};var u=function(t,e,r){e.key=r;var i=e.parent;return i&&a(e.key,i.key)&&(c(t,e,i),h(t,i)),a(e.key,t.key)&&(t=e),t},c=function(t,e,r){e.left.right=e.right,e.right.left=e.left,r.degree--,r.child==e&&(r.child=e.right),0===r.degree&&(r.child=null),e.left=t,e.right=t.right,t.right=e,e.right.left=e,e.parent=null,e.mark=!1},h=function(t,e){var r=e.parent;r&&(e.mark?(c(t,e,r),h(r)):e.mark=!0)},f=function(t,e){t.left.right=t.right,t.right.left=t.left,t.parent=e,e.child?(t.left=e.child,t.right=e.child.right,e.child.right=t,t.right.left=t):(e.child=t,t.right=t,t.left=t),e.degree++,t.mark=!1},d=function(t,e){var r=Math.floor(Math.log(e)*l)+1,i=new Array(r),n=0,o=t;if(o)for(n++,o=o.right;o!==t;)n++,o=o.right;for(var u;n>0;){for(var c=o.degree,h=o.right;;){if(u=i[c],!u)break;if(s(o.key,u.key)){var d=u;u=o,o=d}f(u,o),i[c]=null,c++}i[c]=o,o=h,n--}t=null;for(var p=0;r>p;p++)u=i[p],u&&(t?(u.left.right=u.right,u.right.left=u.left,u.left=t,u.right=t.right,t.right=u,u.right.left=u,a(u.key,t.key)&&(t=u)):t=u);return t};return o}e.name="FibonacciHeap",e.path="type",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("smaller",{"boolean, boolean":function(t,e){return e>t},"number, number":function(t,r){return r>t&&!n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.lt(r)&&!o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return-1===t.compare(e)},"Complex, Complex":function(t,e){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return e>t},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,p);break;default:r=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,p,!1);break;default:r=h(t,e,p)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=f(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,p,!0);break;default:r=f(e,t,p,!0)}return r},"Array, any":function(t,e){return f(s(t),e,p,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+d.operators.smaller+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="smaller",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=t.DenseMatrix,a=function(t,e,r,a){var s=t._data,l=t._size,u=t._datatype,c=e._values,h=e._index,f=e._ptr,d=e._size,p=e._datatype;if(l.length!==d.length)throw new n(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m,g=l[0],y=l[1],v=0,E=r;"string"==typeof u&&u===p&&(m=u,v=i.convert(0,m),E=i.find(r,[m,m]));for(var w=[],b=0;g>b;b++)w[b]=[];for(var x=[],_=[],S=0;y>S;S++){for(var T=S+1,L=f[S],M=f[S+1],A=L;M>A;A++){var N=h[A];x[N]=a?E(c[A],s[N][S]):E(s[N][S],c[A]),_[N]=T}for(var R=0;g>R;R++)_[R]===T?w[R][S]=x[R]:w[R][S]=a?E(v,s[R][S]):E(s[R][S],v)}return new o({data:w,size:[g,y],datatype:m})};return a}var n=r(42);e.name="algorithm03",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=t.DenseMatrix,a=function(t,e,r){var a=t._size,l=t._datatype,u=e._size,c=e._datatype;if(a.length!==u.length)throw new n(a.length,u.length);if(a[0]!==u[0]||a[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+u+")");var h,f=a[0],d=a[1],p=0,m=r;"string"==typeof l&&l===c&&(h=l,p=i.convert(0,h),m=i.find(r,[h,h]));var g,y,v=[];for(g=0;f>g;g++)v[g]=[];var E=new o({data:v,size:[f,d],datatype:h}),w=[],b=[],x=[],_=[];for(y=0;d>y;y++){var S=y+1;for(s(t,y,x,w,S),s(e,y,_,b,S),g=0;f>g;g++){var T=x[g]===S?w[g]:p,L=_[g]===S?b[g]:p;v[g][y]=m(T,L)}}return E},s=function(t,e,r,i,n){for(var o=t._values,a=t._index,s=t._ptr,l=s[e],u=s[e+1];u>l;l++){var c=a[l];r[c]=n,i[c]=o[l]}};return a}var n=r(42);e.name="algorithm07",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){var n=t.DenseMatrix,o=function(t,e,r,o){var a=t._values,s=t._index,l=t._ptr,u=t._size,c=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,f=u[0],d=u[1],p=r;"string"==typeof c&&(h=c,e=i.convert(e,h),p=i.find(r,[h,h]));for(var m=[],g=new n({data:m,size:[f,d],datatype:h}),y=[],v=[],E=0;d>E;E++){for(var w=E+1,b=l[E],x=l[E+1],_=b;x>_;_++){var S=s[_];y[S]=a[_],v[S]=w}for(var T=0;f>T;T++)0===E&&(m[T]=[]),v[T]===w?m[T][E]=o?p(e,y[T]):p(y[T],e):m[T][E]=o?p(e,0):p(0,e)}return g};return o}e.name="algorithm12",e.factory=r},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("larger",{"boolean, boolean":function(t,e){return t>e},"number, number":function(t,r){return t>r&&!n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.gt(r)&&!o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return 1===t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return t>e},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,p);break;default:r=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,p,!1);break;default:r=h(t,e,p)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=f(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,p,!0);break;default:r=f(e,t,p,!0)}return r},"Array, any":function(t,e){return f(s(t),e,p,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+d.operators.larger+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="larger",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!l(e))throw new Error("Invalid datatype: "+e);if(t&&t.isMatrix===!0||s(t)){var r=new u(t,e);this._data=r._data,this._size=r._size,this._datatype=r._datatype,this._min=null,this._max=null}else if(t&&s(t.data)&&s(t.size))this._data=t.data,this._size=t.size,this._datatype=t.datatype,this._min="undefined"!=typeof t.min?t.min:null,this._max="undefined"!=typeof t.max?t.max:null;else{if(t)throw new TypeError("Unsupported type of data ("+n.types.type(t)+")");this._data=[],this._size=[0],this._datatype=e,this._min=null,this._max=null}}var u=i(r(46)),c=i(r(60));return o.prototype=new u,o.prototype.type="ImmutableDenseMatrix",o.prototype.isImmutableDenseMatrix=!0,o.prototype.subset=function(t){switch(arguments.length){case 1:var e=u.prototype.subset.call(this,t);return e.isMatrix?new o({data:e._data,size:e._size,datatype:e._datatype}):e;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},o.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},o.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},o.prototype.clone=function(){var t=new o({data:a.clone(this._data),size:a.clone(this._size),datatype:this._datatype});return t},o.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},o.fromJSON=function(t){return new o(t)},o.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},o.prototype.min=function(){if(null===this._min){var t=null;this.forEach(function(e){(null===t||c(e,t))&&(t=e)}),this._min=null!==t?t:void 0}return this._min},o.prototype.max=function(){if(null===this._max){var t=null;this.forEach(function(e){(null===t||c(t,e))&&(t=e)}),this._max=null!==t?t:void 0}return this._max},o}var n=r(39),o=n.string,a=n.object,s=Array.isArray,l=o.isString;e.name="ImmutableDenseMatrix",e.path="type",e.factory=i},function(t,e,r){"use strict";function i(t){function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var i=0,n=arguments.length;n>i;i++){var o=arguments[i];if(o&&o.isRange===!0)this._dimensions.push(o),this._isScalar=!1;else if(o&&(Array.isArray(o)||o.isMatrix===!0)){var a=r(o.valueOf());this._dimensions.push(a);var s=a.size();(1!==s.length||1!==s[0])&&(this._isScalar=!1)}else if("number"==typeof o)this._dimensions.push(r([o]));else{if("string"!=typeof o)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(o)}}}function r(e){for(var r=0,i=e.length;i>r;r++)if("number"!=typeof e[r]||!o(e[r]))throw new TypeError("Index parameters must be positive integer numbers");return new t.ImmutableDenseMatrix(e)}return e.prototype.type="Index",e.prototype.isIndex=!0,e.prototype.clone=function(){var t=new e;return t._dimensions=n(this._dimensions),t._isScalar=this._isScalar,t},e.create=function(t){var r=new e;return e.apply(r,t),r},e.prototype.size=function(){for(var t=[],e=0,r=this._dimensions.length;r>e;e++){var i=this._dimensions[e];t[e]="string"==typeof i?1:i.size()[0]}return t},e.prototype.max=function(){for(var t=[],e=0,r=this._dimensions.length;r>e;e++){var i=this._dimensions[e];t[e]="string"==typeof i?i:i.max()}return t},e.prototype.min=function(){for(var t=[],e=0,r=this._dimensions.length;r>e;e++){var i=this._dimensions[e];t[e]="string"==typeof i?i:i.min()}return t},e.prototype.forEach=function(t){for(var e=0,r=this._dimensions.length;r>e;e++)t(this._dimensions[e],e,this)},e.prototype.dimension=function(t){return this._dimensions[t]||null},e.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},e.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},e.prototype.isScalar=function(){return this._isScalar},e.prototype.toArray=function(){for(var t=[],e=0,r=this._dimensions.length;r>e;e++){var i=this._dimensions[e];t.push("string"==typeof i?i:i.toArray())}return t},e.prototype.valueOf=e.prototype.toArray,e.prototype.toString=function(){for(var t=[],e=0,r=this._dimensions.length;r>e;e++){var i=this._dimensions[e];"string"==typeof i?t.push(JSON.stringify(i)):t.push(i.toString())}return"["+t.join(", ")+"]"},e.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},e.fromJSON=function(t){return e.create(t.dimensions)},e}var n=r(3).clone,o=r(6).isInteger;e.name="Index",e.path="type",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){function o(t,e,r){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(null!=t)if(t.isBigNumber===!0)t=t.toNumber();else if("number"!=typeof t)throw new TypeError("Parameter start must be a number");if(null!=e)if(e.isBigNumber===!0)e=e.toNumber();else if("number"!=typeof e)throw new TypeError("Parameter end must be a number");if(null!=r)if(r.isBigNumber===!0)r=r.toNumber();else if("number"!=typeof r)throw new TypeError("Parameter step must be a number");this.start=null!=t?parseFloat(t):0,this.end=null!=e?parseFloat(e):0,this.step=null!=r?parseFloat(r):1}return o.prototype.type="Range",o.prototype.isRange=!0,o.parse=function(t){if("string"!=typeof t)return null;var e=t.split(":"),r=e.map(function(t){return parseFloat(t)}),i=r.some(function(t){return isNaN(t)});if(i)return null;switch(r.length){case 2:return new o(r[0],r[1]);case 3:return new o(r[0],r[2],r[1]);default:return null}},o.prototype.clone=function(){return new o(this.start,this.end,this.step)},o.prototype.size=function(){var t=0,e=this.start,r=this.step,i=this.end,o=i-e;return n.sign(r)==n.sign(o)?t=Math.ceil(o/r):0==o&&(t=0),isNaN(t)&&(t=0),[t]},o.prototype.min=function(){var t=this.size()[0];return t>0?this.step>0?this.start:this.start+(t-1)*this.step:void 0},o.prototype.max=function(){var t=this.size()[0];return t>0?this.step>0?this.start+(t-1)*this.step:this.start:void 0},o.prototype.forEach=function(t){var e=this.start,r=this.step,i=this.end,n=0;if(r>0)for(;i>e;)t(e,[n],this),e+=r,n++;else if(0>r)for(;e>i;)t(e,[n],this),e+=r,n++},o.prototype.map=function(t){var e=[];return this.forEach(function(r,i,n){e[i[0]]=t(r,i,n)}),e},o.prototype.toArray=function(){var t=[];return this.forEach(function(e,r){t[r[0]]=e}),t},o.prototype.valueOf=function(){return this.toArray()},o.prototype.format=function(t){var e=n.format(this.start,t);return 1!=this.step&&(e+=":"+n.format(this.step,t)),e+=":"+n.format(this.end,t)},o.prototype.toString=function(){return this.format()},o.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},o.fromJSON=function(t){return new o(t.start,t.end,t.step)},o}var n=r(6);e.name="Range",e.path="type",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){return i("index",{"...number | string | BigNumber | Range | Array | Matrix":function(e){var r=e.map(function(t){return t&&t.isBigNumber===!0?t.toNumber():t&&(Array.isArray(t)||t.isMatrix===!0)?t.map(function(t){return t&&t.isBigNumber===!0?t.toNumber():t}):t}),i=new t.Index;return t.Index.apply(i,r),i}})}e.name="index",e.factory=r},function(t,e){"use strict";function r(t,e,r,i){var n=t.SparseMatrix,o=i("sparse",{"":function(){return new n([])},string:function(t){return new n([],t)},"Array | Matrix":function(t){return new n(t)},"Array | Matrix, string":function(t,e){return new n(t,e)}});return o.toTex={0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},o}e.name="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("number",{"":function(){return 0},number:function(t){return t},string:function(t){var e=Number(t);if(isNaN(e))throw new SyntaxError('String "'+t+'" is no valid number');return e},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:function(t){throw new Error("Second argument with valueless unit expected")},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},o}var n=r(19);e.name="number",e.factory=i},function(t,e,r){t.exports=[r(72)]},function(t,e){"use strict";function r(t,e,r,i){function n(t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.entries=t||[]}return n.prototype.type="ResultSet",n.prototype.isResultSet=!0,n.prototype.valueOf=function(){return this.entries},n.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},n.fromJSON=function(t){return new n(t.entries)},n}e.name="ResultSet",e.path="type",e.factory=r},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("string",{"":function(){return""},number:o.format,"null":function(t){return"null"},"boolean":function(t){return t+""},string:function(t){return t},"Array | Matrix":function(t){return n(t,a)},any:function(t){return String(t)}});return a.toTex={0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},a}var n=r(19),o=r(6);e.name="string",e.factory=i},function(t,e,r){t.exports=[r(75),r(96),r(97),r(98),r(99)]},function(t,e,r){"use strict";function i(t,e,i,s,l){function u(t,e){if(!(this instanceof u))throw new Error("Constructor must be called with the new operator");
if(void 0!==t&&!N(t)&&!t.isComplex)throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(void 0!=e&&("string"!=typeof e||""==e))throw new TypeError("Second parameter in Unit constructor must be a string");if(void 0!=e){var r=u.parse(e);this.units=r.units,this.dimensions=r.dimensions}else{this.units=[{unit:j,prefix:F.NONE,power:0}],this.dimensions=[];for(var i=0;i<B.length;i++)this.dimensions[i]=0}this.value=void 0!=t?this._normalize(t):null,this.fixPrefix=!1,this.isUnitListSimplified=!0}function c(){for(;" "==D||"	"==D;)d()}function h(t){return t>="0"&&"9">=t||"."==t}function f(t){return t>="0"&&"9">=t}function d(){k++,D=I.charAt(k)}function p(t){k=t,D=I.charAt(k)}function m(){var t,e="";if(t=k,"+"==D?d():"-"==D&&(e+=D,d()),!h(D))return p(t),null;if("."==D){if(e+=D,d(),!f(D))return p(t),null}else{for(;f(D);)e+=D,d();"."==D&&(e+=D,d())}for(;f(D);)e+=D,d();if("E"==D||"e"==D){var r="",i=k;if(r+=D,d(),("+"==D||"-"==D)&&(r+=D,d()),!f(D))return p(i),e;for(e+=r;f(D);)e+=D,d()}return e}function g(){for(var t="",e=I.charCodeAt(k);e>=48&&57>=e||e>=65&&90>=e||e>=97&&122>=e;)t+=D,d(),e=I.charCodeAt(k);return e=t.charCodeAt(0),e>=65&&90>=e||e>=97&&122>=e?t||null:null}function y(t){return D===t?(d(),t):null}function v(t){if(z.hasOwnProperty(t)){var e=z[t],r=e.prefixes[""];return{unit:e,prefix:r}}for(var i in z)if(z.hasOwnProperty(i)&&n(t,i)){var e=z[i],o=t.length-i.length,a=t.substring(0,o),r=e.prefixes[a];if(void 0!==r)return{unit:e,prefix:r}}return null}function E(e){if("BigNumber"===e.number){var r=a.pi(t.BigNumber);z.rad.value=new t.BigNumber(1),z.deg.value=r.div(180),z.grad.value=r.div(200),z.cycle.value=r.times(2),z.arcsec.value=r.div(648e3),z.arcmin.value=r.div(10800)}else z.rad.value=1,z.deg.value=Math.PI/180,z.grad.value=Math.PI/200,z.cycle.value=2*Math.PI,z.arcsec.value=Math.PI/648e3,z.arcmin.value=Math.PI/10800}function w(t){for(var e=0;e<t.length;e++){var r=t.charAt(e),i=function(t){return/^[a-zA-Z]$/.test(t)},n=function(t){return t>="0"&&"9">=t};if(0===e&&!i(r))throw new Error('Invalid unit name (must begin with alpha character): "'+t+'"');if(e>0&&!i(r)&&!n(r))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+t+'"')}}var b=i(r(53)),x=i(r(77)),_=i(r(80)),S=i(r(81)),T=i(r(82)),L=i(r(86)),M=i(r(87)),A=i(r(88)),N=i(r(89)),R=i(r(90)),C=i(r(91)),P=i(r(70)),O=i(r(27));u.prototype.type="Unit",u.prototype.isUnit=!0;var I,k,D;u.parse=function(r,i){if(i=i||{},I=r,k=-1,D="","string"!=typeof I)throw new TypeError("Invalid argument in Unit.parse, string expected");var n=new u;n.units=[],d(),c();var o=m(),a=null;o&&(a="BigNumber"===e.number?new t.BigNumber(o):"Fraction"===e.number?new t.Fraction(o):parseFloat(o)),c();for(var s=1,l=!1,h=[],f=1;;){for(c();"("===D;)h.push(s),f*=s,s=1,d(),c();if(!D)break;var p=D,E=g();if(null==E)throw new SyntaxError('Unexpected "'+p+'" in "'+I+'" at index '+k.toString());var w=v(E);if(null==w)throw new SyntaxError('Unit "'+E+'" not found.');var b=s*f;if(c(),y("^")){c();var x=m();if(null==x)throw new SyntaxError('In "'+r+'", "^" must be followed by a floating-point number');b*=x}n.units.push({unit:w.unit,prefix:w.prefix,power:b});for(var _=0;_<B.length;_++)n.dimensions[_]+=(w.unit.dimensions[_]||0)*b;for(c();")"===D;){if(0===h.length)throw new SyntaxError('Unmatched ")" in "'+I+'" at index '+k.toString());f/=h.pop(),d(),c()}if(l=!1,y("*")?(s=1,l=!0):y("/")?(s=-1,l=!0):s=1,w.unit.base){var S=w.unit.base.key;q.auto[S]={unit:w.unit,prefix:w.prefix}}}if(c(),D)throw new SyntaxError('Could not parse: "'+r+'"');if(l)throw new SyntaxError('Trailing characters: "'+r+'"');if(0!==h.length)throw new SyntaxError('Unmatched "(" in "'+I+'"');if(0==n.units.length&&!i.allowNoUnits)throw new SyntaxError('"'+r+'" contains no units');return n.value=void 0!=a?n._normalize(a):null,n},u.prototype.clone=function(){var t=new u;t.fixPrefix=this.fixPrefix,t.isUnitListSimplified=this.isUnitListSimplified,t.value=o(this.value),t.dimensions=this.dimensions.slice(0),t.units=[];for(var e=0;e<this.units.length;e++){t.units[e]={};for(var r in this.units[e])this.units[e].hasOwnProperty(r)&&(t.units[e][r]=this.units[e][r])}return t},u.prototype._isDerived=function(){return 0===this.units.length?!1:this.units.length>1||Math.abs(this.units[0].power-1)>1e-15},u.prototype._normalize=function(t){var e,r,i,n,o;if(null==t||0===this.units.length)return t;if(this._isDerived()){var a=t;o=u._getNumberConverter(C(t));for(var s=0;s<this.units.length;s++)e=o(this.units[s].unit.value),n=o(this.units[s].prefix.value),i=o(this.units[s].power),a=_(a,T(_(e,n),i));return a}return o=u._getNumberConverter(C(t)),e=o(this.units[0].unit.value),r=o(this.units[0].unit.offset),n=o(this.units[0].prefix.value),_(b(t,r),_(e,n))},u.prototype._denormalize=function(t,e){var r,i,n,o,a;if(null==t||0===this.units.length)return t;if(this._isDerived()){var s=t;a=u._getNumberConverter(C(t));for(var l=0;l<this.units.length;l++)r=a(this.units[l].unit.value),o=a(this.units[l].prefix.value),n=a(this.units[l].power),s=S(s,T(_(r,o),n));return s}return a=u._getNumberConverter(C(t)),r=a(this.units[0].unit.value),o=a(this.units[0].prefix.value),i=a(this.units[0].unit.offset),void 0==e?x(S(S(t,r),o),i):x(S(S(t,r),e),i)},u.isValuelessUnit=function(t){return null!=v(t)},u.prototype.hasBase=function(t){if("string"==typeof t&&(t=W[t]),!t)return!1;for(var e=0;e<B.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},u.prototype.equalBase=function(t){for(var e=0;e<B.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},u.prototype.equals=function(t){return this.equalBase(t)&&A(this.value,t.value)},u.prototype.multiply=function(t){for(var e=this.clone(),r=0;r<B.length;r++)e.dimensions[r]=(this.dimensions[r]||0)+(t.dimensions[r]||0);for(var r=0;r<t.units.length;r++){var i={};for(var n in t.units[r])i[n]=t.units[r][n];e.units.push(i)}if(null!=this.value||null!=t.value){var o=null==this.value?this._normalize(1):this.value,a=null==t.value?t._normalize(1):t.value;e.value=_(o,a)}else e.value=null;return e.isUnitListSimplified=!1,V(e)},u.prototype.divide=function(t){for(var e=this.clone(),r=0;r<B.length;r++)e.dimensions[r]=(this.dimensions[r]||0)-(t.dimensions[r]||0);for(var r=0;r<t.units.length;r++){var i={};for(var n in t.units[r])i[n]=t.units[r][n];i.power=-i.power,e.units.push(i)}if(null!=this.value||null!=t.value){var o=null==this.value?this._normalize(1):this.value,a=null==t.value?t._normalize(1):t.value;e.value=S(o,a)}else e.value=null;return e.isUnitListSimplified=!1,V(e)},u.prototype.pow=function(t){for(var e=this.clone(),r=0;r<B.length;r++)e.dimensions[r]=(this.dimensions[r]||0)*t;for(var r=0;r<e.units.length;r++)e.units[r].power*=t;return null!=e.value?e.value=T(e.value,t):e.value=null,e.isUnitListSimplified=!1,V(e)};var V=function(t){return t.equalBase(W.NONE)&&null!==t.value&&!e.predictable?t.value:t};u.prototype.abs=function(){var t=this.clone();t.value=L(t.value);for(var e in t.units)("VA"===t.units[e].unit.name||"VAR"===t.units[e].unit.name)&&(t.units[e].unit=z.W);return t},u.prototype.to=function(t){var e,r=null==this.value?this._normalize(1):this.value;if("string"==typeof t){if(e=u.parse(t),!this.equalBase(e))throw new Error("Units do not match");if(null!==e.value)throw new Error("Cannot convert to a unit with a value");return e.value=o(r),e.fixPrefix=!0,e.isUnitListSimplified=!0,e}if(t&&t.isUnit){if(!this.equalBase(t))throw new Error("Units do not match");if(null!==t.value)throw new Error("Cannot convert to a unit with a value");return e=t.clone(),e.value=o(r),e.fixPrefix=!0,e.isUnitListSimplified=!0,e}throw new Error("String or Unit expected as parameter")},u.prototype.toNumber=function(t){return P(this.toNumeric(t))},u.prototype.toNumeric=function(t){var e=this;return t&&(e=this.to(t)),e._isDerived()?e._denormalize(e.value):e._denormalize(e.value,e.units[0].prefix.value)},u.prototype.toString=function(){return this.format()},u.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},u.fromJSON=function(t){var e=new u(t.value,t.unit);return e.fixPrefix=t.fixPrefix||!1,e},u.prototype.valueOf=u.prototype.toString,u.prototype.simplifyUnitListLazy=function(){if(!this.isUnitListSimplified&&null!=this.value){var t,e=[];for(var i in H)if(this.hasBase(W[i])){t=i;break}if("NONE"===t)this.units=[];else{var n;t&&H.hasOwnProperty(t)&&(n=H[t]);if(n)this.units=[{unit:n.unit,prefix:n.prefix,power:1}];else{for(var o=!1,a=0;a<B.length;a++){var s=B[a];Math.abs(this.dimensions[a]||0)>1e-12&&(H.hasOwnProperty(s)?e.push({unit:H[s].unit,prefix:H[s].prefix,power:this.dimensions[a]||0}):o=!0)}r(92);e.length<this.units.length&&!o&&(this.units=e)}}this.isUnitListSimplified=!0}},u.prototype.formatUnits=function(){this.simplifyUnitListLazy();for(var t="",e="",r=0,i=0,n=0;n<this.units.length;n++)this.units[n].power>0?(r++,t+=" "+this.units[n].prefix.name+this.units[n].unit.name,Math.abs(this.units[n].power-1)>1e-15&&(t+="^"+this.units[n].power)):this.units[n].power<0&&i++;if(i>0)for(var n=0;n<this.units.length;n++)this.units[n].power<0&&(r>0?(e+=" "+this.units[n].prefix.name+this.units[n].unit.name,Math.abs(this.units[n].power+1)>1e-15&&(e+="^"+-this.units[n].power)):(e+=" "+this.units[n].prefix.name+this.units[n].unit.name,e+="^"+this.units[n].power));t=t.substr(1),e=e.substr(1),r>1&&i>0&&(t="("+t+")"),i>1&&r>0&&(e="("+e+")");var o=t;return r>0&&i>0&&(o+=" / "),o+=e},u.prototype.format=function(t){this.simplifyUnitListLazy();var e=!1,r=!0;"undefined"!=typeof this.value&&null!==this.value&&this.value.isComplex&&(e=Math.abs(this.value.re)<1e-14,r=Math.abs(this.value.im)<1e-14);for(var i in this.units)this.units[i].unit&&("VA"===this.units[i].unit.name&&e?this.units[i].unit=z.VAR:"VAR"!==this.units[i].unit.name||e||(this.units[i].unit=z.VA));1!==this.units.length||this.fixPrefix||Math.abs(this.units[0].power-Math.round(this.units[0].power))<1e-14&&(this.units[0].prefix=this._bestPrefix());var n=this._denormalize(this.value),o=null!==this.value?R(n,t||{}):"",a=this.formatUnits();return this.value&&this.value.isComplex&&(o="("+o+")"),a.length>0&&o.length>0&&(o+=" "),o+=a},u.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var t=L(this.value),e=L(this.units[0].unit.value),r=this.units[0].prefix;if(0===t)return r;var i=this.units[0].power,n=Math.abs(Math.log(t/Math.pow(r.value*e,i))/Math.LN10-1.2),o=this.units[0].unit.prefixes;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];if(s.scientific){var l=Math.abs(Math.log(t/Math.pow(s.value*e,i))/Math.LN10-1.2);(n>l||l===n&&s.name.length<r.name.length)&&(r=s,n=l)}}return r},u.prototype.splitUnit=function(t){for(var e=this.clone(),r=[],i=0;i<t.length&&(e=e.to(t[i]),i!=t.length-1);i++){var n=M(e.toNumeric()),o=new u(n,t[i].toString());r.push(o),e=x(e,o)}return r.push(e),r};var F={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};F.SHORTLONG={};for(var G in F.SHORT)F.SHORT.hasOwnProperty(G)&&(F.SHORTLONG[G]=F.SHORT[G]);for(var G in F.LONG)F.LONG.hasOwnProperty(G)&&(F.SHORTLONG[G]=F.LONG[G]);var B=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],W={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var G in W)W[G].key=G;var U={},j={name:"",base:U,value:1,offset:0,dimensions:[0,0,0,0,0,0,0,0,0]},z={meter:{name:"meter",base:W.LENGTH,prefixes:F.LONG,value:1,offset:0},inch:{name:"inch",base:W.LENGTH,prefixes:F.NONE,value:.0254,offset:0},foot:{name:"foot",base:W.LENGTH,prefixes:F.NONE,value:.3048,offset:0},yard:{name:"yard",base:W.LENGTH,prefixes:F.NONE,value:.9144,offset:0},mile:{name:"mile",base:W.LENGTH,prefixes:F.NONE,value:1609.344,offset:0},link:{name:"link",base:W.LENGTH,prefixes:F.NONE,value:.201168,offset:0},rod:{name:"rod",base:W.LENGTH,prefixes:F.NONE,value:5.02921,offset:0},chain:{name:"chain",base:W.LENGTH,prefixes:F.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:W.LENGTH,prefixes:F.NONE,value:1e-10,offset:0},m:{name:"m",base:W.LENGTH,prefixes:F.SHORT,value:1,offset:0},"in":{name:"in",base:W.LENGTH,prefixes:F.NONE,value:.0254,offset:0},ft:{name:"ft",base:W.LENGTH,prefixes:F.NONE,value:.3048,offset:0},yd:{name:"yd",base:W.LENGTH,prefixes:F.NONE,value:.9144,offset:0},mi:{name:"mi",base:W.LENGTH,prefixes:F.NONE,value:1609.344,offset:0},li:{name:"li",base:W.LENGTH,prefixes:F.NONE,value:.201168,offset:0},rd:{name:"rd",base:W.LENGTH,prefixes:F.NONE,value:5.02921,offset:0},ch:{name:"ch",base:W.LENGTH,prefixes:F.NONE,value:20.1168,offset:0},mil:{name:"mil",base:W.LENGTH,prefixes:F.NONE,value:254e-7,offset:0},m2:{name:"m2",base:W.SURFACE,prefixes:F.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:W.SURFACE,prefixes:F.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:W.SURFACE,prefixes:F.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:W.SURFACE,prefixes:F.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:W.SURFACE,prefixes:F.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:W.SURFACE,prefixes:F.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:W.SURFACE,prefixes:F.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:W.SURFACE,prefixes:F.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:W.SURFACE,prefixes:F.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:W.SURFACE,prefixes:F.NONE,value:1e4,offset:0},m3:{name:"m3",base:W.VOLUME,prefixes:F.CUBIC,value:1,offset:0},L:{name:"L",base:W.VOLUME,prefixes:F.SHORT,value:.001,offset:0},l:{name:"l",base:W.VOLUME,prefixes:F.SHORT,value:.001,offset:0},litre:{name:"litre",base:W.VOLUME,prefixes:F.LONG,value:.001,offset:0},cuin:{name:"cuin",base:W.VOLUME,prefixes:F.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:W.VOLUME,prefixes:F.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:W.VOLUME,prefixes:F.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:W.VOLUME,prefixes:F.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:W.VOLUME,prefixes:F.NONE,value:15e-6,offset:0},drop:{name:"drop",base:W.VOLUME,prefixes:F.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:W.VOLUME,prefixes:F.NONE,value:5e-8,offset:0},minim:{name:"minim",base:W.VOLUME,prefixes:F.NONE,value:6.161152e-8,offset:0},fluiddram:{name:"fluiddram",base:W.VOLUME,prefixes:F.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:W.VOLUME,prefixes:F.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:W.VOLUME,prefixes:F.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:W.VOLUME,prefixes:F.NONE,value:1e-6,offset:0},cup:{name:"cup",base:W.VOLUME,prefixes:F.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:W.VOLUME,prefixes:F.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:W.VOLUME,prefixes:F.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:W.VOLUME,prefixes:F.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:W.VOLUME,prefixes:F.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:W.VOLUME,prefixes:F.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:W.VOLUME,prefixes:F.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:W.VOLUME,prefixes:F.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:W.VOLUME,prefixes:F.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:W.VOLUME,prefixes:F.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:W.VOLUME,prefixes:F.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:W.VOLUME,prefixes:F.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:W.VOLUME,prefixes:F.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:W.VOLUME,prefixes:F.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:W.VOLUME,prefixes:F.NONE,value:.1173478,offset:0},obl:{name:"obl",base:W.VOLUME,prefixes:F.NONE,value:.1589873,offset:0},g:{name:"g",base:W.MASS,prefixes:F.SHORT,value:.001,offset:0},gram:{name:"gram",base:W.MASS,prefixes:F.LONG,value:.001,offset:0},ton:{name:"ton",base:W.MASS,prefixes:F.SHORT,value:907.18474,offset:0},tonne:{name:"tonne",base:W.MASS,prefixes:F.SHORT,value:1e3,offset:0},grain:{name:"grain",base:W.MASS,prefixes:F.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:W.MASS,prefixes:F.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:W.MASS,prefixes:F.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:W.MASS,prefixes:F.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:W.MASS,prefixes:F.NONE,value:45.359237,offset:0},stick:{name:"stick",base:W.MASS,prefixes:F.NONE,value:.115,offset:0},stone:{name:"stone",base:W.MASS,prefixes:F.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:W.MASS,prefixes:F.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:W.MASS,prefixes:F.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:W.MASS,prefixes:F.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:W.MASS,prefixes:F.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:W.MASS,prefixes:F.NONE,value:45.359237,offset:0},s:{name:"s",base:W.TIME,prefixes:F.SHORT,value:1,offset:0},min:{name:"min",base:W.TIME,prefixes:F.NONE,value:60,offset:0},h:{name:"h",base:W.TIME,prefixes:F.NONE,value:3600,offset:0},second:{name:"second",base:W.TIME,prefixes:F.LONG,value:1,offset:0},sec:{name:"sec",base:W.TIME,prefixes:F.LONG,value:1,offset:0},minute:{name:"minute",base:W.TIME,prefixes:F.NONE,value:60,offset:0},hour:{name:"hour",base:W.TIME,prefixes:F.NONE,value:3600,offset:0},day:{name:"day",base:W.TIME,prefixes:F.NONE,value:86400,offset:0},week:{name:"week",base:W.TIME,prefixes:F.NONE,value:604800,offset:0},month:{name:"month",base:W.TIME,prefixes:F.NONE,value:2629800,offset:0},year:{name:"year",base:W.TIME,prefixes:F.NONE,value:31557600,offset:0},decade:{name:"year",base:W.TIME,prefixes:F.NONE,value:315576e3,offset:0},century:{name:"century",base:W.TIME,prefixes:F.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:W.TIME,prefixes:F.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:W.FREQUENCY,prefixes:F.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:W.FREQUENCY,prefixes:F.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:W.ANGLE,prefixes:F.NONE,value:1,offset:0},deg:{name:"deg",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},grad:{name:"grad",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},cycle:{name:"cycle",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},A:{name:"A",base:W.CURRENT,prefixes:F.SHORT,value:1,offset:0},ampere:{name:"ampere",base:W.CURRENT,prefixes:F.LONG,value:1,offset:0},K:{name:"K",base:W.TEMPERATURE,prefixes:F.NONE,value:1,offset:0},degC:{name:"degC",base:W.TEMPERATURE,prefixes:F.NONE,value:1,offset:273.15},degF:{name:"degF",base:W.TEMPERATURE,prefixes:F.NONE,value:1/1.8,offset:459.67},degR:{name:"degR",base:W.TEMPERATURE,prefixes:F.NONE,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:W.TEMPERATURE,prefixes:F.NONE,value:1,offset:0},celsius:{name:"celsius",base:W.TEMPERATURE,prefixes:F.NONE,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:W.TEMPERATURE,prefixes:F.NONE,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:W.TEMPERATURE,prefixes:F.NONE,value:1/1.8,offset:0},mol:{name:"mol",base:W.AMOUNT_OF_SUBSTANCE,prefixes:F.SHORT,value:1,offset:0},mole:{name:"mole",base:W.AMOUNT_OF_SUBSTANCE,prefixes:F.LONG,value:1,offset:0},cd:{name:"cd",base:W.LUMINOUS_INTENSITY,prefixes:F.NONE,value:1,offset:0},candela:{name:"candela",base:W.LUMINOUS_INTENSITY,prefixes:F.NONE,value:1,offset:0},N:{name:"N",base:W.FORCE,prefixes:F.SHORT,value:1,offset:0},newton:{name:"newton",base:W.FORCE,prefixes:F.LONG,value:1,offset:0},dyn:{name:"dyn",base:W.FORCE,prefixes:F.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:W.FORCE,prefixes:F.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:W.FORCE,prefixes:F.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:W.FORCE,prefixes:F.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:W.FORCE,prefixes:F.LONG,value:4448.2216,offset:0},J:{name:"J",base:W.ENERGY,prefixes:F.SHORT,value:1,offset:0},joule:{name:"joule",base:W.ENERGY,prefixes:F.SHORT,value:1,offset:0},erg:{name:"erg",base:W.ENERGY,prefixes:F.NONE,value:1e-5,offset:0},Wh:{name:"Wh",base:W.ENERGY,prefixes:F.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:W.ENERGY,prefixes:F.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:W.ENERGY,prefixes:F.SHORT,value:1.602176565e-19,offset:0},electronvolt:{name:"electronvolt",base:W.ENERGY,prefixes:F.LONG,value:1.602176565e-19,offset:0},W:{name:"W",base:W.POWER,prefixes:F.SHORT,value:1,offset:0},watt:{name:"W",base:W.POWER,prefixes:F.LONG,value:1,offset:0},hp:{name:"hp",base:W.POWER,prefixes:F.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:W.POWER,prefixes:F.SHORT,value:O.I,offset:0},VA:{name:"VA",base:W.POWER,prefixes:F.SHORT,value:1,offset:0},Pa:{name:"Pa",base:W.PRESSURE,prefixes:F.SHORT,value:1,offset:0},psi:{name:"psi",base:W.PRESSURE,prefixes:F.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:W.PRESSURE,prefixes:F.NONE,value:101325,offset:0},bar:{name:"bar",base:W.PRESSURE,prefixes:F.NONE,value:1e5,offset:0},torr:{name:"torr",base:W.PRESSURE,prefixes:F.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:W.PRESSURE,prefixes:F.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:W.PRESSURE,prefixes:F.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:W.PRESSURE,prefixes:F.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:W.ELECTRIC_CHARGE,prefixes:F.LONG,value:1,offset:0},C:{name:"C",base:W.ELECTRIC_CHARGE,prefixes:F.SHORT,value:1,offset:0},farad:{name:"farad",base:W.ELECTRIC_CAPACITANCE,prefixes:F.LONG,value:1,offset:0},F:{name:"F",base:W.ELECTRIC_CAPACITANCE,prefixes:F.SHORT,value:1,offset:0},volt:{name:"volt",base:W.ELECTRIC_POTENTIAL,prefixes:F.LONG,value:1,offset:0},V:{name:"V",base:W.ELECTRIC_POTENTIAL,prefixes:F.SHORT,value:1,offset:0},ohm:{name:"ohm",base:W.ELECTRIC_RESISTANCE,prefixes:F.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:W.ELECTRIC_INDUCTANCE,prefixes:F.LONG,value:1,offset:0},H:{name:"H",base:W.ELECTRIC_INDUCTANCE,prefixes:F.SHORT,value:1,offset:0},siemens:{name:"siemens",base:W.ELECTRIC_CONDUCTANCE,prefixes:F.LONG,value:1,offset:0},S:{name:"S",base:W.ELECTRIC_CONDUCTANCE,prefixes:F.SHORT,value:1,offset:0},weber:{name:"weber",base:W.MAGNETIC_FLUX,prefixes:F.LONG,value:1,offset:0},Wb:{name:"Wb",base:W.MAGNETIC_FLUX,prefixes:F.SHORT,value:1,offset:0},tesla:{name:"tesla",base:W.MAGNETIC_FLUX_DENSITY,prefixes:F.LONG,value:1,offset:0},T:{name:"T",base:W.MAGNETIC_FLUX_DENSITY,prefixes:F.SHORT,value:1,offset:0},b:{name:"b",base:W.BIT,prefixes:F.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:W.BIT,prefixes:F.BINARY_LONG,value:1,offset:0},B:{name:"B",base:W.BIT,prefixes:F.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:W.BIT,prefixes:F.BINARY_LONG,value:8,offset:0}},K={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",hertz:"hertz",radians:"rad",degree:"deg",degrees:"deg",gradian:"grad",gradians:"grad",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole"};E(e),l.on("config",function(t,e){t.number!==e.number&&E(t)});var q={si:{NONE:{unit:j,prefix:F.NONE[""]},LENGTH:{unit:z.m,prefix:F.SHORT[""]},MASS:{unit:z.g,prefix:F.SHORT.k},TIME:{unit:z.s,prefix:F.SHORT[""]},CURRENT:{unit:z.A,prefix:F.SHORT[""]},TEMPERATURE:{unit:z.K,prefix:F.SHORT[""]},LUMINOUS_INTENSITY:{unit:z.cd,prefix:F.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:z.mol,prefix:F.SHORT[""]},ANGLE:{unit:z.rad,prefix:F.SHORT[""]},BIT:{unit:z.bit,prefix:F.SHORT[""]},FORCE:{unit:z.N,prefix:F.SHORT[""]},ENERGY:{unit:z.J,prefix:F.SHORT[""]},POWER:{unit:z.W,prefix:F.SHORT[""]},PRESSURE:{unit:z.Pa,prefix:F.SHORT[""]},ELECTRIC_CHARGE:{unit:z.C,prefix:F.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:z.F,prefix:F.SHORT[""]},ELECTRIC_POTENTIAL:{unit:z.V,prefix:F.SHORT[""]},ELECTRIC_RESISTANCE:{unit:z.ohm,prefix:F.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:z.H,prefix:F.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:z.S,prefix:F.SHORT[""]},MAGNETIC_FLUX:{unit:z.Wb,prefix:F.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:z.T,prefix:F.SHORT[""]},FREQUENCY:{unit:z.Hz,prefix:F.SHORT[""]}}};q.cgs=JSON.parse(JSON.stringify(q.si)),q.cgs.LENGTH={unit:z.m,prefix:F.SHORT.c},q.cgs.MASS={unit:z.g,prefix:F.SHORT[""]},q.cgs.FORCE={unit:z.dyn,prefix:F.SHORT[""]},q.cgs.ENERGY={unit:z.erg,prefix:F.NONE[""]},q.us=JSON.parse(JSON.stringify(q.si)),q.us.LENGTH={unit:z.ft,prefix:F.NONE[""]},q.us.MASS={unit:z.lbm,prefix:F.NONE[""]},q.us.TEMPERATURE={
unit:z.degF,prefix:F.NONE[""]},q.us.FORCE={unit:z.lbf,prefix:F.NONE[""]},q.us.ENERGY={unit:z.BTU,prefix:F.BTU[""]},q.us.POWER={unit:z.hp,prefix:F.NONE[""]},q.us.PRESSURE={unit:z.psi,prefix:F.NONE[""]},q.auto=JSON.parse(JSON.stringify(q.si));var H=q.auto;u.setUnitSystem=function(t){if(!q.hasOwnProperty(t))throw new Error("Unit system "+t+" does not exist. Choices are: "+Object.keys(q).join(", "));H=q[t]},u.getUnitSystem=function(){for(var t in q)if(q[t]===H)return t},u.typeConverters={BigNumber:function(e){return new t.BigNumber(e+"")},Fraction:function(e){return new t.Fraction(e)},Complex:function(t){return t},number:function(t){return t}},u._getNumberConverter=function(t){if(!u.typeConverters[t])throw new TypeError('Unsupported type "'+t+'"');return u.typeConverters[t]};for(var G in z){var Y=z[G];Y.dimensions=Y.base.dimensions}for(var $ in K)if(K.hasOwnProperty($)){var Y=z[K[$]],X={};for(var G in Y)Y.hasOwnProperty(G)&&(X[G]=Y[G]);X.name=$,z[$]=X}return u.createUnit=function(t,e){if("object"!=typeof t)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(e&&e.override)for(var r in t)if(t.hasOwnProperty(r)&&u.deleteUnit(r),t[r].aliases)for(var i=0;i<t[r].aliases.length;i++)u.deleteUnit(t[r].aliases[i]);var n;for(var r in t)t.hasOwnProperty(r)&&(n=u.createUnitSingle(r,t[r]));return n},u.createUnitSingle=function(t,e,r){if(("undefined"==typeof e||null===e)&&(e={}),"string"!=typeof t)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(z.hasOwnProperty(t))throw new Error('Cannot create unit "'+t+'": a unit with that name already exists');w(t);var i,n,o=null,a=[],s=0;if(e&&"Unit"===e.type)o=e.clone();else if("string"==typeof e)""!==e&&(i=e);else{if("object"!=typeof e)throw new TypeError('Cannot create unit "'+t+'" from "'+e.toString()+'": expecting "string" or "Unit" or "Object"');i=e.definition,n=e.prefixes,s=e.offset,a=e.aliases}if(a)for(var l=0;l<a.length;l++)if(z.hasOwnProperty(a[l]))throw new Error('Cannot create alias "'+a[l]+'": a unit with that name already exists');if(i&&"string"==typeof i&&!o)try{o=u.parse(i,{allowNoUnits:!0})}catch(c){throw c.message='Could not create unit "'+t+'" from "'+i+'": '+c.message,c}else i&&"Unit"===i.type&&(o=i.clone());a=a||[],s=s||0,n=n&&n.toUpperCase?F[n.toUpperCase()]||F.NONE:F.NONE;var h={};if(o){h={name:t,value:o.value,dimensions:o.dimensions.slice(0),prefixes:n,offset:s};var f=!1;for(var l in W)if(W.hasOwnProperty(l)){for(var d=!0,p=0;p<B.length;p++)if(Math.abs((h.dimensions[p]||0)-(W[l].dimensions[p]||0))>1e-12){d=!1;break}if(d){f=!0;break}}if(!f){var m=t+"_STUFF",g={dimensions:o.dimensions.slice(0)};g.key=m,W[m]=g,H[m]={unit:h,prefix:F.NONE[""]},h.base=m}}else{var m=t+"_STUFF";if(B.indexOf(m)>=0)throw new Error('Cannot create new base unit "'+t+'": a base unit with that name already exists (and cannot be overridden)');B.push(m);for(var y in W)W.hasOwnProperty(y)&&(W[y].dimensions[B.length-1]=0);for(var g={dimensions:[]},l=0;l<B.length;l++)g.dimensions[l]=0;g.dimensions[B.length-1]=1,g.key=m,W[m]=g,h={name:t,value:1,dimensions:W[m].dimensions.slice(0),prefixes:n,offset:s,base:m},H[m]={unit:h,prefix:F.NONE[""]}}u.UNITS[t]=h;for(var l=0;l<a.length;l++){var v=a[l],E={};for(var b in h)h.hasOwnProperty(b)&&(E[b]=h[b]);E.name=v,u.UNITS[v]=E}return new u(null,t)},u.deleteUnit=function(t){delete u.UNITS[t]},u.PREFIXES=F,u.BASE_UNITS=W,u.UNITS=z,u.UNIT_SYSTEMS=q,u}var n=r(23).endsWith,o=r(3).clone,a=r(76);e.name="Unit",e.path="type",e.factory=i,e.math=!0},function(t,e,r){function i(t){return t[0].precision}var n=r(45).memoize;e.e=n(function(t){return new t(1).exp()},i),e.phi=n(function(t){return new t(1).plus(new t(5).sqrt()).div(2)},i),e.pi=n(function(t){return pi=t.acos(-1)},i),e.tau=n(function(t){return e.pi(t).times(2)},i)},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=i(r(52)),l=i(r(53)),u=i(r(78)),c=i(r(54)),h=i(r(61)),f=i(r(79)),d=i(r(56)),p=i(r(57)),m=i(r(58)),g=o("subtract",{"number, number":function(t,e){return t-e},"Complex, Complex":function(t,e){return t.sub(e)},"BigNumber, BigNumber":function(t,e){return t.minus(e)},"Fraction, Fraction":function(t,e){return t.sub(e)},"Unit, Unit":function(t,e){if(null==t.value)throw new Error("Parameter x contains a unit with undefined value");if(null==e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var r=t.clone();return r.value=g(r.value,e.value),r.fixPrefix=!1,r},"Matrix, Matrix":function(t,e){var r=t.size(),i=e.size();if(r.length!==i.length)throw new n(r.length,i.length);var o;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":o=f(t,e,g);break;default:o=h(e,t,g,!0)}break;default:switch(e.storage()){case"sparse":o=c(t,e,g,!1);break;default:o=p(t,e,g)}}return o},"Array, Array":function(t,e){return g(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return g(s(t),e)},"Matrix, Array":function(t,e){return g(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=d(t,u(e),l);break;default:r=m(t,e,g)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=d(e,t,g,!0);break;default:r=m(e,t,g,!0)}return r},"Array, any":function(t,e){return m(s(t),e,g,!1).valueOf()},"any, Array":function(t,e){return m(s(e),t,g,!0).valueOf()}});return g.toTex={2:"\\left(${args[0]}"+a.operators.subtract+"${args[1]}\\right)"},g}var n=r(42);e.name="subtract",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=o("unaryMinus",{number:function(t){return-t},Complex:function(t){return t.neg()},BigNumber:function(t){return t.neg()},Fraction:function(t){return t.neg()},Unit:function(t){var e=t.clone();return e.value=s(t.value),e},"Array | Matrix":function(t){return n(t,s,!0)}});return s.toTex={1:a.operators.unaryMinus+"\\left(${args[0]}\\right)"},s}var n=r(19);e.name="unaryMinus",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r){var i=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype,f=e._values,d=e._index,p=e._ptr,m=e._size,g=e._datatype;if(c.length!==m.length)throw new n(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");var y,v=c[0],E=c[1],w=a,b=0,x=r;"string"==typeof h&&h===g&&(y=h,w=o.find(a,[y,y]),b=o.convert(0,y),x=o.find(r,[y,y]));var _,S,T,L,M=i&&f?[]:void 0,A=[],N=[],R=new s({values:M,index:A,ptr:N,size:[v,E],datatype:y}),C=M?[]:void 0,P=M?[]:void 0,O=[],I=[];for(S=0;E>S;S++){N[S]=A.length;var k=S+1;for(T=u[S],L=u[S+1];L>T;T++)_=l[T],A.push(_),O[_]=k,C&&(C[_]=i[T]);for(T=p[S],L=p[S+1];L>T;T++)_=d[T],O[_]!==k&&A.push(_),I[_]=k,P&&(P[_]=f[T]);if(M)for(T=N[S];T<A.length;){_=A[T];var D=O[_],V=I[_];if(D===k||V===k){var F=D===k?C[_]:b,G=V===k?P[_]:b,B=x(F,G);w(B,b)?A.splice(T,1):(M.push(B),T++)}}}return N[E]=A.length,R};return l}var n=r(42);e.name="algorithm05",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){var n=i("multiplyScalar",{"number, number":function(t,e){return t*e},"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":function(t,e){var r=e.clone();return r.value=null===r.value?r._normalize(t):n(r.value,t),r},"Unit, number | Fraction | BigNumber | Complex":function(t,e){var r=t.clone();return r.value=null===r.value?r._normalize(e):n(r.value,e),r},"Unit, Unit":function(t,e){return t.multiply(e)}});return n}e.factory=r},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(80)),a=n("divide",{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Fraction | BigNumber":function(t,e){var r=t.clone();return r.value=a(null===r.value?r._normalize(1):r.value,e),r},"number | Fraction | BigNumber, Unit":function(t,e){var r=e.pow(-1);return r.value=o(null===r.value?r._normalize(1):r.value,t),r},"Unit, Unit":function(t,e){return t.divide(e)}});return a}e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(r,i){if(e.predictable&&!n(i)&&0>r)try{var o=p(i),a=m(o);if((i===a||Math.abs((i-a)/i)<1e-14)&&o.d%2===1)return(o.n%2===0?1:-1)*Math.pow(-r,i)}catch(s){}return n(i)||r>=0||e.predictable?Math.pow(r,i):new t.Complex(r,0).pow(i,0)}function l(t,e){if(!n(e)||0>e)throw new TypeError("For A^b, b must be a positive integer (value is "+e+")");var r=o(t);if(2!=r.length)throw new Error("For A^b, A must be 2 dimensional (A has "+r.length+" dimensions)");if(r[0]!=r[1])throw new Error("For A^b, A must be square (size is "+r[0]+"x"+r[1]+")");for(var i=h(r[0]).valueOf(),a=t;e>=1;)1==(1&e)&&(i=f(a,i)),e>>=1,a=f(a,a);return i}function u(t,e){return d(l(t.valueOf(),e))}var c=r(32),h=i(r(83)),f=i(r(84)),d=i(r(52)),p=i(r(36)),m=i(r(70)),g=a("pow",{"number, number":s,"Complex, Complex":function(t,e){return t.pow(e)},"BigNumber, BigNumber":function(r,i){return i.isInteger()||r>=0||e.predictable?r.pow(i):new t.Complex(r.toNumber(),0).pow(i.toNumber(),0)},"Fraction, Fraction":function(t,r){if(1!==r.d){if(e.predictable)throw new Error("Function pow does not support non-integer exponents for fractions.");return s(t.valueOf(),r.valueOf())}return t.pow(r)},"Array, number":l,"Array, BigNumber":function(t,e){return l(t,e.toNumber())},"Matrix, number":u,"Matrix, BigNumber":function(t,e){return u(t,e.toNumber())},"Unit, number":function(t,e){return t.pow(e)}});return g.toTex={2:"\\left(${args[0]}\\right)"+c.operators.pow+"{${args[1]}}"},g}var n=r(6).isInteger,o=r(40).size;e.name="pow",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(t,e){switch(t.length){case 0:return e?u(e):[];case 1:return l(t[0],t[0],e);case 2:return l(t[0],t[1],e);default:throw new Error("Vector containing two values expected")}}function l(e,r,i){var a=e&&e.isBigNumber===!0?t.BigNumber:r&&r.isBigNumber===!0?t.BigNumber:null;if(e&&e.isBigNumber===!0&&(e=e.toNumber()),r&&r.isBigNumber===!0&&(r=r.toNumber()),!o(e)||1>e)throw new Error("Parameters in function eye must be positive integers");if(!o(r)||1>r)throw new Error("Parameters in function eye must be positive integers");var s=a?new t.BigNumber(1):1,l=a?new a(0):0,u=[e,r];if(i){var c=t.Matrix.storage(i);return c.diagonal(u,s,0,l)}for(var h=n.resize([],u,l),f=r>e?e:r,d=0;f>d;d++)h[d][d]=s;return h}var u=i(r(52)),c=a("eye",{"":function(){return"Matrix"===e.matrix?u([]):[]},string:function(t){return u(t)},"number | BigNumber":function(t){return l(t,t,"Matrix"===e.matrix?"default":void 0)},"number | BigNumber, string":function(t,e){return l(t,t,e)},"number | BigNumber, number | BigNumber":function(t,r){return l(t,r,"Matrix"===e.matrix?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,r){return l(t,e,r)},Array:function(t){return s(t)},"Array, string":function(t,e){return s(t,e)},Matrix:function(t){return s(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return s(t.valueOf(),e)}});return c.toTex=void 0,c}var n=r(40),o=r(6).isInteger;e.name="eye",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(53)),c=i(r(80)),h=i(r(48)),f=i(r(85)),d=i(r(58)),p=t.DenseMatrix,m=t.SparseMatrix,g=a("multiply",n({"Array, Array":function(t,e){y(o.size(t),o.size(e));var r=g(l(t),l(e));return r&&r.isMatrix===!0?r.valueOf():r},"Matrix, Matrix":function(t,e){var r=t.size(),i=e.size();return y(r,i),1===r.length?1===i.length?v(t,e,r[0]):E(t,e):1===i.length?b(t,e):x(t,e)},"Matrix, Array":function(t,e){return g(t,l(e))},"Array, Matrix":function(t,e){return g(l(t,e.storage()),e)},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=f(t,e,c,!1);break;case"dense":r=d(t,e,c,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=f(e,t,c,!0);break;case"dense":r=d(e,t,c,!0)}return r},"Array, any":function(t,e){return d(l(t),e,c,!1).valueOf()},"any, Array":function(t,e){return d(l(e),t,c,!0).valueOf()}},c.signatures)),y=function(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}},v=function(t,e,r){if(0===r)throw new Error("Cannot multiply two empty vectors");var i,n=t._data,o=t._datatype,s=e._data,l=e._datatype,h=u,f=c;o&&l&&o===l&&"string"==typeof o&&(i=o,h=a.find(u,[i,i]),f=a.find(c,[i,i]));for(var d=f(n[0],s[0]),p=1;r>p;p++)d=h(d,f(n[p],s[p]));return d},E=function(t,e){switch(e.storage()){case"dense":return w(t,e)}throw new Error("Not implemented")},w=function(t,e){var r,i=t._data,n=t._size,o=t._datatype,s=e._data,l=e._size,h=e._datatype,f=n[0],d=l[1],m=u,g=c;o&&h&&o===h&&"string"==typeof o&&(r=o,m=a.find(u,[r,r]),g=a.find(c,[r,r]));for(var y=[],v=0;d>v;v++){for(var E=g(i[0],s[0][v]),w=1;f>w;w++)E=m(E,g(i[w],s[w][v]));y[v]=E}return new p({data:y,size:[d],datatype:r})},b=function(t,e){switch(t.storage()){case"dense":return _(t,e);case"sparse":return L(t,e)}},x=function(t,e){switch(t.storage()){case"dense":switch(e.storage()){case"dense":return S(t,e);case"sparse":return T(t,e)}break;case"sparse":switch(e.storage()){case"dense":return M(t,e);case"sparse":return A(t,e)}}},_=function(t,e){var r,i=t._data,n=t._size,o=t._datatype,s=e._data,l=e._datatype,h=n[0],f=n[1],d=u,m=c;o&&l&&o===l&&"string"==typeof o&&(r=o,d=a.find(u,[r,r]),m=a.find(c,[r,r]));for(var g=[],y=0;h>y;y++){for(var v=i[y],E=m(v[0],s[0]),w=1;f>w;w++)E=d(E,m(v[w],s[w]));g[y]=E}return new p({data:g,size:[h],datatype:r})},S=function(t,e){var r,i=t._data,n=t._size,o=t._datatype,s=e._data,l=e._size,h=e._datatype,f=n[0],d=n[1],m=l[1],g=u,y=c;o&&h&&o===h&&"string"==typeof o&&(r=o,g=a.find(u,[r,r]),y=a.find(c,[r,r]));for(var v=[],E=0;f>E;E++){var w=i[E];v[E]=[];for(var b=0;m>b;b++){for(var x=y(w[0],s[0][b]),_=1;d>_;_++)x=g(x,y(w[_],s[_][b]));v[E][b]=x}}return new p({data:v,size:[f,m],datatype:r})},T=function(t,e){var r=t._data,i=t._size,n=t._datatype,o=e._values,s=e._index,l=e._ptr,f=e._size,d=e._datatype;if(!o)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var p,g=i[0],y=f[1],v=u,E=c,w=h,b=0;n&&d&&n===d&&"string"==typeof n&&(p=n,v=a.find(u,[p,p]),E=a.find(c,[p,p]),w=a.find(h,[p,p]),b=a.convert(0,p));for(var x=[],_=[],S=[],T=new m({values:x,index:_,ptr:S,size:[g,y],datatype:p}),L=0;y>L;L++){S[L]=_.length;var M=l[L],A=l[L+1];if(A>M)for(var N=0,R=0;g>R;R++){for(var C,P=R+1,O=M;A>O;O++){var I=s[O];N!==P?(C=E(r[R][I],o[O]),N=P):C=v(C,E(r[R][I],o[O]))}N!==P||w(C,b)||(_.push(R),x.push(C))}}return S[y]=_.length,T},L=function(t,e){var r=t._values,i=t._index,n=t._ptr,o=t._datatype;if(!r)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s,l=e._data,f=e._datatype,d=t._size[0],p=e._size[0],g=[],y=[],v=[],E=u,w=c,b=h,x=0;o&&f&&o===f&&"string"==typeof o&&(s=o,E=a.find(u,[s,s]),w=a.find(c,[s,s]),b=a.find(h,[s,s]),x=a.convert(0,s));var _=[],S=[];v[0]=0;for(var T=0;p>T;T++){var L=l[T];if(!b(L,x))for(var M=n[T],A=n[T+1],N=M;A>N;N++){var R=i[N];S[R]?_[R]=E(_[R],w(L,r[N])):(S[R]=!0,y.push(R),_[R]=w(L,r[N]))}}for(var C=y.length,P=0;C>P;P++){var O=y[P];g[P]=_[O]}return v[1]=y.length,new m({values:g,index:y,ptr:v,size:[d,1],datatype:s})},M=function(t,e){var r=t._values,i=t._index,n=t._ptr,o=t._datatype;if(!r)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s,l=e._data,f=e._datatype,d=t._size[0],p=e._size[0],g=e._size[1],y=u,v=c,E=h,w=0;o&&f&&o===f&&"string"==typeof o&&(s=o,y=a.find(u,[s,s]),v=a.find(c,[s,s]),E=a.find(h,[s,s]),w=a.convert(0,s));for(var b=[],x=[],_=[],S=new m({values:b,index:x,ptr:_,size:[d,g],datatype:s}),T=[],L=[],M=0;g>M;M++){_[M]=x.length;for(var A=M+1,N=0;p>N;N++){var R=l[N][M];if(!E(R,w))for(var C=n[N],P=n[N+1],O=C;P>O;O++){var I=i[O];L[I]!==A?(L[I]=A,x.push(I),T[I]=v(R,r[O])):T[I]=y(T[I],v(R,r[O]))}}for(var k=_[M],D=x.length,V=k;D>V;V++){var F=x[V];b[V]=T[F]}}return _[g]=x.length,S},A=function(t,e){var r,i=t._values,n=t._index,o=t._ptr,s=t._datatype,l=e._values,h=e._index,f=e._ptr,d=e._datatype,p=t._size[0],g=e._size[1],y=i&&l,v=u,E=c;s&&d&&s===d&&"string"==typeof s&&(r=s,v=a.find(u,[r,r]),E=a.find(c,[r,r]));for(var w,b,x,_,S,T,L,M,A=y?[]:void 0,N=[],R=[],C=new m({values:A,index:N,ptr:R,size:[p,g],datatype:r}),P=y?[]:void 0,O=[],I=0;g>I;I++){R[I]=N.length;var k=I+1;for(S=f[I],T=f[I+1],_=S;T>_;_++)if(M=h[_],y)for(b=o[M],x=o[M+1],w=b;x>w;w++)L=n[w],O[L]!==k?(O[L]=k,N.push(L),P[L]=E(l[_],i[w])):P[L]=v(P[L],E(l[_],i[w]));else for(b=o[M],x=o[M+1],w=b;x>w;w++)L=n[w],O[L]!==k&&(O[L]=k,N.push(L));if(y)for(var D=R[I],V=N.length,F=D;V>F;F++){var G=N[F];A[F]=P[G]}}return R[g]=N.length,C};return g.toTex={2:"\\left(${args[0]}"+s.operators.multiply+"${args[1]}\\right)"},g}var n=r(3).extend,o=r(40);e.name="multiply",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(48)),a=t.SparseMatrix,s=function(t,e,r,i){var s=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f,d=c[0],p=c[1],m=o,g=0,y=r;"string"==typeof h&&(f=h,m=n.find(o,[f,f]),g=n.convert(0,f),e=n.convert(e,f),y=n.find(r,[f,f]));for(var v=[],E=[],w=[],b=new a({values:v,index:E,ptr:w,size:[d,p],datatype:f}),x=0;p>x;x++){w[x]=E.length;for(var _=u[x],S=u[x+1],T=_;S>T;T++){var L=l[T],M=i?y(e,s[T]):y(s[T],e);m(M,g)||(E.push(L),v.push(M))}}return w[p]=E.length,b};return s}e.name="algorithm11",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("abs",{number:Math.abs,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},Fraction:function(t){return t.abs()},"Array | Matrix":function(t){return n(t,o,!0)},Unit:function(t){return t.abs()}});return o.toTex={1:"\\left|${args[0]}\\right|"},o}var n=r(19);e.name="abs",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("fix",{number:function(t){return t>0?Math.floor(t):Math.ceil(t)},Complex:function(e){return new t.Complex(e.re>0?Math.floor(e.re):Math.ceil(e.re),e.im>0?Math.floor(e.im):Math.ceil(e.im))},BigNumber:function(t){return t.isNegative()?t.ceil():t.floor()},Fraction:function(t){return t.s<0?t.ceil():t.floor()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="fix",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(48)),s=i(r(61)),l=i(r(62)),u=i(r(63)),c=i(r(57)),h=i(r(58)),f=r(32),d=n("equal",{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:a(t,e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=l(t,e,a);break;default:r=s(e,t,a,!0)}break;default:switch(e.storage()){case"sparse":r=s(t,e,a,!1);break;default:r=c(t,e,a)}}return r},"Array, Array":function(t,e){return d(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return d(o(t),e)},"Matrix, Array":function(t,e){return d(t,o(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=u(t,e,a,!1);break;default:r=h(t,e,a,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=u(e,t,a,!0);break;default:r=h(e,t,a,!0)}return r},"Array, any":function(t,e){return h(o(t),e,a,!1).valueOf()},"any, Array":function(t,e){return h(o(e),t,a,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+f.operators.equal+"${args[1]}\\right)"},d}e.name="equal",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isNumeric",{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string":function(){return!1},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);r(6);e.name="isNumeric",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("format",{any:n.format,"any, Object | function | number":n.format});return o.toTex=void 0,o}var n=r(23);e.name="format",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("_typeof",{any:function(t){var e=n.type(t);if("Object"===e){if(t.isBigNumber===!0)return"BigNumber";if(t.isComplex===!0)return"Complex";if(t.isFraction===!0)return"Fraction";if(t.isMatrix===!0)return"Matrix";if(t.isUnit===!0)return"Unit";if(t.isIndex===!0)return"Index";if(t.isRange===!0)return"Range";if(t.isChain===!0)return"Chain";if(t.isHelp===!0)return"Help"}return e}});return o.toTex=void 0,o}var n=r(41);e.name="typeof",e.factory=i},function(t,e,r){(function(t,i){function n(t,r){var i={seen:[],stylize:a};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),m(r)?i.showHidden=r:r&&e._extend(i,r),b(i.showHidden)&&(i.showHidden=!1),b(i.depth)&&(i.depth=2),b(i.colors)&&(i.colors=!1),b(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=o),l(i,t,i.depth)}function o(t,e){var r=n.styles[e];return r?"["+n.colors[r][0]+"m"+t+"["+n.colors[r][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}function l(t,r,i){if(t.customInspect&&r&&L(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(i,t);return E(n)||(n=l(t,n,i)),n}var o=u(t,r);if(o)return o;var a=Object.keys(r),m=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(r)),T(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(r);if(0===a.length){if(L(r)){var g=r.name?": "+r.name:"";return t.stylize("[Function"+g+"]","special")}if(x(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(S(r))return t.stylize(Date.prototype.toString.call(r),"date");if(T(r))return c(r)}var y="",v=!1,w=["{","}"];if(p(r)&&(v=!0,w=["[","]"]),L(r)){var b=r.name?": "+r.name:"";y=" [Function"+b+"]"}if(x(r)&&(y=" "+RegExp.prototype.toString.call(r)),S(r)&&(y=" "+Date.prototype.toUTCString.call(r)),T(r)&&(y=" "+c(r)),0===a.length&&(!v||0==r.length))return w[0]+y+w[1];if(0>i)return x(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special");t.seen.push(r);var _;return _=v?h(t,r,i,m,a):a.map(function(e){return f(t,r,i,m,e,v)}),t.seen.pop(),d(_,y,w)}function u(t,e){if(b(e))return t.stylize("undefined","undefined");if(E(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return v(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,r,i,n){for(var o=[],a=0,s=e.length;s>a;++a)C(e,String(a))?o.push(f(t,e,r,i,String(a),!0)):o.push("");return n.forEach(function(n){n.match(/^\d+$/)||o.push(f(t,e,r,i,n,!0))}),o}function f(t,e,r,i,n,o){var a,s,u;if(u=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},u.get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),C(i,n)||(a="["+n+"]"),s||(t.seen.indexOf(u.value)<0?(s=g(r)?l(t,u.value,null):l(t,u.value,r-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),b(a)){if(o&&n.match(/^\d+$/))return s;a=JSON.stringify(""+n),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t,e,r){var i=0,n=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function p(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return null==t}function v(t){return"number"==typeof t}function E(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function b(t){return void 0===t}function x(t){return _(t)&&"[object RegExp]"===A(t)}function _(t){return"object"==typeof t&&null!==t}function S(t){return _(t)&&"[object Date]"===A(t)}function T(t){return _(t)&&("[object Error]"===A(t)||t instanceof Error)}function L(t){return"function"==typeof t}function M(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function A(t){return Object.prototype.toString.call(t)}function N(t){return 10>t?"0"+t.toString(10):t.toString(10)}function R(){var t=new Date,e=[N(t.getHours()),N(t.getMinutes()),N(t.getSeconds())].join(":");return[t.getDate(),k[t.getMonth()],e].join(" ")}function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var P=/%[sdj%]/g;e.format=function(t){if(!E(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(n(arguments[r]));return e.join(" ")}for(var r=1,i=arguments,o=i.length,a=String(t).replace(P,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(e){return"[Circular]"}default:return t}}),s=i[r];o>r;s=i[++r])a+=g(s)||!_(s)?" "+s:" "+n(s);return a},e.deprecate=function(r,n){function o(){if(!a){if(i.throwDeprecation)throw new Error(n);i.traceDeprecation?console.trace(n):console.error(n),a=!0}return r.apply(this,arguments)}if(b(t.process))return function(){return e.deprecate(r,n).apply(this,arguments)};if(i.noDeprecation===!0)return r;var a=!1;return o};var O,I={};e.debuglog=function(t){if(b(O)&&(O=i.env.NODE_DEBUG||""),t=t.toUpperCase(),!I[t])if(new RegExp("\\b"+t+"\\b","i").test(O)){var r=i.pid;I[t]=function(){var i=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,i)}}else I[t]=function(){};return I[t]},e.inspect=n,n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=m,e.isNull=g,e.isNullOrUndefined=y,e.isNumber=v,e.isString=E,e.isSymbol=w,e.isUndefined=b,e.isRegExp=x,e.isObject=_,e.isDate=S,e.isError=T,e.isFunction=L,e.isPrimitive=M,e.isBuffer=r(94);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",R(),e.format.apply(e,arguments))},e.inherits=r(95),e._extend=function(t,e){if(!e||!_(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t}}).call(e,function(){return this}(),r(93))},function(t,e){function r(){u=!1,a.length?l=a.concat(l):c=-1,l.length&&i()}function i(){if(!u){var t=setTimeout(r);u=!0;for(var e=l.length;e;){for(a=l,l=[];++c<e;)a&&a[c].run();c=-1,e=l.length}a=null,u=!1,clearTimeout(t)}}function n(t,e){this.fun=t,this.array=e}function o(){}var a,s=t.exports={},l=[],u=!1,c=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new n(t,e)),1!==l.length||u||setTimeout(i,0)},n.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=o,s.addListener=o,s.once=o,s.off=o,s.removeListener=o,s.removeAllListeners=o,s.emit=o,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("unit",{Unit:function(t){return t.clone()},string:function(e){return t.Unit.isValuelessUnit(e)?new t.Unit(null,e):t.Unit.parse(e)},"number | BigNumber | Fraction | Complex, string":function(e,r){return new t.Unit(e,r)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},o}var n=r(19);e.name="unit",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var n=i("createUnit",{"Object, Object":function(e,r){return t.Unit.createUnit(e,r)},Object:function(e){return t.Unit.createUnit(e,{})},"string, Unit | string | Object, Object":function(e,r,i){var n={};return n[e]=r,t.Unit.createUnit(n,i)},"string, Unit | string | Object":function(e,r){var i={};return i[e]=r,t.Unit.createUnit(i,{})},string:function(e){var r={};return r[e]={},t.Unit.createUnit(r,{})}});return n}r(19);e.name="createUnit",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var n=i("splitUnit",{"Unit, Array":function(t,e){return t.splitUnit(e)}});return n}r(19);e.name="splitUnit",e.factory=i},function(t,e,r){function i(t,e,r,i,o){function a(e){var r=t.Unit.parse(e);return r.fixPrefix=!0,r}n(o,"speedOfLight",function(){return a("299792458 m s^-1")}),n(o,"gravitationConstant",function(){return a("6.6738480e-11 m^3 kg^-1 s^-2")}),n(o,"planckConstant",function(){return a("6.626069311e-34 J s")}),n(o,"reducedPlanckConstant",function(){return a("1.05457172647e-34 J s")}),n(o,"magneticConstant",function(){return a("1.2566370614e-6 N A^-2")}),n(o,"electricConstant",function(){return a("8.854187817e-12 F m^-1")}),n(o,"vacuumImpedance",function(){return a("376.730313461 ohm")}),n(o,"coulomb",function(){return a("8.9875517873681764e9 N m^2 C^-2")}),n(o,"elementaryCharge",function(){return a("1.60217656535e-19 C")}),n(o,"bohrMagneton",function(){return a("9.2740096820e-24 J T^-1")}),n(o,"conductanceQuantum",function(){return a("7.748091734625e-5 S")}),n(o,"inverseConductanceQuantum",function(){return a("12906.403721742 ohm")}),n(o,"magneticFluxQuantum",function(){return a("2.06783375846e-15 Wb")}),n(o,"nuclearMagneton",function(){return a("5.0507835311e-27 J T^-1")}),n(o,"klitzing",function(){return a("25812.807443484 ohm")}),n(o,"bohrRadius",function(){return a("5.291772109217e-11 m")}),n(o,"classicalElectronRadius",function(){return a("2.817940326727e-15 m")}),n(o,"electronMass",function(){return a("9.1093829140e-31 kg")}),n(o,"fermiCoupling",function(){return a("1.1663645e-5 GeV^-2")}),n(o,"fineStructure",function(){return.007297352569824}),n(o,"hartreeEnergy",function(){return a("4.3597443419e-18 J")}),n(o,"protonMass",function(){return a("1.67262177774e-27 kg")}),n(o,"deuteronMass",function(){return a("3.3435830926e-27 kg")}),n(o,"neutronMass",function(){return a("1.6749271613e-27 kg")}),n(o,"quantumOfCirculation",function(){return a("3.636947552024e-4 m^2 s^-1")}),n(o,"rydberg",function(){return a("10973731.56853955 m^-1")}),n(o,"thomsonCrossSection",function(){return a("6.65245873413e-29 m^2")}),n(o,"weakMixingAngle",function(){return.222321}),n(o,"efimovFactor",function(){
return 22.7}),n(o,"atomicMass",function(){return a("1.66053892173e-27 kg")}),n(o,"avogadro",function(){return a("6.0221412927e23 mol^-1")}),n(o,"boltzmann",function(){return a("1.380648813e-23 J K^-1")}),n(o,"faraday",function(){return a("96485.336521 C mol^-1")}),n(o,"firstRadiation",function(){return a("3.7417715317e-16 W m^2")}),n(o,"loschmidt",function(){return a("2.686780524e25 m^-3")}),n(o,"gasConstant",function(){return a("8.314462175 J K^-1 mol^-1")}),n(o,"molarPlanckConstant",function(){return a("3.990312717628e-10 J s mol^-1")}),n(o,"molarVolume",function(){return a("2.241396820e-10 m^3 mol^-1")}),n(o,"sackurTetrode",function(){return-1.164870823}),n(o,"secondRadiation",function(){return a("1.438777013e-2 m K")}),n(o,"stefanBoltzmann",function(){return a("5.67037321e-8 W m^-2 K^-4")}),n(o,"wienDisplacement",function(){return a("2.897772126e-3 m K")}),n(o,"molarMass",function(){return a("1e-3 kg mol^-1")}),n(o,"molarMassC12",function(){return a("1.2e-2 kg mol^-1")}),n(o,"gravity",function(){return a("9.80665 m s^-2")}),n(o,"planckLength",function(){return a("1.61619997e-35 m")}),n(o,"planckMass",function(){return a("2.1765113e-8 kg")}),n(o,"planckTime",function(){return a("5.3910632e-44 s")}),n(o,"planckCharge",function(){return a("1.87554595641e-18 C")}),n(o,"planckTemperature",function(){return a("1.41683385e+32 K")})}var n=r(3).lazy;e.factory=i,e.lazy=!1,e.math=!0},function(t,e,r){"use strict";function i(t,e,a,s,l){l.on("config",function(r,n){r.number!==n.number&&i(t,e,a,s,l)}),l["true"]=!0,l["false"]=!1,l["null"]=null,l.uninitialized=r(40).UNINITIALIZED,"BigNumber"===e.number?(l.Infinity=new t.BigNumber(1/0),l.NaN=new t.BigNumber(NaN),n.lazy(l,"pi",function(){return o.pi(t.BigNumber)}),n.lazy(l,"tau",function(){return o.tau(t.BigNumber)}),n.lazy(l,"e",function(){return o.e(t.BigNumber)}),n.lazy(l,"phi",function(){return o.phi(t.BigNumber)}),n.lazy(l,"E",function(){return l.e}),n.lazy(l,"LN2",function(){return new t.BigNumber(2).ln()}),n.lazy(l,"LN10",function(){return new t.BigNumber(10).ln()}),n.lazy(l,"LOG2E",function(){return new t.BigNumber(1).div(new t.BigNumber(2).ln())}),n.lazy(l,"LOG10E",function(){return new t.BigNumber(1).div(new t.BigNumber(10).ln())}),n.lazy(l,"PI",function(){return l.pi}),n.lazy(l,"SQRT1_2",function(){return new t.BigNumber("0.5").sqrt()}),n.lazy(l,"SQRT2",function(){return new t.BigNumber(2).sqrt()})):(l.Infinity=1/0,l.NaN=NaN,l.pi=Math.PI,l.tau=2*Math.PI,l.e=Math.E,l.phi=1.618033988749895,l.E=l.e,l.LN2=Math.LN2,l.LN10=Math.LN10,l.LOG2E=Math.LOG2E,l.LOG10E=Math.LOG10E,l.PI=l.pi,l.SQRT1_2=Math.SQRT1_2,l.SQRT2=Math.SQRT2),l.i=t.Complex.I,l.version=r(101)}var n=r(3),o=r(76);e.factory=i,e.lazy=!1,e.math=!0},function(t,e){t.exports="3.7.0"},function(t,e,r){t.exports=[r(103),r(278),r(307),r(309),r(335),r(280),r(306)]},function(t,e,r){function i(t,e,i,n){var o={};return o.bignumber=r(104),o["boolean"]=r(105),o.complex=r(106),o.fraction=r(107),o.index=r(108),o.matrix=r(109),o.number=r(110),o.sparse=r(111),o.string=r(112),o.unit=r(113),o.e=r(114),o.E=r(114),o["false"]=r(115),o.i=r(116),o.Infinity=r(117),o.LN2=r(118),o.LN10=r(119),o.LOG2E=r(120),o.LOG10E=r(121),o.NaN=r(122),o["null"]=r(123),o.pi=r(124),o.PI=r(124),o.phi=r(125),o.SQRT1_2=r(126),o.SQRT2=r(127),o.tau=r(128),o["true"]=r(129),o.version=r(130),o.speedOfLight={description:"Speed of light in vacuum",examples:["speedOfLight"]},o.gravitationConstant={description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},o.planckConstant={description:"Planck constant",examples:["planckConstant"]},o.reducedPlanckConstant={description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},o.magneticConstant={description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},o.electricConstant={description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},o.vacuumImpedance={description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},o.coulomb={description:"Coulomb's constant",examples:["coulomb"]},o.elementaryCharge={description:"Elementary charge",examples:["elementaryCharge"]},o.bohrMagneton={description:"Borh magneton",examples:["bohrMagneton"]},o.conductanceQuantum={description:"Conductance quantum",examples:["conductanceQuantum"]},o.inverseConductanceQuantum={description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},o.magneticFluxQuantum={description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},o.nuclearMagneton={description:"Nuclear magneton",examples:["nuclearMagneton"]},o.klitzing={description:"Von Klitzing constant",examples:["klitzing"]},o.bohrRadius={description:"Borh radius",examples:["bohrRadius"]},o.classicalElectronRadius={description:"Classical electron radius",examples:["classicalElectronRadius"]},o.electronMass={description:"Electron mass",examples:["electronMass"]},o.fermiCoupling={description:"Fermi coupling constant",examples:["fermiCoupling"]},o.fineStructure={description:"Fine-structure constant",examples:["fineStructure"]},o.hartreeEnergy={description:"Hartree energy",examples:["hartreeEnergy"]},o.protonMass={description:"Proton mass",examples:["protonMass"]},o.deuteronMass={description:"Deuteron Mass",examples:["deuteronMass"]},o.neutronMass={description:"Neutron mass",examples:["neutronMass"]},o.quantumOfCirculation={description:"Quantum of circulation",examples:["quantumOfCirculation"]},o.rydberg={description:"Rydberg constant",examples:["rydberg"]},o.thomsonCrossSection={description:"Thomson cross section",examples:["thomsonCrossSection"]},o.weakMixingAngle={description:"Weak mixing angle",examples:["weakMixingAngle"]},o.efimovFactor={description:"Efimov factor",examples:["efimovFactor"]},o.atomicMass={description:"Atomic mass constant",examples:["atomicMass"]},o.avogadro={description:"Avogadro's number",examples:["avogadro"]},o.boltzmann={description:"Boltzmann constant",examples:["boltzmann"]},o.faraday={description:"Faraday constant",examples:["faraday"]},o.firstRadiation={description:"First radiation constant",examples:["firstRadiation"]},o.loschmidt={description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},o.gasConstant={description:"Gas constant",examples:["gasConstant"]},o.molarPlanckConstant={description:"Molar Planck constant",examples:["molarPlanckConstant"]},o.molarVolume={description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},o.sackurTetrode={description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},o.secondRadiation={description:"Second radiation constant",examples:["secondRadiation"]},o.stefanBoltzmann={description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},o.wienDisplacement={description:"Wien displacement law constant",examples:["wienDisplacement"]},o.molarMass={description:"Molar mass constant",examples:["molarMass"]},o.molarMassC12={description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},o.gravity={description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},o.planckLength={description:"Planck length",examples:["planckLength"]},o.planckMass={description:"Planck mass",examples:["planckMass"]},o.planckTime={description:"Planck time",examples:["planckTime"]},o.planckCharge={description:"Planck charge",examples:["planckCharge"]},o.planckTemperature={description:"Planck temperature",examples:["planckTemperature"]},o.lsolve=r(131),o.lup=r(132),o.lusolve=r(133),o.slu=r(134),o.usolve=r(135),o.abs=r(136),o.add=r(137),o.cbrt=r(138),o.ceil=r(139),o.cube=r(140),o.divide=r(141),o.dotDivide=r(142),o.dotMultiply=r(143),o.dotPow=r(144),o.exp=r(145),o.fix=r(146),o.floor=r(147),o.gcd=r(148),o.hypot=r(149),o.lcm=r(150),o.log=r(151),o.log10=r(152),o.mod=r(153),o.multiply=r(154),o.norm=r(155),o.nthRoot=r(156),o.pow=r(157),o.round=r(158),o.sign=r(159),o.sqrt=r(160),o.square=r(161),o.subtract=r(162),o.unaryMinus=r(163),o.unaryPlus=r(164),o.xgcd=r(165),o.bitAnd=r(166),o.bitNot=r(167),o.bitOr=r(168),o.bitXor=r(169),o.leftShift=r(170),o.rightArithShift=r(171),o.rightLogShift=r(172),o.bellNumbers=r(173),o.catalan=r(174),o.composition=r(175),o.stirlingS2=r(176),o.config=r(177),o["import"]=r(178),o.typed=r(179),o.arg=r(180),o.conj=r(181),o.re=r(182),o.im=r(183),o.eval=r(184),o.help=r(185),o.distance=r(186),o.intersect=r(187),o.and=r(188),o.not=r(189),o.or=r(190),o.xor=r(191),o.concat=r(192),o.cross=r(193),o.det=r(194),o.diag=r(195),o.dot=r(196),o.eye=r(197),o.filter=r(198),o.flatten=r(199),o.forEach=r(200),o.inv=r(201),o.map=r(202),o.ones=r(203),o.partitionSelect=r(204),o.range=r(205),o.resize=r(206),o.size=r(207),o.sort=r(208),o.squeeze=r(209),o.subset=r(210),o.trace=r(211),o.transpose=r(212),o.zeros=r(213),o.combinations=r(214),o.factorial=r(215),o.gamma=r(216),o.kldivergence=r(217),o.multinomial=r(218),o.permutations=r(219),o.pickRandom=r(220),o.random=r(221),o.randomInt=r(222),o.compare=r(223),o.deepEqual=r(224),o.equal=r(225),o.larger=r(226),o.largerEq=r(227),o.smaller=r(228),o.smallerEq=r(229),o.unequal=r(230),o.erf=r(231),o.max=r(232),o.mean=r(233),o.median=r(234),o.min=r(235),o.mode=r(236),o.prod=r(237),o.quantileSeq=r(238),o.std=r(239),o.sum=r(240),o["var"]=r(241),o.acos=r(242),o.acosh=r(243),o.acot=r(244),o.acoth=r(245),o.acsc=r(246),o.acsch=r(247),o.asec=r(248),o.asech=r(249),o.asin=r(250),o.asinh=r(251),o.atan=r(252),o.atanh=r(253),o.atan2=r(254),o.cos=r(255),o.cosh=r(256),o.cot=r(257),o.coth=r(258),o.csc=r(259),o.csch=r(260),o.sec=r(261),o.sech=r(262),o.sin=r(263),o.sinh=r(264),o.tan=r(265),o.tanh=r(266),o.to=r(267),o.clone=r(268),o.format=r(269),o.isNaN=r(270),o.isInteger=r(271),o.isNegative=r(272),o.isNumeric=r(273),o.isPositive=r(274),o.isPrime=r(275),o.isZero=r(276),o["typeof"]=r(277),o}e.name="docs",e.path="expression",e.factory=i},function(t,e){t.exports={name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","complex","fraction","index","matrix","string","unit"]}},function(t,e){t.exports={name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]}},function(t,e){t.exports={name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]}},function(t,e){t.exports={name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(num,den)"],description:"Create a fraction from a number or from a numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]}},function(t,e){t.exports={name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["[]","[1, 2, 3]","A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[0:2, 0:2] = ones(2, 2)"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]}},function(t,e){t.exports={name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]}},function(t,e){t.exports={name:"number",category:"Construction",syntax:["x","number(x)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number("52cm", "m")'],seealso:["bignumber","boolean","complex","fraction","index","matrix","string","unit"]}},function(t,e){t.exports={name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]}},function(t,e){t.exports={name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]}},function(t,e){t.exports={name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]}},function(t,e){t.exports={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]}},function(t,e){t.exports={name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]}},function(t,e){t.exports={name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]}},function(t,e){t.exports={name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]}},function(t,e){t.exports={name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]}},function(t,e){t.exports={name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]}},function(t,e){t.exports={name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]}},function(t,e){t.exports={name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]}},function(t,e){t.exports={name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]}},function(t,e){t.exports={name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]}},function(t,e){t.exports={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]}},function(t,e){t.exports={name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["tau"],seealso:[]}},function(t,e){t.exports={name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]}},function(t,e){t.exports={name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]}},function(t,e){t.exports={name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]}},function(t,e){t.exports={name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]}},function(t,e){t.exports={name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]}},function(t,e){t.exports={name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Solves the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lup","lusolve","usolve","matrix","sparse"]}},function(t,e){t.exports={name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu"]}},function(t,e){t.exports={name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]}},function(t,e){t.exports={name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup"]}},function(t,e){t.exports={name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Solves the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["lup","lusolve","lsolve","matrix","sparse"]}},function(t,e){t.exports={name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]}},function(t,e){t.exports={name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]}},function(t,e){t.exports={name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]}},function(t,e){t.exports={name:"ceil",category:"Arithmetic",syntax:["ceil(x)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)"],seealso:["floor","fix","round"]}},function(t,e){t.exports={name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]}},function(t,e){t.exports={name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]}},function(t,e){t.exports={name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]}},function(t,e){t.exports={name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]}},function(t,e){t.exports={name:"dotpow",category:"Operators",syntax:["x .^ y","dotpow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]}},function(t,e){t.exports={name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["pow","log"]}},function(t,e){t.exports={name:"fix",category:"Arithmetic",syntax:["fix(x)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)"],seealso:["ceil","floor","round"]}},function(t,e){t.exports={name:"floor",category:"Arithmetic",syntax:["floor(x)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)"],seealso:["ceil","fix","round"]}},function(t,e){t.exports={name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]}},function(t,e){t.exports={name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenusa of a list with values. ",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]}},function(t,e){t.exports={name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]}},function(t,e){t.exports={name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log10"]}},function(t,e){t.exports={name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]}},function(t,e){t.exports={name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","function isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]}},function(t,e){t.exports={name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]}},function(t,e){t.exports={name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i))","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)","norm([[1, 2], [3, 4]], 'inf')","norm([[1, 2], [3, 4]], 'fro')"]}},function(t,e){t.exports={name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["sqrt","pow"]}},function(t,e){t.exports={name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3 = 8","2*2*2","1 + e ^ (pi * i)"],seealso:["multiply"]}},function(t,e){t.exports={name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)"],seealso:["ceil","floor","fix"]}},function(t,e){t.exports={name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>1, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]}},function(t,e){t.exports={name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","multiply"]}},function(t,e){t.exports={name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]}},function(t,e){t.exports={name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]}},function(t,e){t.exports={name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]}},function(t,e){t.exports={name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]}},function(t,e){t.exports={name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]}},function(t,e){t.exports={name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"rightArithShift",category:"Bitwise",syntax:["x >> y","leftShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]}},function(t,e){t.exports={name:"rightLogShift",category:"Bitwise",syntax:["x >> y","leftShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]}},function(t,e){t.exports={name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]}},function(t,e){t.exports={name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]}},function(t,e){t.exports={name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]}},function(t,e){t.exports={name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]}},function(t,e){t.exports={name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]}},function(t,e){t.exports={name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]}},function(t,e){t.exports={name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number, number": f(x)=x+x })',"double(2)",'double("hello")'],seealso:[]}},function(t,e){t.exports={name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",
examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]}},function(t,e){t.exports={name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]}},function(t,e){t.exports={name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]}},function(t,e){t.exports={name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]}},function(t,e){t.exports={name:"eval",category:"Expression",syntax:["eval(expression)","eval([expr1, expr2, expr3, ...])"],description:"Evaluate an expression or an array with expressions.",examples:['eval("2 + 3")','eval("sqrt(" + 4 + ")")'],seealso:[]}},function(t,e){t.exports={name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]}},function(t,e){t.exports={name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]}},function(t,e){t.exports={name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]}},function(t,e){t.exports={name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]}},function(t,e){t.exports={name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]}},function(t,e){t.exports={name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]}},function(t,e){t.exports={name:"xor",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 or 4"],seealso:["not","and","or"]}},function(t,e){t.exports={name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]}},function(t,e){t.exports={name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"dot",category:"Matrix",syntax:["dot(A, B)"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]}},function(t,e){t.exports={name:"eye",category:"Matrix",syntax:["eye(n)","eye(m, n)","eye([m, n])","eye"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["eye(3)","eye(3, 5)","a = [1, 2, 3; 4, 5, 6]","eye(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]}},function(t,e){t.exports={name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]}},function(t,e){t.exports={name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["forEach([1, 2, 3], function(val) { console.log(val) })"],seealso:["map","sort","filter"]}},function(t,e){t.exports={name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","eye","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"map",category:"Matrix",syntax:["map(x, callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array.",examples:["map([1, 2, 3], function(val) { return value * value })"],seealso:["filter","forEach"]}},function(t,e){t.exports={name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])","ones"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","eye","inv","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1)'],seealso:["sort"]}},function(t,e){t.exports={name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","eye","inv","ones","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze"]}},function(t,e){t.exports={name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","det","diag","eye","inv","ones","range","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc" or "desc", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"])',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)'],seealso:["map","filter","forEach"]}},function(t,e){t.exports={name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","eye","inv","ones","range","size","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of a matrix or string. Indexes are one-based. Both the ranges lower-bound and upper-bound are included.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","trace","transpose","zeros"]}},function(t,e){t.exports={name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","transpose","zeros"]}},function(t,e){t.exports={name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","zeros"]}},function(t,e){t.exports={name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])","zeros"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose"]}},function(t,e){t.exports={name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["permutations","factorial"]}},function(t,e){t.exports={name:"factorial",category:"Probability",syntax:["kldivergence(x, y)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","permutations","gamma"]}},function(t,e){t.exports={name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]}},function(t,e){t.exports={name:"kldivergence",category:"Probability",syntax:["n!","factorial(n)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["math.kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]}},function(t,e){t.exports={name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai <= 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]}},function(t,e){t.exports={name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","factorial"]}},function(t,e){t.exports={name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]}},function(t,e){t.exports={name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]}},function(t,e){t.exports={name:"randInt",category:"Probability",syntax:["randInt(max)","randInt(min, max)","randInt(size)","randInt(size, max)","randInt(size, min, max)"],description:"Return a random integer number",examples:["randInt(10, 20)","randInt([2, 3], 10)"],seealso:["pickRandom","random"]}},function(t,e){t.exports={name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 if x is larger than y, -1 if x is smaller than y, and 0 if x and y are equal.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq"]}},function(t,e){t.exports={name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["[1,3,4] == [1,3,4]","[1,3,4] == [1,3]"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]}},function(t,e){t.exports={name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(t,e){t.exports={name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]}},function(t,e){t.exports={name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 > 1+1","2 >= 1+1","a = 3.2","b = 6-2.8","(a > b)"],seealso:["equal","unequal","smallerEq","smaller","largerEq","compare"]}},function(t,e){t.exports={name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]}},function(t,e){t.exports={name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 1+1","2 <= 1+1","a = 3.2","b = 6-2.8","(a < b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]}},function(t,e){t.exports={name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(t,e){t.exports={name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]}},function(t,e){t.exports={name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dim)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dim)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dim)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","var"]}},function(t,e){t.exports={name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(5, 2, 7)","mode([3, -1, 5, 7])"],seealso:["max","mean","min","median","prod","std","sum","var"]}},function(t,e){t.exports={name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","var"]}},function(t,e){t.exports={name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probablity are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","var"]}},function(t,e){t.exports={name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(var(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","sum","var"]}},function(t,e){t.exports={name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"var",category:"Statistics",syntax:["var(a, b, c, ...)","var(A)","var(A, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["var(2, 4, 6)","var([2, 4, 6, 8])",'var([2, 4, 6, 8], "uncorrected")','var([2, 4, 6, 8], "biased")',"var([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]}},function(t,e){t.exports={name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]}},function(t,e){t.exports={name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]}},function(t,e){t.exports={name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]}},function(t,e){t.exports={name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the hyperbolic arccotangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(0.5)"],seealso:["acsch","asech"]}},function(t,e){t.exports={name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(0.5)","acsc(csc(0.5))","acsc(2)"],seealso:["csc","asin","asec"]}},function(t,e){t.exports={name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the hyperbolic arccosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]}},function(t,e){t.exports={name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]}},function(t,e){t.exports={name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]}},function(t,e){t.exports={name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(2.3))"],seealso:["sin","acos","atan"]}},function(t,e){t.exports={name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]}},function(t,e){t.exports={name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(2.3))"],seealso:["tan","acos","asin"]}},function(t,e){t.exports={name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]}},function(t,e){t.exports={name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]}},function(t,e){t.exports={name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]}},function(t,e){t.exports={name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]}},function(t,e){t.exports={name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]}},function(t,e){t.exports={name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]}},function(t,e){t.exports={name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]}},function(t,e){t.exports={name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]}},function(t,e){t.exports={name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]}},function(t,e){t.exports={name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]}},function(t,e){t.exports={name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]}},function(t,e){t.exports={name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]}},function(t,e){t.exports={name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]}},function(t,e){t.exports={name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]}},function(t,e){t.exports={name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]}},function(t,e){t.exports={name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables,and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]}},function(t,e){t.exports={name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]}},function(t,e){t.exports={name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]}},function(t,e){t.exports={name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]}},function(t,e){t.exports={name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]}},function(t,e){t.exports={name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)","isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))",'isNumeric("3")',"isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN"]}},function(t,e){t.exports={name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]}},function(t,e){t.exports={name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]}},function(t,e){t.exports={name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]}},function(t,e){t.exports={name:"typeof",category:"Utils",syntax:["typeof(x)"],description:"Get the type of a variable.",examples:["typeof(3.5)","typeof(2 - 4i)","typeof(45 deg)",'typeof("hello world")'],seealso:[]}},function(t,e,r){t.exports=[r(279),r(302),r(303),r(304),r(305)]},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(280));return o("compile",{string:function(t){return a(t).compile()},"Array | Matrix":function(t){return n(t,function(t){return a(t).compile()})}})}var n=r(19);e.name="compile",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){if(1!=arguments.length&&2!=arguments.length)throw new n("parse",arguments.length,1,2);if(dt=r&&r.nodes?r.nodes:{},"string"==typeof e)return pt=e,y();if(Array.isArray(e)||e instanceof t.Matrix)return o(e,function(t){if("string"!=typeof t)throw new TypeError("String expected");return pt=t,y()});throw new TypeError("String or matrix expected")}function l(){gt=0,yt=pt.charAt(0),wt=0,bt=null}function u(){gt++,yt=pt.charAt(gt)}function c(){return pt.charAt(gt-1)}function h(){return pt.charAt(gt+1)}function f(){return pt.charAt(gt+2)}function d(){for(Et=ct.NULL,vt="",mt="";s.isWhitespace(yt,wt);)u();if("#"==yt)for(;"\n"!=yt&&""!=yt;)mt+=yt,u();if(""==yt)return void(Et=ct.DELIMITER);if("\n"==yt&&!wt)return Et=ct.DELIMITER,vt=yt,void u();var t=yt+h(),e=t+f();if(3==e.length&&ht[e])return Et=ct.DELIMITER,vt=e,u(),u(),void u();if(2==t.length&&ht[t])return Et=ct.DELIMITER,vt=t,u(),void u();if(ht[yt])return Et=ct.DELIMITER,vt=yt,void u();if(!s.isDigitDot(yt)){if(s.isAlpha(yt,c(),h())){for(;s.isAlpha(yt,c(),h())||s.isDigit(yt);)vt+=yt,u();return void(Et=ft.hasOwnProperty(vt)?ct.DELIMITER:ct.SYMBOL)}for(Et=ct.UNKNOWN;""!=yt;)vt+=yt,u();throw Y('Syntax error in part "'+vt+'"')}if(Et=ct.NUMBER,"."==yt)vt+=yt,u(),s.isDigit(yt)||(Et=ct.DELIMITER);else{for(;s.isDigit(yt);)vt+=yt,u();s.isDecimalMark(yt,h())&&(vt+=yt,u())}for(;s.isDigit(yt);)vt+=yt,u();if(t=h(),"E"==yt||"e"==yt)if(s.isDigit(t)||"-"==t||"+"==t){
if(vt+=yt,u(),("+"==yt||"-"==yt)&&(vt+=yt,u()),!s.isDigit(yt))throw Y('Digit expected, got "'+yt+'"');for(;s.isDigit(yt);)vt+=yt,u();if(s.isDecimalMark(yt,h()))throw Y('Digit expected, got "'+yt+'"')}else if("."==t)throw u(),Y('Digit expected, got "'+yt+'"')}function p(){do d();while("\n"==vt)}function m(){wt++}function g(){wt--}function y(){l(),d();var t=v();if(""!=vt)throw Et==ct.DELIMITER?$("Unexpected operator "+vt):Y('Unexpected part "'+vt+'"');return t}function v(){var t,e,r=[];if(""==vt)return t=new et("undefined","undefined"),t.comment=mt,t;for("\n"!=vt&&";"!=vt&&(t=E(),t.comment=mt);"\n"==vt||";"==vt;)0==r.length&&t&&(e=";"!=vt,r.push({node:t,visible:e})),d(),"\n"!=vt&&";"!=vt&&""!=vt&&(t=E(),t.comment=mt,e=";"!=vt,r.push({node:t,visible:e}));return r.length>0?new Q(r):t}function E(){var t,e,r,i,n=w();if("="==vt){if(n&&n.isSymbolNode)return t=n.name,p(),r=E(),new Z(new ut(t),r);if(n&&n.isAccessorNode)return p(),r=E(),new Z(n.object,n.index,r);if(n&&n.isFunctionNode&&(i=!0,e=[],t=n.name,n.args.forEach(function(t,r){t&&t.isSymbolNode?e[r]=t.name:i=!1}),i))return p(),r=E(),new rt(t,e,r);throw Y("Invalid left hand side of assignment operator =")}return n}function w(){for(var t=b();"?"==vt;){var e=bt;bt=wt,p();var r=t,i=E();if(":"!=vt)throw Y("False part of conditional expression expected");bt=null,p();var n=E();t=new tt(r,i,n),bt=e}return t}function b(){for(var t=x();"or"==vt;)p(),t=new ot("or","or",[t,x()]);return t}function x(){for(var t=_();"xor"==vt;)p(),t=new ot("xor","xor",[t,_()]);return t}function _(){for(var t=S();"and"==vt;)p(),t=new ot("and","and",[t,S()]);return t}function S(){for(var t=T();"|"==vt;)p(),t=new ot("|","bitOr",[t,T()]);return t}function T(){for(var t=L();"^|"==vt;)p(),t=new ot("^|","bitXor",[t,L()]);return t}function L(){for(var t=M();"&"==vt;)p(),t=new ot("&","bitAnd",[t,M()]);return t}function M(){var t,e,r,i,n;for(t=A(),e={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};vt in e;)r=vt,i=e[r],p(),n=[t,A()],t=new ot(r,i,n);return t}function A(){var t,e,r,i,n;for(t=N(),e={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};vt in e;)r=vt,i=e[r],p(),n=[t,N()],t=new ot(r,i,n);return t}function N(){var t,e,r,i,n;for(t=R(),e={to:"to","in":"to"};vt in e;)r=vt,i=e[r],p(),"in"===r&&""===vt?t=new ot("*","multiply",[t,new ut("in")],!0):(n=[t,R()],t=new ot(r,i,n));return t}function R(){var t,e=[];if(t=":"==vt?new et("1","number"):C(),":"==vt&&bt!==wt){for(e.push(t);":"==vt&&e.length<3;)p(),")"==vt||"]"==vt||","==vt||""==vt?e.push(new ut("end")):e.push(C());t=3==e.length?new lt(e[0],e[2],e[1]):new lt(e[0],e[1])}return t}function C(){var t,e,r,i,n;for(t=P(),e={"+":"add","-":"subtract"};vt in e;)r=vt,i=e[r],p(),n=[t,P()],t=new ot(r,i,n);return t}function P(){var t,e,r,i,n;for(t=O(),e=t,r={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};;)if(vt in r)i=vt,n=r[i],p(),e=O(),t=new ot(i,n,[t,e]);else{if(!(Et==ct.SYMBOL||"in"==vt&&t&&t.isConstantNode)&&(Et!=ct.NUMBER||e.isConstantNode||e.isOperatorNode&&"!"!==e.op)&&"("!=vt)break;e=O(),t=new ot("*","multiply",[t,e],!0)}return t}function O(){var t,e,r={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"}[vt];return r?(t=vt,p(),e=[O()],new ot(t,r,e)):I()}function I(){var t,e,r,i;return t=k(),("^"==vt||".^"==vt)&&(e=vt,r="^"==e?"pow":"dotPow",p(),i=[t,O()],t=new ot(e,r,i)),t}function k(){var t,e,r,i,n;for(t=D(),e={"!":"factorial","'":"transpose"};vt in e;)r=vt,i=e[r],d(),n=[t],t=new ot(r,i,n),t=F(t);return t}function D(){var t,e=[];if(Et==ct.SYMBOL&&dt[vt]){if(t=dt[vt],d(),"("==vt){if(e=[],m(),d(),")"!=vt)for(e.push(E());","==vt;)d(),e.push(E());if(")"!=vt)throw Y("Parenthesis ) expected");g(),d()}return new t(e)}return V()}function V(){var t,e;return Et==ct.SYMBOL||Et==ct.DELIMITER&&vt in ft?(e=vt,d(),t=new ut(e),t=F(t)):G()}function F(t,e){for(var r;!("("!=vt&&"["!=vt&&"."!=vt||e&&-1===e.indexOf(vt));)if(r=[],"("==vt){if(!t.isSymbolNode&&!t.isAccessorNode)return t;if(m(),d(),")"!=vt)for(r.push(E());","==vt;)d(),r.push(E());if(")"!=vt)throw Y("Parenthesis ) expected");g(),d(),t=new st(t,r)}else if("["==vt){if(m(),d(),"]"!=vt)for(r.push(E());","==vt;)d(),r.push(E());if("]"!=vt)throw Y("Parenthesis ] expected");g(),d(),t=new X(t,new it(r))}else{if(d(),Et!=ct.SYMBOL)throw Y("Property name expected after dot");r.push(new et(vt)),d();var i=!0;t=new X(t,new it(r,i))}return t}function G(){var t,e;return'"'==vt?(e=B(),t=new et(e,"string"),t=F(t)):W()}function B(){for(var t="";""!=yt&&'"'!=yt;)"\\"==yt&&(t+=yt,u()),t+=yt,u();if(d(),'"'!=vt)throw Y('End of string " expected');return d(),t}function W(){var t,e,r,i;if("["==vt){if(m(),d(),"]"!=vt){var n=U();if(";"==vt){for(r=1,e=[n];";"==vt;)d(),e[r]=U(),r++;if("]"!=vt)throw Y("End of matrix ] expected");g(),d(),i=e[0].items.length;for(var o=1;r>o;o++)if(e[o].items.length!=i)throw $("Column dimensions mismatch ("+e[o].items.length+" != "+i+")");t=new J(e)}else{if("]"!=vt)throw Y("End of matrix ] expected");g(),d(),t=n}}else g(),d(),t=new J([]);return F(t)}return j()}function U(){for(var t=[E()],e=1;","==vt;)d(),t[e]=E(),e++;return new J(t)}function j(){if("{"==vt){var t,e={};do if(d(),"}"!=vt){if('"'==vt)t=B();else{if(Et!=ct.SYMBOL)throw Y("Symbol or string expected as object key");t=vt,d()}if(":"!=vt)throw Y("Colon : expected after object key");d(),e[t]=E()}while(","==vt);if("}"!=vt)throw Y("Comma , or bracket } expected after object value");d();var r=new nt(e);return r=F(r)}return z()}function z(){var t;return Et==ct.NUMBER?(t=vt,d(),new et(t,"number")):K()}function K(){var t;if("("==vt){if(m(),d(),t=E(),")"!=vt)throw Y("Parenthesis ) expected");return g(),d(),t=new at(t),t=F(t)}return q()}function q(){throw Y(""==vt?"Unexpected end of expression":"Value expected")}function H(){return gt-vt.length+1}function Y(t){var e=H(),r=new SyntaxError(t+" (char "+e+")");return r["char"]=e,r}function $(t){var e=H(),r=new SyntaxError(t+" (char "+e+")");return r["char"]=e,r}var X=i(r(281)),J=i(r(287)),Z=i(r(288)),Q=i(r(291)),tt=i(r(292)),et=i(r(293)),rt=i(r(294)),it=i(r(295)),nt=i(r(298)),ot=i(r(299)),at=i(r(301)),st=i(r(300)),lt=i(r(296)),ut=i(r(297)),ct={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},ht={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"'":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},ft={mod:!0,to:!0,"in":!0,and:!0,xor:!0,or:!0,not:!0},dt={},pt="",mt="",gt=0,yt="",vt="",Et=ct.NULL,wt=0,bt=null;return s.isAlpha=function(t,e,r){return s.isValidLatinOrGreek(t)||s.isValidMathSymbol(t,r)||s.isValidMathSymbol(e,t)},s.isValidLatinOrGreek=function(t){return/^[a-zA-Z_\u00C0-\u02AF\u0370-\u03FF]$/.test(t)},s.isValidMathSymbol=function(t,e){return/^[\uD835]$/.test(t)&&/^[\uDC00-\uDFFF]$/.test(e)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(e)},s.isWhitespace=function(t,e){return" "==t||"	"==t||"\n"==t&&e>0},s.isDecimalMark=function(t,e){return"."==t&&"/"!==e&&"*"!==e&&"^"!==e},s.isDigitDot=function(t){return t>="0"&&"9">=t||"."==t},s.isDigit=function(t){return t>="0"&&"9">=t},s}var n=r(11),o=r(19);e.name="parse",e.path="expression",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError('Node expected for parameter "object"');if(!e||!e.isIndexNode)throw new TypeError('IndexNode expected for parameter "index"');this.object=t||null,this.index=e,Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function a(t){return!(t.isAccessorNode||t.isArrayNode||t.isConstantNode||t.isFunctionNode||t.isObjectNode||t.isParenthesisNode||t.isSymbolNode)}var s=i(r(282)),l=i(r(284));return o.prototype=new s,o.prototype.type="AccessorNode",o.prototype.isAccessorNode=!0,o.prototype._compile=function(t,e){t.access=l;var r=this.object._compile(t,e),i=this.index._compile(t,e);return this.index.isObjectProperty()?r+'["'+this.index.getObjectProperty()+'"]':this.index.needsSize()?"(function () {  var object = "+r+";  var size = math.size(object).valueOf();  return access(object, "+i+");})()":"access("+r+", "+i+")"},o.prototype.forEach=function(t){t(this.object,"object",this),t(this.index,"index",this)},o.prototype.map=function(t){return new o(this._ifNode(t(this.object,"object",this)),this._ifNode(t(this.index,"index",this)))},o.prototype.clone=function(){return new o(this.object,this.index)},o.prototype._toString=function(t){var e=this.object.toString(t);return a(this.object)&&(e="("+e+")"),e+this.index.toString(t)},o.prototype._toTex=function(t){var e=this.object.toTex(t);return a(this.object)&&(e="\\left("+e+"\\right)"),e+this.index.toTex(t)},o}e.name="AccessorNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i,a){function s(){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator")}function l(t){for(var e in t)if(t.hasOwnProperty(e)&&e in n)throw new Error('Scope contains an illegal symbol, "'+e+'" is a reserved keyword')}return s.prototype.eval=function(t){return this.compile().eval(t)},s.prototype.type="Node",s.prototype.isNode=!0,s.prototype.comment="",s.prototype.compile=function(){if(arguments.length>0)throw new Error("Calling compile(math) is deprecated. Call the function as compile() instead.");var t={math:a.expression.transform,args:{},_validateScope:l},e={},r=this._compile(t,e),i=Object.keys(t).map(function(t){return"    var "+t+' = defs["'+t+'"];'}),n=i.join(" ")+'return {  "eval": function (scope) {    if (scope) _validateScope(scope);    scope = scope || {};    return '+r+";  }};",o=new Function("defs",n);return o(t)},s.prototype._compile=function(t,e){throw new Error("Cannot compile a Node interface")},s.prototype.forEach=function(t){throw new Error("Cannot run forEach on a Node interface")},s.prototype.map=function(t){throw new Error("Cannot run map on a Node interface")},s.prototype._ifNode=function(t){if(!t||!t.isNode)throw new TypeError("Callback function must return a Node");return t},s.prototype.traverse=function(t){function e(t,r){t.forEach(function(t,i,n){r(t,i,n),e(t,r)})}t(this,null,null),e(this,t)},s.prototype.transform=function(t){function e(t,r){return t.map(function(t,i,n){var o=r(t,i,n);return e(o,r)})}var r=t(this,null,null);return e(r,t)},s.prototype.filter=function(t){var e=[];return this.traverse(function(r,i,n){t(r,i,n)&&e.push(r)}),e},s.prototype.find=function(){throw new Error("Function Node.find is deprecated. Use Node.filter instead.")},s.prototype.match=function(){throw new Error("Function Node.match is deprecated. See functions Node.filter, Node.transform, Node.traverse.")},s.prototype.clone=function(){throw new Error("Cannot clone a Node interface")},s.prototype.equals=function(t){return t?o(this,t):!1},s.prototype.toString=function(t){var e;if(t&&"object"==typeof t)switch(typeof t.handler){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return"undefined"!=typeof e?e:this._toString(t)},s.prototype._toString=function(){throw new Error("_toString not implemented for "+this.type)},s.prototype.toTex=function(t){var e;if(t&&"object"==typeof t)switch(typeof t.handler){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return"undefined"!=typeof e?e:this._toTex(t)},s.prototype._toTex=function(t){throw new Error("_toTex not implemented for "+this.type)},s.prototype.getIdentifier=function(){return this.type},s.prototype.getContent=function(){return this},s}var n=r(283),o=(r(3).extend,r(3).deepEqual);e.name="Node",e.path="expression.node",e.math=!0,e.factory=i},function(t,e){"use strict";t.exports={end:!0}},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(286)),s=i(r(52));return function(t,e){try{if(Array.isArray(t))return s(t).subset(e).valueOf();if(t&&"function"==typeof t.subset)return t.subset(e);if("string"==typeof t)return a(t,e);if("object"==typeof t){if(!e.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return t[e.getObjectProperty()]}throw new TypeError("Cannot apply index: unsupported type of object")}catch(r){throw n(r)}}}var n=r(285).transform;e.factory=i},function(t,e,r){var i=r(43);e.transform=function(t){return t&&t.isIndexError?new i(t.index+1,t.min+1,void 0!==t.max?t.max+1:void 0):t}},function(t,e,r){"use strict";function i(t,e,i,u){function c(t,e){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(1!=e.size().length)throw new l(e.size().length,1);var r=t.length;s(e.min()[0],r),s(e.max()[0],r);var i=e.dimension(0),n="";return i.forEach(function(e){n+=t.charAt(e)}),n}function h(t,e,r,i){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(1!=e.size().length)throw new l(e.size().length,1);if(void 0!==i){if("string"!=typeof i||1!==i.length)throw new TypeError("Single character expected as defaultValue")}else i=" ";var n=e.dimension(0),o=n.size()[0];if(o!=r.length)throw new l(n.size()[0],r.length);var a=t.length;s(e.min()[0]),s(e.max()[0]);for(var u=[],c=0;a>c;c++)u[c]=t.charAt(c);if(n.forEach(function(t,e){u[t]=r.charAt(e[0])}),u.length>a)for(c=a-1,o=u.length;o>c;c++)u[c]||(u[c]=i);return u.join("")}var f=i(r(52)),d=u("subset",{"Array, Index":function(t,e){var r=f(t),i=r.subset(e);return i&&i.valueOf()},"Matrix, Index":function(t,e){return t.subset(e)},"Object, Index":n,"string, Index":c,"Array, Index, any":function(t,e,r){return f(a(t)).subset(e,r,void 0).valueOf()},"Array, Index, any, any":function(t,e,r,i){return f(a(t)).subset(e,r,i).valueOf()},"Matrix, Index, any":function(t,e,r){return t.clone().subset(e,r)},"Matrix, Index, any, any":function(t,e,r,i){return t.clone().subset(e,r,i)},"string, Index, string":h,"string, Index, string, string":h,"Object, Index, any":o});return d.toTex=void 0,d}function n(t,e){if(1!==e.size().length)throw new l(e.size(),1);var r=e.dimension(0);if("string"!=typeof r)throw new TypeError("String expected as index to retrieve an object property");return t[r]}function o(t,e,r){if(1!==e.size().length)throw new l(e.size(),1);var i=e.dimension(0);if("string"!=typeof i)throw new TypeError("String expected as index to retrieve an object property");var n=a(t);return n[i]=r,n}var a=r(3).clone,s=r(40).validateIndex,l=r(42);e.name="subset",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.items=t||[],!Array.isArray(this.items)||!this.items.every(function(t){return t&&t.isNode}))throw new TypeError("Array containing Nodes expected");var e=function(){throw new Error("Property `ArrayNode.nodes` is deprecated, use `ArrayNode.items` instead")};Object.defineProperty(this,"nodes",{get:e,set:e})}var a=i(r(282));return o.prototype=new a,o.prototype.type="ArrayNode",o.prototype.isArrayNode=!0,o.prototype._compile=function(t,e){var r="Array"!==t.math.config().matrix,i=this.items.map(function(r){return r._compile(t,e)});return(r?"math.matrix([":"[")+i.join(",")+(r?"])":"]")},o.prototype.forEach=function(t){for(var e=0;e<this.items.length;e++){var r=this.items[e];t(r,"items["+e+"]",this)}},o.prototype.map=function(t){for(var e=[],r=0;r<this.items.length;r++)e[r]=this._ifNode(t(this.items[r],"items["+r+"]",this));return new o(e)},o.prototype.clone=function(){return new o(this.items.slice(0))},o.prototype._toString=function(t){var e=this.items.map(function(e){return e.toString(t)});return"["+e.join(", ")+"]"},o.prototype._toTex=function(t){var e="\\begin{bmatrix}";return this.items.forEach(function(r){e+=r.items?r.items.map(function(e){return e.toTex(t)}).join("&"):r.toTex(t),e+="\\\\"}),e+="\\end{bmatrix}"},o}e.name="ArrayNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e,r){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.object=t,this.index=r?e:null,this.value=r?r:e,!t||!t.isSymbolNode&&!t.isAccessorNode)throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(t&&t.isSymbolNode&&"end"===t.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!this.index.isIndexNode)throw new TypeError('IndexNode expected as "index"');if(!this.value||!this.value.isNode)throw new TypeError('Node expected as "value"');Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function a(t,e){e||(e="keep");var r=c.getPrecedence(t,e),i=c.getPrecedence(t.value,e);return"all"===e||null!==i&&r>=i}var s=i(r(282)),l=(i(r(287)),i(r(52)),i(r(289))),u=i(r(284)),c=(r(283),r(290));return o.prototype=new s,o.prototype.type="AssignmentNode",o.prototype.isAssignmentNode=!0,o.prototype._compile=function(t,e){t.assign=l,t.access=u;var r,i=this.object._compile(t,e),n=this.index?this.index._compile(t,e):null,o=this.value._compile(t,e);if(this.index){if(this.index.isObjectProperty())return i+'["'+this.index.getObjectProperty()+'"] = '+o;if(this.object.isSymbolNode)return r=this.index.needsSize()?"var size = math.size(object).valueOf();":"","(function () {  var object = "+i+";  var value = "+o+";  "+r+'  scope["'+this.object.name+'"] = assign(object, '+n+", value);  return value;})()";r=this.index.needsSize()?"var size = math.size(object).valueOf();":"";var a=this.object.object._compile(t,e);if(this.object.index.isObjectProperty()){var s='["'+this.object.index.getObjectProperty()+'"]';return"(function () {  var parent = "+a+";  var object = parent"+s+";  var value = "+o+";"+r+"  parent"+s+" = assign(object, "+n+", value);  return value;})()"}var c=this.object.index.needsSize()?"var size = math.size(parent).valueOf();":"",h=this.object.index._compile(t,e);return"(function () {  var parent = "+a+";  "+c+"  var parentIndex = "+h+";  var object = access(parent, parentIndex);  var value = "+o+";  "+r+"  assign(parent, parentIndex, assign(object, "+n+", value));  return value;})()"}if(!this.object.isSymbolNode)throw new TypeError("SymbolNode expected as object");return'scope["'+this.object.name+'"] = '+o},o.prototype.forEach=function(t){t(this.object,"object",this),this.index&&t(this.index,"index",this),t(this.value,"value",this)},o.prototype.map=function(t){var e=this._ifNode(t(this.object,"object",this)),r=this.index?this._ifNode(t(this.index,"index",this)):null,i=this._ifNode(t(this.value,"value",this));return new o(e,r,i)},o.prototype.clone=function(){return new o(this.object,this.index,this.value)},o.prototype._toString=function(t){var e=this.object.toString(t),r=this.index?this.index.toString(t):"",i=this.value.toString(t);return a(this,t&&t.parenthesis)&&(i="("+i+")"),e+r+" = "+i},o.prototype._toTex=function(t){var e=this.object.toTex(t),r=this.index?this.index.toTex(t):"",i=this.value.toTex(t);return a(this,t&&t.parenthesis)&&(i="\\left("+i+"\\right)"),e+r+":="+i},o}r(32);e.name="AssignmentNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(286)),s=i(r(52));return function(t,e,r){try{if(Array.isArray(t))return s(t).subset(e,r).valueOf();if(t&&"function"==typeof t.subset)return t.subset(e,r);if("string"==typeof t)return a(t,e,r);if("object"==typeof t){if(!e.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return t[e.getObjectProperty()]=r,t}throw new TypeError("Cannot apply index: unsupported type of object")}catch(i){throw n(i)}}}var n=r(285).transform;e.factory=i},function(t,e){"use strict";function r(t,e){var r=t;"keep"!==e&&(r=t.getContent());for(var i=r.getIdentifier(),n=0;n<o.length;n++)if(i in o[n])return n;return null}function i(t,e){var i=t;"keep"!==e&&(i=t.getContent());var n=i.getIdentifier(),a=r(i,e);if(null===a)return null;var s=o[a][n];if(s.hasOwnProperty("associativity")){if("left"===s.associativity)return"left";if("right"===s.associativity)return"right";throw Error("'"+n+"' has the invalid associativity '"+s.associativity+"'.")}return null}function n(t,e,i){var n=t,a=e;if("keep"!==i)var n=t.getContent(),a=e.getContent();var s=n.getIdentifier(),l=a.getIdentifier(),u=r(n,i);if(null===u)return null;var c=o[u][s];if(c.hasOwnProperty("associativeWith")&&c.associativeWith instanceof Array){for(var h=0;h<c.associativeWith.length;h++)if(c.associativeWith[h]===l)return!0;return!1}return null}var o=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{associativity:"left",associativeWith:[]}},{"OperatorNode:and":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{associativity:"left",associativeWith:[]},"OperatorNode:unequal":{associativity:"left",associativeWith:[]},"OperatorNode:smaller":{associativity:"left",associativeWith:[]},"OperatorNode:larger":{associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{associativity:"left",associativeWith:[]}},{"OperatorNode:to":{associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{associativity:"left",associativeWith:[]},"OperatorNode:mod":{associativity:"left",associativeWith:[]}},{"OperatorNode:unaryPlus":{associativity:"right"},"OperatorNode:unaryMinus":{associativity:"right"},"OperatorNode:bitNot":{associativity:"right"},"OperatorNode:not":{associativity:"right"}},{"OperatorNode:pow":{associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{associativity:"left"}},{"OperatorNode:transpose":{associativity:"left"}}];t.exports.properties=o,t.exports.getPrecedence=r,t.exports.getAssociativity=i,t.exports.isAssociativeWith=n},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(t))throw new Error("Array expected");this.blocks=t.map(function(t){var e=t&&t.node,r=t&&void 0!==t.visible?t.visible:!0;if(!e||!e.isNode)throw new TypeError('Property "node" must be a Node');if("boolean"!=typeof r)throw new TypeError('Property "visible" must be a boolean');return{node:e,visible:r}})}var a=i(r(282)),s=i(r(72));return o.prototype=new a,o.prototype.type="BlockNode",o.prototype.isBlockNode=!0,o.prototype._compile=function(t,e){t.ResultSet=s;var r=this.blocks.map(function(r){var i=r.node._compile(t,e);return r.visible?"results.push("+i+");":i+";"});return"(function () {var results = [];"+r.join("")+"return new ResultSet(results);})()"},o.prototype.forEach=function(t){for(var e=0;e<this.blocks.length;e++)t(this.blocks[e].node,"blocks["+e+"].node",this)},o.prototype.map=function(t){for(var e=[],r=0;r<this.blocks.length;r++){var i=this.blocks[r],n=this._ifNode(t(i.node,"blocks["+r+"].node",this));e[r]={node:n,visible:i.visible}}return new o(e)},o.prototype.clone=function(){var t=this.blocks.map(function(t){return{node:t.node,visible:t.visible}});return new o(t)},o.prototype._toString=function(t){return this.blocks.map(function(e){return e.node.toString(t)+(e.visible?"":";")}).join("\n")},o.prototype._toTex=function(t){return this.blocks.map(function(e){return e.node.toTex(t)+(e.visible?"":";")}).join("\\;\\;\n")},o}e.name="BlockNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e,r){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError("Parameter condition must be a Node");if(!e||!e.isNode)throw new TypeError("Parameter trueExpr must be a Node");if(!r||!r.isNode)throw new TypeError("Parameter falseExpr must be a Node");this.condition=t,this.trueExpr=e,this.falseExpr=r}var s=i(r(282));return a.prototype=new s,a.prototype.type="ConditionalNode",a.prototype.isConditionalNode=!0,a.prototype._compile=function(t,e){return t.testCondition=function(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e)return e?!0:!1;if(e){if(e.isBigNumber===!0)return e.isZero()?!1:!0;if(e.isComplex===!0)return e.re||e.im?!0:!1;if(e.isUnit===!0)return e.value?!0:!1}if(null===e||void 0===e)return!1;throw new TypeError('Unsupported type of condition "'+t.math["typeof"](e)+'"')},"testCondition("+this.condition._compile(t,e)+") ? ( "+this.trueExpr._compile(t,e)+") : ( "+this.falseExpr._compile(t,e)+")"},a.prototype.forEach=function(t){t(this.condition,"condition",this),t(this.trueExpr,"trueExpr",this),t(this.falseExpr,"falseExpr",this)},a.prototype.map=function(t){return new a(this._ifNode(t(this.condition,"condition",this)),this._ifNode(t(this.trueExpr,"trueExpr",this)),this._ifNode(t(this.falseExpr,"falseExpr",this)))},a.prototype.clone=function(){return new a(this.condition,this.trueExpr,this.falseExpr)},a.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=n.getPrecedence(this,e),i=this.condition.toString(t),o=n.getPrecedence(this.condition,e);("all"===e||"OperatorNode"===this.condition.type||null!==o&&r>=o)&&(i="("+i+")");var a=this.trueExpr.toString(t),s=n.getPrecedence(this.trueExpr,e);("all"===e||"OperatorNode"===this.trueExpr.type||null!==s&&r>=s)&&(a="("+a+")");var l=this.falseExpr.toString(t),u=n.getPrecedence(this.falseExpr,e);return("all"===e||"OperatorNode"===this.falseExpr.type||null!==u&&r>=u)&&(l="("+l+")"),i+" ? "+a+" : "+l},a.prototype._toTex=function(t){return"\\begin{cases} {"+this.trueExpr.toTex(t)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(t)+"}\\\\{"+this.falseExpr.toTex(t)+"}, &\\quad{\\text{otherwise}}\\end{cases}"},a}var n=(r(32),r(290));e.name="ConditionalNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(e){if("string"!=typeof e)throw new TypeError('String expected for parameter "valueType"');if("string"!=typeof t)throw new TypeError('String expected for parameter "value"');this.value=t,this.valueType=e}else this.value=t+"",this.valueType=n(t);if(!l[this.valueType])throw new TypeError('Unsupported type of value "'+this.valueType+'"')}var s=i(r(282)),l={number:!0,string:!0,"boolean":!0,undefined:!0,"null":!0};return a.prototype=new s,a.prototype.type="ConstantNode",a.prototype.isConstantNode=!0,a.prototype._compile=function(t,e){switch(this.valueType){case"number":var r=t.math.config().number;return"BigNumber"===r?'math.bignumber("'+this.value+'")':"Fraction"===r?'math.fraction("'+this.value+'")':this.value.replace(/^(0*)[0-9]/,function(t,e){return t.substring(e.length)});case"string":return'"'+this.value+'"';case"boolean":return this.value;case"undefined":return this.value;case"null":return this.value;default:throw new TypeError('Unsupported type of constant "'+this.valueType+'"')}},a.prototype.forEach=function(t){},a.prototype.map=function(t){return this.clone()},a.prototype.clone=function(){return new a(this.value,this.valueType)},a.prototype._toString=function(t){switch(this.valueType){case"string":return'"'+this.value+'"';default:return this.value}},a.prototype._toTex=function(t){var e,r=this.value;switch(this.valueType){case"string":return'\\mathtt{"'+r+'"}';case"number":return e=r.toLowerCase().indexOf("e"),-1!==e?r.substring(0,e)+"\\cdot10^{"+r.substring(e+1)+"}":r;default:return r}},a}var n=r(41).type;e.name="ConstantNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,s){function l(t,e,r){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(e))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!r||!r.isNode)throw new TypeError('Node expected for parameter "expr"');if(t in n)throw new Error('Illegal function name, "'+t+'" is a reserved keyword');this.name=t,this.params=e.map(function(t){return t&&t.name||t}),this.types=e.map(function(t){return t&&t.type||"any"}),this.expr=r}function u(t,e){var r=a.getPrecedence(t,e),i=a.getPrecedence(t.expr,e);return"all"===e||null!==i&&r>=i}var c=i(r(282));return l.prototype=new c,l.prototype.type="FunctionAssignmentNode",l.prototype.isFunctionAssignmentNode=!0,l.prototype._compile=function(t,e){t.typed=s;var r=Object.create(e);this.params.forEach(function(t){r[t]=!0});var i=this.expr._compile(t,r);return'scope["'+this.name+'"] =   (function () {    var fn = typed("'+this.name+'", {      "'+this.types.join(",")+'": function ('+this.params.join(",")+") {        return "+i+'      }    });    fn.syntax = "'+this.name+"("+this.params.join(", ")+')";    return fn;  })()'},l.prototype.forEach=function(t){t(this.expr,"expr",this)},l.prototype.map=function(t){var e=this._ifNode(t(this.expr,"expr",this));return new l(this.name,this.params.slice(0),e)},l.prototype.clone=function(){return new l(this.name,this.params.slice(0),this.expr)},l.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=this.expr.toString(t);return u(this,e)&&(r="("+r+")"),"function "+this.name+"("+this.params.join(", ")+") = "+r},l.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=this.expr.toTex(t);return u(this,e)&&(r="\\left("+r+"\\right)"),"\\mathrm{"+this.name+"}\\left("+this.params.map(o.toSymbol).join(",")+"\\right):="+r},l}var n=r(283),o=r(32),a=r(290);e.name="FunctionAssignmentNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.dimensions=t,this.dotNotation=e||!1,!l(t)||!t.every(function(t){return t&&t.isNode}))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties");var r=function(){throw new Error("Property `IndexNode.object` is deprecated, use `IndexNode.fn` instead")};Object.defineProperty(this,"object",{get:r,set:r})}var a=i(r(282)),s=(i(r(296)),i(r(297)),i(r(67))),l=Array.isArray;return o.prototype=new a,o.prototype.type="IndexNode",o.prototype.isIndexNode=!0,o.prototype._compile=function(t,e){
var r=Object.create(e);t.range=function(t,e,r){return new s(t&&t.isBigNumber===!0?t.toNumber():t,e&&e.isBigNumber===!0?e.toNumber():e,r&&r.isBigNumber===!0?r.toNumber():r)};var i=this.dimensions.map(function(e,i){return e&&e.isRangeNode?e.needsEnd()?(r.end=!0,"(function () {var end = size["+i+"]; return range("+e.start._compile(t,r)+", "+e.end._compile(t,r)+", "+(e.step?e.step._compile(t,r):"1")+"); })()"):"range("+e.start._compile(t,r)+", "+e.end._compile(t,r)+", "+(e.step?e.step._compile(t,r):"1")+")":e.isSymbolNode&&"end"===e.name?(r.end=!0,"(function () {var end = size["+i+"]; return "+e._compile(t,r)+"; })()"):e._compile(t,r)});return"math.index("+i.join(", ")+")"},o.prototype.forEach=function(t){for(var e=0;e<this.dimensions.length;e++)t(this.dimensions[e],"dimensions["+e+"]",this)},o.prototype.map=function(t){for(var e=[],r=0;r<this.dimensions.length;r++)e[r]=this._ifNode(t(this.dimensions[r],"dimensions["+r+"]",this));return new o(e)},o.prototype.clone=function(){return new o(this.dimensions.slice(0))},o.prototype.isObjectProperty=function(){return 1===this.dimensions.length&&this.dimensions[0].isConstantNode&&"string"===this.dimensions[0].valueType},o.prototype.getObjectProperty=function(){return this.isObjectProperty()?this.dimensions[0].value:null},o.prototype._toString=function(t){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"},o.prototype._toTex=function(t){var e=this.dimensions.map(function(e){return e.toTex(t)});return this.dotNotation?"."+this.getObjectProperty():"_{"+e.join(",")+"}"},o.prototype.needsSize=function(){return this.dimensions.some(function(t){return t.isRangeNode&&t.needsEnd()||t.isSymbolNode&&"end"===t.name})},o}e.name="IndexNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e,r){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError("Node expected");if(!e||!e.isNode)throw new TypeError("Node expected");if(r&&(!r||!r.isNode))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=t,this.end=e,this.step=r||null}function s(t,e){var r=n.getPrecedence(t,e),i={},o=n.getPrecedence(t.start,e);if(i.start=null!==o&&r>=o||"all"===e,t.step){var a=n.getPrecedence(t.step,e);i.step=null!==a&&r>=a||"all"===e}var s=n.getPrecedence(t.end,e);return i.end=null!==s&&r>=s||"all"===e,i}var l=i(r(282));return a.prototype=new l,a.prototype.type="RangeNode",a.prototype.isRangeNode=!0,a.prototype.needsEnd=function(){var t=this.filter(function(t){return t&&t.isSymbolNode&&"end"==t.name});return t.length>0},a.prototype._compile=function(t,e){return"math.range("+this.start._compile(t,e)+", "+this.end._compile(t,e)+(this.step?", "+this.step._compile(t,e):"")+")"},a.prototype.forEach=function(t){t(this.start,"start",this),t(this.end,"end",this),this.step&&t(this.step,"step",this)},a.prototype.map=function(t){return new a(this._ifNode(t(this.start,"start",this)),this._ifNode(t(this.end,"end",this)),this.step&&this._ifNode(t(this.step,"step",this)))},a.prototype.clone=function(){return new a(this.start,this.end,this.step&&this.step)},a.prototype._toString=function(t){var e,r=t&&t.parenthesis?t.parenthesis:"keep",i=s(this,r),n=this.start.toString(t);if(i.start&&(n="("+n+")"),e=n,this.step){var o=this.step.toString(t);i.step&&(o="("+o+")"),e+=":"+o}var a=this.end.toString(t);return i.end&&(a="("+a+")"),e+=":"+a},a.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=s(this,e),i=this.start.toTex(t);if(r.start&&(i="\\left("+i+"\\right)"),this.step){var n=this.step.toTex(t);r.step&&(n="\\left("+n+"\\right)"),i+=":"+n}var o=this.end.toTex(t);return r.end&&(o="\\left("+o+"\\right)"),i+=":"+o},a}var n=r(290);e.name="RangeNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o,a){function s(t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('String expected for parameter "name"');this.name=t}function l(t){throw new Error("Undefined symbol "+t)}var u=i(r(282)),c=i(r(75));return s.prototype=new u,s.prototype.type="SymbolNode",s.prototype.isSymbolNode=!0,s.prototype._compile=function(t,e){return t.undef=l,t.Unit=c,e[this.name]?this.name:this.name in t.math?'("'+this.name+'" in scope ? scope["'+this.name+'"] : math["'+this.name+'"])':'("'+this.name+'" in scope ? scope["'+this.name+'"] : '+(c.isValuelessUnit(this.name)?'new Unit(null, "'+this.name+'")':'undef("'+this.name+'")')+")"},s.prototype.forEach=function(t){},s.prototype.map=function(t){return this.clone()},s.prototype.clone=function(){return new s(this.name)},s.prototype._toString=function(t){return this.name},s.prototype._toTex=function(t){var e=!1;"undefined"==typeof a[this.name]&&c.isValuelessUnit(this.name)&&(e=!0);var r=n.toSymbol(this.name,e);return"\\"===r[0]?r:" "+r},s}var n=r(32);e.name="SymbolNode",e.path="expression.node",e.math=!0,e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.properties=t||{},t&&("object"!=typeof t||Object.keys(t).some(function(e){return!t[e]||!t[e].isNode})))throw new TypeError("Object containing Nodes expected")}var a=i(r(282));return o.prototype=new a,o.prototype.type="ObjectNode",o.prototype.isObjectNode=!0,o.prototype._compile=function(t,e){var r=[];for(var i in this.properties)this.properties.hasOwnProperty(i)&&r.push('"'+i+'": '+this.properties[i]._compile(t,e));return"{"+r.join(", ")+"}"},o.prototype.forEach=function(t){for(var e in this.properties)this.properties.hasOwnProperty(e)&&t(this.properties[e],'properties["'+e+'"]',this)},o.prototype.map=function(t){var e={};for(var r in this.properties)this.properties.hasOwnProperty(r)&&(e[r]=this._ifNode(t(this.properties[r],'properties["'+r+'"]',this)));return new o(e)},o.prototype.clone=function(){var t={};for(var e in this.properties)this.properties.hasOwnProperty(e)&&(t[e]=this.properties[e]);return new o(t)},o.prototype._toString=function(t){var e=[];for(var r in this.properties)this.properties.hasOwnProperty(r)&&e.push('"'+r+'": '+this.properties[r].toString(t));return"{"+e.join(", ")+"}"},o.prototype._toTex=function(t){var e=[];for(var r in this.properties)this.properties.hasOwnProperty(r)&&e.push("\\mathbf{"+r+":} & "+this.properties[r].toTex(t)+"\\\\");return"\\left\\{\\begin{array}{ll}"+e.join("\n")+"\\end{array}\\right\\}"},o}r(23);e.name="ObjectNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a,s){function l(t,e,r,i){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('string expected for parameter "op"');if("string"!=typeof e)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(r)||!r.every(function(t){return t&&t.isNode}))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=i===!0,this.op=t,this.fn=e,this.args=r||[]}function u(t,e,r,i){var n=o.getPrecedence(t,e),a=o.getAssociativity(t,e);if("all"===e||r.length>2){var s=[];return r.forEach(function(t){switch(t.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":s.push(!1);break;default:s.push(!0)}}),s}switch(r.length){case 0:return[];case 1:var l=o.getPrecedence(r[0],e);if(i&&null!==l){var u,c;if("keep"===e?(u=r[0].getIdentifier(),c=t.getIdentifier()):(u=r[0].getContent().getIdentifier(),c=t.getContent().getIdentifier()),o.properties[n][c].latexLeftParens===!1)return[!1];if(o.properties[l][u].latexParens===!1)return[!1]}return null===l?[!1]:n>=l?[!0]:[!1];case 2:var h,f=o.getPrecedence(r[0],e),d=o.isAssociativeWith(t,r[0],e);h=null===f?!1:f!==n||"right"!==a||d?n>f?!0:!1:!0;var p,m=o.getPrecedence(r[1],e),g=o.isAssociativeWith(t,r[1],e);if(p=null===m?!1:m!==n||"left"!==a||g?n>m?!0:!1:!0,i){var c,y,v;"keep"===e?(c=t.getIdentifier(),y=t.args[0].getIdentifier(),v=t.args[1].getIdentifier()):(c=t.getContent().getIdentifier(),y=t.args[0].getContent().getIdentifier(),v=t.args[1].getContent().getIdentifier()),null!==f&&(o.properties[n][c].latexLeftParens===!1&&(h=!1),o.properties[f][y].latexParens===!1&&(h=!1)),null!==m&&(o.properties[n][c].latexRightParens===!1&&(p=!1),o.properties[m][v].latexParens===!1&&(p=!1))}return[h,p]}}var c=i(r(282));i(r(293)),i(r(297)),i(r(300));return l.prototype=new c,l.prototype.type="OperatorNode",l.prototype.isOperatorNode=!0,l.prototype._compile=function(t,e){if(!t.math[this.fn])throw new Error("Function "+this.fn+' missing in provided namespace "math"');var r=this.args.map(function(r){return r._compile(t,e)});return"math."+this.fn+"("+r.join(", ")+")"},l.prototype.forEach=function(t){for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},l.prototype.map=function(t){for(var e=[],r=0;r<this.args.length;r++)e[r]=this._ifNode(t(this.args[r],"args["+r+"]",this));return new l(this.op,this.fn,e)},l.prototype.clone=function(){return new l(this.op,this.fn,this.args.slice(0))},l.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=t&&t.implicit?t.implicit:"hide",i=this.args,n=u(this,e,i,!1);switch(i.length){case 1:var a=o.getAssociativity(this,e),s=i[0].toString(t);return n[0]&&(s="("+s+")"),"right"===a?this.op+s:"left"===a?s+this.op:s+this.op;case 2:var l=i[0].toString(t),c=i[1].toString(t);return n[0]&&(l="("+l+")"),n[1]&&(c="("+c+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"==r?l+" "+c:l+" "+this.op+" "+c;default:return this.fn+"("+this.args.join(", ")+")"}},l.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=t&&t.implicit?t.implicit:"hide",i=this.args,a=u(this,e,i,!0),s=n.operators[this.fn];switch(s="undefined"==typeof s?this.op:s,i.length){case 1:var l=o.getAssociativity(this,e),c=i[0].toTex(t);return a[0]&&(c="\\left("+c+"\\right)"),"right"===l?s+c:"left"===l?c+s:c+s;case 2:var h=i[0],f=h.toTex(t);a[0]&&(f="\\left("+f+"\\right)");var d=i[1],p=d.toTex(t);a[1]&&(p="\\left("+p+"\\right)");var m;switch(m="keep"===e?h.getIdentifier():h.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return s+"{"+f+"}{"+p+"}";case"OperatorNode:pow":switch(f="{"+f+"}",p="{"+p+"}",m){case"ConditionalNode":case"OperatorNode:divide":f="\\left("+f+"\\right)"}case"OperatorNode:multiply":if(this.implicit&&"hide"===r)return f+"~"+p}return f+s+p;default:return"\\mathrm{"+this.fn+"}\\left("+i.map(function(e){return e.toTex(t)}).join(",")+"\\right)"}},l.prototype.getIdentifier=function(){return this.type+":"+this.fn},l}var n=r(32),o=r(290);e.name="OperatorNode",e.path="expression.node",e.math=!0,e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o,a){function s(t,e){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if("string"==typeof t&&(console.warn("WARNING: passing a string to FunctionNode is deprecated, pass a SymbolNode instead."),t=new c(t)),!t||!t.isNode)throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(e)||!e.every(function(t){return t&&t.isNode}))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=t,this.args=e||[],Object.defineProperty(this,"name",{get:function(){return this.fn.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}});var r=function(){throw new Error("Property `FunctionNode.object` is deprecated, use `FunctionNode.fn` instead")};Object.defineProperty(this,"object",{get:r,set:r})}function l(t,e,r){for(var i,n="",o=new RegExp("\\$(?:\\{([a-z_][a-z_0-9]*)(?:\\[([0-9]+)\\])?\\}|\\$)","ig"),a=0;null!==(i=o.exec(t));)if(n+=t.substring(a,i.index),a=i.index,"$$"===i[0])n+="$",a++;else{a+=i[0].length;var s=e[i[1]];if(!s)throw new ReferenceError("Template: Property "+i[1]+" does not exist.");if(void 0===i[2])switch(typeof s){case"string":n+=s;break;case"object":if(s.isNode)n+=s.toTex(r);else{if(!Array.isArray(s))throw new TypeError("Template: "+i[1]+" has to be a Node, String or array of Nodes");n+=s.map(function(t,e){if(t&&t.isNode)return t.toTex(r);throw new TypeError("Template: "+i[1]+"["+e+"] is not a Node.")}).join(",")}break;default:throw new TypeError("Template: "+i[1]+" has to be a Node, String or array of Nodes")}else{if(!s[i[2]]||!s[i[2]].isNode)throw new TypeError("Template: "+i[1]+"["+i[2]+"] is not a Node.");n+=s[i[2]].toTex(r)}}return n+=t.slice(a)}var u=i(r(282)),c=i(r(297));s.prototype=new u,s.prototype.type="FunctionNode",s.prototype.isFunctionNode=!0,s.prototype._compile=function(t,e){var r,i=this.fn._compile(t,e),n=this.args.map(function(r){return r._compile(t,e)});if(this.fn.isSymbolNode){var o=this.fn.name,a=t.math[o],s="function"==typeof a&&1==a.rawArgs;return s?(r=this._getUniqueArgumentsName(t),t[r]=this.args,i+"("+r+", math, scope)"):i+"("+n.join(", ")+")"}if(this.fn.isAccessorNode&&this.fn.index.isObjectProperty()){r=this._getUniqueArgumentsName(t),t[r]=this.args;var l=this.fn.object._compile(t,e),u=this.fn.index.getObjectProperty();return"(function () {var object = "+l+';return (object["'+u+'"] && object["'+u+'"].rawArgs)  ? object["'+u+'"]('+r+', math, scope) : object["'+u+'"]('+n.join(", ")+")})()"}return r=this._getUniqueArgumentsName(t),t[r]=this.args,"(function () {var fn = "+i+";return (fn && fn.rawArgs)  ? fn("+r+", math, scope) : fn("+n.join(", ")+")})()"},s.prototype._getUniqueArgumentsName=function(t){var e,r=0;do e="args"+r,r++;while(e in t);return e},s.prototype.forEach=function(t){for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},s.prototype.map=function(t){for(var e=this.fn.map(t),r=[],i=0;i<this.args.length;i++)r[i]=this._ifNode(t(this.args[i],"args["+i+"]",this));return new s(e,r)},s.prototype.clone=function(){return new s(this.fn,this.args.slice(0))};var h=s.prototype.toString;s.prototype.toString=function(t){var e,r=this.fn.toString(t);return t&&"object"==typeof t.handler&&t.handler.hasOwnProperty(r)&&(e=t.handler[r](this,t)),"undefined"!=typeof e?e:h.call(this,t)},s.prototype._toString=function(t){var e=this.args.map(function(e){return e.toString(t)});return this.fn.toString(t)+"("+e.join(", ")+")"};var f=s.prototype.toTex;return s.prototype.toTex=function(t){var e;return t&&"object"==typeof t.handler&&t.handler.hasOwnProperty(this.name)&&(e=t.handler[this.name](this,t)),"undefined"!=typeof e?e:f.call(this,t)},s.prototype._toTex=function(t){var e,r=this.args.map(function(e){return e.toTex(t)});!a[this.name]||"function"!=typeof a[this.name].toTex&&"object"!=typeof a[this.name].toTex&&"string"!=typeof a[this.name].toTex||(e=a[this.name].toTex);var i;switch(typeof e){case"function":i=e(this,t);break;case"string":i=l(e,this,t);break;case"object":switch(typeof e[r.length]){case"function":i=e[r.length](this,t);break;case"string":i=l(e[r.length],this,t)}}return"undefined"!=typeof i?i:l(n.defaultTemplate,this,t)},s.prototype.getIdentifier=function(){return this.type+":"+this.name},s}var n=r(32);e.name="FunctionNode",e.path="expression.node",e.math=!0,e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError('Node expected for parameter "content"');this.content=t}var a=i(r(282));return o.prototype=new a,o.prototype.type="ParenthesisNode",o.prototype.isParenthesisNode=!0,o.prototype._compile=function(t,e){return this.content._compile(t,e)},o.prototype.getContent=function(){return this.content.getContent()},o.prototype.forEach=function(t){t(this.content,"content",this)},o.prototype.map=function(t){var e=t(this.content,"content",this);return new o(e)},o.prototype.clone=function(){return new o(this.content)},o.prototype._toString=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"("+this.content.toString(t)+")":this.content.toString(t)},o.prototype._toTex=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"\\left("+this.content.toTex(t)+"\\right)":this.content.toTex(t)},o}e.name="ParenthesisNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(280));return o("compile",{string:function(t){var e={};return a(t).compile().eval(e)},"string, Object":function(t,e){return a(t).compile().eval(e)},"Array | Matrix":function(t){var e={};return n(t,function(t){return a(t).compile().eval(e)})},"Array | Matrix, Object":function(t,e){return n(t,function(t){return a(t).compile().eval(e)})}})}var n=r(19);e.name="eval",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n,o){var a=i(r(103));return n("help",{any:function(e){var r,i=e;if("string"!=typeof e)for(r in o)if(o.hasOwnProperty(r)&&e===o[r]){i=r;break}var n=a[i];if(!n)throw new Error('No documentation found on "'+i+'"');return new t.Help(n)}})}e.math=!0,e.name="help",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(280));return n("parse",{"string | Array | Matrix":o,"string | Array | Matrix, Object":o})}e.name="parse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n,o){var a=i(r(306));return n("parser",{"":function(){return new a(o)}})}e.name="parser",e.factory=i,e.math=!0},function(t,e,r){"use strict";function i(t,e,i,o,a){function s(){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");this.scope={}}var l=i(r(280));return s.prototype.type="Parser",s.prototype.isParser=!0,s.prototype.parse=function(t){throw new Error("Parser.parse is deprecated. Use math.parse instead.")},s.prototype.compile=function(t){throw new Error("Parser.compile is deprecated. Use math.compile instead.")},s.prototype.eval=function(t){return l(t).compile().eval(this.scope)},s.prototype.get=function(t){return this.scope[t]},s.prototype.getAll=function(){return n({},this.scope)},s.prototype.set=function(t,e){return this.scope[t]=e},s.prototype.remove=function(t){delete this.scope[t]},s.prototype.clear=function(){for(var t in this.scope)this.scope.hasOwnProperty(t)&&delete this.scope[t]},s}var n=r(3).extend;e.name="Parser",e.path="expression",e.factory=i,e.math=!0},function(t,e,r){t.exports=[r(281),r(287),r(288),r(291),r(292),r(293),r(295),r(294),r(300),r(282),r(298),r(299),r(301),r(296),r(297),r(308)]},function(t,e){"use strict";function r(t,e,r,i){function n(){throw new Error("UpdateNode is deprecated. Use AssignmentNode instead.")}return n}e.name="UpdateNode",e.path="expression.node",e.factory=r},function(t,e,r){t.exports=[r(310),r(312),r(314),r(316),r(317),r(319),r(325),r(330),r(332),r(334)]},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(311));return o("concat",{"...any":function(t){var e=t.length-1,r=t[e];"number"==typeof r?t[e]=r-1:r&&r.isBigNumber===!0&&(t[e]=r.minus(1));try{return a.apply(null,t)}catch(i){throw n(i)}}})}var n=r(285).transform;e.name="concat",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,c){var h=i(r(52)),f=c("concat",{"...Array | Matrix | number | BigNumber":function(t){var e,r,i=t.length,c=-1,f=!1,d=[];for(e=0;i>e;e++){var p=t[e];if(p&&p.isMatrix===!0&&(f=!0),"number"==typeof p||p&&p.isBigNumber===!0){if(e!==i-1)throw new Error("Dimension must be specified as last argument");if(r=c,c=p.valueOf(),!a(c))throw new TypeError("Integer number expected for dimension");if(0>c||e>0&&c>r)throw new l(c,r+1)}else{var m=o(p).valueOf(),g=s.size(m);if(d[e]=m,r=c,c=g.length-1,e>0&&c!=r)throw new u(r+1,c+1)}}if(0==d.length)throw new SyntaxError("At least one matrix expected");for(var y=d.shift();d.length;)y=n(y,d.shift(),c,0);return f?h(y):y},"...string":function(t){return t.join("")}});return f.toTex=void 0,f}function n(t,e,r,i){if(r>i){if(t.length!=e.length)throw new u(t.length,e.length);for(var o=[],a=0;a<t.length;a++)o[a]=n(t[a],e[a],r,i+1);return o}return t.concat(e)}var o=r(3).clone,a=r(6).isInteger,s=r(40),l=r(43),u=r(42);e.name="concat",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e,r){var i,n;if(t[0]&&(i=t[0].compile().eval(r)),t[1])if(t[1]&&t[1].isSymbolNode)n=t[1].compile().eval(r);else{var o=r||{},s=t[1].filter(function(t){return t&&t.isSymbolNode&&!(t.name in e)&&!(t.name in o)})[0],l=Object.create(o),u=t[1].compile();if(!s)throw new Error("No undefined variable found in filter equation");var c=s.name;n=function(t){return l[c]=t,u.eval(l)}}return a(i,n)}var a=i(r(313));i(r(297));return o.rawArgs=!0,o}r(45).maxArgumentCount;e.name="filter",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=a("filter",{"Array, function":n,"Array, RegExp":o,"Matrix, function":function(t,e){return s(n(t.toArray(),e))},"Matrix, RegExp":function(t,e){return s(o(t.toArray(),e))}});return l.toTex=void 0,l}function n(t,e){if(1!==a(t).length)throw new Error("Only one dimensional matrices supported");var r=s(e);return t.filter(function(t,i,n){return 1===r?e(t):2===r?e(t,[i]):e(t,[i],n)})}function o(t,e){if(1!==a(t).length)throw new Error("Only one dimensional matrices supported");return t.filter(function(t){return e.test(t)})}var a=r(40).size,s=r(45).maxArgumentCount;e.name="filter",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){i(r(315));return o("forEach",{"Array | Matrix, function":function(t,e){var r=n(e),i=function(n,o){Array.isArray(n)?n.forEach(function(t,e){i(t,o.concat(e+1))}):1===r?e(n):2===r?e(n,o):e(n,o,t)};i(t.valueOf(),[])}})}var n=r(45).maxArgumentCount;e.name="forEach",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("forEach",{"Array, function":n,"Matrix, function":function(t,e){return t.forEach(e)}});return o.toTex=void 0,o}function n(t,e){var r=o(e),i=function(n,o){Array.isArray(n)?n.forEach(function(t,e){i(t,o.concat(e))}):1===r?e(n):2===r?e(n,o):e(n,o,t)};i(t,[])}var o=r(45).maxArgumentCount;e.name="forEach",e.factory=i},function(t,e){"use strict";function r(t,e,r){return function(){for(var e=[],r=0,i=arguments.length;i>r;r++){var n=arguments[r];if(n&&n.isRange===!0)n.start--,n.end-=n.step>0?0:2;else if(n&&n.isSet===!0)n=n.map(function(t){return t-1});else if(n&&(n.isArray===!0||n.isMatrix))n=n.map(function(t){return t-1});else if("number"==typeof n)n--;else if(n&&n.isBigNumber===!0)n=n.toNumber()-1;else if("string"!=typeof n)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");e[r]=n}var o=new t.Index;return t.Index.apply(o,e),o}}e.name="index",e.path="expression.transform",e.factory=r},function(t,e,r){"use strict";function i(t,e,i,o){var a=(i(r(318)),i(r(52)));return o("max",{"Array, function":function(t,e){return n(t,e,t)},"Matrix, function":function(t,e){return a(n(t.valueOf(),e,t))}})}function n(t,e,r){function i(t,o){return Array.isArray(t)?t.map(function(t,e){return i(t,o.concat(e+1))}):1===n?e(t):2===n?e(t,o):e(t,o,r)}var n=o(e);return i(t,[])}var o=r(45).maxArgumentCount;e.name="map",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("map",{"Array, function":n,"Matrix, function":function(t,e){return t.map(e)}});return o.toTex=void 0,o}function n(t,e){var r=o(e),i=function(n,o){return Array.isArray(n)?n.map(function(t,e){return i(t,o.concat(e))}):1===r?e(n):2===r?e(n,o):e(n,o,t)};return i(t,[])}var o=r(45).maxArgumentCount;e.name="map",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(321));return a("max",{"...any":function(t){if(2==t.length&&o(t[0])){var e=t[1];"number"==typeof e?t[1]=e-1:e&&e.isBigNumber===!0&&(t[1]=e.minus(1))}try{return s.apply(null,t)}catch(r){throw n(r)}}})}var n=r(285).transform,o=r(320);e.name="max",e.path="expression.transform",e.factory=i},function(t,e){"use strict";t.exports=function(t){return Array.isArray(t)||t&&t.isMatrix===!0}},function(t,e,r){"use strict";function i(t,e,i,s){function l(t,e){return c(t,e)?t:e}function u(t){var e=void 0;if(n(t,function(t){(void 0===e||c(t,e))&&(e=t)}),void 0===e)throw new Error("Cannot calculate max of an empty array");return e}var c=i(r(64)),h=s("max",{"Array | Matrix":u,"Array | Matrix, number | BigNumber":function(t,e){return o(t,e.valueOf(),l)},"...":function(t){if(a(t))throw new TypeError("Scalar values expected in function max");return u(t)}});return h.toTex="\\max\\left(${args}\\right)",h}var n=r(322),o=r(323),a=r(324);e.name="max",e.factory=i},function(t,e){"use strict";t.exports=function r(t,e){t&&t.isMatrix===!0&&(t=t.valueOf());for(var i=0,n=t.length;n>i;i++){var o=t[i];Array.isArray(o)?r(o,e):e(o)}}},function(t,e,r){"use strict";function i(t,e,r){var o,a,s,l;if(0>=e){if(Array.isArray(t[0])){for(l=n(t),a=[],o=0;o<l.length;o++)a[o]=i(l[o],e-1,r);return a}for(s=t[0],o=1;o<t.length;o++)s=r(s,t[o]);return s}for(a=[],o=0;o<t.length;o++)a[o]=i(t[o],e-1,r);return a}function n(t){var e,r,i=t.length,n=t[0].length,o=[];for(r=0;n>r;r++){var a=[];for(e=0;i>e;e++)a.push(t[e][r]);o.push(a)}return o}var o=r(40).size,a=r(43);t.exports=function(t,e,r){var n=Array.isArray(t)?o(t):t.size();if(0>e||e>=n.length)throw new a(e,n.length);return t&&t.isMatrix===!0?t.create(i(t.valueOf(),e,r)):i(t,e,r)}},function(t,e,r){"use strict";var i=r(320);t.exports=function(t){for(var e=0;e<t.length;e++)if(i(t[e]))return!0;return!1}},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(326));return a("mean",{"...any":function(t){if(2==t.length&&o(t[0])){var e=t[1];"number"==typeof e?t[1]=e-1:e&&e.isBigNumber===!0&&(t[1]=e.minus(1))}try{return s.apply(null,t)}catch(r){throw n(r)}}})}var n=r(285).transform,o=r(320);e.name="mean",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,l){function u(t,e){var r=a(t,e,h),i=Array.isArray(t)?n(t):t.size();return f(r,i[e])}function c(t){var e=0,r=0;if(o(t,function(t){e=h(e,t),r++}),0===r)throw new Error("Cannot calculate mean of an empty array");return f(e,r)}var h=i(r(51)),f=i(r(327)),d=l("mean",{"Array | Matrix":c,"Array | Matrix, number | BigNumber":u,"...":function(t){if(s(t))throw new TypeError("Scalar values expected in function mean");return c(t)}});return d.toTex=void 0,d}var n=r(40).size,o=r(322),a=r(323),s=r(324);e.name="mean",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(81)),s=i(r(84)),l=i(r(328)),u=i(r(52)),c=i(r(85)),h=i(r(58)),f=o("divide",n({"Array | Matrix, Array | Matrix":function(t,e){return s(t,l(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,a,!1);break;case"dense":r=h(t,e,a,!1)}return r},"Array, any":function(t,e){return h(u(t),e,a,!1).valueOf()},"any, Array | Matrix":function(t,e){return s(t,l(e))}},a.signatures));return f.toTex={2:"\\frac{${args[0]}}{${args[1]}}"},f}var n=r(3).extend;e.name="divide",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e,r){var i,n,o,a,s;if(1==e){if(a=t[0][0],0==a)throw Error("Cannot calculate inverse, determinant is zero");return[[l(1,a)]]}if(2==e){var p=f(t);if(0==p)throw Error("Cannot calculate inverse, determinant is zero");return[[l(t[1][1],p),l(h(t[0][1]),p)],[l(h(t[1][0]),p),l(t[0][0],p)]]}var m=t.concat();for(i=0;e>i;i++)m[i]=m[i].concat();for(var g=d(e).valueOf(),y=0;r>y;y++){for(i=y;e>i&&0==m[i][y];)i++;if(i==e||0==m[i][y])throw Error("Cannot calculate inverse, determinant is zero");i!=y&&(s=m[y],m[y]=m[i],m[i]=s,s=g[y],g[y]=g[i],g[i]=s);var v=m[y],E=g[y];for(i=0;e>i;i++){var w=m[i],b=g[i];if(i!=y){if(0!=w[y]){for(o=l(h(w[y]),v[y]),n=y;r>n;n++)w[n]=u(w[n],c(o,v[n]));for(n=0;r>n;n++)b[n]=u(b[n],c(o,E[n]))}}else{for(o=v[y],n=y;r>n;n++)w[n]=l(w[n],o);for(n=0;r>n;n++)b[n]=l(b[n],o)}}}return g}var s=i(r(52)),l=i(r(81)),u=i(r(53)),c=i(r(84)),h=i(r(78)),f=i(r(329)),d=i(r(83)),p=o("inv",{"Array | Matrix":function(t){var e=t.isMatrix===!0?t.size():n.array.size(t);switch(e.length){case 1:if(1==e[0])return t.isMatrix===!0?s([l(1,t.valueOf()[0])]):[l(1,t[0])];throw new RangeError("Matrix must be square (size: "+n.string.format(e)+")");case 2:var r=e[0],i=e[1];if(r==i)return t.isMatrix===!0?s(a(t.valueOf(),r,i),t.storage()):a(t,r,i);throw new RangeError("Matrix must be square (size: "+n.string.format(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+n.string.format(e)+")")}},any:function(t){return l(1,t)}});return p.toTex={1:"\\left(${args[0]}\\right)^{-1}"},p}var n=r(39);e.name="inv",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function s(t,e,r){if(1==e)return o.clone(t[0][0]);if(2==e)return c(h(t[0][0],t[1][1]),h(t[1][0],t[0][1]));for(var i=function(t){var e,r,i=new Array(t.length),n=0;for(e=1;e<t.length;e++)n=u(n,t[e][e]);for(e=0;e<t.length;e++){for(i[e]=new Array(t.length),i[e][e]=f(n),r=0;e>r;r++)i[e][r]=0;for(r=e+1;r<t.length;r++)i[e][r]=t[e][r];e+1<t.length&&(n=c(n,t[e+1][e+1]))}return i},n=t,a=0;e-1>a;a++)n=h(i(n),t);return e%2==0?f(n[0][0]):n[0][0]}var l=i(r(52)),u=i(r(51)),c=i(r(77)),h=i(r(84)),f=i(r(78)),d=n("det",{any:function(t){return o.clone(t)},"Array | Matrix":function(t){var e;switch(t&&t.isMatrix===!0?e=t.size():Array.isArray(t)?(t=l(t),e=t.size()):e=[],e.length){case 0:return o.clone(t);case 1:if(1==e[0])return o.clone(t.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+a.format(e)+")");case 2:var r=e[0],i=e[1];if(r==i)return s(t.clone().valueOf(),r,i);throw new RangeError("Matrix must be square (size: "+a.format(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+a.format(e)+")")}}});return d.toTex={1:"\\det\\left(${args[0]}\\right)"},d}var n=r(39),o=n.object,a=n.string;e.name="det",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(331));return a("min",{"...any":function(t){if(2==t.length&&o(t[0])){var e=t[1];"number"==typeof e?t[1]=e-1:e&&e.isBigNumber===!0&&(t[1]=e.minus(1))}try{return s.apply(null,t)}catch(r){throw n(r)}}})}var n=r(285).transform,o=r(320);e.name="min",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,s){function l(t,e){return c(t,e)?t:e}function u(t){var e=void 0;if(n(t,function(t){(void 0===e||c(t,e))&&(e=t)}),void 0===e)throw new Error("Cannot calculate min of an empty array");return e}var c=i(r(60)),h=s("min",{"Array | Matrix":u,"Array | Matrix, number | BigNumber":function(t,e){return o(t,e.valueOf(),l)},"...":function(t){if(a(t))throw new TypeError("Scalar values expected in function min");return u(t)}});return h.toTex="\\min\\left(${args}\\right)",h}var n=r(322),o=r(323),a=r(324);e.name="min",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(333));return n("range",{"...any":function(t){var e=t.length-1,r=t[e];return"boolean"!=typeof r&&t.push(!0),o.apply(null,t)}})}e.name="range",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){return"Array"===e.matrix?t:f(t)}function a(r,i){var n=h(r);if(!n)throw new SyntaxError('String "'+r+'" is no valid range');var a;return"BigNumber"===e.number?(a=i?c:u,o(a(new t.BigNumber(n.start),new t.BigNumber(n.end),new t.BigNumber(n.step)))):(a=i?l:s,o(a(n.start,n.end,n.step)))}function s(t,e,r){var i=[],n=t;if(r>0)for(;e>n;)i.push(n),n+=r;else if(0>r)for(;n>e;)i.push(n),n+=r;return i}function l(t,e,r){var i=[],n=t;if(r>0)for(;e>=n;)i.push(n),n+=r;else if(0>r)for(;n>=e;)i.push(n),n+=r;return i}function u(t,e,r){var i=[],n=t;if(r.gt(d))for(;n.lt(e);)i.push(n),n=n.plus(r);else if(r.lt(d))for(;n.gt(e);)i.push(n),n=n.plus(r);return i}function c(t,e,r){var i=[],n=t;if(r.gt(d))for(;n.lte(e);)i.push(n),n=n.plus(r);else if(r.lt(d))for(;n.gte(e);)i.push(n),n=n.plus(r);return i}function h(t){var e=t.split(":"),r=e.map(function(t){return Number(t)}),i=r.some(function(t){return isNaN(t)});if(i)return null;switch(r.length){case 2:return{start:r[0],end:r[1],step:1};case 3:return{start:r[0],end:r[2],step:r[1]};default:return null}}var f=i(r(52)),d=new t.BigNumber(0),p=new t.BigNumber(1),m=n("range",{string:a,"string, boolean":a,"number, number":function(t,e){
return o(s(t,e,1))},"number, number, number":function(t,e,r){return o(s(t,e,r))},"number, number, boolean":function(t,e,r){return o(r?l(t,e,1):s(t,e,1))},"number, number, number, boolean":function(t,e,r,i){return o(i?l(t,e,r):s(t,e,r))},"BigNumber, BigNumber":function(t,e){return o(u(t,e,p))},"BigNumber, BigNumber, BigNumber":function(t,e,r){return o(u(t,e,r))},"BigNumber, BigNumber, boolean":function(t,e,r){return o(r?c(t,e,p):u(t,e,p))},"BigNumber, BigNumber, BigNumber, boolean":function(t,e,r,i){return o(i?c(t,e,r):u(t,e,r))}});return m.toTex=void 0,m}e.name="range",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(286));return o("subset",{"...any":function(t){try{return a.apply(null,t)}catch(e){throw n(e)}}})}var n=r(285).transform;e.name="subset",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(!t)throw new Error('Argument "doc" missing');this.doc=t}var l=i(r(305))();return s.prototype.type="Help",s.prototype.isHelp=!0,s.prototype.toString=function(){var t=this.doc||{},e="\n";if(t.name&&(e+="Name: "+t.name+"\n\n"),t.category&&(e+="Category: "+t.category+"\n\n"),t.description&&(e+="Description:\n    "+t.description+"\n\n"),t.syntax&&(e+="Syntax:\n    "+t.syntax.join("\n    ")+"\n\n"),t.examples){e+="Examples:\n";for(var r=0;r<t.examples.length;r++){var i=t.examples[r];e+="    "+i+"\n";var n;try{n=l.eval(i)}catch(a){n=a}n&&!n.isHelp&&(e+="        "+o.format(n,{precision:14})+"\n")}e+="\n"}return t.seealso&&(e+="See also: "+t.seealso.join(", ")+"\n"),e},s.prototype.toJSON=function(){var t=n.clone(this.doc);return t.mathjs="Help",t},s.fromJSON=function(t){var e={};for(var r in t)"mathjs"!==r&&(e[r]=t[r]);return new s(e)},s.prototype.valueOf=s.prototype.toString,s}var n=r(3),o=r(23);e.name="Help",e.path="type",e.factory=i},function(t,e,r){t.exports=[r(337),r(364),r(395),r(411),r(420),r(425),r(428),r(434),r(446),r(455),r(459),r(461),r(468),r(470),r(496),r(498)]},function(t,e,r){t.exports=[r(338),r(339),r(359),r(361),r(363)]},function(t,e,r){"use strict";function i(t,e,i,n){var a=i(r(52)),s=i(r(86)),l=i(r(53)),u=i(r(81)),c=i(r(80)),h=i(r(77)),f=i(r(64)),d=i(r(48)),p=i(r(78)),m=t.SparseMatrix,g=t.DenseMatrix,y=t.Spa,v=n("lup",{DenseMatrix:function(t){return E(t)},SparseMatrix:function(t){return w(t)},Array:function(t){var e=a(t),r=E(e);return{L:r.L.valueOf(),U:r.U.valueOf(),p:r.p}}}),E=function(t){var e,r,i,n=t._size[0],a=t._size[1],p=Math.min(n,a),m=o.clone(t._data),y=[],v=[n,p],E=[],w=[p,a],b=[];for(e=0;n>e;e++)b[e]=e;for(r=0;a>r;r++){if(r>0)for(e=0;n>e;e++){var x=Math.min(e,r),_=0;for(i=0;x>i;i++)_=l(_,c(m[e][i],m[i][r]));m[e][r]=h(m[e][r],_)}var S=r,T=0,L=0;for(e=r;n>e;e++){var M=m[e][r],A=s(M);f(A,T)&&(S=e,T=A,L=M)}if(r!==S&&(b[r]=[b[S],b[S]=b[r]][0],g._swapRows(r,S,m)),n>r)for(e=r+1;n>e;e++){var N=m[e][r];d(N,0)||(m[e][r]=u(m[e][r],L))}}for(r=0;a>r;r++)for(e=0;n>e;e++)0===r&&(a>e&&(E[e]=[]),y[e]=[]),r>e?(a>e&&(E[e][r]=m[e][r]),n>r&&(y[e][r]=0)):e!==r?(a>e&&(E[e][r]=0),n>r&&(y[e][r]=m[e][r])):(a>e&&(E[e][r]=m[e][r]),n>r&&(y[e][r]=1));var R=new g({data:y,size:v}),C=new g({data:E,size:w}),P=[];for(e=0,p=b.length;p>e;e++)P[b[e]]=e;return{L:R,U:C,p:P,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}},w=function(t){var e,r,i,n=t._size[0],o=t._size[1],a=Math.min(n,o),l=t._values,h=t._index,g=t._ptr,v=[],E=[],w=[],b=[n,a],x=[],_=[],S=[],T=[a,o],L=[],M=[];for(e=0;n>e;e++)L[e]=e,M[e]=e;var A=function(t,e){var r=M[t],i=M[e];L[r]=e,L[i]=t,M[t]=i,M[e]=r};for(r=0;o>r;r++){var N=new y;n>r&&(w.push(v.length),v.push(1),E.push(r)),S.push(x.length);var R=g[r],C=g[r+1];for(i=R;C>i;i++)e=h[i],N.set(L[e],l[i]);r>0&&N.forEach(0,r-1,function(t,e){m._forEachRow(t,v,E,w,function(r,i){r>t&&N.accumulate(r,p(c(i,e)))})});var P=r,O=N.get(r),I=s(O);N.forEach(r+1,n-1,function(t,e){var r=s(e);f(r,I)&&(P=t,I=r,O=e)}),r!==P&&(m._swapRows(r,P,b[1],v,E,w),m._swapRows(r,P,T[1],x,_,S),N.swap(r,P),A(r,P)),N.forEach(0,n-1,function(t,e){r>=t?(x.push(e),_.push(t)):(e=u(e,O),d(e,0)||(v.push(e),E.push(t)))})}return S.push(x.length),w.push(v.length),{L:new m({values:v,index:E,ptr:w,size:b}),U:new m({values:x,index:_,ptr:S,size:T}),p:L,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}};return v}var n=r(39),o=n.object;e.name="lup",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(340)),s=i(r(351)),l=n("slu",{"SparseMatrix, number, number":function(t,e,r){if(!a(e)||0>e||e>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(0>r||r>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var i=o(e,t,!1),n=s(t,i,r);return{L:n.L,U:n.U,p:n.pinv,q:i.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}});return l}var n=r(39),o=n.number,a=o.isInteger;e.name="slu",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(341)),o=i(r(346)),a=i(r(347)),s=i(r(348)),l=i(r(349)),u=function(t,e,r){var i,u=e._ptr,h=e._size,f=h[1],d={};if(d.q=n(t,e),t&&!d.q)return null;if(r){var p=t?o(e,null,d.q,0):e;d.parent=a(p,1);var m=s(d.parent,f);if(d.cp=l(p,d.parent,m,1),p&&d.parent&&d.cp&&c(p,d))for(d.unz=0,i=0;f>i;i++)d.unz+=d.cp[i]}else d.unz=4*u[f]+f,d.lnz=d.unz;return d},c=function(t,e){var r=t._ptr,i=t._index,n=t._size,o=n[0],a=n[1];e.pinv=[],e.leftmost=[];var s,l,u,c,h,f=e.parent,d=e.pinv,p=e.leftmost,m=[],g=0,y=o,v=o+a,E=o+2*a;for(l=0;a>l;l++)m[y+l]=-1,m[v+l]=-1,m[E+l]=0;for(s=0;o>s;s++)p[s]=-1;for(l=a-1;l>=0;l--)for(c=r[l],h=r[l+1],u=c;h>u;u++)p[i[u]]=l;for(s=o-1;s>=0;s--)d[s]=-1,l=p[s],-1!=l&&(0===m[E+l]++&&(m[v+l]=s),m[g+s]=m[y+l],m[y+l]=s);for(e.lnz=0,e.m2=o,l=0;a>l;l++)if(s=m[y+l],e.lnz++,0>s&&(s=e.m2++),d[s]=l,!(--E[l]<=0)){e.lnz+=m[E+l];var w=f[l];-1!=w&&(0===m[E+w]&&(m[v+w]=m[v+l]),m[g+m[v+l]]=m[y+w],m[y+w]=m[g+s],m[E+w]+=m[E+l])}for(s=0;o>s;s++)d[s]<0&&(d[s]=l++);return!0};return u}e.name="cs_sqr",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(342)),o=i(r(343)),a=i(r(344)),s=i(r(51)),l=i(r(84)),u=i(r(345)),c=function(t,e){if(!e||0>=t||t>3)return null;var r=e._size,i=r[0],s=r[1],l=0,u=Math.max(16,10*Math.sqrt(s));u=Math.min(s-2,u);var c=h(t,e,i,s,u);o(c,m,null);for(var g,y,v,E,w,b,x,_,S,T,L,M,A,N,R,C,P=c._index,O=c._ptr,I=O[s],k=[],D=[],V=0,F=s+1,G=2*(s+1),B=3*(s+1),W=4*(s+1),U=5*(s+1),j=6*(s+1),z=7*(s+1),K=k,q=f(s,O,D,V,B,K,G,z,F,j,W,U),H=d(s,O,D,U,W,j,u,F,B,K,G),Y=0;s>H;){for(v=-1;s>Y&&-1==(v=D[B+Y]);Y++);-1!=D[G+v]&&(K[D[G+v]]=-1),D[B+Y]=D[G+v];var $=D[W+v],X=D[F+v];H+=X;var J=0;D[F+v]=-X;var Z=O[v],Q=0===$?Z:I,tt=Q;for(E=1;$+1>=E;E++){for(E>$?(b=v,x=Z,_=D[V+v]-$):(b=P[Z++],x=O[b],_=D[V+b]),w=1;_>=w;w++)g=P[x++],(S=D[F+g])<=0||(J+=S,D[F+g]=-S,P[tt++]=g,-1!=D[G+g]&&(K[D[G+g]]=K[g]),-1!=K[g]?D[G+K[g]]=D[G+g]:D[B+D[U+g]]=D[G+g]);b!=v&&(O[b]=n(v),D[j+b]=0)}for(0!==$&&(I=tt),D[U+v]=J,O[v]=Q,D[V+v]=tt-Q,D[W+v]=-2,q=p(q,l,D,j,s),T=Q;tt>T;T++)if(g=P[T],!((L=D[W+g])<=0)){S=-D[F+g];var et=q-S;for(Z=O[g],M=O[g]+L-1;M>=Z;Z++)b=P[Z],D[j+b]>=q?D[j+b]-=S:0!==D[j+b]&&(D[j+b]=D[U+b]+et)}for(T=Q;tt>T;T++){for(g=P[T],M=O[g],A=M+D[W+g]-1,N=M,R=0,C=0,Z=M;A>=Z;Z++)if(b=P[Z],0!==D[j+b]){var rt=D[j+b]-q;rt>0?(C+=rt,P[N++]=b,R+=b):(O[b]=n(v),D[j+b]=0)}D[W+g]=N-M+1;var it=N,nt=M+D[V+g];for(Z=A+1;nt>Z;Z++){y=P[Z];var ot=D[F+y];0>=ot||(C+=ot,P[N++]=y,R+=y)}0===C?(O[g]=n(v),S=-D[F+g],J-=S,X+=S,H+=S,D[F+g]=0,D[W+g]=-1):(D[U+g]=Math.min(D[U+g],C),P[N]=P[it],P[it]=P[M],P[M]=v,D[V+g]=N-M+1,R=(0>R?-R:R)%s,D[G+g]=D[z+R],D[z+R]=g,K[g]=R)}for(D[U+v]=J,l=Math.max(l,J),q=p(q+l,l,D,j,s),T=Q;tt>T;T++)if(g=P[T],!(D[F+g]>=0))for(R=K[g],g=D[z+R],D[z+R]=-1;-1!=g&&-1!=D[G+g];g=D[G+g],q++){for(_=D[V+g],L=D[W+g],Z=O[g]+1;Z<=O[g]+_-1;Z++)D[j+P[Z]]=q;var at=g;for(y=D[G+g];-1!=y;){var st=D[V+y]===_&&D[W+y]===L;for(Z=O[y]+1;st&&Z<=O[y]+_-1;Z++)D[j+P[Z]]!=q&&(st=0);st?(O[y]=n(g),D[F+g]+=D[F+y],D[F+y]=0,D[W+y]=-1,y=D[G+y],D[G+at]=y):(at=y,y=D[G+y])}}for(Z=Q,T=Q;tt>T;T++)g=P[T],(S=-D[F+g])<=0||(D[F+g]=S,C=D[U+g]+J-S,C=Math.min(C,s-H-S),-1!=D[B+C]&&(K[D[B+C]]=g),D[G+g]=D[B+C],K[g]=-1,D[B+C]=g,Y=Math.min(Y,C),D[U+g]=C,P[Z++]=g);D[F+v]=X,0===(D[V+v]=Z-Q)&&(O[v]=-1,D[j+v]=0),0!==$&&(I=Z)}for(g=0;s>g;g++)O[g]=n(O[g]);for(y=0;s>=y;y++)D[B+y]=-1;for(y=s;y>=0;y--)D[F+y]>0||(D[G+y]=D[B+O[y]],D[B+O[y]]=y);for(b=s;b>=0;b--)D[F+b]<=0||-1!=O[b]&&(D[G+b]=D[B+O[b]],D[B+O[b]]=b);for(v=0,g=0;s>=g;g++)-1==O[g]&&(v=a(g,v,D,B,G,k,j));return k.splice(k.length-1,1),k},h=function(t,e,r,i,n){var o=u(e);if(1===t&&i===r)return s(e,o);if(2==t){for(var a=o._index,c=o._ptr,h=0,f=0;r>f;f++){var d=c[f];if(c[f]=h,!(c[f+1]-d>n))for(var p=c[f+1];p>d;d++)a[h++]=a[d]}return c[r]=h,e=u(o),l(o,e)}return l(o,e)},f=function(t,e,r,i,n,o,a,s,l,u,c,h){for(var f=0;t>f;f++)r[i+f]=e[f+1]-e[f];r[i+t]=0;for(var d=0;t>=d;d++)r[n+d]=-1,o[d]=-1,r[a+d]=-1,r[s+d]=-1,r[l+d]=1,r[u+d]=1,r[c+d]=0,r[h+d]=r[i+d];var m=p(0,0,r,u,t);return r[c+t]=-2,e[t]=-1,r[u+t]=0,m},d=function(t,e,r,i,o,a,s,l,u,c,h){for(var f=0,d=0;t>d;d++){var p=r[i+d];if(0===p)r[o+d]=-2,f++,e[d]=-1,r[a+d]=0;else if(p>s)r[l+d]=0,r[o+d]=-1,f++,e[d]=n(t),r[l+t]++;else{var m=r[u+p];-1!=m&&(c[m]=d),r[h+d]=r[u+p],r[u+p]=d}}return f},p=function(t,e,r,i,n){if(2>t||0>t+e){for(var o=0;n>o;o++)0!==r[i+o]&&(r[i+o]=1);t=2}return t},m=function(t,e){return t!=e};return c}e.name="cs_amd",e.path="sparse",e.factory=i},function(t,e){"use strict";function r(){var t=function(t){return-t-2};return t}e.name="cs_flip",e.path="sparse",e.factory=r},function(t,e){"use strict";function r(){var t=function(t,e,r){for(var i=t._values,n=t._index,o=t._ptr,a=t._size,s=a[1],l=0,u=0;s>u;u++){var c=o[u];for(o[u]=l;c<o[u+1];c++)e(n[c],u,i?i[c]:1,r)&&(n[l]=n[c],i&&(i[l]=i[c]),l++)}return o[s]=l,n.splice(l,n.length-l),i&&i.splice(l,i.length-l),l};return t}e.name="cs_fkeep",e.path="sparse",e.factory=r},function(t,e){"use strict";function r(){var t=function(t,e,r,i,n,o,a){var s=0;for(r[a]=t;s>=0;){var l=r[a+s],u=r[i+l];-1==u?(s--,o[e++]=l):(r[i+l]=r[n+u],++s,r[a+s]=u)}return e};return t}e.name="cs_tdfs",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=t.DenseMatrix,c=t.SparseMatrix,h=a("transpose",{Array:function(t){return h(l(t)).valueOf()},Matrix:function(t){var e,r=t.size();switch(r.length){case 1:e=t.clone();break;case 2:var i=r[0],n=r[1];if(0===n)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+o(r)+")");switch(t.storage()){case"dense":e=f(t,i,n);break;case"sparse":e=d(t,i,n)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+o(this._size)+")")}return e},any:function(t){return n(t)}}),f=function(t,e,r){for(var i,o=t._data,a=[],s=0;r>s;s++){i=a[s]=[];for(var l=0;e>l;l++)i[l]=n(o[l][s])}return new u({data:a,size:[r,e],datatype:t._datatype})},d=function(t,e,r){for(var i=t._values,o=t._index,a=t._ptr,s=i?[]:void 0,l=[],u=[],h=[],f=0;e>f;f++)h[f]=0;var d,p,m;for(d=0,p=o.length;p>d;d++)h[o[d]]++;for(var g=0,y=0;e>y;y++)u.push(g),g+=h[y],h[y]=u[y];for(u.push(g),m=0;r>m;m++)for(var v=a[m],E=a[m+1],w=v;E>w;w++){var b=h[o[w]]++;l[b]=m,i&&(s[b]=n(i[w]))}return new c({values:s,index:l,ptr:u,size:[r,e],datatype:t._datatype})};return h.toTex={1:"\\left(${args[0]}\\right)"+s.operators.transpose},h}var n=r(3).clone,o=r(23).format;e.name="transpose",e.factory=i},function(t,e){"use strict";function r(t){var e=t.SparseMatrix,r=function(t,r,i,n){for(var o=t._values,a=t._index,s=t._ptr,l=t._size,u=t._datatype,c=l[0],h=l[1],f=n&&t._values?[]:null,d=[],p=[],m=0,g=0;h>g;g++){p[g]=m;for(var y=i?i[g]:g,v=s[y],E=s[y+1],w=v;E>w;w++){var b=r?r[a[w]]:a[w];d[m]=b,f&&(f[m]=o[w]),m++}}return p[h]=m,new e({values:f,index:d,ptr:p,size:[c,h],datatype:u})};return r}e.name="cs_permute",e.path="sparse",e.factory=r},function(t,e){"use strict";function r(){var t=function(t,e){if(!t)return null;var r,i,n=t._index,o=t._ptr,a=t._size,s=a[0],l=a[1],u=[],c=[],h=0,f=l;if(e)for(r=0;s>r;r++)c[f+r]=-1;for(var d=0;l>d;d++){u[d]=-1,c[h+d]=-1;for(var p=o[d],m=o[d+1],g=p;m>g;g++){var y=n[g];for(r=e?c[f+y]:y;-1!=r&&d>r;r=i)i=c[h+r],c[h+r]=d,-1==i&&(u[r]=d);e&&(c[f+y]=d)}}return u};return t}e.name="cs_etree",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(344)),o=function(t,e){if(!t)return null;var r,i=0,o=[],a=[],s=0,l=e,u=2*e;for(r=0;e>r;r++)a[s+r]=-1;for(r=e-1;r>=0;r--)-1!=t[r]&&(a[l+r]=a[s+t[r]],a[s+t[r]]=r);for(r=0;e>r;r++)-1==t[r]&&(i=n(r,i,a,s,l,o,u));return o};return o}e.name="cs_post",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(345)),o=i(r(350)),a=function(t,e,r,i){if(!t||!e||!r)return null;var a,s,l,u,c,h,f,d=t._size,p=d[0],m=d[1],g=4*m+(i?m+p+1:0),y=[],v=0,E=m,w=2*m,b=3*m,x=4*m,_=5*m+1;for(l=0;g>l;l++)y[l]=-1;var S=[],T=n(t),L=T._index,M=T._ptr;for(l=0;m>l;l++)for(s=r[l],S[s]=-1==y[b+s]?1:0;-1!=s&&-1==y[b+s];s=e[s])y[b+s]=l;if(i){for(l=0;m>l;l++)y[r[l]]=l;for(a=0;p>a;a++){for(l=m,h=M[a],f=M[a+1],c=h;f>c;c++)l=Math.min(l,y[L[c]]);y[_+a]=y[x+l],y[x+l]=a}}for(a=0;m>a;a++)y[v+a]=a;for(l=0;m>l;l++){for(s=r[l],-1!=e[s]&&S[e[s]]--,u=i?y[x+l]:s;-1!=u;u=i?y[_+u]:-1)for(c=M[u];c<M[u+1];c++){a=L[c];var A=o(a,s,y,b,E,w,v);A.jleaf>=1&&S[s]++,2==A.jleaf&&S[A.q]--}-1!=e[s]&&(y[v+s]=e[s])}for(s=0;m>s;s++)-1!=e[s]&&(S[e[s]]+=S[s]);return S};return a}e.name="cs_counts",e.path="sparse",e.factory=i},function(t,e){"use strict";function r(){var t=function(t,e,r,i,n,o,a){var s,l,u,c,h=0;if(e>=t||r[i+e]<=r[n+t])return-1;if(r[n+t]=r[i+e],u=r[o+t],r[o+t]=e,-1===u)h=1,c=t;else{for(h=2,c=u;c!=r[a+c];c=r[a+c]);for(s=u;s!=c;s=l)l=r[a+s],r[a+s]=c}return{jleaf:h,q:c}};return t}e.name="cs_leaf",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(86)),o=i(r(81)),a=i(r(84)),s=i(r(64)),l=i(r(352)),u=i(r(353)),c=t.SparseMatrix,h=function(t,e,r){if(!t)return null;var i,h=t._size,f=h[1],d=100,p=100;e&&(i=e.q,d=e.lnz||d,p=e.unz||p);var m,g,y=[],v=[],E=[],w=new c({values:y,index:v,ptr:E,size:[f,f]}),b=[],x=[],_=[],S=new c({values:b,index:x,ptr:_,size:[f,f]}),T=[],L=[],M=[];for(m=0;f>m;m++)L[m]=0,T[m]=-1,E[m+1]=0;d=0,p=0;for(var A=0;f>A;A++){E[A]=d,_[A]=p;var N=i?i[A]:A,R=u(w,t,N,M,L,T,1),C=-1,P=-1;for(g=R;f>g;g++)if(m=M[g],T[m]<0){var O=n(L[m]);s(O,P)&&(P=O,C=m)}else x[p]=T[m],b[p++]=L[m];if(-1==C||0>=P)return null;T[N]<0&&l(n(L[N]),a(P,r))&&(C=N);var I=L[C];for(x[p]=A,b[p++]=I,T[C]=A,v[d]=C,y[d++]=1,g=R;f>g;g++)m=M[g],T[m]<0&&(v[d]=m,y[d++]=o(L[m],I)),L[m]=0}for(E[f]=d,_[f]=p,g=0;d>g;g++)v[g]=T[v[g]];return y.splice(d,y.length-d),v.splice(d,v.length-d),b.splice(p,b.length-p),x.splice(p,x.length-p),{L:w,U:S,pinv:T}};return h}e.name="cs_lu",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("largerEq",{"boolean, boolean":function(t,e){return t>=e},"number, number":function(t,r){return t>=r||n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.gte(r)||o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return-1!==t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return t>=e},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,p);break;default:r=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,p,!1);break;default:r=h(t,e,p)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=f(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,p,!0);break;default:r=f(e,t,p,!0)}return r},"Array, any":function(t,e){return f(s(t),e,p,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+d.operators.largerEq+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="largerEq",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(81)),o=i(r(84)),a=i(r(77)),s=i(r(354)),l=function(t,e,r,i,l,u,c){var h,f,d,p,m=t._values,g=t._index,y=t._ptr,v=t._size,E=v[1],w=e._values,b=e._index,x=e._ptr,_=s(t,e,r,i,u);for(h=_;E>h;h++)l[i[h]]=0;for(f=x[r],d=x[r+1],h=f;d>h;h++)l[b[h]]=w[h];for(var S=_;E>S;S++){var T=i[S],L=u?u[T]:T;if(!(0>L))for(f=y[L],d=y[L+1],l[T]=n(l[T],m[c?f:d-1]),h=c?f+1:f,p=c?d:d-1;p>h;h++){var M=g[h];l[M]=a(l[M],o(m[h],l[T]))}}return _};return l}e.name="cs_spsolve",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(355)),o=i(r(356)),a=i(r(357)),s=function(t,e,r,i,s){var l,u,c,h=t._ptr,f=t._size,d=e._index,p=e._ptr,m=f[1],g=m;for(u=p[r],c=p[r+1],l=u;c>l;l++){var y=d[l];o(h,y)||(g=n(y,t,g,i,s))}for(l=g;m>l;l++)a(h,i[l]);return g};return s}e.name="cs_reach",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(356)),o=i(r(357)),a=i(r(358)),s=function(t,e,r,i,s){var l,u,c,h=e._index,f=e._ptr,d=e._size,p=d[1],m=0;for(i[0]=t;m>=0;){t=i[m];var g=s?s[t]:t;n(f,t)||(o(f,t),i[p+m]=0>g?0:a(f[g]));var y=1;for(u=i[p+m],c=0>g?0:a(f[g+1]);c>u;u++)if(l=h[u],!n(f,l)){i[p+m]=u,i[++m]=l,y=0;break}y&&(m--,i[--r]=t)}return r};return s}e.name="cs_dfs",e.path="sparse",e.factory=i},function(t,e){"use strict";function r(){var t=function(t,e){return t[e]<0};return t}e.name="cs_marked",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(342)),o=function(t,e){t[e]=n(t[e])};return o}e.name="cs_mark",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(342)),o=function(t){return 0>t?n(t):t};return o}e.name="cs_unflip",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(81)),s=i(r(80)),l=i(r(77)),u=i(r(48)),c=i(r(360)),h=t.DenseMatrix,f=n("lsolve",{"SparseMatrix, Array | Matrix":function(t,e){return p(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return d(t,e)},"Array, Array | Matrix":function(t,e){var r=o(t),i=d(r,e);return i.valueOf()}}),d=function(t,e){e=c(t,e,!0);for(var r=e._data,i=t._size[0],n=t._size[1],o=[],f=t._data,d=0;n>d;d++){var p,m=r[d][0]||0;if(u(m,0))p=0;else{var g=f[d][d];if(u(g,0))throw new Error("Linear system cannot be solved since matrix is singular");p=a(m,g);for(var y=d+1;i>y;y++)r[y]=[l(r[y][0]||0,s(p,f[y][d]))]}o[d]=[p]}return new h({data:o,size:[i,1]})},p=function(t,e){e=c(t,e,!0);for(var r,i,n=e._data,o=t._size[0],f=t._size[1],d=t._values,p=t._index,m=t._ptr,g=[],y=0;f>y;y++){var v=n[y][0]||0;if(u(v,0))g[y]=[0];else{var E=0,w=[],b=[],x=m[y+1];for(i=m[y];x>i;i++)r=p[i],r===y?E=d[i]:r>y&&(w.push(d[i]),b.push(r));if(u(E,0))throw new Error("Linear system cannot be solved since matrix is singular");var _=a(v,E);for(i=0,x=b.length;x>i;i++)r=b[i],n[r]=[l(n[r][0]||0,s(_,w[i]))];g[y]=[_]}}return new h({data:g,size:[o,1]})};return f}e.name="lsolve",e.factory=i},function(t,e,r){"use strict";function i(t){var e=t.DenseMatrix,r=function(t,r,i){var n=t.size();if(2!==n.length)throw new RangeError("Matrix must be two dimensional (size: "+o.format(n)+")");var l=n[0],u=n[1];if(l!==u)throw new RangeError("Matrix must be square (size: "+o.format(n)+")");var c,h,f;if(r&&r.isMatrix===!0){var d=r.size();if(1===d.length){if(d[0]!==l)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(c=[],f=r._data,h=0;l>h;h++)c[h]=[f[h]];return new e({data:c,size:[l,1],datatype:r._datatype})}if(2===d.length){if(d[0]!==l||1!==d[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(r.isDenseMatrix===!0){if(i){for(c=[],f=r._data,h=0;l>h;h++)c[h]=[f[h][0]];return new e({data:c,size:[l,1],datatype:r._datatype})}return r}for(c=[],h=0;l>h;h++)c[h]=[0];for(var p=r._values,m=r._index,g=r._ptr,y=g[1],v=g[0];y>v;v++)h=m[v],c[h][0]=p[v];return new e({data:c,size:[l,1],datatype:r._datatype})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}if(s(r)){var E=a.size(r);if(1===E.length){if(E[0]!==l)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(c=[],h=0;l>h;h++)c[h]=[r[h]];return new e({data:c,size:[l,1]})}if(2===E.length){if(E[0]!==l||1!==E[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(c=[],h=0;l>h;h++)c[h]=[r[h][0]];return new e({data:c,size:[l,1]})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}};return r}var n=r(39),o=n.string,a=n.array,s=Array.isArray;e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(52)),s=i(r(338)),l=i(r(339)),u=i(r(362)),c=i(r(360)),h=i(r(363)),f=i(r(359)),d=o("lusolve",{"Array, Array | Matrix":function(t,e){t=a(t);var r=s(t),i=m(r.L,r.U,r.p,null,e);return i.valueOf()},"DenseMatrix, Array | Matrix":function(t,e){var r=s(t);return m(r.L,r.U,r.p,null,e)},"SparseMatrix, Array | Matrix":function(t,e){var r=s(t);return m(r.L,r.U,r.p,null,e)},"SparseMatrix, Array | Matrix, number, number":function(t,e,r,i){var n=l(t,r,i);return m(n.L,n.U,n.p,n.q,e)},"Object, Array | Matrix":function(t,e){return m(t.L,t.U,t.p,t.q,e)}}),p=function(t){if(t&&t.isMatrix===!0)return t;if(n(t))return a(t);throw new TypeError("Invalid Matrix LU decomposition")},m=function(t,e,r,i,n){t=p(t),e=p(e),n=c(t,n,!1),r&&(n._data=u(r,n._data));var o=f(t,n),a=h(e,o);return i&&(a._data=u(i,a._data)),a};return d}var n=Array.isArray;e.name="lusolve",e.factory=i},function(t,e){"use strict";function r(){var t=function(t,e,r){var i,r=e.length,n=[];if(t)for(i=0;r>i;i++)n[t[i]]=e[i];else for(i=0;r>i;i++)n[i]=e[i];return n};return t}e.name="cs_ipvec",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(81)),s=i(r(80)),l=i(r(77)),u=i(r(48)),c=i(r(360)),h=t.DenseMatrix,f=n("usolve",{"SparseMatrix, Array | Matrix":function(t,e){return p(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return d(t,e)},"Array, Array | Matrix":function(t,e){var r=o(t),i=d(r,e);return i.valueOf()}}),d=function(t,e){e=c(t,e,!0);for(var r=e._data,i=t._size[0],n=t._size[1],o=[],f=t._data,d=n-1;d>=0;d--){var p,m=r[d][0]||0;if(u(m,0))p=0;else{var g=f[d][d];if(u(g,0))throw new Error("Linear system cannot be solved since matrix is singular");p=a(m,g);for(var y=d-1;y>=0;y--)r[y]=[l(r[y][0]||0,s(p,f[y][d]))]}o[d]=[p]}return new h({data:o,size:[i,1]})},p=function(t,e){e=c(t,e,!0);for(var r,i,n=e._data,o=t._size[0],f=t._size[1],d=t._values,p=t._index,m=t._ptr,g=[],y=f-1;y>=0;y--){var v=n[y][0]||0;if(u(v,0))g[y]=[0];else{var E=0,w=[],b=[],x=m[y],_=m[y+1];for(i=_-1;i>=x;i--)r=p[i],r===y?E=d[i]:y>r&&(w.push(d[i]),b.push(r));if(u(E,0))throw new Error("Linear system cannot be solved since matrix is singular");var S=a(v,E);for(i=0,_=b.length;_>i;i++)r=b[i],n[r]=[l(n[r][0],s(S,w[i]))];g[y]=[S]}}return new h({data:g,size:[o,1]})};return f}e.name="usolve",e.factory=i},function(t,e,r){t.exports=[r(86),r(51),r(53),r(365),r(367),r(368),r(327),r(369),r(371),r(373),r(374),r(87),r(375),r(376),r(377),r(380),r(383),r(384),r(385),r(84),r(386),r(388),r(82),r(389),r(391),r(378),r(392),r(77),r(78),r(393),r(394)]},function(t,e,r){"use strict";function i(t,e,i,a){function s(r,i){var n=r.arg()/3,a=r.abs(),s=new t.Complex(o(a),0).mul(new t.Complex(0,n).exp());if(i){var l=[s,new t.Complex(o(a),0).mul(new t.Complex(0,n+2*Math.PI/3).exp()),new t.Complex(o(a),0).mul(new t.Complex(0,n-2*Math.PI/3).exp())];return"Array"===e.matrix?l:h(l)}return s}function l(e){if(e.value&&e.value.isComplex){var r=e.clone();return r.value=1,r=r.pow(1/3),r.value=s(e.value),r}var i=c(e.value);i&&(e.value=u(e.value));var n;n=e.value&&e.value.isBigNumber?new t.BigNumber(1).div(3):e.value&&e.value.isFraction?new t.Fraction(1,3):1/3;var r=e.pow(n);return i&&(r.value=u(r.value)),r}var u=i(r(78)),c=i(r(366)),h=i(r(52)),f=a("cbrt",{number:o,Complex:s,"Complex, boolean":s,BigNumber:function(t){return t.cbrt()},Unit:l,"Array | Matrix":function(t){return n(t,f,!0)}});return f.toTex={1:"\\sqrt[3]{${args[0]}}"},f}var n=r(19),o=Math.cbrt||function(t){if(0===t)return t;var e,r=0>t;return r&&(t=-t),isFinite(t)?(e=Math.exp(Math.log(t)/3),e=(t/(e*e)+2*e)/3):e=t,r?-e:e};e.name="cbrt",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isNegative",{number:function(t){return 0>t},BigNumber:function(t){return t.isNeg()&&!t.isZero()&&!t.isNaN()},Fraction:function(t){return t.s<0},Unit:function(t){return o(t.value)},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);r(6);e.name="isNegative",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("ceil",{number:Math.ceil,Complex:function(t){return t.ceil()},BigNumber:function(t){return t.ceil()},Fraction:function(t){return t.ceil()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\left\\lceil${args[0]}\\right\\rceil"},o}var n=r(19);e.name="ceil",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("cube",{number:function(t){return t*t*t},Complex:function(t){return t.mul(t).mul(t)},BigNumber:function(t){return t.times(t).times(t)},Fraction:function(t){return t.pow(3)},"Array | Matrix":function(t){return n(t,o,!0)},Unit:function(t){return t.pow(3)}});return o.toTex={1:"\\left(${args[0]}\\right)^3"},o}var n=r(19);e.name="cube",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(81)),s=r(32),l=i(r(370)),u=i(r(61)),c=i(r(62)),h=i(r(85)),f=i(r(63)),d=i(r(57)),p=i(r(58)),m=n("dotDivide",{"any, any":a,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,a,!1);break;default:r=l(e,t,a,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,a,!1);break;default:r=d(t,e,a)}}return r},"Array, Array":function(t,e){return m(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return m(o(t),e)},"Matrix, Array":function(t,e){return m(t,o(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,a,!1);break;default:r=p(t,e,a,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=f(e,t,a,!0);break;default:r=p(e,t,a,!0)}return r},"Array, any":function(t,e){return p(o(t),e,a,!1).valueOf()},"any, Array":function(t,e){return p(o(e),t,a,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+s.operators.dotDivide+"${args[1]}\\right)"},m}e.name="dotDivide",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r,i){var l=t._data,u=t._size,c=t._datatype,h=e._values,f=e._index,d=e._ptr,p=e._size,m=e._datatype;if(u.length!==p.length)throw new n(u.length,p.length);if(u[0]!==p[0]||u[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+p+")");if(!h)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g,y=u[0],v=u[1],E=a,w=0,b=r;"string"==typeof c&&c===m&&(g=c,E=o.find(a,[g,g]),w=o.convert(0,g),b=o.find(r,[g,g]));for(var x=[],_=[],S=[],T=0;v>T;T++){S[T]=_.length;for(var L=d[T],M=d[T+1],A=L;M>A;A++){var N=f[A],R=i?b(h[A],l[N][T]):b(l[N][T],h[A]);E(R,w)||(_.push(N),x.push(R))}}return S[v]=_.length,new s({values:x,index:_,ptr:S,size:[y,v],datatype:g})};return l}var n=r(42);e.name="algorithm02",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(80)),s=r(32),l=i(r(370)),u=i(r(372)),c=i(r(85)),h=i(r(57)),f=i(r(58)),d=n("dotMultiply",{"any, any":a,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,a,!1);break;default:r=l(e,t,a,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,a,!1);break;default:r=h(t,e,a)}}return r},"Array, Array":function(t,e){return d(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return d(o(t),e)},"Matrix, Array":function(t,e){return d(t,o(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,a,!1);break;default:r=f(t,e,a,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,a,!0);break;default:r=f(e,t,a,!0)}return r},"Array, any":function(t,e){return f(o(t),e,a,!1).valueOf()},"any, Array":function(t,e){return f(o(e),t,a,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+s.operators.dotMultiply+"${args[1]}\\right)"},d}e.name="dotMultiply",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r){var i=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype,f=e._values,d=e._index,p=e._ptr,m=e._size,g=e._datatype;if(c.length!==m.length)throw new n(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");var y,v=c[0],E=c[1],w=a,b=0,x=r;"string"==typeof h&&h===g&&(y=h,w=o.find(a,[y,y]),b=o.convert(0,y),x=o.find(r,[y,y]));var _,S,T,L,M,A=i&&f?[]:void 0,N=[],R=[],C=new s({values:A,index:N,ptr:R,size:[v,E],datatype:y}),P=A?[]:void 0,O=[];for(S=0;E>S;S++){R[S]=N.length;var I=S+1;if(P)for(L=p[S],M=p[S+1],T=L;M>T;T++)_=d[T],O[_]=I,P[_]=f[T];for(L=u[S],M=u[S+1],T=L;M>T;T++)if(_=l[T],P){var k=O[_]===I?P[_]:b,D=x(i[T],k);w(D,b)||(N.push(_),A.push(D))}else N.push(_)}return R[E]=N.length,C};return l}var n=r(42);e.name="algorithm09",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(82)),s=r(32),l=i(r(61)),u=i(r(62)),c=i(r(85)),h=i(r(63)),f=i(r(57)),d=i(r(58)),p=n("dotPow",{"any, any":a,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,a,!1);break;default:r=l(e,t,a,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,a,!1);break;default:r=f(t,e,a)}}return r},"Array, Array":function(t,e){return p(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return p(o(t),e)},"Matrix, Array":function(t,e){return p(t,o(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return d(o(t),e,p,!1).valueOf()},"any, Array":function(t,e){return d(o(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+s.operators.dotPow+"${args[1]}\\right)"},p}e.name="dotPow",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("exp",{number:Math.exp,Complex:function(t){return t.exp()},BigNumber:function(t){return t.exp()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\exp\\left(${args[0]}\\right)"},o}var n=r(19);e.name="exp",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("floor",{number:Math.floor,Complex:function(t){return t.floor()},BigNumber:function(t){return t.floor()},Fraction:function(t){return t.floor()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\left\\lfloor${args[0]}\\right\\rfloor"},o}var n=r(19);e.name="floor",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(e,r){if(!e.isInt()||!r.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var i=new t.BigNumber(0);!r.isZero();){var n=e.mod(r);e=r,r=n}return e.lt(i)?e.neg():e}var s=i(r(52)),l=i(r(54)),u=i(r(55)),c=i(r(56)),h=i(r(57)),f=i(r(58)),d=o("gcd",{"number, number":n,"BigNumber, BigNumber":a,"Fraction, Fraction":function(t,e){return t.gcd(e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,d);break;default:r=l(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,d,!1);break;default:r=h(t,e,d)}}return r},"Array, Array":function(t,e){return d(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return d(s(t),e)},"Matrix, Array":function(t,e){
return d(t,s(e))},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,d,!1);break;default:r=f(t,e,d,!1)}return r},"number | BigNumber, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,d,!0);break;default:r=f(e,t,d,!0)}return r},"Array, number | BigNumber":function(t,e){return f(s(t),e,d,!1).valueOf()},"number | BigNumber, Array":function(t,e){return f(s(e),t,d,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(t,e,r){for(var i=d(t,e),n=0;n<r.length;n++)i=d(i,r[n]);return i}});return d.toTex="\\gcd\\left(${args}\\right)",d}function n(t,e){if(!o(t)||!o(e))throw new Error("Parameters in function gcd must be integer numbers");for(var r;0!=e;)r=t%e,t=e,e=r;return 0>t?-t:t}var o=r(6).isInteger;e.name="gcd",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t){for(var e=0,r=0,i=0;i<t.length;i++){var n=s(t[i]);f(r,n)?(e=c(e,c(u(r,n),u(r,n))),e=l(e,1),r=n):e=l(e,d(n)?c(u(n,r),u(n,r)):n)}return c(r,h(e))}var s=i(r(86)),l=i(r(53)),u=i(r(81)),c=i(r(80)),h=i(r(378)),f=i(r(60)),d=i(r(379)),p=o("hypot",{"... number | BigNumber":a,Array:function(t){return p.apply(p,n(t))},Matrix:function(t){return p.apply(p,n(t.toArray()))}});return p.toTex="\\hypot\\left(${args}\\right)",p}var n=r(40).flatten;e.name="hypot",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){function o(r){return r>=0||e.predictable?Math.sqrt(r):new t.Complex(r,0).sqrt()}var a=i("sqrt",{number:o,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():o(t.toNumber())},"Array | Matrix":function(t){return n(t,a,!0)},Unit:function(t){return t.pow(.5)}});return a.toTex={1:"\\sqrt{${args[0]}}"},a}var n=r(19);e.name="sqrt",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isPositive",{number:function(t){return t>0},BigNumber:function(t){return!t.isNeg()&&!t.isZero()&&!t.isNaN()},Fraction:function(t){return t.s>0&&t.n>0},Unit:function(t){return o(t.value)},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);r(6);e.name="isPositive",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(e,r){if(!e.isInt()||!r.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(e.isZero()||r.isZero())return new t.BigNumber(0);for(var i=e.times(r);!r.isZero();){var n=r;r=e.mod(n),e=n}return i.div(e).abs()}var s=i(r(52)),l=i(r(370)),u=i(r(381)),c=i(r(85)),h=i(r(57)),f=i(r(58)),d=o("lcm",{"number, number":n,"BigNumber, BigNumber":a,"Fraction, Fraction":function(t,e){return t.lcm(e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,d);break;default:r=l(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,d,!1);break;default:r=h(t,e,d)}}return r},"Array, Array":function(t,e){return d(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return d(s(t),e)},"Matrix, Array":function(t,e){return d(t,s(e))},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,d,!1);break;default:r=f(t,e,d,!1)}return r},"number | BigNumber, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,d,!0);break;default:r=f(e,t,d,!0)}return r},"Array, number | BigNumber":function(t,e){return f(s(t),e,d,!1).valueOf()},"number | BigNumber, Array":function(t,e){return f(s(e),t,d,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(t,e,r){for(var i=d(t,e),n=0;n<r.length;n++)i=d(i,r[n]);return i}});return d.toTex=void 0,d}function n(t,e){if(!o(t)||!o(e))throw new Error("Parameters in function lcm must be integer numbers");if(0==t||0==e)return 0;for(var r,i=t*e;0!=e;)r=e,e=t%r,t=r;return Math.abs(i/t)}var o=r(6).isInteger;e.name="lcm",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(48)),l=t.SparseMatrix,u=function(t,e,r){var i=t._values,u=t._size,c=t._datatype,h=e._values,f=e._size,d=e._datatype;if(u.length!==f.length)throw new o(u.length,f.length);if(u[0]!==f[0]||u[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+f+")");var p,m=u[0],g=u[1],y=s,v=0,E=r;"string"==typeof c&&c===d&&(p=c,y=a.find(s,[p,p]),v=a.convert(0,p),E=a.find(r,[p,p]));for(var w=i&&h?[]:void 0,b=[],x=[],_=new l({values:w,index:b,ptr:x,size:[m,g],datatype:p}),S=w?[]:void 0,T=[],L=[],M=0;g>M;M++){x[M]=b.length;var A=M+1;if(n(t,M,T,S,L,A,_,E),n(e,M,T,S,L,A,_,E),S)for(var N=x[M];N<b.length;){var R=b[N];if(L[R]===A){var C=S[R];y(C,v)?b.splice(N,1):(w.push(C),N++)}else b.splice(N,1)}else for(var P=x[M];P<b.length;){var O=b[P];L[O]!==A?b.splice(P,1):P++}}return x[g]=b.length,_};return u}var n=r(382),o=r(42);e.name="algorithm06",e.factory=i},function(t,e){"use strict";t.exports=function(t,e,r,i,n,o,a,s,l,u,c){var h,f,d,p,m=t._values,g=t._index,y=t._ptr,v=a._index;if(i)for(f=y[e],d=y[e+1],h=f;d>h;h++)p=g[h],r[p]!==o?(r[p]=o,v.push(p),u?(i[p]=l?s(m[h],c):s(c,m[h]),n[p]=o):i[p]=m[h]):(i[p]=l?s(m[h],i[p]):s(i[p],m[h]),n[p]=o);else for(f=y[e],d=y[e+1],h=f;d>h;h++)p=g[h],r[p]!==o?(r[p]=o,v.push(p)):n[p]=o}},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(81)),s=o("log",{number:function(r){return r>=0||e.predictable?Math.log(r):new t.Complex(r,0).log()},Complex:function(t){return t.log()},BigNumber:function(r){return!r.isNegative()||e.predictable?r.ln():new t.Complex(r.toNumber(),0).log()},"Array | Matrix":function(t){return n(t,s)},"any, any":function(t,e){return a(s(t),s(e))}});return s.toTex={1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},s}var n=r(19);e.name="log",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("log10",{number:function(r){return r>=0||e.predictable?o(r):new t.Complex(r,0).log().div(Math.LN10)},Complex:function(e){return new t.Complex(e).log().div(Math.LN10)},BigNumber:function(r){return!r.isNegative()||e.predictable?r.log():new t.Complex(r.toNumber(),0).log().div(Math.LN10)},"Array | Matrix":function(t){return n(t,a)}});return a.toTex={1:"\\log_{10}\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.log10||function(t){return Math.log(t)/Math.LN10};e.name="log10",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(e>0)return t-e*Math.floor(t/e);if(0===e)return t;throw new Error("Cannot calculate mod for a negative divisor")}var a=i(r(52)),s=r(32),l=i(r(370)),u=i(r(61)),c=i(r(79)),h=i(r(85)),f=i(r(63)),d=i(r(57)),p=i(r(58)),m=n("mod",{"number, number":o,"BigNumber, BigNumber":function(t,e){return e.isZero()?t:t.mod(e)},"Fraction, Fraction":function(t,e){return t.mod(e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,m,!1);break;default:r=l(e,t,m,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,m,!1);break;default:r=d(t,e,m)}}return r},"Array, Array":function(t,e){return m(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return m(a(t),e)},"Matrix, Array":function(t,e){return m(t,a(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,m,!1);break;default:r=p(t,e,m,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=f(e,t,m,!0);break;default:r=p(e,t,m,!0)}return r},"Array, any":function(t,e){return p(a(t),e,m,!1).valueOf()},"any, Array":function(t,e){return p(a(e),t,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+s.operators.mod+"${args[1]}\\right)"},m}e.name="mod",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){var r=t.size();if(1==r.length){if(e===Number.POSITIVE_INFINITY||"inf"===e){var i=0;return t.forEach(function(t){var e=a(t);f(e,i)&&(i=e)},!0),i}if(e===Number.NEGATIVE_INFINITY||"-inf"===e){var n;return t.forEach(function(t){var e=a(t);(!n||d(e,n))&&(n=e)},!0),n||0}if("fro"===e)return o(t,2);if("number"==typeof e&&!isNaN(e)){if(!h(e,0)){var p=0;return t.forEach(function(t){p=s(l(a(t),e),p)},!0),l(p,1/e)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}if(2==r.length){if(1===e){var y=[],v=0;return t.forEach(function(t,e){var r=e[1],i=s(y[r]||0,a(t));f(i,v)&&(v=i),y[r]=i},!0),v}if(e===Number.POSITIVE_INFINITY||"inf"===e){var E=[],w=0;return t.forEach(function(t,e){var r=e[0],i=s(E[r]||0,a(t));f(i,w)&&(w=i),E[r]=i},!0),w}if("fro"===e)return u(m(c(g(t),t)));if(2===e)throw new Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw new Error("Unsupported parameter value")}}var a=i(r(86)),s=i(r(51)),l=i(r(82)),u=i(r(378)),c=i(r(84)),h=i(r(48)),f=i(r(64)),d=i(r(60)),p=i(r(52)),m=i(r(387)),g=i(r(345)),y=n("norm",{number:Math.abs,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},"boolean | null":function(t){return Math.abs(t)},Array:function(t){return o(p(t),2)},Matrix:function(t){return o(t,2)},"number | Complex | BigNumber | boolean | null, number | BigNumber | string":function(t){return y(t)},"Array, number | BigNumber | string":function(t,e){return o(p(t),e)},"Matrix, number | BigNumber | string":function(t,e){return o(t,e)}});return y.toTex={1:"\\left\\|${args[0]}\\right\\|",2:void 0},y}e.name="norm",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(51)),u=a("trace",{Array:function(t){return u(s(t))},Matrix:function(t){var e;switch(t.storage()){case"dense":e=c(t);break;case"sparse":e=h(t)}return e},any:n}),c=function(t){var e=t._size,r=t._data;switch(e.length){case 1:if(1==e[0])return n(r[0]);throw new RangeError("Matrix must be square (size: "+o(e)+")");case 2:var i=e[0],a=e[1];if(i===a){for(var s=0,u=0;i>u;u++)s=l(s,r[u][u]);return s}throw new RangeError("Matrix must be square (size: "+o(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+o(e)+")")}},h=function(t){var e=t._values,r=t._index,i=t._ptr,n=t._size,a=n[0],s=n[1];if(a===s){var u=0;if(e.length>0)for(var c=0;s>c;c++)for(var h=i[c],f=i[c+1],d=h;f>d;d++){var p=r[d];if(p===c){u=l(u,e[d]);break}if(p>c)break}return u}throw new RangeError("Matrix must be square (size: "+o(n)+")")};return u.toTex={1:"\\mathrm{tr}\\left(${args[0]}\\right)"},u}var n=r(3).clone,o=r(23).format;e.name="trace",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){var i=t.BigNumber.precision,n=t.BigNumber.clone({precision:i+2}),o=new t.BigNumber(0),a=new n(1),s=r.isNegative();if(s&&(r=r.neg()),r.isZero())throw new Error("Root must be non-zero");if(e.isNegative()&&!r.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(e.isZero())return s?new n(1/0):0;if(!e.isFinite())return s?o:e;var l=e.abs().pow(a.div(r));return l=e.isNeg()?l.neg():l,new t.BigNumber((s?a.div(l):l).toPrecision(i))}var l=i(r(52)),u=i(r(54)),c=i(r(370)),h=i(r(381)),f=i(r(85)),d=i(r(57)),p=i(r(58)),m=a("nthRoot",{number:function(t){return n(t,2)},"number, number":n,BigNumber:function(e){return s(e,new t.BigNumber(2))},Complex:function(t){return o(t,2)},"Complex, number":o,"BigNumber, BigNumber":s,"Array | Matrix":function(t){return m(t,2)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":if(1!==e.density())throw new Error("Root must be non-zero");r=h(t,e,m);break;default:r=c(e,t,m,!0)}break;default:switch(e.storage()){case"sparse":if(1!==e.density())throw new Error("Root must be non-zero");r=u(t,e,m,!1);break;default:r=d(t,e,m)}}return r},"Array, Array":function(t,e){return m(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return m(l(t),e)},"Matrix, Array":function(t,e){return m(t,l(e))},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=f(t,e,m,!1);break;default:r=p(t,e,m,!1)}return r},"number | BigNumber, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":if(1!==e.density())throw new Error("Root must be non-zero");r=f(e,t,m,!0);break;default:r=p(e,t,m,!0)}return r},"Array, number | BigNumber":function(t,e){return m(l(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return m(t,l(e)).valueOf()}});return m.toTex={2:"\\sqrt[${args[1]}]{${args[0]}}"},m}function n(t,e){var r=0>e;if(r&&(e=-e),0===e)throw new Error("Root must be non-zero");if(0>t&&Math.abs(e)%2!=1)throw new Error("Root must be odd when a is negative.");if(0==t)return r?1/0:0;if(!isFinite(t))return r?0:t;var i=Math.pow(Math.abs(t),1/e);return i=0>t?-i:i,r?1/i:i}function o(t,e){if(0>e)throw new Error("Root must be greater than zero");if(0===e)throw new Error("Root must be non-zero");if(e%1!==0)throw new Error("Root must be an integer");for(var r=t.arg(),i=t.abs(),n=[],o=Math.pow(i,1/e),a=0;e>a;a++)n.push({r:o,phi:(r+2*Math.PI*a)/e});return n}e.name="nthRoot",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var u=i(r(52)),c=i(r(48)),h=i(r(390)),f=i(r(85)),d=i(r(63)),p=i(r(58)),m=a("round",{number:Math.round,"number, number":function(t,e){if(!o(e))throw new TypeError(l);if(0>e||e>15)throw new Error("Number of decimals in function round must be in te range of 0-15");return n(t,e)},Complex:function(t){return t.round()},"Complex, number":function(t,e){if(e%1)throw new TypeError(l);return t.round(e)},"Complex, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(l);var r=e.toNumber();return t.round(r)},"number, BigNumber":function(e,r){if(!r.isInteger())throw new TypeError(l);return new t.BigNumber(e).toDecimalPlaces(r.toNumber())},BigNumber:function(t){return t.toDecimalPlaces(0)},"BigNumber, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(l);return t.toDecimalPlaces(e.toNumber())},Fraction:function(t){return t.round()},"Fraction, number":function(t,e){if(e%1)throw new TypeError(l);return t.round(e)},"Array | Matrix":function(t){return s(t,m,!0)},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=f(t,e,m,!1);break;default:r=p(t,e,m,!1)}return r},"number | Complex | BigNumber, Matrix":function(t,e){if(!c(t,0)){var r;switch(e.storage()){case"sparse":r=d(e,t,m,!0);break;default:r=p(e,t,m,!0)}return r}return h(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return p(u(t),e,m,!1).valueOf()},"number | Complex | BigNumber, Array":function(t,e){return p(u(e),t,m,!0).valueOf()}});return m.toTex={1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},m}function n(t,e){return parseFloat(a(t,e))}var o=r(6).isInteger,a=r(6).toFixed,s=r(19),l="Number of decimals in function round must be an integer";e.name="round",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){var i=l(e),n=i?new t.BigNumber(0):0;if(u(e),r){var a=c(r);return e.length>0?a.resize(e,n):a}var s=[];return e.length>0?o(s,e,n):s}function l(t){var e=!1;return t.forEach(function(t,r,i){t&&t.isBigNumber===!0&&(e=!0,i[r]=t.toNumber())}),e}function u(t){t.forEach(function(t){if("number"!=typeof t||!n(t)||0>t)throw new Error("Parameters in function zeros must be positive integers")})}var c=i(r(52)),h=a("zeros",{"":function(){return"Array"===e.matrix?s([]):s([],"default")},"...number | BigNumber | string":function(t){var r=t[t.length-1];if("string"==typeof r){var i=t.pop();return s(t,i)}return"Array"===e.matrix?s(t):s(t,"default")},Array:s,Matrix:function(t){var e=t.storage();return s(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return s(t.valueOf(),e)}});return h.toTex=void 0,h}var n=r(6).isInteger,o=r(40).resize;e.name="zeros",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("sign",{number:n.sign,Complex:function(t){return t.sign()},BigNumber:function(e){return new t.BigNumber(e.cmp(0))},Fraction:function(e){return new t.Fraction(e.s,1)},"Array | Matrix":function(t){return o(t,a,!0)},Unit:function(t){return a(t.value)}});return a.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},a}var n=r(6),o=r(19);e.name="sign",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("square",{number:function(t){return t*t},Complex:function(t){return t.mul(t)},BigNumber:function(t){return t.times(t)},Fraction:function(t){return t.mul(t)},"Array | Matrix":function(t){return n(t,o,!0)},Unit:function(t){return t.pow(2)}});return o.toTex={1:"\\left(${args[0]}\\right)^2"},o}var n=r(19);e.name="square",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=o("unaryPlus",{number:function(t){return t},Complex:function(t){return t},BigNumber:function(t){return t},Fraction:function(t){return t},Unit:function(t){return t.clone()},"Array | Matrix":function(t){return n(t,s,!0)},"boolean | string | null":function(r){return"BigNumber"==e.number?new t.BigNumber(+r):+r}});return s.toTex={1:a.operators.unaryPlus+"\\left(${args[0]}\\right)"},s}var n=r(19);e.name="unaryPlus",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,r){var i,o,a,s=0,u=1,c=1,h=0;if(!n(t)||!n(r))throw new Error("Parameters in function xgcd must be integer numbers");for(;r;)o=Math.floor(t/r),a=t%r,i=s,s=u-o*s,u=i,i=c,c=h-o*c,h=i,t=r,r=a;var f;return f=0>t?[-t,-u,-h]:[t,t?u:0,h],"Array"===e.matrix?f:l(f)}function s(r,i){var n,o,a,s=new t.BigNumber(0),u=new t.BigNumber(1),c=s,h=u,f=u,d=s;if(!r.isInt()||!i.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!i.isZero();)o=r.div(i).floor(),a=r.mod(i),n=c,c=h.minus(o.times(c)),h=n,n=f,f=d.minus(o.times(f)),d=n,r=i,i=a;var p;return p=r.lt(s)?[r.neg(),h.neg(),d.neg()]:[r,r.isZero()?0:h,d],"Array"===e.matrix?p:l(p)}var l=i(r(52)),u=o("xgcd",{"number, number":a,"BigNumber, BigNumber":s});return u.toTex=void 0,u}var n=r(6).isInteger;e.name="xgcd",e.factory=i},function(t,e,r){t.exports=[r(396),r(400),r(401),r(403),r(405),r(408),r(410)]},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(370)),c=i(r(381)),h=i(r(85)),f=i(r(57)),d=i(r(58)),p=a("bitAnd",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function bitAnd");return t&e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=u(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,p,!1);break;default:r=f(t,e,p)}}return r},"Array, Array":function(t,e){return p(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return p(l(t),e)},"Matrix, Array":function(t,e){return p(t,l(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return d(l(t),e,p,!1).valueOf()},"any, Array":function(t,e){return d(l(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+s.operators.bitAnd+"${args[1]}\\right)"},p}var n=r(6).isInteger,o=r(397);e.name="bitAnd",e.factory=i},function(t,e,r){var i=r(398);t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitAnd");var r=t.constructor;if(t.isNaN()||e.isNaN())return new r(NaN);if(t.isZero()||e.eq(-1)||t.eq(e))return t;if(e.isZero()||t.eq(-1))return e;if(!t.isFinite()||!e.isFinite()){if(!t.isFinite()&&!e.isFinite())return t.isNegative()==e.isNegative()?t:new r(0);if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new r(0):e;if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new r(0):t}return i(t,e,function(t,e){return t&e})}},function(t,e,r){function i(t){for(var e=t.d,r=e[0]+"",i=1;i<e.length;++i){for(var n=e[i]+"",o=7-n.length;o--;)n="0"+n;r+=n}var a;for(a=r.length-1;"0"==r.charAt(a);--a);var s=t.e,l=r.slice(0,a+1||1),u=l.length;if(s>0)if(++s>u)for(s-=u;s--;l+="0");else u>s&&(l=l.slice(0,s)+"."+l.slice(s));for(var c=[0],i=0;i<l.length;){for(var h=c.length;h--;c[h]*=10);c[0]+=l.charAt(i++)<<0;for(var a=0;a<c.length;++a)c[a]>1&&(null==c[a+1]&&(c[a+1]=0),c[a+1]+=c[a]>>1,c[a]&=1)}return c.reverse()}var n=r(399);t.exports=function(t,e,r){var o,a,s=t.constructor,l=+(t.s<0),u=+(e.s<0);if(l){o=i(n(t));for(var c=0;c<o.length;++c)o[c]^=1}else o=i(t);if(u){a=i(n(e));for(var c=0;c<a.length;++c)a[c]^=1}else a=i(e);var h,f,d;o.length<=a.length?(h=o,f=a,d=l):(h=a,f=o,d=u);var p=h.length,m=f.length,g=1^r(l,u),y=new s(1^g),v=new s(1),E=new s(2),w=s.precision;for(s.config({precision:1e9});p>0;)r(h[--p],f[--m])==g&&(y=y.plus(v)),v=v.times(E);for(;m>0;)r(d,f[--m])==g&&(y=y.plus(v)),v=v.times(E);return s.config({precision:w}),0==g&&(y.s=-y.s),y}},function(t,e){t.exports=function(t){if(t.isFinite()&&!t.isInteger())throw new Error("Integer expected in function bitNot");var e=t.constructor,r=e.precision;e.config({precision:1e9});var t=t.plus(new e(1));return t.s=-t.s||null,e.config({precision:r}),t}},function(t,e,r){"use strict";function i(t,e,i,s){var l=r(32),u=s("bitNot",{number:function(t){if(!a(t))throw new Error("Integer expected in function bitNot");return~t},BigNumber:o,"Array | Matrix":function(t){return n(t,u)}});return u.toTex={1:l.operators.bitNot+"\\left(${args[0]}\\right)"},u}var n=r(19),o=r(399),a=r(6).isInteger;e.name="bitNot",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(54)),c=i(r(55)),h=i(r(56)),f=i(r(57)),d=i(r(58)),p=a("bitOr",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function bitOr");return t|e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,p);break;default:r=u(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,p,!1);break;default:r=f(t,e,p)}}return r},"Array, Array":function(t,e){return p(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return p(l(t),e)},"Matrix, Array":function(t,e){return p(t,l(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return d(l(t),e,p,!1).valueOf()},"any, Array":function(t,e){return d(l(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+s.operators.bitOr+"${args[1]}\\right)"},p}var n=r(6).isInteger,o=r(402);e.name="bitOr",e.factory=i},function(t,e,r){var i=r(398);t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitOr");var r=t.constructor;if(t.isNaN()||e.isNaN())return new r(NaN);var n=new r(-1);return t.isZero()||e.eq(n)||t.eq(e)?e:e.isZero()||t.eq(n)?t:t.isFinite()&&e.isFinite()?i(t,e,function(t,e){return t|e}):!t.isFinite()&&!t.isNegative()&&e.isNegative()||t.isNegative()&&!e.isNegative()&&!e.isFinite()?n:t.isNegative()&&e.isNegative()?t.isFinite()?t:e:t.isFinite()?e:t}},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(61)),c=i(r(62)),h=i(r(63)),f=i(r(57)),d=i(r(58)),p=a("bitXor",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function bitXor");return t^e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,p);break;default:r=u(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,p,!1);break;default:r=f(t,e,p)}}return r},"Array, Array":function(t,e){return p(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return p(l(t),e)},"Matrix, Array":function(t,e){return p(t,l(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return d(l(t),e,p,!1).valueOf()},"any, Array":function(t,e){return d(l(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+s.operators.bitXor+"${args[1]}\\right)"},p}var n=r(6).isInteger,o=r(404);e.name="bitXor",e.factory=i},function(t,e,r){var i=r(398),n=r(399);t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitXor");var r=t.constructor;if(t.isNaN()||e.isNaN())return new r(NaN);if(t.isZero())return e;if(e.isZero())return t;if(t.eq(e))return new r(0);var o=new r(-1);return t.eq(o)?n(e):e.eq(o)?n(t):t.isFinite()&&e.isFinite()?i(t,e,function(t,e){return t^e}):t.isFinite()||e.isFinite()?new r(t.isNegative()==e.isNegative()?1/0:-(1/0)):o}},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(48)),c=i(r(390)),h=i(r(54)),f=i(r(370)),d=i(r(407)),p=i(r(56)),m=i(r(85)),g=i(r(57)),y=i(r(58)),v=a("leftShift",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function leftShift");return t<<e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=d(t,e,v,!1);break;default:r=f(e,t,v,!0)}break;default:switch(e.storage()){case"sparse":r=h(t,e,v,!1);break;default:r=g(t,e,v)}}return r},"Array, Array":function(t,e){return v(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return v(l(t),e)},"Matrix, Array":function(t,e){return v(t,l(e))},"Matrix, number | BigNumber":function(t,e){if(!u(e,0)){var r;switch(t.storage()){case"sparse":r=m(t,e,v,!1);break;default:r=y(t,e,v,!1)}return r}return t.clone()},"number | BigNumber, Matrix":function(t,e){if(!u(t,0)){var r;switch(e.storage()){case"sparse":r=p(e,t,v,!0);break;default:r=y(e,t,v,!0)}return r}return c(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return v(l(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return v(t,l(e)).valueOf()}});return v.toTex={2:"\\left(${args[0]}"+s.operators.leftShift+"${args[1]}\\right)"},v}var n=r(6).isInteger,o=r(406);e.name="leftShift",e.factory=i},function(t,e){t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function leftShift");var r=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new r(NaN):t.isZero()||e.isZero()?t:t.isFinite()||e.isFinite()?e.lt(55)?t.times(Math.pow(2,e.toNumber())+""):t.times(new r(2).pow(e)):new r(NaN)}},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r){var i=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype,f=e._values,d=e._index,p=e._ptr,m=e._size,g=e._datatype;if(c.length!==m.length)throw new n(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");if(!i||!f)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var y,v=c[0],E=c[1],w=a,b=0,x=r;"string"==typeof h&&h===g&&(y=h,w=o.find(a,[y,y]),b=o.convert(0,y),x=o.find(r,[y,y]));for(var _,S,T,L,M=[],A=[],N=[],R=new s({values:M,index:A,ptr:N,size:[v,E],datatype:y}),C=[],P=[],O=0;E>O;O++){N[O]=A.length;var I=O+1;for(S=u[O],T=u[O+1],_=S;T>_;_++)L=l[_],P[L]=I,C[L]=i[_],A.push(L);for(S=p[O],T=p[O+1],_=S;T>_;_++)L=d[_],P[L]===I&&(C[L]=x(C[L],f[_]));for(_=N[O];_<A.length;){L=A[_];var k=C[L];w(k,b)?A.splice(_,1):(M.push(k),_++)}}return N[E]=A.length,R};return l}var n=r(42);e.name="algorithm08",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(48)),c=i(r(390)),h=i(r(54)),f=i(r(370)),d=i(r(407)),p=i(r(56)),m=i(r(85)),g=i(r(57)),y=i(r(58)),v=a("rightArithShift",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function rightArithShift");return t>>e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=d(t,e,v,!1);break;default:r=f(e,t,v,!0)}break;default:switch(e.storage()){case"sparse":r=h(t,e,v,!1);break;default:r=g(t,e,v)}}return r},"Array, Array":function(t,e){return v(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return v(l(t),e)},"Matrix, Array":function(t,e){return v(t,l(e))},"Matrix, number | BigNumber":function(t,e){if(!u(e,0)){var r;switch(t.storage()){case"sparse":r=m(t,e,v,!1);break;default:r=y(t,e,v,!1)}return r}return t.clone()},"number | BigNumber, Matrix":function(t,e){if(!u(t,0)){var r;switch(e.storage()){case"sparse":r=p(e,t,v,!0);break;default:r=y(e,t,v,!0)}return r}return c(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return v(l(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return v(t,l(e)).valueOf()}});return v.toTex={2:"\\left(${args[0]}"+s.operators.rightArithShift+"${args[1]}\\right)"},v}var n=r(6).isInteger,o=r(409);e.name="rightArithShift",e.factory=i},function(t,e){t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function rightArithShift");var r=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new r(NaN):t.isZero()||e.isZero()?t:e.isFinite()?e.lt(55)?t.div(Math.pow(2,e.toNumber())+"").floor():t.div(new r(2).pow(e)).floor():new r(t.isNegative()?-1:t.isFinite()?0:NaN)}},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=i(r(52)),l=i(r(48)),u=i(r(390)),c=i(r(54)),h=i(r(370)),f=i(r(407)),d=i(r(56)),p=i(r(85)),m=i(r(57)),g=i(r(58)),y=o("rightLogShift",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function rightLogShift");return t>>>e},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=f(t,e,y,!1);break;default:r=h(e,t,y,!0)}break;default:switch(e.storage()){case"sparse":r=c(t,e,y,!1);break;default:r=m(t,e,y)}}return r},"Array, Array":function(t,e){return y(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return y(s(t),e)},"Matrix, Array":function(t,e){return y(t,s(e))},"Matrix, number | BigNumber":function(t,e){if(!l(e,0)){var r;switch(t.storage()){case"sparse":r=p(t,e,y,!1);break;default:r=g(t,e,y,!1)}return r}return t.clone()},"number | BigNumber, Matrix":function(t,e){if(!l(t,0)){var r;switch(e.storage()){case"sparse":r=d(e,t,y,!0);break;default:r=g(e,t,y,!0)}return r}return u(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return y(s(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return y(t,s(e)).valueOf()}});return y.toTex={2:"\\left(${args[0]}"+a.operators.rightLogShift+"${args[1]}\\right)"},y}var n=r(6).isInteger;e.name="rightLogShift",e.factory=i},function(t,e,r){t.exports=[r(412),r(418),r(413),r(419)]},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(51)),a=i(r(413)),s=i(r(366)),l=i(r(417)),u=n("bellNumbers",{"number | BigNumber":function(t){if(!l(t)||s(t))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var e=0,r=0;t>=r;r++)e=o(e,a(t,r));return e}});return u.toTex={1:"\\mathrm{B}_{${args[0]}}"},u}e.name="bellNumbers",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(51)),a=i(r(77)),s=i(r(84)),l=i(r(327)),u=i(r(82)),c=i(r(414)),h=i(r(416)),f=i(r(366)),d=i(r(417)),p=i(r(64)),m=n("stirlingS2",{"number | BigNumber, number | BigNumber":function(t,e){if(!d(t)||f(t)||!d(e)||f(e))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(p(e,t))throw new TypeError("k must be less than or equal to n in function stirlingS2");for(var r=c(e),i=0,n=0;e>=n;n++){var m=u(-1,a(e,n)),g=h(e,n),y=u(n,t);i=o(i,s(s(g,y),m))}return l(i,r)}});return m.toTex={2:"\\mathrm{S}\\left(${args}\\right)"},m}e.name="stirlingS2",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(415)),s=r(32),l=o("factorial",{number:function(t){if(0>t)throw new Error("Value must be non-negative");return a(t+1)},BigNumber:function(t){if(t.isNegative())throw new Error("Value must be non-negative");return a(t.plus(1))},"Array | Matrix":function(t){return n(t,l)}});return l.toTex={1:"\\left(${args[0]}\\right)"+s.operators.factorial},l}var n=r(19);e.name="factorial",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,l){function u(r){if(r.isZero())return new t.BigNumber(1);
for(var i=e.precision+(0|Math.log(r.toNumber())),n=t.BigNumber.clone({precision:i}),o=new n(r),a=r.toNumber()-1;a>1;)o=o.times(a),a--;return new t.BigNumber(o.toPrecision(t.BigNumber.precision))}var c=i(r(84)),h=i(r(82)),f=l("gamma",{number:function(t){var e,r;if(o(t)){if(0>=t)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var i=t-2,n=t-1;i>1;)n*=i,i--;return 0==n&&(n=1),n}if(.5>t)return Math.PI/(Math.sin(Math.PI*t)*f(1-t));if(t>=171.35)return 1/0;if(t>85){var l=t*t,u=l*t,c=u*t,h=c*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*l)-139/(51840*u)-571/(2488320*c)+163879/(209018880*h)+5246819/(75246796800*h*t))}--t,r=s[0];for(var d=1;d<s.length;++d)r+=s[d]/(t+d);return e=t+a+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*r},Complex:function(e){var r,i;if(0==e.im)return f(e.re);e=new t.Complex(e.re-1,e.im),i=new t.Complex(s[0],0);for(var n=1;n<s.length;++n){var o=e.re+n,l=o*o+e.im*e.im;0!=l?(i.re+=s[n]*o/l,i.im+=-(s[n]*e.im)/l):i.re=s[n]<0?-(1/0):1/0}r=new t.Complex(e.re+a+.5,e.im);var u=Math.sqrt(2*Math.PI);e.re+=.5;var d=h(r,e);0==d.im?d.re*=u:0==d.re?d.im*=u:(d.re*=u,d.im*=u);var p=Math.exp(-r.re);return r.re=p*Math.cos(-r.im),r.im=p*Math.sin(-r.im),c(c(d,r),i)},BigNumber:function(e){if(e.isInteger())return e.isNegative()||e.isZero()?new t.BigNumber(1/0):u(e.minus(1));if(!e.isFinite())return new t.BigNumber(e.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")},"Array | Matrix":function(t){return n(t,f)}});return f.toTex={1:"\\Gamma\\left(${args[0]}\\right)"},f}var n=r(19),o=r(6).isInteger,a=4.7421875,s=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];e.name="gamma",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("combinations",{"number, number":function(t,e){var r,i,n;if(!o(t)||0>t)throw new TypeError("Positive integer value expected in function combinations");if(!o(e)||0>e)throw new TypeError("Positive integer value expected in function combinations");if(e>t)throw new TypeError("k must be less than or equal to n");for(r=Math.max(e,t-e),i=1,n=1;t-r>=n;n++)i=i*(r+n)/n;return i},"BigNumber, BigNumber":function(e,r){var i,o,a,s,l=new t.BigNumber(1);if(!n(e)||!n(r))throw new TypeError("Positive integer value expected in function combinations");if(r.gt(e))throw new TypeError("k must be less than n in function combinations");for(i=e.minus(r),r.lt(i)&&(i=r),o=l,a=l,s=e.minus(i);a.lte(s);a=a.plus(1))o=o.times(i.plus(a)).dividedBy(a);return o}});return a.toTex={2:"\\binom{${args[0]}}{${args[1]}}"},a}function n(t){return t.isInteger()&&t.gte(0)}var o=r(6).isInteger;e.name="combinations",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("isInteger",{number:o.isInteger,BigNumber:function(t){return t.isInt()},Fraction:function(t){return 1===t.d&&isFinite(t.n)},"Array | Matrix":function(t){return n(t,a)}});return a}var n=r(19),o=r(6);e.name="isInteger",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(416)),a=i(r(53)),s=i(r(379)),l=i(r(417)),u=i(r(64)),c=n("composition",{"number | BigNumber, number | BigNumber":function(t,e){if(!(l(t)&&s(t)&&l(e)&&s(e)))throw new TypeError("Positive integer value expected in function composition");if(u(e,t))throw new TypeError("k must be less than or equal to n in function composition");return o(a(t,-1),a(e,-1))}});return c.toTex=void 0,c}e.name="composition",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(51)),a=i(r(327)),s=i(r(84)),l=i(r(416)),u=i(r(366)),c=i(r(417)),h=n("catalan",{"number | BigNumber":function(t){if(!c(t)||u(t))throw new TypeError("Non-negative integer value expected in function catalan");return a(l(s(t,2),t),o(t,1))}});return h.toTex={1:"\\mathrm{C}_{${args[0]}}"},h}e.name="catalan",e.factory=i},function(t,e,r){t.exports=[r(421),r(422),r(423),r(424)]},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("arg",{number:function(t){return Math.atan2(0,t)},BigNumber:function(e){return t.BigNumber.atan2(0,e)},Complex:function(t){return t.arg()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\arg\\left(${args[0]}\\right)"},o}var n=r(19);e.name="arg",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("conj",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.conjugate()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\left(${args[0]}\\right)^*"},o}var n=r(19);e.name="conj",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("im",{number:function(t){return 0},BigNumber:function(e){return new t.BigNumber(0)},Complex:function(t){return t.im},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},o}var n=r(19);e.name="im",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("re",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.re},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},o}var n=r(19);e.name="re",e.factory=i},function(t,e,r){t.exports=[r(426),r(427)]},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){return 2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function a(t){return 3===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]}function s(t){return 4===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}function l(t,r,i,n){var o=t,a=i,s=m(o,r),l=m(a,n),u=s[0]*l[1]-l[0]*s[1];if(h(u)<e.epsilon)return null;var c=(l[0]*o[1]-l[1]*o[0]-l[0]*a[1]+l[1]*a[0])/u;return f(p(s,c),o)}function u(t,e,r,i,n,o,a,s,l,u,c,h){var f=(t-a)*(u-a)+(e-s)*(c-s)+(r-l)*(h-l),d=(u-a)*(i-t)+(c-s)*(n-e)+(h-l)*(o-r),p=(t-a)*(i-t)+(e-s)*(n-e)+(r-l)*(o-r),m=(u-a)*(u-a)+(c-s)*(c-s)+(h-l)*(h-l),g=(i-t)*(i-t)+(n-e)*(n-e)+(o-r)*(o-r),y=(f*d-p*m)/(g*m-d*d),v=(f+y*d)/m,E=t+y*(i-t),w=e+y*(n-e),b=r+y*(o-r),x=a+v*(u-a),_=s+v*(c-s),S=l+v*(h-l);return E===x&&w===_&&b===S?[E,w,b]:null}function c(t,e,r,i,n,o,a,s,l,u){var c=(u-t*a-e*s-r*l)/(i*a+n*s+o*l-t-e-r),h=t+c*(i-t),f=e+c*(n-e),d=r+c*(o-r);return[h,f,d]}var h=i(r(86)),f=i(r(51)),d=i(r(52)),p=i(r(84)),m=i(r(77)),g=n("intersect",{"Array, Array, Array":function(t,e,r){if(!a(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!a(e))throw new TypeError("Array with 3 numbers expected for second argument");if(!s(r))throw new TypeError("Array with 4 numbers expected as third argument");return c(t[0],t[1],t[2],e[0],e[1],e[2],r[0],r[1],r[2],r[3])},"Array, Array, Array, Array":function(t,e,r,i){if(2===t.length){if(!o(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!o(e))throw new TypeError("Array with 2 numbers expected for second argument");if(!o(r))throw new TypeError("Array with 2 numbers expected for third argument");if(!o(i))throw new TypeError("Array with 2 numbers expected for fourth argument");return l(t,e,r,i)}if(3===t.length){if(!a(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!a(e))throw new TypeError("Array with 3 numbers expected for second argument");if(!a(r))throw new TypeError("Array with 3 numbers expected for third argument");if(!a(i))throw new TypeError("Array with 3 numbers expected for fourth argument");return u(t[0],t[1],t[2],e[0],e[1],e[2],r[0],r[1],r[2],i[0],i[1],i[2])}throw new TypeError("Arrays with two or thee dimensional points expected")},"Matrix, Matrix, Matrix":function(t,e,r){return d(g(t.valueOf(),e.valueOf(),r.valueOf()))},"Matrix, Matrix, Matrix, Matrix":function(t,e,r,i){return d(g(t.valueOf(),e.valueOf(),r.valueOf(),i.valueOf()))}});return g}e.name="intersect",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,s){var p=(i(r(52)),s("distance",{"Array, Array, Array":function(t,e,r){if(2==t.length&&2==e.length&&2==r.length){if(!n(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!n(e))throw new TypeError("Array with 2 numbers expected for second argument");if(!n(r))throw new TypeError("Array with 2 numbers expected for third argument");var i=(r[1]-r[0])/(e[1]-e[0]),o=i*i*e[0],a=-1*(i*e[0]),s=t[1];return u(t[0],t[1],o,a,s)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(t,e,r){if(2==Object.keys(t).length&&2==Object.keys(e).length&&2==Object.keys(r).length){if(!n(t))throw new TypeError("Values of pointX and pointY should be numbers");if(!n(e))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers");if(!n(r))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers");if(t.hasOwnProperty("pointX")&&t.hasOwnProperty("pointY")&&e.hasOwnProperty("lineOnePtX")&&e.hasOwnProperty("lineOnePtY")&&r.hasOwnProperty("lineTwoPtX")&&r.hasOwnProperty("lineTwoPtY")){var i=(r.lineTwoPtY-r.lineTwoPtX)/(e.lineOnePtY-e.lineOnePtX),o=i*i*e.lineOnePtX,a=-1*(i*e.lineOnePtX),s=t.pointX;return u(t.pointX,t.pointY,o,a,s)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(t,e){if(2==t.length&&3==e.length){if(!n(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!o(e))throw new TypeError("Array with 3 numbers expected for second argument");return u(t[0],t[1],e[0],e[1],e[2])}if(3==t.length&&6==e.length){if(!o(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!a(e))throw new TypeError("Array with 6 numbers expected for second argument");return c(t[0],t[1],t[2],e[0],e[1],e[2],e[3],e[4],e[5])}if(2==t.length&&2==e.length){if(!n(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!n(e))throw new TypeError("Array with 2 numbers expected for second argument");return h(t[0],t[1],e[0],e[1])}if(3==t.length&&3==e.length){if(!o(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!o(e))throw new TypeError("Array with 3 numbers expected for second argument");return f(t[0],t[1],t[2],e[0],e[1],e[2])}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(t,e){if(2==Object.keys(t).length&&3==Object.keys(e).length){if(!n(t))throw new TypeError("Values of pointX and pointY should be numbers");if(!o(e))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers");if(t.hasOwnProperty("pointX")&&t.hasOwnProperty("pointY")&&e.hasOwnProperty("xCoeffLine")&&e.hasOwnProperty("yCoeffLine")&&e.hasOwnProperty("yCoeffLine"))return u(t.pointX,t.pointY,e.xCoeffLine,e.yCoeffLine,e.constant);throw new TypeError("Key names do not match")}if(3==Object.keys(t).length&&6==Object.keys(e).length){if(!o(t))throw new TypeError("Values of pointX, pointY and pointZ should be numbers");if(!a(e))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers");if(t.hasOwnProperty("pointX")&&t.hasOwnProperty("pointY")&&e.hasOwnProperty("x0")&&e.hasOwnProperty("y0")&&e.hasOwnProperty("z0")&&e.hasOwnProperty("a")&&e.hasOwnProperty("b")&&e.hasOwnProperty("c"))return c(t.pointX,t.pointY,t.pointZ,e.x0,e.y0,e.z0,e.a,e.b,e.c);throw new TypeError("Key names do not match")}if(2==Object.keys(t).length&&2==Object.keys(e).length){if(!n(t))throw new TypeError("Values of pointOneX and pointOneY should be numbers");if(!n(e))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers");if(t.hasOwnProperty("pointOneX")&&t.hasOwnProperty("pointOneY")&&e.hasOwnProperty("pointTwoX")&&e.hasOwnProperty("pointTwoY"))return h(t.pointOneX,t.pointOneY,e.pointTwoX,e.pointTwoY);throw new TypeError("Key names do not match")}if(3==Object.keys(t).length&&3==Object.keys(e).length){if(!o(t))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers");if(!o(e))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers");if(t.hasOwnProperty("pointOneX")&&t.hasOwnProperty("pointOneY")&&t.hasOwnProperty("pointOneZ")&&e.hasOwnProperty("pointTwoX")&&e.hasOwnProperty("pointTwoY")&&e.hasOwnProperty("pointTwoZ"))return f(t.pointOneX,t.pointOneY,t.pointOneZ,e.pointTwoX,e.pointTwoY,e.pointTwoZ);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(t){if(!l(t))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return d(t)}}));return p}function n(t){return t.constructor!==Array&&(t=s(t)),"number"==typeof t[0]&&"number"==typeof t[1]}function o(t){return t.constructor!==Array&&(t=s(t)),"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]}function a(t){return t.constructor!==Array&&(t=s(t)),"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]&&"number"==typeof t[4]&&"number"==typeof t[5]}function s(t){for(var e=Object.keys(t),r=[],i=0;i<e.length;i++)r.push(t[e[i]]);return r}function l(t){if(2==t[0].length&&"number"==typeof t[0][0]&&"number"==typeof t[0][1]){for(var e in t)if(2!=t[e].length||"number"!=typeof t[e][0]||"number"!=typeof t[e][1])return!1}else{if(3!=t[0].length||"number"!=typeof t[0][0]||"number"!=typeof t[0][1]||"number"!=typeof t[0][2])return!1;for(var e in t)if(3!=t[e].length||"number"!=typeof t[e][0]||"number"!=typeof t[e][1]||"number"!=typeof t[e][2])return!1}return!0}function u(t,e,r,i,n){var o=Math.abs(r*t+i*e+n),a=Math.pow(r*r+i*i,.5),s=o/a;return s}function c(t,e,r,i,n,o,a,s,l){var u=[(n-e)*l-(o-r)*s,(o-r)*a-(i-t)*l,(i-t)*s-(n-e)*a];u=Math.pow(u[0]*u[0]+u[1]*u[1]+u[2]*u[2],.5);var c=Math.pow(a*a+s*s+l*l,.5),h=u/c;return h}function h(t,e,r,i){var n=i-e,o=r-t,a=n*n+o*o,s=Math.pow(a,.5);return s}function f(t,e,r,i,n,o){var a=o-r,s=n-e,l=i-t,u=a*a+s*s+l*l,c=Math.pow(u,.5);return c}function d(t){for(var e=[],r=0;r<t.length-1;r++)for(var i=r+1;i<t.length;i++)2==t[0].length?e.push(h(t[r][0],t[r][1],t[i][0],t[i][1])):3==t[0].length&&e.push(f(t[r][0],t[r][1],t[r][2],t[i][0],t[i][1],t[i][2]));return e}e.name="distance",e.factory=i},function(t,e,r){t.exports=[r(429),r(430),r(432),r(433)]},function(t,e,r){"use strict";function i(t,e,i,n){var o=r(32),a=i(r(52)),s=i(r(390)),l=i(r(430)),u=(i(r(431)),i(r(370))),c=i(r(381)),h=i(r(85)),f=i(r(57)),d=i(r(58)),p=n("and",{"number, number":function(t,e){return!(!t||!e)},"Complex, Complex":function(t,e){return!(0===t.re&&0===t.im||0===e.re&&0===e.im)},"BigNumber, BigNumber":function(t,e){return!(t.isZero()||e.isZero()||t.isNaN()||e.isNaN())},"Unit, Unit":function(t,e){return p(t.value,e.value)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=u(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,p,!1);break;default:r=f(t,e,p)}}return r},"Array, Array":function(t,e){return p(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return p(a(t),e)},"Matrix, Array":function(t,e){return p(t,a(e))},"Matrix, any":function(t,e){if(l(e))return s(t.size(),t.storage());var r;switch(t.storage()){case"sparse":r=h(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){if(l(t))return s(t.size(),t.storage());var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return p(a(t),e).valueOf()},"any, Array":function(t,e){return p(t,a(e)).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+o.operators.and+"${args[1]}\\right)"},p}e.name="and",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=o("not",{number:function(t){return!t},Complex:function(t){return 0===t.re&&0===t.im},BigNumber:function(t){return t.isZero()||t.isNaN()},Unit:function(t){return s(t.value)},"Array | Matrix":function(t){return n(t,s)}});return s.toTex={1:a.operators.not+"\\left(${args[0]}\\right)"},s}var n=r(19);e.name="not",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isZero",{number:function(t){return 0===t},BigNumber:function(t){return t.isZero()},Complex:function(t){return 0===t.re&&0===t.im},Fraction:function(t){return 1===t.d&&0===t.n},Unit:function(t){return o(t.value)},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);r(6);e.name="isZero",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=r(32),a=i(r(52)),s=i(r(61)),l=i(r(79)),u=i(r(63)),c=i(r(57)),h=i(r(58)),f=n("or",{"number, number":function(t,e){return!(!t&&!e)},"Complex, Complex":function(t,e){return 0!==t.re||0!==t.im||0!==e.re||0!==e.im},"BigNumber, BigNumber":function(t,e){return!t.isZero()&&!t.isNaN()||!e.isZero()&&!e.isNaN()},"Unit, Unit":function(t,e){return f(t.value,e.value)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=l(t,e,f);break;default:r=s(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":r=s(t,e,f,!1);break;default:r=c(t,e,f)}}return r},"Array, Array":function(t,e){return f(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return f(a(t),e)},"Matrix, Array":function(t,e){return f(t,a(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=u(t,e,f,!1);break;default:r=h(t,e,f,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=u(e,t,f,!0);break;default:r=h(e,t,f,!0)}return r},"Array, any":function(t,e){return h(a(t),e,f,!1).valueOf()},"any, Array":function(t,e){return h(a(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+o.operators.or+"${args[1]}\\right)"},f}e.name="or",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=r(32),a=i(r(52)),s=i(r(61)),l=i(r(62)),u=i(r(63)),c=i(r(57)),h=i(r(58)),f=n("xor",{"number, number":function(t,e){return!!(!!t^!!e)},"Complex, Complex":function(t,e){return(0!==t.re||0!==t.im)!=(0!==e.re||0!==e.im)},"BigNumber, BigNumber":function(t,e){return(!t.isZero()&&!t.isNaN())!=(!e.isZero()&&!e.isNaN())},"Unit, Unit":function(t,e){return f(t.value,e.value)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=l(t,e,f);break;default:r=s(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":r=s(t,e,f,!1);break;default:r=c(t,e,f)}}return r},"Array, Array":function(t,e){return f(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return f(a(t),e)},"Matrix, Array":function(t,e){return f(t,a(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=u(t,e,f,!1);break;default:r=h(t,e,f,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=u(e,t,f,!0);break;default:r=h(e,t,f,!0)}return r},"Array, any":function(t,e){return h(a(t),e,f,!1).valueOf()},"any, Array":function(t,e){return h(a(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+o.operators.xor+"${args[1]}\\right)"},f}e.name="xor",e.factory=i},function(t,e,r){t.exports=[r(311),r(435),r(329),r(436),r(437),r(83),r(313),r(438),r(315),r(328),r(318),r(439),r(440),r(333),r(442),r(443),r(444),r(445),r(286),r(387),r(345),r(390)]},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e){var r=Math.max(n.size(t).length,n.size(e).length);t=n.squeeze(t),e=n.squeeze(e);var i=n.size(t),o=n.size(e);if(1!=i.length||1!=o.length||3!=i[0]||3!=o[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+i.join(", ")+"], B = ["+o.join(", ")+"])");var a=[l(u(t[1],e[2]),u(t[2],e[1])),l(u(t[2],e[0]),u(t[0],e[2])),l(u(t[0],e[1]),u(t[1],e[0]))];return r>1?[a]:a}var s=i(r(52)),l=i(r(77)),u=i(r(84)),c=o("cross",{"Matrix, Matrix":function(t,e){return s(a(t.toArray(),e.toArray()))},"Matrix, Array":function(t,e){return s(a(t.toArray(),e))},"Array, Matrix":function(t,e){return s(a(t,e.toArray()))},"Array, Array":a});return c.toTex={2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},c}var n=r(40);e.name="cross",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(t,e,r,i){if(!o(e))throw new TypeError("Second parameter in function diag must be an integer");var n=e>0?e:0,a=0>e?-e:0;switch(r.length){case 1:return l(t,e,i,r[0],a,n);case 2:return u(t,e,i,r,a,n)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function l(e,r,i,n,o,a){var s=[n+o,n+a],l=t.Matrix.storage(i||"dense"),u=l.diagonal(s,e,r);return null!==i?u:u.valueOf()}function u(t,e,r,i,n,o){if(t&&t.isMatrix===!0){var a=t.diagonal(e);return null!==r?r!==a.storage()?c(a,r):a:a.valueOf()}for(var s=Math.min(i[0]-n,i[1]-o),l=[],u=0;s>u;u++)l[u]=t[u+n][u+o];return null!==r?c(l):l}var c=i(r(52)),h=a("diag",{Array:function(t){return s(t,0,n.size(t),null)},"Array, number":function(t,e){return s(t,e,n.size(t),null)},"Array, BigNumber":function(t,e){return s(t,e.toNumber(),n.size(t),null)},"Array, string":function(t,e){return s(t,0,n.size(t),e)},"Array, number, string":function(t,e,r){return s(t,e,n.size(t),r)},"Array, BigNumber, string":function(t,e,r){return s(t,e.toNumber(),n.size(t),r)},Matrix:function(t){return s(t,0,t.size(),t.storage())},"Matrix, number":function(t,e){return s(t,e,t.size(),t.storage())},"Matrix, BigNumber":function(t,e){return s(t,e.toNumber(),t.size(),t.storage())},"Matrix, string":function(t,e){return s(t,0,t.size(),e)},"Matrix, number, string":function(t,e,r){return s(t,e,t.size(),r)},"Matrix, BigNumber, string":function(t,e,r){return s(t,e.toNumber(),t.size(),r)}});return h.toTex=void 0,h}var n=r(40),o=(r(3).clone,r(6).isInteger);e.name="diag",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e){var r=n(t),i=n(e),o=r[0];if(1!==r.length||1!==i.length)throw new RangeError("Vector expected");if(r[0]!=i[0])throw new RangeError("Vectors must have equal length ("+r[0]+" != "+i[0]+")");if(0==o)throw new RangeError("Cannot calculate the dot product of empty vectors");for(var a=0,u=0;o>u;u++)a=s(a,l(t[u],e[u]));return a}var s=i(r(51)),l=i(r(84)),u=o("dot",{"Matrix, Matrix":function(t,e){return a(t.toArray(),e.toArray())},"Matrix, Array":function(t,e){return a(t.toArray(),e)},"Array, Matrix":function(t,e){return a(t,e.toArray())},"Array, Array":a});return u.toTex={2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},u}var n=r(40).size;e.name="dot",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=a("flatten",{Array:function(t){return o(n(t))},Matrix:function(t){var e=o(n(t.toArray()));return s(e)}});return l.toTex=void 0,l}var n=r(3).clone,o=r(40).flatten;e.name="flatten",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){var i=l(e),n=i?new t.BigNumber(1):1;if(u(e),r){var a=c(r);return e.length>0?a.resize(e,n):a}var s=[];return e.length>0?o(s,e,n):s}function l(t){var e=!1;return t.forEach(function(t,r,i){t&&t.isBigNumber===!0&&(e=!0,i[r]=t.toNumber())}),e}function u(t){t.forEach(function(t){if("number"!=typeof t||!n(t)||0>t)throw new Error("Parameters in function ones must be positive integers")})}var c=i(r(52)),h=a("ones",{"":function(){return"Array"===e.matrix?s([]):s([],"default")},"...number | BigNumber | string":function(t){var r=t[t.length-1];if("string"==typeof r){var i=t.pop();return s(t,i)}return"Array"===e.matrix?s(t):s(t,"default")},Array:s,Matrix:function(t){var e=t.storage();return s(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return s(t.valueOf(),e)}});return h.toTex=void 0,h}var n=r(6).isInteger,o=r(40).resize;e.name="ones",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e){return-u(t,e)}function s(t,e,r){if(!n(e)||0>e)throw new Error("k must be a non-negative integer");if(t&&t.isMatrix){var i=t.size();if(i.length>1)throw new Error("Only one dimensional matrices supported");return l(t.valueOf(),e,r)}return Array.isArray(t)?l(t,e,r):void 0}function l(t,e,r){if(e>=t.length)throw new Error("k out of bounds");for(var i=0,n=t.length-1;n>i;){for(var o=i,a=n,s=t[Math.floor(Math.random()*(n-i+1))+i];a>o;)if(r(t[o],s)>=0){var l=t[a];t[a]=t[o],t[o]=l,--a}else++o;r(t[o],s)>0&&--o,o>=e?n=o:i=o+1}return t[e]}var u=i(r(441));return o("partitionSelect",{"Array | Matrix, number":function(t,e){return s(t,e,u)},"Array | Matrix, number, string":function(t,e,r){if("asc"===r)return s(t,e,u);if("desc"===r)return s(t,e,a);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":s})}var n=r(6).isInteger;e.name="partitionSelect",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(79)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=a("compare",{"boolean, boolean":function(t,e){return t===e?0:t>e?1:-1},"number, number":function(t,r){return t===r||n(t,r,e.epsilon)?0:t>r?1:-1},"BigNumber, BigNumber":function(r,i){return r.eq(i)||o(r,i,e.epsilon)?new t.BigNumber(0):new t.BigNumber(r.cmp(i))},"Fraction, Fraction":function(e,r){return new t.Fraction(e.compare(r))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return d(t.value,e.value)},"string, string":function(t,e){return t===e?0:t>e?1:-1},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,d);break;default:r=l(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,d,!1);break;default:r=h(t,e,d)}}return r},"Array, Array":function(t,e){return d(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return d(s(t),e)},"Matrix, Array":function(t,e){return d(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,d,!1);break;default:r=f(t,e,d,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,d,!0);break;default:r=f(e,t,d,!0)}return r},"Array, any":function(t,e){return f(s(t),e,d,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,d,!0).valueOf()}});return d.toTex=void 0,d}var n=r(6).nearlyEqual,o=r(49);e.name="compare",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,c){function h(t,e,r){if(void 0!==r){if("string"!=typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";if(1!==e.length)throw new n(e.length,1);var i=e[0];if("number"!=typeof i||!a(i))throw new TypeError("Invalid size, must contain positive integers (size: "+s(e)+")");if(t.length>i)return t.substring(0,i);if(t.length<i){for(var o=t,l=0,u=i-t.length;u>l;l++)o+=r;return o}return t}var f=i(r(52)),d=function(t,r,i){if(2!=arguments.length&&3!=arguments.length)throw new o("resize",arguments.length,2,3);if(r&&r.isMatrix===!0&&(r=r.valueOf()),r.length&&r[0]&&r[0].isBigNumber===!0&&(r=r.map(function(t){return t&&t.isBigNumber===!0?t.toNumber():t})),t&&t.isMatrix===!0)return t.resize(r,i,!0);if("string"==typeof t)return h(t,r,i);var n=Array.isArray(t)?!1:"Array"!==e.matrix;if(0==r.length){for(;Array.isArray(t);)t=t[0];return l(t)}Array.isArray(t)||(t=[t]),t=l(t);var a=u.resize(t,r,i);return n?f(a):a};return d.toTex=void 0,d}var n=r(42),o=r(11),a=r(6).isInteger,s=r(23).format,l=r(3).clone,u=r(40);e.name="resize",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(52)),s=o("size",{Matrix:function(t){return a(t.size())},Array:n.size,string:function(t){return"Array"===e.matrix?[t.length]:a([t.length])},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===e.matrix?[]:a([])}});return s.toTex=void 0,s}var n=r(40);e.name="size",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t){if("asc"===t)return c;if("desc"===t)return h;throw new Error('String "asc" or "desc" expected')}function s(t){if(1!==n(t).length)throw new Error("One dimensional array expected")}function l(t){if(1!==t.size().length)throw new Error("One dimensional matrix expected")}var u=i(r(52)),c=i(r(441)),h=function(t,e){return-c(t,e)},f=o("sort",{Array:function(t){return s(t),t.sort(c)},Matrix:function(t){return l(t),u(t.toArray().sort(c),t.storage())},"Array, function":function(t,e){return s(t),t.sort(e)},"Matrix, function":function(t,e){return l(t),u(t.toArray().sort(e),t.storage())},"Array, string":function(t,e){return s(t),t.sort(a(e))},"Matrix, string":function(t,e){return l(t),u(t.toArray().sort(a(e)),t.storage())}});return f.toTex=void 0,f}var n=r(40).size;e.name="sort",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=a("squeeze",{Array:function(t){return o.squeeze(n.clone(t))},Matrix:function(t){var e=o.squeeze(t.toArray());return Array.isArray(e)?s(e):e},any:function(t){return n.clone(t)}});return l.toTex=void 0,l}var n=r(3),o=r(40);e.name="squeeze",e.factory=i},function(t,e,r){t.exports=[r(416),r(414),r(415),r(447),r(449),r(450),r(451),r(453),r(454)]},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){var r=e.size().length,i=t.size().length;if(r>1)throw new Error("first object must be one dimensional");if(i>1)throw new Error("second object must be one dimensional");if(r!==i)throw new Error("Length of two vectors must be equal");var n=l(t);if(0===n)throw new Error("Sum of elements in first object must be non zero");var o=l(e);if(0===o)throw new Error("Sum of elements in second object must be non zero");var a=s(t,l(t)),d=s(e,l(e)),p=l(u(a,h(c(a,d))));return f(p)?p:Number.NaN}var a=i(r(52)),s=i(r(327)),l=i(r(448)),u=i(r(84)),c=i(r(369)),h=i(r(383)),f=i(r(89)),d=n("kldivergence",{"Array, Array":function(t,e){return o(a(t),a(e))},"Matrix, Array":function(t,e){return o(t,a(e))},"Array, Matrix":function(t,e){return o(a(t),e)},"Matrix, Matrix":function(t,e){return o(t,e)}});return d}e.name="kldivergence",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(r){var i=void 0;if(n(r,function(t){i=void 0===i?t:s(i,t)}),void 0===i)switch(e.number){case"number":return 0;case"BigNumber":return new t.BigNumber(0);case"Fraction":return new t.Fraction(0);default:return 0}return i}var s=i(r(53)),l=o("sum",{"Array | Matrix":function(t){return a(t)},"Array | Matrix, number | BigNumber":function(){throw new Error("sum(A, dim) is not yet supported")},"...":function(t){return a(t)}});return l.toTex=void 0,l}var n=r(322);e.name="sum",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(51)),s=i(r(84)),l=i(r(327)),u=i(r(414)),c=i(r(417)),h=i(r(379));return o("multinomial",{"Array | Matrix":function(t){var e=0,r=1;return n(t,function(t){if(!c(t)||!h(t))throw new TypeError("Positive integer value expected in function multinomial");e=a(e,t),r=s(r,u(t))}),l(u(e),r)}})}var n=r(322);e.name="multinomial",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(414)),l=a("permutations",{"number | BigNumber":s,"number, number":function(t,e){var r,i;if(!o(t)||0>t)throw new TypeError("Positive integer value expected in function permutations");if(!o(e)||0>e)throw new TypeError("Positive integer value expected in function permutations");if(e>t)throw new TypeError("second argument k must be less than or equal to first argument n");for(r=1,i=t-e+1;t>=i;i++)r*=i;return r},"BigNumber, BigNumber":function(e,r){var i,o;if(!n(e)||!n(r))throw new TypeError("Positive integer value expected in function permutations");if(r.gt(e))throw new TypeError("second argument k must be less than or equal to first argument n");for(i=new t.BigNumber(1),o=e.minus(r).plus(1);o.lte(e);o=o.plus(1))i=i.times(o);return i}});return l.toTex=void 0,l}function n(t){return t.isInteger()&&t.gte(0)}var o=r(6).isInteger;e.name="permutations",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(452)),a=o("uniform").pickRandom;return a.toTex=void 0,a}e.name="pickRandom",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,s){function l(t){if(!h.hasOwnProperty(t))throw new Error("Unknown distribution "+t);var e=Array.prototype.slice.call(arguments,1),r=h[t].apply(this,e);return function(t){var e={random:function(t,e,r){var s,l,c;if(arguments.length>3)throw new n("random",arguments.length,0,3);if(1===arguments.length?o(t)?s=t:c=t:2===arguments.length?o(t)?(s=t,c=e):(l=t,c=e):(s=t,
l=e,c=r),void 0!==l&&!a(l)||void 0!==c&&!a(c))throw new TypeError("Invalid argument in function random");if(void 0===c&&(c=1),void 0===l&&(l=0),void 0!==s){var f=h(s.valueOf(),l,c,i);return s&&s.isMatrix===!0?u(f):f}return i(l,c)},randomInt:s({"number | Array":function(t){var e=0;if(o(t)){var r=t,i=1,n=h(r.valueOf(),e,i,l);return r&&r.isMatrix===!0?u(n):n}var i=t;return l(e,i)},"number | Array, number":function(t,e){if(o(t)){var r=t,i=e,n=0,a=h(r.valueOf(),n,i,l);return r&&r.isMatrix===!0?u(a):a}var n=t,i=e;return l(n,i)},"Array, number, number":function(t,e,r){var i=h(t.valueOf(),e,r,l);return t&&t.isMatrix===!0?u(i):i}}),pickRandom:s({Array:function(t){return r(t)},"Array, number | Array":function(t,e){var i,n;if(Array.isArray(e))n=e;else{if(!a(e))throw new TypeError("Invalid argument in function pickRandom");i=e}return r(t,i,n)},"Array, number | Array, Array | number":function(t,e,i){var n,o;if(Array.isArray(e)?(o=e,n=i):(o=i,n=e),!Array.isArray(o)||!a(n))throw new TypeError("Invalid argument in function pickRandom");return r(t,n,o)}})},r=function(t,e,r){var i="undefined"==typeof e;if(i&&(e=1),t&&t.isMatrix===!0)t=t.valueOf();else if(!Array.isArray(t))throw new TypeError("Unsupported type of value in function pickRandom");if(c.size(t).length>1)throw new Error("Only one dimensional vectors supported");if("undefined"!=typeof r){if(r.length!=t.length)throw new Error("Weights must have the same length as possibles");for(var n=0,o=0,s=r.length;s>o;o++){if(!a(r[o])||r[o]<0)throw new Error("Weights must be an array of positive numbers");n+=r[o]}}var l=t.length;if(0==l)return[];if(e>=l)return t;for(var u,h=[];h.length<e;){if("undefined"==typeof r)u=t[Math.floor(Math.random()*l)];else for(var f=Math.random()*n,o=0,s=t.length;s>o;o++)if(f-=r[o],0>f){u=t[o];break}-1==h.indexOf(u)&&h.push(u)}return i?h[0]:h},i=function(e,r){return e+t()*(r-e)},l=function(e,r){return Math.floor(e+t()*(r-e))},h=function(t,e,r,i){var n,o,a=[];if(t=t.slice(0),t.length>1)for(var o=0,n=t.shift();n>o;o++)a.push(h(t,e,r,i));else for(var o=0,n=t.shift();n>o;o++)a.push(i(e,r));return a};return e}(r)}var u=i(r(52)),c=r(40),h={uniform:function(){return Math.random},normal:function(){return function(){for(var t,e,r=-1;0>r||r>1;)t=Math.random(),e=Math.random(),r=1/6*Math.pow(-2*Math.log(t),.5)*Math.cos(2*Math.PI*e)+.5;return r}}};return l.toTex=void 0,l}var n=r(11),o=r(320),a=r(6).isNumber;e.name="distribution",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(452)),a=o("uniform").random;return a.toTex=void 0,a}e.name="random",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(452)),a=o("uniform").randomInt;return a.toTex=void 0,a}e.name="randomInt",e.factory=i},function(t,e,r){t.exports=[r(441),r(456),r(88),r(64),r(352),r(60),r(457),r(458)]},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(Array.isArray(t)){if(Array.isArray(e)){var r=t.length;if(r!==e.length)return!1;for(var i=0;r>i;i++)if(!o(t[i],e[i]))return!1;return!0}return!1}return Array.isArray(e)?!1:a(t,e)}var a=i(r(88)),s=n("deepEqual",{"any, any":function(t,e){return o(t.valueOf(),e.valueOf())}});return s.toTex=void 0,s}e.name="deepEqual",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("smallerEq",{"boolean, boolean":function(t,e){return e>=t},"number, number":function(t,r){return r>=t||n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.lte(r)||o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return 1!==t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return e>=t},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,p);break;default:r=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,p,!1);break;default:r=h(t,e,p)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=f(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,p,!0);break;default:r=f(e,t,p,!0)}return r},"Array, any":function(t,e){return f(s(t),e,p,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+d.operators.smallerEq+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="smallerEq",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("unequal",{"any, any":function(t,e){return null===t?null!==e:null===e?null!==t:void 0===t?void 0!==e:void 0===e?void 0!==t:m(t,e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,m);break;default:r=l(e,t,m,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,m,!1);break;default:r=h(t,e,m)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,m,!1);break;default:r=f(t,e,m,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,m,!0);break;default:r=f(e,t,m,!0)}return r},"Array, any":function(t,e){return f(s(t),e,m,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,m,!0).valueOf()}}),m=a("_unequal",{"boolean, boolean":function(t,e){return t!==e},"number, number":function(t,r){return!n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return!o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return!t.equals(e)},"Complex, Complex":function(t,e){return!t.equals(e)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return t!==e}});return p.toTex={2:"\\left(${args[0]}"+d.operators.unequal+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="unequal",e.factory=i},function(t,e,r){t.exports=[r(460)]},function(t,e,r){"use strict";function i(t,e,r,i){function h(t){var e,r=t*t,i=l[0][4]*r,n=r;for(e=0;3>e;e+=1)i=(i+l[0][e])*r,n=(n+u[0][e])*r;return t*(i+l[0][3])/(n+u[0][3])}function f(t){var e,r=l[1][8]*t,i=t;for(e=0;7>e;e+=1)r=(r+l[1][e])*t,i=(i+u[1][e])*t;var n=(r+l[1][7])/(i+u[1][7]),o=parseInt(16*t)/16,a=(t-o)*(t+o);return Math.exp(-o*o)*Math.exp(-a)*n}function d(t){var e,r=1/(t*t),i=l[2][5]*r,n=r;for(e=0;4>e;e+=1)i=(i+l[2][e])*r,n=(n+u[2][e])*r;var o=r*(i+l[2][4])/(n+u[2][4]);o=(s-o)/t,r=parseInt(16*t)/16;var a=(t-r)*(t+r);return Math.exp(-r*r)*Math.exp(-a)*o}var p=i("erf",{number:function(t){var e=Math.abs(t);return e>=c?o(t):a>=e?o(t)*h(e):4>=e?o(t)*(1-f(e)):o(t)*(1-d(e))},BigNumber:function(e){return new t.BigNumber(p(e.toNumber()))},"Array | Matrix":function(t){return n(t,p)}});return p.toTex={1:"erf\\left(${args[0]}\\right)"},p}var n=r(19),o=r(6).sign,a=.46875,s=.5641895835477563,l=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],u=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],c=Math.pow(2,53);e.name="erf",e.factory=i},function(t,e,r){t.exports=[r(321),r(326),r(462),r(331),r(463),r(464),r(465),r(466),r(448),r(467)]},function(t,e,r){"use strict";function i(t,e,i,a){function s(t){t=n(t.valueOf());var e=t.length;if(0==e)throw new Error("Cannot calculate median of an empty array");if(e%2==0){for(var r=e/2-1,i=h(t,r+1),o=t[r],a=0;r>a;++a)c(t[a],o)>0&&(o=t[a]);return p(o,i)}var s=h(t,(e-1)/2);return d(s)}var l=i(r(53)),u=i(r(81)),c=i(r(441)),h=i(r(440)),f=a("median",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("median(A, dim) is not yet supported")},"...":function(t){if(o(t))throw new TypeError("Scalar values expected in function median");return s(t)}}),d=a({"number | BigNumber | Unit":function(t){return t}}),p=a({"number | BigNumber | Unit, number | BigNumber | Unit":function(t,e){return u(l(t,e),2)}});return f.toTex=void 0,f}var n=r(40).flatten,o=(r(323),r(324));e.name="median",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){function o(t){t=n(t.valueOf());var e=t.length;if(0==e)throw new Error("Cannot calculate mode of an empty array");var r={},i=[],o=0;for(var a in t)t[a]in r||(r[t[a]]=0),r[t[a]]++,r[t[a]]==o?i.push(t[a]):r[t[a]]>o&&(o=r[t[a]],i=[t[a]]);return i}var a=i("mode",{"Array | Matrix":o,"...":function(t){return o(t)}});return a}var n=r(40).flatten;e.name="mode",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t){var e=void 0;if(n(t,function(t){e=void 0===e?t:s(e,t)}),void 0===e)throw new Error("Cannot calculate prod of an empty array");return e}var s=i(r(80)),l=o("prod",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("prod(A, dim) is not yet supported")},"...":function(t){return a(t)}});return l.toTex=void 0,l}var n=r(322);e.name="prod",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,l){function u(e,r,i){var a,l,u;if(arguments.length<2||arguments.length>3)throw new SyntaxError("Function quantileSeq requires two or three parameters");if(s(e)){if(i=i||!1,"boolean"==typeof i){if(l=e.valueOf(),o(r)){if(0>r)throw new Error("N/prob must be non-negative");if(1>=r)return c(l,r,i);if(r>1){if(!n(r))throw new Error("N must be a positive integer");var h=r+1;a=new Array(r);for(var f=0;r>f;)a[f]=c(l,++f/h,i);return a}}if(r&&r.isBigNumber){if(r.isNegative())throw new Error("N/prob must be non-negative");if(u=new r.constructor(1),r.lte(u))return c(l,r,i);if(r.gt(u)){if(!r.isInteger())throw new Error("N must be a positive integer");var d=r.toNumber();if(d>4294967295)throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var h=new t.BigNumber(d+1);a=new Array(d);for(var f=0;d>f;)a[f]=c(l,new t.BigNumber(++f).div(h),i);return a}}if(Array.isArray(r)){a=new Array(r.length);for(var f=0;f<a.length;++f){var p=r[f];if(o(p)){if(0>p||p>1)throw new Error("Probability must be between 0 and 1, inclusive")}else{if(!p||!p.isBigNumber)throw new TypeError("Unexpected type of argument in function quantileSeq");if(u=new p.constructor(1),p.isNegative()||p.gt(u))throw new Error("Probability must be between 0 and 1, inclusive")}a[f]=c(l,p,i)}return a}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}function c(t,e,r){var i=a(t),n=i.length;if(0===n)throw new Error("Cannot calculate quantile of an empty sequence");if(o(e)){var s=e*(n-1),l=s%1;if(0===l){var u=r?i[s]:d(i,s);return m(u),u}var c,g,y=Math.floor(s);if(r)c=i[y],g=i[y+1];else{g=d(i,y+1),c=i[y];for(var v=0;y>v;++v)p(i[v],c)>0&&(c=i[v])}return m(c),m(g),h(f(c,1-l),f(g,l))}var s=e.times(n-1);if(s.isInteger()){s=s.toNumber();var u=r?i[s]:d(i,s);return m(u),u}var c,g,y=s.floor(),l=s.minus(y),E=y.toNumber();if(r)c=i[E],g=i[E+1];else{g=d(i,E+1),c=i[E];for(var v=0;E>v;++v)p(i[v],c)>0&&(c=i[v])}m(c),m(g);var w=new l.constructor(1);return h(f(c,w.minus(l)),f(g,l))}var h=i(r(51)),f=i(r(84)),d=i(r(440)),p=i(r(441)),m=l({"number | BigNumber | Unit":function(t){return t}});return u}var n=r(6).isInteger,o=r(6).isNumber,a=r(40).flatten,s=r(320);e.name="quantileSeq",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(0==t.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");return a(s.apply(null,arguments))}var a=i(r(378)),s=i(r(467)),l=n("std",{"Array | Matrix":o,"Array | Matrix, string":o,"...":function(t){return o(t)}});return l.toTex=void 0,l}e.name="std",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){var i=0,n=0;if(0==e.length)throw new SyntaxError("Function var requires one or more parameters (0 provided)");if(o(e,function(t){i=l(i,t),n++}),0===n)throw new Error("Cannot calculate var of an empty array");var a=h(i,n);switch(i=0,o(e,function(t){var e=u(t,a);i=l(i,c(e,e))}),r){case"uncorrected":return h(i,n);case"biased":return h(i,n+1);case"unbiased":var s=i&&i.isBigNumber===!0?new t.BigNumber(0):0;return 1==n?s:h(i,n-1);default:throw new Error('Unknown normalization "'+r+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}var l=i(r(53)),u=i(r(77)),c=i(r(80)),h=i(r(81)),f=a("variance",{"Array | Matrix":function(t){return s(t,n)},"Array | Matrix, string":s,"...":function(t){return s(t,n)}});return f.toTex="\\mathrm{Var}\\left(${args}\\right)",f}var n="unbiased",o=r(322);e.name="var",e.factory=i},function(t,e,r){t.exports=[r(90),r(469)]},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("print",{"string, Object":n,"string, Object, number | Object":n});return o.toTex=void 0,o}function n(t,e,r){return t.replace(/\$([\w\.]+)/g,function(t,i){for(var n=i.split("."),s=e[n.shift()];n.length&&void 0!==s;){var l=n.shift();s=l?s[l]:s+"."}return void 0!==s?o(s)?s:a(s,r):t})}var o=r(23).isString,a=r(23).format;e.name="print",e.factory=i},function(t,e,r){t.exports=[r(471),r(472),r(473),r(474),r(475),r(476),r(477),r(478),r(479),r(480),r(481),r(482),r(483),r(484),r(485),r(486),r(487),r(488),r(489),r(490),r(491),r(492),r(493),r(494),r(495)]},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acos",{number:function(r){return r>=-1&&1>=r||e.predictable?Math.acos(r):new t.Complex(r,0).acos()},Complex:function(t){return t.acos()},BigNumber:function(t){return t.acos()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\cos^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acos",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("acosh",{number:function(r){return r>=1||e.predictable?o(r):-1>=r?new t.Complex(Math.log(Math.sqrt(r*r-1)-r),Math.PI):new t.Complex(r,0).acosh()},Complex:function(t){return t.acosh()},BigNumber:function(t){return t.acosh()},"Array | Matrix":function(t){return n(t,a)}});return a.toTex={1:"\\cosh^{-1}\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.acosh||function(t){return Math.log(Math.sqrt(t*t-1)+t)};e.name="acosh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acot",{number:function(t){return Math.atan(1/t)},Complex:function(t){return t.acot()},BigNumber:function(e){return new t.BigNumber(1).div(e).atan()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\cot^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acot",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acoth",{number:function(r){return r>=1||-1>=r||e.predictable?isFinite(r)?(Math.log((r+1)/r)+Math.log(r/(r-1)))/2:0:new t.Complex(r,0).acoth()},Complex:function(t){return t.acoth()},BigNumber:function(e){return new t.BigNumber(1).div(e).atanh()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\coth^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acoth",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acsc",{number:function(r){return-1>=r||r>=1||e.predictable?Math.asin(1/r):new t.Complex(r,0).acsc()},Complex:function(t){return t.acsc()},BigNumber:function(e){return new t.BigNumber(1).div(e).asin()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\csc^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acsc",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acsch",{number:function(t){return t=1/t,Math.log(t+Math.sqrt(t*t+1))},Complex:function(t){return t.acsch()},BigNumber:function(e){return new t.BigNumber(1).div(e).asinh()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acsch",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("asec",{number:function(r){return-1>=r||r>=1||e.predictable?Math.acos(1/r):new t.Complex(r,0).asec()},Complex:function(t){return t.asec()},BigNumber:function(e){return new t.BigNumber(1).div(e).acos()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\sec^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="asec",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=(o.find(i(r(472)),["Complex"]),o("asech",{number:function(r){if(1>=r&&r>=-1||e.predictable){r=1/r;var i=Math.sqrt(r*r-1);return r>0||e.predictable?Math.log(i+r):new t.Complex(Math.log(i-r),Math.PI)}return new t.Complex(r,0).asech()},Complex:function(t){return t.asech()},BigNumber:function(e){return new t.BigNumber(1).div(e).acosh()},"Array | Matrix":function(t){return n(t,a)}}));return a.toTex={1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},a}var n=r(19);e.name="asech",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("asin",{number:function(r){return r>=-1&&1>=r||e.predictable?Math.asin(r):new t.Complex(r,0).asin()},Complex:function(t){return t.asin()},BigNumber:function(t){return t.asin()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\sin^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="asin",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("asinh",{number:Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},Complex:function(t){return t.asinh()},BigNumber:function(t){return t.asinh()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\sinh^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="asinh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("atan",{number:function(t){return Math.atan(t)},Complex:function(t){return t.atan()},BigNumber:function(t){return t.atan()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\tan^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="atan",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(370)),s=i(r(61)),l=i(r(372)),u=i(r(85)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=n("atan2",{"number, number":Math.atan2,"BigNumber, BigNumber":function(e,r){return t.BigNumber.atan2(e,r)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=l(t,e,d,!1);break;default:r=a(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":r=s(t,e,d,!1);break;default:r=h(t,e,d)}}return r},"Array, Array":function(t,e){return d(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return d(o(t),e)},"Matrix, Array":function(t,e){return d(t,o(e))},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=u(t,e,d,!1);break;default:r=f(t,e,d,!1)}return r},"number | BigNumber, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,d,!0);break;default:r=f(e,t,d,!0)}return r},"Array, number | BigNumber":function(t,e){return f(o(t),e,d,!1).valueOf()},"number | BigNumber, Array":function(t,e){return f(o(e),t,d,!0).valueOf()}});return d.toTex={2:"\\mathrm{atan2}\\left(${args}\\right)"},d}e.name="atan2",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("atanh",{number:function(r){return 1>=r&&r>=-1||e.predictable?o(r):new t.Complex(r,0).atanh()},Complex:function(t){return t.atanh()},BigNumber:function(t){return t.atanh()},"Array | Matrix":function(t){return n(t,a,!0)}});return a.toTex={1:"\\tanh^{-1}\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2};e.name="atanh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("cos",{number:Math.cos,Complex:function(t){return t.cos()},BigNumber:function(t){return t.cos()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\cos\\left(${args[0]}\\right)"},o}var n=r(19);e.name="cos",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("cosh",{number:o,Complex:function(t){return t.cosh()},BigNumber:function(t){return t.cosh()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return a(e.value)},"Array | Matrix":function(t){return n(t,a)}});return a.toTex={1:"\\cosh\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.cosh||function(t){return(Math.exp(t)+Math.exp(-t))/2};e.name="cosh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("cot",{number:function(t){return 1/Math.tan(t)},Complex:function(t){return t.cot()},BigNumber:function(e){return new t.BigNumber(1).div(e.tan())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\cot\\left(${args[0]}\\right)"},o}var n=r(19);e.name="cot",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("coth",{number:n,Complex:function(t){return t.coth()},BigNumber:function(e){return new t.BigNumber(1).div(e.tanh())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function coth is no angle");return a(e.value)},"Array | Matrix":function(t){return o(t,a)}});return a.toTex={1:"\\coth\\left(${args[0]}\\right)"},a}function n(t){var e=Math.exp(2*t);return(e+1)/(e-1)}var o=r(19);e.name="coth",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("csc",{number:function(t){return 1/Math.sin(t)},Complex:function(t){return t.csc()},BigNumber:function(e){return new t.BigNumber(1).div(e.sin())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csc is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\csc\\left(${args[0]}\\right)"},o}var n=r(19);e.name="csc",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("csch",{number:n,Complex:function(t){return t.csch()},BigNumber:function(e){return new t.BigNumber(1).div(e.sinh())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csch is no angle");return a(e.value)},"Array | Matrix":function(t){return o(t,a)}});return a.toTex={1:"\\mathrm{csch}\\left(${args[0]}\\right)"},a}function n(t){return 0==t?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(t)-Math.exp(-t)))*a(t)}var o=r(19),a=r(6).sign;e.name="csch",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("sec",{number:function(t){return 1/Math.cos(t)},Complex:function(t){return t.sec()},BigNumber:function(e){return new t.BigNumber(1).div(e.cos())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sec is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\sec\\left(${args[0]}\\right)"},o}var n=r(19);e.name="sec",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("sech",{number:n,Complex:function(t){return t.sech()},BigNumber:function(e){return new t.BigNumber(1).div(e.cosh())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sech is no angle");return a(e.value)},"Array | Matrix":function(t){return o(t,a)}});return a.toTex={1:"\\mathrm{sech}\\left(${args[0]}\\right)"},a}function n(t){return 2/(Math.exp(t)+Math.exp(-t))}var o=r(19);e.name="sech",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("sin",{number:Math.sin,Complex:function(t){return t.sin()},BigNumber:function(t){return t.sin()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\sin\\left(${args[0]}\\right)"},o}var n=r(19);e.name="sin",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("sinh",{number:o,Complex:function(t){return t.sinh()},BigNumber:function(t){return t.sinh()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return a(e.value)},"Array | Matrix":function(t){return n(t,a,!0)}});return a.toTex={1:"\\sinh\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2};e.name="sinh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("tan",{number:Math.tan,Complex:function(t){return t.tan()},BigNumber:function(t){return t.tan()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tan is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\tan\\left(${args[0]}\\right)"},o}var n=r(19);e.name="tan",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("tanh",{number:o,Complex:function(t){return t.tanh()},BigNumber:function(t){return t.tanh()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tanh is no angle");return a(e.value)},"Array | Matrix":function(t){return n(t,a,!0)}});return a.toTex={1:"\\tanh\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.tanh||function(t){var e=Math.exp(2*t);return(e-1)/(e+1)};e.name="tanh",e.factory=i},function(t,e,r){t.exports=[r(497)]},function(t,e,r){"use strict";function i(t,e,i,n){var o=r(32),a=i(r(52)),s=i(r(57)),l=i(r(58)),u=n("to",{"Unit, Unit | string":function(t,e){return t.to(e)},"Matrix, Matrix":function(t,e){return s(t,e,u)},"Array, Array":function(t,e){return u(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return u(a(t),e)},"Matrix, Array":function(t,e){return u(t,a(e))},"Matrix, any":function(t,e){return l(t,e,u,!1)},"any, Matrix":function(t,e){return l(e,t,u,!0)},"Array, any":function(t,e){return l(a(t),e,u,!1).valueOf()},"any, Array":function(t,e){return l(a(e),t,u,!0).valueOf()}});return u.toTex={2:"\\left(${args[0]}"+o.operators.to+"${args[1]}\\right)"},u}e.name="to",e.factory=i},function(t,e,r){t.exports=[r(499),r(417),r(366),r(89),r(379),r(500),r(431),r(501),r(91)]},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("clone",{any:n.clone});return o.toTex=void 0,o}var n=r(3);e.name="clone",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isPrime",{number:function(t){if(2>t)return!1;if(2==t)return!0;if(t%2==0)return!1;for(var e=3;t>=e*e;e+=2)if(t%e==0)return!1;return!0},BigNumber:function(e){if(e.lt(2))return!1;if(e.equals(2))return!0;if(e.mod(2).isZero())return!1;for(var r=t.BigNumber(3);r.times(r).lte(e);r=r.plus(1))if(e.mod(r).isZero())return!1;return!0},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);e.name="isPrime",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isNaN",{number:function(t){return Number.isNaN(t)},BigNumber:function(t){return t.isNaN()},Fraction:function(t){return!1},Complex:function(t){return Number.isNaN(t.re)&&Number.isNaN(t.im)},Unit:function(t){return Number.isNaN(t.value)},"Array | Matrix":function(t){return n(t,Number.isNaN)}});return o}var n=r(19);r(6);e.name="isNaN",e.factory=i},function(t,e,r){t.exports=[r(503)]},function(t,e){"use strict";function r(t,e,r,i){return function(e,r){var i=t[r&&r.mathjs];return i&&"function"==typeof i.fromJSON?i.fromJSON(r):r}}e.name="reviver",e.path="json",e.factory=r},function(t,e,r){"use strict";var i=r(11),n=r(42),o=r(43);t.exports=[{name:"ArgumentsError",path:"error",factory:function(){return i}},{name:"DimensionError",path:"error",factory:function(){return n}},{name:"IndexError",path:"error",factory:function(){return o}}]}])}),i("../src/scripts/util/Transformation",["./math"],function(t){var e=function(){};return e.prototype.setPoints=function(e,r){y0=[],e.forEach(function(t){y0.push(t[0],t[1])});for(var i=[[],[],[],[],[],[]],n=0;n<r.length;n++)i[0].push(r[n][0]),i[0].push(0),i[1].push(r[n][1]),i[1].push(0),i[2].push(1),i[2].push(0),i[3].push(0),i[3].push(r[n][0]),i[4].push(0),i[4].push(r[n][1]),i[5].push(0),i[5].push(1);var o=i;o=t.transpose(o);var a=t.transpose(o),s=t.multiply(a,o),l=t.inv(s),u=t.multiply(l,a),c=t.multiply(u,y0);this.a=c[0],this.b=c[1],this.c=c[2],this.d=c[3],this.e=c[4],this.f=c[5]},e.prototype.transform=function(t){var e=this.a*t[0]+this.b*t[1]+this.c,r=this.d*t[0]+this.e*t[1]+this.f;return[e,r]},e}),"undefined"!=typeof module&&(module.exports=t),t.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(t){return this._data=t,this},max:function(t){return this._max=t,this},fixedOpacity:function(t){return this._fixedOpacity=t,this},add:function(t){return this._data.push(t),this},clear:function(){return this._data=[],this},radius:function(t,e){e=void 0===e?15:e;var r=this._circle=this._createCanvas(),i=r.getContext("2d"),n=this._r=t+e;return r.width=r.height=2*n,i.shadowOffsetX=i.shadowOffsetY=2*n,i.shadowBlur=e,i.shadowColor="black",i.beginPath(),i.arc(-n,-n,t,0,2*Math.PI,!0),i.closePath(),i.fill(),this},resize:function(){this._width=this._canvas.width,this._height=this._canvas.height},gradient:function(t){var e=this._createCanvas(),r=e.getContext("2d"),i=r.createLinearGradient(0,0,0,256);e.width=1,e.height=256;for(var n in t)i.addColorStop(+n,t[n]);return r.fillStyle=i,r.fillRect(0,0,1,256),this._grad=r.getImageData(0,0,1,256).data,this},draw:function(t){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var e=this._ctx;e.clearRect(0,0,this._width,this._height);for(var r,i=0,n=this._data.length;n>i;i++)r=this._data[i],e.globalAlpha=Math.max(r[2]/this._max,void 0===t?.05:t),e.drawImage(this._circle,r[0]-this._r,r[1]-this._r);var o=e.getImageData(0,0,this._width,this._height);return this._colorize(o.data,this._grad),e.putImageData(o,0,0),this},_colorize:function(t,e){for(var r,i=0,n=t.length;n>i;i+=4)r=4*t[i+3],r&&(t[i]=e[r],t[i+1]=e[r+1],t[i+2]=e[r+2],null!=this._fixedOpacity&&(t[i+3]=this._fixedOpacity))},_createCanvas:function(){return"undefined"!=typeof document?document.createElement("canvas"):new this._canvas.constructor}},i("../src/scripts/util/simpleheat",function(){}),i("../src/scripts/util/HeatmapPanel",["./Transformation","../csvToGrid/Converter","./simpleheat"],function(e,r){var i=function(t,e,r){this.wwd=t,this.navigator=e,this.controls=r,this.myHeatmap={},this.heats={};var i=this;this.index=0,$("#loadHeatmapBtn").on("click",function(){i.requestData()})};return i.prototype.requestData=function(){$("#loading").show();var t=this,e=document.getElementById("HeatmapTxtArea").value,i=document.getElementById("HeatmapTxtDelimiter").value,n=Number(document.getElementById("latCSV").value),o=Number(document.getElementById("lonCSV").value),a=Number(document.getElementById("intensityCSV").value);try{var s=new Promise(function(t){r.loadData(e,t,i)})}catch(l){$("#loading").hide(),alert("Error occurred:"+l)}var u=[],c=[],h=1/0,f=-(1/0);s.then(function(e){$("#loading").hide(),e.forEach(function(t){var e=Number(t[n]),r=Number(t[o]);if(a){var i=Number(t[a]);isNaN(i)||(c.push(i),f=Math.max(i,f),h=Math.min(i,h))}isNaN(e)||isNaN(r)||u.push([e,r])}),c=c.map(function(t){return(t-h)/(f-h)*100}),t.addHeatmap(u,c)})},i.prototype.addHeatmap=function(e,r){var i=this,n=this.wwd,o=document.createElement("canvas"),a=n.canvas;o.width=a.width,o.height=a.height;var s=t(o);
s.points=e,s.intensities=r,s.canvas=o;var l=new WorldWind.SurfaceImage(new WorldWind.Sector(-90,90,-180,180),new WorldWind.ImageSource(o)),u=new WorldWind.RenderableLayer;this.heats[this.index]=s,u.index=this.index++,s.index=this.index,this.myHeatmap[this.index]=u,u.displayName="Heatmap",u.addRenderable(l),n.addLayer(u);var c=this.navigator;n.redraw(),i.createInterface(n),c.handleWheelEvent=function(t){this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt);var e;t.deltaMode==WheelEvent.DOM_DELTA_PIXEL?e=t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_LINE?e=40*t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_PAGE&&(e=400*t.deltaY);var r=1+2*e/1e3;this.lookAt.range*=r,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw(),i.drawHeatmap(this.lookAt.range)},this.controls.heatmap=this.drawHeatmap.bind(this),n.goTo(new WorldWind.Position(e[0][1],e[0][0]),function(){i.drawHeatmap(c.lookAt.range)})},i.prototype.drawHeatmap=function(t){var r=this.wwd,i=this.heats,n=r.canvas;for(var o in i)(i[o].canvas.height!=n.height||i[o].canvas.width!=n.width)&&(i[o].canvas.height=n.height,i[o].canvas.width=n.width);var a=r.pickTerrain(new WorldWind.Vec2(n.width/2,n.height/2));if(a.objects&&a.objects[0]){a=a.objects[0].position,t>1e7&&(t=1e7);var s=t/Math.cos(Math.PI/8),l=Math.sqrt(Math.pow(s,2)-Math.pow(t,2));l/=1e5;for(var u=a.latitude-l,c=a.latitude+l,h=a.longitude-l,f=a.longitude+l,d=n.width/n.height;d>(f-h)/(c-u);)f+=.1,h-=.1;for(;(f-h)/(c-u)>d;)c+=.1,u-=.1;var p=(f-h)/5,m=(c-u)/5,u=u-m,h=h-p,c=c+m,f=f+p,g={minLat:u,minLng:h,maxLat:c,maxLng:f};for(var o in this.myHeatmap){var y=this.myHeatmap[o];y.renderables[0].sector.minLatitude=u,y.renderables[0].sector.minLongitude=h,y.renderables[0].sector.maxLatitude=c,y.renderables[0].sector.maxLongitude=f}for(o in i){var v=i[o],E=new e;E.setPoints([[0,n.height],[0,0],[n.width,0],[n.width,n.height]],[[g.minLng,g.minLat],[g.minLng,g.maxLat],[g.maxLng,g.maxLat],[g.maxLng,g.minLat]]),v.clear(),v.points.forEach(function(t,e){if(g.minLat<=t[1]&&t[1]<=g.maxLat&&g.minLng<=t[0]&&t[0]<=g.maxLng){var r=E.transform(t),i=r[0],n=r[1],o=v.intensities[e];v.add([i,n,o])}}),v.draw(0)}for(o in this.myHeatmap)y=this.myHeatmap[o],y.renderables[0].imageSourceWasUpdated=!0}},i.prototype.createInterface=function(t){$("#HeatmapList").html("");var e=this;for(var r in e.myHeatmap){var i=e.myHeatmap[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#HeatmapList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myHeatmap[r]),t.redraw(),$(this).remove(),delete e.myHeatmap[r],delete e.heats[r]})}},i}),i("../src/scripts/LayerManager",[],function(){"use strict";var t=function(t){var e=this;this.wwd=t,this.roundGlobe=this.wwd.globe,this.createProjectionList(),$("#projectionDropdown").find(" li").on("click",function(t){e.onProjectionClick(t)}),this.synchronizeLayerList(),$("#searchBox").find("button").on("click",function(t){e.onSearchButton(t)}),this.geocoder=new WorldWind.NominatimGeocoder,this.goToAnimator=new WorldWind.GoToAnimator(this.wwd),$("#searchText").on("keypress",function(t){e.onSearchTextKeyPress($(this),t)})};return t.prototype.onProjectionClick=function(t){var e=t.target.innerText||t.target.innerHTML;$("#projectionDropdown").find("button").html(e+' <span class="caret"></span>'),"3D"===e?(this.roundGlobe||(this.roundGlobe=new WorldWind.Globe(new WorldWind.EarthElevationModel)),this.wwd.globe!==this.roundGlobe&&(this.wwd.globe=this.roundGlobe)):(this.flatGlobe||(this.flatGlobe=new WorldWind.Globe2D),"Equirectangular"===e?this.flatGlobe.projection=new WorldWind.ProjectionEquirectangular:"Mercator"===e?this.flatGlobe.projection=new WorldWind.ProjectionMercator:"North Polar"===e?this.flatGlobe.projection=new WorldWind.ProjectionPolarEquidistant("North"):"South Polar"===e?this.flatGlobe.projection=new WorldWind.ProjectionPolarEquidistant("South"):"North UPS"===e?this.flatGlobe.projection=new WorldWind.ProjectionUPS("North"):"South UPS"===e?this.flatGlobe.projection=new WorldWind.ProjectionUPS("South"):"North Gnomonic"===e?this.flatGlobe.projection=new WorldWind.ProjectionUPS("North"):"South Gnomonic"===e&&(this.flatGlobe.projection=new WorldWind.ProjectionUPS("South")),this.wwd.globe!==this.flatGlobe&&(this.wwd.globe=this.flatGlobe)),this.wwd.redraw()},t.prototype.onLayerClick=function(t){for(var e=t.text(),r=0,i=this.wwd.layers.length;i>r;r++){var n=this.wwd.layers[r];if(!n.hide&&n.displayName===e){n.enabled=!n.enabled,n.enabled?t.addClass("active"):t.removeClass("active"),this.wwd.redraw();break}}},t.prototype.synchronizeLayerList=function(){var t=$("#layerList");t.find("button").off("click"),t.find("button").remove();for(var e=0,r=this.wwd.layers.length;r>e;e++){var i=this.wwd.layers[e];if(!i.hide){var n=$('<button class="list-group-item btn btn-block">'+i.displayName+"</button>");if(t.append(n),i.showSpinner&&Spinner){var o={scale:.9},a=new Spinner(o).spin();n.append(a.el)}i.enabled?n.addClass("active"):n.removeClass("active")}}var s=this;t.find("button").on("click",function(t){s.onLayerClick($(this))})},t.prototype.createProjectionList=function(){var t=["3D","Equirectangular","Mercator","North Polar","South Polar","North UPS","South UPS","North Gnomonic","South Gnomonic"],e=$("#projectionDropdown"),r=$('<button class="btn btn-info btn-block dropdown-toggle" type="button" data-toggle="dropdown">3D<span class="caret"></span></button>');e.append(r);var i=$('<ul class="dropdown-menu">');e.append(i);for(var n=0;n<t.length;n++){var o=$("<li><a >"+t[n]+"</a></li>");i.append(o)}i=$("</ul>"),e.append(i)},t.prototype.onSearchButton=function(t){this.performSearch($("#searchText")[0].value)},t.prototype.onSearchTextKeyPress=function(t,e){13===e.keyCode&&(t.blur(),this.performSearch($("#searchText")[0].value))},t.prototype.performSearch=function(t){if(t){var e,r,i=this;if(t.match(WorldWind.WWUtil.latLonRegex)){var n=t.split(",");e=parseFloat(n[0]),r=parseFloat(n[1]),i.goToAnimator.goTo(new WorldWind.Location(e,r))}else this.geocoder.lookup(t,function(n,o){o.length>0&&(e=parseFloat(o[0].lat),r=parseFloat(o[0].lon),WorldWind.Logger.log(WorldWind.Logger.LEVEL_INFO,t+": "+e+", "+r),i.goToAnimator.goTo(new WorldWind.Location(e,r)))})}},t});var l,u,c=0;i("../src/scripts/ESTWA",["./AppConstructor","./GlobeInterface","./Globe","./Configurator","./HandlePicks","./UserInterface","./GlobeHelper","./navigator/MoveNavigator","../scripts/Controls","./util/ServersPanel","./util/GeoJSONPanel","./util/GeoTIFFPanel","../worldwind/formats/kml/KmlFile","./util/KMLPanel","./util/SurfaceImagePanel","./util/NDVIPanel","./util/HeatmapPanel","../scripts/LayerManager"],function(t,e,r,i,n,o,a,s,c,h,f,d,p,m,g,y,v,E){var w;return w=function(w){function b(t){var e=new i;if(0===A)var r=$("#csv-file").get(0).files[0];else var r=$("input[option='re1']").val();var n=new Promise(function(t){e.getConfig(r,t)});$(".timeConfig, .gridConfig, .dataConfig, .latitudeConfig, .longitudeConfig").html(""),n.then(function(e){for(var r=0;r<e.length;r++)$(".timeConfig, .gridConfig, .dataConfig, .latitudeConfig, .longitudeConfig").append($("<option></option>").attr("value",r).text(e[r]));loadConfig=!0,t&&t()}),$("#configType").show(),$("#advanced").show(),$("#start").show()}var x=new r({id:w.globe}),_=new c(x);l=new e(x),u=new t,this.GeoJSONPanel=new f(x),this.GeoTIFFPanel=new d(x),this.KMLPanel=new m(x,p),this.SurfaceImagePanel=new g(x),this.NDVIPanel=new y(x,S),this.HeatmapPanel=new v(x,l.globe.controller,_),this.serversPanel=new h(x),this.serversPanel.attachServer("http://ows.terrestris.de/osm/service?");var S=new E(x);l._navigator=new s({wwd:l.globe,zoomLevelListeners:[l.globe.redraw.bind(this)],viewPortChangedListeners:[l.globe.redraw.bind(this),u.addCsv.bind(u,l)]}),l.globe.controller.handlePanOrDrag=function(t){this.worldWindow.globe.is2D()?this.handlePanOrDrag2D(t):this.handlePanOrDrag3D(t),setTimeout(function(){u.addCsv(l)},100)},l.setUI(new o(l));var T=new n;l.UI.handlePick=T;var L=0,M=0;$("#cleanAll").click(function(){u.cleanAll(l),l.globe.layers.splice(2),$("#controls").show(),$(".afterControls").hide()}),$("#changeValues").click(function(){var t=Number($("#changeHeight").val()),e=Number($("#changeBig").val()),r=Number($("#changeStat").val());l.updateOpt([t,e,r])});var A=1;$("#fileType").change(function(){var t=$("#fileType").val();"1"==t?($("#csv-file").show(),$("#hostedFileSelector").hide(),$("#loadConfig").show(),A=0):"2"==t?($("#csv-file").hide(),$("#hostedFileSelector").show(),$("#loadConfig").show(),A=1):($("#csv-file").hide(),$("#hostedFileSelector").hide(),$("#sample").show(),A=1)});var N=1;$("#gridType").change(function(){var t=$("#gridType").val();"1"==t?($("#grid-file").show(),$("#hostedGridSelector").hide(),N=0):($("#grid-file").hide(),$("#hostedGridSelector").show(),N=1)}),$("#checkCompare").change(function(){L=$("#checkCompare").is(":checked")?1:0,l.compare=L,l.UI.resetValueFilter()}),$("input[name=optradio]").change(function(){var t=Number($("input[name=optradio]:checked","#radioButtons").val());x.eventListeners.dblclick&&x.removeEventListener("dblclick",self.handlePick);var e;if(t){l.UI.resetValueFilter(),l.makeBigDoxels(),M=1;var r=l.rect,i=l.bigVoxels.layers;e=T.getBigDoxels(r,i,x),x.addEventListener("dblclick",e),self.handlePick=e}else e=T.getDoxel(l),self.handlePick=e,x.addEventListener("dblclick",e)}),$("#autoTile").change(function(){var t=$("#autoTile").is(":checked")?1:0;l.autoTile=t}),$("#atmosphere-icon").click(function(){x.atmosphereLayer.enabled?(x.atmosphereLayer.enabled=!1,$("#atmosphere-icon").attr("style","color: #444 !important")):(x.atmosphereLayer.enabled=!0,$("#atmosphere-icon").css("color","#2f6eff")),x.redraw()}),$("#loadConfigCompare").click(function(){$("#configSelectorCompare").show(),configurator=new i;var t=$("input[option='co1']").val(),e=new Promise(function(e){configurator.getConfig(t,e)});e.then(function(t){for(var e=0;e<t.length;e++)$("#timeConfigCompare, #gridConfigCompare, #dataConfigCompare").append($("<option></option>").attr("value",e).text(t[e]))})}),$("#addData").click(function(){try{var t=1,e=$("input[option='co1']").val(),r=$("input[option='co6']").val(),i=Number($("select[option='co3']").val()),n=Number($("select[option='co4']").val()),o=$("input[option='co2']").val(),a=$("select[option='co5']").val();$(".checkCompare").show();var s={time:i,id:n,data:a,half:t,separator:o,idSeparator:r,url:e,reference:0};u.newData(s,l),$("#afterType option[value=2]").attr("disabled","disabled")}catch(c){l.UI.alert(c)}}),$("#start").click(function(){$("#loading").show();var t=$("#my-tour-id").tourbus({});t.trigger("stop"),$("#CSVButton").click();var e=0;if(0===N){var r=$("#grid-file").get(0).files[0];e=1}else var r=$("input[option='gr1']").val();if(0===A)var i=$("#csv-file").get(0).files[0];else var i=$("input[option='re1']").val();var n=Number($("select[option='re3']").val()),o=Number($("select[option='re4']").val()),s=$("input[option='re2']").val(),c=$("input[option='re6']").val(),h=$("select[option='re5']").val(),f=Number($(".latitudeConfig").val()),d=Number($(".longitudeConfig").val()),p=0,m=Number($("select[option='re8']").val()),g=Number($("input[option='re10']").val()),y=$("select[option='re9']").val(),v=$("input[option='heightExtrusion']").is(":checked")?1:0,E=$("input[option='isUrl']").is(":checked")?1:0,w=$("input[option='csvImporting']").is(":checked")?1:0,b=Number($("input[option='heightCube']").val()),x=Number($("input[option='shown']").val()),_=Number($("input[option='maxApp']").val()),S=Number($("input[option='subxy']").val()),T=Number($("input[option='subz']").val()),L=Number($("input[option='initH']").val()),M=Number($("select[option='statIndex']").val()),R=Number($("input[option='monthRange1']").val()),C=Number($("input[option='monthRange2']").val()),P=$("input[option='coverage']").val();$("#alert").css("visibility","hidden"),$("#alert").css("visibility","hidden"),$("#controls").hide(),$(".afterControls").show();var O=$("input[name='maxcolor']").val(),I=$("input[name='mincolor']").val(),k=$("input[name='midcolor']").val(),D=[a.getRGB(I),a.getRGB(k),a.getRGB(O)];$("#legendScale").css("background","linear-gradient(to bottom,"+I+" 0%,"+k+" 50%,"+O+" 100%)"),$("#legendScale").css("background","-moz-linear-gradient(to bottom,"+I+" 0%,"+k+" 50%,"+O+" 100%)"),$("#legendScale").css("background","-webkit-linear-gradient(to bottom,"+I+" 0%,"+k+" 50%,"+O+" 100%)");var V=$("input[option='refSystem']").val(),F=Number($("input[option='csvZone']").val());(w||E)&&$(".autoTile").show();var G=0;try{u.init({globe:"canvasOne",gridUrl:r,isCSV:w,csv:{csvUrl:i,zone:F,source:V,time:m,data:y,quadSub:g,delimiter:";"},config_0:{time:n,id:o,data:h,half:G,separator:s,idSeparator:c,url:i,reference:p,heightExtrusion:v,lat:f,lng:d,monthRange1:R,monthRange2:C,coverage:P},isLocal:e,isUrl:E,heightCube:b,maxShown:x,maxInApp:_,startHeight:L,sub:S,heightDim:T,autoTime:0,statIndex:M,maxDownload:2e3,colors:D},l)}catch(B){l.UI.alert(B)}}),$("#teleSample").click(function(){$("input[option='re1']").val("data/blocks.csv"),$("#loading").show();var t=new Promise(function(t){b(t)});t.then(function(){$("input[option='gr1']").val("data/grid.txt"),$("select[option='re4']").val(1),$("select[option='re3']").val(0),$("select[option='re5']").val([2,4]),$("input[option='re2']").val("."),$("input[option='re6']").val("_"),$("input[option='shown']").val(3),$("#configType").val(4),$("#configType").change(),$("#loading").hide()})}),$("#turinSample").click(function(){$("#loading").show(),$("input[option='re1']").val("data/torino.csv"),$("#loadConfig").click();var t=new Promise(function(t){b(t)});t.then(function(){$("input[option='csvImporting']").prop("checked",!0),$("select[option='re8']").val(0),$("select[option='re9']").val([1,2]),$(".latitudeConfig").val(3),$(".longitudeConfig").val(4),$("input[option='heightExtrusion']").prop("checked",!0),$("#configType").val(4),$("#configType").change(),$("#loading").hide()})}),$("#fullSample").click(function(){$("#loading").show(),$("input[option='re1']").val("data/full.csv"),$("#loadConfig").click();var t=new Promise(function(t){b(t)});t.then(function(){l.globe.navigator.longitude=14.209447413225549,l.globe.navigator.latitude=37.70978565490195,l._navigator.altitude=312535.24849800026,$("input[option='csvImporting']").prop("checked",!0),$("select[option='re8']").val(3),$("select[option='re9']").val([2]),$(".latitudeConfig").val(0),$(".longitudeConfig").val(1),$("#configType").val(4),$("#configType").change(),$("#loading").hide()})}),$("#litoSample").click(function(){$("#loading").show(),$("input[option='re1']").val("data/chalk_small.csv"),$("#loadConfig").click();var t=new Promise(function(t){b(t)});t.then(function(){$("input[option='csvImporting']").prop("checked",!0),$("select[option='re8']").val(4),$("input[option='re10']").val(4),$("select[option='re9']").val([2,3]),$(".latitudeConfig").val(1),$(".longitudeConfig").val(0),$("input[option='initH']").val(0),$("input[option='heightCube']").val(200),$("input[option='heightExtrusion']").prop("checked",!0),$("#configType").val(4),$("#configType").change(),$("#loading").hide()})}),$("#rasdaSample").click(function(){$("#loadConfig").click();var t=new Promise(function(t){$("#loading").show(),b(t)});t.then(function(){$("input[option='re1']").val("http://ows.rasdaman.org/rasdaman/ows"),$("input[option='isUrl']").prop("checked",!0),$("input[option='monthRange2']").val(1),l.globe.controller.lookAt.longitude=14.209447413225549,l.globe.controller.lookAt.latitude=37.70978565490195,l.globe.controller.lookAt.range=312535.24849800026,$("input[option='initH']").val(1e4),$("input[option='heightCube']").val(1e4),$("input[option='shown']").val(1),$(".data").val(2),$("#configType").val(4),$("#configType").change(),$("#loading").hide()})})}}),i("../main",["./src/scripts/ESTWA"],function(t){function e(){$("#CSVMenu").hide(),$("#CSVMenu").data("open",0),$("#wmsMenu").hide(),$("#wmsMenu").data("open",0),$("#HeatmapMenu").hide(),$("#HeatmapMenu").data("open",0),$("#SurfaceImageMenu").hide(),$("#SurfaceImageMenu").data("open",0),$("#geoJSONMenu").hide(),$("#geoJSONMenu").data("open",0),$("#geoJSONMenu").hide(),$("#geoJSONMenu").data("open",0),$("#geoTIFFMenu").hide(),$("#geoTIFFMenu").data("open",0),$("#geoTIFFMenu").hide(),$("#geoTIFFMenu").data("open",0),$("#KMLMenu").hide(),$("#KMLMenu").data("open",0),$("#NDVIMenu").hide(),$("#NDVIMenu").data("open",0),$("#searchMenu").hide()}new t({globe:"canvasOne"}),$("#loading").hide();var r=$("#my-tour-id").tourbus({});r.trigger("depart.tourbus"),$("#CSVButton").click(function(){var t=$("#CSVMenu").data("open");e(),t?($("#CSVMenu").hide(),$("#CSVMenu").data("open",0)):($("#CSVMenu").show(),$("#CSVMenu").data("open",1))}),$("#wmsButton").click(function(){var t=$("#wmsMenu").data("open");e(),t?($("#wmsMenu").hide(),$("#wmsMenu").data("open",0)):($("#wmsMenu").show(),$("#wmsMenu").data("open",1))}),$("#geoJSONButton").click(function(){var t=$("#geoJSONMenu").data("open");e(),t?($("#geoJSONMenu").hide(),$("#geoJSONMenu").data("open",0)):($("#geoJSONMenu").show(),$("#geoJSONMenu").data("open",1))}),$("#geoTIFFButton").click(function(){var t=$("#geoTIFFMenu").data("open");e(),t?($("#geoTIFFMenu").hide(),$("#geoTIFFMenu").data("open",0)):($("#geoTIFFMenu").show(),$("#geoTIFFMenu").data("open",1))}),$("#KMLButton").click(function(){var t=$("#KMLMenu").data("open");e(),t?($("#KMLMenu").hide(),$("#KMLMenu").data("open",0)):($("#KMLMenu").show(),$("#KMLMenu").data("open",1))}),$("#SurfaceImageButton").click(function(){var t=$("#SurfaceImageMenu").data("open");e(),t?($("#SurfaceImageMenu").hide(),$("#SurfaceImageMenu").data("open",0)):($("#SurfaceImageMenu").show(),$("#SurfaceImageMenu").data("open",1))}),$("#HeatmapButton").click(function(){var t=$("#HeatmapMenu").data("open");e(),t?($("#HeatmapMenu").hide(),$("#HeatmapMenu").data("open",0)):($("#HeatmapMenu").show(),$("#HeatmapMenu").data("open",1))}),$("#searchBoxButton").click(function(){var t=$("#searchMenu").data("open");e(),t?($("#searchMenu").hide(),$("#searchMenu").data("open",0)):($("#searchMenu").show(),$("#searchMenu").data("open",1))}),$("#NDVIButton").click(function(){var t=$("#NDVIMenu").data("open");e(),t?($("#NDVIMenu").hide(),$("#NDVIMenu").data("open",0)):($("#NDVIMenu").show(),$("#NDVIMenu").data("open",1))}),$("#hideStatistics").click(function(){$("#bottomMenu").hide()}),$("input[option='heightExtrusion']").change(function(){var t=$("input[option='heightExtrusion']").is(":checked")?1:0,e=$("select[option='re5']").val();return e.length<2?(l.UI.alert("Error: At least two Data values must be selected to apply the extrusion"),void $("input[option='heightExtrusion']").prop("checked",!1)):void(t?($("input[option='shown']").val(1),$("input[option='shown']").attr("disabled",!0)):$("input[option='shown']").attr("disabled",!1))}),$("#configType").change(function(){var t=$("#configType option:selected").val();1==t&&($("#configSelector").show(),$("#CSVOptions").hide(),$("#dbOptions").hide(),$("#advancedOptions").hide()),2==t&&($("#configSelector").hide(),$("#CSVOptions").show(),$("#dbOptions").hide(),$("#advancedOptions").hide()),3==t&&($("#configSelector").hide(),$("#CSVOptions").hide(),$("#dbOptions").show(),$("#advancedOptions").hide()),4==t&&($("#configSelector").hide(),$("#CSVOptions").hide(),$("#dbOptions").hide(),$("#advancedOptions").show())}),$("#afterType").change(function(){var t=$("#afterType option:selected").val();0==t&&($("#sliders").show(),$("#updateSettings").hide(),$("#compareOptions").hide()),1==t&&($("#sliders").hide(),$("#updateSettings").show(),$("#compareOptions").hide()),2==t&&($("#sliders").hide(),$("#updateSettings").hide(),$("#compareOptions").show())})}),r(["../main"])});