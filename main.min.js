!function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):t.WorldWind=e()}(this,function(){function simpleheat(t){return this instanceof simpleheat?(this._canvas=t="string"==typeof t?document.getElementById(t):t,this._ctx=t.getContext("2d"),this._width=t.width,this._height=t.height,this._max=1,this._fixedOpacity=null,void(this._data=[])):new simpleheat(t)}var requirejs,require,define;!function(t){function e(t,e){return y.call(t,e)}function r(t,e){var r,i,n,o,a,s,l,u,c,h,f,d=e&&e.split("/"),p=g.map,m=p&&p["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),a=t.length-1,g.nodeIdCompat&&b.test(t[a])&&(t[a]=t[a].replace(b,"")),t=d.concat(t),c=0;c<t.length;c+=1)if(f=t[c],"."===f)t.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||m)&&p){for(r=t.split("/"),c=r.length;c>0;c-=1){if(i=r.slice(0,c).join("/"),d)for(h=d.length;h>0;h-=1)if(n=p[d.slice(0,h).join("/")],n&&(n=n[i])){o=n,s=c;break}if(o)break;!l&&m&&m[i]&&(l=m[i],u=c)}!o&&l&&(o=l,s=u),o&&(r.splice(0,s,o),t=r.join("/"))}return t}function i(e,r){return function(){var i=v.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),c.apply(t,i.concat([e,r]))}}function n(t){return function(e){return r(e,t)}}function o(t){return function(e){d[t]=e}}function a(r){if(e(p,r)){var i=p[r];delete p[r],m[r]=!0,u.apply(t,i)}if(!e(d,r)&&!e(m,r))throw new Error("No "+r);return d[r]}function s(t){var e,r=t?t.indexOf("!"):-1;return r>-1&&(e=t.substring(0,r),t=t.substring(r+1,t.length)),[e,t]}function l(t){return function(){return g&&g.config&&g.config[t]||{}}}var u,c,h,f,d={},p={},g={},m={},y=Object.prototype.hasOwnProperty,v=[].slice,b=/\.js$/;h=function(t,e){var i,o=s(t),l=o[0];return t=o[1],l&&(l=r(l,e),i=a(l)),l?t=i&&i.normalize?i.normalize(t,n(e)):r(t,e):(t=r(t,e),o=s(t),l=o[0],t=o[1],l&&(i=a(l))),{f:l?l+"!"+t:t,n:t,pr:l,p:i}},f={require:function(t){return i(t)},exports:function(t){var e=d[t];return"undefined"!=typeof e?e:d[t]={}},module:function(t){return{id:t,uri:"",exports:d[t],config:l(t)}}},u=function(r,n,s,l){var u,c,g,y,v,b,E=[],w=typeof s;if(l=l||r,"undefined"===w||"function"===w){for(n=!n.length&&s.length?["require","exports","module"]:n,v=0;v<n.length;v+=1)if(y=h(n[v],l),c=y.f,"require"===c)E[v]=f.require(r);else if("exports"===c)E[v]=f.exports(r),b=!0;else if("module"===c)u=E[v]=f.module(r);else if(e(d,c)||e(p,c)||e(m,c))E[v]=a(c);else{if(!y.p)throw new Error(r+" missing "+c);y.p.load(y.n,i(l,!0),o(c),{}),E[v]=d[c]}g=s?s.apply(d[r],E):void 0,r&&(u&&u.exports!==t&&u.exports!==d[r]?d[r]=u.exports:g===t&&b||(d[r]=g))}else r&&(d[r]=s)},requirejs=require=c=function(e,r,i,n,o){if("string"==typeof e)return f[e]?f[e](r):a(h(e,r).f);if(!e.splice){if(g=e,g.deps&&c(g.deps,g.callback),!r)return;r.splice?(e=r,r=i,i=null):e=t}return r=r||function(){},"function"==typeof i&&(i=n,n=o),n?u(t,e,r,i):setTimeout(function(){u(t,e,r,i)},4),c},c.config=function(t){return c(t)},requirejs._defined=d,define=function(t,r,i){r.splice||(i=r,r=[]),e(d,t)||e(p,t)||(p[t]=[t,r,i])},define.amd={jQuery:!0}}(),define("../tools/almond",function(){}),define("scripts/DataLoader",[],function(){var t=function(t){};return t.prototype.getData=function(e,r,i){var n=this,o=0;Papa.parse(e,{worker:!1,download:!0,preview:2e4,fastMode:!0,complete:function(e){if(!o){o=1;var a=t.removeEmpty(e.data);return a.bounds=n.getDataBounds(a,i,0),i.heightExtrusion&&(a.bounds1=n.getDataBounds(a,i,1)),r(a),1}}})},t.removeEmpty=function(t){return""!=t[t.length-1]&&void 0!=t[t.length-1]||t.splice(t.length-1),t},t.prototype.getDataBounds=function(t,e,r){for(var i,n=-(1/0),o=1/0,a=0;a<t.length;a++)i=t[a],i[e.data[0]].indexOf(e.separator)!==-1&&(n=Math.max(n,i[e.data[r]].split(e.separator).join("")),o=Math.min(o,i[e.data[r]].split(e.separator).join("")));return[n,o]},t}),define("scripts/GlobeHelper",[],function(){var t=t||{};return t.getCoords=function(t){var e={};return e[0]={},e[0].lat=t._boundaries[0].latitude,e[0].lng=t._boundaries[0].longitude,e[1]={},e[1].lat=t._boundaries[1].latitude,e[1].lng=t._boundaries[1].longitude,e[2]={},e[2].lat=t._boundaries[2].latitude,e[2].lng=t._boundaries[2].longitude,e[3]={},e[3].lat=t._boundaries[3].latitude,e[3].lng=t._boundaries[3].longitude,e},t.getMaxTile=function(){return Number($("#maxTile").val())},t.clean=function(t,e,r,i){var n;if(r&&i.removeLayer(r),t)for(n in t)i.removeLayer(t[n]);if(e)for(n in e)i.removeLayer(e[n])},t.getStatistics=function(t,e,r,i,n,o,a){for(var s=0,l=0,u=0,c=0,h=0,f=-(1/0),d=0,p=0;p<t.cubes.length;p++)if(t.cubes[p].heightLayer==e){c+=1;var g;if(o[a].idSeparator){var m=t.cubes[p].id.split(o[a].idSeparator).length/3;g=1/m}else g=1;l+=g,s+=Number(t.cubes[p].data[a]*g),u+=Number(t.cubes[p].data),f=Math.max(f,Number(t.cubes[p].data[a])),h=Math.min(h,Number(t.cubes[p].data[a]))}var y;switch(i){case 0:y=s/l;break;case 1:y=u/c;break;case 2:var v=u/c,b=0;for(p=0;p<t.cubes.length;p++)if(t.cubes[p].heightLayer==e){var E=t.cubes[p].data[a];b+=(E-v)*(E-v)}b/=c-1,y=Math.sqrt(b);break;case 3:d=Math.ceil(c/2),y=t.cubes[d].data[a];break;case 4:y=f;break;case 5:y=h;break;default:y=s/l}var w=r.bounds[0],_=r.bounds[1],x=this.getColor((y-_)/(w-_)*100,n);return[x,y]},t.getRGB=function(t){t="#"==t.charAt(0)?t.substring(1,7):t;var e=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16);return[e,r,i]},t.getColor=function(t,e){var r,i=[];t<50?(i[1]=e[0],i[0]=e[1],r=t/50):(i[1]=e[1],i[0]=e[2],r=(t-50)/50);var n=2*r-1,o=(n/1+1)/2,a=1-o,s=[Math.round(i[0][0]*o+i[1][0]*a),Math.round(i[0][1]*o+i[1][1]*a),Math.round(i[0][2]*o+i[1][2]*a)];return[s[0],s[1],s[2],255]},t.toTime=function(t){var e=new Date(0);try{e.setMilliseconds(Number(t+"000")),t=e.toLocaleDateString()+" "+e.toLocaleTimeString()}catch(e){t=0}return t},t}),define("scripts/csvToGrid/CSVReader",[],function(){var t=t||{};return t.getData=function(e,r,i){Papa.parse(e,{download:!0,delimiter:i,complete:function(e){var i=t.removeEmpty(e.data);r(i)}})},t.removeEmpty=function(t){return""!=t[t.length-1]&&void 0!=t[t.length-1]||t.splice(t.length-1),t},t});var quad;define("scripts/csvToGrid/Converter",["./CSVReader"],function(t){var e=e||{};return e.loadData=function(e,r,i){t.getData(e,r,i)},e.filterData=function(t,e,r,i){i||(i=4e4);var n=[],o=r._bottom,a=r._top,s=r._left,l=r._right;return t.forEach(function(t){Number(t[e.lat])<=a&&Number(t[e.lat])>=o&&Number(t[e.lng])>=s&&Number(t[e.lng])<=l&&n.length<i&&n.push(t)}),n},e.initData=function(t,e,r){var i=this.parseData(t,e,r);return i},e.getDataBounds=function(t,e,r){for(var i,n=-(1/0),o=1/0,a=1;a<t.length;a++)i=t[a],isNaN(i[e.data[0]])&&i[e.data[0]].indexOf(e.separator)!==-1?isNaN(n)||isNaN(o)||(n=Math.max(n,Number(i[e.data[r]].split(e.separator).join(""))),o=Math.min(o,Number(i[e.data[r]].split(e.separator).join("")))):isNaN(n)||isNaN(o)||(n=Math.max(n,i[e.data[r]]),o=Math.min(o,i[e.data[r]]));return[n,o]},e.initJson=function(t,e,r,i){var n=Math.floor(t.positions.length/2),o=Number(t.positions[n][1]),a=Number(t.positions[n][0]);e=Math.floor((o+180)/6)+1,a>=56&&a<64&&o>=3&&o<12&&(e=32),a>=72&&a<84&&(o>=0&&o<9?e=31:o>=9&&o<21?e=33:o>=21&&o<33?e=35:o>=33&&o<42&&(e=37));var s=this.getCoordinatesBoundaries(t.positions),s=this.convertBounds(s,e,i),l=this.getPoints(t.positions,e,i);minPoint=s[0],maxPoint=s[1],sizeW=maxPoint[0]-minPoint[0],sizeH=maxPoint[1]-minPoint[1];var u=!0,c={x:minPoint[0],y:minPoint[1],width:sizeW,height:sizeH};quad=new QuadTree(c,u,r,1),quad=this.insertData(quad,l);var h=this.getJson(quad,e,i);return h},e.setGridtoData=function(t,e,r){t=JSON.parse(t);for(var i in e)for(var n=e[i].length,o=0;o<n;o++)for(var a=e[i][o].length,s=0;s<a;s++)for(var l=t.features.length,u=0;u<l;u++){var c=e[i][o][s],h=t.features[u],f=[h.properties.lat,h.properties.lng];if(0!==f[0]&&0!==f[1]){var d=[Number(c[r.data.length+1][0]),Number(c[r.data.length+1][1])];f[0]==d[0]&&f[1]==d[1]&&(c[0]=h.properties.id)}}return e},e.parseData=function(t,e,r){for(var i=[],n={},o=t.length,a=[],s=0;s<o;s++){var l=t[s];i.indexOf(l[e.time])==-1&&i.push(l[e.time]),n[l[e.time]]||(n[l[e.time]]=[]),n[l[e.time]][r]||(n[l[e.time]][r]=[]);var u=[l[e.lat],l[e.lng]],c=[],h=[];h.length<1&&(c.push(-1),a.push(u));for(var f in e.data)c.push(l[e.data[f]]);c.push(u),n[l[e.time]][r].push(c)}var d={allTime:i,positions:a,times:n};return d},e.insertData=function(t,e){var r,i,o={};for(i=0,n=e.length;i<n;i++){var a=e[i];0!=a[0]&&(o[a[0]+" - "+a[1]]=a)}var i=0,s=[];for(var a in o)s[i++]=o[a];for(r in o)t.insert({x:o[r][0],y:o[r][1],width:10,height:10,coords:[o[r].coord[0],o[r].coord[1]]});return t},e.getPoints=function(t,e,r){var i=[];r=r||"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs";for(var n=0;n<t.length;n++){var o=t[n][0],a=t[n][1];o=Number(o),a=Number(a),i[n]=[a,o],i[n].coord=[o,a]}return i},e.convertBounds=function(t,e,r){var i=t[0],n=t[1],o=t[2],a=t[3],s=[n,i],l=[a,o];return[s,l]},e.getJson=function(t,e,r){var i={type:"FeatureCollection",features:[]},n=[];0==t.root.children.length&&t.root.nodes.length>0?n=this.explore(t.root,n):n.push([t.root._bounds,[0,0]]);r=r||"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs";for(var o=0,a=0;a<n.length;a++){var s=this.newFeature();s.properties.id=a,s.properties.lat=n[a][1][0],s.properties.lng=n[a][1][1],i.features.push(s);var l=n[a][0],u=[];u[0]=u[4]=[l.x,l.y],u[1]=[l.x+l.width,l.y],u[2]=[l.x+l.width,l.y+l.height],u[3]=[l.x,l.y+l.height];for(var c=0;c<u.length;c++)i.features[o].geometry.coordinates[0].push([u[c][0],u[c][1]]);o++}return i},e.newFeature=function(){return{type:"Feature",properties:{id:"gridBound"},geometry:{type:"Polygon",coordinates:[[]]}}},e.explore=function(t,e){if(0==t.children.length&&t.nodes.length>0)for(var r=0;r<t.nodes.length;r++)e=this.explore(t.nodes[r],e);else 0==t.children.length?e.push([t._bounds,[0,0]]):e.push([t._bounds,t.children[0].coords]);return e},e.getCoordinatesBoundaries=function(t,e){for(var r=-(1/0),i=-(1/0),n=1/0,o=1/0,a=0;a<t.length;a++){if(e)var s=t[a][e.lat],l=t[a][e.lng];else var s=t[a][0],l=t[a][1];s=Number(s),l=Number(l),s&&l&&(n=Math.min(n,s),o=Math.min(o,l),r=Math.max(r,s),i=Math.max(i,l))}return[n,o,r,i]},e}),define("worldwind/error/AbstractError",[],function(){"use strict";var t=function(t,e){this.name=t,this.message=e};return t.prototype.toString=function(){var t=this.name+": "+this.message;return this.stack&&(t+="\n"+this.stack.toString()),t},t}),define("worldwind/geom/Angle",[],function(){"use strict";var t={DEGREES_TO_RADIANS:Math.PI/180,RADIANS_TO_DEGREES:180/Math.PI,TWO_PI:2*Math.PI,HALF_PI:Math.PI/2,normalizedDegrees:function(t){var e=t%360;return e>180?e-360:e<-180?360+e:e},normalizedDegreesLatitude:function(t){var e=t%180;return e>90?180-e:e<-90?-180-e:e},normalizedDegreesLongitude:function(t){var e=t%360;return e>180?e-360:e<-180?360+e:e},normalizedRadians:function(t){var e=t%this.TWO_PI;return e>Math.PI?e-this.TWO_PI:e<-Math.PI?this.TWO_PI+e:e},normalizedRadiansLatitude:function(t){var e=t%Math.PI;return e>this.HALF_PI?Math.PI-e:e<-this.HALF_PI?-Math.PI-e:e},normalizedRadiansLongitude:function(t){var e=t%this.TWO_PI;return e>Math.PI?e-this.TWO_PI:e<-Math.PI?this.TWO_PI+e:e},isValidLatitude:function(t){return t>=-90&&t<=90},isValidLongitude:function(t){return t>=-180&&t<=180},toString:function(t){return t.toString()+"°"},toDecimalDegreesString:function(t){return t.toString()+"°"},toDMSString:function(t){var e,r,i,n,o;return e=t<0?-1:1,r=e*t,i=Math.floor(r),r=60*(r-i),n=Math.floor(r),r=60*(r-n),o=Math.round(r),60==o&&(n++,o=0),60==n&&(i++,n=0),(e==-1?"-":"")+i+"° "+n+"’ "+o+"”"},toDMString:function(t){var e,r,i,n,o,a;return e=t<0?-1:1,r=e*t,i=Math.floor(r),r=60*(r-i),n=Math.floor(r),r=60*(r-n),o=Math.round(r),60==o&&(n++,o=0),60==n&&(i++,n=0),a=0==o?n:n+o/60,(e==-1?"-":"")+i+"° "+a+"’"}};return t}),define("worldwind/util/Logger",[],function(){"use strict";var t={LEVEL_NONE:0,LEVEL_SEVERE:1,LEVEL_WARNING:2,LEVEL_INFO:3,setLoggingLevel:function(t){e=t},getLoggingLevel:function(){return e},log:function(r,i){i&&r>0&&r<=e&&(r===t.LEVEL_SEVERE?console.error(i):r===t.LEVEL_WARNING?console.warn(i):r===t.LEVEL_INFO?console.info(i):console.log(i))},makeMessage:function(t,e,r){var i=this.messageTable[r]?this.messageTable[r]:r;return t+"."+e+": "+i},logMessage:function(t,e,r,i){var n=this.makeMessage(e,r,i);return this.log(t,n),n},messageTable:{abstractInvocation:"The function called is abstract and must be overridden in a subclass.",indexOutOfRange:"The specified index is out of range.",invalidHeight:"The specified height is zero or negative.",invalidWidth:"The specified width is zero or negative.",invalidSize:"The specified size is zero or negative.",missingAltitudeMode:"The specified altitude mode is null or undefined.",missingAttributeName:"The specified DBase attribute file name is null or undefined.",missingArray:"The specified array is null, undefined or of insufficient length.",missingBoundaries:"The specified boundaries array is null or undefined.",missingBuffer:"The specified buffer descriptor is null or undefined.",missingColor:"The specified color is null or undefined.",missingDc:"The specified draw context is null or undefined.",missingDomElement:"The specified DOM element is null or undefined.",missingEntry:"The specified entry is null or undefined.",missingFont:"The specified font is null or undefined.",missingFrustum:"The specified frustum is null or undefined.",missingFunction:"The specified function is null or undefined.",missingGlContext:"The specified WebGL rendering context is null or undefined.",missingGlobe:"The specified globe is null or undefined.",missingImage:"The specified image is null or undefined.",missingIndices:"The specified indices array is null or undefined.",missingKey:"The specified key is null or undefined.",missingLevel:"The specified level is null or undefined.",missingLine:"The specified line is null or undefined.",missingList:"The specified list is null or undefined.",missingListener:"The specified listener is null or undefined",missingLocation:"The specified location is null or undefined.",missingMatrix:"The specified matrix is null or undefined.",missingNavigatorState:"The specified navigator state is null or undefined.",missingOffset:"The specified offset is null or undefined.",missingPath:"The specified path is null or undefined.",missingPlacename:"The specified place name is null or undefined.",missingPlane:"The specified plane is null or undefined.",missingPoint:"The specified point is null or undefined.",missingPoints:"The specified points array is null or undefined.",missingPosition:"The specified position is null or undefined.",missingPositions:"The specified positions array is null or undefined.",missingProgram:"The specified program is null or undefined.",missingProjection:"The specified projection is null or undefined.",missingRectangle:"The specified rectangle is null or undefined.",missingRenderable:"The specified renderable is null or undefined.",missingResource:"The specified resource is null or undefined.",missingResult:"The specified result variable is null or undefined.",missingResults:"The specified results array is null or undefined.",missingSector:"The specified sector is null or undefined.",missingShapeType:"The specified shape type is null or undefined.",missingSize:"The specified size is null or undefined.",missingText:"The specified text is null or undefined.",missingTexture:"The specified texture is null or undefined.",missingTile:"The specified tile is null or undefined.",missingType:"The specified type is null or undefined.",missingUrl:"The specified URL is null or undefined",missingVector:"The specified vector is null or undefined.",missingVertex:"The specified vertex is null or undefined.",missingViewport:"The specified viewport is null or undefined.",missingWorldWindow:"The specified World Window is null or undefined.",notYetImplemented:"This function is not yet implemented"}},e=1;return t}),define("worldwind/util/Color",["../util/Logger"],function(t){"use strict";var e=function(t,e,r,i){this.red=t,this.green=e,this.blue=r,this.alpha=i};return e.WHITE=new e(1,1,1,1),e.BLACK=new e(0,0,0,1),e.RED=new e(1,0,0,1),e.GREEN=new e(0,1,0,1),e.BLUE=new e(0,0,1,1),e.CYAN=new e(0,1,1,1),e.YELLOW=new e(1,1,0,1),e.MAGENTA=new e(1,0,1,1),e.LIGHT_GRAY=new e(.75,.75,.75,1),e.MEDIUM_GRAY=new e(.5,.5,.5,1),e.DARK_GRAY=new e(.25,.25,.25,1),e.TRANSPARENT=new e(0,0,0,0),e.prototype.set=function(t,e,r,i){return this.red=t,this.green=e,this.blue=r,this.alpha=i,this},e.prototype.copy=function(e){if(!e)throw new ArgumentError(t.logMessage(t.LEVEL_SEVERE,"Color","copy","missingColor"));return this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha,this},e.prototype.clone=function(){return new e(this.red,this.green,this.blue,this.alpha)},e.prototype.premultipliedComponents=function(t){var e=this.alpha;return t[0]=this.red*e,t[1]=this.green*e,t[2]=this.blue*e,t[3]=e,t},e.colorFromByteArray=function(t){return new e(t[0]/255,t[1]/255,t[2]/255,t[3]/255)},e.colorFromBytes=function(t,r,i,n){return new e(t/255,r/255,i/255,n/255)},e.colorFromHex=function(t){var r=parseInt(t.substring(0,2),16),i=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16),o=parseInt(t.substring(6,8),16);return e.colorFromBytes(r,i,n,o)},e.colorFromKmlHex=function(t){var r=parseInt(t.substring(0,2),16),i=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16),o=parseInt(t.substring(6,8),16);return e.colorFromBytes(o,n,i,r)},e.prototype.nextColor=function(){var t=Math.round(255*this.red),e=Math.round(255*this.green),r=Math.round(255*this.blue);return t<255?this.red=(t+1)/255:e<255?(this.red=0,this.green=(e+1)/255):r<255?(this.red=0,this.green=0,this.blue=(r+1)/255):(this.red=1/255,this.green=0,this.blue=0),this},e.prototype.equals=function(t){var e=Math.round(255*this.red),r=Math.round(255*this.green),i=Math.round(255*this.blue),n=Math.round(255*this.alpha),o=Math.round(255*t.red),a=Math.round(255*t.green),s=Math.round(255*t.blue),l=Math.round(255*t.alpha);return e===o&&r===a&&i===s&&n===l},e.prototype.equalsBytes=function(t){var e=Math.round(255*this.red),r=Math.round(255*this.green),i=Math.round(255*this.blue),n=Math.round(255*this.alpha);return e===t[0]&&r===t[1]&&i===t[2]&&n===t[3]},e.prototype.toByteString=function(){var t=Math.round(255*this.red),e=Math.round(255*this.green),r=Math.round(255*this.blue),i=Math.round(255*this.alpha);return"("+t+","+e+","+r+","+i+")"},e.prototype.toHexString=function(t){var e=Math.ceil(255*this.red).toString(16),r=Math.ceil(255*this.green).toString(16),i=Math.ceil(255*this.blue).toString(16),n=Math.ceil(255*this.alpha).toString(16),o="#";return o+=e.length<2?"0"+e:e,o+=r.length<2?"0"+r:r,o+=i.length<2?"0"+i:i,t&&(o+=n.length<2?"0"+n:n),o},e.prototype.toRGBAString=function(){var t=Math.floor(255*this.red),e=Math.floor(255*this.green),r=Math.floor(255*this.blue);return"rgba("+t+" ,"+e+" ,"+r+" ,"+this.alpha+")"},e}),define("worldwind/error/ArgumentError",["../error/AbstractError"],function(t){"use strict";var e=function(e){t.call(this,"ArgumentError",e);var r;try{throw new Error}catch(t){r=t.stack}this.stack=r};return e.prototype=Object.create(t.prototype),e}),define("worldwind/util/Font",["../error/ArgumentError","../util/Color","../util/Logger"],function(t,e,r){"use strict";var i=function(e,i,n,o,a,s){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Font","constructor","missingSize"));if(e<=0)throw new t(r.logMessage(r.LEVEL_SEVERE,"Font","constructor","invalidSize"));this._size=e,this.style=i||"normal",this.variant=n||"normal",this.weight=o||"normal",this.family=a||"sans-serif",this.horizontalAlignment=s||"center"};return Object.defineProperties(i.prototype,{size:{get:function(){return this._size},set:function(t){this._fontString=null,this._size=t}},style:{get:function(){return this._style},set:function(t){this._fontString=null,this._style=t}},variant:{get:function(){return this._variant},set:function(t){this._fontString=null,this._variant=t}},weight:{get:function(){return this._weight},set:function(t){this._fontString=null,this._weight=t}},family:{get:function(){return this._family},set:function(t){this._fontString=null,this._family=t}},horizontalAlignment:{get:function(){return this._horizontalAlignment},set:function(t){this._toString=null,this._horizontalAlignment=t}},fontString:{get:function(){return this._fontString||(this._fontString=this._style+" "+this.variant+" "+this._weight+" "+this._size.toString()+"px "+this._family),this._fontString}}}),i.prototype.toString=function(){return this._toString&&this._fontString||(this._toString=this.fontString+" "+this.horizontalAlignment),this._toString},i}),define("worldwind/util/Insets",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i,n,o){if(4!==arguments.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"Insets","constructor","invalidArgumentCount"));this._top=r,this._left=i,this._bottom=n,this._right=o};return r.prototype.set=function(t,e,r,i){this._top=t,this._left=e,this._bottom=r,this._right=i},r.prototype.clone=function(){return new r(this._top,this._left,this._bottom,this._right)},r.prototype.toString=function(){return this._top+" "+this._left+" "+this._bottom+" "+this._right},Object.defineProperties(r.prototype,{top:{get:function(){return this._top},set:function(t){this._top=t}},left:{get:function(){return this._left},set:function(t){this._left=t}},bottom:{get:function(){return this._bottom},set:function(t){this._bottom=t}},right:{get:function(){return this._right},set:function(t){this._right=t}}}),r}),define("worldwind/geom/Vec3",["../util/Logger","../error/ArgumentError"],function(t,e){"use strict";var r=function(t,e,r){this[0]=t,this[1]=e,this[2]=r};return r.prototype=new Float64Array(3),r.ZERO=new r(0,0,0),r.average=function(r,i){if(!r||r.length<1)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","average","missingArray"));if(!i)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","average","missingResult"));var n,o=r.length;i[0]=0,i[1]=0,i[2]=0;for(var a=0,s=r.length;a<s;a++)n=r[a],i[0]+=n[0]/o,i[1]+=n[1]/o,i[2]+=n[2]/o;return i},r.averageOfBuffer=function(r,i){if(!r||r.length<1)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","averageBuffer","missingArray"));if(!i)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","averageBuffer","missingResult"));var n=r.length/3;i[0]=0,i[1]=0,i[2]=0;for(var o=0;o<n;o++)i[0]+=r[3*o]/n,i[1]+=r[3*o+1]/n,i[2]+=r[3*o+2]/n;return i},r.areColinear=function(i,n,o){if(!i||!n||!o)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","areColinear","missingVector"));var a=new r(i[0]-n[0],i[1]-n[1],i[2]-n[2]).normalize(),s=new r(o[0]-n[0],o[1]-n[1],o[2]-n[2]).normalize();return Math.abs(a.dot(s))>.999},r.computeTriangleNormal=function(i,n,o){if(!i||!n||!o)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","areColinear","missingVector"));var a=(n[1]-i[1])*(o[2]-i[2])-(n[2]-i[2])*(o[1]-i[1]),s=(n[2]-i[2])*(o[0]-i[0])-(n[0]-i[0])*(o[2]-i[2]),l=(n[0]-i[0])*(o[1]-i[1])-(n[1]-i[1])*(o[0]-i[0]),u=a*a+s*s+l*l;return 0===u?new r(a,s,l):(u=Math.sqrt(u),new r(a/u,s/u,l/u))},r.findThreeIndependentVertices=function(t,e){var i=e&&e>0?e:3;if(!t||t.length<3*i)return null;for(var n=new r(t[0],t[1],t[2]),o=null,a=null,s=i;s<t.length&&(o=new r(t[s],t[s+1],t[s+2]),o[0]===n[0]&&o[1]===n[1]&&o[2]===n[2]);s+=i)o=null;if(!o)return null;for(s+=i;s<t.length&&(a=new r(t[s],t[s+1],t[s+2]),a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]||a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]||r.areColinear(n,o,a));s+=i)a=null;return a?[n,o,a]:null},r.computeBufferNormal=function(t,e){var i=r.findThreeIndependentVertices(t,e);return i?r.computeTriangleNormal(i[0],i[1],i[2]):null},r.prototype.set=function(t,e,r){return this[0]=t,this[1]=e,this[2]=r,this},r.prototype.copy=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","copy","missingVector"));return this[0]=r[0],this[1]=r[1],this[2]=r[2],this},r.prototype.equals=function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]},r.prototype.add=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","add","missingVector"));return this[0]+=r[0],this[1]+=r[1],this[2]+=r[2],this},r.prototype.subtract=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","subtract","missingVector"));return this[0]-=r[0],this[1]-=r[1],this[2]-=r[2],this},r.prototype.multiply=function(t){return this[0]*=t,this[1]*=t,this[2]*=t,this},r.prototype.divide=function(t){return this[0]/=t,this[1]/=t,this[2]/=t,this},r.prototype.multiplyByMatrix=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","multiplyByMatrix","missingMatrix"));var i=r[0]*this[0]+r[1]*this[1]+r[2]*this[2]+r[3],n=r[4]*this[0]+r[5]*this[1]+r[6]*this[2]+r[7],o=r[8]*this[0]+r[9]*this[1]+r[10]*this[2]+r[11],a=r[12]*this[0]+r[13]*this[1]+r[14]*this[2]+r[15];return this[0]=i/a,this[1]=n/a,this[2]=o/a,this},r.prototype.mix=function(r,i){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","mix","missingVector"));var n=1-i,o=i;return this[0]=this[0]*n+r[0]*o,this[1]=this[1]*n+r[1]*o,this[2]=this[2]*n+r[2]*o,this},r.prototype.negate=function(){return this[0]=-this[0],this[1]=-this[1],this[2]=-this[2],this},r.prototype.dot=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","dot","missingVector"));return this[0]*r[0]+this[1]*r[1]+this[2]*r[2]},r.prototype.cross=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","cross","missingVector"));var i=this[1]*r[2]-this[2]*r[1],n=this[2]*r[0]-this[0]*r[2],o=this[0]*r[1]-this[1]*r[0];return this[0]=i,this[1]=n,this[2]=o,this},r.prototype.magnitudeSquared=function(){return this.dot(this)},r.prototype.magnitude=function(){return Math.sqrt(this.magnitudeSquared())},r.prototype.normalize=function(){var t=this.magnitude(),e=1/t;return this[0]*=e,this[1]*=e,this[2]*=e,this},r.prototype.distanceToSquared=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","distanceToSquared","missingVector"));var i=this[0]-r[0],n=this[1]-r[1],o=this[2]-r[2];return i*i+n*n+o*o},r.prototype.distanceTo=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec3","distanceTo","missingVector"));return Math.sqrt(this.distanceToSquared(r))},r.prototype.swap=function(t){var e=this[0];return this[0]=t[0],t[0]=e,e=this[1],this[1]=t[1],t[1]=e,e=this[2],this[2]=t[2],t[2]=e,this},r.prototype.toString=function(){return"("+this[0]+", "+this[1]+", "+this[2]+")"},r}),define("worldwind/geom/Vec2",["../util/Logger","../error/ArgumentError","../geom/Vec3"],function(t,e,r){"use strict";var i=function(t,e){this[0]=t,this[1]=e};return i.prototype=new Float64Array(2),i.prototype.set=function(t,e){return this[0]=t,this[1]=e,this},i.prototype.copy=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","copy","missingVector"));return this[0]=r[0],this[1]=r[1],this},i.prototype.equals=function(t){return this[0]===t[0]&&this[1]===t[1]},i.average=function(r,i){if(!r||r.length<1)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","average","missingArray"));if(!i)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","average","missingResult"));var n,o=r.length;i[0]=0,i[1]=0;for(var a=0,s=r.length;a<s;a++)n=r[a],i[0]+=n[0]/o,i[1]+=n[1]/o;return i},i.prototype.add=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","add","missingVector"));return this[0]+=r[0],this[1]+=r[1],this},i.prototype.subtract=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","subtract","missingVector"));return this[0]-=r[0],this[1]-=r[1],this},i.prototype.multiply=function(t){return this[0]*=t,this[1]*=t,this},i.prototype.divide=function(t){return this[0]/=t,this[1]/=t,this},i.prototype.mix=function(r,i){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","mix","missingVector"));var n=1-i,o=i;return this[0]=this[0]*n+r[0]*o,this[1]=this[1]*n+r[1]*o,this},i.prototype.negate=function(){return this[0]=-this[0],this[1]=-this[1],this},i.prototype.dot=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","dot","missingVector"));return this[0]*r[0]+this[1]*r[1]},i.prototype.magnitudeSquared=function(){return this.dot(this)},i.prototype.magnitude=function(){return Math.sqrt(this.magnitudeSquared())},i.prototype.normalize=function(){var t=this.magnitude(),e=1/t;return this[0]*=e,this[1]*=e,this},i.prototype.distanceToSquared=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","distanceToSquared","missingVector"));var i=this[0]-r[0],n=this[1]-r[1];return i*i+n*n},i.prototype.distanceTo=function(r){if(!r)throw new e(t.logMessage(t.LEVEL_SEVERE,"Vec2","distanceTo","missingVector"));return Math.sqrt(this.distanceToSquared(r))},i.prototype.toVec3=function(){return new r(this[0],this[1],0)},i.prototype.swap=function(t){var e=this[0];return this[0]=t[0],t[0]=e,e=this[1],this[1]=t[1],t[1]=e,this},i.prototype.toString=function(){return"("+this[0]+", "+this[1]+")"},i}),define("worldwind/util/Offset",["../geom/Vec2"],function(t){"use strict";var e=function(t,e,r,i){this.x=e,this.y=i,this.xUnits=t,this.yUnits=r};return e.prototype.clone=function(){return new e(this.xUnits,this.x,this.yUnits,this.y)},e.prototype.offsetForSize=function(e,r){var i,n;return i=this.xUnits==WorldWind.OFFSET_FRACTION?e*this.x:this.xUnits==WorldWind.OFFSET_INSET_PIXELS?e-this.x:this.x,n=this.yUnits==WorldWind.OFFSET_FRACTION?r*this.y:this.yUnits==WorldWind.OFFSET_INSET_PIXELS?r-this.y:this.y,new t(i,n)},e.prototype.toString=function(){return this.xUnits+" "+this.x+" "+this.yUnits+" "+this.y},e}),define("worldwind/shapes/TextAttributes",["../util/Color","../util/Font","../util/Offset"],function(t,e,r){"use strict";var i=function(i){this._color=i?i._color:new t(1,1,1,1),this._font=i?i._font:new e(14),this._offset=i?i._offset:new r(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0),this._scale=i?i._scale:1,this._depthTest=!!i&&i._depthTest,this.stateKeyInvalid=!0};return i.prototype.computeStateKey=function(){return"c "+this._color.toHexString(!0)+" f "+this._font.toString()+" o "+this._offset.toString()+" s "+this._scale+" dt "+this._depthTest},Object.defineProperties(i.prototype,{stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}},color:{get:function(){return this._color},set:function(t){this._color=t,this.stateKeyInvalid=!0}},font:{get:function(){return this._font},set:function(t){this._font=t,this.stateKeyInvalid=!0}},offset:{get:function(){return this._offset},set:function(t){this._offset=t,this.stateKeyInvalid=!0}},scale:{get:function(){return this._scale},set:function(t){this._scale=t,this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(t){this._depthTest=t,this.stateKeyInvalid=!0}}}),i}),define("worldwind/shapes/AnnotationAttributes",["../util/Color","../util/Font","../util/Insets","../shapes/TextAttributes"],function(t,e,r,i){"use strict";var n=function(e){this._cornerRadius=e?e._cornerRadius:0,this._insets=e?e._insets:new r(0,0,0,0),this._backgroundColor=e?e._backgroundColor:t.WHITE,this._leaderGapWidth=e?e._leaderGapWidth:40,this._leaderGapHeight=e?e._leaderGapHeight:30,this._opacity=e?e._opacity:1,this._scale=e?e._scale:1,this._drawLeader=!e||e._drawLeader,this._width=e?e._width:200,this._height=e?e._height:100,this._textAttributes=e?e._textAttributes:new i(null),this.stateKeyInvalid=!0};return n.prototype.computeStateKey=function(){return"wi "+this._width+" he "+this._height+" cr "+this._cornerRadius+" in "+this._insets.toString()+" bg "+this.backgroundColor.toHexString(!0)+" dl "+this.drawLeader+" lgw "+this.leaderGapWidth+" lgh "+this.leaderGapHeight+" op "+this.opacity+" ta "+this._textAttributes.stateKey+" sc "+this.scale},Object.defineProperties(n.prototype,{width:{get:function(){return this._width},set:function(t){this._width=t,this.stateKeyInvalid=!0}},height:{get:function(){return this._height},set:function(t){this._height=t,this.stateKeyInvalid=!0}},cornerRadius:{get:function(){return this._cornerRadius},set:function(t){this._cornerRadius=t,this.stateKeyInvalid=!0}},insets:{get:function(){
return this._insets},set:function(t){this._insets=t,this.stateKeyInvalid=!0}},backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this.stateKeyInvalid=!0}},textAttributes:{get:function(){return this._textAttributes},set:function(t){this._textAttributes=t,this.stateKeyInvalid=!0}},drawLeader:{get:function(){return this._drawLeader},set:function(t){this._drawLeader=t,this.stateKeyInvalid=!0}},leaderGapWidth:{get:function(){return this._leaderGapWidth},set:function(t){this._leaderGapWidth=t,this.stateKeyInvalid=!0}},leaderGapHeight:{get:function(){return this._leaderGapHeight},set:function(t){this._leaderGapHeight=t,this.stateKeyInvalid=!0}},opacity:{get:function(){return this._opacity},set:function(t){this._opacity=t,this.stateKeyInvalid=!0}},scale:{get:function(){return this._scale},set:function(t){this._scale=t,this.stateKeyInvalid=!0}},stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}}}),n}),define("worldwind/shaders/GpuShader",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i,n){if(i!==r.VERTEX_SHADER&&i!==r.FRAGMENT_SHADER)throw new t(e.logMessage(e.LEVEL_SEVERE,"GpuShader","constructor","The specified shader type is unrecognized."));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"GpuShader","constructor","The specified shader source is null or undefined."));var o=r.createShader(i);if(!o)throw new t(e.logMessage(e.LEVEL_SEVERE,"GpuShader","constructor","Unable to create shader of type "+(i==r.VERTEX_SHADER?"VERTEX_SHADER.":"FRAGMENT_SHADER.")));if(!this.compile(r,o,i,n)){var a=r.getShaderInfoLog(o);throw r.deleteShader(o),new t(e.logMessage(e.LEVEL_SEVERE,"GpuShader","constructor","Unable to compile shader: "+a))}this.shaderId=o};return r.prototype.compile=function(t,e,r,i){return t.shaderSource(e,i),t.compileShader(e),t.getShaderParameter(e,t.COMPILE_STATUS)},r.prototype.dispose=function(t){this.shaderId&&(t.deleteShader(this.shaderId),delete this.shaderId)},r}),define("worldwind/shaders/GpuProgram",["../error/ArgumentError","../util/Color","../shaders/GpuShader","../util/Logger"],function(t,e,r,i){"use strict";var n=function(e,n,o,a){if(!n||!o)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","constructor","The specified shader source is null or undefined."));var s,l,u;try{l=new r(e,e.VERTEX_SHADER,n),u=new r(e,e.FRAGMENT_SHADER,o)}catch(t){throw l&&l.dispose(e),u&&u.dispose(e),t}if(s=e.createProgram(),!s)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","constructor","Unable to create shader program."));if(e.attachShader(s,l.shaderId),e.attachShader(s,u.shaderId),a)for(var c=0,h=a.length;c<h;c++)e.bindAttribLocation(s,c,a[c]);if(!this.link(e,s)){var f=e.getProgramInfoLog(s);throw e.detachShader(s,l.shaderId),e.detachShader(s,u.shaderId),e.deleteProgram(s),l.dispose(e),u.dispose(e),new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","constructor","Unable to link shader program: "+f))}this.programId=s,this.attributeLocations={},this.uniformLocations={},this.vertexShader=l,this.fragmentShader=u,this.size=n.length+o.length,this.scratchArray=new Float32Array(16)};return n.prototype.dispose=function(t){this.programId&&(this.vertexShader&&t.detachShader(this.programId,this.vertexShader.shaderId),this.fragmentShader&&t.detachShader(this.programId,this.fragmentShader.shaderId),t.deleteProgram(this.programId),delete this.programId),this.vertexShader&&(this.vertexShader.dispose(t),delete this.vertexShader),this.fragmentShader&&(this.fragmentShader.dispose(t),delete this.fragmentShader),this.attributeLocations={},this.uniformLocations={}},n.prototype.attributeLocation=function(e,r){if(!r||0==r.length)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","attributeLocation","The specified attribute name is null, undefined or empty."));var n=this.attributeLocations[r];return n||(n=e.getAttribLocation(this.programId,r),this.attributeLocations[r]=n),n},n.prototype.uniformLocation=function(e,r){if(!r||0==r.length)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","uniformLocation","The specified uniform name is null, undefined or empty."));var n=this.uniformLocations[r];return n||(n=e.getUniformLocation(this.programId,r),this.uniformLocations[r]=n),n},n.prototype.link=function(t,e){return t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)},n.prototype.loadUniformMatrix=function(e,r,n){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","loadUniformMatrix","missingMatrix"));var o=r.columnMajorComponents(this.scratchArray);e.uniformMatrix4fv(n,!1,o)},n.prototype.loadUniformColor=function(e,r,n){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"GpuProgram","loadUniformColor","missingColor"));var o=r.premultipliedComponents(this.scratchArray);e.uniform4f(n,o[0],o[1],o[2],o[3])},n.prototype.loadUniformColorComponents=function(t,e,r,i,n,o){t.uniform4f(o,e*n,r*n,i*n,n)},n}),define("worldwind/shaders/BasicTextureProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(t,e,r,i){"use strict";var n=function(t){var e="attribute vec4 vertexPoint;\nattribute vec4 vertexTexCoord;\nattribute vec4 normalVector;\nuniform mat4 mvpMatrix;\nuniform mat4 mvInverseMatrix;\nuniform mat4 texCoordMatrix;\nuniform bool applyLighting;\nvarying vec2 texCoord;\nvarying vec4 normal;\nvoid main() {gl_Position = mvpMatrix * vertexPoint;\ntexCoord = (texCoordMatrix * vertexTexCoord).st;\nif (applyLighting) {normal = mvInverseMatrix * normalVector;}\n}",i="precision mediump float;\nuniform float opacity;\nuniform vec4 color;\nuniform bool enableTexture;\nuniform bool modulateColor;\nuniform sampler2D textureSampler;\nuniform bool applyLighting;\nvarying vec2 texCoord;\nvarying vec4 normal;\nvoid main() {\nvec4 textureColor = texture2D(textureSampler, texCoord);\nfloat ambient = 0.15; vec4 lightDirection = vec4(0, 0, 1, 0);\nif (enableTexture && !modulateColor)\n    gl_FragColor = textureColor * color * opacity;\nelse if (enableTexture && modulateColor)\n    gl_FragColor = color * floor(textureColor.a + 0.5);\nelse\n    gl_FragColor = color * opacity;\nif (gl_FragColor.a == 0.0) {discard;}\nif (applyLighting) {\n    vec4 n = normal * (gl_FrontFacing ? 1.0 : -1.0);\n    gl_FragColor.rgb *= clamp(ambient + dot(lightDirection, n), 0.0, 1.0);\n}\n}",n=["vertexPoint","normalVector","vertexTexCoord"];r.call(this,t,e,i,n),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.normalVectorLocation=this.attributeLocation(t,"normalVector"),this.vertexTexCoordLocation=this.attributeLocation(t,"vertexTexCoord"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.mvInverseMatrixLocation=this.uniformLocation(t,"mvInverseMatrix"),this.colorLocation=this.uniformLocation(t,"color"),this.textureEnabledLocation=this.uniformLocation(t,"enableTexture"),this.modulateColorLocation=this.uniformLocation(t,"modulateColor"),this.textureUnitLocation=this.uniformLocation(t,"textureSampler"),this.textureMatrixLocation=this.uniformLocation(t,"texCoordMatrix"),this.opacityLocation=this.uniformLocation(t,"opacity"),this.applyLightingLocation=this.uniformLocation(t,"applyLighting")};return n.key="WorldWindGpuBasicTextureProgram",n.prototype=Object.create(r.prototype),n.prototype.loadModelviewInverse=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicTextureProgram","loadModelviewInverse","missingMatrix"));this.loadUniformMatrix(e,r,this.mvInverseMatrixLocation)},n.prototype.loadModelviewProjection=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicTextureProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,r,this.mvpMatrixLocation)},n.prototype.loadColor=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicTextureProgram","loadColor","missingColor"));this.loadUniformColor(e,r,this.colorLocation)},n.prototype.loadTextureEnabled=function(t,e){t.uniform1i(this.textureEnabledLocation,e?1:0)},n.prototype.loadModulateColor=function(t,e){t.uniform1i(this.modulateColorLocation,e?1:0)},n.prototype.loadTextureUnit=function(t,e){t.uniform1i(this.textureUnitLocation,e-t.TEXTURE0)},n.prototype.loadTextureMatrix=function(t,e){this.loadUniformMatrix(t,e,this.textureMatrixLocation)},n.prototype.loadOpacity=function(t,e){t.uniform1f(this.opacityLocation,e)},n.prototype.loadApplyLighting=function(t,e){t.uniform1i(this.applyLightingLocation,e)},n}),define("worldwind/geom/Line",["../error/ArgumentError","../util/Logger","../geom/Vec3"],function(t,e,r){"use strict";var i=function(r,i){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"Line","constructor","Origin is null or undefined."));if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Line","constructor","Direction is null or undefined."));this.origin=r,this.direction=i};return i.fromSegment=function(n,o){if(!n||!o)throw new t(e.logMessage(e.LEVEL_SEVERE,"Line","fromSegment","missingPoint"));var a=new r(n[0],n[1],n[2]),s=new r(o[0]-n[0],o[1]-n[1],o[2]-n[2]);return new i(a,s)},i.prototype.pointAt=function(r,i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Line","pointAt","missingResult."));return i[0]=this.origin[0]+this.direction[0]*r,i[1]=this.origin[1]+this.direction[1]*r,i[2]=this.origin[2]+this.direction[2]*r,i},i}),define("worldwind/geom/Plane",["../error/ArgumentError","../geom/Line","../util/Logger","../geom/Vec3"],function(t,e,r,i){"use strict";var n=function(t,e,r,n){this.normal=new i(t,e,r),this.distance=n};return n.fromPoints=function(e,o,a){if(!e||!o||!a)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","fromPoints","missingVector"));var s=new i(o[0],o[1],o[2]);s.subtract(e);var l=new i(a[0],a[1],a[2]);l.subtract(e),s.cross(l),s.normalize();var u=-s.dot(e);return new n(s[0],s[1],s[2],u)},n.prototype.dot=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","dot","missingVector"));return this.normal.dot(e)+this.distance},n.prototype.distanceToPoint=function(t){return this.dot(t)},n.prototype.transformByMatrix=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","transformByMatrix","missingMatrix"));var i=e[0]*this.normal[0]+e[1]*this.normal[1]+e[2]*this.normal[2]+e[3]*this.distance,n=e[4]*this.normal[0]+e[5]*this.normal[1]+e[6]*this.normal[2]+e[7]*this.distance,o=e[8]*this.normal[0]+e[9]*this.normal[1]+e[10]*this.normal[2]+e[11]*this.distance,a=e[12]*this.normal[0]+e[13]*this.normal[1]+e[14]*this.normal[2]+e[15]*this.distance;return this.normal[0]=i,this.normal[1]=n,this.normal[2]=o,this.distance=a,this},n.prototype.normalize=function(){var t=this.normal.magnitude();return 0===t?this:(this.normal.divide(t),this.distance/=t,this)},n.prototype.intersectsSegment=function(t,e){var r=this.dot(t),i=this.dot(e);return r*i<=0},n.prototype.intersectsSegmentAt=function(t,e,r){var i=this.dot(t),n=this.dot(e);if(0===i&&0===n)return r[0]=t[0],r[1]=t[1],r[2]=t[2],!0;if(i===n)return!1;var o=-i/(n-i),a=1-o;return r[0]=o*t[0]+a*e[0],r[1]=o*t[1]+a*e[1],r[2]=o*t[2]+a*e[2],i*n<=0},n.prototype.onSameSide=function(e,i){if(!e||!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","onSameSide","missingPoint"));var n=this.distanceToPoint(e),o=this.distanceToPoint(i);return n<0&&o<0?-1:n>0&&o>0?1:0},n.prototype.clip=function(n,o){if(!n||!o)throw new t(r.logMessage(r.LEVEL_SEVERE,"Plane","clip","missingPoint"));if(n.equals(o))return null;var a,s,l,u=e.fromSegment(n,o),c=this.normal.dot(u.direction);return 0===c?(a=this.dot(u.origin),0===a?[n,o]:null):(s=-this.dot(u.origin)/c,s<0||s>1?null:(l=u.pointAt(s,new i(0,0,0)),c>0?[l,o]:[n,l]))},n.prototype.set=function(t,e,r,i){this.normal[0]=t,this.normal[1]=e,this.normal[2]=r,this.distance=i,this.normalizeIfNeeded()},n.prototype.normalizeIfNeeded=function(){var t=this.normal.magnitude();if(0!=t){var e=1e-10;t>=1-e&&t<=1+e||(this.normal[0]/=t,this.normal[1]/=t,this.normal[2]/=t,this.distance/=t)}},n}),define("worldwind/geom/Rectangle",["../util/Logger"],function(t){"use strict";var e=function(t,e,r,i){this.x=t,this.y=e,this.width=r,this.height=i};return e.prototype.set=function(t,e,r,i){this.x=t,this.y=e,this.width=r,this.height=i},e.prototype.getMinX=function(){return this.x},e.prototype.getMinY=function(){return this.y},e.prototype.getMaxX=function(){return this.x+this.width},e.prototype.getMaxY=function(){return this.y+this.height},e.prototype.containsPoint=function(t){return t[0]>=this.x&&t[0]<=this.x+this.width&&t[1]>=this.y&&t[1]<=this.y+this.height},e.prototype.intersects=function(t){return!(t.x+t.width<this.x)&&(!(t.x>this.x+this.width)&&(!(t.y+t.height<this.y)&&!(t.y>this.y+this.height)))},e.prototype.intersectsRectangles=function(t){if(t)for(var e=0;e<t.length;e++)if(this.intersects(t[e]))return!0;return!1},e.prototype.toString=function(){return this.x+", "+this.y+", "+this.width+", "+this.height},e}),define("worldwind/util/WWMath",["../geom/Angle","../error/ArgumentError","../geom/Line","../util/Logger","../geom/Rectangle","../geom/Vec3"],function(t,e,r,i,n,o){"use strict";var a={clamp:function(t,e,r){return t<e?e:t>r?r:t},interpolate:function(t,e,r){return(1-t)*e+t*r},cbrt:function(t){return"function"==typeof Math.cbrt?Math.cbrt(t):Math.pow(t,1/3)},computeEllipsoidalGlobeIntersection:function(t,r,n,o){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeEllipsoidalGlobeIntersection","missingLine"));if(!o)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeEllipsoidalGlobeIntersection","missingResult"));var a,s=t.direction[0],l=t.direction[1],u=t.direction[2],c=t.origin[0],h=t.origin[1],f=t.origin[2],d=r/n,p=d*d,g=r*r,m=s*s+p*l*l+u*u,y=2*(c*s+p*h*l+f*u),v=c*c+p*h*h+f*f-g,b=y*y-4*m*v;return!(b<0)&&(a=(-y-Math.sqrt(b))/(2*m),o[0]=c+s*a,o[1]=h+l*a,o[2]=f+u*a,!0)},computeTriangleIntersection:function(t,r,n,o,a){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingLine"));if(!r||!n||!o)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingVertex"));if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingResult"));var s=t.direction[0],l=t.direction[1],u=t.direction[2],c=t.origin[0],h=t.origin[1],f=t.origin[2],d=1e-5,p=n[0]-r[0],g=n[1]-r[1],m=n[2]-r[2],y=o[0]-r[0],v=o[1]-r[1],b=o[2]-r[2],E=l*b-u*v,w=u*y-s*b,_=s*v-l*y,x=p*E+g*w+m*_;if(x>-d&&x<d)return!1;var S=1/x,T=c-r[0],M=h-r[1],L=f-r[2],A=S*(T*E+M*w+L*_);if(A<-d||A>1+d)return!1;var N=M*m-L*g,C=L*p-T*m,R=T*g-M*p,P=S*(s*N+l*C+u*R);if(P<-d||A+P>1+d)return!1;var O=S*(y*N+v*C+b*R);return!(O<0)&&(a[0]=c+s*O,a[1]=h+l*O,a[2]=f+u*O,!0)},computeIndexedTrianglesIntersection:function(t,r,n,s){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingLine"));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingPoints"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingIndices"));if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingResults"));for(var l=new o(0,0,0),u=new o(0,0,0),c=new o(0,0,0),h=new o(0,0,0),f=0,d=n.length;f<d;f+=3){var p=3*n[f],g=3*n[f+1],m=3*n[f+2];l[0]=r[p],l[1]=r[p+1],l[2]=r[p+2],u[0]=r[g],u[1]=r[g+1],u[2]=r[g+2],c[0]=r[m],c[1]=r[m+1],c[2]=r[m+2],a.computeTriangleIntersection(t,l,u,c,h)&&(s.push(h),h=new o(0,0,0))}return s.length>0},computeTriStripIntersections:function(t,r,n,a){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingLine"));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingPoints"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingIndices"));if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingResults"));var s,l,u,c,h,f,d,p,g,m,y,v,b,E,w,_,x,S,T,M,L,A,N,C,R,P,O,I,k,D,V=t.direction[0],F=t.direction[1],G=t.direction[2],B=t.origin[0],W=t.origin[1],U=t.origin[2],z=1e-5;D=3*n[0],c=r[D++],h=r[D++],f=r[D],D=3*n[1],d=r[D++],p=r[D++],g=r[D];for(var j=2,K=n.length;j<K;j++)s=c,l=h,u=f,c=d,h=p,f=g,D=3*n[j],d=r[D++],p=r[D++],g=r[D],m=c-s,y=h-l,v=f-u,b=d-s,E=p-l,w=g-u,_=F*w-G*E,x=G*b-V*w,S=V*E-F*b,I=m*_+y*x+v*S,I>-z&&I<z||(k=1/I,T=B-s,M=W-l,L=U-u,R=k*(T*_+M*x+L*S),R<-z||R>1+z||(A=M*v-L*y,N=L*m-T*v,C=T*y-M*m,P=k*(V*A+F*N+G*C),P<-z||R+P>1+z||(O=k*(b*A+E*N+w*C),O>=0&&a.push(new o(B+V*O,W+F*O,U+G*O)))))},fabs:function(t){return t>=0?t:-t},fmod:function(t,e){return 0===e?0:t-Math.floor(t/e)*e},fract:function(t){return t-Math.floor(t)},mod:function(t,e){return(t%e+e)%e},max:function(t,e){return t>e?t:e},localCoordinateAxesAtPoint:function(t,r,n,o,a){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingVector"));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingGlobe"));if(!n||!o||!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingResult"));var s=t[0],l=t[1],u=t[2];r.surfaceNormalAtPoint(s,l,u,a),r.northTangentAtPoint(s,l,u,o),n.set(o[0],o[1],o[2]),n.cross(a),n.normalize(),o.set(a[0],a[1],a[2]),o.cross(n),o.normalize()},horizonDistanceForGlobeRadius:function(t,r){if(t<0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","horizontalDistanceForGlobeRadius","The specified globe radius is negative."));return t>0&&r>0?Math.sqrt(r*(2*t+r)):0},perspectiveNearDistanceForFarDistance:function(t,r,n){if(t<0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified distance is negative."));if(r<0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified resolution is negative."));if(n<1)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified depth bits is negative."));var o=(1<<n)-1;return t/(o/(1-r/t)-o+1)},perspectiveNearDistance:function(t,r,n){if(t<=0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","invalidWidth"));if(r<=0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","invalidHeight"));if(n<0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","The specified distance is negative."));var o=r/t;return 2*n/Math.sqrt(o*o+5)},perspectiveFrustumRectangle:function(t,r,o){if(t<=0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","invalidWidth"));if(r<=0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","invalidHeight"));if(o<0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","The specified distance is negative."));var a=o,s=o*r/t;return new n(-a/2,-s/2,a,s)},perspectivePixelSize:function(t,r,n){if(t<=0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectivePixelSize","invalidWidth"));if(r<=0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectivePixelSize","invalidHeight"));if(n<0)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","perspectivePixelSize","The specified distance is negative."));var o=a.perspectiveFrustumRectangle(t,r,n).height;return o/r},boundingRectForUnitQuad:function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WWMath","boundingRectForUnitQuad","missingMatrix"));var r=t,o=r[3],a=r[7],s=r[0]+r[3],l=r[4]+r[7],u=r[1]+r[3],c=r[5]+r[7],h=r[0]+r[1]+r[3],f=r[4]+r[5]+r[7],d=Math.min(Math.min(o,s),Math.min(u,h)),p=Math.max(Math.max(o,s),Math.max(u,h)),g=Math.min(Math.min(a,l),Math.min(c,f)),m=Math.max(Math.max(a,l),Math.max(c,f));return new n(d,g,p-d,m-g)},isPowerOfTwo:function(t){return 0!=t&&0===(t&t-1)},signum:function(t){return t>0?1:t<0?-1:0},gudermannianInverse:function(e){return Math.log(Math.tan(Math.PI/4+e*t.DEGREES_TO_RADIANS/2))/Math.PI},epsg3857ToEpsg4326:function(e,r){var i=6378100,n=Math.PI/2-2*Math.atan(Math.exp(-r/i)),o=e/i;return[a.clamp(n*t.RADIANS_TO_DEGREES,-90,90),a.clamp(o*t.RADIANS_TO_DEGREES,-180,180)]},powerOfTwoFloor:function(t){var e=Math.floor(Math.log(t)/Math.log(2));return Math.pow(2,e)},toRadians:function(e){return t.DEGREES_TO_RADIANS*e},toDegrees:function(e){return t.RADIANS_TO_DEGREES*e},normalizeAngle360:function(t){var e=t%360;return e>=0?e:e<0?360+e:360-e}};return a}),define("worldwind/geom/Location",["../geom/Angle","../error/ArgumentError","../util/Logger","../geom/Plane","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o){"use strict";var a=function(t,e){this.latitude=t,this.longitude=e};return a.ZERO=new a(0,0),a.fromRadians=function(e,r){return new a(e*t.RADIANS_TO_DEGREES,r*t.RADIANS_TO_DEGREES)},a.prototype.copy=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","copy","missingLocation"));return this.latitude=t.latitude,this.longitude=t.longitude,this},a.prototype.set=function(t,e){return this.latitude=t,this.longitude=e,this},a.prototype.equals=function(t){return t&&t.latitude===this.latitude&&t.longitude===this.longitude},a.interpolateAlongPath=function(t,i,n,o,a){if(!n||!o)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateAlongPath","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateAlongPath","missingResult"));return t===WorldWind.GREAT_CIRCLE?this.interpolateGreatCircle(i,n,o,a):t&&t===WorldWind.RHUMB_LINE?this.interpolateRhumb(i,n,o,a):this.interpolateLinear(i,n,o,a)},a.interpolateGreatCircle=function(t,i,n,a){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateGreatCircle","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateGreatCircle","missingResult"));if(i.equals(n))return a.latitude=i.latitude,a.longitude=i.longitude,a;var s=o.clamp(t,0,1),l=this.greatCircleAzimuth(i,n),u=this.greatCircleDistance(i,n);return this.greatCircleLocation(i,l,s*u,a)},a.greatCircleAzimuth=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleAzimuth","missingLocation"));var o,a,s,l=i.latitude*t.DEGREES_TO_RADIANS,u=n.latitude*t.DEGREES_TO_RADIANS,c=i.longitude*t.DEGREES_TO_RADIANS,h=n.longitude*t.DEGREES_TO_RADIANS;return l==u&&c==h?0:c==h?l>u?180:0:(a=Math.cos(u)*Math.sin(h-c),o=Math.cos(l)*Math.sin(u)-Math.sin(l)*Math.cos(u)*Math.cos(h-c),s=Math.atan2(a,o),isNaN(s)?0:s*t.RADIANS_TO_DEGREES)},a.greatCircleDistance=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleDistance","missingLocation"));var o,a,s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=n.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n.longitude*t.DEGREES_TO_RADIANS;return u==c&&h==f?0:(o=Math.sin((c-u)/2),a=Math.sin((f-h)/2),s=o*o+Math.cos(u)*Math.cos(c)*a*a,l=2*Math.asin(Math.sqrt(s)),isNaN(l)?0:l)},a.greatCircleLocation=function(i,n,o,a){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleLocation","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleLocation","missingResult"));if(0==o)return a.latitude=i.latitude,a.longitude=i.longitude,a;var s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=i.longitude*t.DEGREES_TO_RADIANS,h=n*t.DEGREES_TO_RADIANS;return s=Math.asin(Math.sin(u)*Math.cos(o)+Math.cos(u)*Math.sin(o)*Math.cos(h)),l=c+Math.atan2(Math.sin(o)*Math.sin(h),Math.cos(u)*Math.cos(o)-Math.sin(u)*Math.sin(o)*Math.cos(h)),isNaN(s)||isNaN(l)?(a.latitude=i.latitude,a.longitude=i.longitude):(a.latitude=t.normalizedDegreesLatitude(s*t.RADIANS_TO_DEGREES),a.longitude=t.normalizedDegreesLongitude(l*t.RADIANS_TO_DEGREES)),a},a.interpolateRhumb=function(t,i,n,a){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateRhumb","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateRhumb","missingResult"));if(i.equals(n))return a.latitude=i.latitude,a.longitude=i.longitude,a;var s=o.clamp(t,0,1),l=this.rhumbAzimuth(i,n),u=this.rhumbDistance(i,n);return this.rhumbLocation(i,l,s*u,a)},a.rhumbAzimuth=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","rhumbAzimuth","missingLocation"));var a,s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=n.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n.longitude*t.DEGREES_TO_RADIANS;return u==c&&h==f?0:(a=f-h,s=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(u/2+Math.PI/4)),o.fabs(a)>Math.PI&&(a=a>0?-(2*Math.PI-a):2*Math.PI+a),l=Math.atan2(a,s),isNaN(l)?0:l*t.RADIANS_TO_DEGREES)},a.rhumbDistance=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","rhumbDistance","missingLocation"));var a,s,l,u,c,h=i.latitude*t.DEGREES_TO_RADIANS,f=n.latitude*t.DEGREES_TO_RADIANS,d=i.longitude*t.DEGREES_TO_RADIANS,p=n.longitude*t.DEGREES_TO_RADIANS;return h==f&&d==p?0:(a=f-h,s=p-d,l=Math.log(Math.tan(f/2+Math.PI/4)/Math.tan(h/2+Math.PI/4)),u=a/l,(isNaN(l)||isNaN(u))&&(u=Math.cos(h)),o.fabs(s)>Math.PI&&(s=s>0?-(2*Math.PI-s):2*Math.PI+s),c=Math.sqrt(a*a+u*u*s*s),isNaN(c)?0:c)},a.rhumbLocation=function(i,n,a,s){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","rhumbLocation","missingLocation"));if(!s)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","rhumbLocation","missingResult"));if(0==a)return s.latitude=i.latitude,s.longitude=i.longitude,s;var l,u,c=i.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n*t.DEGREES_TO_RADIANS,d=c+a*Math.cos(f),p=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(c/2+Math.PI/4)),g=(d-c)/p;return(isNaN(p)||isNaN(g)||!isFinite(g))&&(g=Math.cos(c)),l=a*Math.sin(f)/g,o.fabs(d)>Math.PI/2&&(d=d>0?Math.PI-d:-Math.PI-d),u=o.fmod(h+l+Math.PI,2*Math.PI)-Math.PI,isNaN(d)||isNaN(u)?(s.latitude=i.latitude,s.longitude=i.longitude):(s.latitude=t.normalizedDegreesLatitude(d*t.RADIANS_TO_DEGREES),s.longitude=t.normalizedDegreesLongitude(u*t.RADIANS_TO_DEGREES)),s},a.interpolateLinear=function(t,i,n,a){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateLinear","missingLocation"));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","interpolateLinear","missingResult"));if(i.equals(n))return a.latitude=i.latitude,a.longitude=i.longitude,a;var s=o.clamp(t,0,1),l=this.linearAzimuth(i,n),u=this.linearDistance(i,n);return this.linearLocation(i,l,s*u,a)},a.linearAzimuth=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","linearAzimuth","missingLocation"));var a,s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=n.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n.longitude*t.DEGREES_TO_RADIANS;return u==c&&h==f?0:(a=f-h,s=c-u,o.fabs(a)>Math.PI&&(a=a>0?-(2*Math.PI-a):2*Math.PI+a),l=Math.atan2(a,s),isNaN(l)?0:l*t.RADIANS_TO_DEGREES)},a.linearDistance=function(i,n){if(!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","linearDistance","missingLocation"));var a,s,l,u=i.latitude*t.DEGREES_TO_RADIANS,c=n.latitude*t.DEGREES_TO_RADIANS,h=i.longitude*t.DEGREES_TO_RADIANS,f=n.longitude*t.DEGREES_TO_RADIANS;return u==c&&h==f?0:(a=c-u,s=f-h,o.fabs(s)>Math.PI&&(s=s>0?-(2*Math.PI-s):2*Math.PI+s),l=Math.sqrt(a*a+s*s),isNaN(l)?0:l)},a.linearLocation=function(i,n,a,s){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","linearLocation","missingLocation"));if(!s)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","linearLocation","missingResult"));if(0==a)return s.latitude=i.latitude,s.longitude=i.longitude,s;var l,u=i.latitude*t.DEGREES_TO_RADIANS,c=i.longitude*t.DEGREES_TO_RADIANS,h=n*t.DEGREES_TO_RADIANS,f=u+a*Math.cos(h);return o.fabs(f)>Math.PI/2&&(f=f>0?Math.PI-f:-Math.PI-f),l=o.fmod(c+a*Math.sin(h)+Math.PI,2*Math.PI)-Math.PI,isNaN(f)||isNaN(l)?(s.latitude=i.latitude,s.longitude=i.longitude):(s.latitude=t.normalizedDegreesLatitude(f*t.RADIANS_TO_DEGREES),s.longitude=t.normalizedDegreesLongitude(l*t.RADIANS_TO_DEGREES)),s},a.locationsCrossDateLine=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","locationsCrossDateline","missingLocation"));for(var i=null,n=0,a=t.length;n<a;n+=1){var s=t[n];if(null!=i&&o.signum(i.longitude)!=o.signum(s.longitude)){var l=Math.abs(i.longitude-s.longitude);if(l>180&&l<360)return!0}i=s}return!1},a.greatCircleArcExtremeLocations=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleArcExtremeLocations","missingLocation"));for(var i=null,n=null,o=null,s=0,l=t.length;s<l;s+=1){var u=t[s];if(null!=o){var c=a.greatCircleArcExtremeForTwoLocations(o,u);if(null==c)continue;(null==i||i.latitude>c[0].latitude)&&(i=c[0]),(null==n||n.latitude<c[1].latitude)&&(n=c[1])}o=u}return[i,n]},a.greatCircleArcExtremeForTwoLocations=function(t,i){if(!t||!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleArcExtremeForTwoLocations","missingLocation"));var n,s,l,u=null,c=null,h=90,f=-90,d=[t,i];for(n=0,s=d.length;n<s;n+=1)l=d[n],h>=l.latitude&&(h=l.latitude,u=l),f<=l.latitude&&(f=l.latitude,c=l);var p=a.greatCircleAzimuth(t,i),g=a.greatCircleDistance(t,i),m=a.greatCircleExtremeLocationsUsingAzimuth(t,p);for(n=0,s=m.length;n<s;n+=1){l=m[n];var y=a.greatCircleAzimuth(t,l),v=a.greatCircleDistance(t,l);o.signum(y)==o.signum(p)&&v>=0&&v<=g&&(h>=l.latitude&&(h=l.latitude,u=l),f<=l.latitude&&(f=l.latitude,c=l))}return[u,c]},a.greatCircleExtremeLocationsUsingAzimuth=function(i,n){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Location","greatCircleArcExtremeLocationsUsingAzimuth","missingLocation"));var o=i.latitude,s=n*t.DEGREES_TO_RADIANS,l=-Math.tan(o)/Math.cos(s),u=Math.atan(l),c=u+Math.PI/2,h=u-Math.PI/2;return[a.greatCircleLocation(i,n,c,new a(0,0)),a.greatCircleLocation(i,n,h,new a(0,0))]},a.intersectionWithMeridian=function(t,e,r,o){var a=o.computePointFromLocation(t.latitude,t.longitude,new n(0,0,0)),s=o.computePointFromLocation(e.latitude,e.longitude,new n(0,0,0)),l=o.computePointFromLocation(90,r,new n(0,0,0)),u=o.computePointFromLocation(0,r,new n(0,0,0)),c=i.fromPoints(l,u,n.ZERO),h=new n(0,0,0);if(!c.intersectsSegmentAt(a,s,h))return null;var f=new WorldWind.Position(0,0,0);return o.computePositionFromPoint(h[0],h[1],h[2],f),f.latitude},a.normalizeLatitude=function(t){var e=t%180,r=e>90?180-e:e<-90?-180-e:e,i=Math.round(t/180);return i%2==0?r:-r},a.normalizeLongitude=function(t){var e=t%360;return e>180?e-360:e<-180?360+e:e},a.meridianIntersection=function(t,e,r){var i=t.longitude<0?t.longitude+360:t.longitude,n=e.longitude<0?e.longitude+360:e.longitude;if(i===n)return null;var o=r<0?r+360:r,a=(e.latitude-t.latitude)/(n-i),s=t.latitude+a*(o-i);return s},a.poles={NONE:0,NORTH:1,SOUTH:2},a}),define("worldwind/geom/Position",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../util/WWMath"],function(t,e,r,i,n){"use strict";var o=function(t,e,r){this.latitude=t,this.longitude=e,this.altitude=r};return o.ZERO=new o(0,0,0),o.fromRadians=function(e,r,i){return new o(e*t.RADIANS_TO_DEGREES,r*t.RADIANS_TO_DEGREES,i)},o.prototype.copy=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","copy","missingPosition"));return this.latitude=t.latitude,this.longitude=t.longitude,this.altitude=t.altitude,this},o.prototype.equals=function(t){return t&&t.latitude===this.latitude&&t.longitude===this.longitude&&t.altitude===this.altitude},o.interpolateGreatCircle=function(t,o,a,s){if(!o||!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateGreatCircle","missingPosition"));if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateGreatCircle","missingResult"));var l=n.clamp(t,0,1);return s.altitude=n.interpolate(l,o.altitude,a.altitude),r.interpolateGreatCircle(l,o,a,s),s},o.interpolateRhumb=function(t,o,a,s){if(!o||!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateRhumb","missingPosition"));if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateRhumb","missingResult"));var l=n.clamp(t,0,1);return s.altitude=n.interpolate(l,o.altitude,a.altitude),r.interpolateRhumb(l,o,a,s),s},o.interpolateLinear=function(t,o,a,s){if(!o||!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateLinear","missingPosition"));if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"Position","interpolateLinear","missingResult"));var l=n.clamp(t,0,1);return s.altitude=n.interpolate(l,o.altitude,a.altitude),r.interpolateLinear(l,o,a,s),s},o.prototype.toString=function(){
return"("+this.latitude.toString()+"°, "+this.longitude.toString()+"°, "+this.altitude.toString()+")"},o}),define("worldwind/render/Texture",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Texture","constructor","missingGlContext"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"Texture","constructor","missingImage"));o||(o=i.CLAMP_TO_EDGE);var a=i.createTexture(),s=r.isPowerOfTwo(n.width)&&r.isPowerOfTwo(n.height);this.originalImageWidth=n.width,this.originalImageHeight=n.height,o!==i.REPEAT||s||(n=this.resizeImage(n),s=!0),this.imageWidth=n.width,this.imageHeight=n.height,this.size=n.width*n.height*4,i.bindTexture(i.TEXTURE_2D,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,s?i.LINEAR_MIPMAP_LINEAR:i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,o);var l=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");l&&i.texParameteri(i.TEXTURE_2D,l.TEXTURE_MAX_ANISOTROPY_EXT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),s&&i.generateMipmap(i.TEXTURE_2D),this.textureId=a,this.creationTime=new Date};return i.prototype.dispose=function(t){t.deleteTexture(this.textureId),delete this.textureId},i.prototype.bind=function(t){return t.currentGlContext.bindTexture(t.currentGlContext.TEXTURE_2D,this.textureId),t.frameStatistics.incrementTextureLoadCount(1),!0},i.prototype.resizeImage=function(t){var e=document.createElement("canvas");e.width=r.powerOfTwoFloor(t.width),e.height=r.powerOfTwoFloor(t.height);var i=e.getContext("2d");return i.drawImage(t,0,0,e.width,e.height),e},i}),define("worldwind/geom/Matrix",["../geom/Angle","../error/ArgumentError","../util/Logger","../geom/Plane","../geom/Position","../geom/Rectangle","../render/Texture","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g){this[0]=t,this[1]=e,this[2]=r,this[3]=i,this[4]=n,this[5]=o,this[6]=a,this[7]=s,this[8]=l,this[9]=u,this[10]=c,this[11]=h,this[12]=f,this[13]=d,this[14]=p,this[15]=g};return u.prototype=new Float64Array(16),u.fromIdentity=function(){return new u(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},u.principalAxesFromPoints=function(t,i,n,o){if(!t||t.length<1)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","principalAxesFromPoints","missingPoints"));if(!i||!n||!o)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","principalAxesFromPoints","An axis argument is null or undefined."));var a=u.fromIdentity();a.setToCovarianceOfPoints(t),a.eigensystemFromSymmetricMatrix(i,n,o),i.normalize(),n.normalize(),o.normalize()},u.prototype.set=function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g){return this[0]=t,this[1]=e,this[2]=r,this[3]=i,this[4]=n,this[5]=o,this[6]=a,this[7]=s,this[8]=l,this[9]=u,this[10]=c,this[11]=h,this[12]=f,this[13]=d,this[14]=p,this[15]=g,this},u.prototype.setToIdentity=function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1},u.prototype.copy=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","copy","missingMatrix"));this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15]},u.prototype.equals=function(t){return t&&this[0]==t[0]&&this[1]==t[1]&&this[2]==t[2]&&this[3]==t[3]&&this[4]==t[4]&&this[5]==t[5]&&this[6]==t[6]&&this[7]==t[7]&&this[8]==t[8]&&this[9]==t[9]&&this[10]==t[10]&&this[11]==t[11]&&this[12]==t[12]&&this[13]==t[13]&&this[14]==t[14]&&this[15]==t[15]},u.prototype.equalsWithPrecision=function(t,e){return t&&this[0].toFixed(e)==t[0].toFixed(e)&&this[1].toFixed(e)==t[1].toFixed(e)&&this[2].toFixed(e)==t[2].toFixed(e)&&this[3].toFixed(e)==t[3].toFixed(e)&&this[4].toFixed(e)==t[4].toFixed(e)&&this[5].toFixed(e)==t[5].toFixed(e)&&this[6].toFixed(e)==t[6].toFixed(e)&&this[7].toFixed(e)==t[7].toFixed(e)&&this[8].toFixed(e)==t[8].toFixed(e)&&this[9].toFixed(e)==t[9].toFixed(e)&&this[10].toFixed(e)==t[10].toFixed(e)&&this[11].toFixed(e)==t[11].toFixed(e)&&this[12].toFixed(e)==t[12].toFixed(e)&&this[13].toFixed(e)==t[13].toFixed(e)&&this[14].toFixed(e)==t[14].toFixed(e)&&this[15].toFixed(e)==t[15].toFixed(e)},u.prototype.columnMajorComponents=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","columnMajorComponents","missingResult"));return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t},u.prototype.setToTranslation=function(t,e,r){return this[0]=1,this[1]=0,this[2]=0,this[3]=t,this[4]=0,this[5]=1,this[6]=0,this[7]=e,this[8]=0,this[9]=0,this[10]=1,this[11]=r,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.setTranslation=function(t,e,r){return this[3]=t,this[7]=e,this[11]=r,this},u.prototype.setToScale=function(t,e,r){return this[0]=t,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=e,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=r,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.setScale=function(t,e,r){return this[0]=t,this[5]=e,this[10]=r,this},u.prototype.setToTransposeOfMatrix=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToTransposeOfMatrix","missingMatrix"));return this[0]=t[0],this[1]=t[4],this[2]=t[8],this[3]=t[12],this[4]=t[1],this[5]=t[5],this[6]=t[9],this[7]=t[13],this[8]=t[2],this[9]=t[6],this[10]=t[10],this[11]=t[14],this[12]=t[3],this[13]=t[7],this[14]=t[11],this[15]=t[15],this},u.prototype.setToMultiply=function(t,i){if(!t||!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToMultiply","missingMatrix"));var n=t,o=i;return this[0]=n[0]*o[0]+n[1]*o[4]+n[2]*o[8]+n[3]*o[12],this[1]=n[0]*o[1]+n[1]*o[5]+n[2]*o[9]+n[3]*o[13],this[2]=n[0]*o[2]+n[1]*o[6]+n[2]*o[10]+n[3]*o[14],this[3]=n[0]*o[3]+n[1]*o[7]+n[2]*o[11]+n[3]*o[15],this[4]=n[4]*o[0]+n[5]*o[4]+n[6]*o[8]+n[7]*o[12],this[5]=n[4]*o[1]+n[5]*o[5]+n[6]*o[9]+n[7]*o[13],this[6]=n[4]*o[2]+n[5]*o[6]+n[6]*o[10]+n[7]*o[14],this[7]=n[4]*o[3]+n[5]*o[7]+n[6]*o[11]+n[7]*o[15],this[8]=n[8]*o[0]+n[9]*o[4]+n[10]*o[8]+n[11]*o[12],this[9]=n[8]*o[1]+n[9]*o[5]+n[10]*o[9]+n[11]*o[13],this[10]=n[8]*o[2]+n[9]*o[6]+n[10]*o[10]+n[11]*o[14],this[11]=n[8]*o[3]+n[9]*o[7]+n[10]*o[11]+n[11]*o[15],this[12]=n[12]*o[0]+n[13]*o[4]+n[14]*o[8]+n[15]*o[12],this[13]=n[12]*o[1]+n[13]*o[5]+n[14]*o[9]+n[15]*o[13],this[14]=n[12]*o[2]+n[13]*o[6]+n[14]*o[10]+n[15]*o[14],this[15]=n[12]*o[3]+n[13]*o[7]+n[14]*o[11]+n[15]*o[15],this},u.prototype.setToCovarianceOfPoints=function(t){if(!t||t.length<1)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToCovarianceOfPoints","missingArray"));var i,n,o,a,l=0,u=0,c=0,h=0,f=0,d=0,p=0,g=new s(0,0,0);i=s.averageOfBuffer(t,new s(0,0,0));for(var m=0,y=t.length/3;m<y;m++)g[0]=t[3*m],g[1]=t[3*m+1],g[2]=t[3*m+2],n=g[0]-i[0],o=g[1]-i[1],a=g[2]-i[2],++l,u+=n*n,c+=o*o,h+=a*a,f+=n*o,d+=n*a,p+=o*a;return this[0]=u/l,this[1]=f/l,this[2]=d/l,this[3]=0,this[4]=f/l,this[5]=c/l,this[6]=p/l,this[7]=0,this[8]=d/l,this[9]=p/l,this[10]=h/l,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=0,this},u.prototype.multiplyByTranslation=function(t,e,r){return this.multiply(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},u.prototype.multiplyByRotation=function(e,r,i,n){var o=Math.cos(n*t.DEGREES_TO_RADIANS),a=Math.sin(n*t.DEGREES_TO_RADIANS);return this.multiply(o+(1-o)*e*e,(1-o)*e*r-a*i,(1-o)*e*i+a*r,0,(1-o)*e*r+a*i,o+(1-o)*r*r,(1-o)*r*i-a*e,0,(1-o)*e*i-a*r,(1-o)*r*i+a*e,o+(1-o)*i*i,0,0,0,0,1),this},u.prototype.multiplyByScale=function(t,e,r){return this.multiply(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},u.prototype.setToUnitYFlip=function(){return this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=-1,this[6]=0,this[7]=1,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.multiplyByLocalCoordinateTransform=function(t,i){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLocalCoordinateTransform","Origin vector is null or undefined"));if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLocalCoordinateTransform","missingGlobe"));var n=new s(0,0,0),o=new s(0,0,0),a=new s(0,0,0);return l.localCoordinateAxesAtPoint(t,i,n,o,a),this.multiply(n[0],o[0],a[0],t[0],n[1],o[1],a[1],t[1],n[2],o[2],a[2],t[2],0,0,0,1),this},u.prototype.multiplyByTextureTransform=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByTextureTransform","missingTexture"));var i=t.originalImageWidth/t.imageWidth,n=t.originalImageHeight/t.imageHeight;return this.multiply(i,0,0,0,0,-n,0,n,0,0,1,0,0,0,0,1),this},u.prototype.extractTranslation=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractTranslation","missingResult"));return t[0]=this[3],t[1]=this[7],t[2]=this[11],t},u.prototype.extractRotationAngles=function(i){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractRotationAngles","missingResult"));var n=Math.atan2(this[6],this[10]),o=Math.atan2(-this[2],Math.sqrt(this[0]*this[0]+this[1]*this[1])),a=Math.cos(n),s=Math.sin(n),l=Math.atan2(s*this[8]-a*this[4],a*this[5]-s*this[9]);return i[0]=n*t.RADIANS_TO_DEGREES,i[1]=o*t.RADIANS_TO_DEGREES,i[2]=l*t.RADIANS_TO_DEGREES,i},u.prototype.multiplyByFirstPersonModelview=function(i,n,o,a,u){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByFirstPersonModelview","missingPosition"));if(!u)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByFirstPersonModelview","missingGlobe"));var c,h,f,d,p,g,m,y,v,b,E,w,_,x,S=new s(0,0,0),T=new s(0,0,0),M=new s(0,0,0),L=new s(0,0,0);return c=Math.cos(a*t.DEGREES_TO_RADIANS),h=Math.sin(a*t.DEGREES_TO_RADIANS),this.multiply(c,h,0,0,-h,c,0,0,0,0,1,0,0,0,0,1),c=Math.cos(o*t.DEGREES_TO_RADIANS),h=Math.sin(o*t.DEGREES_TO_RADIANS),this.multiply(1,0,0,0,0,c,h,0,0,-h,c,0,0,0,0,1),c=Math.cos(n*t.DEGREES_TO_RADIANS),h=Math.sin(n*t.DEGREES_TO_RADIANS),this.multiply(c,-h,0,0,h,c,0,0,0,0,1,0,0,0,0,1),u.computePointFromPosition(i.latitude,i.longitude,i.altitude,S),f=S[0],d=S[1],p=S[2],l.localCoordinateAxesAtPoint(S,u,T,M,L),g=T[0],m=T[1],y=T[2],v=M[0],b=M[1],E=M[2],w=L[0],_=L[1],x=L[2],this.multiply(g,m,y,-g*f-m*d-y*p,v,b,E,-v*f-b*d-E*p,w,_,x,-w*f-_*d-x*p,0,0,0,1),this},u.prototype.multiplyByLookAtModelview=function(t,i,n,o,a,s){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","missingPosition"));if(i<0)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","Range is less than zero"));if(!s)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","missingGlobe"));return this.multiplyByTranslation(0,0,-i),this.multiplyByFirstPersonModelview(t,n,o,a,s),this},u.prototype.setToPerspectiveProjection=function(t,i,n,o,a){if(t<=0)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","invalidWidth"));if(i<=0)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","invalidHeight"));if(n<=0||n>=180)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","invalidFieldOfView"));if(o===a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","Near and far distance are the same."));if(o<=0||a<=0)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","Near or far distance is less than or equal to zero."));var s=t/i,u=Math.tan(l.toRadians(.5*n)),c=2*o*u,h=c*s,f=o,d=a;return this[0]=2*f/h,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=2*f/c,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=-(d+f)/(d-f),this[11]=-(2*f*d)/(d-f),this[12]=0,this[13]=0,this[14]=-1,this[15]=0,this},u.prototype.setToScreenProjection=function(t,i){if(t<=0)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToScreenProjection","invalidWidth"));if(i<=0)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToScreenProjection","invalidHeight"));return this[0]=2/t,this[1]=0,this[2]=0,this[3]=-1,this[4]=0,this[5]=2/i,this[6]=0,this[7]=-1,this[8]=0,this[9]=0,this[10]=2,this[11]=-1,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.setToInfiniteProjection=function(t,i,n,o){if(t<=0)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToInfiniteProjection","invalidWidth"));if(i<=0)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToInfiniteProjection","invalidHeight"));if(n<=0||n>=180)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToInfiniteProjection","invalidFieldOfView"));if(o<=0)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","setToInfiniteProjection","invalidClipDistance"));var a=t/i,s=Math.tan(l.toRadians(.5*n)),u=2*o*s,c=u*a,h=o;return this[0]=2*h/c,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=2*h/u,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=-1,this[11]=-2*h,this[12]=0,this[13]=0,this[14]=-1,this[15]=0,this},u.prototype.extractEyePoint=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractEyePoint","missingResult"));return t[0]=-(this[0]*this[3])-this[4]*this[7]-this[8]*this[11],t[1]=-(this[1]*this[3])-this[5]*this[7]-this[9]*this[11],t[2]=-(this[2]*this[3])-this[6]*this[7]-this[10]*this[11],t},u.prototype.extractForwardVector=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractForwardVector","missingResult"));return t[0]=-this[8],t[1]=-this[9],t[2]=-this[10],t},u.prototype.extractViewingParameters=function(i,o,a,s){if(!i)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractViewingParameters","The specified origin is null or undefined."));if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractViewingParameters","missingGlobe"));if(!s)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","extractViewingParameters","missingResult"));var l,c,h,f,d,p,g,m,y,v=new n(0,0,0),b=u.fromIdentity();return a.computePositionFromPoint(i[0],i[1],i[2],v),b.copy(this),b.multiplyByLocalCoordinateTransform(i,a),l=-b[11],c=b[10],h=Math.sqrt(b[2]*b[2]+b[6]*b[6]),f=Math.atan2(h,c)*t.RADIANS_TO_DEGREES,d=Math.cos(o*t.DEGREES_TO_RADIANS),p=Math.sin(o*t.DEGREES_TO_RADIANS),g=d*b[0]-p*b[4],m=p*b[5]-d*b[1],y=Math.atan2(m,g)*t.RADIANS_TO_DEGREES,s.origin=v,s.range=l,s.heading=y,s.tilt=f,s.roll=o,s},u.prototype.offsetProjectionDepth=function(t){return this[10]*=1+t,this},u.prototype.multiplyMatrix=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","multiplyMatrix","missingMatrix"));var i,n,o,a,s=this,l=t;return i=s[0],n=s[1],o=s[2],a=s[3],s[0]=i*l[0]+n*l[4]+o*l[8]+a*l[12],s[1]=i*l[1]+n*l[5]+o*l[9]+a*l[13],s[2]=i*l[2]+n*l[6]+o*l[10]+a*l[14],s[3]=i*l[3]+n*l[7]+o*l[11]+a*l[15],i=s[4],n=s[5],o=s[6],a=s[7],s[4]=i*l[0]+n*l[4]+o*l[8]+a*l[12],s[5]=i*l[1]+n*l[5]+o*l[9]+a*l[13],s[6]=i*l[2]+n*l[6]+o*l[10]+a*l[14],s[7]=i*l[3]+n*l[7]+o*l[11]+a*l[15],i=s[8],n=s[9],o=s[10],a=s[11],s[8]=i*l[0]+n*l[4]+o*l[8]+a*l[12],s[9]=i*l[1]+n*l[5]+o*l[9]+a*l[13],s[10]=i*l[2]+n*l[6]+o*l[10]+a*l[14],s[11]=i*l[3]+n*l[7]+o*l[11]+a*l[15],i=s[12],n=s[13],o=s[14],a=s[15],s[12]=i*l[0]+n*l[4]+o*l[8]+a*l[12],s[13]=i*l[1]+n*l[5]+o*l[9]+a*l[13],s[14]=i*l[2]+n*l[6]+o*l[10]+a*l[14],s[15]=i*l[3]+n*l[7]+o*l[11]+a*l[15],this},u.prototype.multiply=function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g){var m,y,v,b,E=this;return m=E[0],y=E[1],v=E[2],b=E[3],E[0]=m*t+y*n+v*l+b*f,E[1]=m*e+y*o+v*u+b*d,E[2]=m*r+y*a+v*c+b*p,E[3]=m*i+y*s+v*h+b*g,m=E[4],y=E[5],v=E[6],b=E[7],E[4]=m*t+y*n+v*l+b*f,E[5]=m*e+y*o+v*u+b*d,E[6]=m*r+y*a+v*c+b*p,E[7]=m*i+y*s+v*h+b*g,m=E[8],y=E[9],v=E[10],b=E[11],E[8]=m*t+y*n+v*l+b*f,E[9]=m*e+y*o+v*u+b*d,E[10]=m*r+y*a+v*c+b*p,E[11]=m*i+y*s+v*h+b*g,m=E[12],y=E[13],v=E[14],b=E[15],E[12]=m*t+y*n+v*l+b*f,E[13]=m*e+y*o+v*u+b*d,E[14]=m*r+y*a+v*c+b*p,E[15]=m*i+y*s+v*h+b*g,this},u.prototype.invertMatrix=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","invertMatrix","missingMatrix"));var i=[[],[],[],[]];i[0][0]=t[0],i[0][1]=t[1],i[0][2]=t[2],i[0][3]=t[3],i[1][0]=t[4],i[1][1]=t[5],i[1][2]=t[6],i[1][3]=t[7],i[2][0]=t[8],i[2][1]=t[9],i[2][2]=t[10],i[2][3]=t[11],i[3][0]=t[12],i[3][1]=t[13],i[3][2]=t[14],i[3][3]=t[15];var n,o,a=[],s=u.ludcmp(i,a);for(n=0;n<4;n+=1)s*=i[n][n];if(Math.abs(s)<1e-8)return null;var l=[[],[],[],[]],c=[];for(o=0;o<4;o+=1){for(n=0;n<4;n+=1)c[n]=0;for(c[o]=1,u.lubksb(i,a,c),n=0;n<4;n+=1)l[n][o]=c[n]}return this[0]=l[0][0],this[1]=l[0][1],this[2]=l[0][2],this[3]=l[0][3],this[4]=l[1][0],this[5]=l[1][1],this[6]=l[1][2],this[7]=l[1][3],this[8]=l[2][0],this[9]=l[2][1],this[10]=l[2][2],this[11]=l[2][3],this[12]=l[3][0],this[13]=l[3][1],this[14]=l[3][2],this[15]=l[3][3],this},u.lubksb=function(t,e,r){var i,n,o,a=-1;for(i=0;i<4;i+=1){var s=e[i];if(o=r[s],r[s]=r[i],a!=-1)for(n=a;n<=i-1;n+=1)o-=t[i][n]*r[n];else 0!=o&&(a=i);r[i]=o}for(i=3;i>=0;i-=1){for(o=r[i],n=i+1;n<4;n+=1)o-=t[i][n]*r[n];r[i]=o/t[i][i]}},u.ludcmp=function(t,e){var r,i,n,o,a,s,l,u,c=1e-20,h=[],f=1;for(i=0;i<4;i+=1){for(a=0,n=0;n<4;n+=1)(r=Math.abs(t[i][n]))>a&&(a=r);if(0==a)return 0;h[i]=1/a}for(n=0;n<4;n+=1){for(i=0;i<n;i+=1){for(s=t[i][n],o=0;o<i;o+=1)s-=t[i][o]*t[o][n];t[i][n]=s}for(a=0,l=-1,i=n;i<4;i+=1){for(s=t[i][n],o=0;o<n;o++)s-=t[i][o]*t[o][n];t[i][n]=s,(u=h[i]*Math.abs(s))>=a&&(a=u,l=i)}if(n!=l){for(o=0;o<4;o+=1)u=t[l][o],t[l][o]=t[n][o],t[n][o]=u;f=-f,h[l]=h[n]}if(e[n]=l,0==t[n][n]&&(t[n][n]=c),3!=n)for(u=1/t[n][n],i=n+1;i<4;i+=1)t[i][n]*=u}return f},u.prototype.invertOrthonormalMatrix=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","invertOrthonormalMatrix","missingMatrix"));var i=t;return this[0]=i[0],this[1]=i[4],this[2]=i[8],this[3]=0-i[0]*i[3]-i[4]*i[7]-i[8]*i[11],this[4]=i[1],this[5]=i[5],this[6]=i[9],this[7]=0-i[1]*i[3]-i[5]*i[7]-i[9]*i[11],this[8]=i[2],this[9]=i[6],this[10]=i[10],this[11]=0-i[2]*i[3]-i[6]*i[7]-i[10]*i[11],this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.invertOrthonormal=function(t){if(!t)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","invertOrthonormalMatrix","missingMatrix"));var i=t,n=i[1],o=i[2],a=i[6],s=i[3],l=i[7],u=i[11];return this[0]=i[0],this[1]=i[4],this[2]=i[8],this[3]=0-i[0]*s-i[1]*l-i[2]*u,this[4]=n,this[5]=i[5],this[6]=i[9],this[7]=0-i[4]*s-i[5]*l-i[6]*u,this[8]=o,this[9]=a,this[10]=i[10],this[11]=0-i[8]*s-i[9]*l-i[10]*u,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},u.prototype.eigensystemFromSymmetricMatrix=function(t,i,n){if(!t||!i||!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","eigensystemFromSymmetricMatrix","missingResult"));if(this[1]!=this[4]||this[2]!=this[8]||this[6]!=this[9])throw new e(r.logMessage(r.LEVEL_SEVERE,"Matrix","eigensystemFromSymmetricMatrix","Matrix is not symmetric"));for(var o,a,s,u,c,h,f,d,p,g,m,y=1e-10,v=this[0],b=this[1],E=this[2],w=this[5],_=this[6],x=this[10],S=[[1,0,0],[0,1,0],[0,0,1]],T=32,M=0;M<T&&!(l.fabs(b)<y&&l.fabs(E)<y&&l.fabs(_)<y);M++){if(0!=b)for(o=.5*(w-v)/b,a=o*o,s=a+1,u=s!=a?(o<0?-1:1)*(Math.sqrt(s)-l.fabs(o)):.5/o,c=1/Math.sqrt(u*u+1),h=c*u,v-=u*b,w+=u*b,b=0,f=c*E-h*_,_=h*E+c*_,E=f,d=0;d<3;d++)f=c*S[d][0]-h*S[d][1],S[d][1]=h*S[d][0]+c*S[d][1],S[d][0]=f;if(0!=E)for(o=.5*(x-v)/E,a=o*o,s=a+1,u=s!=a?(o<0?-1:1)*(Math.sqrt(s)-l.fabs(o)):.5/o,c=1/Math.sqrt(u*u+1),h=c*u,v-=u*E,x+=u*E,E=0,f=c*b-h*_,_=h*b+c*_,b=f,d=0;d<3;d++)f=c*S[d][0]-h*S[d][2],S[d][2]=h*S[d][0]+c*S[d][2],S[d][0]=f;if(0!=_)for(o=.5*(x-w)/_,a=o*o,s=a+1,u=s!=a?(o<0?-1:1)*(Math.sqrt(s)-l.fabs(o)):.5/o,c=1/Math.sqrt(u*u+1),h=c*u,w-=u*_,x+=u*_,_=0,f=c*b-h*E,E=h*b+c*E,b=f,d=0;d<3;d++)f=c*S[d][1]-h*S[d][2],S[d][2]=h*S[d][1]+c*S[d][2],S[d][1]=f}p=0,g=1,m=2,v<w&&(f=v,v=w,w=f,f=p,p=g,g=f),w<x&&(f=w,w=x,x=f,f=g,g=m,m=f),v<w&&(f=v,v=w,w=f,f=p,p=g,g=f),t[0]=S[0][p],t[1]=S[1][p],t[2]=S[2][p],i[0]=S[0][g],i[1]=S[1][g],i[2]=S[2][g],n[0]=S[0][m],n[1]=S[1][m],n[2]=S[2][m],t.normalize(),i.normalize(),n.normalize(),t.multiply(v),i.multiply(w),n.multiply(x)},u.prototype.upper3By3=function(){var t=u.fromIdentity();return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[4]=this[4],t[5]=this[5],t[6]=this[6],t[8]=this[8],t[9]=this[9],t[10]=this[10],t},u}),define("worldwind/pick/PickedObject",[],function(){"use strict";var t=function(t,e,r,i,n){this.color=t,this.userObject=e,this.position=r,this.parentLayer=i,this.isTerrain=n,this.isOnTop=!1};return t}),define("worldwind/error/UnsupportedOperationError",["../error/AbstractError"],function(t){"use strict";var e=function(e){t.call(this,"UnsupportedOperationError",e);var r;try{throw new Error}catch(t){r=t.stack}this.stack=r};return e.prototype=Object.create(t.prototype),e}),define("worldwind/render/Renderable",["../util/Logger","../error/UnsupportedOperationError"],function(t,e){"use strict";var r=function(){this.displayName="Renderable",this.enabled=!0,this.pickDelegate=null,this.userProperties={}};return r.prototype.render=function(r){throw new e(t.logMessage(t.LEVEL_SEVERE,"Renderable","render","abstractInvocation"))},r}),define("worldwind/shapes/Annotation",["../shapes/AnnotationAttributes","../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Insets","../util/Logger","../geom/Matrix","../util/Offset","../pick/PickedObject","../render/Renderable","../shapes/TextAttributes","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p){"use strict";var g=function(r,i){if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Annotation","constructor","missingPosition"));c.call(this),this.position=r,this.attributes=i?i:new t(null),this.altitudeMode=WorldWind.ABSOLUTE,this.layer=null,this.lastStateKey=null,this.calloutTransform=s.fromIdentity(),this.calloutOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0),this.label="",this.labelTexture=null,this.labelTransform=s.fromIdentity(),this.placePoint=new d(0,0,0),this.depthOffset=-2.05,this.calloutPoints=null};return g.matrix=s.fromIdentity(),g.screenPoint=new d(0,0,0),g.scratchPoint=new d(0,0,0),g.prototype=Object.create(c.prototype),Object.defineProperties(g.prototype,{text:{get:function(){return this.label},set:function(t){this.label=t,this.lastStateKey=null}}}),g.prototype.renderOrdered=function(t){if(this.drawOrderedAnnotation(t),t.pickingMode){var e=new u(this.pickColor.clone(),this,this.position,this.layer,!1);t.pickPoint&&this.labelBounds.containsPoint(t.navigatorState.convertPointToViewport(t.pickPoint,g.scratchPoint))&&(e.labelPicked=!0),t.resolvePick(e)}},g.prototype.clone=function(){var t=new g(this.position);return t.copy(this),t.pickDelegate=this.pickDelegate?this.pickDelegate:this,t},g.prototype.copy=function(t){return this.position=t.position,this.enabled=t.enabled,this.attributes=t.attributes,this.label=t.label,this.altitudeMode=t.altitudeMode,this.pickDelegate=t.pickDelegate,this.depthOffset=t.depthOffset,this},g.prototype.render=function(t){if(this.enabled&&t.accumulateOrderedRenderables&&(!t.globe.projectionLimits||t.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude))){var e;if(this.lastFrameTime!==t.timestamp)e=this.makeOrderedRenderable(t);else{var r=this.clone();e=r.makeOrderedRenderable(t)}e&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e))}},g.prototype.drawOrderedAnnotation=function(t){this.beginDrawing(t);try{this.doDrawOrderedAnnotation(t)}finally{this.endDrawing(t)}},g.prototype.makeOrderedRenderable=function(t){var e,r,i,n,o,a,s,l,u;if(this.label=t.textSupport.wrap(this.label,this.attributes.width,this.attributes.height,this.attributes.textAttributes.font),t.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint),this.eyeDistance=t.navigatorState.eyePoint.distanceTo(this.placePoint),!t.navigatorState.projectWithDepth(this.placePoint,this.depthOffset,g.screenPoint))return null;var c=this.attributes.textAttributes.font,h=this.label+c.toString();this.labelTexture=t.gpuResourceCache.resourceForKey(h),this.labelTexture||(this.labelTexture=t.textSupport.createTexture(t,this.label,c,!1),t.gpuResourceCache.putResource(h,this.labelTexture,this.labelTexture.size)),e=this.labelTexture.imageWidth,r=this.labelTexture.imageHeight,i=this.attributes.scale,n=this.attributes.insets.left,o=this.attributes.insets.right,a=this.attributes.insets.top,s=this.attributes.insets.bottom,u=this.attributes.leaderGapHeight,l=this.calloutOffset.offsetForSize((e+n+o)*i,(r+a+s)*i),this.calloutTransform.setTranslation(g.screenPoint[0]-l[0],g.screenPoint[1]+u,g.screenPoint[2]),this.labelTransform.setTranslation(g.screenPoint[0]-l[0]+n*i,g.screenPoint[1]+u+s*i,g.screenPoint[2]),this.labelTransform.setScale(e*i,r*i,1),this.labelBounds=p.boundingRectForUnitQuad(this.labelTransform);var f=(e+n+o)*i,d=(r+a+s)*i,m=f/2,y=-u;return this.attributes.drawLeader||(y=0),this.attributes.stateKey!=this.lastStateKey&&(this.calloutPoints=this.createCallout(f,d,m,y,this.attributes.leaderGapWidth,this.attributes.cornerRadius)),this},g.prototype.beginDrawing=function(t){var e,i=t.currentGlContext;t.findAndBindProgram(r),e=t.currentProgram,i.enableVertexAttribArray(e.vertexPointLocation),i.enableVertexAttribArray(e.vertexTexCoordLocation),e.loadModulateColor(i,t.pickingMode)},g.prototype.endDrawing=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),t.bindProgram(null)},g.prototype.drawCorner=function(t,e,r,i,n,o,a,s){if(r<1)return s;for(var l=(n-i)/(o-1),u=1;u<o-1;u++){var c=i+l*u,h=t+Math.cos(c)*r,f=e+Math.sin(c)*r;a[s++]=h,a[s++]=f}return s},g.prototype.createCallout=function(t,e,r,i,n,o){var a=16,s=2*(12+(o<1?0:4*(a-2))),l=new Float32Array(s),u=0;return l[u++]=t/2+n/2,l[u++]=0,l[u++]=t-o,l[u++]=0,u=this.drawCorner(t-o,o,o,-Math.PI/2,0,a,l,u),l[u++]=t,l[u++]=o,l[u++]=t,l[u++]=e-o,u=this.drawCorner(t-o,e-o,o,0,Math.PI/2,a,l,u),l[u++]=t-o,l[u++]=e,l[u++]=o,l[u++]=e,u=this.drawCorner(o,e-o,o,Math.PI/2,Math.PI,a,l,u),l[u++]=0,l[u++]=e-o,l[u++]=0,l[u++]=o,u=this.drawCorner(o,o,o,Math.PI,1.5*Math.PI,a,l,u),l[u++]=o,l[u++]=0,l[u++]=t/2-n/2,l[u++]=0,l[u++]=r,l[u++]=i,l[u++]=t/2+n/2,l[u]=0,l},g.prototype.doDrawOrderedAnnotation=function(t){var e,r=t.currentGlContext,i=t.currentProgram,n=!1;t.pickingMode&&(this.pickColor=t.uniquePickColor()),i.loadOpacity(r,this.attributes.opacity);var o=this.attributes.stateKey!=this.lastStateKey;this.calloutCacheKey&&!o||(this.calloutCacheKey=t.gpuResourceCache.generateCacheKey());var a=t.gpuResourceCache.resourceForKey(this.calloutCacheKey);a||(a=r.createBuffer(),t.gpuResourceCache.putResource(this.calloutCacheKey,a,4*this.calloutPoints.length),n=!0),o&&this.calloutCacheKey&&t.gpuResourceCache.removeResource(this.calloutCacheKey),this.lastStateKey=this.attributes.stateKey,g.matrix.copy(t.screenProjection),g.matrix.multiplyMatrix(this.calloutTransform),i.loadModelviewProjection(r,g.matrix),r.bindBuffer(r.ARRAY_BUFFER,a),n&&(r.bufferData(r.ARRAY_BUFFER,this.calloutPoints,r.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),i.loadColor(r,t.pickingMode?this.pickColor:this.attributes.backgroundColor),i.loadTextureEnabled(r,!1),r.vertexAttribPointer(i.vertexPointLocation,2,r.FLOAT,!1,0,0),r.vertexAttribPointer(i.vertexTexCoordLocation,2,r.FLOAT,!1,0,0),r.drawArrays(r.TRIANGLE_FAN,0,this.calloutPoints.length/2),g.matrix.copy(t.screenProjection),g.matrix.multiplyMatrix(this.labelTransform),i.loadModelviewProjection(r,g.matrix),g.matrix.setToIdentity(),g.matrix.multiplyByTextureTransform(this.labelTexture),i.loadTextureMatrix(r,g.matrix),i.loadColor(r,t.pickingMode?this.pickColor:this.attributes.textAttributes.color),e=this.labelTexture.bind(t),i.loadTextureEnabled(r,e),r.bindBuffer(r.ARRAY_BUFFER,t.unitQuadBuffer3()),r.vertexAttribPointer(i.vertexPointLocation,3,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,t.unitQuadBuffer()),r.vertexAttribPointer(i.vertexTexCoordLocation,2,r.FLOAT,!1,0,0),r.drawArrays(r.TRIANGLE_STRIP,0,4)},g}),define("worldwind/util/measure/MeasurerUtils",["../../geom/Location","../../geom/Position"],function(t,e){"use strict";var r={subdividePositions:function(r,i,n,o,a){var s,l=[],u=new t(0,0),c=new t(0,0),h=i[0];this.addPosition(r,l,h,n);for(var f=1;f<i.length;f++){var d=i[f],p=t.greatCircleDistance(h,d);u=t.interpolateAlongPath(o,.5,h,d,u);var g=p*r.radiusAt(u.latitude,u.longitude);if(g>a)for(var m=null,y=null,v=Math.ceil(g/a),b=1;b<v;b++){var E=b/v;o===WorldWind.LINEAR?c=t.interpolateLinear(E,h,d,c):o===WorldWind.RHUMB_LINE?(null==m&&(m=t.rhumbAzimuth(h,d),y=t.rhumbDistance(h,d)),c=t.rhumbLocation(h,m,E*y,c)):(null==m&&(m=t.greatCircleAzimuth(h,d),y=t.greatCircleDistance(h,d)),c=t.greatCircleLocation(h,m,E*y,c)),s=n?r.elevationAtLocation(c.latitude,c.longitude):h.altitude*(1-E)+d.altitude*E,l.push(new e(c.latitude,c.longitude,s))}this.addPosition(r,l,d,n),h=d}return l},addPosition:function(t,r,i,n){var o=i.altitude;return n&&(o=t.elevationAtLocation(i.latitude,i.longitude)),r.push(new e(i.latitude,i.longitude,o)),r},isLocationInside:function(t,e){for(var r=!1,i=e[0],n=1,o=e.length;n<o;n++){var a=e[n];(a.latitude<=t.latitude&&t.latitude<i.latitude||i.latitude<=t.latitude&&t.latitude<a.latitude)&&t.longitude<(i.longitude-a.longitude)*(t.latitude-a.latitude)/(i.latitude-a.latitude)+a.longitude&&(r=!r),i=a}return r},angleBetweenVectors:function(t,e){var r=t.dot(e),i=t.magnitude()*e.magnitude();return 0!==i&&1!==i&&(r/=i),r<-1?r=-1:r>1&&(r=1),Math.acos(r)}};return r}),define("worldwind/geom/Sector",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o){"use strict";var a=function(t,e,r,i){this.minLatitude=t,this.maxLatitude=e,this.minLongitude=r,this.maxLongitude=i};return a.ZERO=new a(0,0,0,0),a.FULL_SPHERE=new a(-90,90,-180,180),a.prototype.copy=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","copy","missingSector"));return this.minLatitude=t.minLatitude,this.maxLatitude=t.maxLatitude,this.minLongitude=t.minLongitude,this.maxLongitude=t.maxLongitude,this},a.prototype.isEmpty=function(){return this.minLatitude===this.maxLatitude&&this.minLongitude===this.maxLongitude},a.prototype.deltaLatitude=function(){return this.maxLatitude-this.minLatitude},a.prototype.deltaLongitude=function(){return this.maxLongitude-this.minLongitude},a.prototype.centroidLatitude=function(){return.5*(this.minLatitude+this.maxLatitude)},a.prototype.centroidLongitude=function(){return.5*(this.minLongitude+this.maxLongitude)},a.prototype.centroid=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","centroid","missingResult"));return t.latitude=this.centroidLatitude(),t.longitude=this.centroidLongitude(),t},a.prototype.minLatitudeRadians=function(){return this.minLatitude*t.DEGREES_TO_RADIANS},a.prototype.maxLatitudeRadians=function(){return this.maxLatitude*t.DEGREES_TO_RADIANS},a.prototype.minLongitudeRadians=function(){return this.minLongitude*t.DEGREES_TO_RADIANS},a.prototype.maxLongitudeRadians=function(){return this.maxLongitude*t.DEGREES_TO_RADIANS},a.prototype.setToBoundingSector=function(t){if(!t||t.length<2)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","setToBoundingSector","missingArray"));for(var r=90,n=-90,o=180,a=-180,s=0,l=t.length;s<l;s+=1){var u=t[s];u&&(r=Math.min(r,u.latitude),n=Math.max(n,u.latitude),o=Math.min(o,u.longitude),a=Math.max(a,u.longitude))}return this.minLatitude=r,this.maxLatitude=n,this.minLongitude=o,this.maxLongitude=a,this},a.splitBoundingSectors=function(t){if(!t||t.length<2)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","splitBoundingSectors","missingArray"));for(var r=90,n=180,s=-90,l=-180,u=null,c=0,h=t.length;c<h;c+=1){var f=t[c],d=f.latitude;d<r&&(r=d),d>s&&(s=d);var p=f.longitude;if(p>=0&&p<n&&(n=p),p<=0&&p>l&&(l=p),null!=u){var g=u.longitude;o.signum(p)!=o.signum(g)&&Math.abs(p-g)<180&&(l=0,n=0)}u=f}return r===s&&n===l?null:[new a(r,s,n,180),new a(r,s,-180,l)];
},a.prototype.intersects=function(t){return t&&this.minLongitude<=t.maxLongitude&&this.maxLongitude>=t.minLongitude&&this.minLatitude<=t.maxLatitude&&this.maxLatitude>=t.minLatitude},a.prototype.overlaps=function(t){return t&&this.minLongitude<t.maxLongitude&&this.maxLongitude>t.minLongitude&&this.minLatitude<t.maxLatitude&&this.maxLatitude>t.minLatitude},a.prototype.contains=function(t){return t&&this.minLatitude<=t.minLatitude&&this.maxLatitude>=t.maxLatitude&&this.minLongitude<=t.minLongitude&&this.maxLongitude>=t.maxLongitude},a.prototype.containsLocation=function(t,e){return this.minLatitude<=t&&this.maxLatitude>=t&&this.minLongitude<=e&&this.maxLongitude>=e},a.prototype.intersection=function(t){if(!t instanceof a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","intersection","missingSector"));return this.minLatitude<t.minLatitude&&(this.minLatitude=t.minLatitude),this.maxLatitude>t.maxLatitude&&(this.maxLatitude=t.maxLatitude),this.minLongitude<t.minLongitude&&(this.minLongitude=t.minLongitude),this.maxLongitude>t.maxLongitude&&(this.maxLongitude=t.maxLongitude),this.maxLatitude<this.minLatitude&&(this.maxLatitude=this.minLatitude),this.maxLongitude<this.minLongitude&&(this.maxLongitude=this.minLongitude),this},a.prototype.union=function(t){if(!t instanceof a)throw new e(i.logMessage(i.LEVEL_SEVERE,"Sector","union","missingSector"));return this.minLatitude>t.minLatitude&&(this.minLatitude=t.minLatitude),this.maxLatitude<t.maxLatitude&&(this.maxLatitude=t.maxLatitude),this.minLongitude>t.minLongitude&&(this.minLongitude=t.minLongitude),this.maxLongitude<t.maxLongitude&&(this.maxLongitude=t.maxLongitude),this},a}),define("worldwind/util/measure/AreaMeasurer",["../../geom/Angle","../../error/ArgumentError","../../geom/Location","../Logger","./MeasurerUtils","../../geom/Sector","../../geom/Vec3"],function(t,e,r,i,n,o,a){"use strict";var s=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"AreaMeasurer","constructor","missingWorldWindow"));this.wwd=t,this.DEFAULT_AREA_SAMPLING_STEPS=32,this._areaTerrainSamplingSteps=this.DEFAULT_AREA_SAMPLING_STEPS,this._maxSegmentLength=1e5,this.subdividedPositions=null,this.vecZ=new a(0,0,1),this.scratchLocation=new r(0,0)};return Object.defineProperties(s.prototype,{areaTerrainSamplingSteps:{get:function(){return this._areaTerrainSamplingSteps},set:function(t){this._areaTerrainSamplingSteps=t}},maxSegmentLength:{get:function(){return this._maxSegmentLength},set:function(t){this._maxSegmentLength=t}}}),s.prototype.getArea=function(t,e,r){var i=this.wwd.globe;return e?this.computeSurfaceAreaSampling(i,t,r):this.computeProjectedAreaGeometry(i,t,r)},s.prototype.computeSurfaceAreaSampling=function(e,r,i){var s=new o(0,0,0,0);s.setToBoundingSector(r),this.subdividedPositions=n.subdividePositions(e,r,!0,i,this._maxSegmentLength);for(var l=Math.max(this.DEFAULT_AREA_SAMPLING_STEPS,this._areaTerrainSamplingSteps),u=s.deltaLatitude()*t.DEGREES_TO_RADIANS,c=s.deltaLongitude()*t.DEGREES_TO_RADIANS,h=Math.max(u/l,c/l),f=Math.round(u/h),d=Math.round(c/h*Math.cos(s.centroidLatitude()*t.DEGREES_TO_RADIANS)),p=u/f,g=c/d,m=0,y=0;y<f;y++)for(var v=s.minLatitude*t.DEGREES_TO_RADIANS+p*y,b=e.radiusAt((v+p/2)*t.RADIANS_TO_DEGREES,s.centroidLongitude()),E=g*b*Math.cos(v+p/2),w=p*b,_=E*w,x=0;x<d;x++){var S=s.minLongitude*t.DEGREES_TO_RADIANS+g*x,T=v*t.RADIANS_TO_DEGREES,M=(v+p)*t.RADIANS_TO_DEGREES,L=S*t.RADIANS_TO_DEGREES,A=(S+g)*t.RADIANS_TO_DEGREES,N=new o(T,M,L,A),C=n.isLocationInside(N.centroid(this.scratchLocation),this.subdividedPositions);if(C){var R=e.elevationAtLocation(T,L),P=e.elevationAtLocation(T,A),O=e.elevationAtLocation(M,L),I=new a(E,0,P-R),k=new a(0,w,O-R);I.normalize(),k.normalize();var D=I.cross(k).normalize(),V=Math.tan(n.angleBetweenVectors(this.vecZ,D)),F=Math.sqrt(1+V*V);m+=_*F}}return m},s.prototype.computeProjectedAreaGeometry=function(e,r,i){this.subdividedPositions=n.subdividePositions(e,r,!1,i,this._maxSegmentLength);var o=this.subdividedPositions.length,a=this.subdividedPositions[0],s=this.subdividedPositions[o-1];a.equals(s)&&o--;for(var l=[],u=0,c=0;c<o;c++){var h=this.subdividedPositions[c];l[u++]=h.longitude*t.DEGREES_TO_RADIANS,l[u++]=h.latitude*t.DEGREES_TO_RADIANS,l[u++]=0}var f=this.tessellatePolygon(o,l),d=0,p=f.length/9;for(c=0;c<p;c++){u=9*c;var g=[f[u+0],f[u+1],f[u+2],f[u+3],f[u+4],f[u+5],f[u+6],f[u+7],f[u+8]];d+=this.computeTriangleProjectedArea(e,g)}return d},s.prototype.computeTriangleProjectedArea=function(e,r){var i=r[0],n=r[1],o=r[3],a=r[4],s=r[6],l=r[7],u=Math.abs(i*(a-l)+o*(l-n)+s*(n-a));u/=2;var c=(i+o+s)/3,h=(n+a+l)/3,f=e.radiusAt(h*t.RADIANS_TO_DEGREES,c*t.RADIANS_TO_DEGREES);return u*=Math.cos(h)*f*f},s.prototype.tessellatePolygon=function(t,e){var r,n=new window.libtess.GluTesselator,o=[];n.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN,function(t){t!==libtess.primitiveType.GL_TRIANGLES&&i.logMessage(i.LEVEL_WARNING,"AreaMeasurer","tessellatePolygon","Tessellation error, primitive is not TRIANGLES.")}),n.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,function(t,e){e.push(t[0]),e.push(t[1]),e.push(t[2])}),n.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG,function(){}),n.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,function(t){i.logMessage(i.LEVEL_WARNING,"AreaMeasurer","tessellatePolygon","Tessellation error "+t+".")}),n.gluTessBeginPolygon(o),n.gluTessBeginContour();for(var a=0;a<t;a++)r=e.slice(3*a,3*a+3),n.gluTessVertex(r,r);return n.gluTessEndContour(),n.gluTessEndPolygon(),o},s}),define("worldwind/shaders/AtmosphereProgram",["../error/ArgumentError","../shaders/GpuProgram","../util/Logger"],function(t,e,r){"use strict";var i=function(t,r,i,n){e.call(this,t,r,i,n),this.FRAGMODE_SKY=1,this.FRAGMODE_GROUND_PRIMARY=2,this.FRAGMODE_GROUND_SECONDARY=3,this.FRAGMODE_GROUND_PRIMARY_TEX_BLEND=4,this.altitude=16e4,this.rayleighScaleDepth=.25,this.fragModeLocation=this.uniformLocation(t,"fragMode"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.texCoordMatrixLocation=this.uniformLocation(t,"texCoordMatrix"),this.vertexOriginLocation=this.uniformLocation(t,"vertexOrigin"),this.eyePointLocation=this.uniformLocation(t,"eyePoint"),this.eyeMagnitudeLocation=this.uniformLocation(t,"eyeMagnitude"),this.eyeMagnitude2Location=this.uniformLocation(t,"eyeMagnitude2"),this.lightDirectionLocation=this.uniformLocation(t,"lightDirection"),this.atmosphereRadiusLocation=this.uniformLocation(t,"atmosphereRadius"),this.atmosphereRadius2Location=this.uniformLocation(t,"atmosphereRadius2"),this.globeRadiusLocation=this.uniformLocation(t,"globeRadius"),this.scaleLocation=this.uniformLocation(t,"scale"),this.scaleDepthLocation=this.uniformLocation(t,"scaleDepth"),this.scaleOverScaleDepthLocation=this.uniformLocation(t,"scaleOverScaleDepth"),this.scratchArray9=new Float32Array(9)};return i.key="WorldWindGpuAtmosphereProgram",i.prototype=Object.create(e.prototype),i.prototype.getAltitude=function(){return this.altitude},i.prototype.loadFragMode=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadFragMode","missingFragMode"));e.uniform1i(this.fragModeLocation,i)},i.prototype.loadModelviewProjection=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,i,this.mvpMatrixLocation)},i.prototype.loadVertexOrigin=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadVertexOrigin","missingVector"));e.uniform3f(this.vertexOriginLocation,i[0],i[1],i[2])},i.prototype.loadLightDirection=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadLightDirection","missingVector"));e.uniform3f(this.lightDirectionLocation,i[0],i[1],i[2])},i.prototype.loadEyePoint=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadEyePoint","missingVector"));e.uniform3f(this.eyePointLocation,i[0],i[1],i[2]),e.uniform1f(this.eyeMagnitudeLocation,i.magnitude()),e.uniform1f(this.eyeMagnitude2Location,i.magnitudeSquared())},i.prototype.loadGlobeRadius=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadGlobeRadius","missingGlobeRadius"));var n=i,o=n+this.altitude;e.uniform1f(this.globeRadiusLocation,n),e.uniform1f(this.atmosphereRadiusLocation,o),e.uniform1f(this.atmosphereRadius2Location,o*o)},i.prototype.setScale=function(t){t.uniform1f(this.scaleLocation,1/this.getAltitude()),t.uniform1f(this.scaleDepthLocation,this.rayleighScaleDepth),t.uniform1f(this.scaleOverScaleDepthLocation,1/this.getAltitude()/this.rayleighScaleDepth)},i.prototype.loadTexMatrix=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"AtmosphereProgram","loadTexMatrix","missingMatrix"));i.columnMajorComponents(this.scratchArray9),e.uniformMatrix3fv(this.texCoordMatrixLocation,!1,this.scratchArray9)},i}),define("worldwind/shaders/GroundProgram",["../shaders/AtmosphereProgram"],function(t){"use strict";var e=function(e){var r="precision mediump int;\nconst int FRAGMODE_GROUND_PRIMARY_TEX_BLEND = 4;\nconst int SAMPLE_COUNT = 2;\nconst float SAMPLES = 2.0;\nconst float PI = 3.141592653589;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * PI;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * PI;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 invWavelength = vec3(5.60204474633241, 9.473284437923038, 19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nuniform int fragMode;\nuniform mat4 mvpMatrix;\nuniform mat3 texCoordMatrix;\nuniform vec3 vertexOrigin;\nuniform vec3 eyePoint;\nuniform float eyeMagnitude;\nuniform float eyeMagnitude2;\nuniform vec3 lightDirection;\nuniform float atmosphereRadius;\nuniform float atmosphereRadius2;\nuniform float globeRadius;\nuniform float scale;\nuniform float scaleDepth;\nuniform float scaleOverScaleDepth;\nattribute vec4 vertexPoint;\nattribute vec2 vertexTexCoord;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec2 texCoord;\nfloat scaleFunc(float cos) {\n    float x = 1.0 - cos;\n    return scaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid sampleGround() {\n    vec3 point = vertexPoint.xyz + vertexOrigin;\n    vec3 ray = point - eyePoint;\n    float far = length(ray);\n    ray /= far;\n    vec3 start;\n    if (eyeMagnitude < atmosphereRadius) {\n        start = eyePoint;\n    } else {\n        float B = 2.0 * dot(eyePoint, ray);\n        float C = eyeMagnitude2 - atmosphereRadius2;\n        float det = max(0.0, B*B - 4.0 * C);\n        float near = 0.5 * (-B - sqrt(det));\n        start = eyePoint + ray * near;\n        far -= near;\n}\n    float depth = exp((globeRadius - atmosphereRadius) / scaleDepth);\n    float eyeAngle = dot(-ray, point) / length(point);\n    float lightAngle = dot(lightDirection, point) / length(point);\n    float eyeScale = scaleFunc(eyeAngle);\n    float lightScale = scaleFunc(lightAngle);\n    float eyeOffset = depth*eyeScale;\n    float temp = (lightScale + eyeScale);\n    float sampleLength = far / SAMPLES;\n    float scaledLength = sampleLength * scale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    vec3 attenuate = vec3(0.0, 0.0, 0.0);\n    for(int i=0; i<SAMPLE_COUNT; i++)\n    {\n        float height = length(samplePoint);\n        float depth = exp(scaleOverScaleDepth * (globeRadius - height));\n        float scatter = depth*temp - eyeOffset;\n        attenuate = exp(-scatter * (invWavelength * Kr4PI + Km4PI));\n        frontColor += attenuate * (depth * scaledLength);\n        samplePoint += sampleRay;\n    }\n    primaryColor = frontColor * (invWavelength * KrESun + KmESun);\n    secondaryColor = attenuate;\n}\nvoid main()\n {\n    sampleGround();\n    gl_Position = mvpMatrix * vertexPoint;\n    if (fragMode == FRAGMODE_GROUND_PRIMARY_TEX_BLEND) {\n        texCoord = (texCoordMatrix * vec3(vertexTexCoord, 1.0)).st;\n    }\n}",i="precision mediump float;\nprecision mediump int;\nconst int FRAGMODE_GROUND_PRIMARY = 2;\nconst int FRAGMODE_GROUND_SECONDARY = 3;\nconst int FRAGMODE_GROUND_PRIMARY_TEX_BLEND = 4;\nuniform int fragMode;\nuniform sampler2D texSampler;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec2 texCoord;\nvoid main (void)\n{\n    if (fragMode == FRAGMODE_GROUND_PRIMARY) {\n        gl_FragColor = vec4(primaryColor, 1.0);\n    } else if (fragMode == FRAGMODE_GROUND_SECONDARY) {\n        gl_FragColor = vec4(secondaryColor, 1.0);\n    } else if (fragMode == FRAGMODE_GROUND_PRIMARY_TEX_BLEND) {\n        vec4 texColor = texture2D(texSampler, texCoord);\n        gl_FragColor = vec4(primaryColor + texColor.rgb * (1.0 - secondaryColor), 1.0);\n    }\n}";t.call(this,e,r,i,["vertexPoint","vertexTexCoord"])};return e.key="WorldWindGroundProgram",e.prototype=Object.create(t.prototype),e}),define("worldwind/layer/Layer",["../util/Logger"],function(t){"use strict";var e=function(t){this.displayName=t?t:"Layer",this.enabled=!0,this.pickEnabled=!0,this.opacity=1,this.minActiveAltitude=-Number.MAX_VALUE,this.maxActiveAltitude=Number.MAX_VALUE,this.inCurrentFrame=!1,this.time=null};return e.prototype.refresh=function(){},e.prototype.render=function(t){this.inCurrentFrame=!1,this.enabled&&(t.pickingMode&&!this.pickEnabled||this.withinActiveAltitudes(t)&&this.isLayerInView(t)&&this.doRender(t))},e.prototype.doRender=function(t){},e.prototype.withinActiveAltitudes=function(t){var e=t.eyePosition;return!!e&&(e.altitude>=this.minActiveAltitude&&e.altitude<=this.maxActiveAltitude)},e.prototype.isLayerInView=function(t){return!0},e}),define("worldwind/geom/Matrix3",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(t,e,r,i,n,o,a,s,l){this[0]=t,this[1]=e,this[2]=r,this[3]=i,this[4]=n,this[5]=o,this[6]=a,this[7]=s,this[8]=l};return r.prototype=new Float64Array(9),r.fromIdentity=function(){return new r(1,0,0,0,1,0,0,0,1)},r.prototype.setToUnitYFlip=function(){return this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=-1,this[5]=1,this[6]=0,this[7]=0,this[8]=1,this},r.prototype.multiplyMatrix=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"Matrix3","multiplyMatrix","missingMatrix"));var i,n,o,a=this,s=r;return i=a[0],n=a[1],o=a[2],a[0]=i*s[0]+n*s[3]+o*s[6],a[1]=i*s[1]+n*s[4]+o*s[7],a[2]=i*s[2]+n*s[5]+o*s[8],i=a[3],n=a[4],o=a[5],a[3]=i*s[0]+n*s[3]+o*s[6],a[4]=i*s[1]+n*s[4]+o*s[7],a[5]=i*s[2]+n*s[5]+o*s[8],i=a[6],n=a[7],o=a[8],a[6]=i*s[0]+n*s[3]+o*s[6],a[7]=i*s[1]+n*s[4]+o*s[7],a[8]=i*s[2]+n*s[5]+o*s[8],this},r.prototype.multiplyByTileTransform=function(t,e){var r=t.deltaLatitude(),i=t.deltaLongitude(),n=e.deltaLatitude(),o=e.deltaLongitude(),a=i/o,s=r/n,l=(t.minLongitude-e.minLongitude)/o,u=(t.minLatitude-e.minLatitude)/n,c=this;return c[2]+=c[0]*l+c[1]*u,c[5]+=c[3]*l+c[4]*u,c[8]+=c[6]*l+c[6]*u,c[0]*=a,c[1]*=s,c[3]*=a,c[4]*=s,c[6]*=a,c[7]*=s,this},r.prototype.columnMajorComponents=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"Matrix3","columnMajorComponents","missingResult"));return r[0]=this[0],r[1]=this[3],r[2]=this[6],r[3]=this[1],r[4]=this[4],r[5]=this[7],r[6]=this[2],r[7]=this[5],r[8]=this[8],r},r}),define("worldwind/shaders/SkyProgram",["../shaders/AtmosphereProgram"],function(t){"use strict";var e=function(e){var r="precision mediump int;\nconst int SAMPLE_COUNT = 2;\nconst float SAMPLES = 2.0;\nconst float PI = 3.141592653589;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * PI;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * PI;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 invWavelength = vec3(5.60204474633241, 9.473284437923038, 19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nuniform mat4 mvpMatrix;\nuniform vec3 vertexOrigin;\nuniform vec3 eyePoint;\nuniform float eyeMagnitude;\nuniform float eyeMagnitude2;\nuniform mediump vec3 lightDirection;\nuniform float atmosphereRadius;\nuniform float atmosphereRadius2;\nuniform float globeRadius;\nuniform float scale;\nuniform float scaleDepth;\nuniform float scaleOverScaleDepth;\nattribute vec4 vertexPoint;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nfloat scaleFunc(float cos)\n{\n    float x = 1.0 - cos;\n    return scaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid sampleSky() {\n    vec3 point = vertexPoint.xyz + vertexOrigin;\n    vec3 ray = point - eyePoint;\n    float far = length(ray);\n    ray /= far;\n    vec3 start;\n    float startOffset;\n    if (eyeMagnitude < atmosphereRadius) {\n        start = eyePoint;\n        float height = length(start);\n        float depth = exp(scaleOverScaleDepth * (globeRadius - eyeMagnitude));\n        float startAngle = dot(ray, start) / height;\n        startOffset = depth*scaleFunc(startAngle);\n    } else {\n        float B = 2.0 * dot(eyePoint, ray);\n        float C = eyeMagnitude2 - atmosphereRadius2;\n        float det = max(0.0, B*B - 4.0 * C);\n        float near = 0.5 * (-B - sqrt(det));\n        start = eyePoint + ray * near;\n        far -= near;\n        float startAngle = dot(ray, start) / atmosphereRadius;\n        float startDepth = exp(-1.0 / scaleDepth);\n        startOffset = startDepth*scaleFunc(startAngle);\n    }\n    float sampleLength = far / SAMPLES;\n    float scaledLength = sampleLength * scale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    for(int i=0; i<SAMPLE_COUNT; i++)\n    {\n       float height = length(samplePoint);\n       float depth = exp(scaleOverScaleDepth * (globeRadius - height));\n       float lightAngle = dot(lightDirection, samplePoint) / height;\n       float cameraAngle = dot(ray, samplePoint) / height;\n       float scatter = (startOffset + depth*(scaleFunc(lightAngle) - scaleFunc(cameraAngle)));\n       vec3 attenuate = exp(-scatter * (invWavelength * Kr4PI + Km4PI));\n       frontColor += attenuate * (depth * scaledLength);\n       samplePoint += sampleRay;\n    }\n    primaryColor = frontColor * (invWavelength * KrESun);\n    secondaryColor = frontColor * KmESun;\n    direction = eyePoint - point;\n}\nvoid main()\n{\n    sampleSky();\n    gl_Position = mvpMatrix * vertexPoint;\n}",i="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nconst float g = -0.95;\nconst float g2 = g * g;\nuniform mediump vec3 lightDirection;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nvoid main (void)\n{\n    float cos = dot(lightDirection, direction) / length(direction);\n    float rayleighPhase = 0.75 * (1.0 + cos * cos);\n    float miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cos*cos) /         pow(1.0 + g2 - 2.0*g*cos, 1.5);\n    const float exposure = 2.0;\n    vec3 color = primaryColor * rayleighPhase + secondaryColor * miePhase;\n    color = vec3(1.0) - exp(-exposure * color);\n    gl_FragColor = vec4(color, color.b);\n}";t.call(this,e,r,i,["vertexPoint"])};return e.key="WorldWindSkyProgram",e.prototype=Object.create(t.prototype),e}),define("worldwind/util/WWUtil",["../error/ArgumentError","../geom/Line","../util/Logger","../geom/Rectangle","../geom/Vec3"],function(t,e,r,i,n){"use strict";var o={latLonRegex:/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/,suffixForMimeType:function(t){return"image/png"===t?"png":"image/jpeg"===t?"jpg":"application/bil16"===t?"bil":"application/bil32"===t?"bil":null},currentUrlSansFilePart:function(){for(var t=window.location.protocol,e=window.location.host,r=window.location.pathname,i=r.split("/"),n="",o=0,a=i.length;o<a-1;o++)i[o].length>0&&(n=n+"/"+i[o]);return t+"//"+e+n},worldwindlibLocation:function(){for(var t=document.getElementsByTagName("script"),e="/worldwind.",r=0;r<t.length;r++){var i=t[r].src.indexOf(e);if(i>=0)return t[r].src.substring(0,i)+"/"}return null},urlPath:function(t){if(!t)return"";for(var e=t.split("/"),r="",i=0,n=e.length;i<n;i++){var o=e[i];o&&0!==o.length&&o.indexOf(":")==-1&&"."!==o&&".."!==o&&"null"!==o&&"undefined"!==o&&(0!==r.length&&(r+="/"),r+=o)}return r},fillArray:function(t,e){if(t)for(var r=0,i=t.length;r<i;r++)t[r]=e},multiplyArray:function(t,e){if(t)for(var r=0,i=t.length;r<i;r++)t[r]*=e},jsonpCounter:0,jsonp:function(t,e,r){var i="gov_nasa_worldwind_jsonp_"+o.jsonpCounter++;window[i]=function(t){delete window[i],r(t)};var n=t+(t.indexOf("?")===-1?"?":"&");n+=e+"="+i;var a=document.createElement("script");a.async=!0,a.src=n;var s=document.getElementsByTagName("head")[0],l=function(){a.onload=void 0,a.onerror=void 0,s.removeChild(a)};a.onload=l,a.onerror=l,s.appendChild(a)},arrayEquals:function(t,e){return t.length==e.length&&t.every(function(t,r){return t===e[r]||t.equals&&t.equals(e[r])})},transformToBoolean:function(t){return 0!=t&&"0"!=t&&"false"!=t&&Boolean(t)},clone:function(t){var e,r={},i=Object.keys(t);for(e=0;e<i.length;e++)r[i[e]]=t[i[e]];return r},guid:function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},date:function(t){return new Date(t)},startsWith:function(t,e,r){return r=r||0,t.substr(r,e.length)===e},endsWith:function(t,e,r){("number"!=typeof r||!isFinite(r)||Math.floor(r)!==r||r>t.length)&&(r=t.length),r-=e.length;var i=t.lastIndexOf(e,r);return i!==-1&&i===r}};return o}),define("worldwind/layer/AtmosphereLayer",["../error/ArgumentError","../shaders/GroundProgram","../layer/Layer","../util/Logger","../geom/Matrix","../geom/Matrix3","../geom/Sector","../shaders/SkyProgram","../geom/Vec3","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u){"use strict";var c=function(t){r.call(this,"Atmosphere"),this.pickEnabled=!1,this._nightImageSource=t||WorldWind.configuration.baseUrl+"images/dnb_land_ocean_ice_2012.png",this._lightLocation=null,this._activeLightDirection=new l(0,0,0),this._fullSphereSector=a.FULL_SPHERE,this._skyData={},this._skyWidth=128,this._skyHeight=128,this._numIndices=0,this._texMatrix=o.fromIdentity(),this._activeTexture=null};return c.prototype=Object.create(r.prototype),Object.defineProperties(c.prototype,{lightLocation:{get:function(){return this._lightLocation},set:function(t){this._lightLocation=t}},nightImageSource:{get:function(){return this._nightImageSource},set:function(t){this._nightImageSource=t}}}),c.prototype.doRender=function(t){t.globe.is2D()||(this.determineLightDirection(t),this.drawSky(t),this.drawGround(t))},c.prototype.applySkyVertices=function(t){var e,r,i=t.currentGlContext,n=t.currentProgram,o=this._skyData;o.verticesVboCacheKey||(o.verticesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(o.verticesVboCacheKey),r?(i.bindBuffer(i.ARRAY_BUFFER,r),i.vertexAttribPointer(0,3,i.FLOAT,!1,0,0)):(e=this.assembleVertexPoints(t,this._skyHeight,this._skyWidth,n.getAltitude()),r=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,r),i.bufferData(i.ARRAY_BUFFER,e,i.STATIC_DRAW),i.vertexAttribPointer(0,3,i.FLOAT,!1,0,0),t.gpuResourceCache.putResource(o.verticesVboCacheKey,r,4*e.length),t.frameStatistics.incrementVboLoadCount(1))},c.prototype.applySkyIndices=function(t){var e,r,i=t.currentGlContext,n=this._skyData;n.indicesVboCacheKey||(n.indicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(n.indicesVboCacheKey),r?i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r):(e=this.assembleTriStripIndices(this._skyWidth,this._skyHeight),r=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e,i.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),t.gpuResourceCache.putResource(n.indicesVboCacheKey,r,2*e.length))},c.prototype.drawSky=function(t){var e=t.currentGlContext,r=t.findAndBindProgram(s);r.loadGlobeRadius(e,t.globe.equatorialRadius),r.loadEyePoint(e,t.navigatorState.eyePoint),r.loadVertexOrigin(e,l.ZERO),r.loadModelviewProjection(e,t.navigatorState.modelviewProjection),r.loadLightDirection(e,this._activeLightDirection),r.setScale(e),this.applySkyVertices(t),this.applySkyIndices(t),e.depthMask(!1),e.frontFace(e.CW),e.enableVertexAttribArray(0),e.drawElements(e.TRIANGLE_STRIP,this._numIndices,e.UNSIGNED_SHORT,0),e.depthMask(!0),e.frontFace(e.CCW),e.disableVertexAttribArray(0)},c.prototype.drawGround=function(t){var r,i=t.currentGlContext,n=t.findAndBindProgram(e),o=t.terrain;n.loadGlobeRadius(i,t.globe.equatorialRadius),n.loadEyePoint(i,t.navigatorState.eyePoint),n.loadLightDirection(i,this._activeLightDirection),n.setScale(i),this.nightImageSource&&this.lightLocation&&(this._activeTexture=t.gpuResourceCache.resourceForKey(this.nightImageSource),this._activeTexture||(this._activeTexture=t.gpuResourceCache.retrieveTexture(i,this.nightImageSource)),r=this._activeTexture&&this._activeTexture.bind(t)),o.beginRendering(t);for(var a=0,s=o.surfaceGeometry.length;a<s;a++){var l=o.surfaceGeometry[a],u=l.referencePoint;n.loadVertexOrigin(i,u),r&&(this._texMatrix.setToUnitYFlip(),this._texMatrix.multiplyByTileTransform(l.sector,this._fullSphereSector),n.loadTexMatrix(i,this._texMatrix)),o.beginRenderingTile(t,l),n.loadFragMode(i,n.FRAGMODE_GROUND_SECONDARY),i.blendFunc(i.DST_COLOR,i.ZERO),o.renderTile(t,l);var c=r?n.FRAGMODE_GROUND_PRIMARY_TEX_BLEND:n.FRAGMODE_GROUND_PRIMARY;n.loadFragMode(i,c),i.blendFunc(i.ONE,i.ONE),o.renderTile(t,l),o.endRenderingTile(t,l)}o.endRendering(t),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),this._activeTexture=null},c.prototype.assembleVertexPoints=function(t,e,r,i){var n=e*r,o=new Array(n);u.fillArray(o,i);var a=new Float32Array(3*n);return t.globe.computePointsForGrid(this._fullSphereSector,e,r,o,l.ZERO,a)},c.prototype.assembleTriStripIndices=function(t,e){for(var r=[],i=0,n=0;n<t-1;n++){for(var o=0;o<e;o++)i=o+n*e,r.push(i+e),r.push(i);n<t-2&&(r.push(i),r.push((n+2)*e))}return this._numIndices=r.length,new Uint16Array(r)},c.prototype.determineLightDirection=function(t){null!=this.lightLocation?t.globe.computePointFromLocation(this.lightLocation.latitude,this.lightLocation.longitude,this._activeLightDirection):this._activeLightDirection.copy(t.navigatorState.eyePoint),this._activeLightDirection.normalize()},c}),define("worldwind/shaders/BasicProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(t,e,r,i){"use strict";var n=function(t){var e="attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nvoid main() {gl_Position = mvpMatrix * vertexPoint;}",i="precision mediump float;\nuniform vec4 color;\nvoid main() {gl_FragColor = color;}";r.call(this,t,e,i),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.colorLocation=this.uniformLocation(t,"color")};return n.key="WorldWindGpuBasicProgram",n.prototype=Object.create(r.prototype),n.prototype.loadModelviewProjection=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,r,this.mvpMatrixLocation)},n.prototype.loadColor=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BasicProgram","loadColor","missingColor"));this.loadUniformColor(e,r,this.colorLocation)},n.prototype.loadColorComponents=function(t,e,r,i,n){this.loadUniformColorComponents(t,e,r,i,n,this.colorLocation)},n}),define("worldwind/util/BasicTimeSequence",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r&&r.length<2)throw new t(e.logMessage(e.LEVEL_SEVERE,"BasicTimeSequence","constructor","missingDates"));this.dates=r,this.currentIndex=0,this.currentTime=r[0]};return Object.defineProperties(r.prototype,{scaleForCurrentTime:{get:function(){return this.currentTime?this.currentIndex/this.dates.length:1}}}),r.prototype.next=function(){return this.currentIndex>=this.dates.length-1?null:(this.currentIndex++,this.currentTime=this.dates[this.currentIndex],this.currentTime)},r.prototype.previous=function(){return this.currentIndex<=0?null:(this.currentIndex--,this.currentTime=this.dates[this.currentIndex],this.currentTime)},r.prototype.reset=function(){this.currentIndex=-1,this.currentTime=null},r.prototype.getTimeForScale=function(t){return t<=0?this.currentIndex=0:t>=1?this.currentIndex=this.dates.length-1:this.currentIndex=Math.floor(this.dates.length*t),this.currentTime=this.dates[this.currentIndex],this.currentTime},r}),define("worldwind/gesture/Touch",[],function(){"use strict";var t=function(t,e,r){this.identifier=t,this._clientX=e,this._clientY=r,this._clientStartX=e,this._clientStartY=r};return Object.defineProperties(t.prototype,{clientX:{get:function(){return this._clientX},set:function(t){this._clientX=t}},clientY:{get:function(){return this._clientY},set:function(t){this._clientY=t}},translationX:{get:function(){return this._clientX-this._clientStartX},set:function(t){this._clientStartX=this._clientX-t}},translationY:{get:function(){return this._clientY-this._clientStartY},set:function(t){this._clientStartY=this._clientY-t}}}),t}),define("worldwind/gesture/GestureRecognizer",["../error/ArgumentError","../util/Logger","../gesture/Touch"],function(t,e,r){"use strict";var i=function(r,n){function o(t){a.handleEvent(t)}if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","constructor","missingTarget"));this.target=r,this.enabled=!0,this._state=WorldWind.POSSIBLE,this._nextState=null,this._clientX=0,this._clientY=0,this._clientStartX=0,this._clientStartY=0,this._translationX=0,this._translationY=0,this._translationWeight=.4,this._mouseButtonMask=0,this._touches=[],this._touchCentroidShiftX=0,this._touchCentroidShiftY=0,this._gestureCallbacks=[],this._canRecognizeWith=[],this._requiresFailureOf=[],this._requiredToFailBy=[],n&&this._gestureCallbacks.push(n),i.allRecognizers.push(this);var a=this;window.PointerEvent?(r.addEventListener("pointerdown",o,!1),window.addEventListener("pointermove",o,!1),window.addEventListener("pointercancel",o,!1),window.addEventListener("pointerup",o,!1)):(r.addEventListener("mousedown",o,!1),window.addEventListener("mousemove",o,!1),window.addEventListener("mouseup",o,!1),r.addEventListener("touchstart",o,!1),r.addEventListener("touchmove",o,!1),r.addEventListener("touchend",o,!1),r.addEventListener("touchcancel",o,!1))};return i.allRecognizers=[],Object.defineProperties(i.prototype,{state:{get:function(){return this._state},set:function(t){this.transitionToState(t)}},clientX:{get:function(){return this._clientX},set:function(t){this._clientX=t}},clientY:{get:function(){return this._clientY},set:function(t){this._clientY=t}},translationX:{get:function(){return this._translationX},set:function(t){this._translationX=t,this._clientStartX=this._clientX,this._touchCentroidShiftX=0}},translationY:{get:function(){return this._translationY},set:function(t){this._translationY=t,this._clientStartY=this._clientY,this._touchCentroidShiftY=0}},mouseButtonMask:{get:function(){return this._mouseButtonMask}},touchCount:{get:function(){return this._touches.length}},gestureCallbacks:{get:function(){return this._gestureCallbacks}}}),i.prototype.touch=function(r){if(r<0||r>=this._touches.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","touch","indexOutOfRange"));return this._touches[r]},i.prototype.recognizeSimultaneouslyWith=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","recognizeSimultaneouslyWith","The specified gesture recognizer is null or undefined."));var i=this._canRecognizeWith.indexOf(r);i==-1&&(this._canRecognizeWith.push(r),r._canRecognizeWith.push(this))},i.prototype.canRecognizeSimultaneouslyWith=function(t){var e=this._canRecognizeWith.indexOf(t);return e!=-1},i.prototype.requireRecognizerToFail=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","requireRecognizerToFail","The specified gesture recognizer is null or undefined"));var i=this._requiresFailureOf.indexOf(r);i==-1&&(this._requiresFailureOf.push(r),r._requiredToFailBy.push(this));
},i.prototype.requiresRecognizerToFail=function(t){var e=this._requiresFailureOf.indexOf(t);return e!=-1},i.prototype.requiredToFailByRecognizer=function(t){var e=this._requiredToFailBy.indexOf(t);return e!=-1},i.prototype.reset=function(){this._state=WorldWind.POSSIBLE,this._nextState=null,this._clientX=0,this._clientY=0,this._clientStartX=0,this._clientStartY=0,this._translationX=0,this._translationY=0,this._mouseButtonMask=0,this._touches=[],this._touchCentroidShiftX=0,this._touchCentroidShiftY=0},i.prototype.prepareToRecognize=function(){},i.prototype.mouseDown=function(t){},i.prototype.mouseMove=function(t){},i.prototype.mouseUp=function(t){},i.prototype.touchStart=function(t){},i.prototype.touchMove=function(t){},i.prototype.touchCancel=function(t){},i.prototype.touchEnd=function(t){},i.prototype.transitionToState=function(t){this._nextState=null,t==WorldWind.FAILED?(this._state=t,this.updateRecognizersWaitingForFailure(),this.resetIfEventsEnded()):t==WorldWind.RECOGNIZED?(this.tryToRecognize(t),this._state==t&&(this.prepareToRecognize(),this.callGestureCallbacks(),this.resetIfEventsEnded())):t==WorldWind.BEGAN?(this.tryToRecognize(t),this._state==t&&(this.prepareToRecognize(),this.callGestureCallbacks())):t==WorldWind.CHANGED?(this._state=t,this.callGestureCallbacks()):t==WorldWind.CANCELLED?(this._state=t,this.callGestureCallbacks(),this.resetIfEventsEnded()):t==WorldWind.ENDED&&(this._state=t,this.callGestureCallbacks(),this.resetIfEventsEnded())},i.prototype.updateRecognizersWaitingForFailure=function(){for(var t=0,e=this._requiredToFailBy.length;t<e;t++){var r=this._requiredToFailBy[t];null!=r._nextState&&r.transitionToState(r._nextState)}},i.prototype.tryToRecognize=function(t){if(i.allRecognizers.some(this.canBePreventedByRecognizer,this))return void this.transitionToState(WorldWind.FAILED);if(i.allRecognizers.some(this.isWaitingForRecognizerToFail,this))return void(this._nextState=t);for(var e=i.allRecognizers.filter(this.canPreventRecognizer,this),r=0,n=e.length;r<n;r++)e[r].transitionToState(WorldWind.FAILED);this._state=t},i.prototype.canPreventRecognizer=function(t){return this!=t&&this.target==t.target&&t.state==WorldWind.POSSIBLE&&(this.requiredToFailByRecognizer(t)||!this.canRecognizeSimultaneouslyWith(t))},i.prototype.canBePreventedByRecognizer=function(t){return this!=t&&this.target==t.target&&t.state==WorldWind.RECOGNIZED&&(this.requiresRecognizerToFail(t)||!this.canRecognizeSimultaneouslyWith(t))},i.prototype.isWaitingForRecognizerToFail=function(t){return this!=t&&this.target==t.target&&t.state==WorldWind.POSSIBLE&&this.requiresRecognizerToFail(t)},i.prototype.callGestureCallbacks=function(){for(var t=0,e=this._gestureCallbacks.length;t<e;t++)this._gestureCallbacks[t](this)},i.prototype.handleEvent=function(t){if(this.enabled&&(!t.defaultPrevented||this.state!=WorldWind.POSSIBLE)){var r,i;try{if("mousedown"==t.type)this.handleMouseDown(t);else if("mousemove"==t.type)this.handleMouseMove(t);else if("mouseup"==t.type)this.handleMouseUp(t);else if("touchstart"==t.type)for(r=0,i=t.changedTouches.length;r<i;r++)this.handleTouchStart(t.changedTouches.item(r));else if("touchmove"==t.type)for(r=0,i=t.changedTouches.length;r<i;r++)this.handleTouchMove(t.changedTouches.item(r));else if("touchcancel"==t.type)for(r=0,i=t.changedTouches.length;r<i;r++)this.handleTouchCancel(t.changedTouches.item(r));else if("touchend"==t.type)for(r=0,i=t.changedTouches.length;r<i;r++)this.handleTouchEnd(t.changedTouches.item(r));else"pointerdown"==t.type&&"mouse"==t.pointerType?this.handleMouseDown(t):"pointermove"==t.type&&"mouse"==t.pointerType?this.handleMouseMove(t):"pointercancel"==t.type&&"mouse"==t.pointerType||("pointerup"==t.type&&"mouse"==t.pointerType?this.handleMouseUp(t):"pointerdown"==t.type&&"touch"==t.pointerType?this.handleTouchStart(t):"pointermove"==t.type&&"touch"==t.pointerType?this.handleTouchMove(t):"pointercancel"==t.type&&"touch"==t.pointerType?this.handleTouchCancel(t):"pointerup"==t.type&&"touch"==t.pointerType?this.handleTouchEnd(t):e.logMessage(e.LEVEL_INFO,"GestureRecognizer","handleEvent","Unrecognized event type: "+t.type))}catch(t){e.logMessage(e.LEVEL_SEVERE,"GestureRecognizer","handleEvent","Error handling event.\n"+t.toString())}}},i.prototype.handleMouseDown=function(t){if(!("mousedown"==t.type&&this._touches.length>0)){var e=1<<t.button;e&0!=this._mouseButtonMask||(0==this._mouseButtonMask&&(this._clientX=t.clientX,this._clientY=t.clientY,this._clientStartX=t.clientX,this._clientStartY=t.clientY,this._translationX=0,this._translationY=0),this._mouseButtonMask|=e,this.mouseDown(t))}},i.prototype.handleMouseMove=function(t){if(0!=this._mouseButtonMask&&(this._clientX!=t.clientX||this._clientY!=t._clientY)){var e=t.clientX-this._clientStartX,r=t.clientY-this._clientStartY,i=this._translationWeight;this._clientX=t.clientX,this._clientY=t.clientY,this._translationX=this._translationX*(1-i)+e*i,this._translationY=this._translationY*(1-i)+r*i,this.mouseMove(t)}},i.prototype.handleMouseUp=function(t){var e=1<<t.button;e&0==this._mouseButtonMask||(this._mouseButtonMask&=~e,this.mouseUp(t),0==this._mouseButtonMask&&this.resetIfEventsEnded())},i.prototype.handleTouchStart=function(t){var e=new r(t.identifier||t.pointerId,t.clientX,t.clientY);this._touches.push(e),1==this._touches.length?(this._clientX=t.clientX,this._clientY=t.clientY,this._clientStartX=t.clientX,this._clientStartY=t.clientY,this._translationX=0,this._translationY=0,this._touchCentroidShiftX=0,this._touchCentroidShiftY=0):this.touchesAddedOrRemoved(),this.touchStart(e)},i.prototype.handleTouchMove=function(t){var e=this.indexOfTouchWithId(t.identifier||t.pointerId);if(e!=-1){var r=this._touches[e];if(r.clientX!=t.clientX||r.clientY!=t.clientY){r.clientX=t.clientX,r.clientY=t.clientY;var i=this.touchCentroid(),n=i.clientX-this._clientStartX+this._touchCentroidShiftX,o=i.clientY-this._clientStartY+this._touchCentroidShiftY,a=this._translationWeight;this._clientX=i.clientX,this._clientY=i.clientY,this._translationX=this._translationX*(1-a)+n*a,this._translationY=this._translationY*(1-a)+o*a,this.touchMove(r)}}},i.prototype.handleTouchCancel=function(t){var e=this.indexOfTouchWithId(t.identifier||t.pointerId);if(e!=-1){var r=this._touches[e];this._touches.splice(e,1),this.touchesAddedOrRemoved(),this.touchCancel(r),this.resetIfEventsEnded()}},i.prototype.handleTouchEnd=function(t){var e=this.indexOfTouchWithId(t.identifier||t.pointerId);if(e!=-1){var r=this._touches[e];this._touches.splice(e,1),this.touchesAddedOrRemoved(),this.touchEnd(r),this.resetIfEventsEnded()}},i.prototype.resetIfEventsEnded=function(){this._state!=WorldWind.POSSIBLE&&0==this._mouseButtonMask&&0==this._touches.length&&this.reset()},i.prototype.touchesAddedOrRemoved=function(){this._touchCentroidShiftX+=this._clientX,this._touchCentroidShiftY+=this._clientY;var t=this.touchCentroid();this._clientX=t.clientX,this._clientY=t.clientY,this._touchCentroidShiftX-=this._clientX,this._touchCentroidShiftY-=this._clientY},i.prototype.touchCentroid=function(){for(var t=0,e=0,r=0,i=this._touches.length;r<i;r++){var n=this._touches[r];t+=n.clientX/i,e+=n.clientY/i}return{clientX:t,clientY:e}},i.prototype.indexOfTouchWithId=function(t){for(var e=0,r=this._touches.length;e<r;e++)if(this._touches[e].identifier==t)return e;return-1},i}),define("worldwind/gesture/DragRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.button=0,this.interpretDistance=5};return e.prototype=Object.create(t.prototype),e.prototype.mouseMove=function(t){this.state==WorldWind.POSSIBLE?this.shouldInterpret()&&(this.shouldRecognize()?(this.translationX=0,this.translationY=0,this.state=WorldWind.BEGAN):this.state=WorldWind.FAILED):this.state!=WorldWind.BEGAN&&this.state!=WorldWind.CHANGED||(this.state=WorldWind.CHANGED)},e.prototype.mouseUp=function(t){0==this.mouseButtonMask&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:this.state!=WorldWind.BEGAN&&this.state!=WorldWind.CHANGED||(this.state=WorldWind.ENDED))},e.prototype.touchStart=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.shouldInterpret=function(){var t=this.translationX,e=this.translationY,r=Math.sqrt(t*t+e*e);return r>this.interpretDistance},e.prototype.shouldRecognize=function(){var t=1<<this.button;return t==this.mouseButtonMask},e}),define("worldwind/geom/Frustum",["../error/ArgumentError","../geom/Matrix","../geom/Plane","../util/Logger"],function(t,e,r,i){"use strict";var n=function(e,r,n,o,a,s){if(!(e&&r&&n&&o&&a&&s))throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","constructor","missingPlane"));this._left=e,this._right=r,this._bottom=n,this._top=o,this._near=a,this._far=s,this._planes=[this._left,this._right,this._top,this._bottom,this._near,this._far]};return Object.defineProperties(n.prototype,{left:{get:function(){return this._left}},right:{get:function(){return this._right}},bottom:{get:function(){return this._bottom}},top:{get:function(){return this._top}},near:{get:function(){return this._near}},far:{get:function(){return this._far}}}),n.prototype.transformByMatrix=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","transformByMatrix","missingMatrix"));return this._left.transformByMatrix(e),this._right.transformByMatrix(e),this._bottom.transformByMatrix(e),this._top.transformByMatrix(e),this._near.transformByMatrix(e),this._far.transformByMatrix(e),this},n.prototype.normalize=function(){return this._left.normalize(),this._right.normalize(),this._bottom.normalize(),this._top.normalize(),this._near.normalize(),this._far.normalize(),this},n.unitFrustum=function(){return new n(new r(1,0,0,1),new r(-1,0,0,1),new r(0,1,1,1),new r(0,-1,0,1),new r(0,0,-1,1),new r(0,0,1,1))},n.fromProjectionMatrix=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","fromProjectionMatrix","missingMatrix"));var o,a,s,l,u,c,h,f,d,p,g;return o=e[12]+e[0],a=e[13]+e[1],s=e[14]+e[2],l=e[15]+e[3],u=Math.sqrt(o*o+a*a+s*s),c=new r(o/u,a/u,s/u,l/u),o=e[12]-e[0],a=e[13]-e[1],s=e[14]-e[2],l=e[15]-e[3],u=Math.sqrt(o*o+a*a+s*s),h=new r(o/u,a/u,s/u,l/u),o=e[12]+e[4],a=e[13]+e[5],s=e[14]+e[6],l=e[15]+e[7],u=Math.sqrt(o*o+a*a+s*s),d=new r(o/u,a/u,s/u,l/u),o=e[12]-e[4],a=e[13]-e[5],s=e[14]-e[6],l=e[15]-e[7],u=Math.sqrt(o*o+a*a+s*s),f=new r(o/u,a/u,s/u,l/u),o=e[12]+e[8],a=e[13]+e[9],s=e[14]+e[10],l=e[15]+e[11],u=Math.sqrt(o*o+a*a+s*s),p=new r(o/u,a/u,s/u,l/u),o=e[12]-e[8],a=e[13]-e[9],s=e[14]-e[10],l=e[15]-e[11],u=Math.sqrt(o*o+a*a+s*s),g=new r(o/u,a/u,s/u,l/u),new n(c,h,d,f,p,g)},n.prototype.containsPoint=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","containsPoint","missingPoint"));return!(this._far.dot(e)<=0)&&(!(this._left.dot(e)<=0)&&(!(this._right.dot(e)<=0)&&(!(this._top.dot(e)<=0)&&(!(this._bottom.dot(e)<=0)&&!(this._near.dot(e)<=0)))))},n.prototype.intersectsSegment=function(e,r){if(!e||!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","containsPoint","missingPoint"));if(this.containsPoint(e)||this.containsPoint(r))return!0;if(e.equals(r))return!1;for(var n=0,o=this._planes.length;n<o;n++){if(this._planes[n].onSameSide(e,r)<0)return!1;if(null!=this._planes[n].clip(e,r))return!0}return!1},n.prototype.setToModelViewProjection=function(r,n,o){if(null==r||null==n)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","setToModelviewProjection","missingMatrix"));if(null==o)throw new t(i.logMessage(i.LEVEL_SEVERE,"Frustum","setToModelviewProjection","missingViewport"));var a=e.fromIdentity();a.setToTransposeOfMatrix(n);var s,l,u,c;return s=r[12]+r[0],l=r[13]+r[1],u=r[14]+r[2],c=r[15]+r[3],this.left.set(s,l,u,c),this.left.transformByMatrix(a),s=r[12]-r[0],l=r[13]-r[1],u=r[14]-r[2],c=r[15]-r[3],this.right.set(s,l,u,c),this.right.transformByMatrix(a),s=r[12]+r[4],l=r[13]+r[5],u=r[14]+r[6],c=r[15]+r[7],this.bottom.set(s,l,u,c),this.bottom.transformByMatrix(a),s=r[12]-r[4],l=r[13]-r[5],u=r[14]-r[6],c=r[15]-r[7],this.top.set(s,l,u,c),this.top.transformByMatrix(a),s=r[12]+r[8],l=r[13]+r[9],u=r[14]+r[10],c=r[15]+r[11],this.near.set(s,l,u,c),this.near.transformByMatrix(a),s=r[12]-r[8],l=r[13]-r[9],u=r[14]-r[10],c=r[15]-r[11],this.far.set(s,l,u,c),this.far.transformByMatrix(a),this.viewport=o,this},n}),define("worldwind/navigate/LookAt",[],function(){var t=function(t,e,r,i,n,o,a,s){this._latitude=t||0,this._longitude=e||0,this._altitude=r||0,this._altitudeMode=i||WorldWind.ABSOLUTE,this._range=n||0,this._heading=o||0,this._tilt=a||0,this._roll=s||0};return Object.defineProperties(t.prototype,{latitude:{get:function(){return this._latitude},set:function(t){this._latitude=t}},longitude:{get:function(){return this._longitude},set:function(t){this._longitude=t}},altitude:{get:function(){return this._altitude},set:function(t){this._altitude=t}},altitudeMode:{get:function(){return this._altitudeMode},set:function(t){this._altitudeMode=t}},range:{get:function(){return this._range},set:function(t){this._range=t}},heading:{get:function(){return this._heading},set:function(t){this._heading=t}},tilt:{get:function(){return this._tilt},set:function(t){this._tilt=t}},roll:{get:function(){return this._roll},set:function(t){this._roll=t}}}),t.prototype.set=function(t){return this.latitude=t.latitude,this.longitude=t.longitude,this.altitude=t.altitude,this.altitudeMode=t.altitudeMode,this.range=t.range,this.heading=t.heading,this.tilt=t.tilt,this.roll=t.roll,this},t.prototype.equals=function(t){return t&&this.latitude==t.latitude&&this.longitude==t.longitude&&this.altitude==t.altitude&&this.altitudeMode==t.altitudeMode&&this.range==t.range&&this.heading==t.heading&&this.tilt==t.tilt&&this.roll==t.roll},t.prototype.toString=function(){return"LookAt{latitude="+this.latitude+", longitude="+this.longitude+", altitude="+this.altitude+", altitudeMode="+this.altitudeMode+", range="+this.range+", heading="+this.heading+", tilt="+this.tilt+", roll="+this.roll+"}"},t}),define("worldwind/navigate/Camera",[],function(){var t=function(t,e,r,i,n,o,a){this._latitude=t||0,this._longitude=e||0,this._altitude=r||0,this._altitudeMode=i||WorldWind.ABSOLUTE,this._heading=n||0,this._tilt=o||0,this._roll=a||0};return Object.defineProperties(t.prototype,{latitude:{get:function(){return this._latitude},set:function(t){this._latitude=t}},longitude:{get:function(){return this._longitude},set:function(t){this._longitude=t}},altitude:{get:function(){return this._altitude},set:function(t){this._altitude=t}},altitudeMode:{get:function(){return this._altitudeMode},set:function(t){this._altitudeMode=t}},heading:{get:function(){return this._heading},set:function(t){this._heading=t}},tilt:{get:function(){return this._tilt},set:function(t){this._tilt=t}},roll:{get:function(){return this._roll},set:function(t){this._roll=t}}}),t.prototype.set=function(t){return this.latitude=t.latitude,this.longitude=t.longitude,this.altitude=t.altitude,this.altitudeMode=t.altitudeMode,this.heading=t.heading,this.tilt=t.tilt,this.roll=t.roll,this},t.prototype.equals=function(t){return t&&this.latitude==t.latitude&&this.longitude==t.longitude&&this.altitude==t.altitude&&this.altitudeMode==t.altitudeMode&&this.heading==t.heading&&this.tilt==t.tilt&&this.roll==t.roll},t.prototype.toString=function(){return"Camera{latitude="+this.latitude+", longitude="+this.longitude+", altitude="+this.altitude+", altitudeMode="+this.altitudeMode+", heading="+this.heading+", tilt="+this.tilt+", roll="+this.roll+"}"},t}),define("worldwind/navigate/NavigatorState",["../error/ArgumentError","../geom/Frustum","../geom/Line","../util/Logger","../geom/Matrix","../geom/Rectangle","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(t,r,i,o,a,u){this.modelview=t,this.projection=r,this.modelviewProjection=n.fromIdentity(),this.modelviewProjection.setToMultiply(r,t),this.viewport=o,this.infiniteProjection=i,this.heading=a,this.tilt=u,this.eyePoint=this.modelview.extractEyePoint(new s(0,0,0)),this.frustumInModelCoordinates=null;var c=n.fromIdentity();c.setToTransposeOfMatrix(this.modelview),this.frustumInModelCoordinates=e.fromProjectionMatrix(this.projection),this.frustumInModelCoordinates.setToModelViewProjection(r,t,o),this.modelviewInv=n.fromIdentity(),this.modelviewInv.invertOrthonormalMatrix(this.modelview),this.projectionInv=n.fromIdentity(),this.projectionInv.invertMatrix(this.projection),this.modelviewProjectionInv=n.fromIdentity(),this.modelviewProjectionInv.invertMatrix(this.modelviewProjection),this.modelviewNormalTransform=n.fromIdentity().setToTransposeOfMatrix(this.modelviewInv.upper3By3());var h=new s(-1,-1,-1),f=new s(1,1,-1),d=new s(-1,-1,1),p=new s(1,1,1);h.multiplyByMatrix(this.projectionInv),f.multiplyByMatrix(this.projectionInv),d.multiplyByMatrix(this.projectionInv),p.multiplyByMatrix(this.projectionInv);var g=l.fabs(f[0]-h[0]),m=l.fabs(p[0]-d[0]),y=-h[2],v=-d[2],b=(m-g)/(v-y),E=g-b*y;this.pixelSizeScale=b/o.width,this.pixelSizeOffset=E/o.height};return u.prototype.project=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","project","missingPoint"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","project","missingResult"));var n=e[0],o=e[1],a=e[2],s=this.modelviewProjection,l=s[0]*n+s[1]*o+s[2]*a+s[3],u=s[4]*n+s[5]*o+s[6]*a+s[7],c=s[8]*n+s[9]*o+s[10]*a+s[11],h=s[12]*n+s[13]*o+s[14]*a+s[15],f=this.viewport;return 0!=h&&(l/=h,u/=h,c/=h,!(c<-1||c>1)&&(l=.5*l+.5,u=.5*u+.5,c=.5*c+.5,l=l*f.width+f.x,u=u*f.height+f.y,r[0]=l,r[1]=u,r[2]=c,!0))},u.prototype.projectWithDepth=function(e,r,n){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","projectWithDepth","missingPoint"));if(!n)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","projectWithDepth","missingResult"));var o=e[0],a=e[1],s=e[2],u=this.modelview,c=u[0]*o+u[1]*a+u[2]*s+u[3],h=u[4]*o+u[5]*a+u[6]*s+u[7],f=u[8]*o+u[9]*a+u[10]*s+u[11],d=u[12]*o+u[13]*a+u[14]*s+u[15],p=this.projection,g=p[0]*c+p[1]*h+p[2]*f+p[3]*d,m=p[4]*c+p[5]*h+p[6]*f+p[7]*d,y=p[8]*c+p[9]*h+p[10]*f+p[11]*d,v=p[12]*c+p[13]*h+p[14]*f+p[15]*d,b=this.viewport;return 0!==v&&(g/=v,m/=v,y/=v,!(y<-1||y>1)&&(y=p[8]*c+p[9]*h+p[10]*f*(1+r)+p[11]*d,y/=v,y=l.clamp(y,-1,1),g=.5*g+.5,m=.5*m+.5,y=.5*y+.5,g=g*b.width+b.x,m=m*b.height+b.y,n[0]=g,n[1]=m,n[2]=y,!0))},u.prototype.unProject=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","unProject","missingPoint"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","unProject","missingResult"));var n=e[0],o=e[1],a=e[2],s=this.viewport;if(n=(n-s.x)/s.width,o=(o-s.y)/s.height,n=2*n-1,o=2*o-1,a=2*a-1,a<-1||a>1)return!1;var l=this.modelviewProjectionInv,u=l[0]*n+l[1]*o+l[2]*a+l[3],c=l[4]*n+l[5]*o+l[6]*a+l[7],h=l[8]*n+l[9]*o+l[10]*a+l[11],f=l[12]*n+l[13]*o+l[14]*a+l[15];return 0!==f&&(r[0]=u/f,r[1]=c/f,r[2]=h/f,!0)},u.prototype.convertPointToWindow=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","convertPointToWindow","missingPoint"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","convertPointToWindow","missingResult"));return r[0]=e[0],r[1]=this.viewport.height-e[1],r},u.prototype.convertPointToViewport=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","convertPointToViewport","missingPoint"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","convertPointToViewport","missingResult"));return r[0]=e[0],r[1]=this.viewport.height-e[1],r},u.prototype.rayFromScreenPoint=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"NavigatorState","rayFromScreenPoint","missingPoint"));var n=this.convertPointToViewport(e,new s(0,0,0)),o=new s(0,0,0),a=new s(0,0,0);if(!this.unProject(n,o))return null;if(n[2]=1,!this.unProject(n,a))return null;var l=new s(this.eyePoint[0],this.eyePoint[1],this.eyePoint[2]),u=new s(a[0],a[1],a[2]);return u.subtract(o),u.normalize(),new r(l,u)},u.prototype.pixelSizeAtDistance=function(t){return this.pixelSizeScale*t+this.pixelSizeOffset},u}),define("worldwind/navigate/Navigator",["../error/ArgumentError","./Camera","../util/Logger","../geom/Matrix","./NavigatorState"],function(t,e,r,i,n){var o=function(t){this.scratchCamera=new e,this.worldWindow=t,this.fieldOfView=45,this.heading=0,this.tilt=0,this.latitude=30,this.longitude=-110,this.altitude=1e7,this.roll=0};return Object.defineProperties(o.prototype,{latitude:{get:function(){return this._latitude},set:function(t){this._latitude=t}},longitude:{get:function(){return this._longitude},set:function(t){this._longitude=t}},altitude:{get:function(){return this._altitude},set:function(t){this._altitude=t}},heading:{get:function(){return this._heading},set:function(t){this._heading=t}},tilt:{get:function(){return this._tilt},set:function(t){this._tilt=t}},roll:{get:function(){return this._roll},set:function(t){this._roll=t}}}),o.prototype.getAsCamera=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","getAsCamera","missing result"));return i.latitude=this.latitude,i.longitude=this.longitude,i.altitude=this.altitude,i.altitudeMode=WorldWind.ABSOLUTE,i.heading=this.heading,i.tilt=this.tilt,i.roll=this.roll,i},o.prototype.setAsCamera=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","setAsCamera","missing camera"));return this.latitude=i.latitude,this.longitude=i.longitude,this.altitude=i.altitude,this.heading=i.heading,this.tilt=i.tilt,this.roll=i.roll,this},o.prototype.getAsLookAt=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","getAsLookAt","missing globe"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","getAsLookAt","missing result"));return this.getAsCamera(e,this.scratchCamera),e.cameraToLookAt(this.scratchCamera,i),i},o.prototype.setAsLookAt=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","setAsLookAt","missing globe"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Navigator","setAsLookAt","missing lookAt"));return e.lookAtToCamera(i,this.scratchCamera),this.setAsCamera(e,this.scratchCamera),this},o.prototype.currentState=function(t){var e=this.getAsCamera(t,this.scratchCamera),r=i.fromIdentity(),o=i.fromIdentity(),a=i.fromIdentity(),s=this.worldWindow.viewport;return this.worldWindow.computeViewingTransform(o,r),a.setToInfiniteProjection(s.width,s.height,this.fieldOfView,1),a.multiplyMatrix(r),new n(r,o,a,s,e.heading,e.tilt)},o}),define("worldwind/gesture/PanRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.minNumberOfTouches=1,this.maxNumberOfTouches=Number.MAX_VALUE,this.interpretDistance=20};return e.prototype=Object.create(t.prototype),e.prototype.mouseDown=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.touchMove=function(t){this.state==WorldWind.POSSIBLE?this.shouldInterpret()&&(this.shouldRecognize()?this.state=WorldWind.BEGAN:this.state=WorldWind.FAILED):this.state!=WorldWind.BEGAN&&this.state!=WorldWind.CHANGED||(this.state=WorldWind.CHANGED)},e.prototype.touchEnd=function(t){0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:this.state!=WorldWind.BEGAN&&this.state!=WorldWind.CHANGED||(this.state=WorldWind.ENDED))},e.prototype.touchCancel=function(t){0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:this.state!=WorldWind.BEGAN&&this.state!=WorldWind.CHANGED||(this.state=WorldWind.CANCELLED))},e.prototype.prepareToRecognize=function(){this.translationX=0,this.translationY=0},e.prototype.shouldInterpret=function(){var t=this.translationX,e=this.translationY,r=Math.sqrt(t*t+e*e);return r>this.interpretDistance},e.prototype.shouldRecognize=function(){var t=this.touchCount;return 0!=t&&t>=this.minNumberOfTouches&&t<=this.maxNumberOfTouches},e}),define("worldwind/gesture/PinchRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this._scale=1,this._offsetScale=1,this.referenceDistance=0,this.interpretThreshold=20,this.weight=.4,this.pinchTouches=[]};return e.prototype=Object.create(t.prototype),Object.defineProperties(e.prototype,{scale:{get:function(){return this._scale*this._offsetScale}}}),e.prototype.reset=function(){t.prototype.reset.call(this),this._scale=1,this._offsetScale=1,this.referenceDistance=0,this.pinchTouches=[]},e.prototype.mouseDown=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.touchStart=function(t){this.pinchTouches.length<2&&2==this.pinchTouches.push(t)&&(this.referenceDistance=this.currentPinchDistance(),this._offsetScale*=this._scale,this._scale=1)},e.prototype.touchMove=function(t){if(2==this.pinchTouches.length)if(this.state==WorldWind.POSSIBLE)this.shouldRecognize()&&(this.state=WorldWind.BEGAN);else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED){var e=this.currentPinchDistance(),r=Math.abs(e/this.referenceDistance),i=this.weight;this._scale=this._scale*(1-i)+r*i,this.state=WorldWind.CHANGED}},e.prototype.touchEnd=function(t){var e=this.pinchTouches.indexOf(t);e!=-1&&this.pinchTouches.splice(e,1),0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:this.state!=WorldWind.BEGAN&&this.state!=WorldWind.CHANGED||(this.state=WorldWind.ENDED))},e.prototype.touchCancel=function(t){var e=this.pinchTouches.indexOf(t);e!=-1&&this.pinchTouches.splice(e,1),0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:this.state!=WorldWind.BEGAN&&this.state!=WorldWind.CHANGED||(this.state=WorldWind.CANCELLED))},e.prototype.prepareToRecognize=function(){this.referenceDistance=this.currentPinchDistance(),this._scale=1},e.prototype.shouldRecognize=function(){var t=this.currentPinchDistance();return Math.abs(t-this.referenceDistance)>this.interpretThreshold},e.prototype.currentPinchDistance=function(){var t=this.pinchTouches[0],e=this.pinchTouches[1],r=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(r*r+i*i)},e}),define("worldwind/gesture/RotationRecognizer",["../geom/Angle","../gesture/GestureRecognizer"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r),this._rotation=0,this._offsetRotation=0,this.referenceAngle=0,this.interpretThreshold=20,this.weight=.4,this.rotationTouches=[]};return r.prototype=Object.create(e.prototype),Object.defineProperties(r.prototype,{rotation:{get:function(){return this._rotation+this._offsetRotation}}}),r.prototype.reset=function(){e.prototype.reset.call(this),this._rotation=0,this._offsetRotation=0,this.referenceAngle=0,this.rotationTouches=[]},r.prototype.mouseDown=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},r.prototype.touchStart=function(t){this.rotationTouches.length<2&&2==this.rotationTouches.push(t)&&(this.referenceAngle=this.currentTouchAngle(),this._offsetRotation+=this._rotation,this._rotation=0)},r.prototype.touchMove=function(e){if(2==this.rotationTouches.length)if(this.state==WorldWind.POSSIBLE)this.shouldRecognize()&&(this.state=WorldWind.BEGAN);else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED){var r=this.currentTouchAngle(),i=t.normalizedDegrees(r-this.referenceAngle),n=this.weight;this._rotation=this._rotation*(1-n)+i*n,this.state=WorldWind.CHANGED}},r.prototype.touchEnd=function(t){var e=this.rotationTouches.indexOf(t);e!=-1&&this.rotationTouches.splice(e,1),0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:this.state!=WorldWind.BEGAN&&this.state!=WorldWind.CHANGED||(this.state=WorldWind.ENDED))},r.prototype.touchCancel=function(t){var e=this.rotationTouches.indexOf(t);e!=-1&&(this.rotationTouches.splice(e,1),0==this.touchCount&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:this.state!=WorldWind.BEGAN&&this.state!=WorldWind.CHANGED||(this.state=WorldWind.CANCELLED)))},r.prototype.prepareToRecognize=function(){this.referenceAngle=this.currentTouchAngle(),this._rotation=0},r.prototype.shouldRecognize=function(){var e=this.currentTouchAngle(),r=t.normalizedDegrees(e-this.referenceAngle);return Math.abs(r)>this.interpretThreshold},r.prototype.currentTouchAngle=function(){var e=this.rotationTouches[0],r=this.rotationTouches[1],i=e.clientX-r.clientX,n=e.clientY-r.clientY;return Math.atan2(n,i)*t.RADIANS_TO_DEGREES},r}),define("worldwind/gesture/TiltRecognizer",["../gesture/PanRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.maxTouchDistance=250,this.maxTouchDivergence=50};return e.LEFT=1,e.RIGHT=2,e.UP=4,e.DOWN=8,e.prototype=Object.create(t.prototype),e.prototype.shouldInterpret=function(){for(var t=0,e=this.touchCount;t<e;t++){var r=this.touch(t),i=r.translationX,n=r.translationY,o=Math.sqrt(i*i+n*n);if(o>this.interpretDistance)return!0}return!1},e.prototype.shouldRecognize=function(){var t=this.touchCount;if(t<2)return!1;var r=this.touch(0),i=this.touch(1),n=r.clientX-i.clientX,o=r.clientY-i.clientY,a=Math.sqrt(n*n+o*o);if(a>this.maxTouchDistance)return!1;var s=r.translationX-i.translationX,l=r.translationY-i.translationY,u=Math.sqrt(s*s+l*l);if(u>this.maxTouchDivergence)return!1;var c=e.UP|e.DOWN,h=this.touchDirection(r)&c,f=this.touchDirection(i)&c;return 0!=(h&f)},e.prototype.touchDirection=function(t){var r=t.translationX,i=t.translationY,n=0;return Math.abs(r)>Math.abs(i)?(n|=r<0?e.LEFT:0,n|=r>0?e.RIGHT:0):(n|=i<0?e.UP:0,n|=i>0?e.DOWN:0),n},e}),define("worldwind/navigate/WorldWindowController",["../geom/Angle","../gesture/DragRecognizer","../geom/Frustum","../gesture/GestureRecognizer","../geom/Line","../geom/Location","../navigate/LookAt","../util/Logger","../geom/Matrix","../navigate/Navigator","../gesture/PanRecognizer","../gesture/PinchRecognizer","../geom/Position","../gesture/RotationRecognizer","../gesture/TiltRecognizer","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y){"use strict";var v=function(t){function r(t){t.preventDefault()}var i=this;t.addEventListener("mousedown",r),t.addEventListener("touchstart",r),t.addEventListener("contextmenu",r),t.addEventListener("wheel",r),window.PointerEvent&&t.canvas.style.setProperty("touch-action","none"),this.worldWindow=t,this.lookAt=t.navigator.getAsLookAt(this.worldWindow.globe,new a),this.modelview=l.fromIdentity(),this.range=1e7,this.enable2DLimits=!0,this.primaryDragRecognizer=new e(t,function(t){i.handlePanOrDrag(t)}),this.secondaryDragRecognizer=new e(t,function(t){i.handleSecondaryDrag(t)}),this.secondaryDragRecognizer.button=2,this.panRecognizer=new c(t,function(t){i.handlePanOrDrag(t)}),this.pinchRecognizer=new h(t,function(t){i.handlePinch(t)}),this.rotationRecognizer=new d(t,function(t){i.handleRotation(t)}),this.tiltRecognizer=new p(t,function(t){i.handleTilt(t)}),t.addEventListener("wheel",function(t){i.handleWheelEvent(t)}),this.panRecognizer.recognizeSimultaneouslyWith(this.pinchRecognizer),this.panRecognizer.recognizeSimultaneouslyWith(this.rotationRecognizer),this.pinchRecognizer.recognizeSimultaneouslyWith(this.rotationRecognizer),this.panRecognizer.requireRecognizerToFail(this.tiltRecognizer),this.pinchRecognizer.requireRecognizerToFail(this.tiltRecognizer),this.rotationRecognizer.requireRecognizerToFail(this.tiltRecognizer),this.beginPoint=new g(0,0),this.lastPoint=new g(0,0),this.beginHeading=0,this.beginTilt=0,this.beginRange=0,this.lastRotation=0};return v.prototype.handlePanOrDrag=function(t){this.worldWindow.globe.is2D()?this.handlePanOrDrag2D(t):this.handlePanOrDrag3D(t)},v.prototype.handlePanOrDrag3D=function(e){var r=e.state,i=e.translationX,n=e.translationY;if(r==WorldWind.BEGAN)this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.lastPoint.set(0,0);else if(r==WorldWind.CHANGED){var o=this.worldWindow.canvas,a=this.worldWindow.globe,s=y.max(a.equatorialRadius,a.polarRadius),l=y.max(1,this.lookAt.range),u=y.perspectivePixelSize(o.clientWidth,o.clientHeight,l),c=(n-this.lastPoint[1])*u,h=-(i-this.lastPoint[0])*u,f=c/s*t.RADIANS_TO_DEGREES,d=h/s*t.RADIANS_TO_DEGREES,p=Math.sin(this.lookAt.heading*t.DEGREES_TO_RADIANS),g=Math.cos(this.lookAt.heading*t.DEGREES_TO_RADIANS);
this.lookAt.latitude+=f*g-d*p,this.lookAt.longitude+=f*p+d*g,this.lastPoint.set(i,n),this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()}},v.prototype.handlePanOrDrag2D=function(t){var e=t.state,r=t.clientX,i=t.clientY,n=t.translationX,o=t.translationY;if(e==WorldWind.BEGAN)this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.beginPoint.set(r,i),this.lastPoint.set(r,i);else if(e==WorldWind.CHANGED){var a=this.lastPoint[0],s=this.lastPoint[1],u=this.beginPoint[0]+n,c=this.beginPoint[1]+o;this.lastPoint.set(u,c);var h=this.currentState(),f=this.worldWindow.globe,d=h.rayFromScreenPoint(this.worldWindow.canvasCoordinates(a,s)),p=new m(0,0,0),g=new m(0,0,0),y=new m(0,0,0);if(!f.intersectsLine(d,p))return;if(d=h.rayFromScreenPoint(this.worldWindow.canvasCoordinates(u,c)),!f.intersectsLine(d,g))return;var v=l.fromIdentity();if(v.copy(h.modelview),v.multiplyByTranslation(g[0]-p[0],g[1]-p[1],g[2]-p[2]),v.extractEyePoint(d.origin),v.extractForwardVector(d.direction),!f.intersectsLine(d,y))return;var b=v.extractViewingParameters(y,this.roll,f,{});this.lookAt.set(b.origin),this.lookAt.range=b.range,this.lookAt.heading=b.heading,this.lookAt.tilt=b.tilt,this.lookAt.roll=b.roll,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()}},v.prototype.handleSecondaryDrag=function(t){var e=t.state,r=t.translationX,i=t.translationY;if(this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),e==WorldWind.BEGAN)this.beginHeading=this.lookAt.heading,this.beginTilt=this.lookAt.tilt;else if(e==WorldWind.CHANGED){var n=180*r/this.worldWindow.canvas.clientWidth,o=90*i/this.worldWindow.canvas.clientHeight;this.lookAt.heading=this.beginHeading+n,this.lookAt.tilt=this.beginTilt+o,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()}},v.prototype.handlePinch=function(t){var e=t.state,r=t.scale;e==WorldWind.BEGAN?(this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.beginRange=this.lookAt.range):e==WorldWind.CHANGED&&0!=r&&(this.lookAt.range=this.beginRange/r,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw())},v.prototype.handleRotation=function(t){var e=t.state,r=t.rotation;e==WorldWind.BEGAN?(this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.lastRotation=0):e==WorldWind.CHANGED&&(this.lookAt.heading-=r-this.lastRotation,this.lookAt.lastRotation=r,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw())},v.prototype.handleTilt=function(t){var e=t.state,r=t.translationY;if(e==WorldWind.BEGAN)this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt),this.beginTilt=this.lookAt.tilt;else if(e==WorldWind.CHANGED){var i=-90*r/this.worldWindow.canvas.clientHeight;this.lookAt.tilt=this.beginTilt+i,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()}},v.prototype.handleWheelEvent=function(t){this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt);var e;t.deltaMode==WheelEvent.DOM_DELTA_PIXEL?e=t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_LINE?e=40*t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_PAGE&&(e=400*t.deltaY);var r=1+e/1e3;this.lookAt.range*=r,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw()},v.prototype.applyLimits=function(){if(this.lookAt.latitude=y.clamp(this.lookAt.latitude,-90,90),this.lookAt.longitude=t.normalizedDegreesLongitude(this.lookAt.longitude),this.lookAt.range=y.clamp(this.lookAt.range,1,Number.MAX_VALUE),this.lookAt.heading=t.normalizedDegrees(this.lookAt.heading),this.lookAt.tilt=y.clamp(this.lookAt.tilt,0,90),this.lookAt.roll=t.normalizedDegrees(this.lookAt.roll),this.worldWindow.globe.is2D()&&this.enable2DLimits){var e=2*Math.PI*this.worldWindow.globe.equatorialRadius;this.lookAt.range=y.clamp(this.lookAt.range,1,e),this.lookAt.tilt=0}},v}),define("worldwind/util/AbsentResourceList",[],function(){"use strict";var t=function(t,e){this.maxTrys=t,this.minCheckInterval=e,this.tryAgainInterval=6e4,this.possiblyAbsent={}};return t.prototype.isResourceAbsent=function(t){var e=this.possiblyAbsent[t];if(!e)return!1;if(e.permanent)return!0;var r=Date.now()-e.timeOfLastMark;return r>this.tryAgainInterval?(delete this.possiblyAbsent[t],!1):r<this.minCheckInterval||e.numTrys>this.maxTrys},t.prototype.markResourceAbsent=function(t){var e=this.possiblyAbsent[t];e||(e={timeOfLastMark:Date.now(),numTrys:0},this.possiblyAbsent[t]=e),e.numTrys=e.numTrys+1,e.timeOfLastMark=Date.now()},t.prototype.markResourceAbsentPermanently=function(t){var e=this.possiblyAbsent[t];e||(e={timeOfLastMark:Date.now(),numTrys:0},this.possiblyAbsent[t]=e),e.numTrys=e.numTrys+1,e.timeOfLastMark=Date.now(),e.permanent=!0},t.prototype.unmarkResourceAbsent=function(t){var e=this.possiblyAbsent[t];e&&delete this.possiblyAbsent[t]},t}),define("worldwind/error/NotYetImplementedError",["../error/AbstractError"],function(t){"use strict";var e=function(e){t.call(this,"NotYetImplementedError",e);var r;try{throw new Error}catch(t){r=t.stack}this.stack=r};return e.prototype=Object.create(t.prototype),e}),define("worldwind/geom/BoundingBox",["../error/ArgumentError","../shaders/BasicProgram","../geom/Frustum","../util/Logger","../geom/Matrix","../error/NotYetImplementedError","../geom/Plane","../geom/Sector","../geom/Vec3","../util/WWMath","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(){this.center=new l(0,0,0),this.bottomCenter=new l(-.5,0,0),this.topCenter=new l(.5,0,0),this.r=new l(1,0,0),this.s=new l(0,1,0),this.t=new l(0,0,1),this.radius=Math.sqrt(3),this.tmp1=new l(0,0,0),this.tmp2=new l(0,0,0),this.tmp3=new l(0,0,0),this.scratchElevations=new Float64Array(9),this.scratchPoints=new Float64Array(3*this.scratchElevations.length)};return h.scratchMatrix=n.fromIdentity(),h.prototype.setToPoints=function(e){if(!e||e.length<3)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","setToPoints","missingArray"));var r,o,a,s,u,c,h,f,d,p,g,m,y,v,b,E=+Number.MAX_VALUE,w=-Number.MAX_VALUE,_=+Number.MAX_VALUE,x=-Number.MAX_VALUE,S=+Number.MAX_VALUE,T=-Number.MAX_VALUE,M=this.r,L=this.s,A=this.t,N=new l(0,0,0);n.principalAxesFromPoints(e,M,L,A);for(var C=0,R=e.length/3;C<R;C++)N[0]=e[3*C],N[1]=e[3*C+1],N[2]=e[3*C+2],r=N.dot(M),E>r&&(E=r),w<r&&(w=r),o=N.dot(L),_>o&&(_=o),x<o&&(x=o),a=N.dot(A),S>a&&(S=a),T<a&&(T=a);return w===E&&(w=E+1),x===_&&(x=_+1),T===S&&(T=S+1),s=w-E,u=x-_,c=T-S,h=w+E,f=x+_,d=T+S,p=.5*M[0]*s,g=.5*M[1]*s,m=.5*M[2]*s,y=.5*(M[0]*h+L[0]*f+A[0]*d),v=.5*(M[1]*h+L[1]*f+A[1]*d),b=.5*(M[2]*h+L[2]*f+A[2]*d),this.center[0]=y,this.center[1]=v,this.center[2]=b,this.topCenter[0]=y+p,this.topCenter[1]=v+g,this.topCenter[2]=b+m,this.bottomCenter[0]=y-p,this.bottomCenter[1]=v-g,this.bottomCenter[2]=b-m,M.multiply(s),L.multiply(u),A.multiply(c),this.radius=.5*Math.sqrt(s*s+u*u+c*c),this},h.prototype.setToSector=function(e,r,n,o){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","setToSector","missingSector"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","setToSector","missingGlobe"));var a=this.scratchElevations,s=this.scratchPoints;c.fillArray(a,o),a[0]=a[2]=a[6]=a[8]=n,r.computePointsForGrid(e,3,3,a,l.ZERO,s);var h=12;this.tmp1.set(s[h],s[h+1],s[h+2]),u.localCoordinateAxesAtPoint(this.tmp1,r,this.r,this.s,this.t);for(var f=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],d=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],p=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],g=0,m=s.length;g<m;g+=3)this.tmp1.set(s[g],s[g+1],s[g+2]),this.adjustExtremes(this.r,f,this.s,d,this.t,p,this.tmp1);f[1]-f[0]<d[1]-d[0]&&this.swapAxes(this.r,f,this.s,d),d[1]-d[0]<p[1]-p[0]&&this.swapAxes(this.s,d,this.t,p),f[1]-f[0]<d[1]-d[0]&&this.swapAxes(this.r,f,this.s,d);var y=f[1]-f[0],v=d[1]-d[0],b=p[1]-p[0],E=f[1]+f[0],w=d[1]+d[0],_=p[1]+p[0],x=.5*(this.r[0]*E+this.s[0]*w+this.t[0]*_),S=.5*(this.r[1]*E+this.s[1]*w+this.t[1]*_),T=.5*(this.r[2]*E+this.s[2]*w+this.t[2]*_),M=.5*this.r[0]*y,L=.5*this.r[1]*y,A=.5*this.r[2]*y;return this.center.set(x,S,T),this.topCenter.set(x+M,S+L,T+A),this.bottomCenter.set(x-M,S-L,T-A),this.r.multiply(y),this.s.multiply(v),this.t.multiply(b),this.radius=.5*Math.sqrt(y*y+v*v+b*b),this},h.prototype.translate=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","translate","missingVector"));return this.bottomCenter.add(e),this.topCenter.add(e),this.center.add(e),this},h.prototype.distanceTo=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","distanceTo","missingPoint"));var r=this.center.distanceTo(e)-this.radius;return r>=0?r:-r},h.prototype.effectiveRadius=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","effectiveRadius","missingPlane"));var r=e.normal;return.5*(u.fabs(this.r.dot(r))+u.fabs(this.s.dot(r))+u.fabs(this.t.dot(r)))},h.prototype.intersectsFrustum=function(e){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"BoundingBox","intersectsFrustum","missingFrustum"));return this.tmp1.copy(this.bottomCenter),this.tmp2.copy(this.topCenter),!(this.intersectionPoint(e.near)<0)&&(!(this.intersectionPoint(e.far)<0)&&(!(this.intersectionPoint(e.left)<0)&&(!(this.intersectionPoint(e.right)<0)&&(!(this.intersectionPoint(e.top)<0)&&!(this.intersectionPoint(e.bottom)<0)))))},h.prototype.intersectionPoint=function(t){var e=t.normal,r=.5*(Math.abs(this.s.dot(e))+Math.abs(this.t.dot(e)));return this.intersectsAt(t,r,this.tmp1,this.tmp2)},h.prototype.intersectsAt=function(t,e,r,i){var n=t.dot(r),o=n<=-e,a=t.dot(i),s=a<=-e;if(o&&s)return-1;if(o==s)return 0;this.tmp3.copy(r),this.tmp3.subtract(i);var l=(e+n)/t.normal.dot(this.tmp3);return this.tmp3.copy(i),this.tmp3.subtract(r),this.tmp3.multiply(l),this.tmp3.add(r),o?r.copy(this.tmp3):i.copy(this.tmp3),l},h.prototype.adjustExtremes=function(t,e,r,i,n,o,a){var s=a.dot(t);e[0]>s&&(e[0]=s),e[1]<s&&(e[1]=s);var l=a.dot(r);i[0]>l&&(i[0]=l),i[1]<l&&(i[1]=l);var u=a.dot(n);o[0]>u&&(o[0]=u),o[1]<u&&(o[1]=u)},h.prototype.swapAxes=function(t,e,r,i){t.swap(r);var n=e[0];e[0]=i[0],i[0]=n,n=e[1],e[1]=i[1],i[1]=n},h.prototype.render=function(t){var r=t.currentGlContext,i=h.scratchMatrix,n=t.findAndBindProgram(e);try{i.copy(t.navigatorState.modelviewProjection),i.multiply(this.r[0],this.s[0],this.t[0],this.center[0],this.r[1],this.s[1],this.t[1],this.center[1],this.r[2],this.s[2],this.t[2],this.center[2],0,0,0,1),i.multiplyByTranslation(-.5,-.5,-.5),n.loadModelviewProjection(r,i),r.disable(r.CULL_FACE),r.bindBuffer(r.ARRAY_BUFFER,t.unitCubeBuffer()),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.unitCubeElements()),r.enableVertexAttribArray(n.vertexPointLocation),r.vertexAttribPointer(n.vertexPointLocation,3,r.FLOAT,!1,0,0),n.loadColorComponents(r,0,1,0,.6),r.drawElements(r.LINES,24,r.UNSIGNED_SHORT,72),n.loadColorComponents(r,1,1,1,.3),r.drawElements(r.TRIANGLES,36,r.UNSIGNED_SHORT,0)}finally{r.enable(r.CULL_FACE),r.bindBuffer(r.ARRAY_BUFFER,null),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null)}},h}),define("worldwind/util/Tile",["../error/ArgumentError","../geom/BoundingBox","../util/Logger","../geom/Sector","../geom/Vec3","../util/WWUtil"],function(t,e,r,i,n,o){"use strict";var a=function(e,i,n,o){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","constructor","missingSector"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","constructor","The specified level is null or undefined."));if(n<0||o<0)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","constructor","The specified row or column is less than zero."));this.sector=e,this.level=i,this.row=n,this.column=o,this.tileWidth=i.tileWidth,this.tileHeight=i.tileHeight,this.texelSize=i.texelSize,this.tileKey=i.levelNumber.toString()+"."+n.toString()+"."+o.toString(),this.extent=null,this.referencePoint=null,this.opacity=1,this.samplePoints=null,this.sampleElevations=null,this.updateTimestamp=null,this.updateVerticalExaggeration=null,this.updateGlobeStateKey=null};return a.prototype.isEqual=function(t){return!!t&&(!!t.tileKey&&this.tileKey==t.tileKey)},a.prototype.size=function(){return 828},a.prototype.distanceTo=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","distanceTo","missingVector"));for(var i,n,o,a=e[0],s=e[1],l=e[2],u=this.samplePoints,c=Number.POSITIVE_INFINITY,h=0,f=u.length;h<f;h+=3)i=a-u[h],n=s-u[h+1],o=l-u[h+2],c=Math.min(c,i*i+n*n+o*o);return Math.sqrt(c)},a.prototype.subdivide=function(e,n){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","subdivide","The specified level is null or undefined."));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","subdivide","The specified tile factory is null or undefined."));var o,a,s,l=this.sector.minLatitude,u=this.sector.maxLatitude,c=this.sector.centroidLatitude(),h=this.sector.minLongitude,f=this.sector.maxLongitude,d=this.sector.centroidLongitude(),p=[];return o=2*this.row,a=2*this.column,s=new i(l,c,h,d),p.push(n.createTile(s,e,o,a)),o=2*this.row,a=2*this.column+1,s=new i(l,c,d,f),p.push(n.createTile(s,e,o,a)),o=2*this.row+1,a=2*this.column,s=new i(c,u,h,d),p.push(n.createTile(s,e,o,a)),o=2*this.row+1,a=2*this.column+1,s=new i(c,u,d,f),p.push(n.createTile(s,e,o,a)),p},a.prototype.subdivideToCache=function(e,i,n){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","subdivideToCache","The specified level is null or undefined."));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile factory is null or undefined."));var o=n?n.entryForKey(this.tileKey):null;return o||(o=this.subdivide(e,i),o&&n&&n.putEntry(this.tileKey,o,4*o[0].size())),o},a.prototype.mustSubdivide=function(t,e){var r=t.globe.equatorialRadius*this.texelSize,i=this.distanceTo(t.navigatorState.eyePoint),n=t.navigatorState.pixelSizeAtDistance(i);return r>Math.max(e*n,.5)},a.prototype.update=function(t){var e=t.globe.elevationTimestamp(),r=t.verticalExaggeration,i=t.globeStateKey;this.updateTimestamp==e&&this.updateVerticalExaggeration==r&&this.updateGlobeStateKey==i||(this.doUpdate(t),t.frameStatistics.incrementTileUpdateCount(1),this.updateTimestamp=e,this.updateVerticalExaggeration=r,this.updateGlobeStateKey=i)},a.prototype.doUpdate=function(t){var r=t.globe,i=t.verticalExaggeration,a=r.minAndMaxElevationsForSector(this.sector),s=a?a[0]*i:0,l=a?a[1]*i:0;s==l&&(s=l+10),this.extent||(this.extent=new e),this.extent.setToSector(this.sector,r,s,l),this.samplePoints||(this.sampleElevations=new Float64Array(9),this.samplePoints=new Float64Array(3*this.sampleElevations.length)),o.fillArray(this.sampleElevations,.5*(s+l)),r.computePointsForGrid(this.sector,3,3,this.sampleElevations,n.ZERO,this.samplePoints),this.referencePoint||(this.referencePoint=new n(0,0,0)),r.computePointFromPosition(this.sector.centroidLatitude(),this.sector.centroidLongitude(),0,this.referencePoint)},a.computeRow=function(t,e){var r=Math.floor((e+90)/t);return 90==e&&(r-=1),r},a.computeColumn=function(t,e){var r=Math.floor((e+180)/t);return 180==e&&(r-=1),r},a.computeLastRow=function(t,e){var r=Math.ceil((e+90)/t-1);return e+90<t&&(r=0),r},a.computeLastColumn=function(t,e){var r=Math.ceil((e+180)/t-1);return e+180<t&&(r=0),r},a.computeSector=function(e,n,o){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","computeSector","missingLevel"));if(n<0||o<0)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","computeSector","The specified row or column is less than zero."));var a=e.tileDelta.latitude,s=e.tileDelta.longitude,l=-90+n*a,u=-180+o*s,c=l+a,h=u+s;return new i(l,c,u,h)},a.createTilesForLevel=function(e,n,o){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","createTilesForLevel","missingLevel"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","createTilesForLevel","The specified tile factory is null or undefined"));if(!o)throw new t(r.logMessage(r.LEVEL_SEVERE,"Tile","createTilesForLevel","missingResult"));for(var s,l,u,c=e.tileDelta.latitude,h=e.tileDelta.longitude,f=e.sector,d=a.computeRow(c,f.minLatitude),p=a.computeRow(c,f.maxLatitude),g=a.computeColumn(h,f.minLongitude),m=a.computeColumn(h,f.maxLongitude),y=-90+d*c,v=-180+g*h,b=y,E=d;E<=p;E+=1){l=b+c,s=v;for(var w=g;w<=m;w+=1){u=s+h;var _=new i(b,l,s,u),x=n.createTile(_,e,E,w);o.push(x),s=u}b=l}},a}),define("worldwind/render/TextureTile",["../error/ArgumentError","../util/Logger","../util/Tile"],function(t,e,r){"use strict";var i=function(t,e,i,n){r.call(this,t,e,i,n),this.gpuCacheKey=null};return i.prototype=Object.create(r.prototype),i.prototype.size=function(){return r.prototype.size.call(this)},i.prototype.bind=function(t){var e=t.gpuResourceCache.resourceForKey(this.gpuCacheKey);return!!e&&e.bind(t)},i.prototype.applyInternalTransform=function(t,e){},i}),define("worldwind/render/ImageTile",["../error/ArgumentError","../util/Logger","../render/TextureTile","../util/Tile"],function(t,e,r,i){"use strict";var n=function(i,n,o,a,s){if(!s||s.length<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"ImageTile","constructor","The specified image path is null, undefined or zero length."));r.call(this,i,n,o,a),this.imagePath=s,this.fallbackTile=null,this.gpuCacheKey=s};return n.prototype=Object.create(r.prototype),n.prototype.size=function(){return this.__proto__.__proto__.size.call(this)+this.imagePath.length+8},n.prototype.bind=function(t){var e=this.__proto__.__proto__.bind.call(this,t);return!!e||!!this.fallbackTile&&this.fallbackTile.bind(t)},n.prototype.applyInternalTransform=function(t,e){this.fallbackTile&&!t.gpuResourceCache.resourceForKey(this.imagePath)&&this.applyFallbackTransform(e)},n.prototype.applyFallbackTransform=function(t){var e=this.level.levelNumber-this.fallbackTile.level.levelNumber;if(!(e<=0)){var r=this.fallbackTile.sector.deltaLatitude(),i=this.fallbackTile.sector.deltaLongitude(),n=this.sector.deltaLongitude()/i,o=this.sector.deltaLatitude()/r,a=(this.sector.minLongitude-this.fallbackTile.sector.minLongitude)/i,s=(this.sector.minLatitude-this.fallbackTile.sector.minLatitude)/r;t.multiply(n,0,0,a,0,o,0,s,0,0,1,0,0,0,0,1)}},n}),define("worldwind/util/Level",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger"],function(t,e,r,i){"use strict";var n=function(r,n,o){if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"Level","constructor","The specified tile delta is null or undefined"));if(!o)throw new e(i.logMessage(i.LEVEL_SEVERE,"Level","constructor","The specified parent level set is null or undefined"));this.levelNumber=r,this.tileDelta=n,this.parent=o,this.texelSize=n.latitude*t.DEGREES_TO_RADIANS/o.tileHeight,this.tileWidth=o.tileWidth,this.tileHeight=o.tileHeight,this.sector=o.sector};return n.prototype.isFirstLevel=function(){return this.parent.firstLevel()==this},n.prototype.isLastLevel=function(){return this.parent.lastLevel()==this},n.prototype.previousLevel=function(){return this.parent.level(this.levelNumber-1)},n.prototype.nextLevel=function(){return this.parent.level(this.levelNumber+1)},n.prototype.compare=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Level","compare","The specified level is null or undefined"));return this.levelNumber<t.levelNumber?-1:this.levelNumber>t.levelNumber?1:0},n}),define("worldwind/util/LevelSet",["../error/ArgumentError","../util/Level","../geom/Location","../util/Logger"],function(t,e,r,i){"use strict";var n=function(n,o,a,s,l){if(!n)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","missingSector"));if(!o)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","The specified level zero delta is null or undefined"));if(o.latitude<=0||o.longitude<=0)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","The specified level zero delta is less than or equal to zero."));if(a<1)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","The specified number of levels is less than one."));if(s<1||l<1)throw new t(i.logMessage(i.LEVEL_SEVERE,"LevelSet","constructor","The specified tile width or tile height is less than one."));this.sector=n,this.levelZeroDelta=o,this.numLevels=a,this.tileWidth=s,this.tileHeight=l,this.levels=[];for(var u=0;u<a;u+=1){var c=Math.pow(2,u),h=o.latitude/c,f=o.longitude/c,d=new r(h,f),p=new e(u,d,this);this.levels[u]=p}};return n.prototype.level=function(t){return t<0||t>=this.levels.length?null:this.levels[t]},n.prototype.levelForTexelSize=function(t){var e=this.lastLevel();if(e.texelSize>=t)return e;for(var r=0,i=this.levels.length;r<i;r+=1){var n=this.levels[r];if(n.texelSize<=t)return n}return e},n.prototype.firstLevel=function(){return this.levels[0]},n.prototype.lastLevel=function(){return this.levels[this.levels.length-1]},n}),define("worldwind/cache/MemoryCache",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i){if(!r||r<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","constructor","The specified capacity is undefined, zero or negative"));if(!i||i>=r||i<0)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","constructor","The specified low-water value is undefined, greater than or equal to the capacity, or less than 1"));this._capacity=r,this._lowWater=i,this.usedCapacity=0,this.freeCapacity=r,this.entries={},this.listeners=[]};return Object.defineProperties(r.prototype,{capacity:{get:function(){return this._capacity},set:function(r){if(!r||r<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","capacity","Specified cache capacity is undefined, 0 or negative."));var i=this._capacity;this._capacity=r,this._capacity<=this.lowWater&&(this._lowWater=.85*this._capacity),this._capacity<i&&this.makeSpace(0)}},lowWater:{get:function(){return this._lowWater},set:function(r){if(!r||r>=this._capacity||r<0)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","lowWater","Specified cache low-water value is undefined, negative or not less than the current capacity."));this._lowWater=r}}}),r.prototype.entryForKey=function(t){if(!t)return null;var e=this.entries[t];return e?(e.lastUsed=Date.now(),e.entry):null},r.prototype.putEntry=function(r,i,n){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","putEntry","missingKey."));if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","putEntry","missingEntry."));if(n<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","putEntry","The specified entry size is less than 1."));var o,a=this.entries[r];a&&this.removeEntry(r),this.usedCapacity+n>this._capacity&&this.makeSpace(n),this.usedCapacity+=n,this.freeCapacity=this._capacity-this.usedCapacity,o={key:r,entry:i,size:n,lastUsed:Date.now()},this.entries[r]=o},r.prototype.clear=function(t){if(t)for(var e in this.entries)this.entries.hasOwnProperty(e)&&this.removeCacheEntry(e);this.entries={},this.freeCapacity=this._capacity,this.usedCapacity=0},r.prototype.removeEntry=function(t){if(t){var e=this.entries[t];e&&this.removeCacheEntry(e)}},r.prototype.removeCacheEntry=function(t){delete this.entries[t.key],this.usedCapacity-=t.size,this.freeCapacity=this._capacity-this.usedCapacity;for(var e=0,r=this.listeners.length;e<r;e++)try{this.listeners[e].entryRemoved(t.key,t.entry)}catch(r){this.listeners[e].removalError(r,t.key,t.entry)}},r.prototype.containsKey=function(t){return t&&this.entries[t]},r.prototype.addCacheListener=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","addCacheListener","missingListener"));if("function"!=typeof r.entryRemoved||"function"!=typeof r.removalError)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","addCacheListener","The specified listener does not implement the required functions."));this.listeners.push(r)},r.prototype.removeCacheListener=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"MemoryCache","removeCacheListener","missingListener"));var i=this.listeners.indexOf(r);i>-1&&this.listeners.splice(i,1)},r.prototype.makeSpace=function(t){var e=[];this.usedCapacity;for(var r in this.entries)this.entries.hasOwnProperty(r)&&e.push(this.entries[r]);e.sort(function(t,e){return t.lastUsed-e.lastUsed});for(var i=0,n=e.length;i<n&&(this.usedCapacity>this._lowWater||this.freeCapacity<t);i++)this.removeCacheEntry(e[i])},r}),define("worldwind/layer/TiledImageLayer",["../util/AbsentResourceList","../error/ArgumentError","../render/ImageTile","../layer/Layer","../util/LevelSet","../util/Logger","../cache/MemoryCache","../render/Texture","../util/Tile","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u){"use strict";var c=function(r,s,l,u,c,h,f){if(!r)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","missingSector"));if(!s)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified level-zero delta is null or undefined."));if(!u)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified image format is null or undefined."));if(!c)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified cache path is null or undefined."));if(!l||l<1)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified number of levels is less than one."));if(!h||!f||h<1||f<1)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified tile width or height is less than one."));i.call(this,"Tiled Image Layer"),this.retrievalImageFormat=u,this.cachePath=c,this.levels=new n(r,s,l,h,f),this.detailControl=1.75,this.expiration=null,this.currentTiles=[],this.currentTilesInvalid=!0,this.tileCache=new a(5e5,4e5),this.currentRetrievals=[],this.absentResourceList=new t(3,5e4),this.pickEnabled=!1};return c.prototype=Object.create(i.prototype),c.prototype.refresh=function(){this.expiration=new Date,this.currentTilesInvalid=!0},c.prototype.prePopulate=function(t){if(!t)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","prePopulate","missingWorldWindow"));var r=t.drawContext;this.topLevelTiles&&0!==this.topLevelTiles.length||this.createTopLevelTiles(r);for(var i=0;i<this.topLevelTiles.length;i++){var n=this.topLevelTiles[i];this.isTileTextureInMemory(r,n)||this.retrieveTileImage(r,n,!0)}},c.prototype.prePopulateCurrentTiles=function(t){if(!t)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","prePopulate","missingWorldWindow"));var r=t.drawContext;this.assembleTiles(r);for(var i=0,n=this.currentTiles.length;i<n;i++){var a=this.currentTiles[i];this.isTileTextureInMemory(r,a)||this.retrieveTileImage(r,a,!0)}},c.prototype.isPrePopulated=function(t){if(!t)throw new e(o.logMessage(o.LEVEL_SEVERE,"TiledImageLayer","isPrePopulated","missingWorldWindow"));for(var r=0;r<this.topLevelTiles.length;r++)if(!this.isTileTextureInMemory(t.drawContext,this.topLevelTiles[r]))return!1;return!0},c.prototype.createTile=function(t,e,i,n){var o=this.cachePath+"-layer/"+e.levelNumber+"/"+i+"/"+i+"_"+n+"."+u.suffixForMimeType(this.retrievalImageFormat);return new r(t,e,i,n,o)},c.prototype.doRender=function(t){if(t.terrain){if(this.currentTilesInvalid||!this.lasTtMVP||!t.navigatorState.modelviewProjection.equals(this.lasTtMVP)||t.globeStateKey!=this.lastGlobeStateKey)if(this.currentTilesInvalid=!1,t.surfaceOpacity>=1&&this.opacity>=1){this.previousTiles={};for(var e=0;e<this.currentTiles.length;e++)this.previousTiles[this.currentTiles[e].imagePath]=this.currentTiles[e];this.assembleTiles(t),this.fadeOutgoingTiles(t)}else this.assembleTiles(t);this.lasTtMVP=t.navigatorState.modelviewProjection,this.lastGlobeStateKey=t.globeStateKey,this.currentTiles.length>0&&(t.surfaceTileRenderer.renderTiles(t,this.currentTiles,this.opacity,t.surfaceOpacity>=1),t.frameStatistics.incrementImageTileCount(this.currentTiles.length),this.inCurrentFrame=!0)}},c.prototype.fadeOutgoingTiles=function(t){for(var e=(t.timestamp-t.previousRedrawTimestamp)/t.fadeTime,r={},i=0;i<this.currentTiles.length;i++){var n=this.currentTiles[i];r[n.imagePath]=n}for(var o in this.previousTiles)this.previousTiles.hasOwnProperty(o)&&(n=this.previousTiles[o],n.opacity>0&&!r[n.imagePath]&&(n.opacity=Math.max(0,n.opacity-e),n.opacity>0&&(this.currentTiles.push(n),this.currentTilesInvalid=!0,t.redrawRequested=!0)))},c.prototype.isLayerInView=function(t){return t.terrain&&t.terrain.sector&&t.terrain.sector.intersects(this.levels.sector)},c.prototype.createTopLevelTiles=function(t){this.topLevelTiles=[],l.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)},c.prototype.assembleTiles=function(t){this.currentTiles=[],this.topLevelTiles&&0!==this.topLevelTiles.length||this.createTopLevelTiles(t);for(var e=0,r=this.topLevelTiles.length;e<r;e++){var i=this.topLevelTiles[e];i.update(t),this.currentAncestorTile=null,this.isTileVisible(t,i)&&this.addTileOrDescendants(t,i)}},c.prototype.addTileOrDescendants=function(t,e){if(this.tileMeetsRenderingCriteria(t,e))return void this.addTile(t,e);var r=null;try{(this.isTileTextureInMemory(t,e)||0===e.level.levelNumber)&&(r=this.currentAncestorTile,this.currentAncestorTile=e);for(var i=this.levels.level(e.level.levelNumber+1),n=e.subdivideToCache(i,this,this.tileCache),o=0,a=n.length;o<a;o++){var s=n[o];s.update(t),this.levels.sector.intersects(s.sector)&&this.isTileVisible(t,s)&&this.addTileOrDescendants(t,s)}}finally{r&&(this.currentAncestorTile=r)}},c.prototype.addTile=function(t,e){e.fallbackTile=null;var r=t.gpuResourceCache.resourceForKey(e.imagePath);return r?(e.opacity=1,this.currentTiles.push(e),void(this.expiration&&this.isTextureExpired(r)&&this.retrieveTileImage(t,e))):(this.retrieveTileImage(t,e),void(this.currentAncestorTile&&this.isTileTextureInMemory(t,this.currentAncestorTile)&&(e.fallbackTile=this.currentAncestorTile,e.fallbackTile.opacity=1,this.currentTiles.push(e))))},c.prototype.isTileVisible=function(t,e){return!(t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits))&&e.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)},c.prototype.tileMeetsRenderingCriteria=function(t,e){var r=this.detailControl;return(e.sector.minLatitude>=75||e.sector.maxLatitude<=-75)&&(r*=1.2),e.level.isLastLevel()||!e.mustSubdivide(t,r)},c.prototype.isTileTextureInMemory=function(t,e){return t.gpuResourceCache.containsResource(e.imagePath)},c.prototype.isTextureExpired=function(t){return this.expiration&&t.creationTime.getTime()<=this.expiration.getTime()},c.prototype.retrieveTileImage=function(t,e,r){if(this.currentRetrievals.indexOf(e.imagePath)<0){if(this.absentResourceList.isResourceAbsent(e.imagePath))return;var i=this.resourceUrlForTile(e,this.retrievalImageFormat),n=new Image,a=e.imagePath,s=t.gpuResourceCache,l=t.currentGlContext.canvas,u=this;if(!i)return void(this.currentTilesInvalid=!0);n.onload=function(){o.log(o.LEVEL_INFO,"Image retrieval succeeded: "+i);var c=u.createTexture(t,e,n);if(u.removeFromCurrentRetrievals(a),c&&(s.putResource(a,c,c.size),u.currentTilesInvalid=!0,u.absentResourceList.unmarkResourceAbsent(a),!r)){var h=document.createEvent("Event");h.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),l.dispatchEvent(h)}},n.onerror=function(){u.removeFromCurrentRetrievals(a),u.absentResourceList.markResourceAbsent(a),o.log(o.LEVEL_WARNING,"Image retrieval failed: "+i)},this.currentRetrievals.push(a),n.crossOrigin="anonymous",n.src=i}},c.prototype.createTexture=function(t,e,r){return new s(t.currentGlContext,r)},c.prototype.removeFromCurrentRetrievals=function(t){var e=this.currentRetrievals.indexOf(t);e>-1&&this.currentRetrievals.splice(e,1)},c.prototype.resourceUrlForTile=function(t,e){return this.urlBuilder?this.urlBuilder.urlForTile(t,e):null},c}),define("worldwind/layer/MercatorTiledImageLayer",["../util/Color","../geom/Sector","../layer/TiledImageLayer","../geom/Vec2","../util/WWMath"],function(t,e,r,i,n){"use strict";var o=function(t,e,n,o,a,s,l){r.call(this,t,e,n,o,a,s,l),this.detectBlankImages=!1,this.testPixels=[new i(20,20),new i(235,20),new i(20,235),new i(235,235)],this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d");
};return o.prototype=Object.create(r.prototype),o.prototype.createTile=function(t,i,o,a){var s,l,u,c,h,f,d=this.mapSizeForLevel(i.levelNumber),p=n.clamp(a*this.imageSize,0,d),g=n.clamp(o*this.imageSize,0,d),m=n.clamp(p+this.imageSize,0,d),y=n.clamp(g+this.imageSize,0,d);return s=p/d-.5,l=.5-y/d,u=90-360*Math.atan(Math.exp(2*-l*Math.PI))/Math.PI,c=360*s,s=m/d-.5,l=.5-g/d,h=90-360*Math.atan(Math.exp(2*-l*Math.PI))/Math.PI,f=360*s,t=new e(u,h,c,f),r.prototype.createTile.call(this,t,i,o,a)},o.prototype.createTexture=function(t,e,i){var o,a,s,l,u,c,h,f,d=t.canvas2D,p=t.ctx2D,g=this.destCanvas,m=this.destContext,y=m.createImageData(i.width,i.height),v=e.sector,b=n.gudermannianInverse(v.minLatitude),E=n.gudermannianInverse(v.maxLatitude);if(d.width=i.width,d.height=i.height,g.width=i.width,g.height=i.height,p.drawImage(i,0,0,i.width,i.height),o=p.getImageData(0,0,i.width,i.height),this.detectBlankImages&&this.isBlankImage(i,o))return this.absentResourceList.markResourceAbsentPermanently(e.imagePath),null;for(var w=0;w<1;w++)for(var _=0;_<i.height;_++){h=1-_/(i.height-1),a=h*v.deltaLatitude()+v.minLatitude,s=n.gudermannianInverse(a),f=1-(s-b)/(E-b),f=n.clamp(f,0,1),l=Math.floor(f*(i.height-1));for(var x=0;x<i.width;x++)u=4*(x+l*i.width),c=4*(x+_*i.width),y.data[c]=o.data[u],y.data[c+1]=o.data[u+1],y.data[c+2]=o.data[u+2],y.data[c+3]=o.data[u+3]}return m.putImageData(y,0,0),r.prototype.createTexture.call(this,t,e,g)},o.prototype.isBlankImage=function(t,e){for(var r,i,n=null,o=0,a=this.testPixels.length;o<a;o++)if(r=this.testPixels[o],i=4*(r[0]+r[1]*t.width),n){if(e.data[i]!=n[0]||e.data[i+1]!=n[1]||e.data[i+2]!=n[2])return!1}else n=[e.data[i],e.data[i+1],e.data[i+2]];return!0},o}),define("worldwind/layer/BingTiledImageLayer",["../geom/Angle","../geom/Location","../geom/Sector","../layer/MercatorTiledImageLayer"],function(t,e,r,i){"use strict";var n=function(t){this.imageSize=256,i.call(this,new r(-85.05,85.05,-180,180),new e(85.05,180),23,"image/jpeg",t,this.imageSize,this.imageSize),this.displayName=t,this.pickEnabled=!1,this.detectBlankImages=!0,this.creditImage=WorldWind.configuration.baseUrl+"images/powered-by-bing.png"};return n.prototype=Object.create(i.prototype),n.prototype.doRender=function(t){i.prototype.doRender.call(this,t),this.inCurrentFrame&&t.screenCreditController.addImageCredit(this.creditImage)},n.prototype.createTopLevelTiles=function(t){this.topLevelTiles=[],this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))},n.prototype.mapSizeForLevel=function(t){return 256<<t+1},n}),define("worldwind/util/BingImageryUrlBuilder",["../error/ArgumentError","../util/Logger","../util/WWUtil"],function(t,e,r){"use strict";var i=function(t,e){var r="AkttWCS8p6qzxvx5RH3qUcCPgwG9nRJ7IwlpFGb14B0rBorB5DvmXr2Y_eCUNIxH";e||(this.bingMapsKey=WorldWind.BingMapsKey,e||(this.bingMapsKey=r),e===r&&(this.bingMapsKey=r,i.showBingMapsKeyWarning())),this.imagerySet=t};return i.showBingMapsKeyWarning=function(){i.keyMessagePrinted||(i.keyMessagePrinted=!0,e.log(e.LEVEL_WARNING,"WARNING: You are using a limited use, non-production Bing Maps key.\nIf you are developing an app or a web page this violates the Bing Terms of Use.\nPlease visit https://www.microsoft.com/maps/choose-your-bing-maps-API.aspx to obtain your own key for your application.\nSpecify that key to World Wind by setting the WorldWind.BingMapsKey property to your key prior to creating any Bing Maps layers.\n"))},i.prototype.requestMetadata=function(){if(!this.metadataRetrievalInProcess){this.metadataRetrievalInProcess=!0;var t="https://dev.virtualearth.net/REST/V1/Imagery/Metadata/"+this.imagerySet+"/0,0?zl=1&uriScheme=https&key="+this.bingMapsKey,e=this;r.jsonp(t,"jsonp",function(t){e.imageUrl=t.resourceSets[0].resources[0].imageUrl;var r=document.createEvent("Event");r.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(r),e.metadataRetrievalInProcess=!1})}},i.prototype.urlForTile=function(r,i){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"BingImageryUrlBuilder","urlForTile","missingTile"));if(!this.imageUrl)return this.requestMetadata(),null;var n,o=this.quadKeyFromLevelRowColumn(r.level.levelNumber,r.row,r.column);return"Aerial"===this.imagerySet?n=this.imageUrl.replace(/a3/,"a"+o):"AerialWithLabels"===this.imagerySet?n=this.imageUrl.replace(/h3/,"h"+o):"Road"===this.imagerySet&&(n=this.imageUrl.replace(/r3/,"r"+o)),n},i.prototype.quadKeyFromLevelRowColumn=function(t,e,r){for(var i,n,o="",a=t+1;a>0;a--)i=0,n=1<<a-1,0!=(r&n)&&(i+=1),0!=(e&n)&&(i+=2),o+=i.toString();return o},i}),define("worldwind/layer/BingAerialLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,"Bing Aerial"),this.urlBuilder=new i("Aerial",t)};return n.prototype=Object.create(r.prototype),n}),define("worldwind/layer/BingAerialWithLabelsLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,"Bing Aerial with Labels"),this.urlBuilder=new i("AerialWithLabels",t)};return n.prototype=Object.create(r.prototype),n}),define("worldwind/layer/BingRoadsLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,"Bing Roads"),this.urlBuilder=new i("Road",t),this.detectBlankImages=!1};return n.prototype=Object.create(r.prototype),n}),define("worldwind/util/WmsUrlBuilder",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i,n,o,a){if(!r||0===r.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","constructor","The WMS service address is missing."));if(!i||0===i.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","constructor","The WMS layer names are not specified."));this.serviceAddress=r,this.layerNames=i,this.styleNames=n?n:"",this.transparent=!0,this.wmsVersion=o&&o.length>0?o:"1.3.0",this.isWms130OrGreater=this.wmsVersion>="1.3.0",this.crs="EPSG:4326",this.timeString=a};return r.prototype.urlForTile=function(i,n){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","missingTile"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","The image format is null or undefined."));var o=i.sector,a=r.fixGetMapString(this.serviceAddress);return a.search(/service=wms/i)<0&&(a+="service=WMS"),a+="&request=GetMap",a=a+"&version="+this.wmsVersion,a=a+"&transparent="+(this.transparent?"TRUE":"FALSE"),a=a+"&layers="+this.layerNames,a=a+"&styles="+this.styleNames,a=a+"&format="+n,a=a+"&width="+i.tileWidth,a=a+"&height="+i.tileHeight,this.timeString&&(a=a+"&time="+this.timeString),this.isWms130OrGreater?(a=a+"&crs="+this.crs,a+="&bbox=","CRS:84"===this.crs?(a=a+o.minLongitude+","+o.minLatitude+",",a=a+o.maxLongitude+","+o.maxLatitude):(a=a+o.minLatitude+","+o.minLongitude+",",a=a+o.maxLatitude+","+o.maxLongitude)):(a=a+"&srs="+this.crs,a+="&bbox=",a=a+o.minLongitude+","+o.minLatitude+",",a=a+o.maxLongitude+","+o.maxLatitude),a=a.replace(" ","%20")},r.fixGetMapString=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","fixGetMapString","The specified service address is null or undefined."));var i=r.indexOf("?");return i<0?r+="?":i!==r.length-1&&(i=r.search(/&$/),i<0&&(r+="&")),r},r}),define("worldwind/layer/BingWMSLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(t,e,r,i){"use strict";var n=function(){r.call(this,e.FULL_SPHERE,new t(45,45),16,"image/png","BingWMS",256,256),this.displayName="Bing WMS",this.pickEnabled=!1,this.maxActiveAltitude=1e4,this.urlBuilder=new i("https://worldwind27.arc.nasa.gov/wms/virtualearth","ve","","1.3.0")};return n.prototype=Object.create(r.prototype),n}),define("worldwind/layer/BMNGLandsatLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(t,e,r,i){"use strict";var n=function(){r.call(this,e.FULL_SPHERE,new t(45,45),10,"image/jpeg","BMNGLandsat256",256,256),this.displayName="Blue Marble & Landsat",this.pickEnabled=!1,this.urlBuilder=new i("https://worldwind25.arc.nasa.gov/wms","BlueMarble-200405,esat","","1.3.0")};return n.prototype=Object.create(r.prototype),n}),define("worldwind/layer/BMNGLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(t,e,r,i){"use strict";var n=function(n){r.call(this,e.FULL_SPHERE,new t(45,45),5,"image/jpeg",n||"BMNG256",256,256),this.displayName="Blue Marble",this.pickEnabled=!1,this.urlBuilder=new i("https://worldwind25.arc.nasa.gov/wms",n||"BlueMarble-200405","","1.3.0")};return n.prototype=Object.create(r.prototype),n}),define("worldwind/layer/RenderableLayer",["../error/ArgumentError","../layer/Layer","../util/Logger"],function(t,e,r){"use strict";var i=function(t){e.call(this,t),this.renderables=[]};return i.prototype=Object.create(e.prototype),i.prototype.addRenderable=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"RenderableLayer","addRenderable","missingRenderable"));this.renderables.push(e)},i.prototype.addRenderables=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"RenderableLayer","addRenderables","The renderables array is null or undefined."));for(var i=0,n=e.length;i<n;i++)this.addRenderable(e[i])},i.prototype.removeRenderable=function(t){var e=this.renderables.indexOf(t);e>=0&&this.renderables.splice(e,1)},i.prototype.removeAllRenderables=function(){this.renderables=[]},i.prototype.doRender=function(t){for(var e=t.orderedRenderables.length,i=0,n=this.renderables.length;i<n;i++)try{this.renderables[i].render(t)}catch(t){r.logMessage(r.LEVEL_SEVERE,"RenderableLayer","doRender","Error while rendering shape "+this.renderables[i].displayName+".\n"+t.toString())}t.orderedRenderables.length>e&&(this.inCurrentFrame=!0)},i}),define("worldwind/render/SurfaceTile",["../error/ArgumentError","../util/Logger","../geom/Matrix","../geom/Sector","../error/UnsupportedOperationError"],function(t,e,r,i,n){"use strict";var o=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceTile","constructor","missingSector"));this.sector=r};return o.prototype.bind=function(t){throw new n(e.logMessage(e.LEVEL_SEVERE,"SurfaceTile","bind","abstractInvocation"))},o.prototype.applyInternalTransform=function(t,r){throw new n(e.logMessage(e.LEVEL_SEVERE,"SurfaceTile","applyInternalTransform","abstractInvocation"))},o}),define("worldwind/shapes/SurfaceImage",["../error/ArgumentError","../util/Logger","../pick/PickedObject","../render/SurfaceTile"],function(t,e,r,i){"use strict";var n=function(r,n){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceImage","constructor","missingSector"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceImage","constructor","missingImage"));i.call(this,r),this.enabled=!0,this._imageSource=n,this.opacity=1,this.displayName="Surface Image",this.imageSourceWasUpdated=!0};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{imageSource:{get:function(){return this._imageSource},set:function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceImage","imageSource","missingImage"));this._imageSource=r,this.imageSourceWasUpdated=!0}}}),n.prototype.bind=function(t){var e=t.gpuResourceCache.resourceForKey(this._imageSource);return e&&!this.imageSourceWasUpdated?e.bind(t):(e=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this._imageSource),this.imageSourceWasUpdated=!1,e?e.bind(t):void 0)},n.prototype.applyInternalTransform=function(t,e){},n.prototype.render=function(t){if(this.enabled&&this.sector.overlaps(t.terrain.sector)){if(t.pickingMode&&(this.pickColor=t.uniquePickColor()),t.surfaceTileRenderer.renderTiles(t,[this],this.opacity*t.currentLayer.opacity),t.pickingMode){var e=new r(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);t.resolvePick(e)}t.currentLayer.inCurrentFrame=!0}},n}),define("worldwind/layer/BMNGOneImageLayer",["../layer/RenderableLayer","../geom/Sector","../shapes/SurfaceImage","../util/WWUtil"],function(t,e,r,i){"use strict";var n=function(){t.call(this,"Blue Marble Image");var i=new r(e.FULL_SPHERE,WorldWind.configuration.baseUrl+"images/BMNG_world.topo.bathy.200405.3.2048x1024.jpg");this.addRenderable(i),this.pickEnabled=!1,this.minActiveAltitude=3e6};return n.prototype=Object.create(t.prototype),n}),define("worldwind/util/PeriodicTimeSequence",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"PeriodicTimeSequence","constructor","missingString"));var n=i.split("/");if(3!==n.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"PeriodicTimeSequence","constructor","The interval string "+i+" does not contain 3 elements."));this.sequenceString=i,this.startTime=new Date(n[0]),this.endTime=new Date(n[1]),this.intervalMilliseconds=this.endTime.getTime()-this.startTime.getTime(),this._currentTime=this.startTime,this.infiniteInterval=this.startTime.getTime()==this.endTime.getTime(),this.period=r.parsePeriodString(n[2],!1)};return Object.defineProperties(r.prototype,{currentTime:{get:function(){return this._currentTime},set:function(t){this._currentTime=t}},scaleForCurrentTime:{get:function(){return this.currentTime?(this.currentTime.getTime()-this.startTime.getTime())/this.intervalMilliseconds:1}}}),r.prototype.next=function(){return this.currentTime?this.currentTime.getTime()>=this.endTime.getTime()&&!this.infiniteInterval?this.currentTime=null:this.currentTime=r.incrementTime(this.currentTime,this.period):this.currentTime=this.startTime,this.currentTime},r.prototype.previous=function(){return this.currentTime?this.currentTime.getTime()===this.startTime.getTime()?this.currentTime=null:this.currentTime=this.getTimeForScale(.9999*this.scaleForCurrentTime):this.currentTime=this.endTime,this.currentTime},r.prototype.reset=function(){this.currentTime=null},r.prototype.getTimeForScale=function(t){if(t<=0)return this.startTime;if(t>=1)return this.endTime;var e=new Date(this.startTime.getTime()),i=e,n=0;for(n=0;n<t;n=(e.getTime()-this.startTime.getTime())/this.intervalMilliseconds)i=e,e=r.incrementTime(e,this.period);return i},r.incrementTime=function(t,e){var i=new Date(t.getTime());return 0!=e[0]&&i.setUTCFullYear(i.getUTCFullYear()+e[0]),0!=e[1]&&r.addMonths(i,e[1]),0!=e[2]&&i.setUTCDate(i.getUTCDate()+7*e[2]),0!=e[3]&&i.setUTCDate(i.getUTCDate()+e[3]),0!=e[4]&&i.setUTCHours(i.getUTCHours()+e[4]),0!=e[5]&&i.setUTCMinutes(i.getUTCMinutes()+e[5]),0!=e[6]&&i.setUTCSeconds(i.getUTCSeconds()+e[6]),i},r.isLeapYear=function(t){return t%4===0&&t%100!==0||t%400===0},r.getDaysInMonth=function(t,e){return[31,r.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},r.addMonths=function(t,e){var i=t.getUTCDate();return t.setUTCDate(1),t.setUTCMonth(t.getUTCMonth()+e),t.setUTCDate(Math.min(i,r.getDaysInMonth(t.getUTCFullYear(),t.getUTCMonth()))),t},r.parsePeriodString=function(r,i){var n,o=!!i&&i,a=[2,3,4,5,7,8,9],s=[0,0,0,0,0,0,0],l=[0,12,4,7,24,60,60];if(r=r.toUpperCase().trim(),!r)return s;if("string"!=typeof r)throw new t(e.logMessage(e.LEVEL_SEVERE,"PeriodicTimeSequence","parsePeriodString","Invalid ISO8601 period string '"+r+"'"));if(!(n=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(r)))throw new t(e.logMessage(e.LEVEL_SEVERE,"PeriodicTimeSequence","parsePeriodString","String '"+r+"' is not a valid ISO8601 period."));for(var u=0;u<a.length;u++){var c=a[u];s[u]=n[c]?+n[c].replace(/[A-Za-z]+/g,""):0}if(o)for(u=s.length-1;u>0;u--)s[u]>=l[u]&&(s[u-1]=s[u-1]+Math.floor(s[u]/l[u]),s[u]=s[u]%l[u]);return s},r}),define("worldwind/util/LevelRowColumnUrlBuilder",["../error/ArgumentError","../util/Logger","../util/WWUtil"],function(t,e,r){"use strict";var i=function(t,e){this.serverAddress=t,t&&0!==t.length||(this.serverAddress=r.currentUrlSansFilePart()),this.pathToData=e};return i.prototype.urlForTile=function(i,n){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","missingTile"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","The image format is null or undefined."));var o=this.serverAddress;return this.pathToData&&(o=o+"/"+this.pathToData),o=o+"/"+i.level.levelNumber.toString(),o=o+"/"+i.row.toString(),o=o+"/"+i.row.toString()+"_"+i.column.toString(),o=o+"."+r.suffixForMimeType(n),o=o.replace(" ","%20")},i}),define("worldwind/layer/RestTiledImageLayer",["../error/ArgumentError","../geom/Location","../util/Logger","../geom/Sector","../layer/TiledImageLayer","../util/LevelRowColumnUrlBuilder","../util/WWUtil"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,s,l){var u=a.urlPath(t+"/"+r);n.call(this,l&&l.sector||i.FULL_SPHERE,l&&l.levelZeroTileDelta||new e(45,45),l&&l.numLevels||5,l&&l.imageFormat||"image/jpeg",u,l&&l.tileWidth||256,l&&l.tileHeight||256),this.displayName=s,this.pickEnabled=!1,this.urlBuilder=new o(t,r)};return s.prototype=Object.create(n.prototype),s}),define("worldwind/layer/BMNGRestLayer",["../error/ArgumentError","../layer/Layer","../util/Logger","../util/PeriodicTimeSequence","../layer/RestTiledImageLayer"],function(t,e,r,i,n){"use strict";var o=function(t,r,n,a){e.call(this,n||"Blue Marble time series"),this.time=a||new Date("2004-01"),this.pickEnabled=!1,this.layers={},this.layerNames=[{month:"BlueMarble-200401",time:o.availableTimes[0]},{month:"BlueMarble-200402",time:o.availableTimes[1]},{month:"BlueMarble-200403",time:o.availableTimes[2]},{month:"BlueMarble-200404",time:o.availableTimes[3]},{month:"BlueMarble-200405",time:o.availableTimes[4]},{month:"BlueMarble-200406",time:o.availableTimes[5]},{month:"BlueMarble-200407",time:o.availableTimes[6]},{month:"BlueMarble-200408",time:o.availableTimes[7]},{month:"BlueMarble-200409",time:o.availableTimes[8]},{month:"BlueMarble-200410",time:o.availableTimes[9]},{month:"BlueMarble-200411",time:o.availableTimes[10]},{month:"BlueMarble-200412",time:o.availableTimes[11]}],this.timeSequence=new i("2004-01-01/2004-12-01/P1M"),this.serverAddress=t||"http://worldwindserver.net/webworldwind/",this.pathToData=r||"/standalonedata/Earth/BlueMarble256/"};return o.prototype=Object.create(e.prototype),o.availableTimes=[new Date("2004-01"),new Date("2004-02"),new Date("2004-03"),new Date("2004-04"),new Date("2004-05"),new Date("2004-06"),new Date("2004-07"),new Date("2004-08"),new Date("2004-09"),new Date("2004-10"),new Date("2004-11"),new Date("2004-12")],o.prototype.prePopulate=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"BMNGRestLayer","prePopulate","missingWorldWindow"));for(var i=0;i<this.layerNames.length;i++){var n=this.layerNames[i].month;this.layers[n]||this.createSubLayer(n),this.layers[n].prePopulate(e)}},o.prototype.isPrePopulated=function(t){for(var e=0;e<this.layerNames.length;e++){var r=this.layers[this.layerNames[e].month];if(!r||!r.isPrePopulated(t))return!1}return!0},o.prototype.doRender=function(t){var e=this.nearestLayer(this.time);e.opacity=this.opacity,this.detailControl&&(e.detailControl=this.detailControl),e.doRender(t),this.inCurrentFrame=e.inCurrentFrame},o.prototype.nearestLayer=function(t){var e=this.nearestLayerName(t);return this.layers[e]||this.createSubLayer(e),this.layers[e]},o.prototype.createSubLayer=function(t){var e=this.pathToData+t;this.layers[t]=new n(this.serverAddress,e,this.displayName)},o.prototype.nearestLayerName=function(t){var e=t.getTime();if(e<=this.layerNames[0].time.getTime())return this.layerNames[0].month;if(e>=this.layerNames[11].time.getTime())return this.layerNames[11].month;for(var r=0;r<this.layerNames.length-1;r++){var i=this.layerNames[r].time.getTime(),n=this.layerNames[r+1].time.getTime();if(e>=i&&e<=n){var o=e-i,a=n-e;return o<a?this.layerNames[r].month:this.layerNames[r+1].month}}},o}),define("worldwind/gesture/ClickRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.numberOfClicks=1,this.button=0,this.maxMouseMovement=5,this.maxClickDuration=500,this.maxClickInterval=400,this.clicks=[],this.timeout=null};return e.prototype=Object.create(t.prototype),e.prototype.reset=function(){t.prototype.reset.call(this),this.clicks=[],this.cancelFailAfterDelay()},e.prototype.mouseDown=function(t){if(this.state==WorldWind.POSSIBLE)if(this.button!=t.button)this.state=WorldWind.FAILED;else{var e={clientX:this.clientX,clientY:this.clientY};this.clicks.push(e),this.failAfterDelay(this.maxClickDuration)}},e.prototype.mouseMove=function(t){if(this.state==WorldWind.POSSIBLE){var e=this.translationX,r=this.translationY,i=Math.sqrt(e*e+r*r);i>this.maxMouseMovement&&(this.state=WorldWind.FAILED)}},e.prototype.mouseUp=function(t){if(this.state==WorldWind.POSSIBLE&&0==this.mouseButtonMask){var e=this.clicks.length;e==this.numberOfClicks?(this.clientX=this.clicks[0].clientX,this.clientY=this.clicks[0].clientY,this.state=WorldWind.RECOGNIZED):this.failAfterDelay(this.maxClickInterval)}},e.prototype.touchStart=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.failAfterDelay=function(t){var e=this;e.timeout&&window.clearTimeout(e.timeout),e.timeout=window.setTimeout(function(){e.timeout=null,e.state==WorldWind.POSSIBLE&&(e.state=WorldWind.FAILED)},t)},e.prototype.cancelFailAfterDelay=function(){var t=this;t.timeout&&(window.clearTimeout(t.timeout),t.timeout=null)},e}),define("worldwind/formats/collada/ColladaAsset",[],function(){"use strict";var t=function(t){this.xmlAsset=t.getElementsByTagName("asset")[0],this.asset={daeVersion:t.querySelector("COLLADA").getAttribute("version")}};return t.prototype.parse=function(){if(!this.xmlAsset)return null;for(var t=0;t<this.xmlAsset.childNodes.length;t++){var e=this.xmlAsset.childNodes.item(t);if(1===e.nodeType)switch(e.nodeName){case"contributor":var r=e.querySelector("authoring_tool");r&&(this.asset.authoring_tool=r.textContext);break;case"unit":this.asset.unit=e.getAttribute("meter");break;default:this.asset[e.localName]=e.textContent}}return this.xmlAsset=null,this.asset},t}),define("worldwind/formats/collada/ColladaUtils",["../../util/Logger"],function(t){"use strict";var e={getRawValues:function(t){if(!t)return null;var e=t.textContent;return e=e.replace(/\n/gi," "),e=e.replace(/\s+/gi," "),e=e.trim(),0===e.length?null:e.split(" ")},bufferDataFloat32:function(t){var e=this.getRawValues(t);if(!e)return null;for(var r=e.length,i=new Float32Array(r),n=0;n<r;n++)i[n]=parseFloat(e[n]);return i},bufferDataUInt32:function(t){var e=this.getRawValues(t);if(!e)return null;for(var r=e.length,i=new Uint32Array(r),n=0;n<r;n++)i[n]=parseInt(e[n]);return i},getFirstChildElement:function(t,e){for(var r=t.childNodes,i=0;i<r.length;++i){var n=r.item(i);if(1===n.nodeType&&(n.nodeName&&!e||e&&e===n.nodeName))return n}return null},getFilename:function(t){var e=t.lastIndexOf("\\");return e!==-1&&(t=t.substr(e+1)),e=t.lastIndexOf("/"),e!==-1&&(t=t.substr(e+1)),t},replaceSpace:function(t){return t?t.replace(/ /g,"_"):""},querySelectorById:function(t,e){for(var r=0;r<t.length;r++){var i=t.item(r).getAttribute("id");if(i&&i.toString()===e)return t.item(r)}return null},getTextureType:function(t){for(var e=!0,r=0,i=t.length;r<i;r++)if(t[r]<0||t[r]>1){e=!1;break}return e},fetchFile:function(e,r){var i=new XMLHttpRequest;i.onload=function(){this.status>=200&&this.status<400?r(this.response):(t.log(t.LEVEL_SEVERE,"sever error: "+this.status),r(null))},i.onerror=function(e){t.log(t.LEVEL_SEVERE,"connection error: "+e),r(null)},i.open("get",e,!0),i.send()}};return e}),define("worldwind/formats/collada/ColladaImage",["./ColladaUtils"],function(t){"use strict";var e=function(t,e){this.filename="",this.map=t,this.name=e,this.path=""};return e.prototype.parse=function(e){for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"init_from":this.filename=t.getFilename(i.textContent),this.path=i.textContent}}return this},e}),define("worldwind/formats/collada/ColladaMaterial",["./ColladaUtils"],function(t){"use strict";var e=function(t){this.id=t,this.newParams=[]};return e.prototype.parse=function(t){for(var e=0;e<t.childNodes.length;e++){var r=t.childNodes[e];if(1===r.nodeType)switch(r.nodeName){case"profile_COMMON":this.parseProfileCommon(r)}}return this},e.prototype.parseProfileCommon=function(t){for(var e=0;e<t.childNodes.length;e++){var r=t.childNodes[e];if(1===r.nodeType)switch(r.nodeName){case"newparam":this.parseNewparam(r);break;case"image":break;case"technique":this.parseTechnique(r)}}},e.prototype.parseNewparam=function(t){for(var e=t.getAttribute("sid"),r=0;r<t.childNodes.length;r++){var i=t.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"surface":var n=i.querySelector("init_from");n&&this.newParams.push({sid:e,type:"surface",initFrom:n.textContent});break;case"sampler2D":var o=i.querySelector("source");this.newParams.push({sid:e,type:"sampler2D",source:o.textContent});break;case"extra":}}},e.prototype.parseTechnique=function(t){for(var e=0;e<t.childNodes.length;e++){var r=t.childNodes[e];if(1===r.nodeType)switch(r.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.techniqueType=r.nodeName,this.parseTechniqueType(r);break;case"extra":}}},e.prototype.parseTechniqueType=function(e){for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType&&i.nodeName){var n=i.nodeName,o=t.getFirstChildElement(i);if(o)switch(o.nodeName){case"color":this[n]=t.bufferDataFloat32(o).subarray(0,4);break;case"float":this[n]=t.bufferDataFloat32(o)[0];break;case"texture":var a=o.getAttribute("texture"),s=this.newParams.map(function(t){return t.sid}).indexOf(a),l=this.newParams[s].source;s=this.newParams.map(function(t){return t.sid}).indexOf(l);var u=this.newParams[s].initFrom;this.textures||(this.textures={}),this.textures[n]={mapId:u}}}}},e}),define("worldwind/formats/collada/ColladaMesh",["./ColladaUtils"],function(t){"use strict";var e=function(t){this.filename=t||"",this.name=t||"",this.buffers=[]};return e.prototype.parse=function(e){for(var r={},i={},n={id:"",inputs:[]},o=0;o<e.childNodes.length;o++){var a=e.childNodes[o];if(1===a.nodeType)switch(a.nodeName){case"source":if(!a.querySelector)continue;var s=a.querySelector("float_array");if(!s)continue;var l=t.bufferDataFloat32(s),u=a.querySelector("accessor"),c=parseInt(u.getAttribute("stride"));r[a.getAttribute("id")]={stride:c,data:l};break;case"vertices":this.parseVertices(a,n);break;case"triangles":i=this.parsePolygons(a,r,n,3),this.buffers.push(i);break;case"polygons":i=this.parsePolygons(a,r,n,4),this.buffers.push(i);break;case"polylist":i=this.parsePolygons(a,r,n,null),this.buffers.push(i)}}return this},e.prototype.parseVertices=function(t,e){e.id=t.getAttribute("id");for(var r=t.querySelectorAll("input"),i=0;i<r.length;i++){var n=r[i],o=n.getAttribute("source").substr(1),a=n.getAttribute("semantic").toUpperCase();e.inputs.push({semantic:a,source:o})}},e.prototype.parsePolygons=function(t,e,r,i){var n=[];if(null==i){var o=t.querySelector("vcount");n=o.textContent.trim().split(" ")}var a=parseInt(t.getAttribute("count")),s=t.getAttribute("material"),l=this.parseInputs(t,e,r),u=l.inputs,c=l.maxOffset,h=t.querySelector("p"),f=[];h&&(f=h.textContent.trim().split(" "));for(var d=u.length,p=0,g={},m=[],y=0,v=!1,b=0;b<a;b++){if(n.length)var E=parseInt(n[b]);else E=i;for(var w=-1,_=-1,x=-1,S=0;S<E;S++){var T=f.slice(y,y+c).join(" ");if(x=_,g.hasOwnProperty(T))_=g[T],v=!0;else{for(var M=0;M<d;M++){var L=u[M],A=L[4],N=parseInt(f[y+A]),C=L[1],R=L[3];N*=L[2];for(var P=0;P<L[2];P++)C.push(R[N+P])}_=p,p+=1,g[T]=_}E>3&&(0===S&&(w=_),S>2*c&&(m.push(w),m.push(x))),m.push(_),y+=c}}var O={vertices:new Float32Array(u[0][1]),indexedRendering:v,material:s};return this.transformMeshInfo(O,u,m),O},e.prototype.parseInputs=function(t,e,r){for(var i=[],n=0,o=t.querySelectorAll("input"),a=0;a<o.length;a++){var s=o.item(a);if(s.getAttribute){var l=s.getAttribute("semantic").toUpperCase(),u=s.getAttribute("source").substr(1),c=parseInt(s.getAttribute("offset"));n=n<c+1?c+1:n;var h=0;if(s.getAttribute("set")&&(h=parseInt(s.getAttribute("set"))),r.id===u)for(var f=r.inputs,d=0;d<f.length;d++){var p=e[f[d].source];p&&i.push([f[d].semantic,[],p.stride,p.data,c,h])}else p=e[u],i.push([l,[],p.stride,p.data,c,h])}}return{inputs:i,maxOffset:n}},e.prototype.transformMeshInfo=function(e,r,i){for(var n={normal:"normals",texcoord:"uvs"},o=1;o<r.length;o++){var a=r[o][0].toLowerCase(),s=r[o][1];s.length&&(n[a]&&(a=n[a]),e[a]&&(a+=r[o][5]),e[a]=new Float32Array(s),"uvs"===a&&(e.isClamp=t.getTextureType(s)))}return e.indexedRendering&&(e.indices=new Uint16Array(i)),e},e}),define("worldwind/formats/collada/ColladaNode",["./ColladaUtils","../../geom/Matrix","../../geom/Vec3"],function(t,e,r){"use strict";var i=function(){this.id="",this.name="",this.sid="",this.children=[],this.materials=[],this.mesh="",this.localMatrix=e.fromIdentity(),this.worldMatrix=e.fromIdentity()};return i.prototype.parse=function(t,r,n){this.id=t.getAttribute("id"),this.sid=t.getAttribute("sid"),this.name=t.getAttribute("name"),this.children=[],this.materials=[],this.mesh="",this.localMatrix=e.fromIdentity(),this.worldMatrix=e.fromIdentity(),this.setNodeTransforms(t,n);for(var o=0;o<t.childNodes.length;o++){var a=t.childNodes[o];if(1===a.nodeType)switch(a.nodeName){case"node":this.children.push((new i).parse(a,r,this.worldMatrix));break;case"instance_geometry":this.mesh=a.getAttribute("url").substr(1);for(var s=a.querySelectorAll("instance_material"),l=0;l<s.length;l++){var u=s.item(l);this.materials.push({id:u.getAttribute("target").substr(1),symbol:u.getAttribute("symbol")})}break;case"instance_node":var c=a.getAttribute("url").substr(1),h=this.getLibraryNode(r,c);h&&this.children.push((new i).parse(h,r,this.worldMatrix))}}return this},i.prototype.setNodeTransforms=function(i,n){var o=e.fromIdentity(),a=e.fromIdentity(),s=e.fromIdentity(),l=e.fromIdentity();n||(n=e.fromIdentity());for(var u=[],c=0;c<i.childNodes.length;c++){var h=i.childNodes[c];if(1===h.nodeType)switch(h.nodeName){case"matrix":var f=t.bufferDataFloat32(h);o.copy(f),u.push(o);break;case"rotate":f=t.bufferDataFloat32(h),a.multiplyByRotation(f[0],f[1],f[2],f[3]),u.push(a);break;case"translate":f=t.bufferDataFloat32(h),s.multiplyByTranslation(f[0],f[1],f[2]),u.push(s);break;case"scale":f=t.bufferDataFloat32(h),l.multiplyByScale(f[0],f[1],f[2]),u.push(l)}}for(c=0;c<u.length;c++)this.localMatrix.multiplyMatrix(u[c]);this.worldMatrix.setToMultiply(n,this.localMatrix),this.normalMatrix=e.fromIdentity();var d=new r(0,0,0);this.worldMatrix.extractRotationAngles(d),this.normalMatrix.multiplyByRotation(-1,0,0,d[0]),this.normalMatrix.multiplyByRotation(0,-1,0,d[1]),this.normalMatrix.multiplyByRotation(0,0,-1,d[2])},i.prototype.getLibraryNode=function(t,e){for(var r=0;r<t.length;r++){var i=t[r].attributes.getNamedItem("id");if(i&&i.value===e)return t[r]}return null},i}),define("worldwind/formats/collada/ColladaScene",["../../error/ArgumentError","../../shaders/BasicTextureProgram","../../util/Color","../../util/Logger","../../geom/Matrix","../../geom/Position","../../pick/PickedObject","../../render/Renderable","../../geom/Vec3"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"ColladaScene","constructor","missingPosition"));s.call(this),this._position=e,this._nodes=[],this._meshes={},this._materials={},this._images={},this._upAxis="",this._dirPath="",this._xRotation=0,this._yRotation=0,this._zRotation=0,this._xTranslation=0,this._yTranslation=0,this._zTranslation=0,this._scale=1,this._altitudeMode=WorldWind.ABSOLUTE,this._localTransforms=!0,this._useTexturePaths=!0,this._nodesToHide=[],this._hideNodes=!1,this.setSceneData(r),
this._placePoint=new l(0,0,0),this._transformationMatrix=n.fromIdentity(),this._normalMatrix=n.fromIdentity(),this._texCoordMatrix=n.fromIdentity().setToUnitYFlip(),this._activeTexture=null};return u.prototype=Object.create(s.prototype),u.prototype.constructor=u,Object.defineProperties(u.prototype,{position:{get:function(){return this._position},set:function(t){this._position=t}},nodes:{get:function(){return this._nodes},set:function(t){this._nodes=t}},meshes:{get:function(){return this._meshes},set:function(t){this._meshes=t}},materials:{get:function(){return this._materials},set:function(t){this._materials=t}},images:{get:function(){return this._images},set:function(t){this._images=t}},upAxis:{get:function(){return this._upAxis},set:function(t){this._upAxis=t}},dirPath:{get:function(){return this._dirPath},set:function(t){this._dirPath=t}},xRotation:{get:function(){return this._xRotation},set:function(t){this._xRotation=t}},yRotation:{get:function(){return this._yRotation},set:function(t){this._yRotation=t}},zRotation:{get:function(){return this._zRotation},set:function(t){this._zRotation=t}},xTranslation:{get:function(){return this._xTranslation},set:function(t){this._xTranslation=t}},yTranslation:{get:function(){return this._yTranslation},set:function(t){this._yTranslation=t}},zTranslation:{get:function(){return this._zTranslation},set:function(t){this._zTranslation=t}},scale:{get:function(){return this._scale},set:function(t){this._scale=t}},placePoint:{get:function(){return this._placePoint},set:function(t){this._placePoint=t}},altitudeMode:{get:function(){return this._altitudeMode},set:function(t){this._altitudeMode=t}},transformationMatrix:{get:function(){return this._transformationMatrix},set:function(t){this._transformationMatrix=t}},normalMatrix:{get:function(){return this._normalMatrix},set:function(t){this._normalMatrix=t}},localTransforms:{get:function(){return this._localTransforms},set:function(t){this._localTransforms=t}},useTexturePaths:{get:function(){return this._useTexturePaths},set:function(t){this._useTexturePaths=t}},nodesToHide:{get:function(){return this._nodesToHide},set:function(t){this._nodesToHide=t}},hideNodes:{get:function(){return this._hideNodes},set:function(t){this._hideNodes=t}}}),u.prototype.setSceneData=function(t){t&&(this.nodes=t.root.children,this.meshes=t.meshes,this.materials=t.materials,this.images=t.images,this.upAxis=t.metadata.up_axis,this.dirPath=t.dirPath)},u.prototype.render=function(t){var e;this.enabled&&(this.lastFrameTime!==t.timestamp&&(e=this.makeOrderedRenderable(t)),e&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e)))},u.prototype.makeOrderedRenderable=function(t){return t.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint),this.eyeDistance=t.navigatorState.eyePoint.distanceTo(this.placePoint),this},u.prototype.renderOrdered=function(t){if(this.drawOrderedScene(t),t.pickingMode){var e=new a(this.pickColor.clone(),this,this.position,this.layer,!1);t.resolvePick(e)}},u.prototype.drawOrderedScene=function(t){this.beginDrawing(t);try{this.doDrawOrderedScene(t)}finally{this.endDrawing(t)}},u.prototype.beginDrawing=function(t){var r=t.currentGlContext;t.findAndBindProgram(e),r.enable(r.CULL_FACE),r.enable(r.DEPTH_TEST)},u.prototype.doDrawOrderedScene=function(t){t.pickingMode&&(this.pickColor=t.uniquePickColor()),this.computeTransformationMatrix(t.globe);for(var e=0,r=this.nodes.length;e<r;e++)this.traverseNodeTree(t,this.nodes[e])},u.prototype.traverseNodeTree=function(t,e){var r=this.mustRenderNode(e.id);if(r){if(e.mesh)for(var i=e.mesh,n=this.meshes[i].buffers,o=0,a=n.length;o<a;o++){for(var s=n[o].material,l=0;l<e.materials.length;l++)if(s===e.materials[l].symbol){var u=e.materials[l].id;break}var c=this.materials[u];this.draw(t,n[o],c,e.worldMatrix,e.normalMatrix)}for(var h=0;h<e.children.length;h++)this.traverseNodeTree(t,e.children[h])}},u.prototype.draw=function(t,e,r,i,n){var o=t.currentGlContext,a=t.currentProgram;this.applyVertices(t,e),a.loadTextureEnabled(o,!1),this.applyColor(t,r);var s=r&&null!=r.textures&&e.uvs&&e.uvs.length>0;s&&this.applyTexture(t,e,r);var l=null!=e.normals&&e.normals.length>0;l&&!t.pickingMode&&this.applyLighting(t,e),this.applyMatrix(t,l,s,i,n),e.indexedRendering?(this.applyIndices(t,e),o.drawElements(o.TRIANGLES,e.indices.length,o.UNSIGNED_SHORT,0)):o.drawArrays(o.TRIANGLES,0,Math.floor(e.vertices.length/3)),this.resetDraw(t,l,s)},u.prototype.applyVertices=function(t,e){var r,i=t.currentGlContext,n=t.currentProgram;e.verticesVboCacheKey||(e.verticesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(e.verticesVboCacheKey),r||(r=i.createBuffer(),t.gpuResourceCache.putResource(e.verticesVboCacheKey,r,e.vertices.length),e.refreshVertexBuffer=!0),i.bindBuffer(i.ARRAY_BUFFER,r),e.refreshVertexBuffer&&(i.bufferData(i.ARRAY_BUFFER,e.vertices,i.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),e.refreshVertexBuffer=!1),i.enableVertexAttribArray(n.vertexPointLocation),i.vertexAttribPointer(n.vertexPointLocation,3,i.FLOAT,!1,0,0)},u.prototype.applyColor=function(t,e){var i=t.currentGlContext,n=t.currentProgram;if(e)if("constant"===e.techniqueType)var o=e.reflective;else o=e.diffuse;var a,s=1,l=1,u=1,c=1;o&&(s=o[0],l=o[1],u=o[2],c=null!=o[3]?o[3]:1);var h=new r(s,l,u,c);a=c*t.currentLayer.opacity,i.depthMask(a>=1||t.pickingMode),n.loadColor(i,t.pickingMode?this.pickColor:h),n.loadOpacity(i,t.pickingMode?a>0?1:0:a)},u.prototype.applyTexture=function(t,e,r){var i,n,o,a=t.currentGlContext,s=t.currentProgram;if(r.textures.diffuse)var l=r.textures.diffuse.mapId;else l=r.textures.reflective.mapId;var u=this.useTexturePaths?this.images[l].path:this.images[l].filename;this._activeTexture=t.gpuResourceCache.resourceForKey(this.dirPath+u+""),this._activeTexture||(o=e.isClamp?a.CLAMP_TO_EDGE:a.REPEAT,this._activeTexture=t.gpuResourceCache.retrieveTexture(a,this.dirPath+u+"",o)),i=this._activeTexture&&this._activeTexture.bind(t),i&&(e.texCoordsVboCacheKey||(e.texCoordsVboCacheKey=t.gpuResourceCache.generateCacheKey()),n=t.gpuResourceCache.resourceForKey(e.texCoordsVboCacheKey),n||(n=a.createBuffer(),t.gpuResourceCache.putResource(e.texCoordsVboCacheKey,n,e.uvs.length),e.refreshTexCoordBuffer=!0),a.bindBuffer(a.ARRAY_BUFFER,n),e.refreshTexCoordBuffer&&(a.bufferData(a.ARRAY_BUFFER,e.uvs,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),e.refreshTexCoordBuffer=!1),s.loadTextureEnabled(a,!0),a.enableVertexAttribArray(s.vertexTexCoordLocation),a.vertexAttribPointer(s.vertexTexCoordLocation,2,a.FLOAT,!1,0,0),s.loadTextureUnit(a,a.TEXTURE0),s.loadModulateColor(a,t.pickingMode))},u.prototype.applyLighting=function(t,e){var r,i=t.currentGlContext,n=t.currentProgram;n.loadApplyLighting(i,!0),e.normalsVboCacheKey||(e.normalsVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(e.normalsVboCacheKey),r||(r=i.createBuffer(),t.gpuResourceCache.putResource(e.normalsVboCacheKey,r,e.normals.length),e.refreshNormalBuffer=!0),i.bindBuffer(i.ARRAY_BUFFER,r),e.refreshNormalBuffer&&(i.bufferData(i.ARRAY_BUFFER,e.normals,i.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),e.refreshNormalBuffer=!1),i.enableVertexAttribArray(n.normalVectorLocation),i.vertexAttribPointer(n.normalVectorLocation,3,i.FLOAT,!1,0,0)},u.prototype.applyMatrix=function(t,e,r,i,o){var a=n.fromIdentity();if(a.copy(t.navigatorState.modelviewProjection),a.multiplyMatrix(this.transformationMatrix),i&&this.localTransforms&&a.multiplyMatrix(i),e&&!t.pickingMode){var s=n.fromIdentity();s.copy(t.navigatorState.modelviewNormalTransform),s.multiplyMatrix(this.normalMatrix),o&&this.localTransforms&&s.multiplyMatrix(o),t.currentProgram.loadModelviewInverse(t.currentGlContext,s)}r&&this._activeTexture&&(t.currentProgram.loadTextureMatrix(t.currentGlContext,this._texCoordMatrix),this._activeTexture=null),t.currentProgram.loadModelviewProjection(t.currentGlContext,a)},u.prototype.applyIndices=function(t,e){var r,i=t.currentGlContext;e.indicesVboCacheKey||(e.indicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(e.indicesVboCacheKey),r||(r=i.createBuffer(),t.gpuResourceCache.putResource(e.indicesVboCacheKey,r,e.indices.length),e.refreshIndicesBuffer=!0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r),e.refreshIndicesBuffer&&(i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.indices,i.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),e.refreshIndicesBuffer=!1)},u.prototype.resetDraw=function(t,e,r){var i=t.currentGlContext,n=t.currentProgram;e&&!t.pickingMode&&(n.loadApplyLighting(i,!1),i.disableVertexAttribArray(n.normalVectorLocation)),r&&i.disableVertexAttribArray(n.vertexTexCoordLocation),i.disableVertexAttribArray(n.vertexPointLocation)},u.prototype.endDrawing=function(t){t.bindProgram(null)},u.prototype.computeTransformationMatrix=function(t){this.transformationMatrix=n.fromIdentity(),this.transformationMatrix.multiplyByLocalCoordinateTransform(this.placePoint,t),this.transformationMatrix.multiplyByRotation(1,0,0,this.xRotation),this.transformationMatrix.multiplyByRotation(0,1,0,this.yRotation),this.transformationMatrix.multiplyByRotation(0,0,1,this.zRotation),this.transformationMatrix.multiplyByScale(this.scale,this.scale,this.scale),this.transformationMatrix.multiplyByTranslation(this.xTranslation,this.yTranslation,this.zTranslation),this.computeNormalMatrix()},u.prototype.computeNormalMatrix=function(){var t=new l(0,0,0);this.transformationMatrix.extractRotationAngles(t),this.normalMatrix=n.fromIdentity(),this.normalMatrix.multiplyByRotation(-1,0,0,t[0]),this.normalMatrix.multiplyByRotation(0,-1,0,t[1]),this.normalMatrix.multiplyByRotation(0,0,-1,t[2])},u.prototype.mustRenderNode=function(t){var e=!0;if(this.hideNodes){var r=this.nodesToHide.indexOf(t);e=r===-1}return e},u}),define("worldwind/formats/collada/ColladaLoader",["../../error/ArgumentError","./ColladaAsset","./ColladaImage","./ColladaMaterial","./ColladaMesh","./ColladaNode","./ColladaScene","./ColladaUtils","../../util/Logger"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(e,r){if(!e)throw new t(l.logMessage(l.LEVEL_SEVERE,"ColladaLoader","constructor","missingPosition"));this.position=e,this.dirPath="/",this.init(r)};return u.prototype.init=function(t){t&&(this.dirPath=t.dirPath||"/"),this.scene={type:"SceneTree",dirPath:this.dirPath,images:{},metadata:{},materials:{},meshes:{},root:{children:[]}},this.xmlDoc=null},u.prototype.load=function(t,e){t.indexOf("://")===-1&&(t=this.dirPath+t),s.fetchFile(t,function(t){if(t)try{r=this.parse(t)}catch(t){r=null,l.log(l.LEVEL_SEVERE,"error parsing collada file: "+t)}else var r=null;e(r)}.bind(this))},u.prototype.parse=function(t){this.init();var r=new DOMParser;this.xmlDoc=r.parseFromString(t,"text/xml");var i=this.xmlDoc.querySelectorAll("library_nodes node"),n=this.xmlDoc.querySelectorAll("library_effects effect");return this.scene.metadata=new e(this.xmlDoc).parse(),this.parseLib("visual_scene",i),this.parseLib("library_geometries"),this.parseLib("library_materials",n),this.parseLib("library_images"),this.xmlDoc=null,new a(this.position,this.scene)},u.prototype.parseLib=function(t,e){var a=this.xmlDoc.getElementsByTagName(t),l=[];a&&a.length&&(l=a[0].childNodes);for(var u=0;u<l.length;u++){var c=l[u];if(1===c.nodeType)switch(c.nodeName){case"node":var h=(new o).parse(c,e);h&&this.scene.root.children.push(h);break;case"geometry":var f=c.getAttribute("id"),d=c.querySelector("mesh"),p=new n(f).parse(d);p&&(this.scene.meshes[f]=p);break;case"material":var g=c.getAttribute("id"),m=c.querySelector("instance_effect"),y=m.getAttribute("url").substr(1),v=s.querySelectorById(e,y),b=new i(g).parse(v);b&&(this.scene.materials[g]=b);break;case"image":var E=c.getAttribute("id"),w=c.getAttribute("name"),_=new r(E,w).parse(c);_&&(this.scene.images[E]=_)}}},u}),define("worldwind/util/ImageSource",["../error/ArgumentError","../util/Color","../util/Logger"],function(t,e,r){"use strict";var i=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"ImageSource","constructor","missingImage"));this.image=e,this.key="ImageSource "+ ++i.keyPool};return i.keyPool=0,i}),define("worldwind/shapes/ScreenImage",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/ImageSource","../util/Logger","../geom/Matrix","../util/Offset","../pick/PickedObject","../render/Renderable","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(e,i){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenImage","constructor","missingOffset"));if(!i)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenImage","constructor","missingImage"));l.call(this),this.screenOffset=e,this._imageSource=i,this.imageColor=r.WHITE,this.imageOffset=new a(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),this.imageScale=1,this.imageRotation=0,this.imageTilt=0,this.enabled=!0,this.opacity=1,this.pickDelegate=null,this.activeTexture=null,this.imageTransform=o.fromIdentity(),this.texCoordMatrix=o.fromIdentity(),this.imageBounds=null,this.layer=null};return h.matrix=o.fromIdentity(),h.prototype=Object.create(l.prototype),Object.defineProperties(h.prototype,{imageSource:{get:function(){return this._imageSource},set:function(e){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenImage","imageSource","missingImage"));this._imageSource=e,this.imageSourceWasUpdated=!0}}}),h.prototype.render=function(t){if(this.enabled&&t.accumulateOrderedRenderables){var e=null;this.lastFrameTime!==t.timestamp&&(e=this.makeOrderedRenderable(t)),e&&e.isVisible(t)&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e))}},h.prototype.renderOrdered=function(t){if(this.drawOrderedScreenImage(t),t.pickingMode){var e=new s(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);t.resolvePick(e)}},h.prototype.makeOrderedRenderable=function(t){var e,r,i,n,o,a,s;return this.activeTexture=this.getActiveTexture(t),this.activeTexture&&!this.imageSourceWasUpdated||(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this._imageSource),this.activeTexture)?(this.eyeDistance=0,e=this.activeTexture.imageWidth,r=this.activeTexture.imageHeight,i=this.imageScale,a=this.imageOffset.offsetForSize(e,r),n=t.navigatorState.viewport.width,o=t.navigatorState.viewport.height,s=this.screenOffset.offsetForSize(n,o),this.imageTransform.setTranslation(s[0]-a[0]*i,s[1]-a[1]*i,0),this.imageTransform.setScale(e*i,r*i,1),this.imageBounds=c.boundingRectForUnitQuad(this.imageTransform),this):null},h.prototype.getActiveTexture=function(t){return t.gpuResourceCache.resourceForKey(this._imageSource)},h.prototype.isVisible=function(t){return t.pickingMode?t.pickRectangle&&this.imageBounds.intersects(t.pickRectangle):this.imageBounds.intersects(t.navigatorState.viewport)},h.prototype.drawOrderedScreenImage=function(t){this.beginDrawing(t);try{this.doDrawOrderedScreenImage(t)}finally{this.endDrawing(t)}},h.prototype.beginDrawing=function(t){var r,i=t.currentGlContext;t.findAndBindProgram(e),r=t.currentProgram,i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer()),i.vertexAttribPointer(r.vertexTexCoordLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.vertexPointLocation),i.enableVertexAttribArray(r.vertexTexCoordLocation),r.loadTextureUnit(i,i.TEXTURE0),r.loadModulateColor(i,t.pickingMode),i.disable(i.DEPTH_TEST)},h.prototype.endDrawing=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.enable(e.DEPTH_TEST)},h.prototype.doDrawOrderedScreenImage=function(t){var e=t.currentGlContext,r=t.currentProgram;e.bindBuffer(e.ARRAY_BUFFER,t.unitQuadBuffer3()),e.vertexAttribPointer(r.vertexPointLocation,3,e.FLOAT,!1,0,0),h.matrix.copy(t.screenProjection),h.matrix.multiplyMatrix(this.imageTransform),h.matrix.multiplyByTranslation(.5,.5,.5),h.matrix.multiplyByRotation(1,0,0,this.imageTilt),h.matrix.multiplyByRotation(0,0,1,this.imageRotation),h.matrix.multiplyByTranslation(-.5,-.5,0),r.loadModelviewProjection(e,h.matrix),r.loadTextureEnabled(e,!0),t.pickingMode?(this.pickColor=t.uniquePickColor(),r.loadColor(e,this.pickColor)):(r.loadColor(e,this.imageColor),r.loadOpacity(e,this.opacity*this.layer.opacity)),this.texCoordMatrix.setToIdentity(),this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture),r.loadTextureMatrix(e,this.texCoordMatrix),this.activeTexture.bind(t)&&e.drawArrays(e.TRIANGLE_STRIP,0,4)},h}),define("worldwind/shapes/Compass",["../error/ArgumentError","../util/Logger","../util/Offset","../shapes/ScreenImage"],function(t,e,r,i){"use strict";var n=function(t,e){var n=t?t:new r(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,1),o=e?e:WorldWind.configuration.baseUrl+"images/notched-compass.png";i.call(this,n,o),t||(this.imageOffset=new r(WorldWind.OFFSET_FRACTION,1.1,WorldWind.OFFSET_FRACTION,1.1)),this.size=.15};return n.prototype=Object.create(i.prototype),n.prototype.render=function(t){this.imageRotation=t.navigatorState.heading,this.imageTilt=t.navigatorState.tilt;var e=this.getActiveTexture(t);e&&(this.imageScale=this.size*t.currentGlContext.drawingBufferWidth/e.imageWidth),i.prototype.render.call(this,t)},n}),define("worldwind/layer/CompassLayer",["../shapes/Compass","../layer/RenderableLayer"],function(t,e){"use strict";var r=function(){e.call(this,"Compass"),this._compass=new t(null,null),this.addRenderable(this._compass)};return r.prototype=Object.create(e.prototype),Object.defineProperties(r.prototype,{compass:{get:function(){return this._compass},set:function(e){e&&e instanceof t&&(this.removeAllRenderables(),this.addRenderable(e),this._compass=e)}}}),r}),define("worldwind/shapes/Text",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Logger","../geom/Matrix","../pick/PickedObject","../render/Renderable","../shapes/TextAttributes","../error/UnsupportedOperationError","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f){"use strict";var d=function(e){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"Text","constructor","missingText"));s.call(this),this.attributes=new l(null),this.highlightAttributes=null,this.highlighted=!1,this.enabled=!0,this.text=e,this.altitudeMode=WorldWind.ABSOLUTE,this.pickDelegate=null,this.alwaysOnTop=!1,this.targetVisibility=1,this.currentVisibility=1,this.declutterGroup=0,this.markerImageSource=WorldWind.configuration.baseUrl+"images/white-dot.png",this.markerImageScale=.1,this.activeAttributes=null,this.activeTexture=null,this.imageTransform=o.fromIdentity(),this.texCoordMatrix=o.fromIdentity(),this.imageBounds=null,this.layer=null,this.depthOffset=-.003,this.screenPoint=new h(0,0,0)};return d.matrix=o.fromIdentity(),d.glPickPoint=new h(0,0,0),d.prototype=Object.create(s.prototype),d.prototype.copy=function(t){return this.text=t.text,this.attributes=t.attributes,this.highlightAttributes=t.highlightAttributes,this.highlighted=t.highlighted,this.enabled=t.enabled,this.altitudeMode=t.altitudeMode,this.pickDelegate=t.pickDelegate,this.alwaysOnTop=t.alwaysOnTop,this.depthOffset=t.depthOffset,this.declutterGroup=t.declutterGroup,this.targetVisibility=t.targetVisibility,this.currentVisibility=t.currentVisibility,this},Object.defineProperties(d.prototype,{screenBounds:{get:function(){return this.imageBounds}}}),d.prototype.render=function(t){if(this.enabled&&this.text&&0!==this.text.length&&t.accumulateOrderedRenderables){var e;if(this.lastFrameTime!=t.timestamp)e=this.makeOrderedRenderable(t);else{var r=this.clone();e=r.makeOrderedRenderable(t)}e&&e.isVisible(t)&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e))}},d.prototype.renderOrdered=function(t){if((0!==this.currentVisibility||0!==this.targetVisibility||this.markerImageSource)&&(this.drawOrderedText(t),t.pickingMode)){var e=new a(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,this.position,this.layer,!1);t.resolvePick(e)}},d.prototype.makeOrderedRenderable=function(t){var e,r,i,n;if(this.determineActiveAttributes(t),!this.activeAttributes)return null;if(!this.computeScreenPointAndEyeDistance(t))return null;var o=this.activeAttributes.font,a=this.text+o.toString();return this.activeTexture=t.gpuResourceCache.resourceForKey(a),this.activeTexture||(this.activeTexture=t.textSupport.createTexture(t,this.text,o,!0),t.gpuResourceCache.putResource(a,this.activeTexture,this.activeTexture.size)),e=this.activeTexture.imageWidth,r=this.activeTexture.imageHeight,i=this.activeAttributes.scale,n=this.activeAttributes.offset.offsetForSize(e,r),this.imageTransform.setTranslation(this.screenPoint[0]-n[0]*i,this.screenPoint[1]-n[1]*i,this.screenPoint[2]),this.imageTransform.setScale(e*i,r*i,1),this.imageBounds=f.boundingRectForUnitQuad(this.imageTransform),this},d.prototype.computeScreenPointAndEyeDistance=function(t){throw new u(n.logMessage(n.LEVEL_SEVERE,"Renderable","render","abstractInvocation"))},d.prototype.determineActiveAttributes=function(t){this.highlighted&&this.highlightAttributes?this.activeAttributes=this.highlightAttributes:this.activeAttributes=this.attributes},d.prototype.isVisible=function(t){return t.pickingMode?t.pickRectangle&&this.imageBounds.intersects(t.pickRectangle):this.imageBounds.intersects(t.navigatorState.viewport)},d.prototype.drawOrderedText=function(t){this.beginDrawing(t);try{this.doDrawOrderedText(t),!t.pickingMode}finally{this.endDrawing(t)}},d.prototype.drawBatchOrderedText=function(t){for(var e;(e=t.peekOrderedRenderable())&&e instanceof d;){t.popOrderedRenderable();try{e.doDrawOrderedText(t)}catch(t){n.logMessage(n.LEVEL_WARNING,"Text","drawBatchOrderedText","Error occurred while rendering text using batching: "+t.message)}}},d.prototype.beginDrawing=function(t){var r,i=t.currentGlContext;t.findAndBindProgram(e),r=t.currentProgram,i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer3()),i.vertexAttribPointer(r.vertexPointLocation,3,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer()),i.vertexAttribPointer(r.vertexTexCoordLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.vertexPointLocation),i.enableVertexAttribArray(r.vertexTexCoordLocation),r.loadTextureUnit(i,i.TEXTURE0),t.pickingMode&&r.loadTextureEnabled(i,!1),r.loadModulateColor(i,!1),i.depthMask(!1),d.currentTexture=null},d.prototype.endDrawing=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.depthMask(!0),d.currentTexture=null},d.prototype.doDrawOrderedText=function(t){var e,r=t.currentGlContext,i=t.currentProgram;if(t.pickingMode&&(this.pickColor=t.uniquePickColor()),!t.pickingMode&&this.currentVisibility!=this.targetVisibility){var n=(t.timestamp-t.previousRedrawTimestamp)/t.fadeTime;this.currentVisibility<this.targetVisibility?this.currentVisibility=Math.min(1,this.currentVisibility+n):this.currentVisibility=Math.max(0,this.currentVisibility-n),t.redrawRequested=!0}if(this.currentVisibility>0&&(d.matrix.copy(t.screenProjection),d.matrix.multiplyMatrix(this.imageTransform),i.loadModelviewProjection(r,d.matrix),t.pickingMode?(i.loadColor(r,this.pickColor),i.loadTextureEnabled(r,!1)):(i.loadColor(r,this.activeAttributes.color),i.loadOpacity(r,this.layer.opacity*this.currentVisibility),this.texCoordMatrix.setToIdentity(),this.activeTexture&&this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture),i.loadTextureMatrix(r,this.texCoordMatrix),this.activeTexture&&this.activeTexture!=d.currentTexture&&(e=this.activeTexture.bind(t),i.loadTextureEnabled(r,e),d.currentTexture=this.activeTexture)),this.activeAttributes.depthTest||r.disable(r.DEPTH_TEST,!1),r.drawArrays(r.TRIANGLE_STRIP,0,4),this.activeAttributes.depthTest||r.disable(r.DEPTH_TEST,!0)),this.currentVisibility<1&&this.markerImageSource){var a=t.gpuResourceCache.resourceForKey(this.markerImageSource);if(!a)return void t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.markerImageSource);var s=this.markerImageScale,l=o.fromIdentity();if(l.setTranslation(this.screenPoint[0]-s*a.imageWidth/2,this.screenPoint[1]-s*a.imageWidth/2,this.screenPoint[2]),l.setScale(a.imageWidth*s,a.imageHeight*s,1),d.matrix.copy(t.screenProjection),d.matrix.multiplyMatrix(l),i.loadModelviewProjection(r,d.matrix),t.pickingMode)i.loadColor(r,this.pickColor),i.loadTextureEnabled(r,!1);else{i.loadColor(r,this.activeAttributes.color),i.loadOpacity(r,this.layer.opacity*(1-this.currentVisibility));var u=o.fromIdentity();u.multiplyByTextureTransform(a),i.loadTextureMatrix(r,u),a!=d.currentTexture&&(e=a.bind(t),i.loadTextureEnabled(r,e),d.currentTexture=a)}this.activeAttributes.depthTest||r.disable(r.DEPTH_TEST,!1),r.drawArrays(r.TRIANGLE_STRIP,0,4),this.activeAttributes.depthTest||r.enable(r.DEPTH_TEST,!0)}},d}),define("worldwind/shapes/ScreenText",["../error/ArgumentError","../util/Logger","../util/Offset","../shapes/Text"],function(t,e,r,i){"use strict";var n=function(r,n){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"Text","constructor","missingOffset"));i.call(this,n),this.screenOffset=r,this.altitudeMode=null};return n.prototype=Object.create(i.prototype),n.prototype.render=function(t){this.lastFrameTime!=t.timestamp&&i.prototype.render.call(this,t)},n.prototype.computeScreenPointAndEyeDistance=function(t){var e=t.currentGlContext,r=this.screenOffset.offsetForSize(e.drawingBufferWidth,e.drawingBufferHeight);return this.screenPoint[0]=r[0],this.screenPoint[1]=r[1],this.screenPoint[2]=0,this.eyeDistance=0,!0},n}),define("worldwind/layer/CoordinatesDisplayLayer",["../error/ArgumentError","../util/Color","../util/Font","../layer/Layer","../util/Logger","../util/Offset","../geom/Position","../shapes/ScreenImage","../shapes/ScreenText","../shapes/TextAttributes","../geom/Vec2"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(r){function a(t){d.handleUIEvent(t)}function c(t,e){d.handleRedraw(e)}if(!r)throw new t(n.logMessage(n.LEVEL_SEVERE,"ViewControlsLayer","constructor","missingWorldWindow"));i.call(this,"Coordinates"),this.wwd=r,this.pickEnabled=!1,this.eventType=null,this.clientX=null,this.clientY=null,this.terrainPosition=null,this.latText=new l(new o(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.latText.attributes=new u(null),this.latText.attributes.color=e.YELLOW,this.lonText=new l(new o(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.lonText.attributes=new u(null),this.lonText.attributes.color=e.YELLOW,this.elevText=new l(new o(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.elevText.attributes=new u(null),this.elevText.attributes.color=e.YELLOW,this.eyeText=new l(new o(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.eyeText.attributes=new u(null),this.eyeText.attributes.color=e.YELLOW;var h=new o(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),f=WorldWind.configuration.baseUrl+"images/crosshair.png";this.crosshairImage=new s(h,f);var d=this;window.PointerEvent?(r.addEventListener("pointerdown",a),r.addEventListener("pointermove",a),r.addEventListener("pointerleave",a)):(r.addEventListener("mousedown",a),r.addEventListener("mousemove",a),r.addEventListener("mouseleave",a),r.addEventListener("touchstart",a),r.addEventListener("touchmove",a)),this.wwd.redrawCallbacks.push(c)};return h.prototype=Object.create(i.prototype),h.prototype.doRender=function(t){var e,r,i,n,a,s=this.terrainPosition,l=t.eyePosition,u=t.currentGlContext.canvas.clientWidth;u>650?(e=u/2-50,r=5,i=WorldWind.OFFSET_PIXELS,n=0):u>400?(e=60,r=5,i=WorldWind.OFFSET_INSET_PIXELS,n=1):(e=60,r=5,i=WorldWind.OFFSET_INSET_PIXELS,n=1,a=!0),this.latText.text=s?this.formatLatitude(s.latitude):null,this.latText.screenOffset=new o(WorldWind.OFFSET_PIXELS,e,i,r),this.latText.attributes.offset=new o(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,n),this.latText.render(t),e+=70,this.lonText.text=s?this.formatLongitude(s.longitude):null,this.lonText.screenOffset=new o(WorldWind.OFFSET_PIXELS,e,i,r),this.lonText.attributes.offset=new o(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,n),this.lonText.render(t),t.globe.is2D()||(e+=70,this.elevText.text=s?this.formatAltitude(s.altitude,"m"):null,this.elevText.screenOffset=new o(WorldWind.OFFSET_PIXELS,e,i,r),this.elevText.attributes.offset=new o(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,n),this.elevText.render(t)),a||(e+=40,this.eyeText.text="Eye  "+this.formatAltitude(l.altitude,l.altitude<1e3?"m":"km"),this.eyeText.screenOffset=new o(WorldWind.OFFSET_PIXELS,e,i,r),this.eyeText.attributes.offset=new o(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,n),this.eyeText.render(t)),"touch"==this.eventType&&this.crosshairImage.render(t),this.inCurrentFrame=!0},h.prototype.handleUIEvent=function(t){t.type.indexOf("pointer")!=-1?this.eventType=t.pointerType:t.type.indexOf("mouse")!=-1?this.eventType="mouse":t.type.indexOf("touch")!=-1&&(this.eventType="touch"),t.type.indexOf("leave")!=-1?(this.clientX=null,this.clientY=null):(this.clientX=t.clientX,this.clientY=t.clientY),this.wwd.redraw()},h.prototype.handleRedraw=function(t){if(t==WorldWind.BEFORE_REDRAW){var e,r;("mouse"==this.eventType||"pen"==this.eventType)&&this.clientX&&this.clientY?(e=this.wwd.canvasCoordinates(this.clientX,this.clientY),e[0]>=0&&e[0]<this.wwd.canvas.width&&e[1]>=0&&e[1]<this.wwd.canvas.height&&(r=this.wwd.pickTerrain(e).terrainObject())):"touch"==this.eventType&&(e=new c(this.wwd.canvas.width/2,this.wwd.canvas.height/2),r=this.wwd.pickTerrain(e).terrainObject()),this.terrainPosition=r?r.position:null}},h.prototype.formatLatitude=function(t){var e=t<0?"°S":"°N";return Math.abs(t).toFixed(2)+e},h.prototype.formatLongitude=function(t){var e=t<0?"°W":"°E";return Math.abs(t).toFixed(2)+e},h.prototype.formatAltitude=function(t,e){return"km"===e&&(t/=1e3),t.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")+" "+e},h}),define("worldwind/util/Date",[],function(){"use strict";var t=function(t){t?this._date=new Date(t):this._date=new Date};return t.prototype=Object.create(Date.prototype),t.prototype.isAfter=function(t){return this.compare(t)==-1},t.prototype.isBefore=function(t){return 1==this.compare(t)},t.prototype.valueOf=function(){return this._date.valueOf()},t.prototype.getTime=function(){return this._date.getTime()},t.prototype.compare=function(t){var e=this._date.valueOf(),r=t.valueOf();return e>r?-1:e<r?1:0},t}),define("worldwind/layer/DigitalGlobeTiledImageLayer",["../geom/Angle","../error/ArgumentError","../util/Color","../geom/Location","../util/Logger","../geom/Sector","../layer/MercatorTiledImageLayer"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,s){if(!r)throw new e(n.logMessage(n.LEVEL_SEVERE,"DigitalGlobeTiledImageLayer","constructor","The map ID is null or undefined."));if(!s)throw new e(n.logMessage(n.LEVEL_SEVERE,"DigitalGlobeTiledImageLayer","constructor","The access token is null or undefined."));this.imageSize=256,t=t||"Digital Globe",a.call(this,new o(-85.05,85.05,-180,180),new i(85.05,180),19,"image/jpeg",t,this.imageSize,this.imageSize),this.mapId=r,this.accessToken=s,this.displayName=t,this.pickEnabled=!1,this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d"),this.requestMetadata();var l=this;this.urlBuilder={urlForTile:function(t,e){return l.metadataRetrievalInProcess?null:l.urlTemplate.replace("{z}",t.level.levelNumber+1).replace("{x}",t.column).replace("{y}",t.row)}}};return s.prototype=Object.create(a.prototype),s.prototype.requestMetadata=function(){if(!this.metadataRetrievalInProcess){this.metadataRetrievalInProcess=!0;var t="https://api.mapbox.com/v4/"+this.mapId+".json?secure&access_token="+this.accessToken,e=new XMLHttpRequest,r=this;e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){
var t=JSON.parse(e.responseText);r.urlTemplate=t.tiles[0];var i=document.createEvent("Event");i.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(i),r.metadataRetrievalInProcess=!1}},e.open("GET",t,!0),e.send()}},s.prototype.doRender=function(t){a.prototype.doRender.call(this,t),this.inCurrentFrame&&t.screenCreditController.addStringCredit("© Digital Globe",r.DARK_GRAY)},s.prototype.createTopLevelTiles=function(t){this.topLevelTiles=[],this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))},s.prototype.mapSizeForLevel=function(t){return 256<<t+1},s}),define("worldwind/util/FrameStatistics",[],function(){"use strict";var t=function(){this.frameCount=0,this.frameTimeCumulative=0,this.frameTimeBase=0,this.frameTimeExtremes=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],this.frameTime=0,this.tessellationTime=0,this.layerRenderingTime=0,this.orderedRenderingTime=0,this.terrainTileCount=0,this.imageTileCount=0,this.renderedTileCount=0,this.tileUpdateCount=0,this.textureLoadCount=0,this.vboLoadCount=0,this.frameTimeAverage=0,this.frameRateAverage=0,this.frameTimeMin=0,this.frameTimeMax=0};return t.prototype.beginFrame=function(){this.frameTime=Date.now(),this.tessellationTime=0,this.layerRenderingTime=0,this.orderedRenderingTime=0,this.terrainTileCount=0,this.imageTileCount=0,this.renderedTileCount=0,this.tileUpdateCount=0,this.textureLoadCount=0,this.vboLoadCount=0,++this.frameCount},t.prototype.endFrame=function(){var t=Date.now();this.frameTime=t-this.frameTime,this.frameTimeCumulative+=this.frameTime,this.frameTimeExtremes[0]=Math.min(this.frameTimeExtremes[0],this.frameTime),this.frameTimeExtremes[1]=Math.max(this.frameTimeExtremes[1],this.frameTime),t-this.frameTimeBase>2e3&&(this.frameTimeAverage=this.frameTimeCumulative/this.frameCount,this.frameRateAverage=1e3*this.frameCount/(t-this.frameTimeBase),this.frameTimeMin=this.frameTimeExtremes[0],this.frameTimeMax=this.frameTimeExtremes[1],this.frameCount=0,this.frameTimeCumulative=0,this.frameTimeBase=t,this.frameTimeExtremes=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY])},t.prototype.incrementRenderedTileCount=function(t){this.renderedTileCount+=t},t.prototype.setTerrainTileCount=function(t){this.terrainTileCount=t},t.prototype.incrementImageTileCount=function(t){this.imageTileCount=t},t.prototype.incrementTileUpdateCount=function(t){this.tileUpdateCount+=t},t.prototype.incrementTextureLoadCount=function(t){this.textureLoadCount+=t},t.prototype.incrementVboLoadCount=function(t){this.vboLoadCount+=t},t}),define("worldwind/render/FramebufferTexture",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(t,e){"use strict";var r=function(r,i,n,o){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"FramebufferTexture","constructor","missingGlContext"));if(i<0||n<0)throw new t(e.logMessage(e.LEVEL_SEVERE,"FramebufferTexture","constructor","The framebuffer width or height is less than zero."));this.width=i,this.height=n,this.depth=o,this.size=i*n*4+(o?i*n*2:0),this.framebufferId=r.createFramebuffer(),r.bindFramebuffer(r.FRAMEBUFFER,this.framebufferId),this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i,n,0,r.RGBA,r.UNSIGNED_BYTE,null),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.texture,0),this.depthBuffer=null,o&&(this.depthBuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,this.depthBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,i,n),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this.depthBuffer));var a=r.checkFramebufferStatus(r.FRAMEBUFFER);a!=r.FRAMEBUFFER_COMPLETE&&(e.logMessage(e.LEVEL_WARNING,"FramebufferTexture","constructor","Error creating framebuffer: "+a),this.framebufferId=null,this.texture=null,this.depthBuffer=null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindTexture(r.TEXTURE_2D,null)};return r.prototype.bind=function(t){return this.texture&&t.currentGlContext.bindTexture(gl.TEXTURE_2D,this.texture),!!this.texture},r}),define("worldwind/render/FramebufferTile",["../error/ArgumentError","../render/FramebufferTexture","../util/Logger","../geom/Matrix","../geom/Rectangle","../render/TextureTile"],function(t,e,r,i,n,o){"use strict";var a=function(e,n,a,s,l){if(!l||l.length<1)throw new t(r.logMessage(r.LEVEL_SEVERE,"FramebufferTile","constructor","The specified cache name is null, undefined or zero length."));o.call(this,e,n,a,s),this.gpuCacheKey=l,this.textureTransform=i.fromIdentity().setToUnitYFlip(),this.mustClear=!0};return a.prototype=Object.create(o.prototype),a.prototype.clearFramebuffer=function(t){this.mustClear=!0},a.prototype.bindFramebuffer=function(t){var e=t.gpuResourceCache.resourceForKey(this.gpuCacheKey);return e||(e=this.createFramebuffer(t)),t.bindFramebuffer(e),this.mustClear&&(this.doClearFramebuffer(t),this.mustClear=!1),!0},a.prototype.createFramebuffer=function(t){var r=new e(t.currentGlContext,this.tileWidth,this.tileHeight,!1);return t.gpuResourceCache.putResource(this.gpuCacheKey,r,r.size),r},a.prototype.doClearFramebuffer=function(t){var e=t.currentGlContext;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},a.prototype.applyInternalTransform=function(t,e){e.multiplyMatrix(this.textureTransform)},a}),define("worldwind/render/FramebufferTileController",["../error/ArgumentError","../render/FramebufferTile","../util/LevelSet","../geom/Location","../util/Logger","../cache/MemoryCache","../geom/Sector","../util/Tile"],function(t,e,r,i,n,o,a,s){"use strict";var l=function(){this.tileWidth=256,this.tileHeight=256,this.detailControl=1.75,this.levels=new r(a.FULL_SPHERE,new i(45,45),16,this.tileWidth,this.tileHeight),this.topLevelTiles=[],this.currentTiles=[],this.currentTimestamp=null,this.currentGlobeStateKey=null,this.tileCache=new o(5e5,4e5),this.key="FramebufferTileController "+ ++l.keyPool};return l.keyPool=0,l.prototype.selectTiles=function(e,r){if(!r)throw new t(n.logMessage(n.LEVEL_SEVERE,"FramebufferTileController","selectTiles","missingSector"));this.assembleTiles(e);for(var i=[],o=0,a=this.currentTiles.length;o<a;o++){var s=this.currentTiles[o];s.sector.overlaps(r)&&(s.selected=!0,i.push(s))}return i},l.prototype.render=function(t){if(0!=this.currentTiles.length){for(var e=[],r=0,i=this.currentTiles.length;r<i;r++){var n=this.currentTiles[r];n.selected&&e.push(n)}t.surfaceTileRenderer.renderTiles(t,e,1);var o=t.currentGlContext,a=t.currentFramebuffer;try{for(o.clearColor(0,0,0,0),r=0,i=e.length;r<i;r++)n=e[r],n.selected=!1,n.bindFramebuffer(t),o.clear(o.COLOR_BUFFER_BIT)}finally{t.bindFramebuffer(a)}}},l.prototype.assembleTiles=function(t){var e=t.timestamp,r=t.globeStateKey;this.currentTimestamp==e&&this.currentGlobeStateKey==r||(this.doAssembleTiles(t),this.currentTimestamp=e,this.currentGlobeStateKey=r)},l.prototype.doAssembleTiles=function(t){if(this.currentTiles=[],t.terrain){0==this.topLevelTiles.length&&this.createTopLevelTiles();for(var e=0,r=this.topLevelTiles.length;e<r;e++){var i=this.topLevelTiles[e];i.update(t),this.isTileVisible(t,i)&&this.addTileOrDescendants(t,i)}}},l.prototype.createTile=function(t,r,i,n){var o=this.key+" "+r.levelNumber+"."+i+"."+n;return new e(t,r,i,n,o)},l.prototype.createTopLevelTiles=function(){s.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)},l.prototype.addTileOrDescendants=function(t,e){if(this.tileMeetsRenderingCriteria(t,e))return void this.addTile(e);for(var r=e.subdivideToCache(e.level.nextLevel(),this,this.tileCache),i=0,n=r.length;i<n;i++){var o=r[i];o.update(t),this.isTileVisible(t,o)&&this.addTileOrDescendants(t,o)}},l.prototype.addTile=function(t){this.currentTiles.push(t)},l.prototype.isTileVisible=function(t,e){return!(t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits))&&(t.pickingMode?e.extent.intersectsFrustum(t.pickFrustum):e.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates))},l.prototype.tileMeetsRenderingCriteria=function(t,e){var r=this.detailControl;return(e.sector.minLatitude>=75||e.sector.maxLatitude<=-75)&&(r*=1.2),e.level.isLastLevel()||!e.mustSubdivide(t,r)},l}),define("worldwind/globe/ElevationImage",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(t,e,r){"use strict";var i=function(r,i,n,o){if(!r||r.length<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","constructor","The specified image path is null, undefined or zero length."));if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","constructor","missingSector"));this.sector=i,this.imagePath=r,this.imageWidth=n,this.imageHeight=o,this.size=this.imageWidth*this.imageHeight};return i.prototype.pixel=function(t,e){return t<0||t>=this.imageWidth?0:e<0||e>=this.imageHeight?0:(e=this.imageHeight-e-1,this.imageData[t+e*this.imageWidth])},i.prototype.elevationAtLocation=function(t,e){var i=this.sector.maxLatitude,n=this.sector.minLongitude,o=this.sector.deltaLatitude(),a=this.sector.deltaLongitude(),s=(this.imageWidth-1)*(e-n)/a,l=(this.imageHeight-1)*(i-t)/o,u=Math.floor(r.clamp(s,0,this.imageWidth-1)),c=Math.floor(r.clamp(u+1,0,this.imageWidth-1)),h=Math.floor(r.clamp(l,0,this.imageHeight-1)),f=Math.floor(r.clamp(h+1,0,this.imageHeight-1)),d=this.imageData,p=d[u+h*this.imageWidth],g=d[c+h*this.imageWidth],m=d[u+f*this.imageWidth],y=d[c+f*this.imageWidth],v=s-u,b=l-h;return(1-v)*(1-b)*p+v*(1-b)*g+(1-v)*b*m+v*b*y},i.prototype.elevationsForGrid=function(i,n,o,a){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","elevationsForSector","missingSector"));if(n<1||o<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","elevationsForSector","The specified number of sample points is less than 1."));if(!a)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationImage","elevationsForSector","missingResult"));var s,l,u,c,h=this.sector.minLatitude,f=this.sector.maxLatitude,d=this.sector.minLongitude,p=this.sector.maxLongitude,g=f-h,m=p-d,y=i.minLatitude,v=i.maxLatitude,b=i.minLongitude,E=i.maxLongitude,w=(v-y)/(n>1?n-1:1),_=(E-b)/(o>1?o-1:1),x=0,S=this.imageData;for(c=0,s=y;c<n;c+=1,s+=w)if(c===n-1&&(s=v),s>=h&&s<=f){var T=(this.imageHeight-1)*(f-s)/g,M=Math.floor(r.clamp(T,0,this.imageHeight-1)),L=Math.floor(r.clamp(M+1,0,this.imageHeight-1)),A=T-M;for(u=0,l=b;u<o;u+=1,l+=_){if(u===o-1&&(l=E),l>=d&&l<=p){var N=(this.imageWidth-1)*(l-d)/m,C=Math.floor(r.clamp(N,0,this.imageWidth-1)),R=Math.floor(r.clamp(C+1,0,this.imageWidth-1)),P=N-C,O=S[C+M*this.imageWidth],I=S[R+M*this.imageWidth],k=S[C+L*this.imageWidth],D=S[R+L*this.imageWidth];a[x]=(1-P)*(1-A)*O+P*(1-A)*I+(1-P)*A*k+P*A*D}x++}}else x+=o},i.prototype.minAndMaxElevationsForSector=function(t){var e=[];if(t)if(t.contains(this.sector))e[0]>this.minElevation&&(e[0]=this.minElevation),e[1]<this.maxElevation&&(e[1]=this.maxElevation);else{var i=this.sector.maxLatitude,n=this.sector.minLongitude,o=this.sector.deltaLatitude(),a=this.sector.deltaLongitude(),s=t.minLatitude,l=t.maxLatitude,u=t.minLongitude,c=t.maxLongitude,h=Math.floor((this.imageHeight-1)*(i-l)/o),f=Math.ceil((this.imageHeight-1)*(i-s)/o),d=Math.floor((this.imageWidth-1)*(u-n)/a),p=Math.ceil((this.imageWidth-1)*(c-n)/a);h=r.clamp(h,0,this.imageHeight-1),f=r.clamp(f,0,this.imageHeight-1),d=r.clamp(d,0,this.imageWidth-1),p=r.clamp(p,0,this.imageWidth-1);for(var g=this.imageData,m=Number.MAX_VALUE,y=-m,v=h;v<=f;v++)for(var b=d;b<=p;b++){var E=g[Math.floor(b+v*this.imageWidth)];m>E&&(m=E),y<E&&(y=E)}e[0]>m&&(e[0]=m),e[1]<y&&(e[1]=y)}else e[0]=this.minElevation,e[1]=this.maxElevation;return e},i.prototype.findMinAndMaxElevation=function(){if(this.imageData&&this.imageData.length>0){this.minElevation=Number.MAX_VALUE,this.maxElevation=-this.minElevation;for(var t=this.imageData,e=this.imageWidth*this.imageHeight,r=0;r<e;r++){var i=t[r];this.minElevation>i&&(this.minElevation=i),this.maxElevation<i&&(this.maxElevation=i)}}else this.minElevation=0,this.maxElevation=0},i}),define("worldwind/globe/ElevationTile",["../error/ArgumentError","../util/Logger","../util/Tile"],function(t,e,r){"use strict";var i=function(i,n,o,a,s,l){if(!s||s.length<1)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationTile","constructor","The specified image path is null, undefined or zero length."));if(!l)throw new t(e.logMessage(e.LEVEL_SEVERE,"ElevationTile","constructor","The specified cache is null or undefined."));r.call(this,i,n,o,a),this.imagePath=s,this.memoryCache=l};return i.prototype=Object.create(r.prototype),i.prototype.size=function(){return r.prototype.size.call(this)+this.imagePath.length+8},i.prototype.image=function(){return this.memoryCache.entryForKey(this.imagePath)},i}),define("worldwind/globe/ElevationModel",["../util/AbsentResourceList","../geom/Angle","../error/ArgumentError","../globe/ElevationImage","../globe/ElevationTile","../util/LevelSet","../util/Logger","../cache/MemoryCache","../geom/Sector","../util/Tile","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(e,i,n,u,c,f,d){if(!e)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","missingSector"));if(!i)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified level-zero delta is null or undefined."));if(!u)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified image format is null or undefined."));if(!c)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified cache path is null or undefined."));if(!n||n<1)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified number of levels is not greater than zero."));if(!f||!d||f<1||d<1)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified tile width or height is not greater than zero."));this.coverageSector=e,this.retrievalImageFormat=u,this.cachePath=c,this.displayName="Elevations",this.timestamp=Date.now(),this.minElevation=0,this.maxElevation=0,this.pixelIsPoint=!0,this.levels=new o(this.coverageSector,i,n,f,d),this.currentTiles=[],this.currentSector=new l(0,0,0,0),this.tileCache=new s(1e6,8e5),this.imageCache=new s(1e7,8e6),this.currentRetrievals=[],this.absentResourceList=new t(3,5e3),this.id=++h.idPool,this.stateKey="elevationModel "+this.id.toString()+" "};return h.idPool=0,h.prototype.minAndMaxElevationsForSector=function(t){if(!t)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","minAndMaxElevationsForSector","missingSector"));var i=this.levels.levelForTexelSize(t.deltaLatitude()*e.DEGREES_TO_RADIANS/64);if(this.assembleTiles(i,t,!1),0==this.currentTiles.length)return null;for(var n,o,s,l=Number.MAX_VALUE,u=-l,c=[],h=0,f=this.currentTiles.length;h<f;h++){if(n=this.currentTiles[h].image(),!n)return c[0]=this.minElevation,c[1]=this.maxElevation,c;o=n.minElevation,l>o&&(l=o),s=n.maxElevation,u<s&&(u=s)}return c[0]=l,c[1]=u,c},h.prototype.elevationAtLocation=function(t,e){return this.coverageSector.containsLocation(t,e)?this.pointElevationForLocation(t,e):0},h.prototype.elevationsForGrid=function(t,e,i,n,o){if(!t)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","elevationsForSector","missingSector"));if(!o)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","elevationsForSector","missingResult"));if(!e||!i||e<1||i<1)throw new r(a.logMessage(a.LEVEL_SEVERE,"ElevationModel","constructor","The specified number of latitudinal or longitudinal positions is less than one."));var s=this.levels.levelForTexelSize(n);return this.pixelIsPoint?this.pointElevationsForGrid(t,e,i,s,o):this.areaElevationsForGrid(t,e,i,s,o)},h.prototype.pointElevationForLocation=function(t,e){for(var r,i=this.levels.lastLevel(),n=i.tileDelta.latitude,o=i.tileDelta.longitude,a=u.computeRow(n,t),s=u.computeColumn(o,e),l=null,c=i.levelNumber;c>=0;c--){if(r=this.tileCache.entryForKey(c+"."+a+"."+s),r&&(l=r.image()))return l.elevationAtLocation(t,e);a=Math.floor(a/2),s=Math.floor(s/2)}return 0},h.prototype.pointElevationsForGrid=function(t,e,r,i,n){var o,a=0;if(this.assembleTiles(i,t,!0),0===this.currentTiles.length)return 0;this.currentTiles.sort(function(t,e){return t.level.levelNumber-e.level.levelNumber});for(var s=0,l=this.currentTiles.length;s<l;s++){var u=this.currentTiles[s],c=u.image();c?(c.elevationsForGrid(t,e,r,n),o=u.level.texelSize,a<o&&(a=o)):a=Number.MAX_VALUE}return a},h.prototype.areaElevationsForGrid=function(t,e,r,i,n){var o,a,s,l,u,c,h=t.minLatitude,f=t.maxLatitude,d=t.minLongitude,p=t.maxLongitude,g=t.deltaLatitude()/(e>1?e-1:1),m=t.deltaLongitude()/(r>1?r-1:1),y=0;for(u=0,o=h;u<e;u+=1,o+=g)for(u===e-1&&(o=f),c=0,a=d;c<r;c+=1,a+=m)c===r-1&&(a=p),this.coverageSector.containsLocation(o,a)&&(s=(a+180)/360,l=(o+90)/180,this.areaElevationForCoord(s,l,i.levelNumber,n,y)),y++;return i.texelSize},h.prototype.areaElevationForCoord=function(t,e,r,i,n){for(var o,a,s,l,u,h,f,d,p,g,m,y,v,b,E,w,_=new Float64Array(4),x=r;x>=0;x--)if(o=this.levels.level(x),a=Math.round(360*o.tileWidth/o.tileDelta.longitude),s=Math.round(180*o.tileHeight/o.tileDelta.latitude),l=1/(2*s),u=1-l,h=0,f=s-1,d=a*c.fract(t),p=s*c.clamp(e,l,u),g=c.mod(Math.floor(d-.5),a),m=c.mod(g+1,a),y=c.clamp(Math.floor(p-.5),h,f),v=c.clamp(y+1,h,f),b=c.fract(d-.5),E=c.fract(p-.5),w=x==r||0==x,this.lookupPixels(g,m,y,v,o,w,_))return void(i[n]=(1-b)*(1-E)*_[0]+b*(1-E)*_[1]+(1-b)*E*_[2]+b*E*_[3])},h.prototype.lookupPixels=function(t,e,r,i,n,o,a){var s,l,u,c,h=n.levelNumber,f=n.tileWidth,d=n.tileHeight,p=Math.floor(r/d),g=Math.floor(i/d),m=Math.floor(t/f),y=Math.floor(e/f);return p==g&&p==this.cachedRow&&m==y&&m==this.cachedCol?s=l=u=c=this.cachedImage:p==g&&m==y?(s=this.lookupImage(h,p,m,o),l=u=c=s,this.cachedRow=p,this.cachedCol=m,this.cachedImage=s):(s=this.lookupImage(h,p,m,o),l=this.lookupImage(h,p,y,o),u=this.lookupImage(h,g,m,o),c=this.lookupImage(h,g,y,o)),!!(s&&l&&u&&c)&&(a[0]=s.pixel(t%f,r%d),a[1]=l.pixel(e%f,r%d),a[2]=u.pixel(t%f,i%d),a[3]=c.pixel(e%f,i%d),!0)},h.prototype.lookupImage=function(t,e,r,i){var n=this.tileForLevel(t,e,r),o=n.image();return null==o&&i&&this.retrieveTileImage(n),o},h.prototype.createTile=function(t,e,r,i){var o=this.cachePath+"/"+e.levelNumber+"/"+r+"/"+r+"_"+i+".bil";return new n(t,e,r,i,o,this.imageCache)},h.prototype.assembleTiles=function(t,e,r){if(this.currentTiles=[],this.currentSector.copy(e),this.currentSector.intersection(this.coverageSector),!this.currentSector.isEmpty())for(var i=t.tileDelta.latitude,n=t.tileDelta.longitude,o=u.computeRow(i,this.currentSector.minLatitude),a=u.computeLastRow(i,this.currentSector.maxLatitude),s=u.computeColumn(n,this.currentSector.minLongitude),l=u.computeLastColumn(n,this.currentSector.maxLongitude),c=o;c<=a;c++)for(var h=s;h<=l;h++)this.addTileOrAncestor(t,c,h,r)},h.prototype.addTileOrAncestor=function(t,e,r,i){var n=this.tileForLevel(t.levelNumber,e,r);this.isTileImageInMemory(n)?this.addToCurrentTiles(n):(i&&this.retrieveTileImage(n),t.isFirstLevel()?this.currentTiles.push(n):this.addAncestor(t,e,r,i))},h.prototype.addAncestor=function(t,e,r,i){for(var n=null,o=Math.floor(e/2),a=Math.floor(r/2),s=t.levelNumber-1;s>=0;s--){if(n=this.tileForLevel(s,o,a),this.isTileImageInMemory(n))return void this.addToCurrentTiles(n);o=Math.floor(o/2),a=Math.floor(a/2)}this.addToCurrentTiles(n),i&&this.retrieveTileImage(n)},h.prototype.addToCurrentTiles=function(t){this.currentTiles.push(t)},h.prototype.tileForLevel=function(t,e,r){var i=t+"."+e+"."+r,n=this.tileCache.entryForKey(i);if(n)return n;var o=this.levels.level(t),a=u.computeSector(o,e,r);return n=this.createTile(a,o,e,r),this.tileCache.putEntry(i,n,n.size()),n},h.prototype.isTileImageInMemory=function(t){return this.imageCache.containsKey(t.imagePath)},h.prototype.resourceUrlForTile=function(t){return this.urlBuilder.urlForTile(t,this.retrievalImageFormat)},h.prototype.retrieveTileImage=function(t){if(this.currentRetrievals.indexOf(t.imagePath)<0){var e=this.resourceUrlForTile(t,this.retrievalImageFormat),r=new XMLHttpRequest,i=this;if(!e)return;r.open("GET",e,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){if(4===r.readyState){i.removeFromCurrentRetrievals(t.imagePath);var n=r.getResponseHeader("content-type");if(200===r.status)if(n===i.retrievalImageFormat||"text/plain"===n||"application/octet-stream"===n){a.log(a.LEVEL_INFO,"Elevations retrieval succeeded: "+e),i.loadElevationImage(t,r),i.absentResourceList.unmarkResourceAbsent(t.imagePath);var o=document.createEvent("Event");o.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(o)}else"text/xml"===n?(i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval failed ("+r.statusText+"): "+e+".\n "+String.fromCharCode.apply(null,new Uint8Array(r.response)))):(i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval failed: "+e+". Unexpected content type "+n));else i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval failed ("+r.statusText+"): "+e)}},r.onerror=function(){i.removeFromCurrentRetrievals(t.imagePath),i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval failed: "+e)},r.ontimeout=function(){i.removeFromCurrentRetrievals(t.imagePath),i.absentResourceList.markResourceAbsent(t.imagePath),a.log(a.LEVEL_WARNING,"Elevations retrieval timed out: "+e)},r.send(null),this.currentRetrievals.push(t.imagePath)}},h.prototype.removeFromCurrentRetrievals=function(t){var e=this.currentRetrievals.indexOf(t);e>-1&&this.currentRetrievals.splice(e,1)},h.prototype.loadElevationImage=function(t,e){var r=new i(t.imagePath,t.sector,t.tileWidth,t.tileHeight);"application/bil16"==this.retrievalImageFormat?(r.imageData=new Int16Array(e.response),r.size=2*r.imageData.length):"application/bil32"==this.retrievalImageFormat&&(r.imageData=new Float32Array(e.response),r.size=4*r.imageData.length),r.imageData&&(r.findMinAndMaxElevation(),this.imageCache.putEntry(t.imagePath,r,r.size),this.timestamp=Date.now())},h}),define("worldwind/projections/GeographicProjection",["../error/ArgumentError","../util/Logger","../geom/Sector","../error/UnsupportedOperationError"],function(t,e,r,i){"use strict";var n=function(t,e,r){this.displayName=t||"Geographic Projection",this.continuous=e,this.projectionLimits=r,this.is2D=!0};return n.prototype.geographicToCartesian=function(t,r,n,o,a,s){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","geographicToCartesian","abstractInvocation"))},n.prototype.geographicToCartesianGrid=function(t,r,n,o,a,s,l,u){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","geographicToCartesianGrid","abstractInvocation"))},n.prototype.cartesianToGeographic=function(t,r,n,o,a,s){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","cartesianToGeographic","abstractInvocation"))},n.prototype.northTangentAtLocation=function(r,i,n,o){if(!o)throw new t(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","northTangentAtLocation","missingResult"));return o[0]=0,o[1]=1,o[2]=0,o},n.prototype.northTangentAtPoint=function(r,i,n,o,a,s){if(!s)throw new t(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","northTangentAtPoint","missingResult"));return s[0]=0,s[1]=1,s[2]=0,s},n.prototype.surfaceNormalAtPoint=function(r,i,n,o,a){if(!a)throw new t(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","surfaceNormalAtPoint","missingResult"));return a[0]=0,a[1]=0,a[2]=1,a},n.prototype.geographicToCartesianTransform=function(t,r,n,o,a,s){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","geographicToCartesianTransform","abstractInvocation"))},n.prototype.cartesianToLocalTransform=function(t,r,n,o,a,s){throw new i(e.logMessage(e.LEVEL_SEVERE,"GeographicProjection","cartesianToLocalTransform","abstractInvocation"))},n}),define("worldwind/projections/ProjectionWgs84",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Position","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(){r.call(this,"WGS84",!1,null),this.is2D=!1,this.scratchPosition=new n(0,0,0)};return s.prototype=Object.create(r.prototype),Object.defineProperties(s.prototype,{stateKey:{get:function(){return"projection wgs84 "}}}),s.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesian","missingGlobe"));var u=Math.cos(n*t.DEGREES_TO_RADIANS),c=Math.sin(n*t.DEGREES_TO_RADIANS),h=Math.cos(o*t.DEGREES_TO_RADIANS),f=Math.sin(o*t.DEGREES_TO_RADIANS),d=r.equatorialRadius/Math.sqrt(1-r.eccentricitySquared*c*c);return l[0]=(a+d)*u*f,l[1]=(a+d*(1-r.eccentricitySquared))*c,l[2]=(a+d)*u*h,l},s.prototype.geographicToCartesianGrid=function(r,n,a,s,l,u,c,h){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesianGrid","missingGlobe"));var f,d,p,g,m,y,v,b,E=n.minLatitude*t.DEGREES_TO_RADIANS,w=n.maxLatitude*t.DEGREES_TO_RADIANS,_=n.minLongitude*t.DEGREES_TO_RADIANS,x=n.maxLongitude*t.DEGREES_TO_RADIANS,S=(w-E)/(a>1?a-1:1),T=(x-_)/(s>1?s-1:1),M=u?u:new o(0,0,0),L=0,A=0,N=new Float64Array(s),C=new Float64Array(s);for(d=0,g=_;d<s;d++,g+=T)d===s-1&&(g=x),N[d]=Math.cos(g),C[d]=Math.sin(g);for(f=0,p=E;f<a;f++,p+=S)for(f===a-1&&(p=w),v=Math.cos(p),b=Math.sin(p),m=r.equatorialRadius/Math.sqrt(1-r.eccentricitySquared*b*b),d=0;d<s;d++)y=l[L++],h[A++]=(m+y)*v*C[d]-M[0],h[A++]=(m*(1-r.eccentricitySquared)+y)*b-M[1],h[A++]=(m+y)*v*N[d]-M[2];return h},s.prototype.cartesianToGeographic=function(r,n,o,s,l,u){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","cartesianToGeographic","missingGlobe"));var c,h,f,d,p,g,m,y,v,b,E,w,_,x,S,T=s,M=n,L=o,A=T*T+M*M,N=Math.sqrt(A),C=r.equatorialRadius,R=1/(C*C),P=r.eccentricitySquared,O=P*P,I=A*R,k=L*L*(1-P)*R,D=(I+k-O)/6,V=8*D*D*D+O*I*k;return V>0||0!=k?(V>0?(d=Math.sqrt(V),p=Math.sqrt(O*I*k),V>10*P?(g=a.cbrt((d+p)*(d+p)),f=D+.5*g+2*D*D/g):f=D+.5*a.cbrt((d+p)*(d+p))+.5*a.cbrt((d-p)*(d-p))):(d=Math.sqrt(-V),p=Math.sqrt(-8*D*D*D),g=Math.sqrt(O*I*k),m=2*Math.atan2(g,d+p)/3,f=-4*D*Math.sin(m)*Math.cos(Math.PI/6+m)),y=Math.sqrt(f*f+O*k),v=P*(f+y-k)/(2*y),b=(f+y)/(Math.sqrt(v*v+f+y)+v),E=b*N/(b+P),w=Math.sqrt(E*E+L*L),c=(b+P-1)*w/b,h=2*Math.atan2(L,w+E)):(d=Math.sqrt(1-P),p=Math.sqrt(P-I),_=Math.sqrt(P),c=-C*d*p/_,h=p/(_*p+d*Math.sqrt(I))),S=Math.sqrt(2),x=(S-1)*M<N+T?2*Math.atan2(M,N+T):N+M<(S+1)*T?.5*-Math.PI+2*Math.atan2(T,N-M):.5*Math.PI-2*Math.atan2(T,N+M),u.latitude=t.RADIANS_TO_DEGREES*h,u.longitude=t.RADIANS_TO_DEGREES*x,u.altitude=c,u},s.prototype.northTangentAtLocation=function(e,r,i,n){var o=Math.cos(r*t.DEGREES_TO_RADIANS),a=Math.cos(i*t.DEGREES_TO_RADIANS),s=Math.sin(r*t.DEGREES_TO_RADIANS),l=Math.sin(i*t.DEGREES_TO_RADIANS);return n[0]=-s*l,n[1]=o,n[2]=-s*a,n},s.prototype.northTangentAtPoint=function(t,e,r,i,n,a){return this.cartesianToGeographic(t,e,r,i,o.ZERO,this.scratchPosition),this.northTangentAtLocation(t,this.scratchPosition.latitude,this.scratchPosition.longitude,a)},s.prototype.surfaceNormalAtPoint=function(t,r,n,o,a){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","surfaceNormalAtPoint","missingGlobe"));var s=t.equatorialRadius*t.equatorialRadius,l=t.polarRadius*t.polarRadius;return a[0]=r/s,a[1]=n/l,a[2]=o/s,a.normalize()},s.prototype.cartesianToLocalTransform=function(t,r,n,o,s,l){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","cartesianToLocalTransform","missing globe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","cartesianToLocalTransform","missing result"));var u=this.cartesianToGeographic(t,r,n,o,s,this.scratchPosition),c=a.toRadians(u.latitude),h=a.toRadians(u.longitude),f=Math.cos(c),d=Math.sin(c),p=Math.cos(h),g=Math.sin(h),m=t.equatorialRadius*t.equatorialRadius,y=t.polarRadius*t.polarRadius,v=f*g/m,b=(1-t.eccentricitySquared)*d/y,E=f*p/m,w=Math.sqrt(v*v+b*b+E*E);v/=w,b/=w,E/=w;var _=-d*g,x=f,S=-d*p;w=Math.sqrt(_*_+x*x+S*S),_/=w,x/=w,S/=w;var T=x*E-S*b,M=S*v-_*E,L=_*b-x*v;return _=b*L-E*M,x=E*T-v*L,S=v*M-b*T,l.set(T,_,v,r,M,x,b,n,L,S,E,o,0,0,0,1),l},s.prototype.geographicToCartesianTransform=function(t,r,n,o,s,l){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesianTransform","missing globe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesianTransform","missing result"));var u=a.toRadians(r),c=a.toRadians(n),h=Math.cos(u),f=Math.sin(u),d=Math.cos(c),p=Math.sin(c),g=t.eccentricitySquared,m=t.equatorialRadius/Math.sqrt(1-g*f*f),y=t.equatorialRadius*t.equatorialRadius,v=t.polarRadius*t.polarRadius,b=(m+o)*h*p,E=(m*(1-g)+o)*f,w=(m+o)*h*d,_=h*p/y,x=(1-g)*f/v,S=h*d/y,T=Math.sqrt(_*_+x*x+S*S);_/=T,x/=T,S/=T;var M=-f*p,L=h,A=-f*d;T=Math.sqrt(M*M+L*L+A*A),M/=T,L/=T,A/=T;var N=L*S-A*x,C=A*_-M*S,R=M*x-L*_;return M=x*R-S*C,L=S*N-_*R,A=_*C-x*N,l.set(N,M,_,b,C,L,x,E,R,A,S,w,0,0,0,1),l},s}),define("worldwind/globe/Terrain",["../error/ArgumentError","../util/Logger","../geom/Vec3"],function(t,e,r){"use strict";var i=function(t,e,r,i){this.globe=t,this.verticalExaggeration=i,this.sector=r.sector,this.tessellator=e,this.surfaceGeometry=r.tileArray,this.stateKey=t.stateKey+" ve "+i.toString()};return i.scratchPoint=new r(0,0,0),i.prototype.surfacePoint=function(r,n,o,a){if(!a)throw new t(e.logMessage(e.LEVEL_SEVERE,"Terrain","surfacePoint","missingResult"));for(var s=0,l=this.surfaceGeometry.length;s<l;s++)if(this.surfaceGeometry[s].sector.containsLocation(r,n)){if(this.surfaceGeometry[s].surfacePoint(r,n,a),o){var u=this.globe.surfaceNormalAtPoint(a[0],a[1],a[2],i.scratchPoint);a[0]+=u[0]*o,a[1]+=u[1]*o,a[2]+=u[2]*o}return a}var c=o+this.globe.elevationAtLocation(r,n)*this.verticalExaggeration;return this.globe.computePointFromPosition(r,n,c,a),a},i.prototype.surfacePointForMode=function(r,i,n,o,a){if(!a)throw new t(e.logMessage(e.LEVEL_SEVERE,"Terrain","surfacePointForMode","missingResult"));if(o||(o=WorldWind.ABSOLUTE),o===WorldWind.CLAMP_TO_GROUND)return this.surfacePoint(r,i,0,a);if(o===WorldWind.RELATIVE_TO_GROUND)return this.surfacePoint(r,i,n,a);var s=n*this.verticalExaggeration;return this.globe.computePointFromPosition(r,i,s,a),a},i.prototype.beginRendering=function(t){this.globe&&this.globe.tessellator&&this.globe.tessellator.beginRendering(t)},i.prototype.endRendering=function(t){this.globe&&this.globe.tessellator&&this.globe.tessellator.endRendering(t)},i.prototype.beginRenderingTile=function(r,i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Terrain","beginRenderingTile","missingTile"));this.globe&&this.globe.tessellator&&this.globe.tessellator.beginRenderingTile(r,i)},i.prototype.endRenderingTile=function(t,e){},i.prototype.renderTile=function(r,i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Terrain","renderTile","missingTile"));this.globe&&this.globe.tessellator&&this.globe.tessellator.renderTile(r,i)},i.prototype.pick=function(t){this.globe&&this.globe.tessellator&&this.globe.tessellator.pick(t,this.surfaceGeometry,this)},i}),define("worldwind/globe/TerrainTile",["../error/ArgumentError","../util/Logger","../geom/Matrix","../util/Tile"],function(t,e,r,i){"use strict";var n=function(t,e,n,o){i.call(this,t,e,n,o),this.transformationMatrix=r.fromIdentity(),this.points=null,this.pointsStateKey=null,this.pointsVboStateKey=null,this.neighborMap={},this.neighborMap[WorldWind.NORTH]=null,this.neighborMap[WorldWind.SOUTH]=null,this.neighborMap[WorldWind.EAST]=null,this.neighborMap[WorldWind.WEST]=null,this._stateKey=null,this._elevationTimestamp=null,this.scratchArray=[]};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{
stateKey:{get:function(){return this._stateKey||(this._stateKey=this.computeStateKey()),this._stateKey}}}),n.prototype.neighborLevel=function(t){return this.neighborMap[t]},n.prototype.setNeighborLevel=function(t,e){this.neighborMap[t]=e,this._stateKey=null},n.prototype.surfacePoint=function(r,i,n){if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"TerrainTile","surfacePoint","missingResult"));var o,a,s,l,u,c,h,f,d,p,g=this.sector,m=g.minLatitude,y=g.maxLatitude,v=g.minLongitude,b=g.maxLongitude,E=this.tileWidth,w=this.tileHeight;o=(i-v)/(b-v)*E,a=(r-m)/(y-m)*w,s=o<E?Math.floor(o):E-1,l=a<w?Math.floor(a):w-1,u=E+1,c=this.points,h=this.scratchArray,f=3*(s+l*u);for(var _=0;_<6;_++)h[_]=c[f+_];f=3*(s+(l+1)*u);for(var x=6;x<12;x++)h[x]=c[f+(x-6)];return d=o<E?o-Math.floor(o):1,p=a<w?a-Math.floor(a):1,d>p?(n[0]=h[0]+d*(h[3]-h[0])+p*(h[6]-h[0]),n[1]=h[1]+d*(h[4]-h[1])+p*(h[7]-h[1]),n[2]=h[2]+d*(h[5]-h[2])+p*(h[8]-h[2])):(n[0]=h[9]+(1-d)*(h[6]-h[9])+(1-p)*(h[3]-h[9]),n[1]=h[10]+(1-d)*(h[7]-h[10])+(1-p)*(h[4]-h[10]),n[2]=h[11]+(1-d)*(h[8]-h[11])+(1-p)*(h[5]-h[11])),n[0]+=this.referencePoint[0],n[1]+=this.referencePoint[1],n[2]+=this.referencePoint[2],n},n.prototype.update=function(t){i.prototype.update.call(this,t);var e=t.globe.elevationTimestamp();this._elevationTimestamp!=e&&(this._elevationTimestamp=e,this._stateKey=null)},n.prototype.computeStateKey=function(){var t=[];return t.push(this._elevationTimestamp),t.push(this.neighborMap[WorldWind.NORTH]?this.neighborMap[WorldWind.NORTH].compare(this.level):0),t.push(this.neighborMap[WorldWind.SOUTH]?this.neighborMap[WorldWind.SOUTH].compare(this.level):0),t.push(this.neighborMap[WorldWind.EAST]?this.neighborMap[WorldWind.EAST].compare(this.level):0),t.push(this.neighborMap[WorldWind.WEST]?this.neighborMap[WorldWind.WEST].compare(this.level):0),t.join(".")},n}),define("worldwind/globe/TerrainTileList",["../error/ArgumentError","../util/Logger","../geom/Sector"],function(t,e,r){"use strict";var i=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"TerrainTileList","TerrainTileList","missingTessellator"));this.tessellator=r,this.sector=null,this.tileArray=[]};return Object.defineProperties(i.prototype,{length:{get:function(){return this.tileArray.length}}}),i.prototype.addTile=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"TerrainTileList","addTile","missingTile"));this.tileArray.indexOf(i)==-1&&(this.tileArray.push(i),this.sector?this.sector.union(i.sector):(this.sector=new r(0,0,0,0),this.sector.copy(i.sector)))},i.prototype.removeAllTiles=function(){this.tileArray=[],this.sector=null},i}),define("worldwind/globe/Tessellator",["../error/ArgumentError","../shaders/BasicProgram","../globe/Globe","../shaders/GpuProgram","../util/Level","../util/LevelSet","../geom/Location","../util/Logger","../geom/Matrix","../cache/MemoryCache","../navigate/NavigatorState","../error/NotYetImplementedError","../pick/PickedObject","../geom/Position","../geom/Rectangle","../geom/Sector","../globe/Terrain","../globe/TerrainTile","../globe/TerrainTileList","../util/Tile","../util/WWMath","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E,w){"use strict";var _=function(){this.numRowsTilesInTopLevel=4,this.numColumnsTilesInTopLevel=8,this.maximumSubdivisionDepth=15,this.tileWidth=32,this.tileHeight=32,this.detailControl=40,this.levels=new o(g.FULL_SPHERE,new a(180/this.numRowsTilesInTopLevel,360/this.numColumnsTilesInTopLevel),this.maximumSubdivisionDepth,this.tileWidth,this.tileHeight),this.topLevelTiles={},this.currentTiles=new v(this),this.tileCache=new u(5e6,4e6),this.elevationTimestamp=void 0,this.lastModelViewProjection=void 0,this.vertexPointLocation=-1,this.vertexTexCoordLocation=-1,this.texCoords=null,this.texCoordVboCacheKey="global_tex_coords",this.indices=null,this.indicesVboCacheKey="global_indices",this.baseIndices=null,this.baseIndicesOffset=null,this.numBaseIndices=null,this.indicesNorth=null,this.indicesNorthOffset=null,this.numIndicesNorth=null,this.indicesSouth=null,this.indicesSouthOffset=null,this.numIndicesSouth=null,this.indicesWest=null,this.indicesWestOffset=null,this.numIndicesWest=null,this.indicesEast=null,this.indicesEastOffset=null,this.numIndicesEast=null,this.indicesLoresNorth=null,this.indicesLoresNorthOffset=null,this.numIndicesLoresNorth=null,this.indicesLoresSouth=null,this.indicesLoresSouthOffset=null,this.numIndicesLoresSouth=null,this.indicesLoresWest=null,this.indicesLoresWestOffset=null,this.numIndicesLoresWest=null,this.indicesLoresEast=null,this.indicesLoresEastOffset=null,this.numIndicesLoresEast=null,this.outlineIndicesOffset=null,this.numOutlineIndices=null,this.wireframeIndicesOffset=null,this.numWireframeIndices=null,this.scratchMatrix=l.fromIdentity(),this.scratchElevations=null,this.scratchPrevElevations=null,this.corners={},this.tiles=[]};return _.prototype.tessellate=function(e){if(!e)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","tessellate","missingDC"));var r=e.globe.elevationTimestamp();if(this.lastGlobeStateKey===e.globeStateKey&&this.lastVerticalExaggeration===e.verticalExaggeration&&this.elevationTimestamp===r&&this.lastModelViewProjection&&e.navigatorState.modelviewProjection.equals(this.lastModelViewProjection))return this.lastTerrain;var i=e.navigatorState;this.lastModelViewProjection=i.modelviewProjection,this.lastGlobeStateKey=e.globeStateKey,this.elevationTimestamp=r,this.lastVerticalExaggeration=e.verticalExaggeration,this.currentTiles.removeAllTiles(),this.topLevelTiles[e.globeStateKey]&&0!=this.topLevelTiles[e.globeStateKey].length||this.createTopLevelTiles(e),this.corners={},this.tiles=[];for(var n=0,o=this.topLevelTiles[e.globeStateKey].length;n<o;n+=1){var a=this.topLevelTiles[e.globeStateKey][n];a.update(e),this.isTileVisible(e,a)&&this.addTileOrDescendants(e,a)}return this.refineNeighbors(e),this.finishTessellating(e),this.lastTerrain=0===this.currentTiles.length?null:new m(e.globe,this,this.currentTiles,e.verticalExaggeration),this.lastTerrain},_.prototype.createTile=function(e,r,i,n){if(!e)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tile","constructor","missingSector"));if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tile","constructor","The specified level is null or undefined."));if(i<0||n<0)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tile","constructor","The specified row or column is less than zero."));return new y(e,r,i,n)},_.prototype.beginRendering=function(t){var e=t.currentProgram;if(!e)return void s.logMessage(s.LEVEL_INFO,"Tessellator","beginRendering","Current Program is empty");this.buildSharedGeometry(),this.cacheSharedGeometryVBOs(t);var r=t.currentGlContext,i=t.gpuResourceCache;if(this.vertexPointLocation=e.attributeLocation(r,"vertexPoint"),this.vertexTexCoordLocation=e.attributeLocation(r,"vertexTexCoord"),r.enableVertexAttribArray(this.vertexPointLocation),this.vertexTexCoordLocation>=0){var n=i.resourceForKey(this.texCoordVboCacheKey);r.bindBuffer(r.ARRAY_BUFFER,n),r.vertexAttribPointer(this.vertexTexCoordLocation,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(this.vertexTexCoordLocation)}var o=i.resourceForKey(this.indicesVboCacheKey);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,o)},_.prototype.endRendering=function(t){var e=t.currentGlContext;e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.vertexPointLocation>=0&&e.disableVertexAttribArray(this.vertexPointLocation),this.vertexTexCoordLocation>=0&&e.disableVertexAttribArray(this.vertexTexCoordLocation)},_.prototype.beginRenderingTile=function(e,r){if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","beginRenderingTile","missingTile"));var i=e.currentGlContext,n=e.gpuResourceCache;this.scratchMatrix.setToMultiply(e.navigatorState.modelviewProjection,r.transformationMatrix),e.currentProgram.loadModelviewProjection(i,this.scratchMatrix);var o=e.globeStateKey+r.tileKey,a=n.resourceForKey(o);a?r.pointsVboStateKey!=r.pointsStateKey?(i.bindBuffer(i.ARRAY_BUFFER,a),i.bufferSubData(i.ARRAY_BUFFER,0,r.points),r.pointsVboStateKey=r.pointsStateKey):e.currentGlContext.bindBuffer(i.ARRAY_BUFFER,a):(a=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,a),i.bufferData(i.ARRAY_BUFFER,r.points,i.STATIC_DRAW),e.frameStatistics.incrementVboLoadCount(1),n.putResource(o,a,4*r.points.length),r.pointsVboStateKey=r.pointsStateKey),i.vertexAttribPointer(this.vertexPointLocation,3,i.FLOAT,!1,0,0)},_.prototype.endRenderingTile=function(t,e){},_.prototype.renderTile=function(e,r){if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","renderTile","missingTile"));var i=e.currentGlContext,n=i.TRIANGLE_STRIP;i.drawElements(n,this.numBaseIndices,i.UNSIGNED_SHORT,2*this.baseIndicesOffset);var o,a=r.level;o=r.neighborLevel(WorldWind.NORTH),o&&o.compare(a)<0?i.drawElements(n,this.numIndicesLoresNorth,i.UNSIGNED_SHORT,2*this.indicesLoresNorthOffset):i.drawElements(n,this.numIndicesNorth,i.UNSIGNED_SHORT,2*this.indicesNorthOffset),o=r.neighborLevel(WorldWind.SOUTH),o&&o.compare(a)<0?i.drawElements(n,this.numIndicesLoresSouth,i.UNSIGNED_SHORT,2*this.indicesLoresSouthOffset):i.drawElements(n,this.numIndicesSouth,i.UNSIGNED_SHORT,2*this.indicesSouthOffset),o=r.neighborLevel(WorldWind.WEST),o&&o.compare(a)<0?i.drawElements(n,this.numIndicesLoresWest,i.UNSIGNED_SHORT,2*this.indicesLoresWestOffset):i.drawElements(n,this.numIndicesWest,i.UNSIGNED_SHORT,2*this.indicesWestOffset),o=r.neighborLevel(WorldWind.EAST),o&&o.compare(a)<0?i.drawElements(n,this.numIndicesLoresEast,i.UNSIGNED_SHORT,2*this.indicesLoresEastOffset):i.drawElements(n,this.numIndicesEast,i.UNSIGNED_SHORT,2*this.indicesEastOffset)},_.prototype.renderWireframeTile=function(e,r){if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","renderWireframeTile","missingTile"));var i=e.currentGlContext;this.vertexTexCoordLocation>=0&&i.disableVertexAttribArray(this.vertexTexCoordLocation),i.drawElements(i.LINES,this.numWireframeIndices,i.UNSIGNED_SHORT,2*this.wireframeIndicesOffset)},_.prototype.renderTileOutline=function(e,r){if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","renderTileOutline","missingTile"));var i=e.currentGlContext;this.vertexTexCoordLocation>=0&&i.disableVertexAttribArray(this.vertexTexCoordLocation),i.drawElements(i.LINE_LOOP,this.numOutlineIndices,i.UNSIGNED_SHORT,2*this.outlineIndicesOffset)},_.prototype.pick=function(e,r,i){if(!e)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","pick","missingDc"));if(!r)throw new t(s.logMessage(s.LEVEL_SEVERE,"Tessellator","pick","missingList"));for(var n=null,o=i||this,a=new d(0,0,0),l=[],u=0,c=r.length;u<c;u++){var h=r[u];h.extent.intersectsFrustum(e.pickFrustum)&&l.push(h)}if(e.pickTerrainOnly||(n=e.uniquePickColor(),this.drawPickTiles(e,l,n)),!e.regionPicking){var p=e.navigatorState.rayFromScreenPoint(e.pickPoint),g=this.computeNearestIntersection(p,l);g&&(e.globe.computePositionFromPoint(g[0],g[1],g[2],a),a.altitude=e.globe.elevationAtLocation(a.latitude,a.longitude),e.addPickedObject(new f(n,o,a,null,!0)))}},_.prototype.drawPickTiles=function(t,r,i){var n=t.currentGlContext;try{t.findAndBindProgram(e),t.currentProgram.loadColor(n,i),this.beginRendering(t);for(var o=0,a=r.length;o<a;o++){var s=r[o];this.beginRenderingTile(t,s),this.renderTile(t,s),this.endRenderingTile(t,s)}}finally{this.endRendering(t)}},_.prototype.computeNearestIntersection=function(t,e){for(var r=[],i=0,n=e.length;i<n;i++)this.computeIntersections(t,e[i],r);if(0==r.length)return null;var o,a=Number.POSITIVE_INFINITY;for(i=0,n=r.length;i<n;i++){var s=t.origin.distanceToSquared(r[i]);a>s&&(a=s,o=i)}return r[o]},_.prototype.computeIntersections=function(t,e,r){var i,n,o=e.level,a=e.points,s=r.length;t.origin.subtract(e.referencePoint),this.buildSharedGeometry(e),n=this.baseIndices,E.computeTriStripIntersections(t,a,n,r),i=e.neighborLevel(WorldWind.SOUTH),n=i&&i.compare(o)<0?this.indicesLoresSouth:this.indicesSouth,E.computeTriStripIntersections(t,a,n,r),i=e.neighborLevel(WorldWind.WEST),n=i&&i.compare(o)<0?this.indicesLoresWest:this.indicesWest,E.computeTriStripIntersections(t,a,n,r),i=e.neighborLevel(WorldWind.EAST),n=i&&i.compare(o)<0?this.indicesLoresEast:this.indicesEast,E.computeTriStripIntersections(t,a,n,r),i=e.neighborLevel(WorldWind.NORTH),n=i&&i.compare(o)<0?this.indicesLoresNorth:this.indicesNorth,E.computeTriStripIntersections(t,a,n,r),t.origin.add(e.referencePoint);for(var l=s,u=r.length;l<u;l++)r[l].add(e.referencePoint)},_.prototype.createTopLevelTiles=function(t){this.topLevelTiles[t.globeStateKey]=[],b.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles[t.globeStateKey])},_.prototype.addTileOrDescendants=function(t,e){return this.tileMeetsRenderCriteria(t,e)?void this.addTile(t,e):void this.addTileDescendants(t,e)},_.prototype.addTileDescendants=function(t,e){for(var r=e.level.nextLevel(),i=e.subdivideToCache(r,this,this.tileCache),n=0;n<i.length;n+=1){var o=i[n];o.update(t),this.levels.sector.intersects(o.sector)&&this.isTileVisible(t,o)&&this.addTileOrDescendants(t,o)}},_.prototype.addTile=function(t,e){var r=this.tiles.length;this.tiles.push(e);var i,n=e.sector,o=[n.maxLatitude,n.maxLongitude].toString(),a=[n.minLatitude,n.maxLongitude].toString(),s=[n.maxLatitude,n.minLongitude].toString(),l=[n.minLatitude,n.minLongitude].toString();i=this.corners[l],i?i.sw=r:this.corners[l]={sw:r},i=this.corners[s],i?i.nw=r:this.corners[s]={nw:r},i=this.corners[a],i?i.se=r:this.corners[a]={se:r},i=this.corners[o],i?i.ne=r:this.corners[o]={ne:r}},_.prototype.refineNeighbors=function(t){for(var e={},r=0,i=this.tiles.length;r<i;r+=1){var n,o,r,i,a=this.tiles[r],s=a.level.levelNumber,l=a.sector,u=[l.maxLatitude,l.maxLongitude].toString(),c=[l.minLatitude,l.maxLongitude].toString(),h=[l.maxLatitude,l.minLongitude].toString(),f=[l.minLatitude,l.minLongitude].toString();n=this.corners[u],n.hasOwnProperty("se")&&(o=n.se,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n.hasOwnProperty("nw")&&(o=n.nw,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n=this.corners[c],n.hasOwnProperty("ne")&&(o=n.ne,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n.hasOwnProperty("sw")&&(o=n.sw,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n=this.corners[h],n.hasOwnProperty("ne")&&(o=n.ne,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n.hasOwnProperty("sw")&&(o=n.sw,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n=this.corners[f],n.hasOwnProperty("se")&&(o=n.se,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0))),n.hasOwnProperty("nw")&&(o=n.nw,this.tiles[o].level.levelNumber<s-1&&(e[o]||(e[o]=!0)))}var d=[],p=[];for(r=0,i=this.tiles.length;r<i;r+=1)a=this.tiles[r],e[r]?d.push(a):p.push(a);if(d.length>0){for(this.tiles=[],this.corners={},r=0,i=p.length;r<i;r+=1)a=p[r],this.addTile(t,a);for(r=0,i=d.length;r<i;r+=1){var a=d[r];this.addTileDescendants(t,a)}this.refineNeighbors(t)}},_.prototype.finishTessellating=function(t){for(var e=0,r=this.tiles.length;e<r;e+=1){var i=this.tiles[e];this.setNeighbors(i),this.regenerateTileGeometryIfNeeded(t,i),this.currentTiles.addTile(i)}},_.prototype.setNeighbors=function(t){var e=t.sector,r=[e.maxLatitude,e.maxLongitude].toString(),i=[e.minLatitude,e.maxLongitude].toString(),n=[e.maxLatitude,e.minLongitude].toString(),o=[e.minLatitude,e.minLongitude].toString(),a=this.corners[r],s=this.corners[i],l=this.corners[n],u=this.corners[o],c=-1,h=-1,f=-1,d=-1;a.hasOwnProperty("se")?c=a.se:l.hasOwnProperty("sw")&&(c=l.sw),s.hasOwnProperty("ne")?h=s.ne:u.hasOwnProperty("nw")&&(h=u.nw),a.hasOwnProperty("nw")?f=a.nw:s.hasOwnProperty("sw")&&(f=s.sw),l.hasOwnProperty("ne")?d=l.ne:u.hasOwnProperty("se")&&(d=u.se),t.setNeighborLevel(WorldWind.NORTH,c>=0?this.tiles[c].level:null),t.setNeighborLevel(WorldWind.SOUTH,h>=0?this.tiles[h].level:null),t.setNeighborLevel(WorldWind.EAST,f>=0?this.tiles[f].level:null),t.setNeighborLevel(WorldWind.WEST,d>=0?this.tiles[d].level:null)},_.prototype.isTileVisible=function(t,e){return!(t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits))&&e.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)},_.prototype.tileMeetsRenderCriteria=function(t,e){var r=this.detailControl;return(e.sector.minLatitude>=75||e.sector.maxLatitude<=-75)&&(r*=2),e.level.isLastLevel()||!e.mustSubdivide(t,r)},_.prototype.regenerateTileGeometryIfNeeded=function(t,e){var r=t.globeStateKey+e.stateKey+t.verticalExaggeration;e.points&&e.pointsStateKey==r||(this.regenerateTileGeometry(t,e),e.pointsStateKey=r)},_.prototype.regenerateTileGeometry=function(t,e){var r=e.tileHeight+1,i=e.tileWidth+1,n=e.referencePoint,o=this.scratchElevations;o||(o=new Float64Array(r*i),this.scratchElevations=o),e.points||(e.points=new Float32Array(r*i*3)),w.fillArray(o,0),t.globe.elevationsForGrid(e.sector,r,i,e.texelSize,o),this.mustAlignNeighborElevations(t,e)&&this.alignNeighborElevations(t,e,o),w.multiplyArray(o,t.verticalExaggeration),t.globe.computePointsForGrid(e.sector,r,i,o,n,e.points),e.transformationMatrix.setTranslation(n[0],n[1],n[2])},_.prototype.mustAlignNeighborElevations=function(t,e){var r=e.level,i=e.neighborLevel(WorldWind.NORTH),n=e.neighborLevel(WorldWind.SOUTH),o=e.neighborLevel(WorldWind.EAST),a=e.neighborLevel(WorldWind.WEST);return i&&i.compare(r)<0||n&&n.compare(r)<0||o&&o.compare(r)<0||a&&a.compare(r)<0},_.prototype.alignNeighborElevations=function(t,e,r){var i,n,o,a,s=e.tileHeight+1,l=e.tileWidth+1,u=e.level,c=Math.floor(s/2)+1,h=Math.floor(l/2)+1,f=u.previousLevel(),d=this.scratchPrevElevations;if(d||(d=new Float64Array(c*h),this.scratchPrevElevations=d),w.fillArray(d,0),t.globe.elevationsForGrid(e.sector,c,h,f.texelSize,d),i=e.neighborLevel(WorldWind.NORTH),i&&i.compare(u)<0)for(o=(s-1)*l,a=(c-1)*h,n=0;n<h;n++,o+=2,a+=1)r[o]=d[a],n<h-1&&(r[o+1]=.5*(d[a]+d[a+1]));if(i=e.neighborLevel(WorldWind.SOUTH),i&&i.compare(u)<0)for(o=0,a=0,n=0;n<h;n++,o+=2,a+=1)r[o]=d[a],n<h-1&&(r[o+1]=.5*(d[a]+d[a+1]));if(i=e.neighborLevel(WorldWind.EAST),i&&i.compare(u)<0)for(o=l-1,a=h-1,n=0;n<c;n++,o+=2*l,a+=h)r[o]=d[a],n<c-1&&(r[o+l]=.5*(d[a]+d[a+h]));if(i=e.neighborLevel(WorldWind.WEST),i&&i.compare(u)<0)for(o=0,a=0,n=0;n<c;n++,o+=2*l,a+=h)r[o]=d[a],n<c-1&&(r[o+l]=.5*(d[a]+d[a+h]))},_.prototype.buildSharedGeometry=function(){var t=this.levels.tileWidth,e=this.levels.tileHeight;this.texCoords||this.buildTexCoords(t,e),this.indices||this.buildIndices(t,e)},_.prototype.buildTexCoords=function(t,e){for(var r=t+1,i=e+1,n=1/t,o=1/e,a=new Float32Array(r*i*2),s=0,l=0,u=0;l<i;l++,u+=o){l==i-1&&(u=1);for(var c=0,h=0;c<r;c++,h+=n)c==r-1&&(h=1),a[s++]=h,a[s++]=u}this.texCoords=a},_.prototype.buildIndices=function(t,e){for(var r,i=e+1,n=t+1,o=2*(i-3)*(n-2)+2*(i-3),a=[],s=0,l=1;l<n-2;l+=1){for(var u=1;u<i-1;u+=1)r=l+u*n,a[s++]=r,a[s++]=r+1;a[s++]=r+1,r=l+1+1*n,a[s++]=r}for(this.baseIndicesOffset=a.length-o,this.baseIndices=new Uint16Array(a.slice(this.baseIndicesOffset)),this.numBaseIndices=o,o=2*n-2,u=i-1,l=n-1,r=l+u*n,a[s++]=r,l=n-2;l>0;l-=1)r=l+u*n,a[s++]=r,a[s++]=r-n;for(l=0,r=l+u*n,a[s++]=r,this.indicesNorthOffset=a.length-o,this.indicesNorth=new Uint16Array(a.slice(this.indicesNorthOffset)),this.numIndicesNorth=o,o=2*n-2,u=0,l=0,r=l+u*n,a[s++]=r,l=1;l<n-1;l+=1)r=l+u*n,a[s++]=r,a[s++]=r+n;for(l=n-1,r=l+u*n,a[s++]=r,this.indicesSouthOffset=a.length-o,this.indicesSouth=new Uint16Array(a.slice(this.indicesSouthOffset)),this.numIndicesSouth=o,o=2*i-2,l=0,u=i-1,r=l+u*n,a[s++]=r,u=i-2;u>0;u-=1)r=l+u*n,a[s++]=r,a[s++]=r+1;for(u=0,r=l+u*n,a[s++]=r,this.indicesWestOffset=a.length-o,this.indicesWest=new Uint16Array(a.slice(this.indicesWestOffset)),this.numIndicesWest=o,o=2*i-2,l=n-1,u=0,r=l+u*n,a[s++]=r,u=1;u<i-1;u+=1)r=l+u*n,a[s++]=r,a[s++]=r-1;for(u=i-1,r=l+u*n,a[s++]=r,this.indicesEastOffset=a.length-o,this.indicesEast=new Uint16Array(a.slice(this.indicesEastOffset)),this.numIndicesEast=o,o=2*n-2,u=i-1,l=n-1,r=l+u*n,a[s++]=r,l=n-2;l>0;l-=1)r=(l+1&-2)+u*n,a[s++]=r,r=l+(u-1)*n,a[s++]=r;for(l=0,r=l+u*n,a[s++]=r,this.indicesLoresNorthOffset=a.length-o,this.indicesLoresNorth=new Uint16Array(a.slice(this.indicesLoresNorthOffset)),this.numIndicesLoresNorth=o,o=2*n-2,u=0,l=0,r=l+u*n,a[s++]=r,l=1;l<n-1;l+=1)r=(l&-2)+u*n,a[s++]=r,r=l+(u+1)*n,a[s++]=r;for(l=n-1,r=l+u*n,a[s++]=r,this.indicesLoresSouthOffset=a.length-o,this.indicesLoresSouth=new Uint16Array(a.slice(this.indicesLoresSouthOffset)),this.numIndicesLoresSouth=o,o=2*i-2,l=0,u=i-1,r=l+u*n,a[s++]=r,u=i-2;u>0;u-=1)r=l+(u+1&-2)*n,a[s++]=r,r=l+1+u*n,a[s++]=r;for(u=0,r=l+u*n,a[s++]=r,this.indicesLoresWestOffset=a.length-o,this.indicesLoresWest=new Uint16Array(a.slice(this.indicesLoresWestOffset)),this.numIndicesLoresWest=o,o=2*i-2,l=n-1,u=0,r=l+u*n,a[s++]=r,u=1;u<i-1;u+=1)r=l+(u&-2)*n,a[s++]=r,r=l-1+u*n,a[s++]=r;u=i-1,r=l+u*n,a[s++]=r,this.indicesLoresEastOffset=a.length-o,this.indicesLoresEast=new Uint16Array(a.slice(this.indicesLoresEastOffset)),this.numIndicesLoresEast=o;var c=this.buildWireframeIndices(t,e),h=this.buildOutlineIndices(t,e);a=a.concat(c),this.wireframeIndicesOffset=a.length-this.numWireframeIndices,a=a.concat(h),this.outlineIndicesOffset=a.length-this.numOutlineIndices,this.indices=new Uint16Array(a)},_.prototype.buildWireframeIndices=function(t,e){var r,i,n,o=e+1,a=t+1,s=2*t*o+2*e*a,l=[],u=a,c=0;for(i=0;i<o;i+=1)for(r=0;r<t;r+=1)n=r+i*u,l[c]=n,l[c+1]=n+1,c+=2;for(r=0;r<a;r+=1)for(i=0;i<e;i+=1)n=r+i*u,l[c]=n,l[c+1]=n+u,c+=2;return this.numWireframeIndices=s,l},_.prototype.buildOutlineIndices=function(t,e){var r,i,n,o=e+1,a=t+1,s=2*(o-2)+2*a+1,l=[],u=0;for(i=0,r=0;r<a;r+=1)n=r+i*a,l[u]=n,u+=1;for(r=a-1,i=1;i<o;i+=1)n=r+i*a,l[u]=n,u+=1;for(i=o-1,r=a-1;r>=0;r-=1)n=r+i*a,l[u]=n,u+=1;for(r=0,i=o-1;i>=0;i-=1)n=r+i*a,l[u]=n,u+=1;return this.numOutlineIndices=s,l},_.prototype.cacheSharedGeometryVBOs=function(t){var e=t.currentGlContext,r=t.gpuResourceCache,i=r.resourceForKey(this.texCoordVboCacheKey);i||(i=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,this.texCoords,e.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),r.putResource(this.texCoordVboCacheKey,i,4*this.texCoords.length/2));var n=r.resourceForKey(this.indicesVboCacheKey);n||(n=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),r.putResource(this.indicesVboCacheKey,n,2*this.indices.length))},_}),define("worldwind/globe/Globe",["../geom/Angle","../error/ArgumentError","../geom/BoundingBox","../globe/ElevationModel","../geom/Line","../geom/Location","../util/Logger","../geom/Matrix","../geom/Position","../projections/ProjectionWgs84","../geom/Sector","../globe/Tessellator","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d){"use strict";var p=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","constructor","Elevation model is null or undefined."));this.elevationModel=t,this.equatorialRadius=6378137,this.polarRadius=6356752.3,this.eccentricitySquared=.00669437999013,this.tessellator=new h,this._projection=r||new u,this._offset=0,this.offsetVector=new f(0,0,0),this.id=++p.idPool,this.modelview=s.fromIdentity(),this.forwardRay=new f(0,0,0),this.originPos=new l(0,0,0),this.originPoint=new f(0,0,0),this.origin=s.fromIdentity(),this._stateKey="globe "+this.id.toString()+" "};return p.idPool=0,Object.defineProperties(p.prototype,{stateKey:{get:function(){return this._stateKey+this.elevationModel.stateKey+"offset "+this.offset.toString()+" "+this.projection.stateKey}},continuous:{get:function(){return this.projection.continuous}},projection:{get:function(){return this._projection},set:function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","projection","missingProjection"));this.projection!=t&&(this.tessellator=new h),this._projection=t}},projectionLimits:{get:function(){return this._projection.projectionLimits}},offset:{get:function(){return this._offset},set:function(t){this._offset=t,this.offsetVector[0]=2*t*Math.PI*this.equatorialRadius}}}),p.prototype.is2D=function(){return this.projection.is2D},p.prototype.computePointFromPosition=function(t,r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointFromPosition","missingResult"));return this.projection.geographicToCartesian(this,t,r,i,this.offsetVector,n)},p.prototype.computePointFromLocation=function(t,r,i){if(!i)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointFromLocation","missingResult"));return this.computePointFromPosition(t,r,0,i)},p.prototype.computePointsForGrid=function(t,r,i,n,o,s){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointsFromPositions","missingSector"));if(r<1||i<1)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointsFromPositions","Number of latitude or longitude locations is less than one."));var l=r*i;if(!n||n.length<l)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointsFromPositions","Elevations array is null, undefined or insufficient length."));if(!s||s.length<l)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePointsFromPositions","Result array is null, undefined or insufficient length."));return this.projection.geographicToCartesianGrid(this,t,r,i,n,o,this.offsetVector,s)},p.prototype.computePositionFromPoint=function(t,r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","computePositionFromPoint","missingResult"));return this.projection.cartesianToGeographic(this,t,r,i,this.offsetVector,n),this.continuous&&(n.longitude<-180?n.longitude+=360:n.longitude>180&&(n.longitude-=360)),n},p.prototype.radiusAt=function(e,r){var i=Math.sin(e*t.DEGREES_TO_RADIANS),n=this.equatorialRadius/Math.sqrt(1-this.eccentricitySquared*i*i);return n*Math.sqrt(1+(this.eccentricitySquared*this.eccentricitySquared-2*this.eccentricitySquared)*i*i)},p.prototype.surfaceNormalAtLocation=function(r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","surfaceNormalAtLocation","missingResult"));if(this.is2D())return n[0]=0,n[1]=0,n[2]=1,n;var o=Math.cos(r*t.DEGREES_TO_RADIANS),s=Math.cos(i*t.DEGREES_TO_RADIANS),l=Math.sin(r*t.DEGREES_TO_RADIANS),u=Math.sin(i*t.DEGREES_TO_RADIANS),c=this.equatorialRadius*this.equatorialRadius,h=this.polarRadius*this.polarRadius;return n[0]=o*u/c,n[1]=(1-this.eccentricitySquared)*l/h,n[2]=o*s/c,n.normalize()},p.prototype.surfaceNormalAtPoint=function(t,r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","surfaceNormalAtPoint","missingResult"));if(this.projection.surfaceNormalAtPoint)return this.projection.surfaceNormalAtPoint(this,t,r,i,n);if(this.is2D())return n[0]=0,n[1]=0,n[2]=1,n;var o=this.equatorialRadius*this.equatorialRadius,s=this.polarRadius*this.polarRadius;return n[0]=t/o,n[1]=r/s,n[2]=i/o,n.normalize()},p.prototype.northTangentAtLocation=function(t,r,i){if(!i)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","northTangentAtLocation","missingResult"));return this.projection.northTangentAtLocation(this,t,r,i)},p.prototype.northTangentAtPoint=function(t,r,i,n){if(!n)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","northTangentAtPoint","missingResult"));return this.projection.northTangentAtPoint(this,t,r,i,this.offsetVector,n)},p.prototype.intersectsFrustum=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","intersectsFrustum","missingFrustum"));if(this.is2D()){var i=new r;return i.setToSector(c.FULL_SPHERE,this,this.elevationModel.minElevation,this.elevationModel.maxElevation),i.intersectsFrustum(t)}return!(t.far.distance<=this.equatorialRadius)&&(!(t.left.distance<=this.equatorialRadius)&&(!(t.right.distance<=this.equatorialRadius)&&(!(t.top.distance<=this.equatorialRadius)&&(!(t.bottom.distance<=this.equatorialRadius)&&!(t.near.distance<=this.equatorialRadius)))))},p.prototype.intersectsLine=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","intersectWithRay","missingLine"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","intersectsLine","missingResult"));var i,n=t.direction[0],o=t.direction[1],s=t.direction[2],l=t.origin[0],u=t.origin[1],c=t.origin[2];if(this.is2D())return(0!=s||0==c)&&(i=-c/s,!(i<0)&&(r[0]=l+n*i,r[1]=u+o*i,r[2]=c+s*i,!0));var h,f,d,p,g=this.equatorialRadius,m=g*g,y=g/this.polarRadius,v=y*y;return h=n*n+v*o*o+s*s,f=2*(l*n+v*u*o+c*s),d=l*l+v*u*u+c*c-m,p=f*f-4*h*d,!(p<0)&&(i=(-f-Math.sqrt(p))/(2*h),i>0?(r[0]=l+n*i,r[1]=u+o*i,r[2]=c+s*i,!0):(i=(-f+Math.sqrt(p))/(2*h),i>0&&(r[0]=l+n*i,r[1]=u+o*i,r[2]=c+s*i,!0)))},p.prototype.elevationTimestamp=function(){return this.elevationModel.timestamp},p.prototype.minElevation=function(){return this.elevationModel.minElevation},p.prototype.maxElevation=function(){return this.elevationModel.maxElevation},p.prototype.minAndMaxElevationsForSector=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","minAndMaxElevationsForSector","missingSector"));return this.elevationModel.minAndMaxElevationsForSector(t)},p.prototype.elevationAtLocation=function(t,e){return this.elevationModel.elevationAtLocation(t,e)},p.prototype.elevationsForGrid=function(t,r,i,n,o){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","elevationsForSector","missingSector"));if(r<=0||i<=0)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","elevationsForSector","numLat or numLon is less than 1"));if(!o||o.length<r*i)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","elevationsForSector","missingArray"));return this.elevationModel.elevationsForGrid(t,r,i,n,o)},p.prototype.getRadiusAt=function(t,e){var r=Math.sin(d.toRadians(t)),i=this.eccentricitySquared,n=this.equatorialRadius/Math.sqrt(1-i*r*r);return n*Math.sqrt(1+(i*i-2*i)*r*r)},p.prototype.computeViewHeading=function(t,e){var r=d.toRadians(e),i=Math.cos(r),n=Math.sin(r),o=i*t[0]-n*t[4],a=n*t[5]-i*t[1];return d.toDegrees(Math.atan2(a,o))},p.prototype.computeViewTilt=function(t){var e=t[10],r=Math.sqrt(t[2]*t[2]+t[6]*t[6]);return d.toDegrees(Math.atan2(r,e))},p.prototype.cameraToCartesianTransform=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","cameraToCartesianTransform","missing camera"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","cameraToCartesianTransform","missing result"));return this._projection.geographicToCartesianTransform(this,t.latitude,t.longitude,t.altitude,null,r),r.multiplyByRotation(0,0,1,-t.heading),r.multiplyByRotation(1,0,0,t.tilt),r.multiplyByRotation(0,0,1,t.roll),r},p.prototype.horizonDistance=function(t,r){var i=t,n=this.equatorialRadius,o=Math.sqrt(i*(2*n+i));if(1==arguments.length)return o;if(2==arguments.length){var s=r,l=Math.sqrt(s*(2*n+s));return o+l}throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","horizon distance","Wrong amount of parameters. Expected: 2 or 1, Actual: "+arguments.length))},p.prototype.cameraToLookAt=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","cameraToLookAt","missing camera"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","cameraToLookAt","missing result"));var i=this.cameraToCartesianTransform(t,this.modelview);i.invertOrthonormal(this.modelview);var o=new f,s=new f;this.modelview.extractEyePoint(o),this.modelview.extractForwardVector(s);var l=new n(o,s);if(!this.intersectsLine(l,this.originPoint)){var u=this.horizonDistance(t.altitude);l.pointAt(u,this.originPoint)}return this.computePositionFromPoint(this.originPoint[0],this.originPoint[1],this.originPoint[2],this.originPos),this._projection.cartesianToLocalTransform(this,this.originPoint[0],this.originPoint[1],this.originPoint[2],null,this.origin),this.modelview.multiplyMatrix(this.origin),r.latitude=this.originPos.latitude,r.longitude=this.originPos.longitude,r.altitude=this.originPos.altitude,r.range=-this.modelview[11],r.heading=this.computeViewHeading(this.modelview,t.roll),r.tilt=this.computeViewTilt(this.modelview),r.roll=t.roll,r},p.prototype.lookAtToCamera=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","lookAtToCamera","missing look at"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","lookAtToCamera","missing result"));return this.lookAtToCartesianTransform(t,this.modelview).invertOrthonormal(this.modelview),this.modelview.extractEyePoint(this.originPoint),this.computePositionFromPoint(this.originPoint[0],this.originPoint[1],this.originPoint[2],this.originPos),
this._projection.cartesianToLocalTransform(this,this.originPoint[0],this.originPoint[1],this.originPoint[2],null,this.origin),this.modelview.multiplyMatrix(this.origin),r.latitude=this.originPos.latitude,r.longitude=this.originPos.longitude,r.altitude=this.originPos.altitude,r.heading=this.computeViewHeading(this.modelview,t.roll),r.tilt=this.computeViewTilt(this.modelview),r.roll=t.roll,r},p.prototype.lookAtToCartesianTransform=function(t,r){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","lookAtToCartesianTransform","missing look at"));if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Globe","lookAtToCartesianTransform","missing result"));return this._projection.geographicToCartesianTransform(this,t.latitude,t.longitude,t.altitude,null,r),r.multiplyByRotation(0,0,1,-t.heading),r.multiplyByRotation(1,0,0,t.tilt),r.multiplyByRotation(0,0,1,t.roll),r.multiplyByTranslation(0,0,t.range),r},p}),define("worldwind/cache/GpuResourceCache",["../util/AbsentResourceList","../error/ArgumentError","../util/ImageSource","../util/Logger","../cache/MemoryCache","../render/Texture"],function(t,e,r,i,n,o){"use strict";var a=function(r,o){if(!r||r<1)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","constructor","Specified cache capacity is undefined, 0 or negative."));if(!o||o<0||o>=r)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","constructor","Specified cache low-water value is undefined, negative or not less than the capacity."));this.entries=new n(r,o),this.cacheKeyPool=0,this.currentRetrievals={},this.absentResourceList=new t(3,6e4)};return Object.defineProperties(a.prototype,{capacity:{get:function(){return this.entries.capacity}},lowWater:{get:function(){return this.entries.lowWater}},usedCapacity:{get:function(){return this.entries.usedCapacity}},freeCapacity:{get:function(){return this.entries.freeCapacity}}}),a.prototype.generateCacheKey=function(){return"GpuResourceCache "+ ++this.cacheKeyPool},a.prototype.putResource=function(t,n,o){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","putResource","missingKey."));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","putResource","missingResource."));if(!o||o<1)throw new e(i.logMessage(i.LEVEL_SEVERE,"GpuResourceCache","putResource","The specified resource size is undefined or less than 1."));var a={resource:n};this.entries.putEntry(t instanceof r?t.key:t,a,o)},a.prototype.resourceForKey=function(t){var e=t instanceof r?this.entries.entryForKey(t.key):this.entries.entryForKey(t);return e?e.resource:null},a.prototype.containsResource=function(t){return this.entries.containsKey(t instanceof r?t.key:t)},a.prototype.removeResource=function(t){this.entries.removeEntry(t instanceof r?t.key:t)},a.prototype.clear=function(){this.entries.clear(!1)},a.prototype.retrieveTexture=function(t,e,n){if(!e)return null;if(e instanceof r){var a=new o(t,e.image,n);return this.putResource(e.key,a,a.size),a}if(this.currentRetrievals[e]||this.absentResourceList.isResourceAbsent(e))return null;var s=this,l=new Image;return l.onload=function(){i.log(i.LEVEL_INFO,"Image retrieval succeeded: "+e);var r=new o(t,l,n);s.putResource(e,r,r.size),delete s.currentRetrievals[e],s.absentResourceList.unmarkResourceAbsent(e);var a=document.createEvent("Event");a.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(a)},l.onerror=function(){delete s.currentRetrievals[e],s.absentResourceList.markResourceAbsent(e),i.log(i.LEVEL_WARNING,"Image retrieval failed: "+e)},this.currentRetrievals[e]=e,l.crossOrigin="anonymous",l.src=e,null},a}),define("worldwind/pick/PickedObjectList",[],function(){"use strict";var t=function(){this.objects=[]};return t.prototype.hasNonTerrainObjects=function(){return this.objects.length>1||1===this.objects.length&&null==this.terrainObject()},t.prototype.terrainObject=function(){for(var t=0,e=this.objects.length;t<e;t++)if(this.objects[t].isTerrain)return this.objects[t];return null},t.prototype.add=function(t){if(t)if(t.isTerrain){for(var e=this.objects.length,r=0,i=this.objects.length;r<i;r++)if(this.objects[r].isTerrain){e=r;break}this.objects[e]=t}else this.objects.push(t)},t.prototype.clear=function(){this.objects=[]},t.prototype.topPickedObject=function(){var t=this.objects.length;if(t>1)for(var e=0;e<t;e++)if(this.objects[[e].isOnTop])return this.objects[e];return t>0?this.objects[0]:null},t}),define("worldwind/render/ScreenCreditController",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Logger","../geom/Matrix","../util/Offset","../pick/PickedObject","../render/Renderable","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(){this.imageUrls=[],this.stringCredits=[],this.imageCreditSize=64,this.margin=5,this.opacity=.5,this.creditFont=new i(14)};return h.scratchMatrix=o.fromIdentity(),h.imageTransform=o.fromIdentity(),h.texCoordMatrix=o.fromIdentity(),h.prototype.clear=function(){this.imageUrls=[],this.stringCredits=[]},h.prototype.addImageCredit=function(e){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenCreditController","addImageCredit","missingUrl"));this.imageUrls.indexOf(e)===-1&&this.imageUrls.push(e)},h.prototype.addStringCredit=function(e,i){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenCreditController","addStringCredit","missingText"));if(!i)throw new t(n.logMessage(n.LEVEL_SEVERE,"ScreenCreditController","addStringCredit","missingColor"));this.stringCredits.indexOf(e)===-1&&this.stringCredits.push({text:e,color:i||r.WHITE})},h.prototype.drawCredits=function(t){if((0!==this.imageUrls.length||0!==this.stringCredits.length)&&!t.pickingMode&&t.timestamp!=this.lastFrameTimestamp){this.lastFrameTimestamp=t.timestamp,this.beginDrawingCredits(t);for(var e,r=t.navigatorState.viewport.width-(this.margin+this.imageCreditSize),i=0,n=0;n<this.imageUrls.length;n++)e=this.drawImageCredit(t,this.imageUrls[n],r,this.margin),e>0&&(r-=this.margin+this.imageCreditSize,i=c.max(e,i));for(var o=i+this.margin,a=0;a<this.stringCredits.length;a++)this.drawStringCredit(t,this.stringCredits[a],o),o+=this.margin+15;this.endDrawingCredits(t)}},h.prototype.beginDrawingCredits=function(t){var r,i=t.currentGlContext;t.findAndBindProgram(e),r=t.currentProgram,i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer3()),i.vertexAttribPointer(r.vertexPointLocation,3,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer()),i.vertexAttribPointer(r.vertexTexCoordLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.vertexPointLocation),i.enableVertexAttribArray(r.vertexTexCoordLocation),r.loadTextureUnit(i,i.TEXTURE0),r.loadModulateColor(i,!1)},h.prototype.endDrawingCredits=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.enable(e.DEPTH_TEST)},h.prototype.drawImageCredit=function(t,e,i,n){var o,a,s,l,u,c;return(l=t.gpuResourceCache.resourceForKey(e))?(o=l.imageWidth,a=l.imageHeight,s=o<=this.imageCreditSize&&this.imageHeight<=this.imageCreditSize?1:o>=a?this.imageCreditSize/o:this.imageCreditSize/a,h.imageTransform.setTranslation(i,n,0),h.imageTransform.setScale(s*o,s*a,1),u=t.currentGlContext,c=t.currentProgram,h.scratchMatrix.copy(t.screenProjection),h.scratchMatrix.multiplyMatrix(h.imageTransform),c.loadModelviewProjection(u,h.scratchMatrix),c.loadTextureEnabled(u,!0),c.loadColor(u,r.WHITE),c.loadOpacity(u,this.opacity),h.texCoordMatrix.setToIdentity(),h.texCoordMatrix.multiplyByTextureTransform(l),c.loadTextureMatrix(u,h.texCoordMatrix),l.bind(t)&&u.drawArrays(u.TRIANGLE_STRIP,0,4),a):(t.gpuResourceCache.retrieveTexture(t.currentGlContext,e),0)},h.prototype.drawStringCredit=function(t,e,r){var i,n,o,a,s,l,u;return a=e.text+this.creditFont.toString(),o=t.gpuResourceCache.resourceForKey(a),o||(o=t.textSupport.createTexture(t,e.text,this.creditFont,!1),t.gpuResourceCache.putResource(a,o,o.size)),i=o.imageWidth,n=o.imageHeight,u=t.navigatorState.viewport.width-(i+this.margin),h.imageTransform.setTranslation(u,r,0),h.imageTransform.setScale(i,n,1),s=t.currentGlContext,l=t.currentProgram,h.scratchMatrix.copy(t.screenProjection),h.scratchMatrix.multiplyMatrix(h.imageTransform),l.loadModelviewProjection(s,h.scratchMatrix),l.loadTextureEnabled(s,!0),l.loadColor(s,e.color),l.loadOpacity(s,this.opacity),h.texCoordMatrix.setToIdentity(),h.texCoordMatrix.multiplyByTextureTransform(o),l.loadTextureMatrix(s,h.texCoordMatrix),o.bind(t)&&s.drawArrays(s.TRIANGLE_STRIP,0,4),!0},h}),define("worldwind/util/HashMap",[],function(){"use strict";var t=function(){this._entries=Object.create(null)};return t.prototype.get=function(t){return this._entries[t]},t.prototype.set=function(t,e){this._entries[t]=e},t.prototype.remove=function(t){delete this._entries[t]},t.prototype.contains=function(t){return t in this._entries},t.reIndex=function(e,r,i){var n=new t;for(var o in e._entries){var a=parseInt(o);a>=r&&(a+=i);var s=e.get(o);s.index=a,n.set(a,s)}return n},t}),define("worldwind/util/PolygonSplitter",["./HashMap","../geom/Location","../geom/Position","./WWMath"],function(t,e,r,i){"use strict";var n={addedIndex:-1,poleIndexOffset:-1,splitContours:function(t,e){for(var r=!1,i=0,n=t.length;i<n;i++){var o=this.splitContour(t[i]);o.polygons.length>1&&(r=!0),e.push(o)}return r},splitContour:function(r){var i=new t,n=[],o=[],a=[],s=[],l=-1,u=this.findIntersectionAndPole(r,n,o,i);return 0===o.length?(a.push(n),s.push(i),this.formatContourOutput(a,u,l,s)):(o.length>2&&o.sort(function(t,e){return e.latitude-t.latitude}),u!==e.poles.NONE&&(n=this.handleOnePole(n,o,i,u),i=this.reindexIntersections(o,i,this.poleIndexOffset)),0===o.length?(a.push(n),s.push(i),l=0,this.formatContourOutput(a,u,l,s)):(this.linkIntersections(o,i),l=this.makePolygons(n,o,i,a,s),this.formatContourOutput(a,u,l,s)))},findIntersectionAndPole:function(t,r,n,o){var a=!1,s=90,l=-90;this.addedIndex=-1;for(var u=0,c=t.length;u<c;u++){var h=t[u],f=t[(u+1)%c];s=Math.min(s,h.latitude),l=Math.max(l,h.latitude);var d=e.locationsCrossDateLine([h,f]);if(d){a=!a;var p=e.meridianIntersection(h,f,180);null===p&&(p=(h.latitude+f.latitude)/2);var g=180*i.signum(h.longitude)||180,m=this.createPoint(p,g,h.altitude),y=this.createPoint(p,-g,f.altitude);this.safeAdd(r,h,u,c);var v=r.length;o.set(v,this.makeIntersectionEntry(v)),o.set(v+1,this.makeIntersectionEntry(v+1)),n.push({indexEnd:v,indexStart:v+1,latitude:p}),r.push(m),r.push(y),this.safeAdd(r,f,u+1,c)}else this.safeAdd(r,h,u,c),this.safeAdd(r,f,u+1,c)}var b=e.poles.NONE;return a&&(b=this.determinePole(s,l)),b},determinePole:function(t,r){var i;return i=t>0?e.poles.NORTH:r<0?e.poles.SOUTH:Math.abs(r)>=Math.abs(t)?e.poles.NORTH:e.poles.SOUTH},handleOnePole:function(t,r,i,n){var o;if(n===e.poles.NORTH)var a=r.shift(),s=90;else n===e.poles.SOUTH&&(a=r.pop(),s=-90);var l=i.get(a.indexEnd),u=i.get(a.indexStart);l.forPole=!0,u.forPole=!0,this.poleIndexOffset=a.indexStart,o=t.slice(0,a.indexEnd+1);var c=this.createPoint(s,t[l.index].longitude,t[l.index].altitude),h=this.createPoint(s,t[u.index].longitude,t[u.index].altitude);return o.push(c,h),o=o.concat(t.slice(this.poleIndexOffset))},linkIntersections:function(t,e){for(var r=0;r<t.length-1;r+=2){var i=t[r],n=t[r+1],o=e.get(i.indexEnd),a=e.get(i.indexStart),s=e.get(n.indexEnd),l=e.get(n.indexStart);o.linkTo=n.indexStart,a.linkTo=n.indexEnd,s.linkTo=i.indexStart,l.linkTo=i.indexEnd}},reindexIntersections:function(e,r,i){r=t.reIndex(r,i,2);for(var n=0,o=e.length;n<o;n++)e[n].indexEnd>=i&&(e[n].indexEnd+=2),e[n].indexStart>=i&&(e[n].indexStart+=2);return r},makePolygons:function(e,r,i,n,o){for(var a=-1,s=0;s<r.length-1;s+=2){var l=r[s],u=r[s+1],c=l.indexStart,h=u.indexEnd,f=[],d=new t,p=this.makePolygon(c,h,e,i,f,d);f.length&&(n.push(f),o.push(d),p&&(a=n.length-1)),c=u.indexStart,h=l.indexEnd,f=[],d=new t,p=this.makePolygon(c,h,e,i,f,d),f.length&&(n.push(f),o.push(d),p&&(a=n.length-1))}return a},makePolygon:function(t,e,r,i,n,o){var a=!1,s=r.length,l=!1;e<t&&(e+=s);for(var u=t;u<=e;u++){var c=u%s,h=r[c],f=i.get(c);if(f){if(f.visited)break;if(n.push(h),o.set(n.length-1,f),f.forPole)l=!0;else{if(a&&(u=f.linkTo-1,u+1===t))break;a=!a,f.visited=!0}}else n.push(h)}return l},safeAdd:function(t,e,r,i){this.addedIndex<r&&this.addedIndex<i-1&&(t.push(e),this.addedIndex=r)},createPoint:function(t,i,n){return null==n?new e(t,i):new r(t,i,n)},formatContourOutput:function(t,e,r,i){return{polygons:t,pole:e,poleIndex:r,iMap:i}},makeIntersectionEntry:function(t){return null==t&&(t=-1),{visited:!1,forPole:!1,index:t,linkTo:-1}}};return n}),define("worldwind/shapes/ShapeAttributes",["../util/Color","../util/ImageSource"],function(t,e){"use strict";var r=function(e){this._drawInterior=!e||e._drawInterior,this._drawOutline=!e||e._drawOutline,this._enableLighting=!!e&&e._enableLighting,this._interiorColor=e?e._interiorColor:t.WHITE,this._outlineColor=e?e._outlineColor:t.RED,this._outlineWidth=e?e._outlineWidth:1,this._outlineStippleFactor=e?e._outlineStippleFactor:0,this._outlineStipplePattern=e?e._outlineStipplePattern:61680,this._imageSource=e?e._imageSource:null,this._depthTest=!e||e._depthTest,this._drawVerticals=!!e&&e._drawVerticals,this._applyLighting=!!e&&e._applyLighting,this.stateKeyInvalid=!0};return r.prototype.computeStateKey=function(){return"di "+this._drawInterior+" do "+this._drawOutline+" el "+this._enableLighting+" ic "+this._interiorColor.toHexString(!0)+" oc "+this._outlineColor.toHexString(!0)+" ow "+this._outlineWidth+" osf "+this._outlineStippleFactor+" osp "+this._outlineStipplePattern+" is "+(this._imageSource?this.imageSource instanceof e?this.imageSource.key:this.imageSource:"null")+" dt "+this._depthTest+" dv "+this._drawVerticals+" li "+this._applyLighting},Object.defineProperties(r.prototype,{stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}},drawInterior:{get:function(){return this._drawInterior},set:function(t){this._drawInterior=t,this.stateKeyInvalid=!0}},drawOutline:{get:function(){return this._drawOutline},set:function(t){this._drawOutline=t,this.stateKeyInvalid=!0}},enableLighting:{get:function(){return this._enableLighting},set:function(t){this._enableLighting=t,this.stateKeyInvalid=!0}},interiorColor:{get:function(){return this._interiorColor},set:function(t){this._interiorColor=t,this.stateKeyInvalid=!0}},outlineColor:{get:function(){return this._outlineColor},set:function(t){this._outlineColor=t,this.stateKeyInvalid=!0}},outlineWidth:{get:function(){return this._outlineWidth},set:function(t){this._outlineWidth=t,this.stateKeyInvalid=!0}},outlineStipplePattern:{get:function(){return this._outlineStipplePattern},set:function(t){this._outlineStipplePattern=t,this.stateKeyInvalid=!0}},outlineStippleFactor:{get:function(){return this._outlineStippleFactor},set:function(t){this._outlineStippleFactor=t,this.stateKeyInvalid=!0}},imageSource:{get:function(){return this._imageSource},set:function(t){this._imageSource=t,this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(t){this._depthTest=t,this.stateKeyInvalid=!0}},drawVerticals:{get:function(){return this._drawVerticals},set:function(t){this._drawVerticals=t,this.stateKeyInvalid=!0}},applyLighting:{get:function(){return this._applyLighting},set:function(t){this._applyLighting=t,this.stateKeyInvalid=!0}}}),r}),define("worldwind/shapes/SurfaceShape",["../error/AbstractError","../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../error/NotYetImplementedError","../pick/PickedObject","../util/PolygonSplitter","../render/Renderable","../geom/Sector","../shapes/ShapeAttributes","../error/UnsupportedOperationError","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f){"use strict";var d=function(t){l.call(this),this._displayName="Surface Shape",this._attributes=t?t:new c(null),this._highlightAttributes=null,this._highlighted=!1,this._enabled=!0,this._pathType=WorldWind.GREAT_CIRCLE,this._maximumNumEdgeIntervals=d.DEFAULT_NUM_EDGE_INTERVALS,this._polarThrottle=d.DEFAULT_POLAR_THROTTLE,this._sector=null,this.pickDelegate=null,this._sectors=[],this._locations=null,this._boundaries=null,this._interiorGeometry=null,this._outlineGeometry=null,this._isInteriorInhibited=!1,this.stateKeyInvalid=!0,this._attributesStateKey=null,this.isPrepared=!1,this.layer=null,this.pickColor=null,this.contours=[],this.containsPole=!1,this.crossesAntiMeridian=!1};return d.prototype=Object.create(l.prototype),Object.defineProperties(d.prototype,{stateKey:{get:function(){if(this._attributesStateKey){var t=null;this._highlighted?this._highlightAttributes&&(t=this._highlightAttributes.stateKey):this._attributes&&(t=this._attributes.stateKey),t!=this._attributesStateKey&&(this._attributesStateKey=t,this.stateKeyInvalid=!0)}else this._highlighted?this._highlightAttributes&&(this._attributesStateKey=this._highlightAttributes.stateKey):this._attributes&&(this._attributesStateKey=this._attributes.stateKey),this._attributesStateKey&&(this.stateKeyInvalid=!0);return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey()),this._stateKey}},displayName:{get:function(){return this._displayName},set:function(t){this.stateKeyInvalid=!0,this._displayName=t}},attributes:{get:function(){return this._attributes},set:function(t){this.stateKeyInvalid=!0,this._attributes=t,this._attributesStateKey=t.stateKey}},highlightAttributes:{get:function(){return this._highlightAttributes},set:function(t){this.stateKeyInvalid=!0,this._highlightAttributes=t}},highlighted:{get:function(){return this._highlighted},set:function(t){this.stateKeyInvalid=!0,this._highlighted=t}},enabled:{get:function(){return this._enabled},set:function(t){this.stateKeyInvalid=!0,this._enabled=t}},pathType:{get:function(){return this._pathType},set:function(t){this.stateKeyInvalid=!0,this._pathType=t}},maximumNumEdgeIntervals:{get:function(){return this._maximumNumEdgeIntervals},set:function(t){this.stateKeyInvalid=!0,this._maximumNumEdgeIntervals=t}},polarThrottle:{get:function(){return this._polarThrottle},set:function(t){this.stateKeyInvalid=!0,this._polarThrottle=t}},sector:{get:function(){return this._sector}}}),d.staticStateKey=function(t){return t.stateKeyInvalid=!1,t.highlighted&&t._highlightAttributes?t._attributesStateKey=t._highlightAttributes.stateKey:t._attributes?t._attributesStateKey=t._attributes.stateKey:t._attributesStateKey=null,"dn "+t.displayName+" at "+(t._attributesStateKey?t._attributesStateKey:"null")+" hi "+t.highlighted+" en "+t.enabled+" pt "+t.pathType+" ne "+t.maximumNumEdgeIntervals+" po "+t.polarThrottle+" se ["+t.sector.minLatitude+","+t.sector.maxLatitude+","+t.sector.minLongitude+","+t.sector.maxLongitude+"]"},d.prototype.computeStateKey=function(){return d.staticStateKey(this)},d.prototype.area=function(t,e){throw new o(n.logMessage(n.LEVEL_SEVERE,"SurfaceShape","area","notYetImplemented"))},d.prototype.computeBoundaries=function(e){throw new t(n.logMessage(n.LEVEL_SEVERE,"SurfaceShape","computeBoundaries","abstractInvocation"))},d.prototype.render=function(t){this.enabled&&(this.layer=t.currentLayer,this.prepareBoundaries(t),t.surfaceShapeTileBuilder.insertSurfaceShape(this))},d.prototype.interpolateLocations=function(t){var e,r,i,n=t[0],o=n,a=!0,s=!0,l=0,u=!0;for(this._locations=[n],r=1,i=t.length;r<i;r+=1)e=o,s=a,o=t[r],a=o.latitude==n.latitude&&o.longitude==n.longitude,u=!0,(a||s)&&(l+=1,l>2&&(u=!1)),u&&this.interpolateEdge(e,o,this._locations),this._locations.push(o),e=o;this._isInteriorInhibited||e.latitude==n.latitude&&e.longitude==n.longitude||(this.interpolateEdge(e,n,this._locations),this._locations.push(n))},d.prototype.interpolateEdge=function(t,e,r){var n,o,a=i.greatCircleDistance(t,e),s=Math.round(this._maximumNumEdgeIntervals*a/Math.PI);if(s>0){n=1/s,o=t;for(var l=this.throttledStep(n,o);l<1;l+=this.throttledStep(n,o))o=new i(0,0),i.interpolateAlongPath(this._pathType,l,t,e,o),180===t.longitude&&180===e.longitude?o.longitude=180:t.longitude===-180&&e.longitude===-180&&(o.longitude=-180),r.push(o)}},d.prototype.throttledStep=function(t,r){var i=Math.cos(r.latitude*e.DEGREES_TO_RADIANS);i*=i;var n=this._polarThrottle/(1+this._polarThrottle);return t*(1-n+n*i)},d.prototype.prepareBoundaries=function(t){if(!this.isPrepared){this._boundaries||this.computeBoundaries(t);var e=this.formatBoundaries();this.normalizeAngles(e),e=this.interpolateBoundaries(e);var r=[],i=s.splitContours(e,r);this.contours=r,this.crossesAntiMeridian=i,this.prepareGeometry(t,r),this.prepareSectors(),this.isPrepared=!0}},d.prototype.formatBoundaries=function(){var t=[];return this._boundaries.length?(null!=this._boundaries[0].latitude?t.push(this._boundaries):t=this._boundaries,t):t},d.prototype.normalizeAngles=function(t){for(var r=0,i=t.length;r<i;r++)for(var n=t[r],o=0,a=n.length;o<a;o++){var s=n[o];(s.longitude<-180||s.longitude>180)&&(s.longitude=e.normalizedDegreesLongitude(s.longitude)),(s.latitude<-90||s.latitude>90)&&(s.latitude=e.normalizedDegreesLatitude(s.latitude))}},d.prototype.interpolateBoundaries=function(t){for(var e=[],r=0,i=t.length;r<i;r++){var n=t[r];this.interpolateLocations(n),e.push(this._locations.slice()),this._locations.length=0}return e},d.prototype.computeSectors=function(t){return this._sectors&&this._sectors.length>0?this._sectors:(this.prepareBoundaries(t),this._sectors)},d.prototype.prepareSectors=function(){this.determineSectors(),this.crossesAntiMeridian?this.sectorsOverAntiMeridian():this.sectorsNotOverAntiMeridian()},d.prototype.determineSectors=function(){for(var t=0,e=this.contours.length;t<e;t++){var r=this.contours[t],n=r.polygons;r.sectors=[];for(var o=0,a=n.length;o<a;o++){var s=n[o],l=new u(0,0,0,0);if(l.setToBoundingSector(s),this._pathType===WorldWind.GREAT_CIRCLE){var c=i.greatCircleArcExtremeLocations(s),h=Math.min(l.minLatitude,c[0].latitude),f=Math.max(l.maxLatitude,c[1].latitude);l.minLatitude=h,l.maxLatitude=f}r.sectors.push(l)}}},d.prototype.sectorsOverAntiMeridian=function(){for(var t=new u(90,-90,180,-180),e=new u(90,-90,180,-180),r=0,i=this.contours.length;r<i;r++)for(var n=this.contours[r].sectors,o=0,a=n.length;o<a;o++){var s=n[o];s.minLongitude<0&&s.maxLongitude>0?(e.union(s),t.union(s)):s.minLongitude<0?e.union(s):t.union(s)}var l=Math.min(t.minLatitude,e.minLatitude),c=Math.max(t.maxLatitude,t.maxLatitude);this._sector=new u(l,c,-180,180),this._sectors=[t,e]},d.prototype.sectorsNotOverAntiMeridian=function(){this._sector=new u(90,-90,180,-180);for(var t=0,e=this.contours.length;t<e;t++)for(var r=this.contours[t].sectors,i=0,n=r.length;i<n;i++)this._sector.union(r[i]);this._sectors=[this._sector]},d.prototype.prepareGeometry=function(t,e){for(var r=[],n=[],o=0,a=e.length;o<a;o++)for(var s=e[o],l=s.poleIndex,u=0,c=s.polygons.length;u<c;u++){var h=s.polygons[u],f=s.iMap[u];r.push(h),s.pole!==i.poles.NONE&&c>1?u===l?this.outlineForPole(h,f,n):this.outlineForSplit(h,f,n):s.pole!==i.poles.NONE&&1===c?this.outlineForPole(h,f,n):s.pole===i.poles.NONE&&c>1?this.outlineForSplit(h,f,n):s.pole===i.poles.NONE&&1===c&&n.push(h)}this._interiorGeometry=r,this._outlineGeometry=n},d.prototype.outlineForPole=function(t,e,r){this.containsPole=!0;for(var i=[],n=0,o=0,a=t.length;o<a;o++){var s=t[o],l=e.get(o);l&&l.forPole&&(n++,n%2===1&&(i.push(s),r.push(i),i=[])),n%2===0&&i.push(s)}i.length&&r.push(i)},d.prototype.outlineForSplit=function(t,e,r){for(var i=[],n=0,o=0,a=t.length;o<a;o++){var s=t[o],l=e.get(o);l&&!l.forPole&&(n++,n%2===0&&(i.push(s),r.push(i),i=[])),n%2===1&&i.push(s)}},d.prototype.resetPickColor=function(){this.pickColor=null},d.prototype.renderToTexture=function(t,e,r,i,n,o){var s=this._highlighted?this._highlightAttributes||this._attributes:this._attributes,l=!this._isInteriorInhibited&&s.drawInterior,u=s.drawOutline&&s.outlineWidth>0;if(l||u){if(t.pickingMode&&!this.pickColor&&(this.pickColor=t.uniquePickColor()),t.pickingMode)var c=this.pickColor.toHexString();if(this.crossesAntiMeridian||this.containsPole?(l&&(this.draw(this._interiorGeometry,e,r,i,n,o),e.fillStyle=t.pickingMode?c:s.interiorColor.toRGBAString(),e.fill()),u&&(this.draw(this._outlineGeometry,e,r,i,n,o),e.lineWidth=s.outlineWidth,e.strokeStyle=t.pickingMode?c:s.outlineColor.toRGBAString(),e.stroke())):(this.draw(this._interiorGeometry,e,r,i,n,o),l&&(e.fillStyle=t.pickingMode?c:s.interiorColor.toRGBAString(),e.fill()),u&&(e.lineWidth=s.outlineWidth,e.strokeStyle=t.pickingMode?c:s.outlineColor.toRGBAString(),e.stroke())),t.pickingMode){var h=new a(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);t.resolvePick(h)}}},d.prototype.draw=function(t,e,r,i,n,o){e.beginPath();for(var a=0,s=t.length;a<s;a++){var l=t[a],u=l[0],c=u.longitude*r+n,h=u.latitude*i+o;e.moveTo(c,h);for(var f=1,d=l.length;f<d;f++)u=l[f],c=u.longitude*r+n,h=u.latitude*i+o,e.lineTo(c,h)}},d.DEFAULT_NUM_EDGE_INTERVALS=128,d.DEFAULT_POLAR_THROTTLE=10,d}),define("worldwind/shapes/SurfaceShapeTile",["../geom/Angle","../error/ArgumentError","../util/Level","../util/Logger","../geom/Sector","../render/Texture","../render/TextureTile"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,e,r,i){a.call(this,t,e,r,i),this.surfaceShapes=[],this.surfaceShapeStateKeys=[],this.asRenderedSurfaceShapeStateKeys=[],this.sector=t,this.cacheKey=null,this.pickSequence=0,this.createCtx2D()};return s.prototype=Object.create(a.prototype),s.prototype.clearShapes=function(){this.surfaceShapes=[],this.surfaceShapeStateKeys=[]},s.prototype.hasShapes=function(){return this.surfaceShapes.length>0},s.prototype.getShapes=function(){return this.surfaceShapes},s.prototype.setShapes=function(t){this.surfaceShapes=t},s.prototype.getSector=function(){return this.sector},s.prototype.addSurfaceShape=function(t){this.surfaceShapes.push(t),this.surfaceShapeStateKeys.push(t.stateKey)},s.prototype.needsUpdate=function(t){var e,r;if(this.surfaceShapes.length!=this.asRenderedSurfaceShapeStateKeys.length)return!0;for(e=0,r=this.surfaceShapes.length;e<r;e+=1)if(this.surfaceShapeStateKeys[e]!==this.asRenderedSurfaceShapeStateKeys[e])return!0;return!this.hasTexture(t)},s.prototype.hasTexture=function(t){if(t.pickingMode)return!1;this.gpuCacheKey||(this.gpuCacheKey=this.getCacheKey());var e=t.gpuResourceCache,r=e.resourceForKey(this.gpuCacheKey);return!!r},s.prototype.updateTexture=function(t){var e=t.currentGlContext,r=s.canvas,i=s.ctx2D;r.width=this.tileWidth,r.height=this.tileHeight;var n=this.tileWidth/this.sector.deltaLongitude(),a=-this.tileHeight/this.sector.deltaLatitude(),l=-this.sector.minLongitude*n,u=-this.sector.maxLatitude*a;this.asRenderedSurfaceShapeStateKeys=[];for(var c=0,h=this.surfaceShapes.length;c<h;c+=1){var f=this.surfaceShapes[c];this.asRenderedSurfaceShapeStateKeys.push(this.surfaceShapeStateKeys[c]),f.renderToTexture(t,i,n,a,l,u)}this.gpuCacheKey=this.getCacheKey();var d=t.gpuResourceCache,p=new o(e,r);return d.putResource(this.gpuCacheKey,p,p.size),p},s.prototype.getCacheKey=function(){return this.cacheKey||(this.cacheKey="SurfaceShapeTile:"+this.tileKey+","+this.pickSequence.toString()),this.cacheKey},s.prototype.createCtx2D=function(){s.ctx2D||(s.canvas=document.createElement("canvas"),s.ctx2D=s.canvas.getContext("2d"))},s.canvas=null,s.ctx2D=null,s}),define("worldwind/shapes/SurfaceShapeTileBuilder",["../error/ArgumentError","../render/DrawContext","../globe/Globe","../shaders/GpuProgram","../util/Level","../util/LevelSet","../geom/Location","../util/Logger","../geom/Matrix","../cache/MemoryCache","../navigate/NavigatorState","../error/NotYetImplementedError","../pick/PickedObject","../geom/Rectangle","../geom/Sector","../shapes/SurfaceShape","../shapes/SurfaceShapeTile","../globe/Terrain","../globe/TerrainTile","../globe/TerrainTileList","../render/TextureTile","../util/Tile"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E,w){"use strict";var _=function(){this.numRowsTilesInTopLevel=4,this.numColumnsTilesInTopLevel=8,this.maximumSubdivisionDepth=15,this.tileWidth=256,this.tileHeight=256,this.levels=new o(p.FULL_SPHERE,new a(180/this.numRowsTilesInTopLevel,360/this.numColumnsTilesInTopLevel),this.maximumSubdivisionDepth,this.tileWidth,this.tileHeight),this.surfaceShapes=[],this.surfaceShapeTiles=[],this.topLevelTiles=[],this.sector=new p(-90,90,-180,180),this.detailControl=1.25,this.tileCache=new u(5e5,4e5)};return _.prototype.clear=function(){this.surfaceShapeTiles.splice(0,this.surfaceShapeTiles.length),this.surfaceShapes.splice(0,this.surfaceShapes.length)},_.prototype.insertSurfaceShape=function(t){this.surfaceShapes.push(t)},_.prototype.doRender=function(t){if(t.pickingMode){for(var e=0,r=this.surfaceShapes.length;e<r;e+=1)this.surfaceShapes[e].resetPickColor();_.pickSequence+=1;var i=this.surfaceShapeTiles,n=this.topLevelTiles;this.surfaceShapeTiles=[],this.topLevelTiles=[],this.buildTiles(t),t.deepPicking?this.doDeepPickingRender(t):t.surfaceTileRenderer.renderTiles(t,this.surfaceShapeTiles,1),this.surfaceShapeTiles=i,this.topLevelTiles=n}else this.buildTiles(t),t.surfaceTileRenderer.renderTiles(t,this.surfaceShapeTiles,1)},_.prototype.doDeepPickingRender=function(t){var e,r,i,n,o,a,s,l,u,c=[];for(o=0,a=t.objectsAtPickPoint.objects.length;o<a;o+=1)s=t.objectsAtPickPoint.objects[o],s.userObject instanceof g&&(l=s.userObject,c.indexOf(l)<0&&(c.push(l),t.objectsAtPickPoint.objects.splice(o,1),o-=1,a-=1));if(!(c.length<=0)){var h=[];for(i=0,n=c.length;i<n;i+=1){for(l=c[i],e=0,r=this.surfaceShapeTiles.length;e<r;e+=1)u=this.surfaceShapeTiles[e],u.setShapes([l]),u.updateTexture(t);t.surfaceTileRenderer.renderTiles(t,this.surfaceShapeTiles,1);var d=t.readPickColor(t.pickPoint);d&&l.pickColor.equals(d)&&(s=new f(l.pickColor.clone(),l.pickDelegate?l.pickDelegate:l,null,l.layer,!1),h.push(s))}for(o=0,a=t.objectsAtPickPoint.objects.length;o<a;o+=1)s=t.objectsAtPickPoint.objects[o],s.userObject instanceof g&&(t.objectsAtPickPoint.objects.splice(o,1),o-=1,a-=1);for(o=0,a=h.length;o<a;o+=1)s=h[o],t.objectsAtPickPoint.objects.push(s)}},_.prototype.buildTiles=function(e){if(!e)throw new t(s.logMessage(s.LEVEL_SEVERE,"SurfaceShapeTileBuilder","buildTiles","missingDc"));if(this.surfaceShapes&&!(this.surfaceShapes.length<1)){this.assembleTiles(e),this.surfaceShapes.splice(0,this.surfaceShapes.length);for(var r=0,i=this.surfaceShapeTiles.length;r<i;r+=1){var n=this.surfaceShapeTiles[r];n.clearShapes()}}},_.prototype.assembleTiles=function(t){var e,r,i,n,o,a,s;this.topLevelTiles.length<1&&this.createTopLevelTiles();var l={};for(r=0,i=this.surfaceShapes.length;r<i;r+=1){var u=this.surfaceShapes[r],c=u.computeSectors(t);if(c)for(a=0,s=c.length;a<s;a+=1){var h=c[a];for(n=0,o=this.topLevelTiles.length;n<o;n+=1)if(e=this.topLevelTiles[n],e.sector.intersects(h)){var f=e.tileKey;l[f]=e,e.addSurfaceShape(u)}}}for(var d in l)l.hasOwnProperty(d)&&(e=l[d],this.addTileOrDescendants(t,this.levels,null,e))},_.prototype.addTileOrDescendants=function(t,e,r,i){if(!this.intersectsFrustum(t,i))return void i.clearShapes();if(null!=r&&this.addIntersectingShapes(t,r,i),i.hasShapes()){if(this.meetsRenderCriteria(t,e,i))return void this.addTile(t,i);for(var n=e.level(i.level.levelNumber+1),o=t.pickingMode?i.subdivide(n,this):i.subdivideToCache(n,this,this.tileCache),a=0,s=o.length;a<s;a+=1){var l=o[a];this.addTileOrDescendants(t,e,i,l)}i.clearShapes()}},_.prototype.addIntersectingShapes=function(t,e,r){for(var i=e.getShapes(),n=0,o=i.length;n<o;n+=1){var a=i[n],s=a.computeSectors(t);if(s)for(var l=0,u=s.length;l<u;l+=1){var c=s[l];if(r.getSector().intersects(c)){r.addSurfaceShape(a);break}}}},_.prototype.addTile=function(t,e){t.pickingMode&&(e.pickSequence=_.pickSequence),e.needsUpdate(t)&&e.updateTexture(t),this.surfaceShapeTiles.push(e)},_.prototype.createTile=function(t,e,r,i){return new m(t,e,r,i)},_.prototype.createTopLevelTiles=function(){w.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)},_.prototype.intersectsFrustum=function(t,e){return!(t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits))&&(e.update(t),
e.extent.intersectsFrustum(t.pickingMode?t.pickFrustum:t.navigatorState.frustumInModelCoordinates))},_.prototype.meetsRenderCriteria=function(t,e,r){return r.level.levelNumber==e.lastLevel().levelNumber||!r.mustSubdivide(t,this.detailControl)},_.pickSequence=0,_}),define("worldwind/shaders/SurfaceTileRendererProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(t,e,r,i){"use strict";var n=function(t){var e="attribute vec4 vertexPoint;\nattribute vec4 vertexTexCoord;\nuniform mat4 mvpMatrix;\nuniform mat4 texSamplerMatrix;\nuniform mat4 texMaskMatrix;\nvarying vec2 texSamplerCoord;\nvarying vec2 texMaskCoord;\nvoid main() {\ngl_Position = mvpMatrix * vertexPoint;\ntexSamplerCoord = (texSamplerMatrix * vertexTexCoord).st;\ntexMaskCoord = (texMaskMatrix * vertexTexCoord).st;\n}",i="precision mediump float;\nuniform sampler2D texSampler;\nuniform float opacity;\nuniform vec4 color;\nuniform bool modulateColor;\nvarying vec2 texSamplerCoord;\nvarying vec2 texMaskCoord;\nbool isInsideTextureImage(const vec2 coord) {\n    return coord.x >= 0.0 && coord.x <= 1.0 && coord.y >= 0.0 && coord.y <= 1.0;\n}\nvoid main(void) {\nfloat mask = float(isInsideTextureImage(texMaskCoord));if (modulateColor) {\n    gl_FragColor = color * mask * floor(texture2D(texSampler, texSamplerCoord).a + 0.5);\n} else {\n    gl_FragColor = texture2D(texSampler, texSamplerCoord) * mask * opacity;\n}\n}";r.call(this,t,e,i),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.vertexTexCoordLocation=this.attributeLocation(t,"vertexTexCoord"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.colorLocation=this.uniformLocation(t,"color"),this.modulateColorLocation=this.uniformLocation(t,"modulateColor"),this.texSamplerMatrixLocation=this.uniformLocation(t,"texSamplerMatrix"),this.texMaskMatrixLocation=this.uniformLocation(t,"texMaskMatrix"),this.texSamplerLocation=this.uniformLocation(t,"texSampler"),this.opacityLocation=this.uniformLocation(t,"opacity"),this.vertexPointLocation=-1};return n.key="WorldWindGpuSurfaceTileRenderingProgram",n.prototype=Object.create(r.prototype),n.prototype.loadModelviewProjection=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,r,this.mvpMatrixLocation)},n.prototype.loadTexSamplerMatrix=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadTexSamplerMatrix","missingMatrix"));this.loadUniformMatrix(e,r,this.texSamplerMatrixLocation)},n.prototype.loadTexMaskMatrix=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadTexMaskMatrix","missingMatrix"));this.loadUniformMatrix(e,r,this.texMaskMatrixLocation)},n.prototype.loadTexSampler=function(t,e){t.uniform1i(this.texSamplerLocation,e-WebGLRenderingContext.TEXTURE0)},n.prototype.loadOpacity=function(t,e){t.uniform1f(this.opacityLocation,e)},n.prototype.loadColor=function(e,r){if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadColor","missingColor"));this.loadUniformColor(e,r,this.colorLocation)},n.prototype.loadModulateColor=function(t,e){t.uniform1i(this.modulateColorLocation,e?1:0)},n}),define("worldwind/render/SurfaceTileRenderer",["../error/ArgumentError","../util/Logger","../geom/Matrix","../shapes/SurfaceShapeTile","../shaders/SurfaceTileRendererProgram"],function(t,e,r,i,n){"use strict";var o=function(){this.texMaskMatrix=r.fromIdentity(),this.texSamplerMatrix=r.fromIdentity(),this.isSurfaceShapeTileRendering=!1};return o.prototype.renderTiles=function(r,n,o,a){if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceTileRenderer","renderTiles","Specified surface tiles array is null or undefined."));if(!(n.length<1)){var s,l,u,c,h=r.terrain,f=r.currentGlContext,d=0,p=1;if(h){this.isSurfaceShapeTileRendering=n[0]instanceof i,o*=r.surfaceOpacity,s=this.beginRendering(r,o),h.beginRendering(r);try{for(var g=0,m=h.surfaceGeometry.length;g<m;g++){l=h.surfaceGeometry[g],u=l.sector,h.beginRenderingTile(r,l);try{for(var y=0,v=n.length;y<v;y++)c=n[y],c.sector.overlaps(u)&&c.bind(r)&&(r.pickingMode?c.pickColor&&s.loadColor(f,c.pickColor):a&&c.opacity!=p&&(s.loadOpacity(f,o*c.opacity),p=c.opacity),this.applyTileState(r,l,c),h.renderTile(r,l),++d)}catch(t){console.log(t)}finally{h.endRenderingTile(r,l)}}}catch(t){console.log(t)}finally{h.endRendering(r),this.endRendering(r),r.frameStatistics.incrementRenderedTileCount(d)}}}},o.prototype.beginRendering=function(t,e){var r=t.currentGlContext,i=t.findAndBindProgram(n);return i.loadTexSampler(r,r.TEXTURE0),t.pickingMode&&!this.isSurfaceShapeTileRendering?i.loadModulateColor(r,!0):(i.loadModulateColor(r,!1),i.loadOpacity(r,e)),i},o.prototype.endRendering=function(t){var e=t.currentGlContext;e.bindTexture(e.TEXTURE_2D,null)},o.prototype.applyTileState=function(t,e,r){var i=t.currentGlContext,n=t.currentProgram,o=e.sector,a=o.deltaLatitude(),s=o.deltaLongitude(),l=r.sector,u=l.deltaLatitude(),c=l.deltaLongitude(),h=u>0?u:1,f=c>0?c:1,d=s/f,p=a/h,g=-(l.minLongitude-o.minLongitude)/f,m=-(l.minLatitude-o.minLatitude)/h;this.texMaskMatrix.set(d,0,0,g,0,p,0,m,0,0,1,0,0,0,0,1),this.texSamplerMatrix.setToUnitYFlip(),r.applyInternalTransform(t,this.texSamplerMatrix),this.texSamplerMatrix.multiplyMatrix(this.texMaskMatrix),n.loadTexSamplerMatrix(i,this.texSamplerMatrix),n.loadTexMaskMatrix(i,this.texMaskMatrix)},o}),define("worldwind/render/TextSupport",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Logger","../geom/Matrix","../render/Texture","../geom/Vec2"],function(t,e,r,i,n,o,a){"use strict";var s=function(){this.canvas2D=document.createElement("canvas"),this.ctx2D=this.canvas2D.getContext("2d"),this.lineSpacing=.15,this.strokeStyle="rgba(0, 0, 0, 0.5)",this.strokeWidth=4};return s.prototype.textSize=function(t,e,r){if(0===t.length)return new a(0,0);this.ctx2D.font=e.fontString;for(var i=t.split("\n"),n=i.length*(e.size*(1+this.lineSpacing)),o=0,s=0;s<i.length;s++)o=Math.max(o,this.ctx2D.measureText(i[s]).width);return r&&(o+=this.strokeWidth,n+=this.strokeWidth),new a(o,n)},s.prototype.createTexture=function(t,e,i,n){var a=t.currentGlContext,s=this.ctx2D,l=this.canvas2D,u=this.textSize(e,i,n),c=e.split("\n"),h=n?this.strokeWidth/2:0,f=t.pixelScale;l.width=Math.ceil(u[0])*f,l.height=Math.ceil(u[1])*f,s.scale(f,f),s.font=i.fontString,s.textBaseline="top",s.textAlign=i.horizontalAlignment,s.fillStyle=r.WHITE.toHexString(!1),s.strokeStyle=this.strokeStyle,s.lineWidth=this.strokeWidth,s.lineCap="round",s.lineJoin="round","left"===i.horizontalAlignment?s.translate(h,0):"right"===i.horizontalAlignment?s.translate(u[0]-h,0):s.translate(u[0]/2,0);for(var d=0;d<c.length;d++)n&&s.strokeText(c[d],0,0),s.fillText(c[d],0,0),s.translate(0,i.size*(1+this.lineSpacing)+h);return new o(a,l)},s.prototype.getMaxLineHeight=function(t){return this.textSize("_É",t,0)[1]},s.prototype.wrap=function(e,r,n,o){if(!e)throw new t(i.logMessage(i.WARNING,"TextSupport","wrap","missing text"));var a,s=e.split("\n"),l="";for(a=0;a<s.length;a++)s[a]=this.wrapLine(s[a],r,o);var u=0,c=!1,h=this.getMaxLineHeight(o);for(a=0;a<s.length&&!c;a++){for(var f=s[a].split("\n"),d=0;d<f.length&&!c;d++)n<=0||u+h<=n?(l+=f[d],u+=h+this.lineSpacing,d<f.length-1&&(l+="\n")):c=!0;a<s.length-1&&!c&&(l+="\n")}return c&&(l.length>0&&(l=l.substring(0,l.length-1)),l+="..."),l},s.prototype.wrapLine=function(t,e,r){var i="",n=t.trim(),o=this.textSize(n,r,0);if(o[0]>e){for(var a="",s=0,l=n.indexOf(" ",s+1);s<n.length;){l==-1&&(l=n.length);var u=n.substring(s,l),c=a+u;this.textSize(c,r,0)[0]<=e?a+=u:0!=a.length?(i+=a,i+="\n",a="",a+=u.trim()):a+=u.trim(),s=l,s<n.length-1&&(l=n.indexOf(" ",s+1))}i+=a}else i+=n;return i},s}),define("worldwind/render/DrawContext",["../error/ArgumentError","../util/Color","../util/FrameStatistics","../render/FramebufferTexture","../render/FramebufferTileController","../geom/Frustum","../globe/Globe","../shaders/GpuProgram","../cache/GpuResourceCache","../layer/Layer","../util/Logger","../geom/Matrix","../navigate/NavigatorState","../pick/PickedObjectList","../geom/Plane","../geom/Position","../geom/Rectangle","../render/ScreenCreditController","../geom/Sector","../shapes/SurfaceShape","../shapes/SurfaceShapeTileBuilder","../render/SurfaceTileRenderer","../render/TextSupport","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E,w,_,x,S,T){"use strict";var M=function(r){if(!r)throw new t(c.logMessage(c.LEVEL_SEVERE,"Texture","constructor","missingGlContext"));this.currentGlContext=r,this.canvas2D=document.createElement("canvas"),this.ctx2D=this.canvas2D.getContext("2d"),this.clearColor=e.TRANSPARENT,this.gpuResourceCache=new l(WorldWind.configuration.gpuCacheSize,.8*WorldWind.configuration.gpuCacheSize),this.surfaceTileRenderer=new w,this.surfaceShapeTileBuilder=new E,this.surfaceShapeTileController=new n,this.screenCreditController=new y,this.textSupport=new _,this.currentFramebuffer=null,this.currentProgram=null,this.surfaceRenderables=[],this.orderedRenderingMode=!1,this.orderedRenderables=[],this.screeRenderables=[],this.orderedRenderablesCounter=0,this.timestamp=Date.now(),this.previousRedrawTimestamp=this.timestamp,this.redrawRequested=!1,this.globe=null,this.globeStateKey=null,this.layers=null,this.currentLayer=null,this.navigatorState=null,this.eyePosition=new g(0,0,0),this.screenProjection=h.fromIdentity(),this.terrain=null,this.verticalExaggeration=1,this.fadeTime=500,this.surfaceOpacity=1,this.frameStatistics=null,this.pickingMode=!1,this.pickTerrainOnly=!1,this.deepPicking=!1,this.regionPicking=!1,this.pickPoint=null,this.pickRectangle=null,this.pickFramebuffer=null,this.pickFrustum=null,this.pickColor=new e(0,0,0,1),this.objectsAtPickPoint=new d,this.pixelScale=1};return M.unitCubeKey="DrawContextUnitCubeKey",M.unitCubeElementsKey="DrawContextUnitCubeElementsKey",M.unitQuadKey="DrawContextUnitQuadKey",M.unitQuadKey3="DrawContextUnitQuadKey3",M.prototype.reset=function(){this.screenCreditController.clear(),this.surfaceRenderables=[],this.orderedRenderingMode=!1,this.orderedRenderables=[],this.screenRenderables=[],this.orderedRenderablesCounter=0;var t=this.timestamp;this.timestamp=Date.now(),this.timestamp===t&&++this.timestamp,this.redrawRequested=!1,this.globe=null,this.globeStateKey=null,this.layers=null,this.currentLayer=null,this.navigatorState=null,this.terrain=null,this.verticalExaggeration=1,this.frameStatistics=null,this.accumulateOrderedRenderables=!0,this.pickingMode=!1,this.pickTerrainOnly=!1,this.deepPicking=!1,this.regionPicking=!1,this.pickPoint=null,this.pickRectangle=null,this.pickFrustum=null,this.pickColor=new e(0,0,0,1),this.objectsAtPickPoint.clear()},M.prototype.update=function(){var t=this.currentGlContext,e=this.navigatorState.eyePoint;this.globeStateKey=this.globe.stateKey,this.globe.computePositionFromPoint(e[0],e[1],e[2],this.eyePosition),this.screenProjection.setToScreenProjection(t.drawingBufferWidth,t.drawingBufferHeight)},M.prototype.contextLost=function(){this.gpuResourceCache.clear(),this.pickFramebuffer=null,this.currentFramebuffer=null,this.currentProgram=null},M.prototype.contextRestored=function(){this.gpuResourceCache.clear()},M.prototype.bindFramebuffer=function(t){this.currentFramebuffer!=t&&(this.currentGlContext.bindFramebuffer(this.currentGlContext.FRAMEBUFFER,t?t.framebufferId:null),this.currentFramebuffer=t)},M.prototype.bindProgram=function(t){this.currentProgram!=t&&(this.currentGlContext.useProgram(t?t.programId:null),this.currentProgram=t)},M.prototype.findAndBindProgram=function(e){if(!e)throw new t(c.logMessage(c.LEVEL_SEVERE,"DrawContext","findAndBindProgram","The specified program constructor is null or undefined."));var r=this.gpuResourceCache.resourceForKey(e.key);if(r)this.bindProgram(r);else try{r=new e(this.currentGlContext),this.bindProgram(r),this.gpuResourceCache.putResource(e.key,r,r.size)}catch(t){c.log(c.LEVEL_SEVERE,"Error attempting to create GPU program.")}return r},M.prototype.addSurfaceRenderable=function(t){t&&this.surfaceRenderables.push(t)},M.prototype.peekSurfaceRenderable=function(){return this.surfaceRenderables.length>0?this.surfaceRenderables[this.surfaceRenderables.length-1]:null},M.prototype.popSurfaceRenderable=function(){return this.surfaceRenderables.length>0?this.surfaceRenderables.pop():null},M.prototype.reverseSurfaceRenderables=function(){this.surfaceRenderables.reverse()},M.prototype.addOrderedRenderable=function(t,e){if(t){var r={orderedRenderable:t,insertionOrder:this.orderedRenderablesCounter++,eyeDistance:e||t.eyeDistance,globeStateKey:this.globeStateKey};this.globe.continuous&&(r.globeOffset=this.globe.offset),0===r.eyeDistance?this.screenRenderables.push(r):this.orderedRenderables.push(r)}},M.prototype.addOrderedRenderableToBack=function(t){if(t){var e={orderedRenderable:t,insertionOrder:this.orderedRenderablesCounter++,eyeDistance:Number.MAX_VALUE,globeStateKey:this.globeStateKey};this.globe.continuous&&(e.globeOffset=this.globe.offset),this.orderedRenderables.push(e)}},M.prototype.peekOrderedRenderable=function(){return this.orderedRenderables.length>0?this.orderedRenderables[this.orderedRenderables.length-1].orderedRenderable:null},M.prototype.popOrderedRenderable=function(){if(this.orderedRenderables.length>0){var t=this.orderedRenderables.pop();return this.globeStateKey=t.globeStateKey,this.globe.continuous&&(this.globe.offset=t.globeOffset),t.orderedRenderable}return null},M.prototype.nextScreenRenderable=function(){if(this.screenRenderables.length>0){var t=this.screenRenderables.shift();return this.globeStateKey=t.globeStateKey,this.globe.continuous&&(this.globe.offset=t.globeOffset),t.orderedRenderable}return null},M.prototype.sortOrderedRenderables=function(){this.orderedRenderables.sort(function(t,e){var r=t.eyeDistance,i=e.eyeDistance;if(r<i)return-1;if(r>i)return 1;var n=t.insertionOrder,o=e.insertionOrder;return n>o?-1:n<o?1:0})},M.prototype.readPickColor=function(t){var r=this.navigatorState.convertPointToViewport(t,new x(0,0)),i=new Uint8Array(4);return this.currentGlContext.readPixels(r[0],r[1],1,1,this.currentGlContext.RGBA,this.currentGlContext.UNSIGNED_BYTE,i),this.clearColor.equalsBytes(i)?null:e.colorFromByteArray(i)},M.prototype.readPickColors=function(t){var r,i=this.currentGlContext,n=new Uint8Array(t.width*t.height*4),o={},a=new e(0,0,0,0),s=i.getParameter(i.PACK_ALIGNMENT);i.pixelStorei(i.PACK_ALIGNMENT,1),this.currentGlContext.readPixels(t.x,t.y,t.width,t.height,i.RGBA,i.UNSIGNED_BYTE,n),i.pixelStorei(i.PACK_ALIGNMENT,s);for(var l=0,u=t.width*t.height;l<u;l++){var c=4*l;r=e.colorFromBytes(n[c],n[c+1],n[c+2],n[c+3]),r.equals(this.clearColor)||r.equals(a)||(o[r.toByteString()]=r)}return o},M.prototype.resolvePick=function(t){if(t.userObject instanceof b||!this.deepPicking||this.regionPicking)this.addPickedObject(t);else{var e=this.readPickColor(this.pickPoint);if(!e)return null;t.color.equals(e)&&this.addPickedObject(t)}},M.prototype.addPickedObject=function(t){t&&this.objectsAtPickPoint.add(t)},M.prototype.uniquePickColor=function(){var t=this.pickColor.nextColor().clone();return t.equals(this.clearColor)?t.nextColor():t},M.prototype.makePickFramebuffer=function(){var t=this.currentGlContext,e=t.drawingBufferWidth,r=t.drawingBufferHeight;return this.pickFramebuffer&&this.pickFramebuffer.width==e&&this.pickFramebuffer.height==r||(this.pickFramebuffer=new i(t,e,r,!0)),this.pickFramebuffer},M.prototype.makePickFrustum=function(){if(!this.pickPoint&&!this.pickRectangle)return!1;var t,e,r,i,n,a,s,l,u,c,h,f,d,g,y,v,b,E,w,_,M,L,A=new S(0,0,0),N=2,C=new S(0,0,0),R=this.pickRectangle,P=this.navigatorState.viewport;R||(L=this.navigatorState.convertPointToViewport(this.pickPoint,new x(0,0)),R=new m(L[0]-N,L[1]-N,2*N,2*N));var O=R.x,I=R.x+R.width,k=R.y,D=R.y+R.height;return!(I<0||D<0||O>P.x+P.width||k>P.y+P.height)&&(R.x=T.clamp(O,P.x,P.x+P.width),R.y=T.clamp(k,P.y,P.y+P.height),R.width=T.clamp(I,P.x,P.x+P.width)-R.x,R.height=T.clamp(D,P.y,P.y+P.height)-R.y,this.pickRectangle=R,C[0]=R.x,C[1]=R.y,C[2]=0,this.navigatorState.unProject(C,t=new S(0,0,0)),C[0]=R.x,C[1]=R.y,C[2]=1,this.navigatorState.unProject(C,e=new S(0,0,0)),C[0]=R.x+R.width,C[1]=R.y,C[2]=0,this.navigatorState.unProject(C,r=new S(0,0,0)),C[0]=R.x+R.width,C[1]=R.y,C[2]=1,this.navigatorState.unProject(C,i=new S(0,0,0)),C[0]=R.x,C[1]=R.y+R.height,C[2]=0,this.navigatorState.unProject(C,n=new S(0,0,0)),C[0]=R.x,C[1]=R.y+R.height,C[2]=1,this.navigatorState.unProject(C,a=new S(0,0,0)),C[0]=R.x+R.width,C[1]=R.y+R.height,C[2]=0,this.navigatorState.unProject(C,s=new S(0,0,0)),C[0]=R.x+R.width,C[1]=R.y+R.height,C[2]=1,this.navigatorState.unProject(C,l=new S(0,0,0)),M=new S(a[0]-t[0],a[1]-t[1],a[2]-t[2]),A.set(n[0]-e[0],n[1]-e[1],n[2]-e[2]),u=M.cross(A),y=new p(u[0],u[1],u[2],-u.dot(t)),y.normalize(),M=new S(s[0]-i[0],s[1]-i[1],s[2]-i[2]),A.set(l[0]-r[0],l[1]-r[1],l[2]-r[2]),c=M.cross(A),v=new p(c[0],c[1],c[2],-c.dot(r)),v.normalize(),M=new S(a[0]-s[0],a[1]-s[1],a[2]-s[2]),A.set(l[0]-n[0],l[1]-n[1],l[2]-n[2]),h=M.cross(A),b=new p(h[0],h[1],h[2],-h.dot(n)),b.normalize(),M=new S(i[0]-t[0],i[1]-t[1],i[2]-t[2]),A.set(e[0]-r[0],e[1]-r[1],e[2]-r[2]),f=M.cross(A),E=new p(f[0],f[1],f[2],-f.dot(r)),E.normalize(),M=new S(n[0]-r[0],n[1]-r[1],n[2]-r[2]),A.set(s[0]-t[0],s[1]-t[1],s[2]-t[2]),d=M.cross(A),w=new p(d[0],d[1],d[2],-d.dot(t)),w.normalize(),M=new S(l[0]-e[0],l[1]-e[1],l[2]-e[2]),A.set(a[0]-i[0],a[1]-i[1],a[2]-i[2]),g=M.cross(A),_=new p(g[0],g[1],g[2],-g.dot(e)),_.normalize(),this.pickFrustum=new o(y,v,E,b,w,_),!0)},M.prototype.isSmall=function(t,e){if(!t)return!1;var r=this.navigatorState.eyePoint.distanceTo(t.center),i=this.navigatorState.pixelSizeAtDistance(r);return 2*t.radius<e*i},M.prototype.unitCubeBuffer=function(){var t=this.gpuResourceCache.resourceForKey(M.unitCubeKey);if(!t){var e=this.currentGlContext,r=new Float32Array(24),i=0;r[i++]=0,r[i++]=1,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=1,r[i++]=1,r[i++]=0,r[i++]=1,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=1,r[i++]=1,r[i++]=0,r[i++]=0,r[i++]=1,r[i++]=1,r[i++]=1,r[i++]=1,r[i++]=1,r[i++]=0,r[i]=1,t=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(M.unitCubeKey,t,4*r.length)}return t},M.prototype.unitCubeElements=function(){var t=this.gpuResourceCache.resourceForKey(M.unitCubeElementsKey);if(!t){var e=this.currentGlContext,r=new Int16Array(60),i=0;r[i++]=1,r[i++]=0,r[i++]=3,r[i++]=3,r[i++]=0,r[i++]=2,r[i++]=4,r[i++]=5,r[i++]=6,r[i++]=6,r[i++]=5,r[i++]=7,r[i++]=5,r[i++]=1,r[i++]=7,r[i++]=7,r[i++]=1,r[i++]=3,r[i++]=6,r[i++]=2,r[i++]=4,r[i++]=4,r[i++]=2,r[i++]=0,r[i++]=4,r[i++]=0,r[i++]=5,r[i++]=5,r[i++]=0,r[i++]=1,r[i++]=7,r[i++]=3,r[i++]=6,r[i++]=6,r[i++]=3,r[i++]=2,r[i++]=0,r[i++]=1,r[i++]=1,r[i++]=3,r[i++]=3,r[i++]=2,r[i++]=2,r[i++]=0,r[i++]=4,r[i++]=5,r[i++]=5,r[i++]=7,r[i++]=7,r[i++]=6,r[i++]=6,r[i++]=4,r[i++]=0,r[i++]=4,r[i++]=5,r[i++]=1,r[i++]=2,r[i++]=6,r[i++]=7,r[i]=3,t=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(M.unitCubeElementsKey,t,2*r.length)}return t},M.prototype.unitQuadBuffer=function(){var t=this.gpuResourceCache.resourceForKey(M.unitQuadKey);if(!t){var e=this.currentGlContext,r=new Float32Array(8);r[0]=0,r[1]=1,r[2]=0,r[3]=0,r[4]=1,r[5]=1,r[6]=1,r[7]=0,t=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(M.unitQuadKey,t,4*r.length)}return t},M.prototype.unitQuadBuffer3=function(){var t=this.gpuResourceCache.resourceForKey(M.unitQuadKey3);if(!t){var e=this.currentGlContext,r=new Float32Array(12);r[0]=0,r[1]=1,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=1,r[7]=1,r[8]=0,r[9]=1,r[10]=0,r[11]=0,t=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(M.unitQuadKey3,t,4*r.length)}return t},M.prototype.surfacePointForMode=function(e,r,i,n,o){if(!o)throw new t(c.logMessage(c.LEVEL_SEVERE,"DrawContext","surfacePointForMode","missingResult"));if(this.terrain)this.terrain.surfacePointForMode(e,r,i,n,o);else{var a=i+this.globe.elevationAtLocation(e,r)*this.verticalExaggeration;this.globe.computePointFromPosition(e,r,a,o)}return o},M}),define("worldwind/globe/EarthElevationModel",["../geom/Location","../geom/Sector","../globe/ElevationModel","../util/WmsUrlBuilder"],function(t,e,r,i){"use strict";var n=function(){r.call(this,e.FULL_SPHERE,new t(45,45),12,"application/bil16","EarthElevations256",256,256),this.displayName="Earth Elevation Model",this.minElevation=-11e3,this.maxElevation=8850,this.pixelIsPoint=!1,this.urlBuilder=new i("https://worldwind26.arc.nasa.gov/elev","GEBCO,aster_v2,USGS-NED","","1.3.0")};return n.prototype=Object.create(r.prototype),n}),define("worldwind/globe/EarthRestElevationModel",["../geom/Location","../geom/Sector","../globe/ElevationModel","../util/LevelRowColumnUrlBuilder"],function(t,e,r,i){"use strict";var n=function(n,o,a){r.call(this,e.FULL_SPHERE,new t(60,60),5,"application/bil16","EarthElevations",512,512),this.displayName=a,this.minElevation=-11e3,this.maxElevation=8850,this.urlBuilder=new i(n,o)};return n.prototype=Object.create(r.prototype),n}),define("worldwind/layer/FrameStatisticsLayer",["../error/ArgumentError","../util/Color","../util/Font","../layer/Layer","../util/Logger","../util/Offset","../shapes/ScreenText","../shapes/TextAttributes"],function(t,e,r,i,n,o,a,s){"use strict";var l=function(l){function u(t,e){h.handleRedraw(t,e)}if(!l)throw new t(n.logMessage(n.LEVEL_SEVERE,"FrameStatisticsLayer","constructor","missingWorldWindow"));i.call(this,"Frame Statistics"),this.pickEnabled=!1;var c=new s(null);c.color=e.GREEN,c.font=new r(12),c.offset=new o(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,1),this.frameTime=new a(new o(WorldWind.OFFSET_PIXELS,5,WorldWind.OFFSET_INSET_PIXELS,5)," "),this.frameTime.attributes=c,this.frameRate=new a(new o(WorldWind.OFFSET_PIXELS,5,WorldWind.OFFSET_INSET_PIXELS,25)," "),this.frameRate.attributes=c;var h=this;l.redrawCallbacks.push(u)};return l.prototype=Object.create(i.prototype),l.prototype.doRender=function(t){this.frameRate.render(t),this.frameTime.render(t),this.inCurrentFrame=!0},l.prototype.handleRedraw=function(t,e){if(e==WorldWind.BEFORE_REDRAW){var r=t.frameStatistics;this.frameTime.text="Frame time  "+r.frameTimeAverage.toFixed(0)+" ms  ("+r.frameTimeMin.toFixed(0)+" - "+r.frameTimeMax.toFixed(0)+")",this.frameRate.text="Frame rate  "+r.frameRateAverage.toFixed(0)+" fps"}},l}),define("worldwind/shapes/AbstractShape",["../error/ArgumentError","../util/Logger","../geom/Matrix","../cache/MemoryCache","../render/Renderable","../shapes/ShapeAttributes","../error/UnsupportedOperationError","../geom/Vec3"],function(t,e,r,i,n,o,a,s){"use strict";var l=function(t){n.call(this),this._attributes=t?t:new o(null),this._highlightAttributes=null,this.highlighted=!1,this._altitudeMode=WorldWind.ABSOLUTE,this.referencePosition=null,this.shapeDataCache=new i(3,2),this.currentData=null,this.activeAttributes=null,this.expirationInterval=2e3,this.useSurfaceShapeFor2D=!1,this.scratchMatrix=r.fromIdentity()};return l.prototype=Object.create(n.prototype),Object.defineProperties(l.prototype,{attributes:{get:function(){return this._attributes},set:function(t){this._attributes=t,this.surfaceShape&&(this.surfaceShape.attributes=this._attributes)}},highlightAttributes:{get:function(){return this._highlightAttributes},set:function(t){this._highlightAttributes=t,this.surfaceShape&&(this.surfaceShape.highlightAttributes=this._highlightAttributes)}},altitudeMode:{get:function(){return this._altitudeMode},set:function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"AbstractShape","altitudeMode","missingAltitudeMode"));this._altitudeMode=r,this.reset()}}}),l.prototype.reset=function(){this.shapeDataCache.clear(!1),this.surfaceShape=null},l.prototype.updateSurfaceShape=function(){this.surfaceShape.displayName=this.displayName,this.surfaceShape.highlighted=this.highlighted,this.surfaceShape.enabled=this.enabled,this.surfaceShape.pathType=this.pathType,this.surfaceShape.pickDelegate=this.pickDelegate?this.pickDelegate:this},l.prototype.createSurfaceShape=function(){return null},l.prototype.render=function(t){if(this.enabled&&t.accumulateOrderedRenderables){if(t.globe.is2D()&&this.useSurfaceShapeFor2D&&(this.surfaceShape||(this.surfaceShape=this.createSurfaceShape(),this.surfaceShape&&(this.surfaceShape.attributes=this._attributes,this.surfaceShape.highlightAttributes=this._highlightAttributes)),this.surfaceShape))return this.updateSurfaceShape(),void this.surfaceShape.render(t);if((t.terrain||this.altitudeMode==WorldWind.ABSOLUTE)&&(this.establishCurrentData(t),(!t.globe.projectionLimits||this.isWithinProjectionLimits(t))&&(!this.currentData.extent||this.intersectsFrustum(t))&&(this.determineActiveAttributes(t),this.activeAttributes))){var e=this.makeOrderedRenderable(t);if(e){if(!this.intersectsFrustum(t))return;if(t.isSmall(this.currentData.extent,1))return;e.layer=t.currentLayer,t.addOrderedRenderable(e,this.currentData.eyeDistance)}}}},l.prototype.renderOrdered=function(t){this.currentData=this.shapeDataCache.entryForKey(t.globeStateKey),this.beginDrawing(t);try{this.doRenderOrdered(t)}finally{this.endDrawing(t)}},l.prototype.makeOrderedRenderable=function(t){var e=this.doMakeOrderedRenderable(t);return this.currentData.verticalExaggeration=t.verticalExaggeration,e},l.prototype.doMakeOrderedRenderable=function(t){throw new a(e.logMessage(e.LEVEL_SEVERE,"AbstractShape","makeOrderedRenderable","abstractInvocation"))},l.prototype.doRenderOrdered=function(t){throw new a(e.logMessage(e.LEVEL_SEVERE,"AbstractShape","doRenderOrdered","abstractInvocation"))},l.prototype.beginDrawing=function(t){},l.prototype.endDrawing=function(t){},l.prototype.intersectsFrustum=function(t){return!this.currentData||!this.currentData.extent||(t.pickingMode?this.currentData.extent.intersectsFrustum(t.pickFrustum):this.currentData.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates))},l.prototype.establishCurrentData=function(t){this.currentData=this.shapeDataCache.entryForKey(t.globeStateKey),this.currentData||(this.currentData=this.createShapeDataObject(),this.resetExpiration(this.currentData),this.shapeDataCache.putEntry(t.globeStateKey,this.currentData,1)),this.currentData.isExpired=!this.isShapeDataCurrent(t,this.currentData)},l.prototype.createShapeDataObject=function(){return{transformationMatrix:r.fromIdentity(),referencePoint:new s(0,0,0)}},l.prototype.resetExpiration=function(t){t.expiryTime=Date.now()+this.expirationInterval+1e3*Math.random()},l.prototype.isShapeDataCurrent=function(t,e){return e.verticalExaggeration===t.verticalExaggeration&&e.expiryTime>Date.now()},l.prototype.determineActiveAttributes=function(t){this.highlighted&&this._highlightAttributes?this.activeAttributes=this.highlightAttributes:this.activeAttributes=this._attributes},l.prototype.isWithinProjectionLimits=function(t){return!0},l.prototype.applyMvpMatrix=function(t){this.scratchMatrix.copy(t.navigatorState.modelviewProjection),this.scratchMatrix.multiplyMatrix(this.currentData.transformationMatrix),t.currentProgram.loadModelviewProjection(t.currentGlContext,this.scratchMatrix)},l.prototype.applyMvpMatrixForOutline=function(t){this.scratchMatrix.copy(t.navigatorState.projection),this.scratchMatrix.offsetProjectionDepth(-.001),this.scratchMatrix.multiplyMatrix(t.navigatorState.modelview),this.scratchMatrix.multiplyMatrix(this.currentData.transformationMatrix),t.currentProgram.loadModelviewProjection(t.currentGlContext,this.scratchMatrix)},l}),define("worldwind/shapes/AbstractMesh",["../shapes/AbstractShape","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Line","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g){"use strict";var m=function(e){t.call(this,e),this.pickTransparentImagePixels=!0,this._altitudeScale=1};return m.prototype=Object.create(t.prototype),Object.defineProperties(m.prototype,{altitudeScale:{get:function(){return this._altitudeScale},set:function(t){this._altitudeScale=t,this.reset()}}}),m.prototype.mustGenerateGeometry=function(t){return!this.currentData.meshPoints||(this.currentData.drawInterior!==this.activeAttributes.drawInterior||(!(!this.activeAttributes.applyLighting||this.currentData.normals)||this.altitudeMode!==WorldWind.ABSOLUTE&&this.currentData.isExpired))},m.prototype.doMakeOrderedRenderable=function(t){if(!this.activeAttributes.drawInterior&&!this.activeAttributes.drawOutline)return null;if(!this.mustGenerateGeometry(t))return this;var e=this.currentData,r=e.referencePoint;return t.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude*this._altitudeScale,this._altitudeMode,r),e.transformationMatrix.setToTranslation(r[0],r[1],r[2]),e.meshPoints=this.computeMeshPoints(t,e),e.refreshVertexBuffer=!0,this.activeAttributes.imageSource&&!this.texCoords&&(this.texCoords=this.computeTexCoords(),this.texCoords&&(e.refreshTexCoordBuffer=!0)),this.meshIndices||(this.meshIndices=this.computeMeshIndices(),e.refreshMeshIndices=!0),this.meshOutlineIndices||(this.meshOutlineIndices=this.computeOutlineIndices(),this.meshOutlineIndices&&(e.refreshOutlineIndices=!0)),this.activeAttributes.applyLighting&&this.computeNormals(e),e.drawInterior=this.activeAttributes.drawInterior,this.resetExpiration(e),e.extent||(e.extent=new i),e.extent.setToPoints(e.meshPoints),e.extent.translate(e.referencePoint),this},m.prototype.computeMeshPoints=function(t,e){throw new UnsupportedOperationError(l.logMessage(l.LEVEL_SEVERE,"AbstractMesh","computeMeshPoints","abstractInvocation"))},m.prototype.computeTexCoords=function(){return null},m.prototype.computeMeshIndices=function(t){throw new UnsupportedOperationError(l.logMessage(l.LEVEL_SEVERE,"AbstractMesh","computeMeshIndices","abstractInvocation"))},m.prototype.computeOutlineIndices=function(t){},m.prototype.computeNormals=function(t){for(var e,r=new Float32Array(t.meshPoints.length),i=this.meshIndices,n=t.meshPoints,o=[],a=[new p(0,0,0),new p(0,0,0),new p(0,0,0)],s=0;s<i.length;s+=3){for(var l=0;l<3;l++)e=i[s+l],a[l].set(n[3*e],n[3*e+1],n[3*e+2]);var u=p.computeTriangleNormal(a[0],a[1],a[2]);for(l=0;l<3;l++)e=i[s+l],o[e]||(o[e]=[]),o[e].push(u)}for(u=new p(0,0,0),s=0;s<o.length;s++)o[s]?(p.average(o[s],u),u.normalize(),r[3*s]=u[0],r[3*s+1]=u[1],r[3*s+2]=u[2]):(r[3*s]=0,r[3*s+1]=0,r[3*s+2]=0);t.normals=r,t.refreshNormalsBuffer=!0},m.prototype.doRenderOrdered=function(t){var e,r,i,n,o,a=t.currentGlContext,s=t.currentProgram,l=this.currentData,u=this.texCoords&&!!this.activeAttributes.imageSource;if(t.pickingMode&&(n=t.uniquePickColor()),l.pointsVboCacheKey||(l.pointsVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.pointsVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.pointsVboCacheKey,e,4*l.meshPoints.length),l.refreshVertexBuffer=!0),a.bindBuffer(a.ARRAY_BUFFER,e),l.refreshVertexBuffer&&(a.bufferData(a.ARRAY_BUFFER,l.meshPoints,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshVertexBuffer=!1),a.vertexAttribPointer(s.vertexPointLocation,3,a.FLOAT,!1,0,0),s.loadTextureEnabled(a,!1),this.activeAttributes.drawInterior){var h=!t.pickingMode&&l.normals&&this.activeAttributes.applyLighting;
this.applyMvpMatrix(t),l.meshIndicesVboCacheKey||(l.meshIndicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.meshIndicesVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.meshIndicesVboCacheKey,e,2*this.meshIndices.length),l.refreshMeshIndices=!0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),l.refreshMeshIndices&&(a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.meshIndices,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshMeshIndices=!1),i=this.activeAttributes.interiorColor,r=i.alpha*t.currentLayer.opacity,a.depthMask(r>=1||t.pickingMode),s.loadColor(a,t.pickingMode?n:i),s.loadOpacity(a,t.pickingMode?r>0?1:0:r),!u||t.pickingMode&&this.pickTransparentImagePixels||(this.activeTexture=t.gpuResourceCache.resourceForKey(this.activeAttributes.imageSource),this.activeTexture||(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.activeAttributes.imageSource)),o=this.activeTexture&&this.activeTexture.bind(t),o&&(l.texCoordsVboCacheKey||(l.texCoordsVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.texCoordsVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.texCoordsVboCacheKey,e,4*this.texCoords.length),l.refreshTexCoordBuffer=!0),a.bindBuffer(a.ARRAY_BUFFER,e),l.refreshTexCoordBuffer&&(a.bufferData(a.ARRAY_BUFFER,this.texCoords,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshTexCoordBuffer=!1),a.enableVertexAttribArray(s.vertexTexCoordLocation),a.vertexAttribPointer(s.vertexTexCoordLocation,2,a.FLOAT,!1,0,0),this.scratchMatrix.setToIdentity(),this.scratchMatrix.multiplyByTextureTransform(this.activeTexture),s.loadTextureEnabled(a,!0),s.loadTextureUnit(a,a.TEXTURE0),s.loadTextureMatrix(a,this.scratchMatrix),s.loadModulateColor(a,t.pickingMode))),h&&(s.loadApplyLighting(a,!0),l.normalsVboCacheKey||(l.normalsVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.normalsVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.normalsVboCacheKey,e,4*l.normals.length),l.refreshNormalsBuffer=!0),a.bindBuffer(a.ARRAY_BUFFER,e),l.refreshNormalsBuffer&&(a.bufferData(a.ARRAY_BUFFER,l.normals,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshNormalsBuffer=!1),a.enableVertexAttribArray(s.normalVectorLocation),a.vertexAttribPointer(s.normalVectorLocation,3,a.FLOAT,!1,0,0)),a.drawElements(a.TRIANGLES,this.meshIndices.length,a.UNSIGNED_SHORT,0),u&&a.disableVertexAttribArray(s.vertexTexCoordLocation),h&&(s.loadApplyLighting(a,!1),a.disableVertexAttribArray(s.normalVectorLocation))}if(this.activeAttributes.drawOutline&&this.meshOutlineIndices&&(s.loadTextureEnabled(a,!1),a.disableVertexAttribArray(s.vertexTexCoordLocation),this.applyMvpMatrixForOutline(t),i=this.activeAttributes.outlineColor,r=i.alpha*t.currentLayer.opacity,a.depthMask(r>=1||t.pickingMode),s.loadColor(a,t.pickingMode?n:i),s.loadOpacity(a,t.pickingMode?1:r),a.lineWidth(this.activeAttributes.outlineWidth),l.outlineIndicesVboCacheKey||(l.outlineIndicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(l.outlineIndicesVboCacheKey),e||(e=a.createBuffer(),t.gpuResourceCache.putResource(l.outlineIndicesVboCacheKey,e,2*this.meshOutlineIndices.length),l.refreshOutlineIndices=!0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),l.refreshOutlineIndices&&(a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.meshOutlineIndices,a.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),l.refreshOutlineIndices=!1),a.drawElements(a.LINE_STRIP,this.meshOutlineIndices.length,a.UNSIGNED_SHORT,0)),t.pickingMode){var f=this.computePickPosition(t),d=new c(n,this.pickDelegate?this.pickDelegate:this,f,t.currentLayer,!1);t.resolvePick(d)}},m.prototype.computePickPosition=function(t){var e=this.currentData,r=t.navigatorState.rayFromScreenPoint(t.pickPoint),i=new p(r.origin[0],r.origin[1],r.origin[2]).subtract(e.referencePoint),n=new a(i,r.direction),o=[];if(g.computeIndexedTrianglesIntersection(n,e.meshPoints,this.meshIndices,o)){var s=o[0];if(o.length>1)for(var l=s.distanceToSquared(t.navigatorState.eyePoint),u=1;u<o.length;u++){var c=o[u].distanceToSquared(t.navigatorState.eyePoint);c<l&&(l=c,s=o[u])}var f=new h(0,0,0);return t.globe.computePositionFromPoint(s[0]+e.referencePoint[0],s[1]+e.referencePoint[1],s[2]+e.referencePoint[2],f),f.altitude/=this._altitudeScale,f}return null},m.prototype.beginDrawing=function(t){var e=t.currentGlContext;if(this.activeAttributes.drawInterior){e.disable(e.CULL_FACE),t.findAndBindProgram(r);var i=!t.pickMode&&this.currentData.normals&&this.activeAttributes.applyLighting;i&&t.currentProgram.loadModelviewInverse(e,t.navigatorState.modelviewNormalTransform)}e.enableVertexAttribArray(t.currentProgram.vertexPointLocation)},m.prototype.endDrawing=function(t){var e=t.currentGlContext;e.disableVertexAttribArray(t.currentProgram.vertexPointLocation),e.depthMask(!0),e.lineWidth(1),e.enable(e.CULL_FACE)},m}),define("worldwind/shapes/SurfacePolygon",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(t,e,r,i){"use strict";var n=function(r,o){if(!Array.isArray(r))throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfacePolygon","constructor","The specified boundary is not an array."));i.call(this,o),this._boundaries=r,this._stateId=n.stateId++};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{boundaries:{get:function(){return this._boundaries},set:function(r){if(!Array.isArray(r))throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfacePolygon","set boundaries","The specified value is not an array."));this._boundaries=r,this._stateId=n.stateId++,this.isPrepared=!1,this.stateKeyInvalid=!0}}}),n.stateId=Number.MIN_SAFE_INTEGER,n.staticStateKey=function(t){var e=i.staticStateKey(t);return e+" pg "+t._stateId},n.prototype.computeStateKey=function(){return n.staticStateKey(this)},n}),define("worldwind/shapes/GeographicMesh",["../shapes/AbstractMesh","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolygon","../geom/Vec2","../geom/Vec3"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p){"use strict";var g=function(r,i){if(!r)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","missingPositions"));if(r.length<2||r[0].length<2)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","Number of positions is insufficient."));if(r.length*r[0].length>65536)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","Too many positions. Must be fewer than 65536. Try using multiple meshes."));for(var n=r[0].length,o=1;o<r.length;o++)if(r[o].length!==n)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","Array lengths are inconsistent."));var a=r.length,l=r[0].length;t.call(this,i),this.pickTransparentImagePixels=!0,this._positions=r,this._altitudeScale=1,this.numRows=a,this.numColumns=l,this._textureCoordinates=null,this.referencePosition=this.determineReferencePosition(this._positions)};return g.prototype=Object.create(t.prototype),Object.defineProperties(g.prototype,{positions:{get:function(){return this._positions},set:function(t){if(!t)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","positions","missingPositions"));if(t.length<2||t[0].length<2)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","positions","Number of positions is insufficient."));for(var r=t[0].length,i=1;i<t.length;i++)if(t[i].length!==r)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","positions","Array lengths are inconsistent."));this.numRows=t.length,this.numColumns=t[0].length,this._positions=t,this.referencePosition=this.determineReferencePosition(this._positions),this.reset(),this.meshIndices=null,this.outlineIndices=null}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(t){if(t&&t.length!=this.numRows)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","textureCoordinates","Number of texture coordinate rows is inconsistent with the currently specified positions."));for(var r=0;r<this.numRows;r++)if(t[r].length!==this.numColumns)throw new e(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","textureCoordinates","Texture coordinate row lengths are inconsistent with the currently specified positions."));this._textureCoordinates=t,this.reset(),this.texCoords=null}}}),g.makeGridIndices=function(t,e){for(var r=[],i=0,n=0;n<t-1;n++)for(var o=0;o<e-1;o++){var a=n*e+o;r[i++]=a,r[i++]=a+1,r[i++]=a+e,r[i++]=a+1,r[i++]=a+1+e,r[i++]=a+e}return r},g.prototype.determineReferencePosition=function(t){return t[0][0]},g.prototype.createSurfaceShape=function(){for(var t=[],e=0;e<this.numColumns;e++)t.push(this._positions[0][e]);for(var r=1;r<this.numRows;r++)t.push(this._positions[r][this.numColumns-1]);for(e=this.numColumns-2;e>=0;e--)t.push(this._positions[this.numRows-1][e]);for(r=this.numRows-2;r>0;r--)t.push(this._positions[r][0]);return new f(t,null)},g.prototype.computeMeshPoints=function(t,e){for(var r,i,n=Number.MAX_VALUE,o=t.navigatorState.eyePoint,a=new Float32Array(this.numRows*this.numColumns*3),s=new p(0,0,0),l=0,u=0;u<this._positions.length;u++)for(var c=0,h=this._positions[u].length;c<h;c++)r=this._positions[u][c],t.surfacePointForMode(r.latitude,r.longitude,r.altitude*this._altitudeScale,this.altitudeMode,s),i=s.distanceToSquared(o),i<n&&(n=i),s.subtract(this.currentData.referencePoint),a[l++]=s[0],a[l++]=s[1],a[l++]=s[2];return e.eyeDistance=Math.sqrt(n),a},g.prototype.computeTexCoords=function(){return this._textureCoordinates?this.computeExplicitTexCoords():this.computeImplicitTexCoords()},g.prototype.computeExplicitTexCoords=function(){for(var t=new Float32Array(2*this.numRows*this.numColumns),e=0,r=0;r<this._textureCoordinates.length;r++)for(var i=0,n=this._textureCoordinates[r].length;i<n;i++){var o=this._textureCoordinates[r][i];t[e++]=o[0],t[e++]=o[1]}return t},g.prototype.computeImplicitTexCoords=function(){for(var t=new Float32Array(2*this.numRows*this.numColumns),e=1/(this.numRows-1),r=1/(this.numColumns-1),i=0,n=0;n<this._positions.length;n++)for(var o=n===this.numRows-1?1:n*e,a=0,s=this._positions[n].length;a<s;a++)t[i++]=a===this.numColumns-1?1:a*r,t[i++]=o;return t},g.prototype.computeMeshIndices=function(){for(var t=new Uint16Array((this.numRows-1)*(this.numColumns-1)*6),e=0,r=0;r<this.numRows-1;r++)for(var i=0;i<this.numColumns-1;i++){var n=r*this.numColumns+i;t[e++]=n,t[e++]=n+1,t[e++]=n+this.numColumns,t[e++]=n+1,t[e++]=n+1+this.numColumns,t[e++]=n+this.numColumns}return t},g.prototype.computeOutlineIndices=function(){for(var t=new Uint16Array(2*this.numRows+2*this.numColumns),e=0,r=0;r<this.numColumns;r++)t[e++]=r;for(var i=1;i<this.numRows;i++)t[e++]=(i+1)*this.numColumns-1;for(r=this.numRows*this.numColumns-2;r>=(this.numRows-1)*this.numColumns;r--)t[e++]=r;for(i=this.numRows-2;i>=0;i--)t[e++]=i*this.numColumns;return t},g}),define("worldwind/shapes/GeographicText",["../error/ArgumentError","../util/Logger","../shapes/Text","../geom/Vec3"],function(t,e,r,i){"use strict";var n=function(i,n){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"Text","constructor","missingPosition"));r.call(this,n),this.position=i,this.declutterGroup=1};return n.placePoint=new i(0,0,0),n.prototype=Object.create(r.prototype),n.prototype.clone=function(){var t=new n(this.position,this.text);return t.copy(this),t.pickDelegate=this.pickDelegate?this.pickDelegate:this,t},n.prototype.render=function(t){t.globe.projectionLimits&&!t.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude)||r.prototype.render.call(this,t)},n.prototype.computeScreenPointAndEyeDistance=function(t){return t.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,n.placePoint),!!t.navigatorState.frustumInModelCoordinates.containsPoint(n.placePoint)&&(this.eyeDistance=this.alwaysOnTop?0:t.navigatorState.eyePoint.distanceTo(n.placePoint),!!t.navigatorState.projectWithDepth(n.placePoint,this.depthOffset,this.screenPoint))},n}),define("worldwind/formats/geojson/GeoJSONConstants",[],function(){"use strict";var t=function(){};return t.FIELD_TYPE="type",t.FIELD_CRS="crs",t.FIELD_NAME="name",t.FIELD_BBOX="bbox",t.FIELD_COORDINATES="coordinates",t.FIELD_GEOMETRIES="geometries",t.FIELD_GEOMETRY="geometry",t.FIELD_PROPERTIES="properties",t.FIELD_FEATURES="features",t.FIELD_ID="id",t.TYPE_POINT="Point",t.TYPE_MULTI_POINT="MultiPoint",t.TYPE_LINE_STRING="LineString",t.TYPE_MULTI_LINE_STRING="MultiLineString",t.TYPE_POLYGON="Polygon",t.TYPE_MULTI_POLYGON="MultiPolygon",t.TYPE_GEOMETRY_COLLECTION="GeometryCollection",t.TYPE_FEATURE="Feature",t.TYPE_FEATURE_COLLECTION="FeatureCollection",t.FIELD_CRS_NAME="name",t.FIELD_CRS_LINK="link",t.WGS84_CRS="urn:ogc:def:crs:OGC:1.3:CRS84",t.EPSG4326_CRS="EPSG:4326",t}),define("worldwind/formats/geojson/GeoJSONGeometry",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(t,e,r){"use strict";var i=function(e,i,n){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometry","constructor","missingCoordinates"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometry","constructor","missingType"));this._coordinates=e,this._type=i,this._bbox=n?n:null};return Object.defineProperties(i.prototype,{coordinates:{get:function(){return this._coordinates}},type:{get:function(){return this._type}},bbox:{get:function(){return this._bbox}}}),i.prototype.isPointType=function(){return this.type===e.TYPE_POINT},i.prototype.isMultiPointType=function(){return this.type===e.TYPE_MULTI_POINT},i.prototype.isLineStringType=function(){return this.type===e.TYPE_LINE_STRING},i.prototype.isMultiLineStringType=function(){return this.type===e.TYPE_MULTI_LINE_STRING},i.prototype.isPolygonType=function(){return this.type===e.TYPE_POLYGON},i.prototype.isMultiPolygonType=function(){return this.type===e.TYPE_MULTI_POLYGON},i}),define("worldwind/formats/geojson/GeoJSONGeometryCollection",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(t,e,r){"use strict";var i=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryCollection","constructor","missingGeometries"));if("[object Array]"!==Object.prototype.toString.call(e))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryCollection","constructor","invalidGeometries"));this._geometries=e,this._bbox=i};return Object.defineProperties(i.prototype,{geometries:{get:function(){return this._geometries}},bbox:{get:function(){return this._bbox}}}),i}),define("worldwind/formats/geojson/GeoJSONGeometryLineString",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingCoordinates"));if(i.length<2||i[0].length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Number]"!==Object.prototype.toString.call(i[0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),define("worldwind/formats/geojson/GeoJSONGeometryMultiLineString",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","missingCoordinates"));if(i[0].length<2||i[0][0].length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Array]"!==Object.prototype.toString.call(i[0][0])||"[object Number]"!==Object.prototype.toString.call(i[0][0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),define("worldwind/formats/geojson/GeoJSONGeometryMultiPoint",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","missingCoordinates"));if(i[0].length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Number]"!==Object.prototype.toString.call(i[0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),define("worldwind/formats/geojson/GeoJSONGeometryMultiPolygon",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryMultiPolygon","constructor","missingCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Array]"!==Object.prototype.toString.call(i[0][0])||"[object Array]"!==Object.prototype.toString.call(i[0][0][0])||"[object Number]"!==Object.prototype.toString.call(i[0][0][0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),define("worldwind/formats/geojson/GeoJSONGeometryPoint",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingCoordinates"));if(i.length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i)||"[object Number]"!==Object.prototype.toString.call(i[0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","invalidCoordinatesType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),define("worldwind/formats/geojson/GeoJSONGeometryPolygon",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingCoordinates"));if(i[0].length<2||i[0][0].length<2)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidNumberOfCoordinates"));if("[object Array]"!==Object.prototype.toString.call(i[0])||"[object Array]"!==Object.prototype.toString.call(i[0][0])||"[object Number]"!==Object.prototype.toString.call(i[0][0][0]))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidCoordinatesType"));if(i[0][0]!==i[0][i.length-1])throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidLinearRing"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingType"));e.call(this,i,n,o)};return i.prototype=Object.create(e.prototype),i}),define("worldwind/util/proj4-src",[],function(){"use strict";function t(t,e){if(t[e])return t[e];for(var r,i,n=Object.keys(t),o=e.toLowerCase().replace(We,""),a=-1;++a<n.length;)if(r=n[a],i=r.toLowerCase().replace(We,""),i===o)return t[r]}function e(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=ze}function r(t){var r=new e(t);return r.output()}function i(t,e,r){Array.isArray(e)&&(r.unshift(e),e=null);var i=e?{}:t,o=r.reduce(function(t,e){return n(e,t),t},i);e&&(t[e]=o)}function n(t,e){if(!Array.isArray(t))return void(e[t]=!0);var r=t.shift();if("PARAMETER"===r&&(r=t.shift()),1===t.length)return Array.isArray(t[0])?(e[r]={},void n(t[0],e[r])):void(e[r]=t[0]);if(!t.length)return void(e[r]=!0);if("TOWGS84"===r)return void(e[r]=t);Array.isArray(r)||(e[r]={});var o;switch(r){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[r]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&n(t[2],e[r]));case"SPHEROID":case"ELLIPSOID":return e[r]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&n(t[3],e[r]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void i(e,r,t);default:for(o=-1;++o<t.length;)if(!Array.isArray(t[o]))return n(t,e[r]);return i(e,r,t)}}function o(t,e){var r=e[0],i=e[1];!(r in t)&&i in t&&(t[r]=t[i],3===e.length&&(t[r]=e[2](t[r])))}function a(t){return t*tr}function s(t){function e(e){var r=t.to_meter||1;return e*r}"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):(t.to_meter=t.UNIT.convert,10)));var r=t.GEOGCS;"GEOGCS"===t.type&&(r=t),r&&(r.DATUM?t.datumCode=r.DATUM.name.toLowerCase():t.datumCode=r.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),r.DATUM&&r.DATUM.SPHEROID&&(t.ellps=r.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=r.DATUM.SPHEROID.a,t.rf=parseFloat(r.DATUM.SPHEROID.rf,10)),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36")),t.b&&!isFinite(t.b)&&(t.b=t.a);var i=function(e){return o(t,e)},n=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",a],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",a],["x0","false_easting",e],["y0","false_northing",e],["long0","central_meridian",a],["lat0","latitude_of_origin",a],["lat0","standard_parallel_1",a],["lat1","standard_parallel_1",a],["lat2","standard_parallel_2",a],["alpha","azimuth",a],["srsCode","name"]];n.forEach(i),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=a(t.lat1>0?90:-90),t.lat_ts=t.lat1)}function l(t){var e=this;if(2===arguments.length){var r=arguments[1];"string"==typeof r?"+"===r.charAt(0)?l[t]=Ue(arguments[1]):l[t]=er(arguments[1]):l[t]=r}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?l.apply(e,t):l(t)});if("string"==typeof t){if(t in l)return l[t]}else"EPSG"in t?l["EPSG:"+t.EPSG]=t:"ESRI"in t?l["ESRI:"+t.ESRI]=t:"IAU2000"in t?l["IAU2000:"+t.IAU2000]=t:console.log(t);return}}function u(t){return"string"==typeof t}function c(t){return t in l}function h(t){return rr.some(function(e){return t.indexOf(e)>-1})}function f(t){return"+"===t[0]}function d(t){return u(t)?c(t)?l[t]:h(t)?er(t):f(t)?Ue(t):void 0:t}function p(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=nr(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function g(t){var e=t.x,r=t.y;if(r*ke>90&&r*ke<-90&&e*ke>180&&e*ke<-180)return null;var i,n;if(Math.abs(Math.abs(r)-Ne)<=Oe)return null;if(this.sphere)i=this.x0+this.a*this.k0*ar(e-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(De+.5*r));else{var o=Math.sin(r),a=sr(this.e,r,o);i=this.x0+this.a*this.k0*ar(e-this.long0),n=this.y0-this.a*this.k0*Math.log(a)}return t.x=i,t.y=n,t}function m(t){var e,r,i=t.x-this.x0,n=t.y-this.y0;if(this.sphere)r=Ne-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var o=Math.exp(-n/(this.a*this.k0));if(r=lr(this.e,o),r===-9999)return null}return e=ar(this.long0+i/(this.a*this.k0)),t.x=e,t.y=r,t}function y(){}function v(t){return t}function b(t,e){var r=gr.length;return t.names?(gr[r]=t,t.names.forEach(function(t){pr[t.toLowerCase()]=r}),this):(console.log(e),!0)}function E(t){if(!t)return!1;var e=t.toLowerCase();return"undefined"!=typeof pr[e]&&gr[pr[e]]?gr[pr[e]]:void 0}function w(){dr.forEach(b)}function _(t,e,r,i){var n=t*t,o=e*e,a=(n-o)/n,s=0;i?(t*=1-a*(Ce+a*(Re+a*Pe)),n=t*t,a=0):s=Math.sqrt(a);var l=(n-o)/o;return{es:a,e:s,ep2:l}}function x(e,r,i,n,o){if(!e){var a=t(yr,n);a||(a=vr),e=a.a,r=a.b,i=a.rf}return i&&!r&&(r=(1-1/i)*e),(0===i||Math.abs(e-r)<Oe)&&(o=!0,r=e),{a:e,b:r,rf:i,sphere:o}}function S(t,e,r,i,n,o){var a={};return void 0===t||"none"===t?a.datum_type=Le:a.datum_type=Me,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=Se),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=Te,a.datum_params[3]*=Ae,a.datum_params[4]*=Ae,a.datum_params[5]*=Ae,a.datum_params[6]=a.datum_params[6]/1e6+1))),a.a=r,a.b=i,a.es=n,a.ep2=o,a}function T(e,r){if(!(this instanceof T))return new T(e);r=r||function(t){if(t)throw t};var i=d(e);if("object"!=typeof i)return void r(e);var n=T.projections.get(i.projName);if(!n)return void r(e);if(i.datumCode&&"none"!==i.datumCode){var o=t(br,i.datumCode);o&&(i.datum_params=o.towgs84?o.towgs84.split(","):null,i.ellps=o.ellipse,i.datumName=o.datumName?o.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84";var a=x(i.a,i.b,i.rf,i.ellps,i.sphere),s=_(a.a,a.b,a.rf,i.R_A),l=i.datum||S(i.datumCode,i.datum_params,a.a,a.b,s.es,s.ep2);ir(this,i),ir(this,n),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=s.es,this.e=s.e,this.ep2=s.ep2,this.datum=l,this.init(),r(null,this)}function M(t,e){return t.datum_type===e.datum_type&&(!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(t.datum_type===Se?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type!==Te||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]))}function L(t,e,r){var i,n,o,a,s=t.x,l=t.y,u=t.z?t.z:0;if(l<-Ne&&l>-1.001*Ne)l=-Ne;else if(l>Ne&&l<1.001*Ne)l=Ne;else if(l<-Ne||l>Ne)return null;return s>Math.PI&&(s-=2*Math.PI),n=Math.sin(l),a=Math.cos(l),o=n*n,i=r/Math.sqrt(1-e*o),{x:(i+u)*a*Math.cos(s),y:(i+u)*a*Math.sin(s),z:(i*(1-e)+u)*n}}function A(t,e,r,i){var n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E=1e-12,w=E*E,_=30,x=t.x,S=t.y,T=t.z?t.z:0;if(n=Math.sqrt(x*x+S*S),o=Math.sqrt(x*x+S*S+T*T),n/r<E){if(y=0,o/r<E)return v=Ne,b=-i,{x:t.x,y:t.y,z:t.z}}else y=Math.atan2(S,x);a=T/o,s=n/o,l=1/Math.sqrt(1-e*(2-e)*s*s),h=s*(1-e)*l,f=a*l,m=0;do m++,c=r/Math.sqrt(1-e*f*f),b=n*h+T*f-c*(1-e*f*f),u=e*c/(c+b),l=1/Math.sqrt(1-u*(2-u)*s*s),d=s*(1-u)*l,p=a*l,g=p*h-d*f,h=d,f=p;while(g*g>w&&m<_);return v=Math.atan(p/Math.abs(d)),{x:y,y:v,z:b}}function N(t,e,r){if(e===Se)return{x:t.x+r[0],y:t.y+r[1],z:t.z+r[2]};if(e===Te){var i=r[0],n=r[1],o=r[2],a=r[3],s=r[4],l=r[5],u=r[6];return{x:u*(t.x-l*t.y+s*t.z)+i,y:u*(l*t.x+t.y-a*t.z)+n,z:u*(-s*t.x+a*t.y+t.z)+o}}}function C(t,e,r){if(e===Se)return{x:t.x-r[0],y:t.y-r[1],z:t.z-r[2]};if(e===Te){var i=r[0],n=r[1],o=r[2],a=r[3],s=r[4],l=r[5],u=r[6],c=(t.x-i)/u,h=(t.y-n)/u,f=(t.z-o)/u;return{x:c+l*h-s*f,y:-l*c+h+a*f,z:s*c-a*h+f}}}function R(t){return t===Se||t===Te}function P(t,e){return(t.datum.datum_type===Se||t.datum.datum_type===Te)&&"WGS84"!==e.datumCode||(e.datum.datum_type===Se||e.datum.datum_type===Te)&&"WGS84"!==t.datumCode}function O(t,e,r){var i;return Array.isArray(r)&&(r=_r(r)),t.datum&&e.datum&&P(t,e)&&(i=new T("WGS84"),r=O(t,i,r),t=i),"enu"!==t.axis&&(r=wr(t,!1,r)),"longlat"===t.projName?r={x:r.x*Ie,y:r.y*Ie}:(t.to_meter&&(r={x:r.x*t.to_meter,y:r.y*t.to_meter}),r=t.inverse(r)),t.from_greenwich&&(r.x+=t.from_greenwich),r=Er(t.datum,e.datum,r),e.from_greenwich&&(r={x:r.x-e.from_greenwich,y:r.y}),"longlat"===e.projName?r={x:r.x*ke,y:r.y*ke}:(r=e.forward(r),e.to_meter&&(r={x:r.x/e.to_meter,y:r.y/e.to_meter})),"enu"!==e.axis?wr(e,!0,r):r}function I(t,e,r){var i;return Array.isArray(r)?(i=O(t,e,r),3===r.length?[i.x,i.y,i.z]:[i.x,i.y]):O(t,e,r)}function k(t){return t instanceof T?t:t.oProj?t.oProj:T(t)}function D(t,e,r){t=k(t);var i,n=!1;return"undefined"==typeof e?(e=t,t=xr,n=!0):("undefined"!=typeof e.x||Array.isArray(e))&&(r=e,e=t,t=xr,n=!0),e=k(e),r?I(t,e,r):(i={forward:function(r){return I(t,e,r)},inverse:function(r){return I(e,t,r)}},n&&(i.oProj=e),i)}function V(t,e){return e=e||5,K(U({lat:t[1],lon:t[0]}),e)}function F(t){var e=z($(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function G(t){var e=z($(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function B(t){return t*(Math.PI/180)}function W(t){return 180*(t/Math.PI)}function U(t){var e,r,i,n,o,a,s,l,u,c=t.lat,h=t.lon,f=6378137,d=.00669438,p=.9996,g=B(c),m=B(h);u=Math.floor((h+180)/6)+1,180===h&&(u=60),c>=56&&c<64&&h>=3&&h<12&&(u=32),c>=72&&c<84&&(h>=0&&h<9?u=31:h>=9&&h<21?u=33:h>=21&&h<33?u=35:h>=33&&h<42&&(u=37)),e=6*(u-1)-180+3,l=B(e),r=d/(1-d),i=f/Math.sqrt(1-d*Math.sin(g)*Math.sin(g)),n=Math.tan(g)*Math.tan(g),o=r*Math.cos(g)*Math.cos(g),a=Math.cos(g)*(m-l),s=f*((1-d/4-3*d*d/64-5*d*d*d/256)*g-(3*d/8+3*d*d/32+45*d*d*d/1024)*Math.sin(2*g)+(15*d*d/256+45*d*d*d/1024)*Math.sin(4*g)-35*d*d*d/3072*Math.sin(6*g));var y=p*i*(a+(1-n+o)*a*a*a/6+(5-18*n+n*n+72*o-58*r)*a*a*a*a*a/120)+5e5,v=p*(s+i*Math.tan(g)*(a*a/2+(5-n+9*o+4*o*o)*a*a*a*a/24+(61-58*n+n*n+600*o-330*r)*a*a*a*a*a*a/720));return c<0&&(v+=1e7),{northing:Math.round(v),easting:Math.round(y),zoneNumber:u,zoneLetter:j(c)}}function z(t){var e=t.northing,r=t.easting,i=t.zoneLetter,n=t.zoneNumber;if(n<0||n>60)return null;var o,a,s,l,u,c,h,f,d,p,g=.9996,m=6378137,y=.00669438,v=(1-Math.sqrt(1-y))/(1+Math.sqrt(1-y)),b=r-5e5,E=e;i<"N"&&(E-=1e7),f=6*(n-1)-180+3,o=y/(1-y),h=E/g,d=h/(m*(1-y/4-3*y*y/64-5*y*y*y/256)),p=d+(3*v/2-27*v*v*v/32)*Math.sin(2*d)+(21*v*v/16-55*v*v*v*v/32)*Math.sin(4*d)+151*v*v*v/96*Math.sin(6*d),
a=m/Math.sqrt(1-y*Math.sin(p)*Math.sin(p)),s=Math.tan(p)*Math.tan(p),l=o*Math.cos(p)*Math.cos(p),u=m*(1-y)/Math.pow(1-y*Math.sin(p)*Math.sin(p),1.5),c=b/(a*g);var w=p-a*Math.tan(p)/u*(c*c/2-(5+3*s+10*l-4*l*l-9*o)*c*c*c*c/24+(61+90*s+298*l+45*s*s-252*o-3*l*l)*c*c*c*c*c*c/720);w=W(w);var _=(c-(1+2*s+l)*c*c*c/6+(5-2*l+28*s-3*l*l+8*o+24*s*s)*c*c*c*c*c/120)/Math.cos(p);_=f+W(_);var x;if(t.accuracy){var S=z({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});x={top:S.lat,right:S.lon,bottom:w,left:_}}else x={lat:w,lon:_};return x}function j(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function K(t,e){var r="00000"+t.easting,i="00000"+t.northing;return t.zoneNumber+t.zoneLetter+q(t.easting,t.northing,t.zoneNumber)+r.substr(r.length-5,e)+i.substr(i.length-5,e)}function q(t,e,r){var i=Z(r),n=Math.floor(t/1e5),o=Math.floor(e/1e5)%20;return H(n,o,i)}function Z(t){var e=t%Sr;return 0===e&&(e=Sr),e}function H(t,e,r){var i=r-1,n=Tr.charCodeAt(i),o=Mr.charCodeAt(i),a=n+t-1,s=o+e,l=!1;a>Rr&&(a=a-Rr+Lr-1,l=!0),(a===Ar||n<Ar&&a>Ar||(a>Ar||n<Ar)&&l)&&a++,(a===Nr||n<Nr&&a>Nr||(a>Nr||n<Nr)&&l)&&(a++,a===Ar&&a++),a>Rr&&(a=a-Rr+Lr-1),s>Cr?(s=s-Cr+Lr-1,l=!0):l=!1,(s===Ar||o<Ar&&s>Ar||(s>Ar||o<Ar)&&l)&&s++,(s===Nr||o<Nr&&s>Nr||(s>Nr||o<Nr)&&l)&&(s++,s===Ar&&s++),s>Cr&&(s=s-Cr+Lr-1);var u=String.fromCharCode(a)+String.fromCharCode(s);return u}function $(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,r=t.length,i=null,n="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;n+=e,o++}var a=parseInt(n,10);if(0===o||o+3>r)throw"MGRSPoint bad conversion from: "+t;var s=t.charAt(o++);if(s<="A"||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+t;i=t.substring(o,o+=2);for(var l=Z(a),u=Y(i.charAt(0),l),c=X(i.charAt(1),l);c<J(s);)c+=2e6;var h=r-o;if(h%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var f,d,p,g,m,y=h/2,v=0,b=0;return y>0&&(f=1e5/Math.pow(10,y),d=t.substring(o,o+y),v=parseFloat(d)*f,p=t.substring(o+y),b=parseFloat(p)*f),g=v+u,m=b+c,{easting:g,northing:m,zoneLetter:s,zoneNumber:a,accuracy:f}}function Y(t,e){for(var r=Tr.charCodeAt(e-1),i=1e5,n=!1;r!==t.charCodeAt(0);){if(r++,r===Ar&&r++,r===Nr&&r++,r>Rr){if(n)throw"Bad character: "+t;r=Lr,n=!0}i+=1e5}return i}function X(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var r=Mr.charCodeAt(e-1),i=0,n=!1;r!==t.charCodeAt(0);){if(r++,r===Ar&&r++,r===Nr&&r++,r>Cr){if(n)throw"Bad character: "+t;r=Lr,n=!0}i+=1e5}return i}function J(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Q(t,e,r){if(!(this instanceof Q))return new Q(t,e,r);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&"undefined"==typeof e){var i=t.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=t,this.y=e,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function tt(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=qr(this.es),this.ml0=Zr(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function et(t){var e,r,i,n=t.x,o=t.y,a=ar(n-this.long0),s=Math.sin(o),l=Math.cos(o);if(this.es){var u=l*a,c=Math.pow(u,2),h=this.ep2*Math.pow(l,2),f=Math.pow(h,2),d=Math.abs(l)>Oe?Math.tan(o):0,p=Math.pow(d,2),g=Math.pow(p,2);e=1-this.es*Math.pow(s,2),u/=Math.sqrt(e);var m=Zr(o,s,l,this.en);r=this.a*(this.k0*u*(1+c/6*(1-p+h+c/20*(5-18*p+g+14*h-58*p*h+c/42*(61+179*g-g*p-479*p)))))+this.x0,i=this.a*(this.k0*(m-this.ml0+s*a*u/2*(1+c/12*(5-p+9*h+4*f+c/30*(61+g-58*p+270*h-330*p*h+c/56*(1385+543*g-g*p-3111*p))))))+this.y0}else{var y=l*Math.sin(a);if(Math.abs(Math.abs(y)-1)<Oe)return 93;if(r=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,i=l*Math.cos(a)/Math.sqrt(1-Math.pow(y,2)),y=Math.abs(i),y>=1){if(y-1>Oe)return 93;i=0}else i=Math.acos(i);o<0&&(i=-i),i=this.a*this.k0*(i-this.lat0)+this.y0}return t.x=r,t.y=i,t}function rt(t){var e,r,i,n,o=(t.x-this.x0)*(1/this.a),a=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,r=$r(e,this.es,this.en),Math.abs(r)<Ne){var s=Math.sin(r),l=Math.cos(r),u=Math.abs(l)>Oe?Math.tan(r):0,c=this.ep2*Math.pow(l,2),h=Math.pow(c,2),f=Math.pow(u,2),d=Math.pow(f,2);e=1-this.es*Math.pow(s,2);var p=o*Math.sqrt(e)/this.k0,g=Math.pow(p,2);e*=u,i=r-e*g/(1-this.es)*.5*(1-g/12*(5+3*f-9*c*f+c-4*h-g/30*(61+90*f-252*c*f+45*d+46*c-g/56*(1385+3633*f+4095*d+1574*d*f)))),n=ar(this.long0+p*(1-g/6*(1+2*f+c-g/20*(5+28*f+24*d+8*c*f+6*c-g/42*(61+662*f+1320*d+720*d*f))))/l)}else i=Ne*or(a),n=0;else{var m=Math.exp(o/this.k0),y=.5*(m-1/m),v=this.lat0+a/this.k0,b=Math.cos(v);e=Math.sqrt((1-Math.pow(b,2))/(1+Math.pow(y,2))),i=Math.asin(e),a<0&&(i=-i),n=0===y&&0===b?0:ar(Math.atan2(y,b)+this.long0)}return t.x=n,t.y=i,t}function it(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),r=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),r*=e,this.cgb[1]=r*(7/3+e*(-1.6+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=r*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),r*=e,this.cgb[2]=r*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=r*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),r*=e,this.cgb[3]=r*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=r*(1237/630+e*(-2.4+e*(-24832/14175))),r*=e,this.cgb[4]=r*(4174/315+e*(-144838/6237)),this.cbg[4]=r*(-734/315+e*(109598/31185)),r*=e,this.cgb[5]=r*(601676/22275),this.cbg[5]=r*(444337/155925),r=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+r*(.25+r*(1/64+r/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=r*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=r*(13/48+e*(-.6+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),r*=e,this.utg[2]=r*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=r*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),r*=e,this.utg[3]=r*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=r*(49561/161280+e*(-179/168+e*(6601661/7257600))),r*=e,this.utg[4]=r*(-4583/161280+e*(108847/3991680)),this.gtu[4]=r*(34729/80640+e*(-3418889/1995840)),r*=e,this.utg[5]=r*-.03233083094085698,this.gtu[5]=.6650675310896665*r;var i=ri(this.cbg,this.lat0);this.Zb=-this.Qn*(i+ii(this.gtu,2*i))}function nt(t){var e=ar(t.x-this.long0),r=t.y;r=ri(this.cbg,r);var i=Math.sin(r),n=Math.cos(r),o=Math.sin(e),a=Math.cos(e);r=Math.atan2(i,a*n),e=Math.atan2(o*n,Qr(i,n*a)),e=ei(Math.tan(e));var s=oi(this.gtu,2*r,2*e);r+=s[0],e+=s[1];var l,u;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,u=this.a*(this.Qn*r+this.Zb)+this.y0):(l=1/0,u=1/0),t.x=l,t.y=u,t}function ot(t){var e=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);r=(r-this.Zb)/this.Qn,e/=this.Qn;var i,n;if(Math.abs(e)<=2.623395162778){var o=oi(this.utg,2*r,2*e);r+=o[0],e+=o[1],e=Math.atan(Jr(e));var a=Math.sin(r),s=Math.cos(r),l=Math.sin(e),u=Math.cos(e);r=Math.atan2(a*u,Qr(l,u*s)),e=Math.atan2(l,u*s),i=ar(e+this.long0),n=ri(this.cgb,r)}else i=1/0,n=1/0;return t.x=i,t.y=n,t}function at(){var t=li(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Ie,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,si.init.apply(this),this.forward=si.forward,this.inverse=si.inverse}function st(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+De)/(Math.pow(Math.tan(.5*this.lat0+De),this.C)*fi(this.e*t,this.ratexp))}function lt(t){var e=t.x,r=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+De),this.C)*fi(this.e*Math.sin(r),this.ratexp))-Ne,t.x=this.C*e,t}function ut(t){for(var e=1e-14,r=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+De)/this.K,1/this.C),o=di;o>0&&(i=2*Math.atan(n*fi(this.e*Math.sin(t.y),-.5*this.e))-Ne,!(Math.abs(i-t.y)<e));--o)t.y=i;return o?(t.x=r,t.y=i,t):null}function ct(){gi.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function ht(t){var e,r,i,n;return t.x=ar(t.x-this.long0),gi.forward.apply(this,[t]),e=Math.sin(t.y),r=Math.cos(t.y),i=Math.cos(t.x),n=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*r*i),t.x=n*r*Math.sin(t.x),t.y=n*(this.cosc0*e-this.sinc0*r*i),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function ft(t){var e,r,i,n,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Math.sqrt(t.x*t.x+t.y*t.y)){var a=2*Math.atan2(o,this.R2);e=Math.sin(a),r=Math.cos(a),n=Math.asin(r*this.sinc0+t.y*e*this.cosc0/o),i=Math.atan2(t.x*e,o*this.cosc0*r-t.y*this.sinc0*e)}else n=this.phic0,i=0;return t.x=i,t.y=n,gi.inverse.apply(this,[t]),t.x=ar(t.x+this.long0),t}function dt(t,e,r){return e*=r,Math.tan(.5*(Ne+t))*Math.pow((1-e)/(1+e),.5*r)}function pt(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Oe&&(this.k0=.5*(1+or(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Oe&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Oe&&(this.k0=.5*this.cons*nr(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/sr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=nr(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Ne,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function gt(t){var e,r,i,n,o,a,s=t.x,l=t.y,u=Math.sin(l),c=Math.cos(l),h=ar(s-this.long0);return Math.abs(Math.abs(s-this.long0)-Math.PI)<=Oe&&Math.abs(l+this.lat0)<=Oe?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*u+this.coslat0*c*Math.cos(h)),t.x=this.a*e*c*Math.sin(h)+this.x0,t.y=this.a*e*(this.coslat0*u-this.sinlat0*c*Math.cos(h))+this.y0,t):(r=2*Math.atan(this.ssfn_(l,u,this.e))-Ne,n=Math.cos(r),i=Math.sin(r),Math.abs(this.coslat0)<=Oe?(o=sr(this.e,l*this.con,this.con*u),a=2*this.a*this.k0*o/this.cons,t.x=this.x0+a*Math.sin(s-this.long0),t.y=this.y0-this.con*a*Math.cos(s-this.long0),t):(Math.abs(this.sinlat0)<Oe?(e=2*this.a*this.k0/(1+n*Math.cos(h)),t.y=e*i):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*i+this.cosX0*n*Math.cos(h))),t.y=e*(this.cosX0*i-this.sinX0*n*Math.cos(h))+this.y0),t.x=e*n*Math.sin(h)+this.x0,t))}function mt(t){t.x-=this.x0,t.y-=this.y0;var e,r,i,n,o,a=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var s=2*Math.atan(a/(.5*this.a*this.k0));return e=this.long0,r=this.lat0,a<=Oe?(t.x=e,t.y=r,t):(r=Math.asin(Math.cos(s)*this.sinlat0+t.y*Math.sin(s)*this.coslat0/a),e=ar(Math.abs(this.coslat0)<Oe?this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y):this.long0+Math.atan2(t.x*Math.sin(s),a*this.coslat0*Math.cos(s)-t.y*this.sinlat0*Math.sin(s))),t.x=e,t.y=r,t)}if(Math.abs(this.coslat0)<=Oe){if(a<=Oe)return r=this.lat0,e=this.long0,t.x=e,t.y=r,t;t.x*=this.con,t.y*=this.con,i=a*this.cons/(2*this.a*this.k0),r=this.con*lr(this.e,i),e=this.con*ar(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else n=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=Oe?o=this.X0:(o=Math.asin(Math.cos(n)*this.sinX0+t.y*Math.sin(n)*this.cosX0/a),e=ar(this.long0+Math.atan2(t.x*Math.sin(n),a*this.cosX0*Math.cos(n)-t.y*this.sinX0*Math.sin(n)))),r=-1*lr(this.e,Math.tan(.5*(Ne+o)));return t.x=e,t.y=r,t}function yt(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),r=this.a,i=this.rf,n=1/i,o=2*n-Math.pow(n,2),a=this.e=Math.sqrt(o);this.R=this.k0*r*Math.sqrt(1-o)/(1-o*Math.pow(e,2)),this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+t/2)),u=Math.log((1+a*e)/(1-a*e));this.K=s-this.alpha*l+this.alpha*a/2*u}function vt(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),r=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+r)+this.K,n=2*(Math.atan(Math.exp(i))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),a=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(n)+Math.cos(this.b0)*Math.cos(o))),s=Math.asin(Math.cos(this.b0)*Math.sin(n)-Math.sin(this.b0)*Math.cos(n)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*a+this.x0,t}function bt(t){for(var e=t.x-this.x0,r=t.y-this.y0,i=e/this.R,n=2*(Math.atan(Math.exp(r/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(n)+Math.sin(this.b0)*Math.cos(n)*Math.cos(i)),a=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(n))),s=this.lambda0+a/this.alpha,l=0,u=o,c=-1e3,h=0;Math.abs(u-c)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),c=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=s,t.y=u,t}function Et(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),r=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-r*r);var i=sr(this.e,this.lat0,t),n=this.bl/e*Math.sqrt((1-this.es)/(1-r*r));n*n<1&&(n=1);var o,a;if(isNaN(this.longc)){var s=sr(this.e,this.lat1,Math.sin(this.lat1)),l=sr(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(n+Math.sqrt(n*n-1))*Math.pow(i,this.bl):this.el=(n-Math.sqrt(n*n-1))*Math.pow(i,this.bl);var u=Math.pow(s,this.bl),c=Math.pow(l,this.bl);o=this.el/u,a=.5*(o-1/o);var h=(this.el*this.el-c*u)/(this.el*this.el+c*u),f=(c-u)/(c+u),d=ar(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(h*Math.tan(.5*this.bl*d)/f)/this.bl,this.long0=ar(this.long0);var p=ar(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*p)/a),this.alpha=Math.asin(n*Math.sin(this.gamma0))}else o=this.lat0>=0?n+Math.sqrt(n*n-1):n-Math.sqrt(n*n-1),this.el=o*Math.pow(i,this.bl),a=.5*(o-1/o),this.gamma0=Math.asin(Math.sin(this.alpha)/n),this.long0=this.longc-Math.asin(a*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(n*n-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(n*n-1),Math.cos(this.alpha))}function wt(t){var e,r,i,n=t.x,o=t.y,a=ar(n-this.long0);if(Math.abs(Math.abs(o)-Ne)<=Oe)i=o>0?-1:1,r=this.al/this.bl*Math.log(Math.tan(De+i*this.gamma0*.5)),e=-1*i*Ne*this.al/this.bl;else{var s=sr(this.e,o,Math.sin(o)),l=this.el/Math.pow(s,this.bl),u=.5*(l-1/l),c=.5*(l+1/l),h=Math.sin(this.bl*a),f=(u*Math.sin(this.gamma0)-h*Math.cos(this.gamma0))/c;r=Math.abs(Math.abs(f)-1)<=Oe?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-f)/(1+f))/this.bl,e=Math.abs(Math.cos(this.bl*a))<=Oe?this.al*this.bl*a:this.al*Math.atan2(u*Math.cos(this.gamma0)+h*Math.sin(this.gamma0),Math.cos(this.bl*a))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+r):(e-=this.uc,t.x=this.x0+r*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-r*Math.sin(this.alpha)),t}function _t(t){var e,r;this.no_rot?(r=t.y-this.y0,e=t.x-this.x0):(r=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var i=Math.exp(-1*this.bl*r/this.al),n=.5*(i-1/i),o=.5*(i+1/i),a=Math.sin(this.bl*e/this.al),s=(a*Math.cos(this.gamma0)+n*Math.sin(this.gamma0))/o,l=Math.pow(this.el/Math.sqrt((1+s)/(1-s)),1/this.bl);return Math.abs(s-1)<Oe?(t.x=this.long0,t.y=Ne):Math.abs(s+1)<Oe?(t.x=this.long0,t.y=-1*Ne):(t.y=lr(this.e,l),t.x=ar(this.long0-Math.atan2(n*Math.cos(this.gamma0)-a*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t}function xt(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Oe)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),r=Math.cos(this.lat1),i=nr(this.e,e,r),n=sr(this.e,this.lat1,e),o=Math.sin(this.lat2),a=Math.cos(this.lat2),s=nr(this.e,o,a),l=sr(this.e,this.lat2,o),u=sr(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Oe?this.ns=Math.log(i/s)/Math.log(n/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(n,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function St(t){var e=t.x,r=t.y;Math.abs(2*Math.abs(r)-Math.PI)<=Oe&&(r=or(r)*(Ne-2*Oe));var i,n,o=Math.abs(Math.abs(r)-Ne);if(o>Oe)i=sr(this.e,r,Math.sin(r)),n=this.a*this.f0*Math.pow(i,this.ns);else{if(o=r*this.ns,o<=0)return null;n=0}var a=this.ns*ar(e-this.long0);return t.x=this.k0*(n*Math.sin(a))+this.x0,t.y=this.k0*(this.rh-n*Math.cos(a))+this.y0,t}function Tt(t){var e,r,i,n,o,a=(t.x-this.x0)/this.k0,s=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+s*s),r=1):(e=-Math.sqrt(a*a+s*s),r=-1);var l=0;if(0!==e&&(l=Math.atan2(r*a,r*s)),0!==e||this.ns>0){if(r=1/this.ns,i=Math.pow(e/(this.a*this.f0),r),n=lr(this.e,i),n===-9999)return null}else n=-Ne;return o=ar(l/this.ns+this.long0),t.x=o,t.y=n,t}function Mt(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Lt(t){var e,r,i,n,o,a,s,l=t.x,u=t.y,c=ar(l-this.long0);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),i=-c*this.alfa,n=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),o=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(n)),a=this.n*o,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(n/2+this.s45),this.n),t.y=s*Math.cos(a)/1,t.x=s*Math.sin(a)/1,this.czech||(t.y*=-1,t.x*=-1),t}function At(t){var e,r,i,n,o,a,s,l,u=t.x;t.x=t.y,t.y=u,this.czech||(t.y*=-1,t.x*=-1),a=Math.sqrt(t.x*t.x+t.y*t.y),o=Math.atan2(t.y,t.x),n=o/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),r=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(e)),t.x=this.long0-r/this.alfa,s=e,l=0;var c=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(l=1),s=t.y,c+=1;while(0===l&&c<15);return c>=15?null:t}function Nt(){this.sphere||(this.e0=Ni(this.es),this.e1=Ci(this.es),this.e2=Ri(this.es),this.e3=Pi(this.es),this.ml0=this.a*Ai(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Ct(t){var e,r,i=t.x,n=t.y;if(i=ar(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(n)*Math.sin(i)),r=this.a*(Math.atan2(Math.tan(n),Math.cos(i))-this.lat0);else{var o=Math.sin(n),a=Math.cos(n),s=Oi(this.a,this.e,o),l=Math.tan(n)*Math.tan(n),u=i*Math.cos(n),c=u*u,h=this.es*a*a/(1-this.es),f=this.a*Ai(this.e0,this.e1,this.e2,this.e3,n);e=s*u*(1-c*l*(1/6-(8-l+8*h)*c/120)),r=f-this.ml0+s*o/a*c*(.5+(5-l+6*h)*c/24)}return t.x=e+this.x0,t.y=r+this.y0,t}function Rt(t){t.x-=this.x0,t.y-=this.y0;var e,r,i=t.x/this.a,n=t.y/this.a;if(this.sphere){var o=n+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(i)),r=Math.atan2(Math.tan(i),Math.cos(o))}else{var a=this.ml0/this.a+n,s=ki(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-Ne)<=Oe)return t.x=this.long0,t.y=Ne,n<0&&(t.y*=-1),t;var l=Oi(this.a,this.e,Math.sin(s)),u=l*l*l/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(s),2),h=i*this.a/l,f=h*h;e=s-l*Math.tan(s)/u*h*h*(.5-(1+3*c)*h*h/24),r=h*(1-f*(c/3+(1+3*c)*c*f/15))/Math.cos(s)}return t.x=ar(r+this.long0),t.y=Ii(e),t}function Pt(){var t=Math.abs(this.lat0);if(Math.abs(t-Ne)<Oe?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<Oe?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=Fi(this.e,1),this.mmf=.5/(1-this.es),this.apa=kt(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Fi(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Ot(t){var e,r,i,n,o,a,s,l,u,c,h=t.x,f=t.y;if(h=ar(h-this.long0),this.sphere){if(o=Math.sin(f),c=Math.cos(f),i=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(r=this.mode===this.EQUIT?1+c*i:1+this.sinph0*o+this.cosph0*c*i,r<=Oe)return null;r=Math.sqrt(2/r),e=r*c*Math.sin(h),r*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*c*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(f+this.phi0)<Oe)return null;r=De-.5*f,r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r)),e=r*Math.sin(h),r*=i}}else{switch(s=0,l=0,u=0,i=Math.cos(h),n=Math.sin(h),o=Math.sin(f),a=Fi(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(s=a/this.qp,l=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:u=1+this.sinb1*s+this.cosb1*l*i;break;case this.EQUIT:u=1+l*i;break;case this.N_POLE:u=Ne+f,a=this.qp-a;break;case this.S_POLE:u=f-Ne,a=this.qp+a}if(Math.abs(u)<Oe)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),r=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*s-this.sinb1*l*i):(u=Math.sqrt(2/(1+l*i)))*s*this.ymf,e=this.xmf*u*l*n;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(u=Math.sqrt(a))*n,r=i*(this.mode===this.S_POLE?u:-u)):e=r=0}}return t.x=this.a*e+this.x0,t.y=this.a*r+this.y0,t}function It(t){t.x-=this.x0,t.y-=this.y0;var e,r,i,n,o,a,s,l=t.x/this.a,u=t.y/this.a;if(this.sphere){var c,h=0,f=0;if(c=Math.sqrt(l*l+u*u),r=.5*c,r>1)return null;switch(r=2*Math.asin(r),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(f=Math.sin(r),h=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(c)<=Oe?0:Math.asin(u*f/c),l*=f,u=h*c;break;case this.OBLIQ:r=Math.abs(c)<=Oe?this.phi0:Math.asin(h*this.sinph0+u*f*this.cosph0/c),l*=f*this.cosph0,u=(h-Math.sin(r)*this.sinph0)*c;break;case this.N_POLE:u=-u,r=Ne-r;break;case this.S_POLE:r-=Ne}e=0!==u||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,u):0}else{if(s=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,u*=this.dd,a=Math.sqrt(l*l+u*u),a<Oe)return t.x=0,t.y=this.phi0,t;n=2*Math.asin(.5*a/this.rq),i=Math.cos(n),l*=n=Math.sin(n),this.mode===this.OBLIQ?(s=i*this.sinb1+u*n*this.cosb1/a,o=this.qp*s,u=a*this.cosb1*i-u*this.sinb1*n):(s=u*n/a,o=this.qp*s,u=a*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(u=-u),o=l*l+u*u,!o)return t.x=0,t.y=this.phi0,t;s=1-o/this.qp,this.mode===this.S_POLE&&(s=-s)}e=Math.atan2(l,u),r=Dt(Math.asin(s),this.apa)}return t.x=ar(this.long0+e),t.y=r,t}function kt(t){var e,r=[];return r[0]=t*zi,e=t*t,r[0]+=e*ji,r[1]=e*qi,e*=t,r[0]+=e*Ki,r[1]+=e*Zi,r[2]=e*Hi,r}function Dt(t,e){var r=t+t;return t+e[0]*Math.sin(r)+e[1]*Math.sin(r+r)+e[2]*Math.sin(r+r+r)}function Vt(){Math.abs(this.lat1+this.lat2)<Oe||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=nr(this.e3,this.sin_po,this.cos_po),this.qs1=Fi(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=nr(this.e3,this.sin_po,this.cos_po),this.qs2=Fi(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Fi(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>Oe?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Ft(t){var e=t.x,r=t.y;this.sin_phi=Math.sin(r),this.cos_phi=Math.cos(r);var i=Fi(this.e3,this.sin_phi,this.cos_phi),n=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,o=this.ns0*ar(e-this.long0),a=n*Math.sin(o)+this.x0,s=this.rh-n*Math.cos(o)+this.y0;return t.x=a,t.y=s,t}function Gt(t){var e,r,i,n,o,a;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),n=0,0!==e&&(n=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-i*i)/(2*this.ns0)):(r=(this.c-i*i)/this.ns0,a=this.phi1z(this.e3,r)),o=ar(n/this.ns0+this.long0),t.x=o,t.y=a,t}function Bt(t,e){var r,i,n,o,a,s=Xi(.5*e);if(t<Oe)return s;for(var l=t*t,u=1;u<=25;u++)if(r=Math.sin(s),i=Math.cos(s),n=t*r,o=1-n*n,a=.5*o*o/i*(e/(1-l)-r/o+.5/t*Math.log((1-n)/(1+n))),s+=a,Math.abs(a)<=1e-7)return s;return null}function Wt(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Ut(t){var e,r,i,n,o,a,s,l,u=t.x,c=t.y;return i=ar(u-this.long0),e=Math.sin(c),r=Math.cos(c),n=Math.cos(i),a=this.sin_p14*e+this.cos_p14*r*n,o=1,a>0||Math.abs(a)<=Oe?(s=this.x0+this.a*o*r*Math.sin(i)/a,l=this.y0+this.a*o*(this.cos_p14*e-this.sin_p14*r*n)/a):(s=this.x0+this.infinity_dist*r*Math.sin(i),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*r*n)),t.x=s,t.y=l,t}function zt(t){var e,r,i,n,o,a;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(n=Math.atan2(e,this.rc),r=Math.sin(n),i=Math.cos(n),a=Xi(i*this.sin_p14+t.y*r*this.cos_p14/e),o=Math.atan2(t.x*r,e*this.cos_p14*i-t.y*this.sin_p14*r),o=ar(this.long0+o)):(a=this.phic0,o=0),t.x=o,t.y=a,t}function jt(){this.sphere||(this.k0=nr(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Kt(t){var e,r,i=t.x,n=t.y,o=ar(i-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var a=Fi(this.e,Math.sin(n));e=this.x0+this.a*this.k0*o,r=this.y0+this.a*a*.5/this.k0}return t.x=e,t.y=r,t}function qt(t){t.x-=this.x0,t.y-=this.y0;var e,r;return this.sphere?(e=ar(this.long0+t.x/this.a/Math.cos(this.lat_ts)),r=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(r=rn(this.e,2*t.y*this.k0/this.a),e=ar(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=r,t}function Zt(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Ht(t){var e=t.x,r=t.y,i=ar(e-this.long0),n=Ii(r-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*n,t}function $t(t){var e=t.x,r=t.y;return t.x=ar(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=Ii(this.lat0+(r-this.y0)/this.a),t}function Yt(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ni(this.es),this.e1=Ci(this.es),this.e2=Ri(this.es),this.e3=Pi(this.es),this.ml0=this.a*Ai(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Xt(t){var e,r,i,n=t.x,o=t.y,a=ar(n-this.long0);if(i=a*Math.sin(o),this.sphere)Math.abs(o)<=Oe?(e=this.a*a,r=-1*this.a*this.lat0):(e=this.a*Math.sin(i)/Math.tan(o),r=this.a*(Ii(o-this.lat0)+(1-Math.cos(i))/Math.tan(o)));else if(Math.abs(o)<=Oe)e=this.a*a,r=-1*this.ml0;else{var s=Oi(this.a,this.e,Math.sin(o))/Math.tan(o);e=s*Math.sin(i),r=this.a*Ai(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+s*(1-Math.cos(i))}return t.x=e+this.x0,t.y=r+this.y0,t}function Jt(t){var e,r,i,n,o,a,s,l,u;if(i=t.x-this.x0,n=t.y-this.y0,this.sphere)if(Math.abs(n+this.a*this.lat0)<=Oe)e=ar(i/this.a+this.long0),r=0;else{a=this.lat0+n/this.a,s=i*i/this.a/this.a+a*a,l=a;var c;for(o=ln;o;--o)if(c=Math.tan(l),u=-1*(a*(l*c+1)-l-.5*(l*l+s)*c)/((l-a)/c-1),l+=u,Math.abs(u)<=Oe){r=l;break}e=ar(this.long0+Math.asin(i*Math.tan(l)/this.a)/Math.sin(r))}else if(Math.abs(n+this.ml0)<=Oe)r=0,e=ar(this.long0+i/this.a);else{a=(this.ml0+n)/this.a,s=i*i/this.a/this.a+a*a,l=a;var h,f,d,p,g;for(o=ln;o;--o)if(g=this.e*Math.sin(l),h=Math.sqrt(1-g*g)*Math.tan(l),f=this.a*Ai(this.e0,this.e1,this.e2,this.e3,l),d=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),p=f/this.a,u=(a*(h*p+1)-p-.5*h*(p*p+s))/(this.es*Math.sin(2*l)*(p*p+s-2*a*p)/(4*h)+(a-p)*(h*d-2/Math.sin(2*l))-d),l-=u,Math.abs(u)<=Oe){r=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r),e=ar(this.long0+Math.asin(i*h/this.a)/Math.sin(r))}return t.x=e,t.y=r,t}function Qt(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function te(t){var e,r=t.x,i=t.y,n=i-this.lat0,o=r-this.long0,a=n/Ae*1e-5,s=o,l=1,u=0;for(e=1;e<=10;e++)l*=a,u+=this.A[e]*l;var c,h,f=u,d=s,p=1,g=0,m=0,y=0;
for(e=1;e<=6;e++)c=p*f-g*d,h=g*f+p*d,p=c,g=h,m=m+this.B_re[e]*p-this.B_im[e]*g,y=y+this.B_im[e]*p+this.B_re[e]*g;return t.x=y*this.a+this.x0,t.y=m*this.a+this.y0,t}function ee(t){var e,r,i,n=t.x,o=t.y,a=n-this.x0,s=o-this.y0,l=s/this.a,u=a/this.a,c=1,h=0,f=0,d=0;for(e=1;e<=6;e++)r=c*l-h*u,i=h*l+c*u,c=r,h=i,f=f+this.C_re[e]*c-this.C_im[e]*h,d=d+this.C_im[e]*c+this.C_re[e]*h;for(var p=0;p<this.iterations;p++){var g,m,y=f,v=d,b=l,E=u;for(e=2;e<=6;e++)g=y*f-v*d,m=v*f+y*d,y=g,v=m,b+=(e-1)*(this.B_re[e]*y-this.B_im[e]*v),E+=(e-1)*(this.B_im[e]*y+this.B_re[e]*v);y=1,v=0;var w=this.B_re[1],_=this.B_im[1];for(e=2;e<=6;e++)g=y*f-v*d,m=v*f+y*d,y=g,v=m,w+=e*(this.B_re[e]*y-this.B_im[e]*v),_+=e*(this.B_im[e]*y+this.B_re[e]*v);var x=w*w+_*_;f=(b*w+E*_)/x,d=(E*w-b*_)/x}var S=f,T=d,M=1,L=0;for(e=1;e<=9;e++)M*=S,L+=this.D[e]*M;var A=this.lat0+L*Ae*1e5,N=this.long0+T;return t.x=N,t.y=A,t}function re(){}function ie(t){var e=t.x,r=t.y,i=ar(e-this.long0),n=this.x0+this.a*i,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;return t.x=n,t.y=o,t}function ne(t){t.x-=this.x0,t.y-=this.y0;var e=ar(this.long0+t.x/this.a),r=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=r,t}function oe(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=qr(this.es)}function ae(t){var e,r,i=t.x,n=t.y;if(i=ar(i-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(n),a=gn;a;--a){var s=(this.m*n+Math.sin(n)-o)/(this.m+Math.cos(n));if(n-=s,Math.abs(s)<Oe)break}else n=1!==this.n?Math.asin(this.n*Math.sin(n)):n;e=this.a*this.C_x*i*(this.m+Math.cos(n)),r=this.a*this.C_y*n}else{var l=Math.sin(n),u=Math.cos(n);r=this.a*Zr(n,l,u,this.en),e=this.a*i*u/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=r,t}function se(t){var e,r,i,n;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=Xi((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Xi(Math.sin(e)/this.n)),i=ar(i+this.long0),e=Ii(e)):(e=$r(t.y/this.a,this.es,this.en),n=Math.abs(e),n<Ne?(n=Math.sin(e),r=this.long0+t.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)),i=ar(r)):n-Oe<Ne&&(i=this.long0)),t.x=i,t.y=e,t}function le(){}function ue(t){for(var e=t.x,r=t.y,i=ar(e-this.long0),n=r,o=Math.PI*Math.sin(r),a=0;!0;a++){var s=-(n+Math.sin(n)-o)/(1+Math.cos(n));if(n+=s,Math.abs(s)<Oe)break}n/=2,Math.PI/2-Math.abs(r)<Oe&&(i=0);var l=.900316316158*this.a*i*Math.cos(n)+this.x0,u=1.4142135623731*this.a*Math.sin(n)+this.y0;return t.x=l,t.y=u,t}function ce(t){var e,r;t.x-=this.x0,t.y-=this.y0,r=t.y/(1.4142135623731*this.a),Math.abs(r)>.999999999999&&(r=.999999999999),e=Math.asin(r);var i=ar(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),r=(2*e+Math.sin(2*e))/Math.PI,Math.abs(r)>1&&(r=1);var n=Math.asin(r);return t.x=i,t.y=n,t}function he(){Math.abs(this.lat1+this.lat2)<Oe||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ni(this.es),this.e1=Ci(this.es),this.e2=Ri(this.es),this.e3=Pi(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=nr(this.e,this.sinphi,this.cosphi),this.ml1=Ai(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Oe?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=nr(this.e,this.sinphi,this.cosphi),this.ml2=Ai(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ai(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function fe(t){var e,r=t.x,i=t.y;if(this.sphere)e=this.a*(this.g-i);else{var n=Ai(this.e0,this.e1,this.e2,this.e3,i);e=this.a*(this.g-n)}var o=this.ns*ar(r-this.long0),a=this.x0+e*Math.sin(o),s=this.y0+this.rh-e*Math.cos(o);return t.x=a,t.y=s,t}function de(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,r,i,n;this.ns>=0?(r=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(r=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(0!==r&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return n=ar(this.long0+o/this.ns),i=Ii(this.g-r/this.a),t.x=n,t.y=i,t;var a=this.g-r/this.a;return i=ki(a,this.e0,this.e1,this.e2,this.e3),n=ar(this.long0+o/this.ns),t.x=n,t.y=i,t}function pe(){this.R=this.a}function ge(t){var e,r,i=t.x,n=t.y,o=ar(i-this.long0);Math.abs(n)<=Oe&&(e=this.x0+this.R*o,r=this.y0);var a=Xi(2*Math.abs(n/Math.PI));(Math.abs(o)<=Oe||Math.abs(Math.abs(n)-Ne)<=Oe)&&(e=this.x0,r=n>=0?this.y0+Math.PI*this.R*Math.tan(.5*a):this.y0+Math.PI*this.R*-Math.tan(.5*a));var s=.5*Math.abs(Math.PI/o-o/Math.PI),l=s*s,u=Math.sin(a),c=Math.cos(a),h=c/(u+c-1),f=h*h,d=h*(2/u-1),p=d*d,g=Math.PI*this.R*(s*(h-p)+Math.sqrt(l*(h-p)*(h-p)-(p+l)*(f-p)))/(p+l);o<0&&(g=-g),e=this.x0+g;var m=l+h;return g=Math.PI*this.R*(d*m-s*Math.sqrt((p+l)*(l+1)-m*m))/(p+l),r=n>=0?this.y0+g:this.y0-g,t.x=e,t.y=r,t}function me(t){var e,r,i,n,o,a,s,l,u,c,h,f,d;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,i=t.x/h,n=t.y/h,o=i*i+n*n,a=-Math.abs(n)*(1+o),s=a-2*n*n+i*i,l=-2*a+1+2*n*n+o*o,d=n*n/l+(2*s*s*s/l/l/l-9*a*s/l/l)/27,u=(a-s*s/3/l)/l,c=2*Math.sqrt(-u/3),h=3*d/u/c,Math.abs(h)>1&&(h=h>=0?1:-1),f=Math.acos(h)/3,r=t.y>=0?(-c*Math.cos(f+Math.PI/3)-s/3/l)*Math.PI:-(-c*Math.cos(f+Math.PI/3)-s/3/l)*Math.PI,e=Math.abs(i)<Oe?this.long0:ar(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(i*i-n*n)+o*o))/2/i),t.x=e,t.y=r,t}function ye(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function ve(t){var e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E,w,_,x,S=t.x,T=t.y,M=Math.sin(t.y),L=Math.cos(t.y),A=ar(S-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=Oe?(t.x=this.x0+this.a*(Ne-T)*Math.sin(A),t.y=this.y0-this.a*(Ne-T)*Math.cos(A),t):Math.abs(this.sin_p12+1)<=Oe?(t.x=this.x0+this.a*(Ne+T)*Math.sin(A),t.y=this.y0+this.a*(Ne+T)*Math.cos(A),t):(v=this.sin_p12*M+this.cos_p12*L*Math.cos(A),m=Math.acos(v),y=m/Math.sin(m),t.x=this.x0+this.a*y*L*Math.sin(A),t.y=this.y0+this.a*y*(this.cos_p12*M-this.sin_p12*L*Math.cos(A)),t):(e=Ni(this.es),r=Ci(this.es),i=Ri(this.es),n=Pi(this.es),Math.abs(this.sin_p12-1)<=Oe?(o=this.a*Ai(e,r,i,n,Ne),a=this.a*Ai(e,r,i,n,T),t.x=this.x0+(o-a)*Math.sin(A),t.y=this.y0-(o-a)*Math.cos(A),t):Math.abs(this.sin_p12+1)<=Oe?(o=this.a*Ai(e,r,i,n,Ne),a=this.a*Ai(e,r,i,n,T),t.x=this.x0+(o+a)*Math.sin(A),t.y=this.y0+(o+a)*Math.cos(A),t):(s=M/L,l=Oi(this.a,this.e,this.sin_p12),u=Oi(this.a,this.e,M),c=Math.atan((1-this.es)*s+this.es*l*this.sin_p12/(u*L)),h=Math.atan2(Math.sin(A),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(A)),b=0===h?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(h)-Math.PI)<=Oe?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(A)*Math.cos(c)/Math.sin(h)),f=this.e*this.sin_p12/Math.sqrt(1-this.es),d=this.e*this.cos_p12*Math.cos(h)/Math.sqrt(1-this.es),p=f*d,g=d*d,E=b*b,w=E*b,_=w*b,x=_*b,m=l*b*(1-E*g*(1-g)/6+w/8*p*(1-2*g)+_/120*(g*(4-7*g)-3*f*f*(1-7*g))-x/48*p),t.x=this.x0+m*Math.sin(h),t.y=this.y0+m*Math.cos(h),t))}function be(t){t.x-=this.x0,t.y-=this.y0;var e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E,w,_,x;if(this.sphere){if(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*Ne*this.a)return;return r=e/this.a,i=Math.sin(r),n=Math.cos(r),o=this.long0,Math.abs(e)<=Oe?a=this.lat0:(a=Xi(n*this.sin_p12+t.y*i*this.cos_p12/e),s=Math.abs(this.lat0)-Ne,o=ar(Math.abs(s)<=Oe?this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y):this.long0+Math.atan2(t.x*i,e*this.cos_p12*n-t.y*this.sin_p12*i))),t.x=o,t.y=a,t}return l=Ni(this.es),u=Ci(this.es),c=Ri(this.es),h=Pi(this.es),Math.abs(this.sin_p12-1)<=Oe?(f=this.a*Ai(l,u,c,h,Ne),e=Math.sqrt(t.x*t.x+t.y*t.y),d=f-e,a=ki(d/this.a,l,u,c,h),o=ar(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=a,t):Math.abs(this.sin_p12+1)<=Oe?(f=this.a*Ai(l,u,c,h,Ne),e=Math.sqrt(t.x*t.x+t.y*t.y),d=e-f,a=ki(d/this.a,l,u,c,h),o=ar(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=a,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),m=Math.atan2(t.x,t.y),p=Oi(this.a,this.e,this.sin_p12),y=Math.cos(m),v=this.e*this.cos_p12*y,b=-v*v/(1-this.es),E=3*this.es*(1-b)*this.sin_p12*this.cos_p12*y/(1-this.es),w=e/p,_=w-b*(1+b)*Math.pow(w,3)/6-E*(1+3*b)*Math.pow(w,4)/24,x=1-b*_*_/2-w*_*_*_/6,g=Math.asin(this.sin_p12*Math.cos(_)+this.cos_p12*Math.sin(_)*y),o=ar(this.long0+Math.asin(Math.sin(m)*Math.sin(_)/Math.cos(g))),a=Math.atan((1-this.es*x*this.sin_p12/Math.sin(g))*Math.tan(g)/(1-this.es)),t.x=o,t.y=a,t)}function Ee(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function we(t){var e,r,i,n,o,a,s,l,u=t.x,c=t.y;return i=ar(u-this.long0),e=Math.sin(c),r=Math.cos(c),n=Math.cos(i),a=this.sin_p14*e+this.cos_p14*r*n,o=1,(a>0||Math.abs(a)<=Oe)&&(s=this.a*o*r*Math.sin(i),l=this.y0+this.a*o*(this.cos_p14*e-this.sin_p14*r*n)),t.x=s,t.y=l,t}function _e(t){var e,r,i,n,o,a,s;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),r=Xi(e/this.a),i=Math.sin(r),n=Math.cos(r),a=this.long0,Math.abs(e)<=Oe?(s=this.lat0,t.x=a,t.y=s,t):(s=Xi(n*this.sin_p14+t.y*i*this.cos_p14/e),o=Math.abs(this.lat0)-Ne,Math.abs(o)<=Oe?(a=ar(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)),t.x=a,t.y=s,t):(a=ar(this.long0+Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i)),t.x=a,t.y=s,t))}var xe=function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]},Se=1,Te=2,Me=4,Le=5,Ae=484813681109536e-20,Ne=Math.PI/2,Ce=.16666666666666666,Re=.04722222222222222,Pe=.022156084656084655,Oe="undefined"==typeof Number.EPSILON?1e-10:Number.EPSILON,Ie=.017453292519943295,ke=57.29577951308232,De=Math.PI/4,Ve=2*Math.PI,Fe=3.14159265359,Ge={};Ge.greenwich=0,Ge.lisbon=-9.131906111111,Ge.paris=2.337229166667,Ge.bogota=-74.080916666667,Ge.madrid=-3.687938888889,Ge.rome=12.452333333333,Ge.bern=7.439583333333,Ge.jakarta=106.807719444444,Ge.ferro=-17.666666666667,Ge.brussels=4.367975,Ge.stockholm=18.058277777778,Ge.athens=23.7163375,Ge.oslo=10.722916666667;var Be={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},We=/[\s_\-\/\(\)]/g,Ue=function(e){var r,i,n,o={},a=e.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,e){var r=e.split("=");return r.push(!0),t[r[0].toLowerCase()]=r[1],t},{}),s={proj:"projName",datum:"datumCode",rf:function(t){o.rf=parseFloat(t)},lat_0:function(t){o.lat0=t*Ie},lat_1:function(t){o.lat1=t*Ie},lat_2:function(t){o.lat2=t*Ie},lat_ts:function(t){o.lat_ts=t*Ie},lon_0:function(t){o.long0=t*Ie},lon_1:function(t){o.long1=t*Ie},lon_2:function(t){o.long2=t*Ie},alpha:function(t){o.alpha=parseFloat(t)*Ie},lonc:function(t){o.longc=t*Ie},x_0:function(t){o.x0=parseFloat(t)},y_0:function(t){o.y0=parseFloat(t)},k_0:function(t){o.k0=parseFloat(t)},k:function(t){o.k0=parseFloat(t)},a:function(t){o.a=parseFloat(t)},b:function(t){o.b=parseFloat(t)},r_a:function(){o.R_A=!0},zone:function(t){o.zone=parseInt(t,10)},south:function(){o.utmSouth=!0},towgs84:function(t){o.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){o.to_meter=parseFloat(t)},units:function(e){o.units=e;var r=t(Be,e);r&&(o.to_meter=r.to_meter)},from_greenwich:function(t){o.from_greenwich=t*Ie},pm:function(e){var r=t(Ge,e);o.from_greenwich=(r?r:parseFloat(e))*Ie},nadgrids:function(t){"@null"===t?o.datumCode="none":o.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&e.indexOf(t.substr(0,1))!==-1&&e.indexOf(t.substr(1,1))!==-1&&e.indexOf(t.substr(2,1))!==-1&&(o.axis=t)}};for(r in a)i=a[r],r in s?(n=s[r],"function"==typeof n?n(i):o[n]=i):o[r]=i;return"string"==typeof o.datumCode&&"WGS84"!==o.datumCode&&(o.datumCode=o.datumCode.toLowerCase()),o},ze=1,je=2,Ke=3,qe=4,Ze=5,He=-1,$e=/\s/,Ye=/[A-Za-z]/,Xe=/[A-Za-z84]/,Je=/[,\]]/,Qe=/[\d\.E\-\+]/;e.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==qe)for(;$e.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case ze:return this.neutral(t);case je:return this.keyword(t);case qe:return this.quoted(t);case Ze:return this.afterquote(t);case Ke:return this.number(t);case He:return}},e.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=qe);if(Je.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},e.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=ze)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=ze,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=He))):void 0},e.prototype.number=function(t){if(Qe.test(t))return void(this.word+=t);if(Je.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)},e.prototype.quoted=function(t){return'"'===t?void(this.state=Ze):void(this.word+=t)},e.prototype.keyword=function(t){if(Xe.test(t))return void(this.word+=t);if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=ze)}if(Je.test(t))return void this.afterItem(t);throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place)},e.prototype.neutral=function(t){if(Ye.test(t))return this.word=t,void(this.state=je);if('"'===t)return this.word="",void(this.state=qe);if(Qe.test(t))return this.word=t,void(this.state=Ke);if(Je.test(t))return void this.afterItem(t);throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place)},e.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===He)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var tr=.017453292519943295,er=function(t){var e=r(t),i=e.shift(),o=e.shift();e.unshift(["name",o]),e.unshift(["type",i]);var a={};return n(e,a),s(a),a};xe(l);var rr=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],ir=function(t,e){t=t||{};var r,i;if(!e)return t;for(i in e)r=e[i],void 0!==r&&(t[i]=r);return t},nr=function(t,e,r){var i=t*e;return r/Math.sqrt(1-i*i)},or=function(t){return t<0?-1:1},ar=function(t){return Math.abs(t)<=Fe?t:t-or(t)*Ve},sr=function(t,e,r){var i=t*r,n=.5*t;return i=Math.pow((1-i)/(1+i),n),Math.tan(.5*(Ne-e))/i},lr=function(t,e){for(var r,i,n=.5*t,o=Ne-2*Math.atan(e),a=0;a<=15;a++)if(r=t*Math.sin(o),i=Ne-2*Math.atan(e*Math.pow((1-r)/(1+r),n))-o,o+=i,Math.abs(i)<=1e-10)return o;return-9999},ur=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],cr={init:p,forward:g,inverse:m,names:ur},hr=["longlat","identity"],fr={init:y,forward:v,inverse:v,names:hr},dr=[cr,fr],pr={},gr=[],mr={start:w,add:b,get:E},yr={};yr.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},yr.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},yr.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},yr.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},yr.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},yr.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},yr.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},yr.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},yr.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},yr.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},yr.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},yr.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},yr.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},yr.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},yr.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},yr.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},yr.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},yr.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},yr.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},yr.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},yr.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},yr.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},yr.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},yr.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},yr.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},yr.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},yr.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},yr.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},yr.hough={a:6378270,rf:297,ellipseName:"Hough"},yr.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},yr.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},yr.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},yr.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},yr.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},yr.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},yr.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},yr.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},yr.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},yr.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},yr.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},yr.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var vr=yr.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};yr.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var br={};br.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},br.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},br.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},br.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},br.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},br.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},br.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},br.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},br.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},br.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},br.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},br.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},br.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},br.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},br.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},br.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},T.projections=mr,T.projections.start();var Er=function(t,e,r){return M(t,e)?r:t.datum_type===Le||e.datum_type===Le?r:t.es!==e.es||t.a!==e.a||R(t.datum_type)||R(e.datum_type)?(r=L(r,t.es,t.a),R(t.datum_type)&&(r=N(r,t.datum_type,t.datum_params)),R(e.datum_type)&&(r=C(r,e.datum_type,e.datum_params)),A(r,e.es,e.a,e.b)):r},wr=function(t,e,r){var i,n,o,a=r.x,s=r.y,l=r.z||0,u={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==r.z)switch(0===o?(i=a,n="x"):1===o?(i=s,n="y"):(i=l,n="z"),t.axis[o]){case"e":u[n]=i;break;case"w":u[n]=-i;break;case"n":u[n]=i;break;case"s":u[n]=-i;break;case"u":void 0!==r[n]&&(u.z=i);break;case"d":void 0!==r[n]&&(u.z=-i);break;default:return null}return u},_r=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e},xr=T("WGS84"),Sr=6,Tr="AJSAJS",Mr="AFAFAF",Lr=65,Ar=73,Nr=79,Cr=86,Rr=90,Pr={forward:V,inverse:F,toPoint:G};Q.fromMGRS=function(t){return new Q(G(t))},Q.prototype.toMGRS=function(t){return V([this.x,this.y],t)};var Or="2.4.3",Ir=1,kr=.25,Dr=.046875,Vr=.01953125,Fr=.01068115234375,Gr=.75,Br=.46875,Wr=.013020833333333334,Ur=.007120768229166667,zr=.3645833333333333,jr=.005696614583333333,Kr=.3076171875,qr=function(t){var e=[];e[0]=Ir-t*(kr+t*(Dr+t*(Vr+t*Fr))),e[1]=t*(Gr-t*(Dr+t*(Vr+t*Fr)));var r=t*t;return e[2]=r*(Br-t*(Wr+t*Ur)),r*=t,e[3]=r*(zr-t*jr),e[4]=r*t*Kr,e},Zr=function(t,e,r,i){return r*=e,e*=e,i[0]*t-r*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))},Hr=20,$r=function(t,e,r){for(var i=1/(1-e),n=t,o=Hr;o;--o){var a=Math.sin(n),s=1-e*a*a;if(s=(Zr(n,a,Math.cos(n),r)-t)*(s*Math.sqrt(s))*i,n-=s,Math.abs(s)<Oe)return n}return n},Yr=["Transverse_Mercator","Transverse Mercator","tmerc"],Xr={init:tt,forward:et,inverse:rt,names:Yr},Jr=function(t){var e=Math.exp(t);return e=(e-1/e)/2},Qr=function(t,e){t=Math.abs(t),e=Math.abs(e);var r=Math.max(t,e),i=Math.min(t,e)/(r?r:1);return r*Math.sqrt(1+Math.pow(i,2))},ti=function(t){var e=1+t,r=e-1;return 0===r?t:t*Math.log(e)/r},ei=function(t){var e=Math.abs(t);return e=ti(e*(1+e/(Qr(1,e)+1))),t<0?-e:e},ri=function(t,e){for(var r,i=2*Math.cos(2*e),n=t.length-1,o=t[n],a=0;--n>=0;)r=-a+i*o+t[n],a=o,o=r;return e+r*Math.sin(2*e)},ii=function(t,e){for(var r,i=2*Math.cos(e),n=t.length-1,o=t[n],a=0;--n>=0;)r=-a+i*o+t[n],a=o,o=r;return Math.sin(e)*r},ni=function(t){var e=Math.exp(t);return e=(e+1/e)/2},oi=function(t,e,r){for(var i,n,o=Math.sin(e),a=Math.cos(e),s=Jr(r),l=ni(r),u=2*a*l,c=-2*o*s,h=t.length-1,f=t[h],d=0,p=0,g=0;--h>=0;)i=p,n=d,p=f,d=g,f=-i+u*p-c*d+t[h],g=-n+c*p+u*d;return u=o*l,c=a*s,[u*f-c*g,u*g+c*f]},ai=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"],si={init:it,forward:nt,inverse:ot,names:ai},li=function(t,e){if(void 0===t){if(t=Math.floor(30*(ar(e)+Math.PI)/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t},ui="etmerc",ci=["Universal Transverse Mercator System","utm"],hi={init:at,names:ci,dependsOn:ui},fi=function(t,e){return Math.pow((1-t)/(1+t),e)},di=20,pi=["gauss"],gi={init:st,forward:lt,inverse:ut,names:pi},mi=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"],yi={init:ct,forward:ht,inverse:ft,names:mi},vi=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],bi={init:pt,forward:gt,inverse:mt,names:vi,ssfn_:dt},Ei=["somerc"],wi={init:yt,forward:vt,inverse:bt,names:Ei},_i=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"],xi={init:Et,forward:wt,inverse:_t,names:_i},Si=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"],Ti={init:xt,forward:St,inverse:Tt,names:Si},Mi=["Krovak","krovak"],Li={init:Mt,forward:Lt,inverse:At,names:Mi},Ai=function(t,e,r,i,n){return t*n-e*Math.sin(2*n)+r*Math.sin(4*n)-i*Math.sin(6*n)},Ni=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},Ci=function(t){return.375*t*(1+.25*t*(1+.46875*t))},Ri=function(t){return.05859375*t*t*(1+.75*t)},Pi=function(t){return t*t*t*(35/3072)},Oi=function(t,e,r){var i=e*r;return t/Math.sqrt(1-i*i)},Ii=function(t){return Math.abs(t)<Ne?t:t-or(t)*Math.PI},ki=function(t,e,r,i,n){var o,a;o=t/e;for(var s=0;s<15;s++)if(a=(t-(e*o-r*Math.sin(2*o)+i*Math.sin(4*o)-n*Math.sin(6*o)))/(e-2*r*Math.cos(2*o)+4*i*Math.cos(4*o)-6*n*Math.cos(6*o)),o+=a,Math.abs(a)<=1e-10)return o;return NaN},Di=["Cassini","Cassini_Soldner","cass"],Vi={init:Nt,forward:Ct,inverse:Rt,names:Di},Fi=function(t,e){var r;return t>1e-7?(r=t*e,(1-t*t)*(e/(1-r*r)-.5/t*Math.log((1-r)/(1+r)))):2*e},Gi=1,Bi=2,Wi=3,Ui=4,zi=.3333333333333333,ji=.17222222222222222,Ki=.10257936507936508,qi=.06388888888888888,Zi=.0664021164021164,Hi=.016415012942191543,$i=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],Yi={init:Pt,forward:Ot,inverse:It,names:$i,S_POLE:Gi,N_POLE:Bi,EQUIT:Wi,OBLIQ:Ui},Xi=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)},Ji=["Albers_Conic_Equal_Area","Albers","aea"],Qi={init:Vt,forward:Ft,inverse:Gt,names:Ji,phi1z:Bt},tn=["gnom"],en={init:Wt,forward:Ut,inverse:zt,names:tn},rn=function(t,e){var r=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-r)<1e-6)return e<0?-1*Ne:Ne;for(var i,n,o,a,s=Math.asin(.5*e),l=0;l<30;l++)if(n=Math.sin(s),o=Math.cos(s),a=t*n,i=Math.pow(1-a*a,2)/(2*o)*(e/(1-t*t)-n/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),s+=i,Math.abs(i)<=1e-10)return s;return NaN},nn=["cea"],on={init:jt,forward:Kt,inverse:qt,names:nn},an=["Equirectangular","Equidistant_Cylindrical","eqc"],sn={init:Zt,forward:Ht,inverse:$t,names:an},ln=20,un=["Polyconic","poly"],cn={init:Yt,forward:Xt,inverse:Jt,names:un},hn=["New_Zealand_Map_Grid","nzmg"],fn={init:Qt,forward:te,inverse:ee,names:hn},dn=["Miller_Cylindrical","mill"],pn={init:re,forward:ie,inverse:ne,names:dn},gn=20,mn=["Sinusoidal","sinu"],yn={init:oe,forward:ae,inverse:se,names:mn},vn=["Mollweide","moll"],bn={init:le,forward:ue,inverse:ce,names:vn},En=["Equidistant_Conic","eqdc"],wn={init:he,forward:fe,inverse:de,names:En},_n=["Van_der_Grinten_I","VanDerGrinten","vandg"],xn={init:pe,forward:ge,inverse:me,names:_n},Sn=["Azimuthal_Equidistant","aeqd"],Tn={init:ye,forward:ve,inverse:be,names:Sn},Mn=["ortho"],Ln={init:Ee,forward:we,inverse:_e,names:Mn},An=function(t){t.Proj.projections.add(Xr),t.Proj.projections.add(si),t.Proj.projections.add(hi),t.Proj.projections.add(yi),t.Proj.projections.add(bi),t.Proj.projections.add(wi),t.Proj.projections.add(xi),t.Proj.projections.add(Ti),t.Proj.projections.add(Li),t.Proj.projections.add(Vi),t.Proj.projections.add(Yi),t.Proj.projections.add(Qi),t.Proj.projections.add(en),t.Proj.projections.add(on),t.Proj.projections.add(sn),t.Proj.projections.add(cn),t.Proj.projections.add(fn),t.Proj.projections.add(pn),t.Proj.projections.add(yn),t.Proj.projections.add(bn),t.Proj.projections.add(wn),t.Proj.projections.add(xn),t.Proj.projections.add(Tn),t.Proj.projections.add(Ln)};return D.defaultDatum="WGS84",D.Proj=T,D.WGS84=new D.Proj("WGS84"),D.Point=Q,D.toPoint=_r,D.defs=l,D.transform=O,D.mgrs=Pr,D.version=Or,An(D),D}),define("worldwind/formats/geojson/GeoJSONCRS",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger","../../util/proj4-src"],function(t,e,r,i){"use strict";var n=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONCRS","constructor","missingType"));if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONCRS","constructor","missingProperties"));this._type=e,this._properties=i,this._projectionString=null};return Object.defineProperties(n.prototype,{type:{get:function(){return this._type}},properties:{get:function(){return this._properties}},projectionString:{get:function(){return this._projectionString}}}),n.prototype.isDefault=function(){return!(!this.isNamed()||this._projectionString!==e.EPSG4326_CRS&&this._projectionString!==e.WGS84_CRS)},n.prototype.isNamed=function(){return this._type===e.FIELD_CRS_NAME},n.prototype.isLinked=function(){return this._type===e.FIELD_CRS_LINK},n.prototype.isCRSSupported=function(){try{i(this._projectionString,e.EPSG4326_CRS)}catch(t){return r.log(r.LEVEL_WARNING,"Unknown GeoJSON coordinate reference system ("+t+"): "+this._properties.name),!1}return!0},n.prototype.getLinkedCRSString=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="text",i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(this._projectionString=i.response,e()):r.log(r.LEVEL_WARNING,"GeoJSON Linked CRS retrieval failed ("+i.statusText+"): "+t))}.bind(this),i.onerror=function(){r.log(r.LEVEL_WARNING,"GeoJSON Linked CRS retrieval failed: "+t)},i.ontimeout=function(){r.log(r.LEVEL_WARNING,"GeoJSON Linked CRS retrieval timed out: "+t)},i.send(null)},n.prototype.setCRSString=function(t){this.isNamed()?(this._projectionString=this._properties.name,t()):this.isLinked()&&this.getLinkedCRSString(this._properties.href,t)},n}),define("worldwind/formats/geojson/GeoJSONFeature",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(t,e,r){"use strict";var i=function(i,n,o,a){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingGeometry"));if(!i[e.FIELD_TYPE])throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingFeatureGeometryType"));if(!n)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingProperties"));this._geometry=i,this._properties=n,this._id=o,this._bbox=a};return Object.defineProperties(i.prototype,{geometry:{get:function(){return this._geometry}},properties:{get:function(){return this._properties}},id:{get:function(){return this._id}},bbox:{get:function(){return this._bbox}}}),i}),define("worldwind/formats/geojson/GeoJSONFeatureCollection",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(t,e,r){"use strict";var i=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeatureCollection","constructor","missingFeatures"));if("[object Array]"!==Object.prototype.toString.call(e))throw new t(r.logMessage(r.LEVEL_SEVERE,"GeoJSONFeatureCollection","constructor","invalidFeatures"));this._features=e,this._bbox=i};return Object.defineProperties(i.prototype,{features:{get:function(){return this._features}},bbox:{get:function(){return this._bbox}}}),i}),define("worldwind/shapes/PlacemarkAttributes",["../util/Color","../util/Font","../util/Offset","../shapes/ShapeAttributes","../shapes/TextAttributes"],function(t,e,r,i,n){"use strict";var o=function(e){this._imageColor=e?e._imageColor:new t(1,1,1,1),this._imageOffset=e?e._imageOffset:new r(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),this._imageScale=e?e._imageScale:1,this._imageSource=e?e._imageSource:null,this._depthTest=!e||e._depthTest,this._labelAttributes=e?e._labelAttributes:new n(null),this._drawLeaderLine=!!e&&e._drawLeaderLine,this._leaderLineAttributes=e?e._leaderLineAttributes:new i(null),this.stateKeyInvalid=!0};return o.prototype.computeStateKey=function(){return"ic "+this._imageColor.toHexString(!0)+" io "+this._imageOffset.toString()+" is "+this._imageScale+" ip "+this._imageSource+" dt "+this._depthTest+" la "+this._labelAttributes.stateKey+" dll "+this._drawLeaderLine+" lla "+this._leaderLineAttributes.stateKey},Object.defineProperties(o.prototype,{stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}},imageColor:{get:function(){return this._imageColor},set:function(t){this._imageColor=t,this.stateKeyInvalid=!0}},imageOffset:{get:function(){return this._imageOffset},set:function(t){this._imageOffset=t,this.stateKeyInvalid=!0}},imageScale:{get:function(){return this._imageScale},set:function(t){this._imageScale=t,this.stateKeyInvalid=!0}},imageSource:{get:function(){return this._imageSource},set:function(t){this._imageSource=t,this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(t){this._depthTest=t,this.stateKeyInvalid=!0}},labelAttributes:{get:function(){return this._labelAttributes},set:function(t){this._labelAttributes=t,this.stateKeyInvalid=!0}},drawLeaderLine:{get:function(){return this._drawLeaderLine},set:function(t){this._drawLeaderLine=t,this.stateKeyInvalid=!0}},leaderLineAttributes:{get:function(){return this._leaderLineAttributes;
},set:function(t){this._leaderLineAttributes=t,this.stateKeyInvalid=!0}}}),o}),define("worldwind/shapes/Placemark",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Logger","../geom/Matrix","../pick/PickedObject","../shapes/PlacemarkAttributes","../render/Renderable","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h){"use strict";var f=function(e,r,i){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"Placemark","constructor","missingPosition"));l.call(this),this.attributes=i?i:new s(null),this.highlightAttributes=null,this.highlighted=!1,this.position=e,this.eyeDistanceScaling=r,this.eyeDistanceScalingThreshold=1e6,this.eyeDistanceScalingLabelThreshold=1.5*this.eyeDistanceScalingThreshold,this.label=null,this.altitudeMode=WorldWind.ABSOLUTE,this.alwaysOnTop=!1,this.enableLeaderLinePicking=!1,this.updateImage=!0,this.declutterGroup=2,this.targetVisibility=1,this.currentVisibility=1,this.imageRotation=0,this.imageTilt=0,this.imageRotationReference=WorldWind.RELATIVE_TO_SCREEN,this.imageTiltReference=WorldWind.RELATIVE_TO_SCREEN,this.activeAttributes=null,this.activeTexture=null,this.labelTexture=null,this.placePoint=new c(0,0,0),this.groundPoint=new c(0,0,0),this.imageTransform=o.fromIdentity(),this.labelTransform=o.fromIdentity(),this.texCoordMatrix=o.fromIdentity(),this.imageBounds=null,this.layer=null,this.depthOffset=-.003};return f.screenPoint=new c(0,0,0),f.matrix=o.fromIdentity(),f.scratchPoint=new c(0,0,0),f.prototype=Object.create(l.prototype),Object.defineProperties(f.prototype,{screenBounds:{get:function(){return this.labelBounds}}}),f.prototype.copy=function(t){return this.position=t.position,this.attributes=t.attributes,this.highlightAttributes=t.highlightAttributes,this.highlighted=t.highlighted,this.enabled=t.enabled,this.label=t.label,this.altitudeMode=t.altitudeMode,this.pickDelegate=t.pickDelegate,this.alwaysOnTop=t.alwaysOnTop,this.depthOffset=t.depthOffset,this.targetVisibility=t.targetVisibility,this.currentVisibility=t.currentVisibility,this.imageRotation=t.imageRotation,this.imageTilt=t.imageTilt,this.imageRotationReference=t.imageRotationReference,this.imageTiltReference=t.imageTiltReference,this},f.prototype.clone=function(){var t=new f(this.position);return t.copy(this),t.pickDelegate=this.pickDelegate?this.pickDelegate:this,t},f.prototype.render=function(t){if(this.enabled&&t.accumulateOrderedRenderables&&(!t.globe.projectionLimits||t.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude))){var e;if(this.lastFrameTime!==t.timestamp)e=this.makeOrderedRenderable(t);else{var r=this.clone();e=r.makeOrderedRenderable(t)}e&&e.isVisible(t)&&(e.layer=t.currentLayer,this.lastFrameTime=t.timestamp,t.addOrderedRenderable(e))}},f.prototype.renderOrdered=function(t){if(this.drawOrderedPlacemark(t),t.pickingMode){var e=new a(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,this.position,this.layer,!1);t.pickPoint&&this.mustDrawLabel()&&this.labelBounds.containsPoint(t.navigatorState.convertPointToViewport(t.pickPoint,f.scratchPoint))&&(e.labelPicked=!0),t.resolvePick(e)}},f.prototype.makeOrderedRenderable=function(t){var e,r,i,n;if(this.determineActiveAttributes(t),!this.activeAttributes)return null;if(t.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint),this.eyeDistance=this.alwaysOnTop?0:t.navigatorState.eyePoint.distanceTo(this.placePoint),this.mustDrawLeaderLine(t)&&t.surfacePointForMode(this.position.latitude,this.position.longitude,0,this.altitudeMode,this.groundPoint),!t.navigatorState.projectWithDepth(this.placePoint,this.depthOffset,f.screenPoint))return null;var o=this.eyeDistanceScaling?Math.max(0,Math.min(1,this.eyeDistanceScalingThreshold/this.eyeDistance)):1;if(this.activeTexture?(e=this.activeTexture.originalImageWidth,r=this.activeTexture.originalImageHeight,i=this.activeAttributes.imageScale*o,n=this.activeAttributes.imageOffset.offsetForSize(e,r),this.imageTransform.setTranslation(f.screenPoint[0]-n[0]*i,f.screenPoint[1]-n[1]*i,f.screenPoint[2]),this.imageTransform.setScale(e*i,r*i,1)):(i=this.activeAttributes.imageScale*o,n=this.activeAttributes.imageOffset.offsetForSize(i,i),this.imageTransform.setTranslation(f.screenPoint[0]-n[0],f.screenPoint[1]-n[1],f.screenPoint[2]),this.imageTransform.setScale(i,i,1)),this.imageBounds=h.boundingRectForUnitQuad(this.imageTransform),this.mustDrawLabel()){var a=this.activeAttributes.labelAttributes.font,s=this.label+a.toString();this.labelTexture=t.gpuResourceCache.resourceForKey(s),this.labelTexture||(this.labelTexture=t.textSupport.createTexture(t,this.label,a,!0),t.gpuResourceCache.putResource(s,this.labelTexture,this.labelTexture.size)),e=this.labelTexture.imageWidth,r=this.labelTexture.imageHeight,i=this.activeAttributes.labelAttributes.scale*o,n=this.activeAttributes.labelAttributes.offset.offsetForSize(e,r),this.labelTransform.setTranslation(f.screenPoint[0]-n[0]*i,f.screenPoint[1]-n[1]*i,f.screenPoint[2]),this.labelTransform.setScale(e*i,r*i,1),this.labelBounds=h.boundingRectForUnitQuad(this.labelTransform)}return this},f.prototype.determineActiveAttributes=function(t){this.highlighted&&this.highlightAttributes?this.activeAttributes=this.highlightAttributes:this.activeAttributes=this.attributes,this.activeAttributes&&this.activeAttributes.imageSource&&(this.activeTexture=t.gpuResourceCache.resourceForKey(this.activeAttributes.imageSource),this.activeTexture&&!this.updateImage||(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.activeAttributes.imageSource),this.updateImage=!1))},f.prototype.isVisible=function(t){return t.pickingMode?t.pickRectangle&&(this.imageBounds.intersects(t.pickRectangle)||this.mustDrawLabel()&&this.labelBounds.intersects(t.pickRectangle)||this.mustDrawLeaderLine(t)&&t.pickFrustum.intersectsSegment(this.groundPoint,this.placePoint)):this.imageBounds.intersects(t.navigatorState.viewport)||this.mustDrawLabel()&&this.labelBounds.intersects(t.navigatorState.viewport)||this.mustDrawLeaderLine(t)&&t.navigatorState.frustumInModelCoordinates.intersectsSegment(this.groundPoint,this.placePoint)},f.prototype.drawOrderedPlacemark=function(t){this.beginDrawing(t);try{this.doDrawOrderedPlacemark(t),t.pickingMode||this.drawBatchOrderedPlacemarks(t)}finally{this.endDrawing(t)}},f.prototype.drawBatchOrderedPlacemarks=function(t){for(var e;(e=t.peekOrderedRenderable())&&e.doDrawOrderedPlacemark;){t.popOrderedRenderable();try{e.doDrawOrderedPlacemark(t)}catch(t){n.logMessage(n.LEVEL_WARNING,"Placemark","drawBatchOrderedPlacemarks","Error occurred while rendering placemark using batching: "+t.message)}}},f.prototype.beginDrawing=function(t){var r,i=t.currentGlContext;t.findAndBindProgram(e),r=t.currentProgram,i.bindBuffer(i.ARRAY_BUFFER,t.unitQuadBuffer()),i.vertexAttribPointer(r.vertexTexCoordLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.vertexPointLocation),i.enableVertexAttribArray(r.vertexTexCoordLocation),r.loadTextureUnit(i,i.TEXTURE0),r.loadModulateColor(i,t.pickingMode)},f.prototype.endDrawing=function(t){var e=t.currentGlContext,r=t.currentProgram;e.disableVertexAttribArray(r.vertexPointLocation),e.disableVertexAttribArray(r.vertexTexCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null)},f.prototype.doDrawOrderedPlacemark=function(t){var e,r=t.currentGlContext,i=t.currentProgram,n=!0;if(t.pickingMode&&(this.pickColor=t.uniquePickColor()),this.eyeDistanceScaling&&this.eyeDistance>this.eyeDistanceScalingLabelThreshold&&(this.targetVisibility=0),!t.pickingMode&&this.mustDrawLabel()&&this.currentVisibility!=this.targetVisibility){var o=(t.timestamp-t.previousRedrawTimestamp)/t.fadeTime;this.currentVisibility<this.targetVisibility?this.currentVisibility=Math.min(1,this.currentVisibility+o):this.currentVisibility=Math.max(0,this.currentVisibility-o),t.redrawRequested=!0}if(i.loadOpacity(r,t.pickingMode?1:this.layer.opacity),this.mustDrawLeaderLine(t)){this.leaderLinePoints||(this.leaderLinePoints=new Float32Array(6)),this.leaderLinePoints[0]=this.groundPoint[0],this.leaderLinePoints[1]=this.groundPoint[1],this.leaderLinePoints[2]=this.groundPoint[2],this.leaderLinePoints[3]=this.placePoint[0],this.leaderLinePoints[4]=this.placePoint[1],this.leaderLinePoints[5]=this.placePoint[2],this.leaderLineCacheKey||(this.leaderLineCacheKey=t.gpuResourceCache.generateCacheKey());var a=t.gpuResourceCache.resourceForKey(this.leaderLineCacheKey);a||(a=r.createBuffer(),t.gpuResourceCache.putResource(this.leaderLineCacheKey,a,4*this.leaderLinePoints.length)),i.loadTextureEnabled(r,!1),i.loadColor(r,t.pickingMode?this.pickColor:this.activeAttributes.leaderLineAttributes.outlineColor),f.matrix.copy(t.navigatorState.modelviewProjection),i.loadModelviewProjection(r,f.matrix),this.activeAttributes.leaderLineAttributes.depthTest||r.disable(r.DEPTH_TEST),r.lineWidth(this.activeAttributes.leaderLineAttributes.outlineWidth),r.bindBuffer(r.ARRAY_BUFFER,a),r.bufferData(r.ARRAY_BUFFER,this.leaderLinePoints,r.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1),r.vertexAttribPointer(i.vertexPointLocation,3,r.FLOAT,!1,0,0),r.drawArrays(r.LINES,0,2)}this.activeAttributes.depthTest||(n=!1,r.disable(r.DEPTH_TEST)),r.bindBuffer(r.ARRAY_BUFFER,t.unitQuadBuffer3()),r.vertexAttribPointer(i.vertexPointLocation,3,r.FLOAT,!1,0,0),f.matrix.copy(t.screenProjection),f.matrix.multiplyMatrix(this.imageTransform);var s=this.imageRotationReference===WorldWind.RELATIVE_TO_GLOBE?t.navigatorState.heading-this.imageRotation:-this.imageRotation;f.matrix.multiplyByTranslation(.5,.5,0),f.matrix.multiplyByRotation(0,0,1,s),f.matrix.multiplyByTranslation(-.5,-.5,0);var l=this.imageTiltReference===WorldWind.RELATIVE_TO_GLOBE?t.navigatorState.tilt+this.imageTilt:this.imageTilt;f.matrix.multiplyByRotation(-1,0,0,l),i.loadModelviewProjection(r,f.matrix),i.loadTextureEnabled(r,!0),t.pickingMode?i.loadColor(r,this.pickColor):i.loadColor(r,this.activeAttributes.imageColor),this.texCoordMatrix.setToIdentity(),this.activeTexture&&this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture),i.loadTextureMatrix(r,this.texCoordMatrix),this.activeTexture?(e=this.activeTexture.bind(t),i.loadTextureEnabled(r,e)):i.loadTextureEnabled(r,!1),r.drawArrays(r.TRIANGLE_STRIP,0,4),this.mustDrawLabel()&&this.currentVisibility>0&&(i.loadOpacity(r,t.pickingMode?1:this.layer.opacity*this.currentVisibility),f.matrix.copy(t.screenProjection),f.matrix.multiplyMatrix(this.labelTransform),i.loadModelviewProjection(r,f.matrix),!t.pickingMode&&this.labelTexture?(this.texCoordMatrix.setToIdentity(),this.texCoordMatrix.multiplyByTextureTransform(this.labelTexture),i.loadTextureMatrix(r,this.texCoordMatrix),i.loadColor(r,this.activeAttributes.labelAttributes.color),e=this.labelTexture.bind(t),i.loadTextureEnabled(r,e)):(i.loadTextureEnabled(r,!1),i.loadColor(r,this.pickColor)),this.activeAttributes.labelAttributes.depthTest?n||(n=!0,r.enable(r.DEPTH_TEST)):(n=!1,r.disable(r.DEPTH_TEST)),r.drawArrays(r.TRIANGLE_STRIP,0,4)),n||r.enable(r.DEPTH_TEST)},f.prototype.mustDrawLabel=function(){return this.label&&this.label.length>0&&this.activeAttributes.labelAttributes},f.prototype.mustDrawLeaderLine=function(t){return this.activeAttributes.drawLeaderLine&&this.activeAttributes.leaderLineAttributes&&(!t.pickingMode||this.enableLeaderLinePicking)},f});var libtess={};libtess.DEBUG=!1,libtess.assert=function(t,e){if(libtess.DEBUG&&!t)throw new Error("Assertion failed"+(e?": "+e:""))},libtess.GLU_TESS_MAX_COORD=1e150,libtess.TRUE_PROJECT=!1,libtess.TESS_MAX_CACHE=100,libtess.GLU_TESS_DEFAULT_TOLERANCE=0,libtess.windingRule={GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},libtess.primitiveType={GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},libtess.errorType={GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},libtess.gluEnum={GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},libtess.PQHandle,libtess.PQKey,libtess.geom={},libtess.geom.vertEq=function(t,e){return t.s===e.s&&t.t===e.t},libtess.geom.vertLeq=function(t,e){return t.s<e.s||t.s===e.s&&t.t<=e.t},libtess.geom.edgeEval=function(t,e,r){var i=e.s-t.s,n=r.s-e.s;return i+n>0?i<n?e.t-t.t+(t.t-r.t)*(i/(i+n)):e.t-r.t+(r.t-t.t)*(n/(i+n)):0},libtess.geom.edgeSign=function(t,e,r){var i=e.s-t.s,n=r.s-e.s;return i+n>0?(e.t-r.t)*i+(e.t-t.t)*n:0},libtess.geom.transLeq=function(t,e){return t.t<e.t||t.t===e.t&&t.s<=e.s},libtess.geom.transEval=function(t,e,r){var i=e.t-t.t,n=r.t-e.t;return i+n>0?i<n?e.s-t.s+(t.s-r.s)*(i/(i+n)):e.s-r.s+(r.s-t.s)*(n/(i+n)):0},libtess.geom.transSign=function(t,e,r){var i=e.t-t.t,n=r.t-e.t;return i+n>0?(e.s-r.s)*i+(e.s-t.s)*n:0},libtess.geom.edgeGoesLeft=function(t){return libtess.geom.vertLeq(t.dst(),t.org)},libtess.geom.edgeGoesRight=function(t){return libtess.geom.vertLeq(t.org,t.dst())},libtess.geom.vertL1dist=function(t,e){return Math.abs(t.s-e.s)+Math.abs(t.t-e.t)},libtess.geom.vertCCW=function(t,e,r){return t.s*(e.t-r.t)+e.s*(r.t-t.t)+r.s*(t.t-e.t)>=0},libtess.geom.interpolate_=function(t,e,r,i){return t=t<0?0:t,r=r<0?0:r,t<=r?0===r?(e+i)/2:e+(i-e)*(t/(t+r)):i+(e-i)*(r/(t+r))},libtess.geom.edgeIntersect=function(t,e,r,i,n){var o,a,s;libtess.geom.vertLeq(t,e)||(s=t,t=e,e=s),libtess.geom.vertLeq(r,i)||(s=r,r=i,i=s),libtess.geom.vertLeq(t,r)||(s=t,t=r,r=s,s=e,e=i,i=s),libtess.geom.vertLeq(r,e)?libtess.geom.vertLeq(e,i)?(o=libtess.geom.edgeEval(t,r,e),a=libtess.geom.edgeEval(r,e,i),o+a<0&&(o=-o,a=-a),n.s=libtess.geom.interpolate_(o,r.s,a,e.s)):(o=libtess.geom.edgeSign(t,r,e),a=-libtess.geom.edgeSign(t,i,e),o+a<0&&(o=-o,a=-a),n.s=libtess.geom.interpolate_(o,r.s,a,i.s)):n.s=(r.s+e.s)/2,libtess.geom.transLeq(t,e)||(s=t,t=e,e=s),libtess.geom.transLeq(r,i)||(s=r,r=i,i=s),libtess.geom.transLeq(t,r)||(s=t,t=r,r=s,s=e,e=i,i=s),libtess.geom.transLeq(r,e)?libtess.geom.transLeq(e,i)?(o=libtess.geom.transEval(t,r,e),a=libtess.geom.transEval(r,e,i),o+a<0&&(o=-o,a=-a),n.t=libtess.geom.interpolate_(o,r.t,a,e.t)):(o=libtess.geom.transSign(t,r,e),a=-libtess.geom.transSign(t,i,e),o+a<0&&(o=-o,a=-a),n.t=libtess.geom.interpolate_(o,r.t,a,i.t)):n.t=(r.t+e.t)/2},libtess.mesh={},libtess.mesh.makeEdge=function(t){var e=libtess.mesh.makeEdgePair_(t.eHead);return libtess.mesh.makeVertex_(e,t.vHead),libtess.mesh.makeVertex_(e.sym,t.vHead),libtess.mesh.makeFace_(e,t.fHead),e},libtess.mesh.meshSplice=function(t,e){var r=!1,i=!1;t!==e&&(e.org!==t.org&&(i=!0,libtess.mesh.killVertex_(e.org,t.org)),e.lFace!==t.lFace&&(r=!0,libtess.mesh.killFace_(e.lFace,t.lFace)),libtess.mesh.splice_(e,t),i||(libtess.mesh.makeVertex_(e,t.org),t.org.anEdge=t),r||(libtess.mesh.makeFace_(e,t.lFace),t.lFace.anEdge=t))},libtess.mesh.deleteEdge=function(t){var e=t.sym,r=!1;t.lFace!==t.rFace()&&(r=!0,libtess.mesh.killFace_(t.lFace,t.rFace())),t.oNext===t?libtess.mesh.killVertex_(t.org,null):(t.rFace().anEdge=t.oPrev(),t.org.anEdge=t.oNext,libtess.mesh.splice_(t,t.oPrev()),r||libtess.mesh.makeFace_(t,t.lFace)),e.oNext===e?(libtess.mesh.killVertex_(e.org,null),libtess.mesh.killFace_(e.lFace,null)):(t.lFace.anEdge=e.oPrev(),e.org.anEdge=e.oNext,libtess.mesh.splice_(e,e.oPrev())),libtess.mesh.killEdge_(t)},libtess.mesh.addEdgeVertex=function(t){var e=libtess.mesh.makeEdgePair_(t),r=e.sym;return libtess.mesh.splice_(e,t.lNext),e.org=t.dst(),libtess.mesh.makeVertex_(r,e.org),e.lFace=r.lFace=t.lFace,e},libtess.mesh.splitEdge=function(t){var e=libtess.mesh.addEdgeVertex(t),r=e.sym;return libtess.mesh.splice_(t.sym,t.sym.oPrev()),libtess.mesh.splice_(t.sym,r),t.sym.org=r.org,r.dst().anEdge=r.sym,r.sym.lFace=t.rFace(),r.winding=t.winding,r.sym.winding=t.sym.winding,r},libtess.mesh.connect=function(t,e){var r=!1,i=libtess.mesh.makeEdgePair_(t),n=i.sym;return e.lFace!==t.lFace&&(r=!0,libtess.mesh.killFace_(e.lFace,t.lFace)),libtess.mesh.splice_(i,t.lNext),libtess.mesh.splice_(n,e),i.org=t.dst(),n.org=e.org,i.lFace=n.lFace=t.lFace,t.lFace.anEdge=n,r||libtess.mesh.makeFace_(i,t.lFace),i},libtess.mesh.zapFace=function(t){var e,r=t.anEdge,i=r.lNext;do if(e=i,i=e.lNext,e.lFace=null,null===e.rFace()){e.oNext===e?libtess.mesh.killVertex_(e.org,null):(e.org.anEdge=e.oNext,libtess.mesh.splice_(e,e.oPrev()));var n=e.sym;n.oNext===n?libtess.mesh.killVertex_(n.org,null):(n.org.anEdge=n.oNext,libtess.mesh.splice_(n,n.oPrev())),libtess.mesh.killEdge_(e)}while(e!==r);var o=t.prev,a=t.next;a.prev=o,o.next=a},libtess.mesh.meshUnion=function(t,e){var r=t.fHead,i=t.vHead,n=t.eHead,o=e.fHead,a=e.vHead,s=e.eHead;return o.next!==o&&(r.prev.next=o.next,o.next.prev=r.prev,o.prev.next=r,r.prev=o.prev),a.next!==a&&(i.prev.next=a.next,a.next.prev=i.prev,a.prev.next=i,i.prev=a.prev),s.next!==s&&(n.sym.next.sym.next=s.next,s.next.sym.next=n.sym.next,s.sym.next.sym.next=n,n.sym.next=s.sym.next),t},libtess.mesh.deleteMesh=function(t){},libtess.mesh.makeEdgePair_=function(t){var e=new libtess.GluHalfEdge,r=new libtess.GluHalfEdge,i=t.sym.next;return r.next=i,i.sym.next=e,e.next=t,t.sym.next=r,e.sym=r,e.oNext=e,e.lNext=r,r.sym=e,r.oNext=r,r.lNext=e,e},libtess.mesh.splice_=function(t,e){var r=t.oNext,i=e.oNext;r.sym.lNext=e,i.sym.lNext=t,t.oNext=i,e.oNext=r},libtess.mesh.makeVertex_=function(t,e){var r=e.prev,i=new libtess.GluVertex(e,r);r.next=i,e.prev=i,i.anEdge=t;var n=t;do n.org=i,n=n.oNext;while(n!==t)},libtess.mesh.makeFace_=function(t,e){var r=e.prev,i=new libtess.GluFace(e,r);r.next=i,e.prev=i,i.anEdge=t,i.inside=e.inside;var n=t;do n.lFace=i,n=n.lNext;while(n!==t)},libtess.mesh.killEdge_=function(t){var e=t.next,r=t.sym.next;e.sym.next=r,r.sym.next=e},libtess.mesh.killVertex_=function(t,e){var r=t.anEdge,i=r;do i.org=e,i=i.oNext;while(i!==r);var n=t.prev,o=t.next;o.prev=n,n.next=o},libtess.mesh.killFace_=function(t,e){var r=t.anEdge,i=r;do i.lFace=e,i=i.lNext;while(i!==r);var n=t.prev,o=t.next;o.prev=n,n.next=o},libtess.normal={},libtess.normal.S_UNIT_X_=1,libtess.normal.S_UNIT_Y_=0,libtess.normal.projectPolygon=function(t){var e=!1,r=[t.normal[0],t.normal[1],t.normal[2]];0===r[0]&&0===r[1]&&0===r[2]&&(libtess.normal.computeNormal_(t,r),e=!0);var i=t.sUnit,n=t.tUnit,o=libtess.normal.longAxis_(r);if(libtess.TRUE_PROJECT){libtess.normal.normalize_(r),i[o]=0,i[(o+1)%3]=libtess.normal.S_UNIT_X_,i[(o+2)%3]=libtess.normal.S_UNIT_Y_;var a=libtess.normal.dot_(i,r);i[0]-=a*r[0],i[1]-=a*r[1],i[2]-=a*r[2],libtess.normal.normalize_(i),n[0]=r[1]*i[2]-r[2]*i[1],n[1]=r[2]*i[0]-r[0]*i[2],n[2]=r[0]*i[1]-r[1]*i[0],libtess.normal.normalize_(n)}else i[o]=0,i[(o+1)%3]=libtess.normal.S_UNIT_X_,i[(o+2)%3]=libtess.normal.S_UNIT_Y_,n[o]=0,n[(o+1)%3]=r[o]>0?-libtess.normal.S_UNIT_Y_:libtess.normal.S_UNIT_Y_,n[(o+2)%3]=r[o]>0?libtess.normal.S_UNIT_X_:-libtess.normal.S_UNIT_X_;for(var s=t.mesh.vHead,l=s.next;l!==s;l=l.next)l.s=libtess.normal.dot_(l.coords,i),l.t=libtess.normal.dot_(l.coords,n);e&&libtess.normal.checkOrientation_(t)},libtess.normal.dot_=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},libtess.normal.normalize_=function(t){var e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];e=Math.sqrt(e),t[0]/=e,t[1]/=e,t[2]/=e},libtess.normal.longAxis_=function(t){var e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e},libtess.normal.computeNormal_=function(t,e){var r,i=[-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD],n=[2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD],o=[],a=[],s=t.mesh.vHead;for(r=s.next;r!==s;r=r.next)for(var l=0;l<3;++l){var u=r.coords[l];u<n[l]&&(n[l]=u,a[l]=r),u>i[l]&&(i[l]=u,o[l]=r)}var c=0;if(i[1]-n[1]>i[0]-n[0]&&(c=1),i[2]-n[2]>i[c]-n[c]&&(c=2),n[c]>=i[c])return e[0]=0,e[1]=0,void(e[2]=1);var h=0,f=a[c],d=o[c],p=[0,0,0],g=[f.coords[0]-d.coords[0],f.coords[1]-d.coords[1],f.coords[2]-d.coords[2]],m=[0,0,0];for(r=s.next;r!==s;r=r.next){m[0]=r.coords[0]-d.coords[0],m[1]=r.coords[1]-d.coords[1],m[2]=r.coords[2]-d.coords[2],p[0]=g[1]*m[2]-g[2]*m[1],p[1]=g[2]*m[0]-g[0]*m[2],p[2]=g[0]*m[1]-g[1]*m[0];var y=p[0]*p[0]+p[1]*p[1]+p[2]*p[2];y>h&&(h=y,e[0]=p[0],e[1]=p[1],e[2]=p[2])}h<=0&&(e[0]=e[1]=e[2]=0,e[libtess.normal.longAxis_(g)]=1)},libtess.normal.checkOrientation_=function(t){for(var e=0,r=t.mesh.fHead,i=r.next;i!==r;i=i.next){var n=i.anEdge;if(!(n.winding<=0))do e+=(n.org.s-n.dst().s)*(n.org.t+n.dst().t),n=n.lNext;while(n!==i.anEdge)}if(e<0){for(var o=t.mesh.vHead,a=o.next;a!==o;a=a.next)a.t=-a.t;t.tUnit[0]=-t.tUnit[0],t.tUnit[1]=-t.tUnit[1],t.tUnit[2]=-t.tUnit[2]}},libtess.render={},libtess.render.renderMesh=function(t,e,r){for(var i=!1,n=-1,o=e.fHead.prev;o!==e.fHead;o=o.prev)if(o.inside){i||(t.callBeginOrBeginData(libtess.primitiveType.GL_TRIANGLES),i=!0);var a=o.anEdge;do{if(r){var s=a.rFace().inside?0:1;n!==s&&(n=s,t.callEdgeFlagOrEdgeFlagData(!!n))}t.callVertexOrVertexData(a.org.data),a=a.lNext}while(a!==o.anEdge)}i&&t.callEndOrEndData()},libtess.render.renderBoundary=function(t,e){for(var r=e.fHead.next;r!==e.fHead;r=r.next)if(r.inside){t.callBeginOrBeginData(libtess.primitiveType.GL_LINE_LOOP);var i=r.anEdge;do t.callVertexOrVertexData(i.org.data),i=i.lNext;while(i!==r.anEdge);t.callEndOrEndData()}},libtess.sweep={},libtess.sweep.SENTINEL_COORD_=4*libtess.GLU_TESS_MAX_COORD,libtess.sweep.TOLERANCE_NONZERO_=!1,libtess.sweep.computeInterior=function(t){t.fatalError=!1,libtess.sweep.removeDegenerateEdges_(t),libtess.sweep.initPriorityQ_(t),libtess.sweep.initEdgeDict_(t);for(var e;null!==(e=t.pq.extractMin());){for(;;){var r=t.pq.minimum();if(null===r||!libtess.geom.vertEq(r,e))break;r=t.pq.extractMin(),libtess.sweep.spliceMergeVertices_(t,e.anEdge,r.anEdge)}libtess.sweep.sweepEvent_(t,e)}var i=t.dict.getMin().getKey();t.event=i.eUp.org,libtess.sweep.doneEdgeDict_(t),libtess.sweep.donePriorityQ_(t),libtess.sweep.removeDegenerateFaces_(t.mesh),t.mesh.checkMesh()},libtess.sweep.addWinding_=function(t,e){t.winding+=e.winding,t.sym.winding+=e.sym.winding},libtess.sweep.edgeLeq_=function(t,e,r){var i=t.event,n=e.eUp,o=r.eUp;if(n.dst()===i)return o.dst()===i?libtess.geom.vertLeq(n.org,o.org)?libtess.geom.edgeSign(o.dst(),n.org,o.org)<=0:libtess.geom.edgeSign(n.dst(),o.org,n.org)>=0:libtess.geom.edgeSign(o.dst(),i,o.org)<=0;if(o.dst()===i)return libtess.geom.edgeSign(n.dst(),i,n.org)>=0;var a=libtess.geom.edgeEval(n.dst(),i,n.org),s=libtess.geom.edgeEval(o.dst(),i,o.org);return a>=s},libtess.sweep.deleteRegion_=function(t,e){e.fixUpperEdge,e.eUp.activeRegion=null,t.dict.deleteNode(e.nodeUp),e.nodeUp=null},libtess.sweep.fixUpperEdge_=function(t,e){libtess.mesh.deleteEdge(t.eUp),t.fixUpperEdge=!1,t.eUp=e,e.activeRegion=t},libtess.sweep.topLeftRegion_=function(t){var e=t.eUp.org;do t=t.regionAbove();while(t.eUp.org===e);if(t.fixUpperEdge){var r=libtess.mesh.connect(t.regionBelow().eUp.sym,t.eUp.lNext);libtess.sweep.fixUpperEdge_(t,r),t=t.regionAbove()}return t},libtess.sweep.topRightRegion_=function(t){var e=t.eUp.dst();do t=t.regionAbove();while(t.eUp.dst()===e);return t},libtess.sweep.addRegionBelow_=function(t,e,r){var i=new libtess.ActiveRegion;return i.eUp=r,i.nodeUp=t.dict.insertBefore(e.nodeUp,i),r.activeRegion=i,i},libtess.sweep.isWindingInside_=function(t,e){switch(t.windingRule){case libtess.windingRule.GLU_TESS_WINDING_ODD:return 0!==(1&e);case libtess.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==e;case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:return e>0;case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:return e<0;case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return e>=2||e<=-2}return!1},libtess.sweep.computeWinding_=function(t,e){e.windingNumber=e.regionAbove().windingNumber+e.eUp.winding,e.inside=libtess.sweep.isWindingInside_(t,e.windingNumber)},libtess.sweep.finishRegion_=function(t,e){var r=e.eUp,i=r.lFace;i.inside=e.inside,i.anEdge=r,libtess.sweep.deleteRegion_(t,e)},libtess.sweep.finishLeftRegions_=function(t,e,r){for(var i=e,n=e.eUp;i!==r;){i.fixUpperEdge=!1;var o=i.regionBelow(),a=o.eUp;if(a.org!==n.org){if(!o.fixUpperEdge){libtess.sweep.finishRegion_(t,i);break}a=libtess.mesh.connect(n.lPrev(),a.sym),libtess.sweep.fixUpperEdge_(o,a)}n.oNext!==a&&(libtess.mesh.meshSplice(a.oPrev(),a),libtess.mesh.meshSplice(n,a)),libtess.sweep.finishRegion_(t,i),n=o.eUp,i=o}return n},libtess.sweep.addRightEdges_=function(t,e,r,i,n,o){var a=!0,s=r;do libtess.sweep.addRegionBelow_(t,e,s.sym),s=s.oNext;while(s!==i);null===n&&(n=e.regionBelow().eUp.rPrev());for(var l,u=e,c=n;l=u.regionBelow(),s=l.eUp.sym,s.org===c.org;)s.oNext!==c&&(libtess.mesh.meshSplice(s.oPrev(),s),libtess.mesh.meshSplice(c.oPrev(),s)),l.windingNumber=u.windingNumber-s.winding,l.inside=libtess.sweep.isWindingInside_(t,l.windingNumber),u.dirty=!0,!a&&libtess.sweep.checkForRightSplice_(t,u)&&(libtess.sweep.addWinding_(s,c),libtess.sweep.deleteRegion_(t,u),libtess.mesh.deleteEdge(c)),a=!1,u=l,c=s;u.dirty=!0,o&&libtess.sweep.walkDirtyRegions_(t,u)},libtess.sweep.callCombine_=function(t,e,r,i,n){var o=[e.coords[0],e.coords[1],e.coords[2]];e.data=null,e.data=t.callCombineOrCombineData(o,r,i),null===e.data&&(n?t.fatalError||(t.callErrorOrErrorData(libtess.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),t.fatalError=!0):e.data=r[0])},libtess.sweep.spliceMergeVertices_=function(t,e,r){var i=[null,null,null,null],n=[.5,.5,0,0];i[0]=e.org.data,i[1]=r.org.data,libtess.sweep.callCombine_(t,e.org,i,n,!1),libtess.mesh.meshSplice(e,r)},libtess.sweep.vertexWeights_=function(t,e,r,i,n){var o=libtess.geom.vertL1dist(e,t),a=libtess.geom.vertL1dist(r,t),s=n,l=n+1;i[s]=.5*a/(o+a),i[l]=.5*o/(o+a),t.coords[0]+=i[s]*e.coords[0]+i[l]*r.coords[0],t.coords[1]+=i[s]*e.coords[1]+i[l]*r.coords[1],t.coords[2]+=i[s]*e.coords[2]+i[l]*r.coords[2]},libtess.sweep.getIntersectData_=function(t,e,r,i,n,o){var a=[0,0,0,0],s=[r.data,i.data,n.data,o.data];e.coords[0]=e.coords[1]=e.coords[2]=0,libtess.sweep.vertexWeights_(e,r,i,a,0),libtess.sweep.vertexWeights_(e,n,o,a,2),libtess.sweep.callCombine_(t,e,s,a,!0)},libtess.sweep.checkForRightSplice_=function(t,e){var r=e.regionBelow(),i=e.eUp,n=r.eUp;if(libtess.geom.vertLeq(i.org,n.org)){if(libtess.geom.edgeSign(n.dst(),i.org,n.org)>0)return!1;libtess.geom.vertEq(i.org,n.org)?i.org!==n.org&&(t.pq.remove(i.org.pqHandle),libtess.sweep.spliceMergeVertices_(t,n.oPrev(),i)):(libtess.mesh.splitEdge(n.sym),libtess.mesh.meshSplice(i,n.oPrev()),e.dirty=r.dirty=!0)}else{if(libtess.geom.edgeSign(i.dst(),n.org,i.org)<0)return!1;e.regionAbove().dirty=e.dirty=!0,libtess.mesh.splitEdge(i.sym),libtess.mesh.meshSplice(n.oPrev(),i)}return!0},libtess.sweep.checkForLeftSplice_=function(t,e){var r,i=e.regionBelow(),n=e.eUp,o=i.eUp;if(libtess.geom.vertLeq(n.dst(),o.dst())){if(libtess.geom.edgeSign(n.dst(),o.dst(),n.org)<0)return!1;e.regionAbove().dirty=e.dirty=!0,r=libtess.mesh.splitEdge(n),libtess.mesh.meshSplice(o.sym,r),r.lFace.inside=e.inside}else{if(libtess.geom.edgeSign(o.dst(),n.dst(),o.org)>0)return!1;e.dirty=i.dirty=!0,r=libtess.mesh.splitEdge(o),libtess.mesh.meshSplice(n.lNext,o.sym),r.rFace().inside=e.inside}return!0},libtess.sweep.checkForIntersect_=function(t,e){var r=e.regionBelow(),i=e.eUp,n=r.eUp,o=i.org,a=n.org,s=i.dst(),l=n.dst(),u=new libtess.GluVertex;if(o===a)return!1;var c=Math.min(o.t,s.t),h=Math.max(a.t,l.t);if(c>h)return!1;if(libtess.geom.vertLeq(o,a)){if(libtess.geom.edgeSign(l,o,a)>0)return!1}else if(libtess.geom.edgeSign(s,a,o)<0)return!1;libtess.geom.edgeIntersect(s,o,l,a,u),libtess.geom.vertLeq(u,t.event)&&(u.s=t.event.s,u.t=t.event.t);var f=libtess.geom.vertLeq(o,a)?o:a;if(libtess.geom.vertLeq(f,u)&&(u.s=f.s,u.t=f.t),libtess.geom.vertEq(u,o)||libtess.geom.vertEq(u,a))return libtess.sweep.checkForRightSplice_(t,e),!1;if(!libtess.geom.vertEq(s,t.event)&&libtess.geom.edgeSign(s,t.event,u)>=0||!libtess.geom.vertEq(l,t.event)&&libtess.geom.edgeSign(l,t.event,u)<=0){if(l===t.event)return libtess.mesh.splitEdge(i.sym),libtess.mesh.meshSplice(n.sym,i),e=libtess.sweep.topLeftRegion_(e),i=e.regionBelow().eUp,libtess.sweep.finishLeftRegions_(t,e.regionBelow(),r),libtess.sweep.addRightEdges_(t,e,i.oPrev(),i,i,!0),!0;if(s===t.event){libtess.mesh.splitEdge(n.sym),libtess.mesh.meshSplice(i.lNext,n.oPrev()),r=e,e=libtess.sweep.topRightRegion_(e);var d=e.regionBelow().eUp.rPrev();return r.eUp=n.oPrev(),n=libtess.sweep.finishLeftRegions_(t,r,null),libtess.sweep.addRightEdges_(t,e,n.oNext,i.rPrev(),d,!0),!0}return libtess.geom.edgeSign(s,t.event,u)>=0&&(e.regionAbove().dirty=e.dirty=!0,libtess.mesh.splitEdge(i.sym),i.org.s=t.event.s,i.org.t=t.event.t),libtess.geom.edgeSign(l,t.event,u)<=0&&(e.dirty=r.dirty=!0,libtess.mesh.splitEdge(n.sym),n.org.s=t.event.s,n.org.t=t.event.t),!1}return libtess.mesh.splitEdge(i.sym),libtess.mesh.splitEdge(n.sym),libtess.mesh.meshSplice(n.oPrev(),i),i.org.s=u.s,i.org.t=u.t,i.org.pqHandle=t.pq.insert(i.org),libtess.sweep.getIntersectData_(t,i.org,o,s,a,l),e.regionAbove().dirty=e.dirty=r.dirty=!0,!1},libtess.sweep.walkDirtyRegions_=function(t,e){for(var r=e.regionBelow();;){for(;r.dirty;)e=r,r=r.regionBelow();if(!e.dirty&&(r=e,e=e.regionAbove(),null===e||!e.dirty))return;e.dirty=!1;var i=e.eUp,n=r.eUp;if(i.dst()!==n.dst()&&libtess.sweep.checkForLeftSplice_(t,e)&&(r.fixUpperEdge?(libtess.sweep.deleteRegion_(t,r),libtess.mesh.deleteEdge(n),r=e.regionBelow(),n=r.eUp):e.fixUpperEdge&&(libtess.sweep.deleteRegion_(t,e),libtess.mesh.deleteEdge(i),e=r.regionAbove(),i=e.eUp)),i.org!==n.org)if(i.dst()===n.dst()||e.fixUpperEdge||r.fixUpperEdge||i.dst()!==t.event&&n.dst()!==t.event)libtess.sweep.checkForRightSplice_(t,e);else if(libtess.sweep.checkForIntersect_(t,e))return;i.org===n.org&&i.dst()===n.dst()&&(libtess.sweep.addWinding_(n,i),libtess.sweep.deleteRegion_(t,e),libtess.mesh.deleteEdge(i),e=r.regionAbove())}},libtess.sweep.connectRightVertex_=function(t,e,r){var i=r.oNext,n=e.regionBelow(),o=e.eUp,a=n.eUp,s=!1;if(o.dst()!==a.dst()&&libtess.sweep.checkForIntersect_(t,e),libtess.geom.vertEq(o.org,t.event)&&(libtess.mesh.meshSplice(i.oPrev(),o),e=libtess.sweep.topLeftRegion_(e),i=e.regionBelow().eUp,libtess.sweep.finishLeftRegions_(t,e.regionBelow(),n),s=!0),libtess.geom.vertEq(a.org,t.event)&&(libtess.mesh.meshSplice(r,a.oPrev()),r=libtess.sweep.finishLeftRegions_(t,n,null),s=!0),s)return void libtess.sweep.addRightEdges_(t,e,r.oNext,i,i,!0);var l;l=libtess.geom.vertLeq(a.org,o.org)?a.oPrev():o,l=libtess.mesh.connect(r.lPrev(),l),libtess.sweep.addRightEdges_(t,e,l,l.oNext,l.oNext,!1),l.sym.activeRegion.fixUpperEdge=!0,libtess.sweep.walkDirtyRegions_(t,e)},libtess.sweep.connectLeftDegenerate_=function(t,e,r){var i=e.eUp;if(libtess.geom.vertEq(i.org,r))return void(libtess.sweep.TOLERANCE_NONZERO_&&libtess.sweep.spliceMergeVertices_(t,i,r.anEdge));if(!libtess.geom.vertEq(i.dst(),r))return libtess.mesh.splitEdge(i.sym),e.fixUpperEdge&&(libtess.mesh.deleteEdge(i.oNext),e.fixUpperEdge=!1),libtess.mesh.meshSplice(r.anEdge,i),void libtess.sweep.sweepEvent_(t,r);if(libtess.sweep.TOLERANCE_NONZERO_){e=libtess.sweep.topRightRegion_(e);var n=e.regionBelow(),o=n.eUp.sym,a=o.oNext,s=a;n.fixUpperEdge&&(libtess.sweep.deleteRegion_(t,n),libtess.mesh.deleteEdge(o),o=a.oPrev()),libtess.mesh.meshSplice(r.anEdge,o),libtess.geom.edgeGoesLeft(a)||(a=null),libtess.sweep.addRightEdges_(t,e,o.oNext,s,a,!0)}},libtess.sweep.connectLeftVertex_=function(t,e){var r=new libtess.ActiveRegion;r.eUp=e.anEdge.sym;var i=t.dict.search(r).getKey(),n=i.regionBelow(),o=i.eUp,a=n.eUp;if(0===libtess.geom.edgeSign(o.dst(),e,o.org))return void libtess.sweep.connectLeftDegenerate_(t,i,e);var s,l=libtess.geom.vertLeq(a.dst(),o.dst())?i:n;
if(i.inside||l.fixUpperEdge){if(l===i)s=libtess.mesh.connect(e.anEdge.sym,o.lNext);else{var u=libtess.mesh.connect(a.dNext(),e.anEdge);s=u.sym}l.fixUpperEdge?libtess.sweep.fixUpperEdge_(l,s):libtess.sweep.computeWinding_(t,libtess.sweep.addRegionBelow_(t,i,s)),libtess.sweep.sweepEvent_(t,e)}else libtess.sweep.addRightEdges_(t,i,e.anEdge,e.anEdge,null,!0)},libtess.sweep.sweepEvent_=function(t,e){t.event=e;for(var r=e.anEdge;null===r.activeRegion;)if(r=r.oNext,r===e.anEdge)return void libtess.sweep.connectLeftVertex_(t,e);var i=libtess.sweep.topLeftRegion_(r.activeRegion),n=i.regionBelow(),o=n.eUp,a=libtess.sweep.finishLeftRegions_(t,n,null);a.oNext===o?libtess.sweep.connectRightVertex_(t,i,a):libtess.sweep.addRightEdges_(t,i,a.oNext,o,o,!0)},libtess.sweep.addSentinel_=function(t,e){var r=new libtess.ActiveRegion,i=libtess.mesh.makeEdge(t.mesh);i.org.s=libtess.sweep.SENTINEL_COORD_,i.org.t=e,i.dst().s=-libtess.sweep.SENTINEL_COORD_,i.dst().t=e,t.event=i.dst(),r.eUp=i,r.windingNumber=0,r.inside=!1,r.fixUpperEdge=!1,r.sentinel=!0,r.dirty=!1,r.nodeUp=t.dict.insert(r)},libtess.sweep.initEdgeDict_=function(t){t.dict=new libtess.Dict(t,libtess.sweep.edgeLeq_),libtess.sweep.addSentinel_(t,-libtess.sweep.SENTINEL_COORD_),libtess.sweep.addSentinel_(t,libtess.sweep.SENTINEL_COORD_)},libtess.sweep.doneEdgeDict_=function(t){for(var e;null!==(e=t.dict.getMin().getKey());)!e.sentinel,libtess.sweep.deleteRegion_(t,e);t.dict=null},libtess.sweep.removeDegenerateEdges_=function(t){for(var e,r=t.mesh.eHead,i=r.next;i!==r;i=e){e=i.next;var n=i.lNext;libtess.geom.vertEq(i.org,i.dst())&&i.lNext.lNext!==i&&(libtess.sweep.spliceMergeVertices_(t,n,i),libtess.mesh.deleteEdge(i),i=n,n=i.lNext),n.lNext===i&&(n!==i&&(n!==e&&n!==e.sym||(e=e.next),libtess.mesh.deleteEdge(n)),i!==e&&i!==e.sym||(e=e.next),libtess.mesh.deleteEdge(i))}},libtess.sweep.initPriorityQ_=function(t){var e=new libtess.PriorityQ(libtess.geom.vertLeq);t.pq=e;var r,i=t.mesh.vHead;for(r=i.next;r!==i;r=r.next)r.pqHandle=e.insert(r);e.init()},libtess.sweep.donePriorityQ_=function(t){t.pq.deleteQ(),t.pq=null},libtess.sweep.removeDegenerateFaces_=function(t){for(var e,r=t.fHead.next;r!==t.fHead;r=e){e=r.next;var i=r.anEdge;i.lNext.lNext===i&&(libtess.sweep.addWinding_(i.oNext,i),libtess.mesh.deleteEdge(i))}},libtess.tessmono={},libtess.tessmono.tessellateMonoRegion_=function(t){for(var e=t.anEdge;libtess.geom.vertLeq(e.dst(),e.org);e=e.lPrev());for(;libtess.geom.vertLeq(e.org,e.dst());e=e.lNext);for(var r,i=e.lPrev();e.lNext!==i;)if(libtess.geom.vertLeq(e.dst(),i.org)){for(;i.lNext!==e&&(libtess.geom.edgeGoesLeft(i.lNext)||libtess.geom.edgeSign(i.org,i.dst(),i.lNext.dst())<=0);)r=libtess.mesh.connect(i.lNext,i),i=r.sym;i=i.lPrev()}else{for(;i.lNext!==e&&(libtess.geom.edgeGoesRight(e.lPrev())||libtess.geom.edgeSign(e.dst(),e.org,e.lPrev().org)>=0);)r=libtess.mesh.connect(e,e.lPrev()),e=r.sym;e=e.lNext}for(;i.lNext.lNext!==e;)r=libtess.mesh.connect(i.lNext,i),i=r.sym},libtess.tessmono.tessellateInterior=function(t){for(var e,r=t.fHead.next;r!==t.fHead;r=e)e=r.next,r.inside&&libtess.tessmono.tessellateMonoRegion_(r)},libtess.tessmono.discardExterior=function(t){for(var e,r=t.fHead.next;r!==t.fHead;r=e)e=r.next,r.inside||libtess.mesh.zapFace(r)},libtess.tessmono.setWindingNumber=function(t,e,r){for(var i,n=t.eHead.next;n!==t.eHead;n=i)i=n.next,n.rFace().inside!==n.lFace.inside?n.winding=n.lFace.inside?e:-e:r?libtess.mesh.deleteEdge(n):n.winding=0},libtess.Dict=function(t,e){this.head_=new libtess.DictNode,this.frame_=t,this.leq_=e},libtess.Dict.prototype.deleteDict_=function(){},libtess.Dict.prototype.insertBefore=function(t,e){do t=t.prev;while(null!==t.key&&!this.leq_(this.frame_,t.key,e));var r=new libtess.DictNode(e,t.next,t);return t.next.prev=r,t.next=r,r},libtess.Dict.prototype.insert=function(t){return this.insertBefore(this.head_,t)},libtess.Dict.prototype.deleteNode=function(t){t.next.prev=t.prev,t.prev.next=t.next},libtess.Dict.prototype.search=function(t){var e=this.head_;do e=e.next;while(null!==e.key&&!this.leq_(this.frame_,t,e.key));return e},libtess.Dict.prototype.getMin=function(){return this.head_.next},libtess.Dict.prototype.getMax=function(){return this.head_.prev},libtess.DictNode=function(t,e,r){this.key=t||null,this.next=e||this,this.prev=r||this},libtess.DictNode.prototype.getKey=function(){return this.key},libtess.DictNode.prototype.getSuccessor=function(){return this.next},libtess.DictNode.prototype.getPredecessor=function(){return this.prev},libtess.CachedVertex=function(){this.coords=[0,0,0],this.data=null},libtess.GluTesselator=function(){this.state=libtess.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.callError_=null,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.relTolerance=libtess.GLU_TESS_DEFAULT_TOLERANCE,this.windingRule=libtess.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.callCombine_=null,this.boundaryOnly=!1,this.callBegin_=null,this.callEdgeFlag_=null,this.callVertex_=null,this.callEnd_=null,this.callMesh_=null,this.callBeginData_=null,this.callEdgeFlagData_=null,this.callVertexData_=null,this.callEndData_=null,this.callErrorData_=null,this.callCombineData_=null,this.polygonData_=null,this.emptyCache=!1,this.cacheCount=0,this.cache=new Array(libtess.TESS_MAX_CACHE);for(var t=0;t<libtess.TESS_MAX_CACHE;t++)this.cache[t]=new libtess.CachedVertex},libtess.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},libtess.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT)},libtess.GluTesselator.prototype.gluTessProperty=function(t,e){switch(t){case libtess.gluEnum.GLU_TESS_TOLERANCE:if(e<0||e>1)break;return void(this.relTolerance=e);case libtess.gluEnum.GLU_TESS_WINDING_RULE:var r=e;switch(r){case libtess.windingRule.GLU_TESS_WINDING_ODD:case libtess.windingRule.GLU_TESS_WINDING_NONZERO:case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=r)}break;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly=!!e);default:return void this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM)}this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_VALUE)},libtess.GluTesselator.prototype.gluGetTessProperty=function(t){switch(t){case libtess.gluEnum.GLU_TESS_TOLERANCE:return this.relTolerance;case libtess.gluEnum.GLU_TESS_WINDING_RULE:var e=this.windingRule;return e;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return this.boundaryOnly;default:this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM)}return!1},libtess.GluTesselator.prototype.gluTessNormal=function(t,e,r){this.normal[0]=t,this.normal[1]=e,this.normal[2]=r},libtess.GluTesselator.prototype.gluTessCallback=function(t,e){var r=e?e:null;switch(t){case libtess.gluEnum.GLU_TESS_BEGIN:return void(this.callBegin_=r);case libtess.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.callBeginData_=r);case libtess.gluEnum.GLU_TESS_EDGE_FLAG:return void(this.callEdgeFlag_=r);case libtess.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.callEdgeFlagData_=r);case libtess.gluEnum.GLU_TESS_VERTEX:return void(this.callVertex_=r);case libtess.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.callVertexData_=r);case libtess.gluEnum.GLU_TESS_END:return void(this.callEnd_=r);case libtess.gluEnum.GLU_TESS_END_DATA:return void(this.callEndData_=r);case libtess.gluEnum.GLU_TESS_ERROR:return void(this.callError_=r);case libtess.gluEnum.GLU_TESS_ERROR_DATA:return void(this.callErrorData_=r);case libtess.gluEnum.GLU_TESS_COMBINE:return void(this.callCombine_=r);case libtess.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.callCombineData_=r);case libtess.gluEnum.GLU_TESS_MESH:return void(this.callMesh_=r);default:return void this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM)}},libtess.GluTesselator.prototype.gluTessVertex=function(t,e){var r=!1,i=[0,0,0];this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR),this.emptyCache&&(this.emptyCache_(),this.lastEdge_=null);for(var n=0;n<3;++n){var o=t[n];o<-libtess.GLU_TESS_MAX_COORD&&(o=-libtess.GLU_TESS_MAX_COORD,r=!0),o>libtess.GLU_TESS_MAX_COORD&&(o=libtess.GLU_TESS_MAX_COORD,r=!0),i[n]=o}if(r&&this.callErrorOrErrorData(libtess.errorType.GLU_TESS_COORD_TOO_LARGE),null===this.mesh){if(this.cacheCount<libtess.TESS_MAX_CACHE)return void this.cacheVertex_(i,e);this.emptyCache_()}this.addVertex_(i,e)},libtess.GluTesselator.prototype.gluTessBeginPolygon=function(t){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT),this.state=libtess.GluTesselator.tessState_.T_IN_POLYGON,this.cacheCount=0,this.emptyCache=!1,this.mesh=null,this.polygonData_=t},libtess.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state=libtess.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null,this.cacheCount>0&&(this.emptyCache=!0)},libtess.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR),this.state=libtess.GluTesselator.tessState_.T_IN_POLYGON},libtess.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state=libtess.GluTesselator.tessState_.T_DORMANT,null===this.mesh&&this.emptyCache_(),libtess.normal.projectPolygon(this),libtess.sweep.computeInterior(this),!this.fatalError){var t=this.mesh;if(this.boundaryOnly?libtess.tessmono.setWindingNumber(t,1,!0):libtess.tessmono.tessellateInterior(t),this.mesh.checkMesh(),this.callBegin_||this.callEnd_||this.callVertex_||this.callEdgeFlag_||this.callBeginData_||this.callEndData_||this.callVertexData_||this.callEdgeFlagData_)if(this.boundaryOnly)libtess.render.renderBoundary(this,this.mesh);else{var e=!(!this.callEdgeFlag_&&!this.callEdgeFlagData_);libtess.render.renderMesh(this,this.mesh,e)}if(this.callMesh_)return libtess.tessmono.discardExterior(this.mesh),this.callMesh_(this.mesh),this.mesh=null,void(this.polygonData_=null)}libtess.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},libtess.GluTesselator.prototype.makeDormant_=function(){this.mesh&&libtess.mesh.deleteMesh(this.mesh),this.state=libtess.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null},libtess.GluTesselator.prototype.requireState_=function(t){this.state!==t&&this.gotoState_(t)},libtess.GluTesselator.prototype.gotoState_=function(t){for(;this.state!==t;)if(this.state<t)switch(this.state){case libtess.GluTesselator.tessState_.T_DORMANT:this.callErrorOrErrorData(libtess.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(libtess.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state){case libtess.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorOrErrorData(libtess.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(libtess.errorType.GLU_TESS_MISSING_END_POLYGON),this.makeDormant_()}},libtess.GluTesselator.prototype.addVertex_=function(t,e){var r=this.lastEdge_;null===r?(r=libtess.mesh.makeEdge(this.mesh),libtess.mesh.meshSplice(r,r.sym)):(libtess.mesh.splitEdge(r),r=r.lNext),r.org.data=e,r.org.coords[0]=t[0],r.org.coords[1]=t[1],r.org.coords[2]=t[2],r.winding=1,r.sym.winding=-1,this.lastEdge_=r},libtess.GluTesselator.prototype.cacheVertex_=function(t,e){var r=this.cache[this.cacheCount];r.data=e,r.coords[0]=t[0],r.coords[1]=t[1],r.coords[2]=t[2],++this.cacheCount},libtess.GluTesselator.prototype.emptyCache_=function(){this.mesh=new libtess.GluMesh;for(var t=0;t<this.cacheCount;t++){var e=this.cache[t];this.addVertex_(e.coords,e.data)}this.cacheCount=0,this.emptyCache=!1},libtess.GluTesselator.prototype.callBeginOrBeginData=function(t){this.callBeginData_?this.callBeginData_(t,this.polygonData_):this.callBegin_&&this.callBegin_(t)},libtess.GluTesselator.prototype.callVertexOrVertexData=function(t){this.callVertexData_?this.callVertexData_(t,this.polygonData_):this.callVertex_&&this.callVertex_(t)},libtess.GluTesselator.prototype.callEdgeFlagOrEdgeFlagData=function(t){this.callEdgeFlagData_?this.callEdgeFlagData_(t,this.polygonData_):this.callEdgeFlag_&&this.callEdgeFlag_(t)},libtess.GluTesselator.prototype.callEndOrEndData=function(){this.callEndData_?this.callEndData_(this.polygonData_):this.callEnd_&&this.callEnd_()},libtess.GluTesselator.prototype.callCombineOrCombineData=function(t,e,r){var i;return this.callCombineData_?i=this.callCombineData_(t,e,r,this.polygonData_):this.callCombine_&&(i=this.callCombine_(t,e,r)),void 0===i&&(i=null),i},libtess.GluTesselator.prototype.callErrorOrErrorData=function(t){this.callErrorData_?this.callErrorData_(t,this.polygonData_):this.callError_&&this.callError_(t)},libtess.GluFace=function(t,e){this.next=t||this,this.prev=e||this,this.anEdge=null,this.data=null,this.inside=!1},libtess.GluHalfEdge=function(t){this.next=t||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},libtess.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},libtess.GluHalfEdge.prototype.dst=function(){return this.sym.org},libtess.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},libtess.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},libtess.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},libtess.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},libtess.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},libtess.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},libtess.GluMesh=function(){this.vHead=new libtess.GluVertex,this.fHead=new libtess.GluFace,this.eHead=new libtess.GluHalfEdge,this.eHeadSym=new libtess.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},libtess.GluMesh.prototype.checkMesh=function(){if(libtess.DEBUG){var t,e,r=this.fHead,i=this.vHead,n=this.eHead,o=r;for(o=r;(e=o.next)!==r;o=e){t=e.anEdge;do t=t.lNext;while(t!==e.anEdge)}var a,s=i;for(s=i;(a=s.next)!==i;s=a){t=a.anEdge;do t=t.oNext;while(t!==a.anEdge)}var l=n;for(l=n;(t=l.next)!==n;l=t);}},libtess.GluVertex=function(t,e){this.next=t||this,this.prev=e||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=null},libtess.PQHandleElem=function(){this.key=null,this.node=0},libtess.PQHandleElem.realloc=function(t,e){var r=new Array(e),i=0;if(null!==t)for(;i<t.length;i++)r[i]=t[i];for(;i<e;i++)r[i]=new libtess.PQHandleElem;return r},libtess.PQNode=function(){this.handle=0},libtess.PQNode.realloc=function(t,e){var r=new Array(e),i=0;if(null!==t)for(;i<t.length;i++)r[i]=t[i];for(;i<e;i++)r[i]=new libtess.PQNode;return r},libtess.PriorityQ=function(t){this.keys_=libtess.PriorityQ.prototype.PQKeyRealloc_(null,libtess.PriorityQ.INIT_SIZE_),this.order_=null,this.size_=0,this.max_=libtess.PriorityQ.INIT_SIZE_,this.initialized_=!1,this.leq_=t,this.heap_=new libtess.PriorityQHeap(this.leq_)},libtess.PriorityQ.INIT_SIZE_=32,libtess.PriorityQ.prototype.deleteQ=function(){this.heap_.deleteHeap(),this.heap_=null,this.order_=null,this.keys_=null},libtess.PriorityQ.prototype.init=function(){this.order_=[];for(var t=0;t<this.size_;t++)this.order_[t]=t;var e=function(t,e){return function(r,i){return e(t[r],t[i])?1:-1}}(this.keys_,this.leq_);if(this.order_.sort(e),this.max_=this.size_,this.initialized_=!0,this.heap_.init(),libtess.DEBUG){var r=0,i=r+this.size_-1;for(t=r;t<i;++t);}},libtess.PriorityQ.prototype.insert=function(t){if(this.initialized_)return this.heap_.insert(t);var e=this.size_;return++this.size_>=this.max_&&(this.max_*=2,this.keys_=libtess.PriorityQ.prototype.PQKeyRealloc_(this.keys_,this.max_)),this.keys_[e]=t,-(e+1)},libtess.PriorityQ.prototype.PQKeyRealloc_=function(t,e){var r=new Array(e),i=0;if(null!==t)for(;i<t.length;i++)r[i]=t[i];for(;i<e;i++)r[i]=null;return r},libtess.PriorityQ.prototype.keyLessThan_=function(t,e){var r=this.keys_[t],i=this.keys_[e];return!this.leq_(i,r)},libtess.PriorityQ.prototype.keyGreaterThan_=function(t,e){var r=this.keys_[t],i=this.keys_[e];return!this.leq_(r,i)},libtess.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var t=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(this.leq_(e,t))return this.heap_.extractMin()}do--this.size_;while(this.size_>0&&null===this.keys_[this.order_[this.size_-1]]);return t},libtess.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var t=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(this.leq_(e,t))return e}return t},libtess.PriorityQ.prototype.isEmpty_=function(){return 0===this.size_&&this.heap_.isEmpty()},libtess.PriorityQ.prototype.remove=function(t){if(t>=0)return void this.heap_.remove(t);for(t=-(t+1),this.keys_[t]=null;this.size_>0&&null===this.keys_[this.order_[this.size_-1]];)--this.size_},libtess.PriorityQHeap=function(t){this.nodes_=libtess.PQNode.realloc(null,libtess.PriorityQHeap.INIT_SIZE_+1),this.handles_=libtess.PQHandleElem.realloc(null,libtess.PriorityQHeap.INIT_SIZE_+1),this.size_=0,this.max_=libtess.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.leq_=t,this.nodes_[1].handle=1},libtess.PriorityQHeap.INIT_SIZE_=32,libtess.PriorityQHeap.prototype.deleteHeap=function(){this.handles_=null,this.nodes_=null},libtess.PriorityQHeap.prototype.init=function(){for(var t=this.size_;t>=1;--t)this.floatDown_(t);this.initialized_=!0},libtess.PriorityQHeap.prototype.insert=function(t){var e=++this.size_;2*e>this.max_&&(this.max_*=2,this.nodes_=libtess.PQNode.realloc(this.nodes_,this.max_+1),this.handles_=libtess.PQHandleElem.realloc(this.handles_,this.max_+1));var r;return 0===this.freeList_?r=e:(r=this.freeList_,this.freeList_=this.handles_[r].node),this.nodes_[e].handle=r,this.handles_[r].node=e,this.handles_[r].key=t,this.initialized_&&this.floatUp_(e),r},libtess.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},libtess.PriorityQHeap.prototype.minimum=function(){return this.handles_[this.nodes_[1].handle].key},libtess.PriorityQHeap.prototype.extractMin=function(){var t=this.nodes_,e=this.handles_,r=t[1].handle,i=e[r].key;return this.size_>0&&(t[1].handle=t[this.size_].handle,e[t[1].handle].node=1,e[r].key=null,e[r].node=this.freeList_,this.freeList_=r,--this.size_>0&&this.floatDown_(1)),i},libtess.PriorityQHeap.prototype.remove=function(t){var e=this.nodes_,r=this.handles_,i=r[t].node;e[i].handle=e[this.size_].handle,r[e[i].handle].node=i,i<=--this.size_&&(i<=1||this.leq_(r[e[i>>1].handle].key,r[e[i].handle].key)?this.floatDown_(i):this.floatUp_(i)),r[t].key=null,r[t].node=this.freeList_,this.freeList_=t},libtess.PriorityQHeap.prototype.floatDown_=function(t){for(var e=this.nodes_,r=this.handles_,i=e[t].handle;;){var n=t<<1;n<this.size_&&this.leq_(r[e[n+1].handle].key,r[e[n].handle].key)&&++n;var o=e[n].handle;if(n>this.size_||this.leq_(r[i].key,r[o].key)){e[t].handle=i,r[i].node=t;break}e[t].handle=o,r[o].node=t,t=n}},libtess.PriorityQHeap.prototype.floatUp_=function(t){for(var e=this.nodes_,r=this.handles_,i=e[t].handle;;){var n=t>>1,o=e[n].handle;if(0===n||this.leq_(r[o].key,r[i].key)){e[t].handle=i,r[i].node=t;break}e[t].handle=o,r[o].node=t,t=n}},libtess.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},libtess.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},libtess.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},"undefined"!=typeof module&&(module.exports=libtess),define("worldwind/util/libtess",function(){}),define("worldwind/shapes/Polygon",["../shapes/AbstractShape","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolygon","../geom/Vec2","../geom/Vec3","../util/libtess"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g){"use strict";var m=function(r,i){if(!r)throw new e(s.logMessage(s.LEVEL_SEVERE,"Polygon","constructor","missingBoundaries"));t.call(this,i),r.length>0&&r[0].latitude&&(r=[r],this._boundariesSpecifiedSimply=!0),this._boundaries=r,this._textureCoordinates=null,this.referencePosition=this.determineReferencePosition(this._boundaries),this._extrude=!1,this.scratchPoint=new p(0,0,0)};return m.prototype=Object.create(t.prototype),Object.defineProperties(m.prototype,{boundaries:{get:function(){return this._boundariesSpecifiedSimply?this._boundaries[0]:this._boundaries},set:function(t){if(!t)throw new e(s.logMessage(s.LEVEL_SEVERE,"Polygon","boundaries","missingBoundaries"));t.length>0&&t[0].latitude&&(t=[t],this._boundariesSpecifiedSimply=!0),this._boundaries=t,this.referencePosition=this.determineReferencePosition(this._boundaries),this.reset()}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(t){this._textureCoordinates=t,this.reset()}},extrude:{get:function(){return this._extrude},set:function(t){this._extrude=t,this.reset()}}}),m.prototype.determineReferencePosition=function(t){return t.length>0&&t[0].length>2?t[0][0]:null},m.prototype.mustGenerateGeometry=function(t){return!this.currentData.boundaryPoints||(this.currentData.drawInterior!==this.activeAttributes.drawInterior||this.altitudeMode!==WorldWind.ABSOLUTE&&this.currentData.isExpired)},m.prototype.hasCapTexture=function(){return this.textureCoordinates&&this.capImageSource()},m.prototype.capImageSource=function(){return this.activeAttributes.imageSource?"string"==typeof this.activeAttributes.imageSource||this.activeAttributes.imageSource instanceof o?this.activeAttributes.imageSource:Array.isArray(this.activeAttributes.imageSource)&&this.activeAttributes.imageSource[0]&&("string"==typeof this.activeAttributes.imageSource[0]||this.activeAttributes.imageSource instanceof o)?this.activeAttributes.imageSource[0]:null:null},m.prototype.hasSideTextures=function(){return this.activeAttributes.imageSource&&Array.isArray(this.activeAttributes.imageSource)&&this.activeAttributes.imageSource.length>1},m.prototype.sideImageSource=function(t){if(0===t||2===this.activeAttributes.imageSource.length)return this.activeAttributes.imageSource[1];var e=this.activeAttributes.imageSource.length-1;return t=Math.min(t+1,e),this.activeAttributes.imageSource[t]},m.prototype.createSurfaceShape=function(){return new f(this.boundaries,null)},m.prototype.doMakeOrderedRenderable=function(t){if(!this.referencePosition)return null;if(!this.activeAttributes.drawInterior&&!this.activeAttributes.drawOutline)return null;if(!this.mustGenerateGeometry(t))return this;var e=this.currentData,r=e.referencePoint;t.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude,this._altitudeMode,r),e.transformationMatrix.setToTranslation(r[0],r[1],r[2]);for(var n=[],o=0;o<this._boundaries.length;o++)n[o]=this._boundaries[o].slice(0),n[o].push(this._boundaries[o][0]);var a=this.computeBoundaryPoints(t,n);if(this.activeAttributes.drawInterior){var s=this.tessellatePolygon(t,a);if(s){e.capTriangles=new Float32Array(s.length);for(var l=0,u=s.length;l<u;l++)e.capTriangles[l]=s[l]}}if(e.boundaryPoints=a,e.drawInterior=this.activeAttributes.drawInterior,this.resetExpiration(e),e.refreshBuffers=!0,e.extent||(e.extent=new i),1===a.length)e.extent.setToPoints(a[0]);else{var c=[];for(o=0;o<a.length;o++)for(var h=0;h<a[o].length;h++)c.push(a[o][h]);e.extent.setToPoints(c)}return e.extent.translate(e.referencePoint),this},m.prototype.computeBoundaryPoints=function(t,e){for(var r,i,n,o,a=Number.MAX_VALUE,s=t.navigatorState.eyePoint,l=[],u=this._extrude?6:3,c=new p(0,0,0),h=0;h<e.length;h++){r=(this._extrude?2:1)*e[h].length,l[h]=new Float32Array(3*r);for(var f=0,d=e[h].length;f<d;f++)i=e[h][f],t.surfacePointForMode(i.latitude,i.longitude,i.altitude,this.altitudeMode,c),o=c.distanceToSquared(s),o<a&&(a=o),c.subtract(this.currentData.referencePoint),n=u*f,l[h][n]=c[0],l[h][n+1]=c[1],l[h][n+2]=c[2],this._extrude&&(t.surfacePointForMode(i.latitude,i.longitude,0,WorldWind.CLAMP_TO_GROUND,c),o=c.distanceToSquared(s),o<a&&(a=o),c.subtract(this.currentData.referencePoint),l[h][n+3]=c[0],l[h][n+4]=c[1],l[h][n+5]=c[2])}return this.currentData.eyeDistance=0,l},m.prototype.tessellatePolygon=function(t,e){var r,i,n=[],o=0,a=this._extrude?6:3,l=this.hasCapTexture();this.polygonTessellator||(this.polygonTessellator=new libtess.GluTesselator,this.polygonTessellator.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,function(t,e){e[e.length]=t[0],e[e.length]=t[1],e[e.length]=t[2],l&&(e[e.length]=t[3],e[e.length]=t[4])}),this.polygonTessellator.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE,function(t,e,r){var i=[t[0],t[1],t[2]];if(l)for(var n=3;n<=4;n++){for(var o=0,a=0;a<4;a++)r[a]>0&&(o+=r[a]*e[a][n]);i[n]=o}return i}),this.polygonTessellator.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,function(t){o=t,s.logMessage(s.LEVEL_WARNING,"Polygon","tessellatePolygon","Tessellation error "+t+".")})),i=p.computeBufferNormal(e[0],a),i||(i=new p(0,0,0),t.globe.surfaceNormalAtLocation(this.referencePosition.latitude,this.referencePosition.longitude,i)),this.polygonTessellator.gluTessNormal(i[0],i[1],i[2]),this.currentData.capNormal=i,this.polygonTessellator.gluTessBeginPolygon(n);for(var u=0;u<e.length;u++){var c=0;this.polygonTessellator.gluTessBeginContour();for(var h=e[u],f=0;f<h.length;f+=a)r=[h[f],h[f+1],h[f+2]],l&&(c<this.textureCoordinates[u].length?(r[3]=this.textureCoordinates[u][c][0],r[4]=this.textureCoordinates[u][c][1]):(r[3]=this.textureCoordinates[u][0][0],r[4]=this.textureCoordinates[u][1][1]),++c),this.polygonTessellator.gluTessVertex(r,r);this.polygonTessellator.gluTessEndContour()}return this.polygonTessellator.gluTessEndPolygon(),0===o?n:null},m.prototype.mustDrawVerticals=function(t){return this._extrude&&this.activeAttributes.drawOutline&&this.activeAttributes.drawVerticals&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND},m.prototype.doRenderOrdered=function(t){var e,r=this.currentData;if(t.pickingMode&&(e=t.uniquePickColor()),this.activeAttributes.drawInterior&&r.capTriangles&&r.capTriangles.length>0&&this.drawCap(t,e),this._extrude&&this.activeAttributes.drawInterior&&this.drawSides(t,e),this.activeAttributes.drawOutline&&this.drawOutline(t,e),r.refreshBuffers=!1,t.pickingMode){var i=new u(e,this.pickDelegate?this.pickDelegate:this,null,t.currentLayer,!1);t.resolvePick(i)}},m.prototype.drawCap=function(t,e){var r,i,n,o,a,s,l=t.currentGlContext,u=t.currentProgram,c=this.currentData,h=c.refreshBuffers,f=!!this.hasCapTexture(),d=this.activeAttributes.applyLighting,p=c.capTriangles.length/(f?5:3);u.loadTextureEnabled(l,!1),this.applyMvpMatrix(t),c.capVboCacheKey||(c.capVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(c.capVboCacheKey),r||(r=l.createBuffer(),t.gpuResourceCache.putResource(c.capVboCacheKey,r,4*c.capTriangles.length),h=!0),l.bindBuffer(l.ARRAY_BUFFER,r),h&&(s=d?this.makeCapBufferWithNormals():c.capTriangles,l.bufferData(l.ARRAY_BUFFER,s,l.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),n=this.activeAttributes.interiorColor,i=n.alpha*t.currentLayer.opacity,l.depthMask(i>=1||t.pickingMode),u.loadColor(l,t.pickingMode?e:n),u.loadOpacity(l,t.pickingMode?i>0?1:0:i),o=12+(f?8:0)+(d?12:0),f&&!t.pickingMode&&(this.activeTexture=t.gpuResourceCache.resourceForKey(this.capImageSource()),this.activeTexture||(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.capImageSource())),a=this.activeTexture&&this.activeTexture.bind(t),a&&(l.enableVertexAttribArray(u.vertexTexCoordLocation),l.vertexAttribPointer(u.vertexTexCoordLocation,2,l.FLOAT,!1,o,12),this.scratchMatrix.setToIdentity(),this.scratchMatrix.multiplyByTextureTransform(this.activeTexture),u.loadTextureEnabled(l,!0),u.loadTextureUnit(l,l.TEXTURE0),u.loadTextureMatrix(l,this.scratchMatrix),u.loadModulateColor(l,t.pickingMode))),d&&!t.pickingMode&&(u.loadApplyLighting(l,!0),l.enableVertexAttribArray(u.normalVectorLocation),l.vertexAttribPointer(u.normalVectorLocation,3,l.FLOAT,!1,o,o-12)),l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,o,0),l.drawArrays(l.TRIANGLES,0,p)},m.prototype.makeCapBufferWithNormals=function(){for(var t=this.currentData,e=t.capNormal,r=this.hasCapTexture()?5:3,i=r+3,n=t.capTriangles.length/r,o=t.capTriangles,a=new Float32Array(n*i),s=0,l=0;l<n;l++){for(var u=0;u<r;u++)a[s++]=o[l*r+u];a[s++]=e[0],a[s++]=e[1],a[s++]=e[2]}return a},m.prototype.drawSides=function(t,e){var r,i,n,o,a,s,l=t.currentGlContext,u=t.currentProgram,c=this.currentData,h=c.refreshBuffers,f=this.hasSideTextures(),d=this.activeAttributes.applyLighting,p=3+(f?2:0)+(d?3:0),g=4*p;s=0;for(var m=0;m<c.boundaryPoints.length;m++)s+=c.boundaryPoints[m].length/6-1;if(c.sidesVboCacheKey||(c.sidesVboCacheKey=t.gpuResourceCache.generateCacheKey()),r=t.gpuResourceCache.resourceForKey(c.sidesVboCacheKey),!r||h?(a=this.makeSidesBuffer(s),c.numSideVertices=a.length/p,r||(r=l.createBuffer()),t.gpuResourceCache.putResource(c.sidesVboCacheKey,r,4*a.length),l.bindBuffer(l.ARRAY_BUFFER,r),l.bufferData(l.ARRAY_BUFFER,a,l.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)):l.bindBuffer(l.ARRAY_BUFFER,r),n=this.activeAttributes.interiorColor,i=n.alpha*t.currentLayer.opacity,l.depthMask(i>=1||t.pickingMode),u.loadColor(l,t.pickingMode?e:n),u.loadOpacity(l,t.pickingMode?i>0?1:0:i),f&&!t.pickingMode){this.activeTexture=t.gpuResourceCache.resourceForKey(this.capImageSource()),this.activeTexture||(this.activeTexture=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this.capImageSource())),d?(u.loadApplyLighting(l,!0),l.enableVertexAttribArray(u.normalVectorLocation)):u.loadApplyLighting(l,!1);for(var y=0;y<s;y++){var v=this.sideImageSource(y),b=t.gpuResourceCache.resourceForKey(v),E=6*y*g;v&&!b&&(b=t.gpuResourceCache.retrieveTexture(t.currentGlContext,v)),o=b&&b.bind(t),o?(l.enableVertexAttribArray(u.vertexTexCoordLocation),l.vertexAttribPointer(u.vertexTexCoordLocation,2,l.FLOAT,!1,g,E+12),this.scratchMatrix.setToIdentity(),this.scratchMatrix.multiplyByTextureTransform(this.activeTexture),u.loadTextureEnabled(l,!0),u.loadTextureUnit(l,l.TEXTURE0),u.loadTextureMatrix(l,this.scratchMatrix)):(u.loadTextureEnabled(l,!1),l.disableVertexAttribArray(u.vertexTexCoordLocation)),d&&l.vertexAttribPointer(u.normalVectorLocation,3,l.FLOAT,!1,g,E+20),l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,g,E),l.drawArrays(l.TRIANGLES,0,6)}}else u.loadTextureEnabled(l,!1),d&&!t.pickingMode?(u.loadApplyLighting(l,!0),l.enableVertexAttribArray(u.normalVectorLocation),l.vertexAttribPointer(u.normalVectorLocation,3,l.FLOAT,!1,g,g-12)):u.loadApplyLighting(l,!1),l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,g,0),l.drawArrays(l.TRIANGLES,0,c.numSideVertices)},m.prototype.makeSidesBuffer=function(t){var e,r,i,n,o,a,s,l,u,c,h,f=this.currentData,g=this.hasSideTextures(),m=this.activeAttributes.applyLighting,y=3+(g?2:0)+(m?3:0);i=2*t*3*y,e=new Float32Array(i),r=0,n=new p(0,0,0),o=new p(0,0,0),a=new p(0,0,0),s=new p(0,0,0),g?(l=new d(0,1),u=new d(0,0),c=new d(1,1),h=new d(1,0)):l=u=c=h=null;for(var v=0;v<f.boundaryPoints.length;v++)for(var b,E=f.boundaryPoints[v],w=0;w<E.length-6;w+=6)n[0]=E[w],n[1]=E[w+1],n[2]=E[w+2],o[0]=E[w+3],o[1]=E[w+4],o[2]=E[w+5],a[0]=E[w+6],a[1]=E[w+7],a[2]=E[w+8],s[0]=E[w+9],s[1]=E[w+10],s[2]=E[w+11],b=m?p.computeTriangleNormal(n,o,a):null,this.addVertexToBuffer(n,l,b,e,r),r+=y,this.addVertexToBuffer(o,u,b,e,r),r+=y,this.addVertexToBuffer(a,c,b,e,r),r+=y,this.addVertexToBuffer(o,u,b,e,r),r+=y,
this.addVertexToBuffer(s,h,b,e,r),r+=y,this.addVertexToBuffer(a,c,b,e,r),r+=y;return e},m.prototype.addVertexToBuffer=function(t,e,r,i,n){i[n++]=t[0],i[n++]=t[1],i[n++]=t[2],e&&(i[n++]=e[0],i[n++]=e[1]),r&&(i[n++]=r[0],i[n++]=r[1],i[n]=r[2])},m.prototype.drawOutline=function(t,e){var r,i,n,o,a,s,l=t.currentGlContext,u=t.currentProgram,c=this.currentData,h=c.refreshBuffers;u.loadTextureEnabled(l,!1),u.loadApplyLighting(l,!1),this.hasCapTexture()&&l.disableVertexAttribArray(u.vertexTexCoordLocation),this.activeAttributes.applyLighting&&l.disableVertexAttribArray(u.normalVectorLocation),c.boundaryVboCacheKeys||(this.currentData.boundaryVboCacheKeys=[]),this.applyMvpMatrixForOutline(t),u.loadTextureEnabled(l,!1),l.disableVertexAttribArray(u.vertexTexCoordLocation);for(var f=0;f<c.boundaryPoints.length;f++)r=c.boundaryPoints[f].length/3,c.boundaryVboCacheKeys[f]||(c.boundaryVboCacheKeys[f]=t.gpuResourceCache.generateCacheKey()),i=t.gpuResourceCache.resourceForKey(c.boundaryVboCacheKeys[f]),i||(i=l.createBuffer(),t.gpuResourceCache.putResource(c.boundaryVboCacheKeys[f],i,12*r),h=!0),l.bindBuffer(l.ARRAY_BUFFER,i),h&&(l.bufferData(l.ARRAY_BUFFER,c.boundaryPoints[f],l.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),o=this.activeAttributes.outlineColor,n=o.alpha*t.currentLayer.opacity,l.depthMask(n>=1||t.pickingMode),u.loadColor(l,t.pickingMode?e:o),u.loadOpacity(l,t.pickingMode?1:n),l.lineWidth(this.activeAttributes.outlineWidth),this._extrude?(a=24,s=r/2):(a=12,s=r),l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,a,0),l.drawArrays(l.LINE_STRIP,0,s),this.mustDrawVerticals(t)&&(l.vertexAttribPointer(u.vertexPointLocation,3,l.FLOAT,!1,0,0),l.drawArrays(l.LINES,0,r-2))},m.prototype.beginDrawing=function(t){var e=t.currentGlContext;this.activeAttributes.drawInterior&&e.disable(e.CULL_FACE),t.findAndBindProgram(r),e.enableVertexAttribArray(t.currentProgram.vertexPointLocation);var i=!t.pickMode&&this.activeAttributes.applyLighting;i&&t.currentProgram.loadModelviewInverse(e,t.navigatorState.modelviewNormalTransform)},m.prototype.endDrawing=function(t){var e=t.currentGlContext;e.disableVertexAttribArray(t.currentProgram.vertexPointLocation),e.disableVertexAttribArray(t.currentProgram.normalVectorLocation),e.depthMask(!0),e.lineWidth(1),e.enable(e.CULL_FACE)},m}),define("worldwind/shapes/SurfacePolyline",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(t,e,r,i){"use strict";var n=function(r,o){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfacePolyline","constructor","The specified locations array is null or undefined."));i.call(this,o),this._boundaries=r,this._stateId=n.stateId++,this._isInteriorInhibited=!0};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{boundaries:{get:function(){return this._boundaries},set:function(r){if(!Array.isArray(r))throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfacePolyline","set boundaries","The specified value is not an array."));this._boundaries=r,this._stateId=n.stateId++,this.isPrepared=!1,this.stateKeyInvalid=!0}}}),n.stateId=Number.MIN_SAFE_INTEGER,n.staticStateKey=function(t){var e=i.staticStateKey(t);return e+" pl "+t._stateId},n.prototype.computeStateKey=function(){return n.staticStateKey(this)},n}),define("worldwind/formats/geojson/GeoJSONParser",["../../error/ArgumentError","../../util/Color","./GeoJSONConstants","./GeoJSONCRS","./GeoJSONFeature","./GeoJSONFeatureCollection","./GeoJSONGeometry","./GeoJSONGeometryCollection","./GeoJSONGeometryLineString","./GeoJSONGeometryMultiLineString","./GeoJSONGeometryMultiPoint","./GeoJSONGeometryMultiPolygon","./GeoJSONGeometryPoint","./GeoJSONGeometryPolygon","../../geom/Location","../../util/Logger","../../shapes/Placemark","../../shapes/PlacemarkAttributes","../../shapes/Polygon","../../geom/Position","../../util/proj4-src","../../layer/RenderableLayer","../../shapes/ShapeAttributes","../../shapes/SurfacePolygon","../../shapes/SurfacePolyline"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E,w,_,x,S){"use strict";var T=function(e){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","constructor","missingDataSource"));this._dataSource=e,this._geoJSONObject=null,this._geoJSONType=null,this._crs=null,this._layer=null,this._parserCompletionCallback=null,this._shapeConfigurationCallback=this.defaultShapeConfigurationCallback,this.defaultPlacemarkAttributes=new y(null),this.defaultShapeAttributes=new _(null),this.setProj4jsAliases()};return Object.defineProperties(T.prototype,{dataSource:{get:function(){return this._dataSource}},geoJSONObject:{get:function(){return this._geoJSONObject}},geoJSONType:{get:function(){return this._geoJSONType}},crs:{get:function(){return this._crs}},layer:{get:function(){return this._layer}},parserCompletionCallback:{get:function(){return this._parserCompletionCallback}},shapeConfigurationCallback:{get:function(){return this._shapeConfigurationCallback}}}),T.prototype.load=function(t,e,r){t&&(this._parserCompletionCallback=t),e&&(this._shapeConfigurationCallback=e),this._layer=r||new w,this.isDataSourceJson()?this.parse(this.dataSource):this.requestUrl(this.dataSource)},T.prototype.defaultShapeConfigurationCallback=function(t,e){var r={},i=e.name||e.Name||e.NAME;return i&&(r.name=i),t.isPointType()||t.isMultiPointType()?r.attributes=this.defaultPlacemarkAttributes:t.isLineStringType()||t.isMultiLineStringType()?r.attributes=this.defaultShapeAttributes:(t.isPolygonType()||t.isMultiPolygonType())&&(r.attributes=this.defaultShapeAttributes),r},T.prototype.requestUrl=function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="text",e.onreadystatechange=function(){4===e.readyState&&(200===e.status?this.parse(e.response):g.log(g.LEVEL_WARNING,"GeoJSON retrieval failed ("+e.statusText+"): "+t))}.bind(this),e.onerror=function(){g.log(g.LEVEL_WARNING,"GeoJSON retrieval failed: "+t)},e.ontimeout=function(){g.log(g.LEVEL_WARNING,"GeoJSON retrieval timed out: "+t)},e.send(null)},T.prototype.parse=function(e){try{this._geoJSONObject=JSON.parse(e)}catch(t){g.logMessage(g.LEVEL_SEVERE,"GeoJSON","parse","invalidGeoJSONObject")}finally{if(this.geoJSONObject){if("[object Array]"===Object.prototype.toString.call(this.geoJSONObject))throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","parse","invalidGeoJSONObjectLength"));if(!this.geoJSONObject.hasOwnProperty(r.FIELD_TYPE))throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","parse","missingGeoJSONType"));this.setGeoJSONType(),this.setGeoJSONCRS(),this._parserCompletionCallback&&"function"==typeof this._parserCompletionCallback&&this._parserCompletionCallback(this.layer)}}},T.prototype.setGeoJSONCRS=function(){if(this.geoJSONObject[r.FIELD_CRS]){this._crs=new i(this.geoJSONObject[r.FIELD_CRS][r.FIELD_TYPE],this.geoJSONObject[r.FIELD_CRS][r.FIELD_PROPERTIES]);var t=function(){this.addRenderablesForGeoJSON(this.layer)}.bind(this);this.crs.setCRSString(t)}else this.addRenderablesForGeoJSON(this.layer)},T.prototype.addRenderablesForGeoJSON=function(e){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeoJSON","missingLayer"));switch(this.geoJSONType){case r.TYPE_FEATURE:var i=new n(this.geoJSONObject[r.FIELD_GEOMETRY],this.geoJSONObject[r.FIELD_PROPERTIES],this.geoJSONObject[r.FIELD_ID],this.geoJSONObject[r.FIELD_BBOX]);this.addRenderablesForFeature(e,i);break;case r.TYPE_FEATURE_COLLECTION:var a=new o(this.geoJSONObject[r.FIELD_FEATURES],this.geoJSONObject[r.FIELD_BBOX]);this.addRenderablesForFeatureCollection(e,a);break;case r.TYPE_GEOMETRY_COLLECTION:var l=new s(this.geoJSONObject[r.FIELD_GEOMETRIES],this.geoJSONObject[r.FIELD_BBOX]);this.addRenderablesForGeometryCollection(e,l,null);break;default:this.addRenderablesForGeometry(e,this.geoJSONObject,null)}},T.prototype.addRenderablesForGeometry=function(e,i,n){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometry","missingLayer"));if(!i)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometry","missingGeometry"));switch(i[r.FIELD_TYPE]){case r.TYPE_POINT:var o=new f(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForPoint(e,o,n?n:null);break;case r.TYPE_MULTI_POINT:var a=new c(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForMultiPoint(e,a,n?n:null);break;case r.TYPE_LINE_STRING:var s=new l(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForLineString(e,s,n?n:null);break;case r.TYPE_MULTI_LINE_STRING:var p=new u(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForMultiLineString(e,p,n?n:null);break;case r.TYPE_POLYGON:var m=new d(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForPolygon(e,m,n?n:null);break;case r.TYPE_MULTI_POLYGON:var y=new h(i[r.FIELD_COORDINATES],i[r.FIELD_TYPE],i[r.FIELD_BBOX]);this.addRenderablesForMultiPolygon(e,y,n?n:null)}},T.prototype.addRenderablesForPoint=function(e,r,i){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForPoint","missingLayer"));if(!r)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForPoint","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported()){var o=r.coordinates[0],a=r.coordinates[1],s=r.coordinates[2]?r.coordinates[2]:0,l=this.getReprojectedIfRequired(a,o,this.crs),u=new b(l[1],l[0],s),c=new m(u,!1,n&&n.attributes?n.attributes:null);c.altitudeMode=WorldWind.RELATIVE_TO_GROUND,n&&n.name&&(c.label=n.name),n.highlightAttributes&&(c.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(c.pickDelegate=n.pickDelegate),n&&n.userProperties&&(c.userProperties=n.userProperties),e.addRenderable(c)}},T.prototype.addRenderablesForMultiPoint=function(e,r,i){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPoint","missingLayer"));if(!r)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPoint","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported())for(var o=0,a=r.coordinates.length;o<a;o+=1){var s=r.coordinates[o][0],l=r.coordinates[o][1],u=r.coordinates[o][2]?r.coordinates[o][2]:0,c=this.getReprojectedIfRequired(l,s,this.crs),h=new b(c[1],c[0],u),f=new m(h,!1,n&&n.attributes?n.attributes:null);f.altitudeMode=WorldWind.RELATIVE_TO_GROUND,n&&n.name&&(f.label=n.name),n.highlightAttributes&&(f.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(f.pickDelegate=n.pickDelegate),n&&n.userProperties&&(f.userProperties=n.userProperties),e.addRenderable(f)}},T.prototype.addRenderablesForLineString=function(e,r,i){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForLineString","missingLayer"));if(!r)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForLineString","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported()){for(var o=[],a=0,s=r.coordinates;a<s.length;a++){var l=s[a][0],u=s[a][1],c=this.getReprojectedIfRequired(u,l,this.crs),h=new p(c[1],c[0]);o.push(h)}var f;f=new S(o,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(f.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(f.pickDelegate=n.pickDelegate),n&&n.userProperties&&(f.userProperties=n.userProperties),e.addRenderable(f)}},T.prototype.addRenderablesForMultiLineString=function(e,r,i){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiLineString","missingLayer"));if(!r)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiLineString","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported())for(var o=0,a=r.coordinates;o<a.length;o++){for(var s=[],l=0,u=a[o];l<u.length;l++){var c=u[l][0],h=u[l][1],f=this.getReprojectedIfRequired(h,c,this.crs),d=new p(f[1],f[0]);s.push(d)}var m;m=new S(s,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(m.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(m.pickDelegate=n.pickDelegate),n&&n.userProperties&&(m.userProperties=n.userProperties),e.addRenderable(m)}},T.prototype.addRenderablesForPolygon=function(e,r,i){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingLayer"));if(!r)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported())for(var o=0,a=r.coordinates;o<a.length;o++){for(var s=[],l=0,u=a[o];l<u.length;l++){var c=u[l][0],h=u[l][1],f=this.getReprojectedIfRequired(h,c,this.crs),d=new p(f[1],f[0]);s.push(d)}var m;m=new x(s,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(m.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(m.pickDelegate=n.pickDelegate),n&&n.userProperties&&(m.userProperties=n.userProperties),e.addRenderable(m)}},T.prototype.addRenderablesForMultiPolygon=function(e,r,i){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingLayer"));if(!r)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingGeometry"));var n=this.shapeConfigurationCallback(r,i);if(!this.crs||this.crs.isCRSSupported())for(var o=0,a=r.coordinates;o<a.length;o++){for(var s=[],l=0;l<a[o].length;l++){for(var u=[],c=0,h=a[o][l];c<h.length;c++){var f=h[c][0],d=h[c][1],m=this.getReprojectedIfRequired(d,f,this.crs),y=new p(m[1],m[0]);u.push(y)}s.push(u)}var v;v=new x(s,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(v.highlightAttributes=n.highlightAttributes),n&&n.pickDelegate&&(v.pickDelegate=n.pickDelegate),n&&n.userProperties&&(v.userProperties=n.userProperties),e.addRenderable(v)}},T.prototype.addRenderablesForGeometryCollection=function(e,i,n){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometryCollection","missingLayer"));if(!i)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometryCollection","missingGeometryCollection"));for(var o=0,a=i.geometries;o<a.length;o++)a[o].hasOwnProperty(r.FIELD_TYPE)&&this.addRenderablesForGeometry(e,a[o],n)},T.prototype.addRenderablesForFeature=function(e,i){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeature","missingLayer"));if(!i)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeature","missingFeature"));if(i.geometry.type===r.TYPE_GEOMETRY_COLLECTION){var n=new s(i.geometry.geometries,i.bbox);this.addRenderablesForGeometryCollection(e,n,i.properties)}else this.addRenderablesForGeometry(e,i.geometry,i.properties)},T.prototype.addRenderablesForFeatureCollection=function(e,i){if(!e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeatureCollection","missingLayer"));if(!i)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeatureCollection","missingFeatureCollection"));if(i.features.length>0)for(var o=0;o<i.features.length;o++){var a=new n(i.features[o][r.FIELD_GEOMETRY],i.features[o][r.FIELD_PROPERTIES],i.features[o][r.FIELD_ID],i.features[o][r.FIELD_BBOX]);this.addRenderablesForFeature(e,a)}},T.prototype.setGeoJSONType=function(){switch(this.geoJSONObject[r.FIELD_TYPE]){case r.TYPE_POINT:this._geoJSONType=r.TYPE_POINT;break;case r.TYPE_MULTI_POINT:this._geoJSONType=r.TYPE_MULTI_POINT;break;case r.TYPE_LINE_STRING:this._geoJSONType=r.TYPE_LINE_STRING;break;case r.TYPE_MULTI_LINE_STRING:this._geoJSONType=r.TYPE_MULTI_LINE_STRING;break;case r.TYPE_POLYGON:this._geoJSONType=r.TYPE_POLYGON;break;case r.TYPE_MULTI_POLYGON:this._geoJSONType=r.TYPE_MULTI_POLYGON;break;case r.TYPE_GEOMETRY_COLLECTION:this._geoJSONType=r.TYPE_GEOMETRY_COLLECTION;break;case r.TYPE_FEATURE:this._geoJSONType=r.TYPE_FEATURE;break;case r.TYPE_FEATURE_COLLECTION:this._geoJSONType=r.TYPE_FEATURE_COLLECTION;break;default:throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","setGeoJSONType","invalidGeoJSONType"))}},T.prototype.getReprojectedIfRequired=function(e,i,n){if(!e&&0!==e)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","getReprojectedIfRequired","missingLatitude"));if(!i&&0!==i)throw new t(g.logMessage(g.LEVEL_SEVERE,"GeoJSON","getReprojectedIfRequired","missingLongitude"));return!n||n.isDefault()?[i,e]:E(n.projectionString,r.EPSG4326_CRS,[i,e])},T.prototype.setProj4jsAliases=function(){E.defs([["urn:ogc:def:crs:OGC:1.3:CRS84",E.defs("EPSG:4326")],["urn:ogc:def:crs:EPSG::4326",E.defs("EPSG:4326")],["urn:ogc:def:crs:EPSG::3857",E.defs("EPSG:3857")]])},T.prototype.isDataSourceJson=function(){try{JSON.parse(this.dataSource)}catch(t){return!1}return!0},T}),define("worldwind/formats/geotiff/GeoTiffConstants",[],function(){"use strict";var t={Tag:{MODEL_PIXEL_SCALE:33550,MODEL_TRANSFORMATION:34264,MODEL_TIEPOINT:33922,GEO_KEY_DIRECTORY:34735,GEO_DOUBLE_PARAMS:34736,GEO_ASCII_PARAMS:34737,GDAL_NODATA:42113,GDAL_METADATA:42112},Key:{GTModelTypeGeoKey:1024,GTRasterTypeGeoKey:1025,GTCitationGeoKey:1026,GeographicTypeGeoKey:2048,GeogCitationGeoKey:2049,GeogGeodeticDatumGeoKey:2050,GeogPrimeMeridianGeoKey:2051,GeogLinearUnitsGeoKey:2052,GeogLinearUnitSizeGeoKey:2053,GeogAngularUnitsGeoKey:2054,GeogAngularUnitSizeGeoKey:2055,GeogEllipsoidGeoKey:2056,GeogSemiMajorAxisGeoKey:2057,GeogSemiMinorAxisGeoKey:2058,GeogInvFlatteningGeoKey:2059,GeogAzimuthUnitsGeoKey:2060,GeogPrimeMeridianLongGeoKey:2061,GeogTOWGS84GeoKey:2062,ProjectedCSTypeGeoKey:3072,PCSCitationGeoKey:3073,ProjectionGeoKey:3074,ProjCoordTransGeoKey:3075,ProjLinearUnitsGeoKey:3076,ProjLinearUnitSizeGeoKey:3077,ProjStdParallel1GeoKey:3078,ProjStdParallel2GeoKey:3079,ProjNatOriginLongGeoKey:3080,ProjNatOriginLatGeoKey:3081,ProjFalseEastingGeoKey:3082,ProjFalseNorthingGeoKey:3083,ProjFalseOriginLongGeoKey:3084,ProjFalseOriginLatGeoKey:3085,ProjFalseOriginEastingGeoKey:3086,ProjFalseOriginNorthingGeoKey:3087,ProjCenterLongGeoKey:3088,ProjCenterLatGeoKey:3089,ProjCenterEastingGeoKey:3090,ProjCenterNorthingGeoKey:3091,ProjScaleAtNatOriginGeoKey:3092,ProjScaleAtCenterGeoKey:3093,ProjAzimuthAngleGeoKey:3094,ProjStraightVertPoleLongGeoKey:3095,VerticalCSTypeGeoKey:4096,VerticalCitationGeoKey:4097,VerticalDatumGeoKey:4098,VerticalUnitsGeoKey:4099}};return t}),define("worldwind/formats/geotiff/GeoTiffKeyEntry",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffConstants","../../util/Logger"],function(t,e,r,i){"use strict";var n=function(t,r,n,o){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingKeyId"));if(null===r||void 0===r)throw new e(i.logMessage(i.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingTiffTagLocation"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingCount"));if(null===o||void 0===o)throw new e(i.logMessage(i.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingValueOffset"));this._keyId=t,this._tiffTagLocation=r,this._count=n,this._valueOffset=o};return Object.defineProperties(n.prototype,{keyId:{get:function(){return this._keyId}},tiffTagLocation:{get:function(){return this._tiffTagLocation}},count:{get:function(){return this._count}},valueOffset:{get:function(){return this._valueOffset}}}),n.prototype.getGeoKeyValue=function(t,e){var i;if(0===this.tiffTagLocation)i=this.valueOffset;else if(this.tiffTagLocation===r.Tag.GEO_ASCII_PARAMS){var n="";if(e){for(var o=this.valueOffset;o<this.count-1;o++)n+=e[o];"|"!=e[this.count-1]&&(n+=e[this.count-1]),i=n}}else this.tiffTagLocation===r.Tag.GEO_DOUBLE_PARAMS&&t&&(i=t[this.valueOffset]);return i},n}),define("worldwind/formats/geotiff/GeoTiffMetadata",[],function(){"use strict";var t=function(){this._bitsPerSample=null,this._colorMap=null,this._compression=null,this._extraSamples=null,this._imageLength=null,this._imageWidth=null,this._maxSampleValue=null,this._minSampleValue=null,this._orientation=0,this._photometricInterpretation=null,this._planarConfiguration=null,this._resolutionUnit=null,this._rowsPerStrip=null,this._samplesPerPixel=null,this._sampleFormat=null,this._software=null,this._stripByteCounts=null,this._stripOffsets=null,this._tileByteCounts=null,this._tileOffsets=null,this._tileLength=null,this._tileWidth=null,this._xResolution=null,this._yResolution=null,this._geoAsciiParams=null,this._geoDoubleParams=null,this._geoKeyDirectory=null,this._modelPixelScale=null,this._modelTiepoint=null,this._modelTransformation=null,this._noData=null,this._bbox=null,this._gtModelTypeGeoKey=null,this._gtRasterTypeGeoKey=null,this._gtCitationGeoKey=null,this._geographicTypeGeoKey=null,this._geogCitationGeoKey=null,this._geogAngularUnitsGeoKey=null,this._geogAngularUnitSizeGeoKey=null,this._geogSemiMajorAxisGeoKey=null,this._geogInvFlatteningGeoKey=null,this._projectedCSType=null};return Object.defineProperties(t.prototype,{bitsPerSample:{get:function(){return this._bitsPerSample},set:function(t){this._bitsPerSample=t}},colorMap:{get:function(){return this._colorMap},set:function(t){this._colorMap=t}},compression:{get:function(){return this._compression},set:function(t){this._compression=t}},extraSamples:{get:function(){return this._extraSamples},set:function(t){this._extraSamples=t}},imageLength:{get:function(){return this._imageLength},set:function(t){this._imageLength=t}},imageWidth:{get:function(){return this._imageWidth},set:function(t){this._imageWidth=t}},maxSampleValue:{get:function(){return this._maxSampleValue},set:function(t){this._maxSampleValue=t}},minSampleValue:{get:function(){return this._minSampleValue},set:function(t){this._minSampleValue=t}},orientation:{get:function(){return this._orientation},set:function(t){this._orientation=t}},photometricInterpretation:{get:function(){return this._photometricInterpretation},set:function(t){this._photometricInterpretation=t}},planarConfiguration:{get:function(){return this._planarConfiguration},set:function(t){this._planarConfiguration=t}},resolutionUnit:{get:function(){return this._resolutionUnit},set:function(t){this._resolutionUnit=t}},rowsPerStrip:{get:function(){return this._rowsPerStrip},set:function(t){this._rowsPerStrip=t}},samplesPerPixel:{get:function(){return this._samplesPerPixel},set:function(t){this._samplesPerPixel=t}},sampleFormat:{get:function(){return this._sampleFormat},set:function(t){this._sampleFormat=t}},software:{get:function(){return this._software},set:function(t){this._software=t}},stripByteCounts:{get:function(){return this._stripByteCounts},set:function(t){this._stripByteCounts=t}},stripOffsets:{get:function(){return this._stripOffsets},set:function(t){this._stripOffsets=t}},tileByteCounts:{get:function(){return this._tileByteCounts},set:function(t){this._tileByteCounts=t}},tileOffsets:{get:function(){return this._tileOffsets},set:function(t){this._tileOffsets=t}},tileLength:{get:function(){return this._tileLength},set:function(t){this._tileLength=t}},tileWidth:{get:function(){return this._tileWidth},set:function(t){this._tileWidth=t}},geoAsciiParams:{get:function(){return this._geoAsciiParams},set:function(t){this._geoAsciiParams=t}},geoDoubleParams:{get:function(){return this._geoDoubleParams},set:function(t){this._geoDoubleParams=t}},geoKeyDirectory:{get:function(){return this._geoKeyDirectory},set:function(t){this._geoKeyDirectory=t}},modelPixelScale:{get:function(){return this._modelPixelScale},set:function(t){this._modelPixelScale=t}},modelTiepoint:{get:function(){return this._modelTiepoint},set:function(t){this._modelTiepoint=t}},modelTransformation:{get:function(){return this._modelTransformation},set:function(t){this._modelTransformation=t}},noData:{get:function(){return this._noData},set:function(t){this._noData=t}},bbox:{get:function(){return this._bbox},set:function(t){this._bbox=t}},gtModelTypeGeoKey:{get:function(){return this._gtModelTypeGeoKey},set:function(t){this._gtModelTypeGeoKey=t}},gtRasterTypeGeoKey:{get:function(){return this._gtRasterTypeGeoKey},set:function(t){this._gtRasterTypeGeoKey=t}},gtCitationGeoKey:{get:function(){return this._gtCitationGeoKey},set:function(t){this._gtCitationGeoKey=t}},geographicTypeGeoKey:{get:function(){return this._geographicTypeGeoKey},set:function(t){this._geographicTypeGeoKey=t}},geogCitationGeoKey:{get:function(){return this._geogCitationGeoKey},set:function(t){this._geogCitationGeoKey=t}},geogAngularUnitsGeoKey:{get:function(){return this._geogAngularUnitsGeoKey},set:function(t){this._geogAngularUnitsGeoKey=t}},geogAngularUnitSizeGeoKey:{get:function(){return this._geogAngularUnitSizeGeoKey},set:function(t){this._geogAngularUnitSizeGeoKey=t}},geogSemiMajorAxisGeoKey:{get:function(){return this._geogSemiMajorAxisGeoKey},set:function(t){this._geogSemiMajorAxisGeoKey=t}},geogInvFlatteningGeoKey:{get:function(){return this._geogInvFlatteningGeoKey},set:function(t){this._geogInvFlatteningGeoKey=t}},projectedCSType:{get:function(){return this._projectedCSType},set:function(t){this._projectedCSType=t}},xResolution:{get:function(){return this._xResolution},set:function(t){this._xResolution=t}},yResolution:{get:function(){return this._yResolution},set:function(t){this._yResolution=t}}}),t}),define("worldwind/formats/geotiff/TiffConstants",[],function(){"use strict";var t={Tag:{NEW_SUBFILE_TYPE:254,SUBFILE_TYPE:255,IMAGE_WIDTH:256,IMAGE_LENGTH:257,BITS_PER_SAMPLE:258,COMPRESSION:259,PHOTOMETRIC_INTERPRETATION:262,THRESHHOLDING:263,CELL_WIDTH:264,CELL_LENGTH:265,FILL_ORDER:266,DOCUMENT_NAME:269,IMAGE_DESCRIPTION:270,MAKE:271,MODEL:272,STRIP_OFFSETS:273,ORIENTATION:274,SAMPLES_PER_PIXEL:277,ROWS_PER_STRIP:278,STRIP_BYTE_COUNTS:279,MIN_SAMPLE_VALUE:280,MAX_SAMPLE_VALUE:281,X_RESOLUTION:282,Y_RESOLUTION:283,PLANAR_CONFIGURATION:284,PAGE_NAME:285,X_POSITION:286,Y_POSITION:287,FREE_OFFSETS:288,FREE_BYTE_COUNTS:289,GRAY_RESPONSE_UNIT:290,GRAY_RESPONSE_CURVE:291,T4_OPTIONS:292,T6_PTIONS:293,RESOLUTION_UNIT:296,PAGE_NUMBER:297,TRANSFER_FUNCTION:301,SOFTWARE:305,DATE_TIME:306,ARTIST:315,HOST_COMPUTER:316,PREDICTOR:317,WHITE_POINT:318,PRIMARY_CHROMATICITIES:319,COLOR_MAP:320,HALFTONE_HINTS:321,TILE_WIDTH:322,TILE_LENGTH:323,TILE_OFFSETS:324,TILE_BYTE_COUNTS:325,INK_SET:332,INK_NAMES:333,NUMBER_OF_INKS:334,DOT_RANGE:336,TARGET_PRINTER:337,EXTRA_SAMPLES:338,SAMPLE_FORMAT:339,S_MIN_SAMPLE_VALUE:340,S_MAX_SAMPLE_VALUE:341,TRANSFER_RANGE:342,JPEG_PROC:512,JPEG_INTERCHANGE_FORMAT:513,JPEG_INTERCHANGE_FORMAT_LENGTH:514,JPEG_RESTART_INTERVAL:515,JPEG_LOSSLESS_PREDICTORS:517,JPEG_POINT_TRANSFORMS:518,JPEG_Q_TABLES:519,JPEG_DC_TABLES:520,JPEG_AC_TABLES:521,Y_Cb_Cr_COEFFICIENTS:529,Y_Cb_Cr_SUB_SAMPLING:530,Y_Cb_Cr_POSITIONING:531,REFERENCE_BLACK_WHITE:532,COPYRIGHT:33432},Compression:{UNCOMPRESSED:1,CCITT_1D:2,GROUP_3_FAX:3,GROUP_4_FAX:4,LZW:5,JPEG:6,PACK_BITS:32773},Orientation:{Row0_IS_TOP__Col0_IS_LHS:1,Row0_IS_TOP__Col0_IS_RHS:2,Row0_IS_BOTTOM__Col0_IS_RHS:3,Row0_IS_BOTTOM__Col0_IS_LHS:4,Row0_IS_LHS__Col0_IS_TOP:5,Row0_IS_RHS__Col0_IS_TOP:6,Row0_IS_RHS__Col0_IS_BOTTOM:7,Row0_IS_LHS__Col0_IS_BOTTOM:8},PhotometricInterpretation:{WHITE_IS_ZERO:0,BLACK_IS_ZERO:1,RGB:2,RGB_PALETTE:3,TRANSPARENCY_MASK:4,CMYK:5,Y_Cb_Cr:6,CIE_LAB:7},PlanarConfiguration:{CHUNKY:1,PLANAR:2},ResolutionUnit:{NONE:1,INCH:2,CENTIMETER:3},SampleFormat:{UNSIGNED:1,SIGNED:2,IEEE_FLOAT:3,UNDEFINED:4,DEFAULT:1},Type:{BYTE:1,ASCII:2,SHORT:3,LONG:4,RATIONAL:5,SBYTE:6,UNDEFINED:7,SSHORT:8,SLONG:9,SRATIONAL:10,FLOAT:11,DOUBLE:12}};return t}),define("worldwind/formats/geotiff/GeoTiffUtil",["../../error/ArgumentError","../../util/Logger","./TiffConstants"],function(t,e,r){"use strict";var i={getBytes:function(r,i,n,o,a){if(n<=0)throw new t(e.logMessage(e.LEVEL_SEVERE,"GeoTiffReader","getBytes","noBytesRequested"));if(n<=1)return a?r.getInt8(i,o):r.getUint8(i,o);if(n<=2)return a?r.getInt16(i,o):r.getUint16(i,o);if(n<=3)return a?r.getInt32(i,o)>>>8:r.getUint32(i,o)>>>8;if(n<=4)return a?r.getInt32(i,o):r.getUint32(i,o);if(n<=8)return r.getFloat64(i,o);throw new t(e.logMessage(e.LEVEL_SEVERE,"GeoTiffReader","getBytes","tooManyBytesRequested"))},getSampleBytes:function(t,i,n,o,a){var s;switch(o){case r.SampleFormat.UNSIGNED:s=this.getBytes(t,i,n,a,!1);break;case r.SampleFormat.SIGNED:s=this.getBytes(t,i,n,a,!0);break;case r.SampleFormat.IEEE_FLOAT:3==n?s=t.getFloat32(i,a)>>>8:4==n?s=t.getFloat32(i,a):8==n?s=t.getFloat64(i,a):e.log(e.LEVEL_WARNING,"Do not attempt to parse the data  not handled: "+n);break;case r.SampleFormat.UNDEFINED:default:s=this.getBytes(t,i,n,a,!1)}return s},canvasToTiffImage:function(t){var e=new Image;return e.src=t.toDataURL(),e},getRGBAFillValue:function(t,e,r,i){return"undefined"==typeof i&&(i=1),"rgba("+t+", "+e+", "+r+", "+i+")"},getTagValueAsString:function(t,e){for(var r in t)if(t[r]===e)return r},clampColorSample:function(t,e){var r=Math.pow(2,8-e);return Math.floor(t*r+(r-1))},clampColorSampleForElevation:function(t,e,r){var i=255/(r-e);return Math.round(i*(t-e))},getMinMaxGeotiffSamples:function(t,e){for(var r=1/0,i=-(1/0),n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++)for(var a=0;a<t[n][o].length;a++)t[n][o][a]!=e&&(t[n][o][a]>i&&(i=t[n][o][a]),t[n][o][a]<r&&(r=t[n][o][a]));return{max:i,min:r}}};return i}),define("worldwind/formats/geotiff/TiffIFDEntry",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffUtil","../../util/Logger","./TiffConstants"],function(t,e,r,i,n){"use strict";var o=function(t,r,n,o,a,s){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingTag"));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingType"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingCount"));if(null===o||void 0===o)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingValueOffset"));if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingGeoTiffData"));if(null===s||void 0===s)throw new e(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingIsLittleEndian"));this._tag=t,this._type=r,this._count=n,this._valueOffset=o,this._geoTiffData=a,this._isLittleEndian=s};return Object.defineProperties(o.prototype,{tag:{get:function(){return this._tag}},type:{get:function(){return this._type}},count:{get:function(){return this._count}},valueOffset:{get:function(){return this._valueOffset}},geoTiffData:{get:function(){return this._geoTiffData}},isLittleEndian:{get:function(){return this._isLittleEndian}}}),o.prototype.getIFDTypeLength=function(){switch(this.type){case n.Type.BYTE:case n.Type.ASCII:case n.Type.SBYTE:case n.Type.UNDEFINED:return 1;case n.Type.SHORT:case n.Type.SSHORT:return 2;case n.Type.LONG:case n.Type.SLONG:case n.Type.FLOAT:return 4;case n.Type.RATIONAL:case n.Type.SRATIONAL:case n.Type.DOUBLE:return 8;default:return-1}},o.prototype.getIFDEntryValue=function(){var e=[],o=null,a=this.getIFDTypeLength(),s=a*this.count;if(s<=4)o=this.isLittleEndian===!1?this.valueOffset>>>8*(4-a):this.valueOffset,e.push(o);else for(var l=0;l<this.count;l++){var u=a*l;if(a>=8)if(this.type===n.Type.RATIONAL||this.type===n.Type.SRATIONAL)e.push(r.getBytes(this.geoTiffData,this.valueOffset+u,4,this.isLittleEndian)),e.push(r.getBytes(this.geoTiffData,this.valueOffset+u+4,4,this.isLittleEndian));else{if(this.type!==n.Type.DOUBLE)throw new t(i.logMessage(i.LEVEL_SEVERE,"TiffIFDEntry","parse","invalidTypeOfIFD"));e.push(r.getBytes(this.geoTiffData,this.valueOffset+u,8,this.isLittleEndian))}else e.push(r.getBytes(this.geoTiffData,this.valueOffset+u,a,this.isLittleEndian))}return this.type===n.Type.ASCII?(e.forEach(function(t,e,r){0===t?r.splice(e,1):r[e]=String.fromCharCode(t)}),e.join("")):e},o}),define("worldwind/formats/geotiff/GeoTiffReader",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffConstants","./GeoTiffKeyEntry","./GeoTiffMetadata","./GeoTiffUtil","../../geom/Location","../../geom/Sector","../../util/Logger","../../util/proj4-src","./TiffConstants","./TiffIFDEntry","../../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c,h,f){"use strict";var d=function(t){if(!t)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","constructor","missingUrl"));this._url=t,this._isLittleEndian=!1,this._imageFileDirectories=[],
this._geoTiffData=null,this._metadata=new n};return Object.defineProperties(d.prototype,{url:{get:function(){return this._url}},isLittleEndian:{get:function(){return this._isLittleEndian}},imageFileDirectories:{get:function(){return this._imageFileDirectories}},geoTiffData:{get:function(){return this._geoTiffData}},metadata:{get:function(){return this._metadata}}}),d.prototype.requestUrl=function(t,e){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var i=r.response;i&&(this.parse(i),e())}else l.log(l.LEVEL_WARNING,"GeoTiff retrieval failed ("+r.statusText+"): "+t)}.bind(this),r.onerror=function(){l.log(l.LEVEL_WARNING,"GeoTiff retrieval failed: "+t)},r.ontimeout=function(){l.log(l.LEVEL_WARNING,"GeoTiff retrieval timed out: "+t)},r.send(null)},d.prototype.parse=function(e){if(this._geoTiffData=new DataView(e),this.getEndianness(),!this.isTiffFileType())throw new t(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","parse","invalidTiffFileType"));var r=o.getBytes(this.geoTiffData,4,4,this.isLittleEndian);this.parseImageFileDirectory(r),this.getMetadataFromImageFileDirectory(),this.parseGeoKeys(),this.setBBox()},d.prototype.getEndianness=function(){var e=o.getBytes(this.geoTiffData,0,2,this.isLittleEndian);if(18761===e)this._isLittleEndian=!0;else{if(19789!==e)throw new t(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","getEndianness","invalidByteOrderValue"));this._isLittleEndian=!1}},d.prototype.isTiffFileType=function(){var t=o.getBytes(this.geoTiffData,2,2,this.isLittleEndian);return 42===t},d.prototype.isGeoTiff=function(){return!!this.getIFDByTag(r.Tag.GEO_KEY_DIRECTORY)},d.prototype.readAsImage=function(t){this.requestUrl(this.url,function(){var e=this.metadata.bitsPerSample,r=this.metadata.samplesPerPixel,i=this.metadata.photometricInterpretation,n=this.metadata.imageLength,o=this.metadata.imageWidth;if(this.metadata.colorMap)var a=this.metadata.colorMap,s=Math.pow(2,e[0]);var l=document.createElement("canvas");l.width=o,l.height=n;var u=l.getContext("2d");if(this.metadata.stripOffsets){var c=this.parseStrips(!1);if(this.metadata.rowsPerStrip)var h=this.metadata.rowsPerStrip;else var h=n;for(var f=c.length,d=0,p=h,g=n%h,m=0===g?h:g,y=0;y<f;y++){y+1===f&&(p=m);for(var v=c[y].length,b=d*y,E=0,w=0;w<v;E++)for(var _=0;_<o;_++,w++){var x=c[y][w];u.fillStyle=this.getFillStyle(x,i,e,r,a,s),u.fillRect(_,b+E,1,1)}d=h}}else if(this.metadata.tileOffsets)for(var S=this.parseTiles(!1),T=this.metadata.tileWidth,M=this.metadata.tileLength,L=Math.ceil(o/T),E=0;E<n;E++)for(var _=0;_<o;_++){var A=Math.floor(_/T),N=Math.floor(E/M),C=N*L+A,R=_%T,P=E%M,O=P*T+R,x=S[C][O];u.fillStyle=this.getFillStyle(x,i,e,r,a,s),u.fillRect(_,E,1,1)}this._geoTiffData=null,t(l)}.bind(this))},d.prototype.getFillStyle=function(t,e,r,i,n,a){var s=0,u=0,h=0,f=1;switch(this.metadata.noData&&t[0]==this.metadata.noData&&(f=0),e){case c.PhotometricInterpretation.WHITE_IS_ZERO:var d=Math.pow(2,r)-1;t[0]=d-t[0];case c.PhotometricInterpretation.BLACK_IS_ZERO:s=u=h=o.clampColorSample(t[0],r[0]);break;case c.PhotometricInterpretation.RGB:if(s=o.clampColorSample(t[0],r[0]),u=o.clampColorSample(t[1],r[1]),h=o.clampColorSample(t[2],r[2]),4===i&&2===this.metadata.extraSamples[0]){var p=Math.pow(2,r[3]);f=t[3]/p}break;case c.PhotometricInterpretation.RGB_PALETTE:if(n){var g=t[0];s=o.clampColorSample(n[g],16),u=o.clampColorSample(n[a+g],16),h=o.clampColorSample(n[2*a+g],16)}break;case c.PhotometricInterpretation.TRANSPARENCY_MASK:l.log(l.LEVEL_WARNING,"Photometric interpretation not yet implemented: TRANSPARENCY_MASK");break;case c.PhotometricInterpretation.CMYK:l.log(l.LEVEL_WARNING,"Photometric interpretation not yet implemented: CMYK");break;case c.PhotometricInterpretation.Y_Cb_Cr:l.log(l.LEVEL_WARNING,"Photometric interpretation not yet implemented: Y_Cb_Cr");break;case c.PhotometricInterpretation.CIE_LAB:l.log(l.LEVEL_WARNING,"Photometric interpretation not yet implemented: CIE_LAB");break;default:l.log("Unknown photometric interpretation: "+e)}return o.getRGBAFillValue(s,u,h,f)},d.prototype.createTypedElevationArray=function(){var t,e=[],r=this.metadata.bitsPerSample[0];if(this.metadata.stripOffsets)for(var i=this.parseStrips(!0),n=0;n<i.length;n++)e=e.concat(i[n]);else if(this.metadata.tileOffsets)for(var o=this.parseTiles(!0),a=this.metadata.imageWidth,s=this.metadata.imageLength,l=this.metadata.tileWidth,u=this.metadata.tileLength,h=Math.ceil(a/l),f=0;f<s;f++)for(var d=0;d<a;d++){var p=Math.floor(d/l),g=Math.floor(f/u),m=g*h+p,y=d%l,v=f%u,b=v*l+y,E=o[m][b];e.push(E)}if(this.metadata.sampleFormat)var w=this.metadata.sampleFormat[0];else var w=c.SampleFormat.UNSIGNED;switch(r){case 8:t=w===c.SampleFormat.SIGNED?new Int8Array(e):new Uint8Array(e);break;case 16:t=w===c.SampleFormat.SIGNED?new Int16Array(e):new Uint16Array(e);break;case 32:t=w===c.SampleFormat.SIGNED?new Int32Array(e):w===c.SampleFormat.IEEE_FLOAT?new Float32Array(e):new Uint32Array(e);break;case 64:t=new Float64Array(e)}return t},d.prototype.readAsData=function(t){this.requestUrl(this.url,function(){t(this.createTypedElevationArray())}.bind(this))},d.prototype.parseStrips=function(t){var e=this.metadata.samplesPerPixel,r=this.metadata.bitsPerSample,i=this.metadata.stripOffsets,n=this.metadata.stripByteCounts,o=this.metadata.compression;if(this.metadata.sampleFormat)var a=this.metadata.sampleFormat;else var a=c.SampleFormat.UNSIGNED;for(var s=e*r[0],l=s/8,u=[],h=0;h<i.length;h++){var f=i[h],d=n[h];u[h]=this.parseBlock(t,o,l,d,f,r,a)}return u},d.prototype.parseBlock=function(t,e,r,i,n,a,s){var u=[];switch(e){case c.Compression.UNCOMPRESSED:for(var h=0,f=r;h<i;h+=f){for(var d=0,p=[];d<a.length;d++){var g=a[d]/8,m=d*g;p.push(o.getSampleBytes(this.geoTiffData,n+h+m,g,s[d],this.isLittleEndian))}t?u.push(p[0]):u.push(p)}break;case c.Compression.CCITT_1D:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: CCITT_1D");break;case c.Compression.GROUP_3_FAX:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: GROUP_3_FAX");break;case c.Compression.GROUP_4_FAX:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: GROUP_4_FAX");break;case c.Compression.LZW:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: LZW");break;case c.Compression.JPEG:l.log(l.LEVEL_WARNING,"Compression type not yet implemented: JPEG");break;case c.Compression.PACK_BITS:if(this.metadata.tileOffsets)var y=this.metadata.tileWidth,v=this.metadata.tileWidth,b=new ArrayBuffer(y*v*r);else var E=this.metadata.rowsPerStrip,w=this.metadata.imageWidth,b=new ArrayBuffer(E*w*r);for(var _=new DataView(b),x=!0,p=[],S=0,T=0,M=0,h=0;h<i;h+=1)if(x){S=1,T=1,x=!1;var L=this.geoTiffData.getInt8(n+h,this.isLittleEndian);L>=0&&L<=127?S=L+1:L>=-127&&L<=-1?T=-L+1:x=!0}else{for(var A=o.getBytes(this.geoTiffData,n+h,1,this.isLittleEndian),N=0;N<T;N++)_.setInt8(M,A),M++;S--,0===S&&(x=!0)}for(var h=0,f=r;h<b.byteLength;h+=f){for(var d=0,p=[];d<a.length;d++){var g=a[d]/8,m=d*g;p.push(o.getSampleBytes(_,h+m,g,s[d],this.isLittleEndian))}t?u.push(p[0]):u.push(p)}}return u},d.prototype.parseTiles=function(t){var e=this.metadata.samplesPerPixel,r=this.metadata.bitsPerSample,i=this.metadata.compression;if(this.metadata.sampleFormat)var n=this.metadata.sampleFormat;else{var n=new Array(e);f.fillArray(n,c.SampleFormat.UNSIGNED)}for(var o=e*r[0],a=o/8,s=this.metadata.tileWidth,l=this.metadata.tileLength,u=this.metadata.tileOffsets,h=this.metadata.tileByteCounts,d=this.metadata.imageLength,p=this.metadata.imageWidth,g=Math.ceil(p/s),m=Math.ceil(d/l),y=[],v=0;v<m;v++)for(var b=0;b<g;b++){var E=g*v+b,w=u[E],_=h[E];y[E]=this.parseBlock(t,i,a,_,w,r,n)}return y},d.prototype.geoTiffImageToPCS=function(t,r){if(null===t||void 0===t)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","geoTiffImageToPCS","missingXValue"));if(null===r||void 0===r)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","geoTiffImageToPCS","missingYValue"));var i=[t,r],n=this.metadata.modelTiepoint,o=this.metadata.modelPixelScale,s=this.metadata.modelTransformation,c=n?n.length:0,h=o?o.length:0,f=s?s.length:0;if(c>6&&0===h);else if(16===f){var d=t,p=r;t=d*s[0]+p*s[1]+s[3],r=d*s[4]+p*s[5]+s[7],i=[t,r]}else h<3||c<6?i=[t,r]:(t=(t-n[0])*o[0]+n[3],r=(r-n[1])*(-1*o[1])+n[4],i=[t,r]);return u.defs([["EPSG:26771","+proj=tmerc +lat_0=36.66666666666666 +lon_0=-88.33333333333333 +k=0.9999749999999999 +x_0=152400.3048006096 +y_0=0 +ellps=clrk66 +datum=NAD27 +to_meter=0.3048006096012192 +no_defs "],["EPSG:32633","+proj=utm +zone=33 +datum=WGS84 +units=m +no_defs"]]),this.metadata.projectedCSType&&(i=u("EPSG:"+this.metadata.projectedCSType,"EPSG:4326",i)),new a(i[1],i[0])},d.prototype.setBBox=function(){var t=this.geoTiffImageToPCS(0,0),e=this.geoTiffImageToPCS(this.metadata.imageWidth,0),r=this.geoTiffImageToPCS(0,this.metadata.imageLength);this.geoTiffImageToPCS(this.metadata.imageWidth,this.metadata.imageLength);this.metadata.bbox=new s(r.latitude,t.latitude,t.longitude,e.longitude)},d.prototype.getMetadataFromImageFileDirectory=function(){for(var t=0;t<this.imageFileDirectories[0].length;t++)switch(this.imageFileDirectories[0][t].tag){case c.Tag.BITS_PER_SAMPLE:this.metadata.bitsPerSample=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.COLOR_MAP:this.metadata.colorMap=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.COMPRESSION:this.metadata.compression=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.EXTRA_SAMPLES:this.metadata.extraSamples=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.IMAGE_LENGTH:this.metadata.imageLength=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.IMAGE_WIDTH:this.metadata.imageWidth=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.MAX_SAMPLE_VALUE:this.metadata.maxSampleValue=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.MIN_SAMPLE_VALUE:this.metadata.minSampleValue=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.ORIENTATION:this.metadata.orientation=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.PHOTOMETRIC_INTERPRETATION:this.metadata.photometricInterpretation=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.PLANAR_CONFIGURATION:this.metadata.planarConfiguration=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.ROWS_PER_STRIP:this.metadata.rowsPerStrip=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.RESOLUTION_UNIT:this.metadata.resolutionUnit=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.SAMPLES_PER_PIXEL:this.metadata.samplesPerPixel=this.imageFileDirectories[0][t].getIFDEntryValue()[0];break;case c.Tag.SAMPLE_FORMAT:this.metadata.sampleFormat=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.SOFTWARE:this.metadata.software=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.STRIP_BYTE_COUNTS:this.metadata.stripByteCounts=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.STRIP_OFFSETS:this.metadata.stripOffsets=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.TILE_BYTE_COUNTS:this.metadata.tileByteCounts=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.TILE_OFFSETS:this.metadata.tileOffsets=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.TILE_LENGTH:this.metadata.tileLength=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.TILE_WIDTH:this.metadata.tileWidth=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.X_RESOLUTION:this.metadata.xResolution=this.imageFileDirectories[0][t].getIFDEntryValue();break;case c.Tag.Y_RESOLUTION:this.metadata.tileWidth=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.GEO_ASCII_PARAMS:this.metadata.geoAsciiParams=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.GEO_DOUBLE_PARAMS:this.metadata.geoDubleParams=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.GEO_KEY_DIRECTORY:this.metadata.geoKeyDirectory=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.MODEL_PIXEL_SCALE:this.metadata.modelPixelScale=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.MODEL_TIEPOINT:this.metadata.modelTiepoint=this.imageFileDirectories[0][t].getIFDEntryValue();break;case r.Tag.GDAL_NODATA:this.metadata.noData=this.imageFileDirectories[0][t].getIFDEntryValue();break;default:l.log(l.LEVEL_WARNING,"Ignored GeoTiff tag: "+this.imageFileDirectories[0][t].tag)}},d.prototype.getMetadataFromGeoKeys=function(){for(var t=0;t<this.geoKeys.length;t++){var e=o.getTagValueAsString(r.Key,this.geoKeys[t].keyId);e?this._metadata.geotiff.geoKeys[e]=this.geoKeys[t].getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams):l.log(l.LEVEL_WARNING,"Unknown GeoTiff key: "+this.geoKeys[t].keyId)}},d.prototype.parseGeoKeys=function(){if(!this.isGeoTiff())throw new t(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","parse","invalidGeoTiffFile"));var e=this.metadata.geoKeyDirectory;if(!e)throw new t(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","parseGeoKeys","missingGeoKeyDirectoryTag"));for(var n=(e[0],e[1],e[2],e[3]),o=0;o<n;o++){var a=e[4+4*o],s=e[5+4*o],u=e[6+4*o],c=e[7+4*o];switch(a){case r.Key.GTModelTypeGeoKey:this.metadata.gtModelTypeGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GTRasterTypeGeoKey:this.metadata.gtRasterTypeGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GTCitationGeoKey:this.metadata.gtCitationGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeographicTypeGeoKey:this.metadata.geographicTypeGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogCitationGeoKey:this.metadata.geogCitationGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogAngularUnitsGeoKey:this.metadata.geogAngularUnitsGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogAngularUnitSizeGeoKey:this.metadata.geogAngularUnitSizeGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogSemiMajorAxisGeoKey:this.metadata.geogSemiMajorAxisGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.GeogInvFlatteningGeoKey:this.metadata.geogInvFlatteningGeoKey=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case r.Key.ProjectedCSTypeGeoKey:this.metadata.projectedCSType=new i(a,s,u,c).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;default:l.log(l.LEVEL_WARNING,"Ignored GeoTiff key: "+a)}}},d.prototype.parseImageFileDirectory=function(t){if(!t)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","parseImageFileDirectory","missingOffset"));for(var r=o.getBytes(this.geoTiffData,t,2,this.isLittleEndian),i=[],n=t+2,a=0;a<r;n+=12,a++){var s=o.getBytes(this.geoTiffData,n,2,this.isLittleEndian),u=o.getBytes(this.geoTiffData,n+2,2,this.isLittleEndian),c=o.getBytes(this.geoTiffData,n+4,4,this.isLittleEndian),f=o.getBytes(this.geoTiffData,n+8,4,this.isLittleEndian);i.push(new h(s,u,c,f,this.geoTiffData,this.isLittleEndian))}this._imageFileDirectories.push(i);var d=o.getBytes(this.geoTiffData,n,4,this.isLittleEndian);0!==d&&this.parseImageFileDirectory(d)},d.prototype.getIFDByTag=function(t){if(!t)throw new e(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","getIFDByTag","missingTag"));for(var r=0;r<this.imageFileDirectories[0].length;r++)if(this.imageFileDirectories[0][r].tag===t)return this.imageFileDirectories[0][r];return null},d}),define("worldwind/projections/ProjectionEquirectangular",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Vec3"],function(t,e,r,i,n){"use strict";var o=function(){r.call(this,"Equirectangular",!0,null)};return o.prototype=Object.create(r.prototype),Object.defineProperties(o.prototype,{stateKey:{get:function(){return"projection equirectangular "}}}),o.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesian","missingResult"));return l[0]=r.equatorialRadius*o*t.DEGREES_TO_RADIANS+(s?s[0]:0),l[1]=r.equatorialRadius*n*t.DEGREES_TO_RADIANS,l[2]=a,l},o.prototype.geographicToCartesianGrid=function(r,o,a,s,l,u,c,h){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingGlobe"));if(!o)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingSector"));if(!l||l.length<a*s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!h)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingResult"));var f,d,p,g,m,y=r.equatorialRadius,v=o.minLatitude*t.DEGREES_TO_RADIANS,b=o.maxLatitude*t.DEGREES_TO_RADIANS,E=o.minLongitude*t.DEGREES_TO_RADIANS,w=o.maxLongitude*t.DEGREES_TO_RADIANS,_=(b-v)/(a>1?a-1:1),x=(w-E)/(s>1?s-1:1),S=u?u:new n(0,0,0),T=c?c[0]:0,M=0,L=0;for(f=0,p=v;f<a;f++,p+=_)for(f===a-1&&(p=b),m=y*p-S[1],d=0,g=E;d<s;d++,g+=x)d===s-1&&(g=w),h[L++]=y*g-S[0]+T,h[L++]=m,h[L++]=l[M++]-S[2];return h},o.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionEquirectangular","cartesianToGeographic","missingResult"));return l.latitude=o/r.equatorialRadius*t.RADIANS_TO_DEGREES,l.longitude=(n-(s?s[0]:0))/r.equatorialRadius*t.RADIANS_TO_DEGREES,l.altitude=a,l},o}),define("worldwind/globe/ZeroElevationModel",["../error/ArgumentError","../globe/ElevationModel","../geom/Location","../util/Logger","../geom/Sector"],function(t,e,r,i,n){"use strict";var o=function(){e.call(this,n.FULL_SPHERE,new r(45,45),1," "," ",150,150),this.displayName="Zero Elevations",this.timestamp=Date.now(),this.minElevation=0,this.maxElevation=0};return o.prototype=Object.create(e.prototype),o.prototype.minAndMaxElevationsForSector=function(t){return[0,0]},o.prototype.elevationAtLocation=function(t,e){return 0},o.prototype.elevationsForGrid=function(e,r,n,o,a){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"ZeroElevationModel","elevationsForSector","missingSector"));if(r<=0||n<=0)throw new t(i.logMessage(i.LEVEL_SEVERE,"ZeroElevationModel","elevationsForSector","numLat or numLon is less than 1"));if(!a||a.length<r*n)throw new t(i.logMessage(i.LEVEL_SEVERE,"ZeroElevationModel","elevationsForSector","missingArray"));for(var s=0,l=a.length;s<l;s++)a[s]=0;return 0},o}),define("worldwind/globe/Globe2D",["../globe/Globe","../projections/ProjectionEquirectangular","../globe/ZeroElevationModel"],function(t,e,r){"use strict";var i=function(){t.call(this,new r,new e)};return i.prototype=Object.create(t.prototype),i}),define("worldwind/util/GoToAnimator",["../geom/Location","../util/Logger","../navigate/LookAt","../geom/Position","../geom/Vec3"],function(t,e,r,i,n){"use strict";var o=function(t){if(!t)throw new ArgumentError(e.logMessage(e.LEVEL_SEVERE,"GoToAnimator","constructor","missingWorldWindow"));this.wwd=t,this.animationFrequency=20,this.travelTime=3e3,this.cancelled=!1};return o.prototype.cancel=function(){this.cancelled=!0},o.prototype.goTo=function(o,a){if(!o)throw new ArgumentError(e.logMessage(e.LEVEL_SEVERE,"GoToAnimator","goTo","missingPosition"));var s=new r;this.wwd.navigator.getAsLookAt(this.wwd.globe,s),this.completionCallback=a,this.cancelled=!1,this.targetPosition=new i(o.latitude,o.longitude,o.altitude||s.range),this.startPosition=new i(s.latitude,s.longitude,s.range),this.startTime=Date.now();var l,u=this.travelTime,c=t.greatCircleDistance(this.startPosition,this.targetPosition),h=this.wwd.globe.computePointFromLocation(this.startPosition.latitude,this.startPosition.longitude,new n(0,0,0)),f=this.wwd.globe.computePointFromLocation(this.targetPosition.latitude,this.targetPosition.longitude,new n(0,0,0));this.maxAltitude=h.distanceTo(f);var d=this.wwd.navigator.currentState().pixelSizeAtDistance(this.startPosition.altitude)*this.wwd.canvas.clientWidth/this.wwd.globe.equatorialRadius;c<=2*d&&(this.maxAltitude=this.startPosition.altitude),this.maxAltitudeReachedTime=this.maxAltitude<=s.range?Date.now():null,this.maxAltitude>this.startPosition.altitude?(l=Math.max(0,this.maxAltitude-this.startPosition.altitude),l+=Math.abs(this.targetPosition.altitude-this.maxAltitude)):l=Math.abs(this.targetPosition.altitude-this.startPosition.altitude);var p=Math.max(c,l/this.wwd.globe.equatorialRadius);if(0!==p){p<2*d&&(u=Math.min(p/d*this.travelTime,this.travelTime)),u=Math.max(1,u),this.panVelocity=c/u,this.rangeVelocity=l/u;var g=this,m=function(){return g.cancelled?void(g.completionCallback&&g.completionCallback(g)):void(g.update()?setTimeout(m,g.animationFrequency):g.completionCallback&&g.completionCallback(g))};setTimeout(m,this.animationFrequency)}},o.prototype.update=function(){var t=new r;this.wwd.navigator.getAsLookAt(this.wwd.globe,t);var e=new i(t.latitude,t.longitude,t.range),n=this.updateRange(e);return n=this.updateLocation(e)||n,this.wwd.redraw(),n},o.prototype.updateRange=function(t){var e,i,n=!1,o=new r;return this.wwd.navigator.getAsLookAt(this.wwd.globe,o),this.maxAltitudeReachedTime?(i=Date.now()-this.maxAltitudeReachedTime,this.maxAltitude>this.targetPosition.altitude?(e=this.maxAltitude-this.rangeVelocity*i,e=Math.max(e,this.targetPosition.altitude)):(e=this.maxAltitude+this.rangeVelocity*i,e=Math.min(e,this.targetPosition.altitude)),o.range=e,this.wwd.navigator.setAsLookAt(this.wwd.globe,o),n=Math.abs(o.range-this.targetPosition.altitude)>1):(i=Date.now()-this.startTime,e=Math.min(this.startPosition.altitude+this.rangeVelocity*i,this.maxAltitude),Math.abs(o.range-e)<1&&(this.maxAltitudeReachedTime=Date.now()),o.range=e,this.wwd.navigator.setAsLookAt(this.wwd.globe,o),n=!0),n},o.prototype.updateLocation=function(e){var i=Date.now()-this.startTime,n=t.greatCircleDistance(this.startPosition,e),o=t.greatCircleDistance(e,this.targetPosition),a=t.greatCircleAzimuth(e,this.targetPosition),s=this.panVelocity*i,l=Math.min(s-n,o),u=t.greatCircleLocation(e,a,l,new t(0,0)),c=!1,h=new r;return this.wwd.navigator.getAsLookAt(this.wwd.globe,h),h.latitude=u.latitude,h.longitude=u.longitude,this.wwd.navigator.setAsLookAt(this.wwd.globe,h),l<1/this.wwd.globe.equatorialRadius&&(c=!0),!c},o}),define("worldwind/util/HighlightController",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"HighlightController","constructor","missingWorldWindow"));this.worldWindow=r;var i=[],n=function(t){for(var e=t.clientX,n=t.clientY,o=i.length>0,a=0;a<i.length;a++)i[a].highlighted=!1;i=[];var s=r.pick(r.canvasCoordinates(e,n));if(s.objects.length>0&&(o=!0),s.objects.length>0)for(var l=0;l<s.objects.length;l++)s.objects[l].isTerrain||(s.objects[l].userObject.highlighted=!0,i.push(s.objects[l].userObject));o&&r.redraw()};this.worldWindow.addEventListener("mousemove",n);new WorldWind.TapRecognizer(this.worldWindow,n)};return r}),define("worldwind/formats/kml/KmlElements",[],function(){"use strict";var t={keys:{},addKey:function(t,e){this.keys[t]=e},getKey:function(t){return this.keys[t]}};return t}),define("worldwind/formats/kml/util/Attribute",[],function(){"use strict";var t=function(t,e){this.node=t,this.name=e};return t.prototype.value=function(){return this.node.attributes&&this.node.attributes.getNamedItem(this.name)&&this.node.attributes.getNamedItem(this.name).value||null},t.prototype.exists=function(){return null!=this.value()},t.prototype.save=function(t){this.node.setAttribute(this.name,t)},t}),define("worldwind/formats/kml/util/NodeTransformers",["./Attribute","../KmlElements","../../../geom/Position","../../../util/WWUtil"],function(t,e,r,i){function n(t){var e;return null!=t&&t.childNodes[0]?e=t.childNodes[0].nodeValue:null!=t&&(e=""),e}var o=function(){};return o.string=function(t){return String(n(t))},o.number=function(t){return Number(n(t))},o.boolean=function(t){return i.transformToBoolean(n(t))},o.date=function(t){return i.date(n(t))},o.kmlObject=function(t,r,i){var n=t.nodeName,o=e.getKey(n);return o?new o({objectNode:t,parent:r,controls:i}):null},o.linearRing=function(t,r,i){var n=e.getKey("LinearRing");if(!n)return null;var o=null;return Array.prototype.forEach.call(t.childNodes,function(t){t.nodeName.toUpperCase()=="LinearRing".toUpperCase()&&(o=t)}),new n({objectNode:o,parent:r,controls:i})},o.positions=function(t){var e=[],i=n(t).trim().replace(/\s+/g," ").split(" ");return i.forEach(function(t){t=t.split(","),e.push(new r(Number(t[1]),Number(t[0]),Number(t[2]||0)))}),e},o.attribute=function(e){return function(r){return new t(r,e).value()}},o}),define("worldwind/formats/kml/util/KmlElementsFactory",["./NodeTransformers"],function(t){"use strict";var e=function(t){this.options=t||{},this.options.controls=this.options.controls||[]};e.prototype.specific=function(t,e){var r=t.node,i=null,n=this;return[].forEach.call(r.childNodes,function(r){r.nodeName==e.name&&(i=e.transformer(r,t,n.options.controls))}),i},e.prototype.any=function(e,r){var i=e.node,n=null,o=this;return[].forEach.call(i.childNodes,function(i){r.name.indexOf(i.nodeName)!=-1&&(n=t.kmlObject(i,e,o.options.controls))}),n},e.prototype.all=function(e){var r=e.node,i=[],n=this;return[].forEach.call(r.childNodes,function(r){var o=t.kmlObject(r,e,n.options.controls);o&&i.push(o)}),i};var r=new e;return e.applicationWide=function(){return r},e}),define("worldwind/formats/kml/util/TreeKeyValueCache",["../../../util/WWUtil"],function(t){"use strict";var e=function(){this.map={}};e.prototype.add=function(t,e,r){this.map[t]||(this.map[t]={}),this.map[t][e]=r},e.prototype.value=function(e,r){if(!this.map[e])return null;if(r.indexOf("#")==-1){var i=this.level(e);for(var n in i)if(i.hasOwnProperty(n)&&t.startsWith(n,r))return i[n]}return this.map[e][r]||null},e.prototype.level=function(t){return this.map[t]},e.prototype.remove=function(t,e){delete this.map[t][e]};var r=new e;return e.applicationLevelCache=function(){return r},e}),define("worldwind/formats/kml/util/KmlElementsFactoryCached",["./Attribute","./KmlElementsFactory","./TreeKeyValueCache","../../../util/WWUtil"],function(t,e,r,i){"use strict";var n=function(t){this.internalFactory=new e(t),this.cache=r.applicationLevelCache()};n.prototype.all=function(t){var e=t.node,r=this.cache.level(this.cacheKey(t.node,"All"));if(r){var i=[];for(var n in r)r.hasOwnProperty(n)&&i.push(r[n]);return i}var o=this.internalFactory.all(t);if(o&&o.length){var a=this;o.forEach(function(t){a.cache.add(a.cacheKey(e,"All"),a.cacheKey(t.node),t)})}return o},n.prototype.specific=function(t,e){var r=t.node,i=e.name;e.attribute&&(i=e.attribute+i);var n=this.cache.value(this.cacheKey(r),i);if(n)return n;var o=this.internalFactory.specific(t,e);return o&&o.node?this.cache.add(this.cacheKey(r),this.cacheKey(o.node),o):o&&this.cache.add(this.cacheKey(r),i,o),o},n.prototype.any=function(t,e){var r,i=t.node,n=this,o=null;if(e.name.forEach(function(t){r=n.cache.value(n.cacheKey(i),t),r&&(o=r)}),o)return o;var a=this.internalFactory.any(t,e);return a&&this.cache.add(n.cacheKey(i),n.cacheKey(a.node),a),a},n.prototype.cacheKey=function(e,r){var n=new t(e,"id");n.exists()||n.save(i.guid());var o=e.nodeName+"#"+n.value();return r&&(o=r+o),o};var o=new n;return n.applicationWide=function(){return o},n}),function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function r(t){return"object"==typeof t&&null!==t}function i(t){W=t}function n(t){K=t}function o(){return function(){process.nextTick(c)}}function a(){return function(){B(c)}}function s(){var t=0,e=new H(c),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}function l(){var t=new MessageChannel;return t.port1.onmessage=c,function(){t.port2.postMessage(0)}}function u(){return function(){setTimeout(c,1)}}function c(){for(var t=0;t<j;t+=2){var e=X[t],r=X[t+1];e(r),X[t]=void 0,X[t+1]=void 0}j=0}function h(){try{var t=require,e=t("vertx");return B=e.runOnLoop||e.runOnContext,a()}catch(t){return u()}}function f(){}function d(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function g(t){try{return t.then}catch(t){return et.error=t,et}}function m(t,e,r,i){try{t.call(e,r,i)}catch(t){return t}}function y(t,e,r){K(function(t){var i=!1,n=m(r,e,function(r){i||(i=!0,e!==r?E(t,r):_(t,r))},function(e){i||(i=!0,x(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&n&&(i=!0,x(t,n))},t)}function v(t,e){e._state===Q?_(t,e._result):e._state===tt?x(t,e._result):S(e,void 0,function(e){E(t,e)},function(e){x(t,e)})}function b(t,r){if(r.constructor===t.constructor)v(t,r);else{var i=g(r);i===et?x(t,et.error):void 0===i?_(t,r):e(i)?y(t,r,i):_(t,r)}}function E(e,r){e===r?x(e,d()):t(r)?b(e,r):_(e,r)}function w(t){t._onerror&&t._onerror(t._result),T(t)}function _(t,e){t._state===J&&(t._result=e,t._state=Q,0!==t._subscribers.length&&K(T,t))}function x(t,e){t._state===J&&(t._state=tt,t._result=e,K(w,t))}function S(t,e,r,i){var n=t._subscribers,o=n.length;t._onerror=null,n[o]=e,n[o+Q]=r,n[o+tt]=i,0===o&&t._state&&K(T,t)}function T(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var i,n,o=t._result,a=0;a<e.length;a+=3)i=e[a],n=e[a+r],i?A(r,i,n,o):n(o);t._subscribers.length=0}}function M(){this.error=null}function L(t,e){try{return t(e)}catch(t){return rt.error=t,rt}}function A(t,r,i,n){var o,a,s,l,u=e(i);if(u){if(o=L(i,n),o===rt?(l=!0,a=o.error,o=null):s=!0,r===o)return void x(r,p())}else o=n,s=!0;r._state!==J||(u&&s?E(r,o):l?x(r,a):t===Q?_(r,o):t===tt&&x(r,o))}function N(t,e){try{e(function(e){E(t,e)},function(e){x(t,e)})}catch(e){x(t,e)}}function C(t,e){var r=this;r._instanceConstructor=t,r.promise=new t(f),r._validateInput(e)?(r._input=e,r.length=e.length,r._remaining=e.length,r._init(),0===r.length?_(r.promise,r._result):(r.length=r.length||0,r._enumerate(),0===r._remaining&&_(r.promise,r._result))):x(r.promise,r._validationError())}function R(t){return new it(this,t).promise}function P(t){function e(t){E(n,t)}function r(t){x(n,t)}var i=this,n=new i(f);if(!z(t))return x(n,new TypeError("You must pass an array to race.")),n;for(var o=t.length,a=0;n._state===J&&a<o;a++)S(i.resolve(t[a]),void 0,e,r);return n}function O(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var r=new e(f);return E(r,t),r}function I(t){var e=this,r=new e(f);return x(r,t),r}function k(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function D(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function V(t){this._id=lt++,this._state=void 0,this._result=void 0,this._subscribers=[],f!==t&&(e(t)||k(),this instanceof V||D(),N(this,t))}function F(){var t;if("undefined"!=typeof ft)t=ft;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;e&&"[object Promise]"===Object.prototype.toString.call(e.resolve())&&!e.cast||(t.Promise=ut);
}var G;G=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var B,W,U,z=G,j=0,K=({}.toString,function(t,e){X[j]=t,X[j+1]=e,j+=2,2===j&&(W?W(c):U())}),q="undefined"!=typeof window?window:void 0,Z=q||{},H=Z.MutationObserver||Z.WebKitMutationObserver,$="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,X=new Array(1e3);U=$?o():H?s():Y?l():void 0===q&&"function"==typeof require?h():u();var J=void 0,Q=1,tt=2,et=new M,rt=new M;C.prototype._validateInput=function(t){return z(t)},C.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},C.prototype._init=function(){this._result=new Array(this.length)};var it=C;C.prototype._enumerate=function(){for(var t=this,e=t.length,r=t.promise,i=t._input,n=0;r._state===J&&n<e;n++)t._eachEntry(i[n],n)},C.prototype._eachEntry=function(t,e){var i=this,n=i._instanceConstructor;r(t)?t.constructor===n&&t._state!==J?(t._onerror=null,i._settledAt(t._state,e,t._result)):i._willSettleAt(n.resolve(t),e):(i._remaining--,i._result[e]=t)},C.prototype._settledAt=function(t,e,r){var i=this,n=i.promise;n._state===J&&(i._remaining--,t===tt?x(n,r):i._result[e]=r),0===i._remaining&&_(n,i._result)},C.prototype._willSettleAt=function(t,e){var r=this;S(t,void 0,function(t){r._settledAt(Q,e,t)},function(t){r._settledAt(tt,e,t)})};var nt=R,ot=P,at=O,st=I,lt=0,ut=V;V.all=nt,V.race=ot,V.resolve=at,V.reject=st,V._setScheduler=i,V._setAsap=n,V._asap=K,V.prototype={constructor:V,then:function(t,e){var r=this,i=r._state;if(i===Q&&!t||i===tt&&!e)return this;var n=new this.constructor(f),o=r._result;if(i){var a=arguments[i-1];K(function(){A(i,n,a,o)})}else S(r,n,t,e);return n},catch:function(t){return this.then(null,t)}};var ct=F,ht={Promise:ut,polyfill:ct};"function"==typeof define&&define.amd?define("worldwind/util/es6-promise",[],function(){return ht}):"undefined"!=typeof module&&module.exports?module.exports=ht:"undefined"!=typeof this&&(this.ES6Promise=ht);var ft={};ct()}.call(this),define("worldwind/util/Promise",["./es6-promise"],function(t){"use strict";return window.Promise?window.Promise:t.Promise});define("worldwind/formats/kml/KmlObject",["../../error/ArgumentError","./util/Attribute","./KmlElements","./util/KmlElementsFactoryCached","../../util/Logger","../../util/Promise","../../render/Renderable"],function(t,e,r,i,n,o,a){"use strict";var s=function(e){if(a.call(this),e=e||{},!e.objectNode)throw new t(n.logMessage(n.LEVEL_SEVERE,"KmlObject","constructor","Passed node isn't defined."));this._node=e.objectNode,this._cache={},this._controls=e.controls||[],this._factory=new i({controls:this._controls}),this.hook(this._controls,e)};return s.prototype=Object.create(a.prototype),Object.defineProperties(s.prototype,{id:{get:function(){return new e(this.node,"id").value()}},node:{get:function(){return this._node}}}),s.prototype.hook=function(t,e){var r=this;t.forEach(function(t){t.hook(r,e)})},s.prototype.render=function(t){},s.prototype.getTagNames=function(){return[]},s});define("worldwind/formats/kml/util/ImagePyramid",["../KmlElements","../KmlObject","../util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlTileSize:{get:function(){return this._factory.specific(this,{name:"tileSize",transformer:r.number})}},kmlMaxWidth:{get:function(){return this._factory.specific(this,{name:"maxWidth",transformer:r.number})}},kmlMaxHeight:{get:function(){return this._factory.specific(this,{name:"maxHeight",transformer:r.number})}},kmlGridOrigin:{get:function(){return this._factory.specific(this,{name:"gridOrigin",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["ImagePyramid"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/util/ItemIcon",["./../KmlElements","../KmlObject","./NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlState:{get:function(){return this._factory.specific(this,{name:"state",transformer:r.string})}},kmlHref:{get:function(){return this._factory.specific(this,{name:"href",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["ItemIcon"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/KmlTimePrimitive",["./KmlObject"],function(t){"use strict";var e=function(e){t.call(this,e)};return e.prototype=Object.create(t.prototype),e.prototype.timeRange=function(){var t,e;return this.kmlBegin&&(e=t=this.kmlBegin.valueOf()),this.kmlEnd&&(e=this.kmlEnd.valueOf(),t||(t=e)),this.kmlWhen&&(e=t=this.kmlWhen.valueOf()),{from:t,to:e}},e.prototype.getTagNames=function(){return["TimeSpan","TimeStamp"]},e}),define("worldwind/formats/kml/KmlAbstractView",["./KmlObject","./KmlElements","./KmlTimePrimitive"],function(t,e,r){"use strict";var i=function(e){t.call(this,e)};return i.prototype=Object.create(t.prototype),Object.defineProperties(i.prototype,{kmlTimePrimitive:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}}}),i.prototype.getTagNames=function(){return["Camera","LookAt"]},i}),define("worldwind/formats/kml/styles/KmlSubStyle",["./../KmlObject"],function(t){"use strict";var e=function(e){t.call(this,e)};return e.prototype=Object.create(t.prototype),e.prototype.getTagNames=function(){return["LineStyle","PolyStyle","IconStyle","LabelStyle","BalloonStyle","ListStyle"]},e}),define("worldwind/formats/kml/styles/KmlBalloonStyle",["../KmlElements","./KmlSubStyle","../util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlBgColor:{get:function(){return this._factory.specific(this,{name:"bgColor",transformer:r.string})}},kmlTextColor:{get:function(){return this._factory.specific(this,{name:"textColor",transformer:r.string})}},kmlText:{get:function(){return this._factory.specific(this,{name:"text",transformer:r.string})}},kmlDisplayMode:{get:function(){return this._factory.specific(this,{name:"displayMode",transformer:r.string})}}}),i.update=function(){},i.prototype.getTagNames=function(){return["BalloonStyle"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/KmlCamera",["./KmlElements","./KmlAbstractView","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:r.string})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:r.string})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:r.string})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:r.string})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:r.string})}},kmlRoll:{get:function(){return this._factory.specific(this,{name:"roll",transformer:r.string})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["Camera"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/styles/KmlColorStyle",["./KmlSubStyle","../util/NodeTransformers"],function(t,e){"use strict";var r=function(e){t.call(this,e)};return r.prototype=Object.create(t.prototype),Object.defineProperties(r.prototype,{kmlColor:{get:function(){return this._factory.specific(this,{name:"color",transformer:e.string})}},kmlColorMode:{get:function(){return this._factory.specific(this,{name:"colorMode",transformer:e.string})}}}),r.prototype.getTagNames=function(){return["LineStyle","PolyStyle","IconStyle","LabelStyle"]},r}),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("worldwind/util/jszip",[],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.JSZip=t()}}(function(){return function t(e,r,i){function n(a,s){if(!r[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=r[a]={exports:{}};e[a][0].call(u.exports,function(t){var r=e[a][1][t];return n(r?r:t)},u,u.exports,t,e,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e,r){"use strict";var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(t,e){for(var r,n,o,a,s,l,u,c="",h=0;h<t.length;)r=t.charCodeAt(h++),n=t.charCodeAt(h++),o=t.charCodeAt(h++),a=r>>2,s=(3&r)<<4|n>>4,l=(15&n)<<2|o>>6,u=63&o,isNaN(n)?l=u=64:isNaN(o)&&(u=64),c=c+i.charAt(a)+i.charAt(s)+i.charAt(l)+i.charAt(u);return c},r.decode=function(t,e){var r,n,o,a,s,l,u,c="",h=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<t.length;)a=i.indexOf(t.charAt(h++)),s=i.indexOf(t.charAt(h++)),l=i.indexOf(t.charAt(h++)),u=i.indexOf(t.charAt(h++)),r=a<<2|s>>4,n=(15&s)<<4|l>>2,o=(3&l)<<6|u,c+=String.fromCharCode(r),64!=l&&(c+=String.fromCharCode(n)),64!=u&&(c+=String.fromCharCode(o));return c}},{}],2:[function(t,e,r){"use strict";function i(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}i.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},e.exports=i},{}],3:[function(t,e,r){"use strict";r.STORE={magic:"\0\0",compress:function(t,e){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},r.DEFLATE=t("./flate")},{"./flate":8}],4:[function(t,e,r){"use strict";var i=t("./utils"),n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];e.exports=function(t,e){if("undefined"==typeof t||!t.length)return 0;var r="string"!==i.getTypeOf(t);"undefined"==typeof e&&(e=0);var o=0,a=0,s=0;e^=-1;for(var l=0,u=t.length;l<u;l++)s=r?t[l]:t.charCodeAt(l),a=255&(e^s),o=n[a],e=e>>>8^o;return e^-1}},{"./utils":21}],5:[function(t,e,r){"use strict";function i(t){this.data=null,this.length=0,this.index=0}var n=t("./utils");i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,r=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)r=(r<<8)+this.byteAt(e);return this.index+=t,r},readString:function(t){return n.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}},e.exports=i},{"./utils":21}],6:[function(t,e,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!1,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],7:[function(t,e,r){"use strict";var i=t("./utils");r.string2binary=function(t){return i.string2binary(t)},r.string2Uint8Array=function(t){return i.transformTo("uint8array",t)},r.uint8Array2String=function(t){return i.transformTo("string",t)},r.string2Blob=function(t){var e=i.transformTo("arraybuffer",t);return i.arrayBuffer2Blob(e)},r.arrayBuffer2Blob=function(t){return i.arrayBuffer2Blob(t)},r.transformTo=function(t,e){return i.transformTo(t,e)},r.getTypeOf=function(t){return i.getTypeOf(t)},r.checkSupport=function(t){return i.checkSupport(t)},r.MAX_VALUE_16BITS=i.MAX_VALUE_16BITS,r.MAX_VALUE_32BITS=i.MAX_VALUE_32BITS,r.pretty=function(t){return i.pretty(t)},r.findCompression=function(t){return i.findCompression(t)},r.isRegExp=function(t){return i.isRegExp(t)}},{"./utils":21}],8:[function(t,e,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=t("pako");r.uncompressInputType=i?"uint8array":"array",r.compressInputType=i?"uint8array":"array",r.magic="\b\0",r.compress=function(t,e){return n.deflateRaw(t,{level:e.level||-1})},r.uncompress=function(t){return n.inflateRaw(t)}},{pako:24}],9:[function(t,e,r){"use strict";function i(t,e){return this instanceof i?(this.files={},this.comment=null,this.root="",t&&this.load(t,e),void(this.clone=function(){var t=new i;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t})):new i(t,e)}var n=t("./base64");i.prototype=t("./object"),i.prototype.load=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.utils=t("./deprecatedPublicUtils"),i.base64={encode:function(t){return n.encode(t)},decode:function(t){return n.decode(t)}},i.compressions=t("./compressions"),e.exports=i},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(t,e,r){"use strict";var i=t("./base64"),n=t("./zipEntries");e.exports=function(t,e){var r,o,a,s;for(e=e||{},e.base64&&(t=i.decode(t)),o=new n(t,e),r=o.files,a=0;a<r.length;a++)s=r[a],this.file(s.fileName,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileComment.length?s.fileComment:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:e.createFolders});return o.zipComment.length&&(this.comment=o.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(t,e,r){(function(t){"use strict";e.exports=function(e,r){return new t(e,r)},e.exports.test=function(e){return t.isBuffer(e)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(t,e,r){"use strict";function i(t){this.data=t,this.length=this.data.length,this.index=0}var n=t("./uint8ArrayReader");i.prototype=new n,i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./uint8ArrayReader":18}],13:[function(t,e,r){"use strict";var i=t("./support"),n=t("./utils"),o=t("./crc32"),a=t("./signature"),s=t("./defaults"),l=t("./base64"),u=t("./compressions"),c=t("./compressedObject"),h=t("./nodeBuffer"),f=t("./utf8"),d=t("./stringWriter"),p=t("./uint8ArrayWriter"),g=function(t){if(t._data instanceof c&&(t._data=t._data.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===n.getTypeOf(t._data))){var e=t._data;t._data=new Uint8Array(e.length),0!==e.length&&t._data.set(e,0)}return t._data},m=function(t){var e=g(t),r=n.getTypeOf(e);return"string"===r?!t.options.binary&&i.nodebuffer?h(e,"utf-8"):t.asBinary():e},y=function(t){var e=g(this);return null===e||"undefined"==typeof e?"":(this.options.base64&&(e=l.decode(e)),e=t&&this.options.binary?C.utf8decode(e):n.transformTo("string",e),t||this.options.binary||(e=n.transformTo("string",C.utf8encode(e))),e)},v=function(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this.options=r,this._initialMetadata={dir:r.dir,date:r.date}};v.prototype={asText:function(){return y.call(this,!0)},asBinary:function(){return y.call(this,!1)},asNodeBuffer:function(){var t=m(this);return n.transformTo("nodebuffer",t)},asUint8Array:function(){var t=m(this);return n.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var b=function(t,e){var r,i="";for(r=0;r<e;r++)i+=String.fromCharCode(255&t),t>>>=8;return i},E=function(){var t,e,r={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&"undefined"==typeof r[e]&&(r[e]=arguments[t][e]);return r},w=function(t){return t=t||{},t.base64!==!0||null!==t.binary&&void 0!==t.binary||(t.binary=!0),t=E(t,s),t.date=t.date||new Date,null!==t.compression&&(t.compression=t.compression.toUpperCase()),t},_=function(t,e,r){var i,o=n.getTypeOf(e);if(r=w(r),"string"==typeof r.unixPermissions&&(r.unixPermissions=parseInt(r.unixPermissions,8)),r.unixPermissions&&16384&r.unixPermissions&&(r.dir=!0),r.dosPermissions&&16&r.dosPermissions&&(r.dir=!0),r.dir&&(t=S(t)),r.createFolders&&(i=x(t))&&T.call(this,i,!0),r.dir||null===e||"undefined"==typeof e)r.base64=!1,r.binary=!1,e=null,o=null;else if("string"===o)r.binary&&!r.base64&&r.optimizedBinaryString!==!0&&(e=n.string2binary(e));else{if(r.base64=!1,r.binary=!0,!(o||e instanceof c))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===o&&(e=n.transformTo("uint8array",e))}var a=new v(t,e,r);return this.files[t]=a,a},x=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},S=function(t){return"/"!=t.slice(-1)&&(t+="/"),t},T=function(t,e){return e="undefined"!=typeof e&&e,t=S(t),this.files[t]||_.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]},M=function(t,e,r){var i,a=new c;return t._data instanceof c?(a.uncompressedSize=t._data.uncompressedSize,a.crc32=t._data.crc32,0===a.uncompressedSize||t.dir?(e=u.STORE,a.compressedContent="",a.crc32=0):t._data.compressionMethod===e.magic?a.compressedContent=t._data.getCompressedContent():(i=t._data.getContent(),a.compressedContent=e.compress(n.transformTo(e.compressInputType,i),r))):(i=m(t),i&&0!==i.length&&!t.dir||(e=u.STORE,i=""),a.uncompressedSize=i.length,a.crc32=o(i),a.compressedContent=e.compress(n.transformTo(e.compressInputType,i),r)),a.compressedSize=a.compressedContent.length,a.compressionMethod=e.magic,a},L=function(t,e){var r=t;return t||(r=e?16893:33204),(65535&r)<<16},A=function(t,e){return 63&(t||0)},N=function(t,e,r,i,s){var l,u,c,h,d=(r.compressedContent,n.transformTo("string",f.utf8encode(e.name))),p=e.comment||"",g=n.transformTo("string",f.utf8encode(p)),m=d.length!==e.name.length,y=g.length!==p.length,v=e.options,E="",w="",_="";c=e._initialMetadata.dir!==e.dir?e.dir:v.dir,h=e._initialMetadata.date!==e.date?e.date:v.date;var x=0,S=0;c&&(x|=16),"UNIX"===s?(S=798,x|=L(e.unixPermissions,c)):(S=20,x|=A(e.dosPermissions,c)),l=h.getHours(),l<<=6,l|=h.getMinutes(),l<<=5,l|=h.getSeconds()/2,u=h.getFullYear()-1980,u<<=4,u|=h.getMonth()+1,u<<=5,u|=h.getDate(),m&&(w=b(1,1)+b(o(d),4)+d,E+="up"+b(w.length,2)+w),y&&(_=b(1,1)+b(this.crc32(g),4)+g,E+="uc"+b(_.length,2)+_);var T="";T+="\n\0",T+=m||y?"\0\b":"\0\0",T+=r.compressionMethod,T+=b(l,2),T+=b(u,2),T+=b(r.crc32,4),T+=b(r.compressedSize,4),T+=b(r.uncompressedSize,4),T+=b(d.length,2),T+=b(E.length,2);var M=a.LOCAL_FILE_HEADER+T+d+E,N=a.CENTRAL_FILE_HEADER+b(S,2)+T+b(g.length,2)+"\0\0\0\0"+b(x,4)+b(i,4)+d+E+g;return{fileRecord:M,dirRecord:N,compressedObject:r}},C={load:function(t,e){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(t){var e,r,i,n,o=[];for(e in this.files)this.files.hasOwnProperty(e)&&(i=this.files[e],n=new v(i.name,i._data,E(i.options)),r=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(r,n)&&o.push(n));return o},file:function(t,e,r){if(1===arguments.length){if(n.isRegExp(t)){var i=t;return this.filter(function(t,e){return!e.dir&&i.test(t)})}return this.filter(function(e,r){return!r.dir&&e===t})[0]||null}return t=this.root+t,_.call(this,t,e,r),this},folder:function(t){if(!t)return this;if(n.isRegExp(t))return this.filter(function(e,r){return r.dir&&t.test(e)});var e=this.root+t,r=T.call(this,e),i=this.clone();return i.root=r.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!=t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var r=this.filter(function(e,r){return r.name.slice(0,t.length)===t}),i=0;i<r.length;i++)delete this.files[r[i].name];return this},generate:function(t){t=E(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip"}),n.checkSupport(t.type),"darwin"!==t.platform&&"freebsd"!==t.platform&&"linux"!==t.platform&&"sunos"!==t.platform||(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var e,r,i=[],o=0,s=0,c=n.transformTo("string",this.utf8encode(t.comment||this.comment||""));for(var h in this.files)if(this.files.hasOwnProperty(h)){var f=this.files[h],g=f.options.compression||t.compression.toUpperCase(),m=u[g];if(!m)throw new Error(g+" is not a valid compression method !");var y=f.options.compressionOptions||t.compressionOptions||{},v=M.call(this,f,m,y),w=N.call(this,h,f,v,o,t.platform);o+=w.fileRecord.length+v.compressedSize,s+=w.dirRecord.length,i.push(w)}var _="";_=a.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(i.length,2)+b(i.length,2)+b(s,4)+b(o,4)+b(c.length,2)+c;var x=t.type.toLowerCase();for(e="uint8array"===x||"arraybuffer"===x||"blob"===x||"nodebuffer"===x?new p(o+s+_.length):new d(o+s+_.length),r=0;r<i.length;r++)e.append(i[r].fileRecord),e.append(i[r].compressedObject.compressedContent);for(r=0;r<i.length;r++)e.append(i[r].dirRecord);e.append(_);var S=e.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return n.transformTo(t.type.toLowerCase(),S);case"blob":return n.arrayBuffer2Blob(n.transformTo("arraybuffer",S),t.mimeType);case"base64":return t.base64?l.encode(S):S;default:return S}},crc32:function(t,e){return o(t,e)},utf8encode:function(t){return n.transformTo("string",f.utf8encode(t))},utf8decode:function(t){return f.utf8decode(t)}};e.exports=C},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(t,e,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],15:[function(t,e,r){"use strict";function i(t,e){this.data=t,e||(this.data=o.string2binary(this.data)),this.length=this.data.length,this.index=0}var n=t("./dataReader"),o=t("./utils");i.prototype=new n,i.prototype.byteAt=function(t){return this.data.charCodeAt(t)},i.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)},i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./dataReader":5,"./utils":21}],16:[function(t,e,r){"use strict";var i=t("./utils"),n=function(){this.data=[]};n.prototype={append:function(t){t=i.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}},e.exports=n},{"./utils":21}],17:[function(t,e,r){(function(t){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof t,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var e=new ArrayBuffer(0);try{r.blob=0===new Blob([e],{type:"application/zip"}).size}catch(t){try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,n=new i;n.append(e),r.blob=0===n.getBlob("application/zip").size}catch(t){r.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(t,e,r){"use strict";function i(t){t&&(this.data=t,this.length=this.data.length,this.index=0)}var n=t("./dataReader");i.prototype=new n,i.prototype.byteAt=function(t){return this.data[t]},i.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===e&&this.data[o+1]===r&&this.data[o+2]===i&&this.data[o+3]===n)return o;return-1},i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./dataReader":5}],19:[function(t,e,r){"use strict";var i=t("./utils"),n=function(t){this.data=new Uint8Array(t),this.index=0};n.prototype={append:function(t){0!==t.length&&(t=i.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}},e.exports=n},{"./utils":21}],20:[function(t,e,r){"use strict";for(var i=t("./utils"),n=t("./support"),o=t("./nodeBuffer"),a=new Array(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;a[254]=a[254]=1;var l=function(t){var e,r,i,o,a,s=t.length,l=0;for(o=0;o<s;o++)r=t.charCodeAt(o),55296===(64512&r)&&o+1<s&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),o++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=n.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;a<l;o++)r=t.charCodeAt(o),55296===(64512&r)&&o+1<s&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),o++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|63&r):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|63&r):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|63&r);return e},u=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&128===(192&t[r]);)r--;return r<0?e:0===r?e:r+a[t[r]]>e?r:e},c=function(t){var e,r,n,o,s=t.length,l=new Array(2*s);for(r=0,e=0;e<s;)if(n=t[e++],n<128)l[r++]=n;else if(o=a[n],o>4)l[r++]=65533,e+=o-1;else{for(n&=2===o?31:3===o?15:7;o>1&&e<s;)n=n<<6|63&t[e++],o--;o>1?l[r++]=65533:n<65536?l[r++]=n:(n-=65536,l[r++]=55296|n>>10&1023,l[r++]=56320|1023&n)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),i.applyFromCharCode(l)};r.utf8encode=function(t){return n.nodebuffer?o(t,"utf-8"):l(t)},r.utf8decode=function(t){if(n.nodebuffer)return i.transformTo("nodebuffer",t).toString("utf-8");t=i.transformTo(n.uint8array?"uint8array":"array",t);for(var e=[],r=0,o=t.length,a=65536;r<o;){var s=u(t,Math.min(r+a,o));n.uint8array?e.push(c(t.subarray(r,s))):e.push(c(t.slice(r,s))),r=s}return e.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(t,e,r){"use strict";function i(t){return t}function n(t,e){for(var r=0;r<t.length;++r)e[r]=255&t.charCodeAt(r);return e}function o(t){var e=65536,i=[],n=t.length,o=r.getTypeOf(t),a=0,s=!0;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,u(0))}}catch(t){s=!1}if(!s){for(var l="",c=0;c<t.length;c++)l+=String.fromCharCode(t[c]);return l}for(;a<n&&e>1;)try{"array"===o||"nodebuffer"===o?i.push(String.fromCharCode.apply(null,t.slice(a,Math.min(a+e,n)))):i.push(String.fromCharCode.apply(null,t.subarray(a,Math.min(a+e,n)))),a+=e}catch(t){e=Math.floor(e/2)}return i.join("")}function a(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}var s=t("./support"),l=t("./compressions"),u=t("./nodeBuffer");r.string2binary=function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(255&t.charCodeAt(r));return e},r.arrayBuffer2Blob=function(t,e){r.checkSupport("blob"),e=e||"application/zip";try{return new Blob([t],{type:e})}catch(r){try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,n=new i;return n.append(t),n.getBlob(e)}catch(t){throw new Error("Bug : can't construct the Blob.")}}},r.applyFromCharCode=o;var c={};c.string={string:i,array:function(t){return n(t,new Array(t.length))},arraybuffer:function(t){return c.string.uint8array(t).buffer},uint8array:function(t){return n(t,new Uint8Array(t.length))},nodebuffer:function(t){return n(t,u(t.length))}},c.array={string:o,array:i,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return u(t)}},c.arraybuffer={string:function(t){return o(new Uint8Array(t))},array:function(t){return a(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:i,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return u(new Uint8Array(t))}},c.uint8array={string:o,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:i,nodebuffer:function(t){return u(t)}},c.nodebuffer={string:o,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return c.nodebuffer.uint8array(t).buffer},uint8array:function(t){return a(t,new Uint8Array(t.length))},nodebuffer:i},r.transformTo=function(t,e){if(e||(e=""),!t)return e;r.checkSupport(t);var i=r.getTypeOf(e),n=c[i][t](e);return n},r.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":s.nodebuffer&&u.test(t)?"nodebuffer":s.uint8array&&t instanceof Uint8Array?"uint8array":s.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(t){var e=s[t.toLowerCase()];if(!e)throw new Error(t+" is not supported by this browser")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(t){var e,r,i="";for(r=0;r<(t||"").length;r++)e=t.charCodeAt(r),i+="\\x"+(e<16?"0":"")+e.toString(16).toUpperCase();return i},r.findCompression=function(t){for(var e in l)if(l.hasOwnProperty(e)&&l[e].magic===t)return l[e];return null},r.isRegExp=function(t){
return"[object RegExp]"===Object.prototype.toString.call(t)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(t,e,r){"use strict";function i(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}var n=t("./stringReader"),o=t("./nodeBufferReader"),a=t("./uint8ArrayReader"),s=t("./utils"),l=t("./signature"),u=t("./zipEntry"),c=t("./support"),h=t("./object");i.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+s.pretty(e)+", expected "+s.pretty(t)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=h.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,r,i=this.zip64EndOfCentralSize-44,n=0;n<i;)t=this.reader.readInt(2),e=this.reader.readInt(4),r=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===l.CENTRAL_FILE_HEADER;)t=new u({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(t===-1){var e=!0;try{this.reader.setIndex(0),this.checkSignature(l.LOCAL_FILE_HEADER),e=!1}catch(t){}throw e?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory")}if(this.reader.setIndex(t),this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),t===-1)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(t),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(t){var e=s.getTypeOf(t);"string"!==e||c.uint8array?"nodebuffer"===e?this.reader=new o(t):this.reader=new a(s.transformTo("uint8array",t)):this.reader=new n(t,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=i},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(t,e,r){"use strict";function i(t,e){this.options=t,this.loadOptions=e}var n=t("./stringReader"),o=t("./utils"),a=t("./compressedObject"),s=t("./object"),l=0,u=3;i.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},prepareCompressedContent:function(t,e,r){return function(){var i=t.index;t.setIndex(e);var n=t.readData(r);return t.setIndex(i),n}},prepareContent:function(t,e,r,i,n){return function(){var t=o.transformTo(i.uncompressInputType,this.getCompressedContent()),e=i.uncompress(t);if(e.length!==n)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(t){var e,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readString(this.fileNameLength),t.skip(r),this.compressedSize==-1||this.uncompressedSize==-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(e=o.findCompression(this.compressionMethod),null===e)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new a,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,e),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,e,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),s.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readString(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readString(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),t===l&&(this.dosPermissions=63&this.externalFileAttributes),t===u&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileName.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=new n(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,r,i,n=t.index;for(this.extraFields=this.extraFields||{};t.index<n+this.extraFieldsLength;)e=t.readInt(2),r=t.readInt(2),i=t.readString(r),this.extraFields[e]={id:e,length:r,value:i}},handleUTF8:function(){if(this.useUTF8())this.fileName=s.utf8decode(this.fileName),this.fileComment=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();null!==t&&(this.fileName=t);var e=this.findExtraFieldUnicodeComment();null!==e&&(this.fileComment=e)}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=new n(t.value);return 1!==e.readInt(1)?null:s.crc32(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=new n(t.value);return 1!==e.readInt(1)?null:s.crc32(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null}},e.exports=i},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(t,e,r){var i=t("./lib/utils/common").assign,n=t("./lib/deflate"),o=t("./lib/inflate"),a=t("./lib/zlib/constants"),s={};i(s,n,o,a),e.exports=s},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(t,e,r){"use strict";function i(t,e){var r=new v(e);if(r.push(t,!0),r.err)throw r.msg;return r.result}function n(t,e){return e=e||{},e.raw=!0,i(t,e)}function o(t,e){return e=e||{},e.gzip=!0,i(t,e)}var a=t("./zlib/deflate.js"),s=t("./utils/common"),l=t("./utils/strings"),u=t("./zlib/messages"),c=t("./zlib/zstream"),h=0,f=4,d=0,p=1,g=-1,m=0,y=8,v=function(t){this.options=s.assign({level:g,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var r=a.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==d)throw new Error(u[r]);e.header&&a.deflateSetHeader(this.strm,e.header)};v.prototype.push=function(t,e){var r,i,n=this.strm,o=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:e===!0?f:h,"string"==typeof t?n.input=l.string2buf(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new s.Buf8(o),n.next_out=0,n.avail_out=o),r=a.deflate(n,i),r!==p&&r!==d)return this.onEnd(r),this.ended=!0,!1;(0===n.avail_out||0===n.avail_in&&i===f)&&("string"===this.options.to?this.onData(l.buf2binstring(s.shrinkBuf(n.output,n.next_out))):this.onData(s.shrinkBuf(n.output,n.next_out)))}while((n.avail_in>0||0===n.avail_out)&&r!==p);return i!==f||(r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===d)},v.prototype.onData=function(t){this.chunks.push(t)},v.prototype.onEnd=function(t){t===d&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Deflate=v,r.deflate=i,r.deflateRaw=n,r.gzip=o},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(t,e,r){"use strict";function i(t,e){var r=new f(e);if(r.push(t,!0),r.err)throw r.msg;return r.result}function n(t,e){return e=e||{},e.raw=!0,i(t,e)}var o=t("./zlib/inflate.js"),a=t("./utils/common"),s=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),c=t("./zlib/zstream"),h=t("./zlib/gzheader"),f=function(t){this.options=a.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var r=o.inflateInit2(this.strm,e.windowBits);if(r!==l.Z_OK)throw new Error(u[r]);this.header=new h,o.inflateGetHeader(this.strm,this.header)};f.prototype.push=function(t,e){var r,i,n,u,c,h=this.strm,f=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:e===!0?l.Z_FINISH:l.Z_NO_FLUSH,"string"==typeof t?h.input=s.binstring2buf(t):h.input=t,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new a.Buf8(f),h.next_out=0,h.avail_out=f),r=o.inflate(h,l.Z_NO_FLUSH),r!==l.Z_STREAM_END&&r!==l.Z_OK)return this.onEnd(r),this.ended=!0,!1;h.next_out&&(0===h.avail_out||r===l.Z_STREAM_END||0===h.avail_in&&i===l.Z_FINISH)&&("string"===this.options.to?(n=s.utf8border(h.output,h.next_out),u=h.next_out-n,c=s.buf2string(h.output,n),h.next_out=u,h.avail_out=f-u,u&&a.arraySet(h.output,h.output,n,u,0),this.onData(c)):this.onData(a.shrinkBuf(h.output,h.next_out)))}while(h.avail_in>0&&r!==l.Z_STREAM_END);return r===l.Z_STREAM_END&&(i=l.Z_FINISH),i!==l.Z_FINISH||(r=o.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===l.Z_OK)},f.prototype.onData=function(t){this.chunks.push(t)},f.prototype.onEnd=function(t){t===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Inflate=f,r.inflate=i,r.inflateRaw=n,r.ungzip=i},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(t,e,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}}return t},r.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var n={arraySet:function(t,e,r,i,n){if(e.subarray&&t.subarray)return void t.set(e.subarray(r,r+i),n);for(var o=0;o<i;o++)t[n+o]=e[r+o]},flattenChunks:function(t){var e,r,i,n,o,a;for(i=0,e=0,r=t.length;e<r;e++)i+=t[e].length;for(a=new Uint8Array(i),n=0,e=0,r=t.length;e<r;e++)o=t[e],a.set(o,n),n+=o.length;return a}},o={arraySet:function(t,e,r,i,n){for(var o=0;o<i;o++)t[n+o]=e[r+o]},flattenChunks:function(t){return[].concat.apply([],t)}};r.setTyped=function(t){t?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,n)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(i)},{}],28:[function(t,e,r){function i(t,e){if(e<65537&&(t.subarray&&a||!t.subarray&&o))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var r="",i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r}var n=t("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var s=new n.Buf8(256),l=0;l<256;l++)s[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;s[254]=s[254]=1,r.string2buf=function(t){var e,r,i,o,a,s=t.length,l=0;for(o=0;o<s;o++)r=t.charCodeAt(o),55296===(64512&r)&&o+1<s&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),o++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new n.Buf8(l),a=0,o=0;a<l;o++)r=t.charCodeAt(o),55296===(64512&r)&&o+1<s&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),o++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|63&r):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|63&r):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|63&r);return e},r.buf2binstring=function(t){return i(t,t.length)},r.binstring2buf=function(t){for(var e=new n.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e},r.buf2string=function(t,e){var r,n,o,a,l=e||t.length,u=new Array(2*l);for(n=0,r=0;r<l;)if(o=t[r++],o<128)u[n++]=o;else if(a=s[o],a>4)u[n++]=65533,r+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&r<l;)o=o<<6|63&t[r++],a--;a>1?u[n++]=65533:o<65536?u[n++]=o:(o-=65536,u[n++]=55296|o>>10&1023,u[n++]=56320|1023&o)}return i(u,n)},r.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&128===(192&t[r]);)r--;return r<0?e:0===r?e:r+s[t[r]]>e?r:e}},{"./common":27}],29:[function(t,e,r){"use strict";function i(t,e,r,i){for(var n=65535&t|0,o=t>>>16&65535|0,a=0;0!==r;){a=r>2e3?2e3:r,r-=a;do n=n+e[i++]|0,o=o+n|0;while(--a);n%=65521,o%=65521}return n|o<<16|0}e.exports=i},{}],30:[function(t,e,r){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(t,e,r){"use strict";function i(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}function n(t,e,r,i){var n=o,a=i+r;t^=-1;for(var s=i;s<a;s++)t=t>>>8^n[255&(t^e[s])];return t^-1}var o=i();e.exports=n},{}],32:[function(t,e,r){"use strict";function i(t,e){return t.msg=P[e],e}function n(t){return(t<<1)-(t>4?9:0)}function o(t){for(var e=t.length;--e>=0;)t[e]=0}function a(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(A.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function s(t,e){N._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,a(t.strm)}function l(t,e){t.pending_buf[t.pending++]=e}function u(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function c(t,e,r,i){var n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,A.arraySet(e,t.input,t.next_in,n,r),1===t.state.wrap?t.adler=C(t.adler,e,n,r):2===t.state.wrap&&(t.adler=R(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)}function h(t,e){var r,i,n=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-ut?t.strstart-(t.w_size-ut):0,u=t.window,c=t.w_mask,h=t.prev,f=t.strstart+lt,d=u[o+a-1],p=u[o+a];t.prev_length>=t.good_match&&(n>>=2),s>t.lookahead&&(s=t.lookahead);do if(r=e,u[r+a]===p&&u[r+a-1]===d&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do;while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&o<f);if(i=lt-(f-o),o=f-lt,i>a){if(t.match_start=e,a=i,i>=s)break;d=u[o+a-1],p=u[o+a]}}while((e=h[e&c])>l&&0!==--n);return a<=t.lookahead?a:t.lookahead}function f(t){var e,r,i,n,o,a=t.w_size;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=a+(a-ut)){A.arraySet(t.window,t.window,a,a,0),t.match_start-=a,t.strstart-=a,t.block_start-=a,r=t.hash_size,e=r;do i=t.head[--e],t.head[e]=i>=a?i-a:0;while(--r);r=a,e=r;do i=t.prev[--e],t.prev[e]=i>=a?i-a:0;while(--r);n+=a}if(0===t.strm.avail_in)break;if(r=c(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=r,t.lookahead+t.insert>=st)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+st-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<st)););}while(t.lookahead<ut&&0!==t.strm.avail_in)}function d(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(f(t),0===t.lookahead&&e===O)return vt;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+r;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,s(t,!1),0===t.strm.avail_out))return vt;if(t.strstart-t.block_start>=t.w_size-ut&&(s(t,!1),0===t.strm.avail_out))return vt}return t.insert=0,e===D?(s(t,!0),0===t.strm.avail_out?Et:wt):t.strstart>t.block_start&&(s(t,!1),0===t.strm.avail_out)?vt:vt}function p(t,e){for(var r,i;;){if(t.lookahead<ut){if(f(t),t.lookahead<ut&&e===O)return vt;if(0===t.lookahead)break}if(r=0,t.lookahead>=st&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-ut&&(t.match_length=h(t,r)),t.match_length>=st)if(i=N._tr_tally(t,t.strstart-t.match_start,t.match_length-st),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=st){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=N._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(s(t,!1),0===t.strm.avail_out))return vt}return t.insert=t.strstart<st-1?t.strstart:st-1,e===D?(s(t,!0),0===t.strm.avail_out?Et:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?vt:bt}function g(t,e){for(var r,i,n;;){if(t.lookahead<ut){if(f(t),t.lookahead<ut&&e===O)return vt;if(0===t.lookahead)break}if(r=0,t.lookahead>=st&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=st-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-ut&&(t.match_length=h(t,r),t.match_length<=5&&(t.strategy===j||t.match_length===st&&t.strstart-t.match_start>4096)&&(t.match_length=st-1)),t.prev_length>=st&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-st,i=N._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-st),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(0!==--t.prev_length);if(t.match_available=0,t.match_length=st-1,t.strstart++,i&&(s(t,!1),0===t.strm.avail_out))return vt}else if(t.match_available){if(i=N._tr_tally(t,0,t.window[t.strstart-1]),i&&s(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return vt}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=N._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<st-1?t.strstart:st-1,e===D?(s(t,!0),0===t.strm.avail_out?Et:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?vt:bt}function m(t,e){for(var r,i,n,o,a=t.window;;){if(t.lookahead<=lt){if(f(t),t.lookahead<=lt&&e===O)return vt;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=st&&t.strstart>0&&(n=t.strstart-1,i=a[n],i===a[++n]&&i===a[++n]&&i===a[++n])){o=t.strstart+lt;do;while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<o);t.match_length=lt-(o-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=st?(r=N._tr_tally(t,1,t.match_length-st),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=N._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(s(t,!1),0===t.strm.avail_out))return vt}return t.insert=0,e===D?(s(t,!0),0===t.strm.avail_out?Et:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?vt:bt}function y(t,e){for(var r;;){if(0===t.lookahead&&(f(t),0===t.lookahead)){if(e===O)return vt;break}if(t.match_length=0,r=N._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(s(t,!1),0===t.strm.avail_out))return vt}return t.insert=0,e===D?(s(t,!0),0===t.strm.avail_out?Et:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?vt:bt}function v(t){t.window_size=2*t.w_size,o(t.head),t.max_lazy_match=L[t.level].max_lazy,t.good_match=L[t.level].good_length,t.nice_match=L[t.level].nice_length,t.max_chain_length=L[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=st-1,t.match_available=0,t.ins_h=0}function b(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new A.Buf16(2*ot),this.dyn_dtree=new A.Buf16(2*(2*it+1)),this.bl_tree=new A.Buf16(2*(2*nt+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new A.Buf16(at+1),this.heap=new A.Buf16(2*rt+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new A.Buf16(2*rt+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function E(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=$,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?ht:mt,t.adler=2===e.wrap?0:1,e.last_flush=O,N._tr_init(e),F):i(t,B)}function w(t){var e=E(t);return e===F&&v(t.state),e}function _(t,e){return t&&t.state?2!==t.state.wrap?B:(t.state.gzhead=e,F):B}function x(t,e,r,n,o,a){if(!t)return B;var s=1;if(e===z&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),o<1||o>X||r!==Y||n<8||n>15||e<0||e>9||a<0||a>Z)return i(t,B);8===n&&(n=9);var l=new b;return t.state=l,l.strm=t,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+st-1)/st),l.window=new A.Buf8(2*l.w_size),l.head=new A.Buf16(l.hash_size),l.prev=new A.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new A.Buf8(l.pending_buf_size),l.d_buf=l.lit_bufsize>>1,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=r,w(t)}function S(t,e){return x(t,e,Y,J,Q,H)}function T(t,e){var r,s,c,h;if(!t||!t.state||e>V||e<0)return t?i(t,B):B;if(s=t.state,!t.output||!t.input&&0!==t.avail_in||s.status===yt&&e!==D)return i(t,0===t.avail_out?U:B);if(s.strm=t,r=s.last_flush,s.last_flush=e,s.status===ht)if(2===s.wrap)t.adler=0,l(s,31),l(s,139),l(s,8),s.gzhead?(l(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),l(s,255&s.gzhead.time),l(s,s.gzhead.time>>8&255),l(s,s.gzhead.time>>16&255),l(s,s.gzhead.time>>24&255),l(s,9===s.level?2:s.strategy>=K||s.level<2?4:0),l(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(l(s,255&s.gzhead.extra.length),l(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(t.adler=R(t.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=ft):(l(s,0),l(s,0),l(s,0),l(s,0),l(s,0),l(s,9===s.level?2:s.strategy>=K||s.level<2?4:0),l(s,_t),s.status=mt);else{var f=Y+(s.w_bits-8<<4)<<8,d=-1;d=s.strategy>=K||s.level<2?0:s.level<6?1:6===s.level?2:3,f|=d<<6,0!==s.strstart&&(f|=ct),f+=31-f%31,s.status=mt,u(s,f),0!==s.strstart&&(u(s,t.adler>>>16),u(s,65535&t.adler)),t.adler=1}if(s.status===ft)if(s.gzhead.extra){for(c=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>c&&(t.adler=R(t.adler,s.pending_buf,s.pending-c,c)),a(t),c=s.pending,s.pending!==s.pending_buf_size));)l(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>c&&(t.adler=R(t.adler,s.pending_buf,s.pending-c,c)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=dt)}else s.status=dt;if(s.status===dt)if(s.gzhead.name){c=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>c&&(t.adler=R(t.adler,s.pending_buf,s.pending-c,c)),a(t),c=s.pending,s.pending===s.pending_buf_size)){h=1;break}h=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,l(s,h)}while(0!==h);s.gzhead.hcrc&&s.pending>c&&(t.adler=R(t.adler,s.pending_buf,s.pending-c,c)),0===h&&(s.gzindex=0,s.status=pt)}else s.status=pt;if(s.status===pt)if(s.gzhead.comment){c=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>c&&(t.adler=R(t.adler,s.pending_buf,s.pending-c,c)),a(t),c=s.pending,s.pending===s.pending_buf_size)){h=1;break}h=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,l(s,h)}while(0!==h);s.gzhead.hcrc&&s.pending>c&&(t.adler=R(t.adler,s.pending_buf,s.pending-c,c)),0===h&&(s.status=gt)}else s.status=gt;if(s.status===gt&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&a(t),s.pending+2<=s.pending_buf_size&&(l(s,255&t.adler),l(s,t.adler>>8&255),t.adler=0,s.status=mt)):s.status=mt),0!==s.pending){if(a(t),0===t.avail_out)return s.last_flush=-1,F}else if(0===t.avail_in&&n(e)<=n(r)&&e!==D)return i(t,U);if(s.status===yt&&0!==t.avail_in)return i(t,U);if(0!==t.avail_in||0!==s.lookahead||e!==O&&s.status!==yt){var p=s.strategy===K?y(s,e):s.strategy===q?m(s,e):L[s.level].func(s,e);if(p!==Et&&p!==wt||(s.status=yt),p===vt||p===Et)return 0===t.avail_out&&(s.last_flush=-1),F;if(p===bt&&(e===I?N._tr_align(s):e!==V&&(N._tr_stored_block(s,0,0,!1),e===k&&(o(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),a(t),0===t.avail_out))return s.last_flush=-1,F}return e!==D?F:s.wrap<=0?G:(2===s.wrap?(l(s,255&t.adler),l(s,t.adler>>8&255),l(s,t.adler>>16&255),l(s,t.adler>>24&255),l(s,255&t.total_in),l(s,t.total_in>>8&255),l(s,t.total_in>>16&255),l(s,t.total_in>>24&255)):(u(s,t.adler>>>16),u(s,65535&t.adler)),a(t),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?F:G)}function M(t){var e;return t&&t.state?(e=t.state.status,e!==ht&&e!==ft&&e!==dt&&e!==pt&&e!==gt&&e!==mt&&e!==yt?i(t,B):(t.state=null,e===mt?i(t,W):F)):B}var L,A=t("../utils/common"),N=t("./trees"),C=t("./adler32"),R=t("./crc32"),P=t("./messages"),O=0,I=1,k=3,D=4,V=5,F=0,G=1,B=-2,W=-3,U=-5,z=-1,j=1,K=2,q=3,Z=4,H=0,$=2,Y=8,X=9,J=15,Q=8,tt=29,et=256,rt=et+1+tt,it=30,nt=19,ot=2*rt+1,at=15,st=3,lt=258,ut=lt+st+1,ct=32,ht=42,ft=69,dt=73,pt=91,gt=103,mt=113,yt=666,vt=1,bt=2,Et=3,wt=4,_t=3,xt=function(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n};L=[new xt(0,0,0,0,d),new xt(4,4,8,4,p),new xt(4,5,16,8,p),new xt(4,6,32,32,p),new xt(4,4,16,16,g),new xt(8,16,32,32,g),new xt(8,16,128,128,g),new xt(8,32,128,256,g),new xt(32,128,258,1024,g),new xt(32,258,258,4096,g)],r.deflateInit=S,r.deflateInit2=x,r.deflateReset=w,r.deflateResetKeep=E,r.deflateSetHeader=_,r.deflate=T,r.deflateEnd=M,r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(t,e,r){"use strict";function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=i},{}],34:[function(t,e,r){"use strict";var i=30,n=12;e.exports=function(t,e){var r,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E,w,_,x,S,T,M,L,A;r=t.state,o=t.next_in,L=t.input,a=o+(t.avail_in-5),s=t.next_out,A=t.output,l=s-(e-t.avail_out),u=s+(t.avail_out-257),c=r.dmax,h=r.wsize,f=r.whave,d=r.wnext,p=r.window,g=r.hold,m=r.bits,y=r.lencode,v=r.distcode,b=(1<<r.lenbits)-1,E=(1<<r.distbits)-1;t:do{m<15&&(g+=L[o++]<<m,m+=8,g+=L[o++]<<m,m+=8),w=y[g&b];e:for(;;){if(_=w>>>24,g>>>=_,m-=_,_=w>>>16&255,0===_)A[s++]=65535&w;else{if(!(16&_)){if(0===(64&_)){w=y[(65535&w)+(g&(1<<_)-1)];continue e}if(32&_){r.mode=n;break t}t.msg="invalid literal/length code",r.mode=i;break t}x=65535&w,_&=15,_&&(m<_&&(g+=L[o++]<<m,m+=8),x+=g&(1<<_)-1,g>>>=_,m-=_),m<15&&(g+=L[o++]<<m,m+=8,g+=L[o++]<<m,m+=8),w=v[g&E];r:for(;;){if(_=w>>>24,g>>>=_,m-=_,_=w>>>16&255,!(16&_)){if(0===(64&_)){w=v[(65535&w)+(g&(1<<_)-1)];continue r}t.msg="invalid distance code",r.mode=i;break t}if(S=65535&w,_&=15,m<_&&(g+=L[o++]<<m,m+=8,m<_&&(g+=L[o++]<<m,m+=8)),S+=g&(1<<_)-1,S>c){t.msg="invalid distance too far back",r.mode=i;break t}if(g>>>=_,m-=_,_=s-l,S>_){if(_=S-_,_>f&&r.sane){t.msg="invalid distance too far back",r.mode=i;break t}if(T=0,M=p,0===d){if(T+=h-_,_<x){x-=_;do A[s++]=p[T++];while(--_);T=s-S,M=A}}else if(d<_){if(T+=h+d-_,_-=d,_<x){x-=_;do A[s++]=p[T++];while(--_);if(T=0,d<x){_=d,x-=_;do A[s++]=p[T++];while(--_);T=s-S,M=A}}}else if(T+=d-_,_<x){x-=_;do A[s++]=p[T++];while(--_);T=s-S,M=A}for(;x>2;)A[s++]=M[T++],A[s++]=M[T++],A[s++]=M[T++],
x-=3;x&&(A[s++]=M[T++],x>1&&(A[s++]=M[T++]))}else{T=s-S;do A[s++]=A[T++],A[s++]=A[T++],A[s++]=A[T++],x-=3;while(x>2);x&&(A[s++]=A[T++],x>1&&(A[s++]=A[T++]))}break}}break}}while(o<a&&s<u);x=m>>3,o-=x,m-=x<<3,g&=(1<<m)-1,t.next_in=o,t.next_out=s,t.avail_in=o<a?5+(a-o):5-(o-a),t.avail_out=s<u?257+(u-s):257-(s-u),r.hold=g,r.bits=m}},{}],35:[function(t,e,r){"use strict";function i(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function n(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=D,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new y.Buf32(pt),e.distcode=e.distdyn=new y.Buf32(gt),e.sane=1,e.back=-1,A):R}function a(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,o(t)):R}function s(t,e){var r,i;return t&&t.state?(i=t.state,e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?R:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,a(t))):R}function l(t,e){var r,i;return t?(i=new n,t.state=i,i.window=null,r=s(t,e),r!==A&&(t.state=null),r):R}function u(t){return l(t,yt)}function c(t){if(vt){var e;for(g=new y.Buf32(512),m=new y.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(w(x,t.lens,0,288,g,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;w(S,t.lens,0,32,m,0,t.work,{bits:5}),vt=!1}t.lencode=g,t.lenbits=9,t.distcode=m,t.distbits=5}function h(t,e,r,i){var n,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new y.Buf8(o.wsize)),i>=o.wsize?(y.arraySet(o.window,e,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(n=o.wsize-o.wnext,n>i&&(n=i),y.arraySet(o.window,e,r-i,n,o.wnext),i-=n,i?(y.arraySet(o.window,e,r-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=n,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=n))),0}function f(t,e){var r,n,o,a,s,l,u,f,d,p,g,m,pt,gt,mt,yt,vt,bt,Et,wt,_t,xt,St,Tt,Mt=0,Lt=new y.Buf8(4),At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return R;r=t.state,r.mode===Z&&(r.mode=H),s=t.next_out,o=t.output,u=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,f=r.hold,d=r.bits,p=l,g=u,xt=A;t:for(;;)switch(r.mode){case D:if(0===r.wrap){r.mode=H;break}for(;d<16;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(2&r.wrap&&35615===f){r.check=0,Lt[0]=255&f,Lt[1]=f>>>8&255,r.check=b(r.check,Lt,2,0),f=0,d=0,r.mode=V;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&f)<<8)+(f>>8))%31){t.msg="incorrect header check",r.mode=ht;break}if((15&f)!==k){t.msg="unknown compression method",r.mode=ht;break}if(f>>>=4,d-=4,_t=(15&f)+8,0===r.wbits)r.wbits=_t;else if(_t>r.wbits){t.msg="invalid window size",r.mode=ht;break}r.dmax=1<<_t,t.adler=r.check=1,r.mode=512&f?K:Z,f=0,d=0;break;case V:for(;d<16;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(r.flags=f,(255&r.flags)!==k){t.msg="unknown compression method",r.mode=ht;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=ht;break}r.head&&(r.head.text=f>>8&1),512&r.flags&&(Lt[0]=255&f,Lt[1]=f>>>8&255,r.check=b(r.check,Lt,2,0)),f=0,d=0,r.mode=F;case F:for(;d<32;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.head&&(r.head.time=f),512&r.flags&&(Lt[0]=255&f,Lt[1]=f>>>8&255,Lt[2]=f>>>16&255,Lt[3]=f>>>24&255,r.check=b(r.check,Lt,4,0)),f=0,d=0,r.mode=G;case G:for(;d<16;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.head&&(r.head.xflags=255&f,r.head.os=f>>8),512&r.flags&&(Lt[0]=255&f,Lt[1]=f>>>8&255,r.check=b(r.check,Lt,2,0)),f=0,d=0,r.mode=B;case B:if(1024&r.flags){for(;d<16;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.length=f,r.head&&(r.head.extra_len=f),512&r.flags&&(Lt[0]=255&f,Lt[1]=f>>>8&255,r.check=b(r.check,Lt,2,0)),f=0,d=0}else r.head&&(r.head.extra=null);r.mode=W;case W:if(1024&r.flags&&(m=r.length,m>l&&(m=l),m&&(r.head&&(_t=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),y.arraySet(r.head.extra,n,a,m,_t)),512&r.flags&&(r.check=b(r.check,n,m,a)),l-=m,a+=m,r.length-=m),r.length))break t;r.length=0,r.mode=U;case U:if(2048&r.flags){if(0===l)break t;m=0;do _t=n[a+m++],r.head&&_t&&r.length<65536&&(r.head.name+=String.fromCharCode(_t));while(_t&&m<l);if(512&r.flags&&(r.check=b(r.check,n,m,a)),l-=m,a+=m,_t)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=z;case z:if(4096&r.flags){if(0===l)break t;m=0;do _t=n[a+m++],r.head&&_t&&r.length<65536&&(r.head.comment+=String.fromCharCode(_t));while(_t&&m<l);if(512&r.flags&&(r.check=b(r.check,n,m,a)),l-=m,a+=m,_t)break t}else r.head&&(r.head.comment=null);r.mode=j;case j:if(512&r.flags){for(;d<16;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(f!==(65535&r.check)){t.msg="header crc mismatch",r.mode=ht;break}f=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Z;break;case K:for(;d<32;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}t.adler=r.check=i(f),f=0,d=0,r.mode=q;case q:if(0===r.havedict)return t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=l,r.hold=f,r.bits=d,C;t.adler=r.check=1,r.mode=Z;case Z:if(e===M||e===L)break t;case H:if(r.last){f>>>=7&d,d-=7&d,r.mode=lt;break}for(;d<3;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}switch(r.last=1&f,f>>>=1,d-=1,3&f){case 0:r.mode=$;break;case 1:if(c(r),r.mode=et,e===L){f>>>=2,d-=2;break t}break;case 2:r.mode=J;break;case 3:t.msg="invalid block type",r.mode=ht}f>>>=2,d-=2;break;case $:for(f>>>=7&d,d-=7&d;d<32;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if((65535&f)!==(f>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ht;break}if(r.length=65535&f,f=0,d=0,r.mode=Y,e===L)break t;case Y:r.mode=X;case X:if(m=r.length){if(m>l&&(m=l),m>u&&(m=u),0===m)break t;y.arraySet(o,n,a,m,s),l-=m,a+=m,u-=m,s+=m,r.length-=m;break}r.mode=Z;break;case J:for(;d<14;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(r.nlen=(31&f)+257,f>>>=5,d-=5,r.ndist=(31&f)+1,f>>>=5,d-=5,r.ncode=(15&f)+4,f>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ht;break}r.have=0,r.mode=Q;case Q:for(;r.have<r.ncode;){for(;d<3;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.lens[At[r.have++]]=7&f,f>>>=3,d-=3}for(;r.have<19;)r.lens[At[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,St={bits:r.lenbits},xt=w(_,r.lens,0,19,r.lencode,0,r.work,St),r.lenbits=St.bits,xt){t.msg="invalid code lengths set",r.mode=ht;break}r.have=0,r.mode=tt;case tt:for(;r.have<r.nlen+r.ndist;){for(;Mt=r.lencode[f&(1<<r.lenbits)-1],mt=Mt>>>24,yt=Mt>>>16&255,vt=65535&Mt,!(mt<=d);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(vt<16)f>>>=mt,d-=mt,r.lens[r.have++]=vt;else{if(16===vt){for(Tt=mt+2;d<Tt;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(f>>>=mt,d-=mt,0===r.have){t.msg="invalid bit length repeat",r.mode=ht;break}_t=r.lens[r.have-1],m=3+(3&f),f>>>=2,d-=2}else if(17===vt){for(Tt=mt+3;d<Tt;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}f>>>=mt,d-=mt,_t=0,m=3+(7&f),f>>>=3,d-=3}else{for(Tt=mt+7;d<Tt;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}f>>>=mt,d-=mt,_t=0,m=11+(127&f),f>>>=7,d-=7}if(r.have+m>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ht;break}for(;m--;)r.lens[r.have++]=_t}}if(r.mode===ht)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=ht;break}if(r.lenbits=9,St={bits:r.lenbits},xt=w(x,r.lens,0,r.nlen,r.lencode,0,r.work,St),r.lenbits=St.bits,xt){t.msg="invalid literal/lengths set",r.mode=ht;break}if(r.distbits=6,r.distcode=r.distdyn,St={bits:r.distbits},xt=w(S,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,St),r.distbits=St.bits,xt){t.msg="invalid distances set",r.mode=ht;break}if(r.mode=et,e===L)break t;case et:r.mode=rt;case rt:if(l>=6&&u>=258){t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=l,r.hold=f,r.bits=d,E(t,g),s=t.next_out,o=t.output,u=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,f=r.hold,d=r.bits,r.mode===Z&&(r.back=-1);break}for(r.back=0;Mt=r.lencode[f&(1<<r.lenbits)-1],mt=Mt>>>24,yt=Mt>>>16&255,vt=65535&Mt,!(mt<=d);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(yt&&0===(240&yt)){for(bt=mt,Et=yt,wt=vt;Mt=r.lencode[wt+((f&(1<<bt+Et)-1)>>bt)],mt=Mt>>>24,yt=Mt>>>16&255,vt=65535&Mt,!(bt+mt<=d);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}f>>>=bt,d-=bt,r.back+=bt}if(f>>>=mt,d-=mt,r.back+=mt,r.length=vt,0===yt){r.mode=st;break}if(32&yt){r.back=-1,r.mode=Z;break}if(64&yt){t.msg="invalid literal/length code",r.mode=ht;break}r.extra=15&yt,r.mode=it;case it:if(r.extra){for(Tt=r.extra;d<Tt;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=nt;case nt:for(;Mt=r.distcode[f&(1<<r.distbits)-1],mt=Mt>>>24,yt=Mt>>>16&255,vt=65535&Mt,!(mt<=d);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(0===(240&yt)){for(bt=mt,Et=yt,wt=vt;Mt=r.distcode[wt+((f&(1<<bt+Et)-1)>>bt)],mt=Mt>>>24,yt=Mt>>>16&255,vt=65535&Mt,!(bt+mt<=d);){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}f>>>=bt,d-=bt,r.back+=bt}if(f>>>=mt,d-=mt,r.back+=mt,64&yt){t.msg="invalid distance code",r.mode=ht;break}r.offset=vt,r.extra=15&yt,r.mode=ot;case ot:if(r.extra){for(Tt=r.extra;d<Tt;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ht;break}r.mode=at;case at:if(0===u)break t;if(m=g-u,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ht;break}m>r.wnext?(m-=r.wnext,pt=r.wsize-m):pt=r.wnext-m,m>r.length&&(m=r.length),gt=r.window}else gt=o,pt=s-r.offset,m=r.length;m>u&&(m=u),u-=m,r.length-=m;do o[s++]=gt[pt++];while(--m);0===r.length&&(r.mode=rt);break;case st:if(0===u)break t;o[s++]=r.length,u--,r.mode=rt;break;case lt:if(r.wrap){for(;d<32;){if(0===l)break t;l--,f|=n[a++]<<d,d+=8}if(g-=u,t.total_out+=g,r.total+=g,g&&(t.adler=r.check=r.flags?b(r.check,o,g,s-g):v(r.check,o,g,s-g)),g=u,(r.flags?f:i(f))!==r.check){t.msg="incorrect data check",r.mode=ht;break}f=0,d=0}r.mode=ut;case ut:if(r.wrap&&r.flags){for(;d<32;){if(0===l)break t;l--,f+=n[a++]<<d,d+=8}if(f!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=ht;break}f=0,d=0}r.mode=ct;case ct:xt=N;break t;case ht:xt=P;break t;case ft:return O;case dt:default:return R}return t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=l,r.hold=f,r.bits=d,(r.wsize||g!==t.avail_out&&r.mode<ht&&(r.mode<lt||e!==T))&&h(t,t.output,t.next_out,g-t.avail_out)?(r.mode=ft,O):(p-=t.avail_in,g-=t.avail_out,t.total_in+=p,t.total_out+=g,r.total+=g,r.wrap&&g&&(t.adler=r.check=r.flags?b(r.check,o,g,t.next_out-g):v(r.check,o,g,t.next_out-g)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Z?128:0)+(r.mode===et||r.mode===Y?256:0),(0===p&&0===g||e===T)&&xt===A&&(xt=I),xt)}function d(t){if(!t||!t.state)return R;var e=t.state;return e.window&&(e.window=null),t.state=null,A}function p(t,e){var r;return t&&t.state?(r=t.state,0===(2&r.wrap)?R:(r.head=e,e.done=!1,A)):R}var g,m,y=t("../utils/common"),v=t("./adler32"),b=t("./crc32"),E=t("./inffast"),w=t("./inftrees"),_=0,x=1,S=2,T=4,M=5,L=6,A=0,N=1,C=2,R=-2,P=-3,O=-4,I=-5,k=8,D=1,V=2,F=3,G=4,B=5,W=6,U=7,z=8,j=9,K=10,q=11,Z=12,H=13,$=14,Y=15,X=16,J=17,Q=18,tt=19,et=20,rt=21,it=22,nt=23,ot=24,at=25,st=26,lt=27,ut=28,ct=29,ht=30,ft=31,dt=32,pt=852,gt=592,mt=15,yt=mt,vt=!0;r.inflateReset=a,r.inflateReset2=s,r.inflateResetKeep=o,r.inflateInit=u,r.inflateInit2=l,r.inflate=f,r.inflateEnd=d,r.inflateGetHeader=p,r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(t,e,r){"use strict";var i=t("../utils/common"),n=15,o=852,a=592,s=0,l=1,u=2,c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,r,p,g,m,y,v){var b,E,w,_,x,S,T,M,L,A=v.bits,N=0,C=0,R=0,P=0,O=0,I=0,k=0,D=0,V=0,F=0,G=null,B=0,W=new i.Buf16(n+1),U=new i.Buf16(n+1),z=null,j=0;for(N=0;N<=n;N++)W[N]=0;for(C=0;C<p;C++)W[e[r+C]]++;for(O=A,P=n;P>=1&&0===W[P];P--);if(O>P&&(O=P),0===P)return g[m++]=20971520,g[m++]=20971520,v.bits=1,0;for(R=1;R<P&&0===W[R];R++);for(O<R&&(O=R),D=1,N=1;N<=n;N++)if(D<<=1,D-=W[N],D<0)return-1;if(D>0&&(t===s||1!==P))return-1;for(U[1]=0,N=1;N<n;N++)U[N+1]=U[N]+W[N];for(C=0;C<p;C++)0!==e[r+C]&&(y[U[e[r+C]]++]=C);if(t===s?(G=z=y,S=19):t===l?(G=c,B-=257,z=h,j-=257,S=256):(G=f,z=d,S=-1),F=0,C=0,N=R,x=m,I=O,k=0,w=-1,V=1<<O,_=V-1,t===l&&V>o||t===u&&V>a)return 1;for(var K=0;;){K++,T=N-k,y[C]<S?(M=0,L=y[C]):y[C]>S?(M=z[j+y[C]],L=G[B+y[C]]):(M=96,L=0),b=1<<N-k,E=1<<I,R=E;do E-=b,g[x+(F>>k)+E]=T<<24|M<<16|L|0;while(0!==E);for(b=1<<N-1;F&b;)b>>=1;if(0!==b?(F&=b-1,F+=b):F=0,C++,0===--W[N]){if(N===P)break;N=e[r+y[C]]}if(N>O&&(F&_)!==w){for(0===k&&(k=O),x+=R,I=N-k,D=1<<I;I+k<P&&(D-=W[I+k],!(D<=0));)I++,D<<=1;if(V+=1<<I,t===l&&V>o||t===u&&V>a)return 1;w=F&_,g[w]=O<<24|I<<16|x-m|0}}return 0!==F&&(g[x+F]=N-k<<24|64<<16|0),v.bits=O,0}},{"../utils/common":27}],37:[function(t,e,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(t,e,r){"use strict";function i(t){for(var e=t.length;--e>=0;)t[e]=0}function n(t){return t<256?at[t]:at[256+(t>>>7)]}function o(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function a(t,e,r){t.bi_valid>Z-r?(t.bi_buf|=e<<t.bi_valid&65535,o(t,t.bi_buf),t.bi_buf=e>>Z-t.bi_valid,t.bi_valid+=r-Z):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function s(t,e,r){a(t,r[2*e],r[2*e+1])}function l(t,e){var r=0;do r|=1&t,t>>>=1,r<<=1;while(--e>0);return r>>>1}function u(t){16===t.bi_valid?(o(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function c(t,e){var r,i,n,o,a,s,l=e.dyn_tree,u=e.max_code,c=e.stat_desc.static_tree,h=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,d=e.stat_desc.extra_base,p=e.stat_desc.max_length,g=0;for(o=0;o<=q;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<K;r++)i=t.heap[r],o=l[2*l[2*i+1]+1]+1,o>p&&(o=p,g++),l[2*i+1]=o,i>u||(t.bl_count[o]++,a=0,i>=d&&(a=f[i-d]),s=l[2*i],t.opt_len+=s*(o+a),h&&(t.static_len+=s*(c[2*i+1]+a)));if(0!==g){do{for(o=p-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[p]--,g-=2}while(g>0);for(o=p;0!==o;o--)for(i=t.bl_count[o];0!==i;)n=t.heap[--r],n>u||(l[2*n+1]!==o&&(t.opt_len+=(o-l[2*n+1])*l[2*n],l[2*n+1]=o),i--)}}function h(t,e,r){var i,n,o=new Array(q+1),a=0;for(i=1;i<=q;i++)o[i]=a=a+r[i-1]<<1;for(n=0;n<=e;n++){var s=t[2*n+1];0!==s&&(t[2*n]=l(o[s]++,s))}}function f(){var t,e,r,i,n,o=new Array(q+1);for(r=0,i=0;i<B-1;i++)for(lt[i]=r,t=0;t<1<<Q[i];t++)st[r++]=i;for(st[r-1]=i,n=0,i=0;i<16;i++)for(ut[i]=n,t=0;t<1<<tt[i];t++)at[n++]=i;for(n>>=7;i<z;i++)for(ut[i]=n<<7,t=0;t<1<<tt[i]-7;t++)at[256+n++]=i;for(e=0;e<=q;e++)o[e]=0;for(t=0;t<=143;)nt[2*t+1]=8,t++,o[8]++;for(;t<=255;)nt[2*t+1]=9,t++,o[9]++;for(;t<=279;)nt[2*t+1]=7,t++,o[7]++;for(;t<=287;)nt[2*t+1]=8,t++,o[8]++;for(h(nt,U+1,o),t=0;t<z;t++)ot[2*t+1]=5,ot[2*t]=l(t,5);ct=new dt(nt,Q,W+1,U,q),ht=new dt(ot,tt,0,z,q),ft=new dt(new Array(0),et,0,j,H)}function d(t){var e;for(e=0;e<U;e++)t.dyn_ltree[2*e]=0;for(e=0;e<z;e++)t.dyn_dtree[2*e]=0;for(e=0;e<j;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*$]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function p(t){t.bi_valid>8?o(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function g(t,e,r,i){p(t),i&&(o(t,r),o(t,~r)),C.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function m(t,e,r,i){var n=2*e,o=2*r;return t[n]<t[o]||t[n]===t[o]&&i[e]<=i[r]}function y(t,e,r){for(var i=t.heap[r],n=r<<1;n<=t.heap_len&&(n<t.heap_len&&m(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!m(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i}function v(t,e,r){var i,o,l,u,c=0;if(0!==t.last_lit)do i=t.pending_buf[t.d_buf+2*c]<<8|t.pending_buf[t.d_buf+2*c+1],o=t.pending_buf[t.l_buf+c],c++,0===i?s(t,o,e):(l=st[o],s(t,l+W+1,e),u=Q[l],0!==u&&(o-=lt[l],a(t,o,u)),i--,l=n(i),s(t,l,r),u=tt[l],0!==u&&(i-=ut[l],a(t,i,u)));while(c<t.last_lit);s(t,$,e)}function b(t,e){var r,i,n,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=K,r=0;r<l;r++)0!==o[2*r]?(t.heap[++t.heap_len]=u=r,t.depth[r]=0):o[2*r+1]=0;for(;t.heap_len<2;)n=t.heap[++t.heap_len]=u<2?++u:0,o[2*n]=1,t.depth[n]=0,t.opt_len--,s&&(t.static_len-=a[2*n+1]);for(e.max_code=u,r=t.heap_len>>1;r>=1;r--)y(t,o,r);n=l;do r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],y(t,o,1),i=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=i,o[2*n]=o[2*r]+o[2*i],t.depth[n]=(t.depth[r]>=t.depth[i]?t.depth[r]:t.depth[i])+1,o[2*r+1]=o[2*i+1]=n,t.heap[1]=n++,y(t,o,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],c(t,e),h(o,u,t.bl_count)}function E(t,e,r){var i,n,o=-1,a=e[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),e[2*(r+1)+1]=65535,i=0;i<=r;i++)n=a,a=e[2*(i+1)+1],++s<l&&n===a||(s<u?t.bl_tree[2*n]+=s:0!==n?(n!==o&&t.bl_tree[2*n]++,t.bl_tree[2*Y]++):s<=10?t.bl_tree[2*X]++:t.bl_tree[2*J]++,s=0,o=n,0===a?(l=138,u=3):n===a?(l=6,u=3):(l=7,u=4))}function w(t,e,r){var i,n,o=-1,l=e[1],u=0,c=7,h=4;for(0===l&&(c=138,h=3),i=0;i<=r;i++)if(n=l,l=e[2*(i+1)+1],!(++u<c&&n===l)){if(u<h){do s(t,n,t.bl_tree);while(0!==--u)}else 0!==n?(n!==o&&(s(t,n,t.bl_tree),u--),s(t,Y,t.bl_tree),a(t,u-3,2)):u<=10?(s(t,X,t.bl_tree),a(t,u-3,3)):(s(t,J,t.bl_tree),a(t,u-11,7));u=0,o=n,0===l?(c=138,h=3):n===l?(c=6,h=3):(c=7,h=4)}}function _(t){var e;for(E(t,t.dyn_ltree,t.l_desc.max_code),E(t,t.dyn_dtree,t.d_desc.max_code),b(t,t.bl_desc),e=j-1;e>=3&&0===t.bl_tree[2*rt[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function x(t,e,r,i){var n;for(a(t,e-257,5),a(t,r-1,5),a(t,i-4,4),n=0;n<i;n++)a(t,t.bl_tree[2*rt[n]+1],3);w(t,t.dyn_ltree,e-1),w(t,t.dyn_dtree,r-1)}function S(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return P;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return O;for(e=32;e<W;e++)if(0!==t.dyn_ltree[2*e])return O;return P}function T(t){gt||(f(),gt=!0),t.l_desc=new pt(t.dyn_ltree,ct),t.d_desc=new pt(t.dyn_dtree,ht),t.bl_desc=new pt(t.bl_tree,ft),t.bi_buf=0,t.bi_valid=0,d(t)}function M(t,e,r,i){a(t,(k<<1)+(i?1:0),3),g(t,e,r,!0)}function L(t){a(t,D<<1,3),s(t,$,nt),u(t)}function A(t,e,r,i){var n,o,s=0;t.level>0?(t.strm.data_type===I&&(t.strm.data_type=S(t)),b(t,t.l_desc),b(t,t.d_desc),s=_(t),n=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=n&&(n=o)):n=o=r+5,r+4<=n&&e!==-1?M(t,e,r,i):t.strategy===R||o===n?(a(t,(D<<1)+(i?1:0),3),v(t,nt,ot)):(a(t,(V<<1)+(i?1:0),3),x(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),v(t,t.dyn_ltree,t.dyn_dtree)),d(t),i&&p(t)}function N(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(st[r]+W+1)]++,t.dyn_dtree[2*n(e)]++),t.last_lit===t.lit_bufsize-1}var C=t("../utils/common"),R=4,P=0,O=1,I=2,k=0,D=1,V=2,F=3,G=258,B=29,W=256,U=W+1+B,z=30,j=19,K=2*U+1,q=15,Z=16,H=7,$=256,Y=16,X=17,J=18,Q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],tt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],et=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],it=512,nt=new Array(2*(U+2));i(nt);var ot=new Array(2*z);i(ot);var at=new Array(it);i(at);var st=new Array(G-F+1);i(st);var lt=new Array(B);i(lt);var ut=new Array(z);i(ut);var ct,ht,ft,dt=function(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length},pt=function(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e},gt=!1;r._tr_init=T,r._tr_stored_block=M,r._tr_flush_block=A,r._tr_tally=N,r._tr_align=L},{"../utils/common":27}],39:[function(t,e,r){"use strict";function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=i},{}]},{},[9])(9)}),define("worldwind/formats/kml/KmlFileCache",[],function(){"use strict";var t=function(){this._rootFile=null,this._map={}};return t.prototype.retrieve=function(t){if(0==t.indexOf("#")||null==t||0!=t.indexOf("http"))return this._rootFile;var e=t;return t.indexOf("#")!=-1&&(e=t.substr(0,t.indexOf("#")-1)),this._map[e]?this._map[e]:null},t.prototype.add=function(t,e){this._rootFile?this._map[t]=e:this._rootFile=e},t}),define("worldwind/formats/kml/styles/KmlStyleSelector",["./../KmlObject"],function(t){"use strict";var e=function(e){t.call(this,e)};return e.prototype=Object.create(t.prototype),e.prototype.getTagNames=function(){return["Style","StyleMap"]},e}),define("worldwind/formats/kml/styles/KmlPolyStyle",["../../../util/Color","./KmlColorStyle","./../KmlElements","../util/NodeTransformers"],function(t,e,r,i){"use strict";var n=function(t){e.call(this,t)};return n.prototype=Object.create(e.prototype),Object.defineProperties(n.prototype,{kmlFill:{get:function(){return this._factory.specific(this,{name:"fill",transformer:i.boolean})}},kmlOutline:{get:function(){return this._factory.specific(this,{name:"outline",transformer:i.boolean})}}}),n.update=function(e,r){e=e||{};var i=r||{};return i._drawInterior=e.kmlFill||!0,i._drawOutline=e.kmlOutline||!1,i._outlineColor=r._outlineColor||t.WHITE,i._interiorColor=e.kmlColor&&t.colorFromKmlHex(e.kmlColor)||t.WHITE,i._colorMode=e.kmlColorMode||"normal",i},n.prototype.getTagNames=function(){return["PolyStyle"]},r.addKey(n.prototype.getTagNames()[0],n),n}),define("worldwind/formats/kml/KmlLink",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t),this.onChangeListeners=[]};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlHref:{get:function(){return this._factory.specific(this,{name:"href",transformer:r.string})}},kmlRefreshMode:{get:function(){return this._factory.specific(this,{name:"refreshMode",transformer:r.string})}},kmlRefreshInterval:{get:function(){return this._factory.specific(this,{name:"refreshInterval",transformer:r.number})}},kmlViewRefreshMode:{get:function(){return this._factory.specific(this,{name:"viewRefreshMode",transformer:r.string})}},kmlViewRefreshTime:{get:function(){return this._factory.specific(this,{name:"viewRefreshTime",transformer:r.number})}},kmlViewBoundScale:{get:function(){return this._factory.specific(this,{name:"viewBoundScale",transformer:r.number})}},kmlViewFormat:{get:function(){return this._factory.specific(this,{name:"viewFormat",transformer:r.string})}},kmlHttpQuery:{get:function(){return this._factory.specific(this,{name:"httpQuery",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["Link"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/KmlIcon",["./KmlLink","./KmlElements","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(e){t.call(this,e)};return i.prototype=Object.create(t.prototype),Object.defineProperties(i.prototype,{kmlX:{get:function(){return this._factory.specific(this,{name:"gx:x",transformer:r.number})}},kmlY:{get:function(){return this._factory.specific(this,{name:"gx:y",transformer:r.number})}},kmlW:{get:function(){return this._factory.specific(this,{name:"gx:w",transformer:r.number})}},kmlH:{get:function(){return this._factory.specific(this,{name:"gx:h",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["Icon"]},e.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/styles/KmlIconStyle",["./KmlColorStyle","./../KmlElements","../KmlIcon","../util/NodeTransformers"],function(t,e,r,i){"use strict";var n=function(e){t.call(this,e)};return n.prototype=Object.create(t.prototype),Object.defineProperties(n.prototype,{kmlScale:{get:function(){return this._factory.specific(this,{name:"scale",transformer:i.number})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:i.number})}},kmlIcon:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}},kmlHotSpotX:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:i.attribute("x")})}},kmlHotSpotY:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:i.attribute("y")})}},kmlHotSpotXUnits:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:i.attribute("xunits")})}},kmlHotSpotYUnits:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:i.attribute("yunits")})}}}),n.update=function(t,e){t=t||{};var r=e||{};return r._imageScale=t.kmlScale||1,r._imageSource=t.kmlIcon&&t.kmlIcon.kmlHref||null,r},n.prototype.getTagNames=function(){return["IconStyle"]},e.addKey(n.prototype.getTagNames()[0],n),n}),define("worldwind/formats/kml/styles/KmlLabelStyle",["./KmlColorStyle","../KmlElements","../util/NodeTransformers"],function(t,e,r){"use strict";var i=function(e){t.call(this,e)};return i.prototype=Object.create(t.prototype),Object.defineProperties(i.prototype,{kmlScale:{get:function(){return this._factory.specific(this,{name:"scale",transformer:r.number})}}}),i.update=function(){},i.prototype.getTagNames=function(){return["LabelStyle"]},e.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/styles/KmlLineStyle",["../../../util/Color","./KmlColorStyle","./../KmlElements","../util/NodeTransformers"],function(t,e,r,i){"use strict";var n=function(t){e.call(this,t)};return n.prototype=Object.create(e.prototype),Object.defineProperties(n.prototype,{kmlWidth:{get:function(){return this._factory.specific(this,{name:"width",transformer:i.number})}},kmlOuterColor:{get:function(){return this._factory.specific(this,{name:"gx:outerColor",transformer:i.string})}},kmlOuterWidth:{get:function(){return this._factory.specific(this,{name:"gx:outerWidth",transformer:i.number})}},kmlPhysicalWidth:{get:function(){return this._factory.specific(this,{name:"gx:physicalWidth",transformer:i.number})}},kmlLabelVisibility:{get:function(){return this._factory.specific(this,{name:"gx:labelVisibility",transformer:i.boolean})}}}),n.update=function(e,r){var i=r||{};return e=e||{},i._outlineColor=e.kmlColor&&t.colorFromKmlHex(e.kmlColor)||t.WHITE,i._outlineWidth=e.kmlWidth||10,i},n.prototype.getTagNames=function(){return["LineStyle"]},r.addKey(n.prototype.getTagNames()[0],n),n}),define("worldwind/formats/kml/styles/KmlListStyle",["../util/ItemIcon","../KmlElements","./KmlSubStyle","../util/NodeTransformers"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,t)};return n.prototype=Object.create(r.prototype),Object.defineProperties(n.prototype,{kmlBgColor:{get:function(){return this._factory.specific(this,{name:"bgColor",transformer:i.string})}},kmlListItemType:{get:function(){return this._factory.specific(this,{name:"listItemType",transformer:i.string})}},kmlItemIcon:{get:function(){return this._factory.any(this,{name:t.prototype.getTagNames()})}}}),n.update=function(t){},n.prototype.getTagNames=function(){return["ListStyle"]},e.addKey(n.prototype.getTagNames()[0],n),n}),define("worldwind/formats/kml/styles/KmlStyle",["../../../util/Color","../../../util/Font","./KmlStyleSelector","./../KmlElements","./KmlPolyStyle","./KmlIconStyle","./KmlLabelStyle","./KmlLineStyle","./KmlListStyle","./KmlBalloonStyle","../../../util/Offset","../../../util/Promise","../../../shapes/ShapeAttributes","../../../shapes/TextAttributes"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d){"use strict";var p=function(t){r.call(this,t)};return p.prototype=Object.create(r.prototype),Object.defineProperties(p.prototype,{kmlIconStyle:{get:function(){return this._factory.any(this,{name:o.prototype.getTagNames()})}},kmlLabelStyle:{get:function(){return this._factory.any(this,{name:a.prototype.getTagNames()})}},kmlLineStyle:{get:function(){return this._factory.any(this,{name:s.prototype.getTagNames()})}},kmlPolyStyle:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}},kmlBalloonStyle:{get:function(){return this._factory.any(this,{name:u.prototype.getTagNames()})}},kmlListStyle:{get:function(){return this._factory.any(this,{name:l.prototype.getTagNames()})}}}),p.prototype.generate=function(t){t=t||{};var e=this||{};return e.kmlIconStyle&&o.update(e.kmlIconStyle,t),e.kmlListStyle&&l.update(e.kmlListStyle,t),e.kmlBalloonStyle&&u.update(e.kmlBalloonStyle,t),e.kmlLabelStyle&&a.update(e.kmlLabelStyle,t),e.kmlPolyStyle&&n.update(e.kmlPolyStyle,t),e.kmlLineStyle&&s.update(e.kmlLineStyle,t),t},p.prototype.getStyle=function(){var t=this;return new h(function(e){window.setTimeout(function(){e(t)},0)})},p.prototype.getTagNames=function(){return["Style"]},i.addKey(p.prototype.getTagNames()[0],p),p.placemarkAttributes=function(e){return e=e||{},e._imageColor=e._imageColor||new t(1,1,1,1),e._imageOffset=e._imageOffset||new c(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),e._imageScale=e._imageScale||1,e._imageSource=e._imageSource||null,e._depthTest=e._depthTest||!0,e._labelAttributes=e._labelAttributes||new d(p.textAttributes()),e._drawLeaderLine=e._drawLeaderLine||!1,e._leaderLineAttributes=e._leaderLineAttributes||new f(p.shapeAttributes()),e},p.textAttributes=function(r){return r=r||{},r._color=r._color||new t(1,1,1,1),r._font=r._font||new e(14),r._offset=r._offset||new c(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0),r._scale=r._scale||1,r._depthTest=r._depthTest||!1,r},p.shapeAttributes=function(e){return e=e||{},e._drawInterior=e._drawInterior||!0,e._drawOutline=e._drawOutline||!0,e._enableLighting=e._enableLighting||!1,e._interiorColor=e._interiorColor||t.WHITE,e._outlineColor=e._outlineColor||t.RED,e._outlineWidth=e._outlineWidth||1,e._outlineStippleFactor=e._outlineStippleFactor||0,e._outlineStipplePattern=e._outlineStipplePattern||61680,e._imageSource=e._imageSource||null,e._depthTest=e._depthTest||!0,e._drawVerticals=e._drawVerticals||!1,e._applyLighting=e._applyLighting||!1,e},p}),define("worldwind/formats/kml/util/StyleResolver",["../KmlFile","../../../util/Logger"],function(t,e){"use strict";var r=function(t){this._fileCache=t};return r.prototype.handleRemoteStyle=function(t,r,i,n,o){t?this.handleStyleUrl(t,i,n,o):r?this.handleStyleSelector(r,i,n):e.logMessage(e.LEVEL_WARNING,"StyleResolver","handleRemoteStyle","Style was null.")},r.prototype.handleStyleUrl=function(t,e,r,i){var n=this;i=this.handlePromiseOfFile(t,i),i.then(function(r){r.resolveStyle(t).then(function(t){t.isMap?t.resolve(e,n):e({normal:t,highlight:null})})})},r.prototype.handlePromiseOfFile=function(t,e){return e||(e=this._fileCache.retrieve(t),e||(e=new WorldWind.KmlFile({url:t}),this._fileCache.add(e))),e},r.prototype.handleStyleSelector=function(t,e,r){t.isMap?t.resolve(e,this):window.setTimeout(function(){e({normal:t,highlight:null})},0)},r}),define("worldwind/formats/kml/util/Pair",["./../KmlElements","../KmlObject","../styles/KmlStyleSelector","./NodeTransformers","../../../util/Promise","../util/StyleResolver"],function(t,e,r,i,n,o){"use strict";var a=function(t){e.call(this,t)};return a.prototype=Object.create(e.prototype),Object.defineProperties(a.prototype,{kmlKey:{get:function(){return this._factory.specific(this,{name:"key",transformer:i.string})}},kmlStyleUrl:{get:function(){
return this._factory.specific(this,{name:"styleUrl",transformer:i.string})}},kmlStyleSelector:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}}}),a.prototype.getTagNames=function(){return["Pair"]},a.prototype.getStyle=function(t){var e=this;return new n(function(r,i){window.setTimeout(function(){t.handleRemoteStyle(e.kmlStyleUrl,e.kmlStyleSelector,r,i)},0)})},t.addKey(a.prototype.getTagNames()[0],a),a}),define("worldwind/formats/kml/styles/KmlStyleMap",["../KmlElements","./KmlSubStyle","../util/Pair","../../../util/Promise"],function(t,e,r,i){"use strict";var n=function(t){e.call(this,t)};return n.prototype=Object.create(e.prototype),Object.defineProperties(n.prototype,{kmlPairs:{get:function(){return this._factory.all(this)}},isMap:{get:function(){return!0}}}),n.prototype.resolve=function(t,e){var r=this,n={},o=[],a=r.kmlPairs;a.forEach(function(t){var r=t.kmlKey,i=t.getStyle(e);o.push(i),i.then(function(t){n[r]=t.normal})});var s=i.all(o);s.then(function(){n.normal||(n.normal=null),n.highlight||(n.highlight=null),t(n)})},n.prototype.getTagNames=function(){return["StyleMap"]},t.addKey(n.prototype.getTagNames()[0],n),n}),define("worldwind/formats/kml/KmlTimeSpan",["./KmlElements","./KmlTimePrimitive","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){t.isTimeSpan=!0,e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlBegin:{get:function(){return this._factory.specific(this,{name:"begin",transformer:r.date})}},kmlEnd:{get:function(){return this._factory.specific(this,{name:"end",transformer:r.date})}}}),i.prototype.getTagNames=function(){return["TimeSpan"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/KmlTimeStamp",["./KmlElements","./KmlTimePrimitive","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){t.isTimeStamp=!0,e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlWhen:{get:function(){return this._factory.specific(this,{name:"when",transformer:r.date})}}}),i.prototype.getTagNames=function(){return["TimeStamp"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/util/RefreshListener",[],function(){var t=function(){this.currentActiveEvents=[]};return t.prototype.addEvent=function(t){var e=this;setTimeout(function(){e.currentActiveEvents.push(t)},t.time)},t.prototype.getActiveEvents=function(){var t=this.currentActiveEvents.slice();return this.currentActiveEvents=[],t},t.Event=function(t,e,r){this.type=t,this.payload=r,this.time=e},t}),define("worldwind/formats/kml/util/RemoteFile",["../../../error/ArgumentError","../../../util/Logger","../../../util/Promise"],function(t,e,r){"use strict";var i=function(r){if(!r.ajax&&!r.zip)throw new t(e.logMessage(e.LEVEL_SEVERE,"RemoteDocument","constructor","Invalid option for retrieval specified. Use either ajax or zip option."));this.options=r};return i.prototype.get=function(){var r=this.options;if(r.ajax)return this.ajax(r.url,r);if(r.zip)return r.responseType=r.responseType||"arraybuffer",this.ajax(r.url,r);throw new t(e.logMessage(e.LEVEL_SEVERE,"RemoteDocument","constructor","Invalid option for retrieval specified. Use either ajax or zip option."))},i.prototype.ajax=function(t,i){return new r(function(r,n){var o=new XMLHttpRequest;o.open("GET",t,!0),i.responseType&&(o.responseType=i.responseType),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var n;n="arraybuffer"==i.responseType?this.response:this.responseText,r({text:n,headers:o.getAllResponseHeaders()})}else e.log(e.LEVEL_WARNING,"KmlFile retrieval failed ("+o.statusText+"): "+t)},o.onerror=function(){e.log(e.LEVEL_WARNING,"Remote file retrieval failed: "+t),n()}.bind(this),o.ontimeout=function(){e.log(e.LEVEL_WARNING,"Remote file retrieval timed out: "+t),n()}.bind(this),o.send(null)})},i}),define("worldwind/util/XmlDocument",["../error/ArgumentError","../util/Logger"],function(t,e){var r=function(t){this._document=t};return r.prototype.dom=function(){if(DOMParser){var r=new DOMParser,i=r.parseFromString(this._document,"text/xml");if(i.getElementsByTagName("parsererror").length||!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"XmlDocument","dom","Invalid XML document. "+i.getElementsByTagName("parsererror")[0].innerHTML));return i}var n=new ActiveXObject("Microsoft.XMLDOM");return n.async=!1,n.loadXML(text),n},r.isValid=function(t){try{return new r(t).dom(),!0}catch(t){return!1}},r}),define("worldwind/formats/kml/KmlFile",["../../error/ArgumentError","../../util/jszip","./KmlElements","./KmlFileCache","./KmlObject","./styles/KmlStyle","./styles/KmlStyleMap","./KmlTimeSpan","./KmlTimeStamp","../../util/Logger","../../util/Promise","./util/RefreshListener","./util/RemoteFile","./util/StyleResolver","../../util/XmlDocument","../../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g){"use strict";var m=function(r,o){var a=this;if(!r)throw new t(u.logMessage(u.LEVEL_SEVERE,"KmlFile","constructor","invalidDocumentPassed"));this._controls=o||null,this._fileCache=new i,this._styleResolver=new d(this._fileCache),this._listener=new h,this._headers=null;var s;return s=new c(function(t){var i=a.requestRemote(r);i.then(function(i){var s=null,l=i.text;if(a._headers=i.headers,a.hasExtension("kmz",r)){var u=new e;u.load(l);for(var c in u.files){var h=u.files[c];null==s&&a.hasExtension("kml",h.name)&&(s=h.asText())}}else s=l;a._document=new p(s).dom(),n.call(a,{objectNode:a._document.documentElement,controls:o}),window.setTimeout(function(){t(a)},0)})}),this._fileCache.add(r,s),s};return m.prototype=Object.create(n.prototype),Object.defineProperties(m.prototype,{shapes:{get:function(){return this._factory.all(this)}}}),m.prototype.render=function(t,e){var r=this;e=e||{},this.shapes.forEach(function(i){i.render(t,{lastStyle:e.lastStyle||null,lastVisibility:e.lastVisibility||null,currentTimeInterval:e.currentTimeInterval||null,regionInvisible:e.regionInvisible||null,fileCache:r._fileCache,styleResolver:r._styleResolver,listener:r._listener,activeEvents:r._listener.getActiveEvents()})})},m.prototype.hasExtension=function(t,e){return g.endsWith(e,"."+t)},m.prototype.requestRemote=function(t){var e={};return e.url=t,this.hasExtension("kmz",t)?e.zip=!0:e.ajax=!0,new f(e).get()},m.prototype.resolveStyle=function(t){var e=this,r=t.substring(t.indexOf("#")+1,t.length);return new c(function(t,i){var n;n=e._document.querySelector?e._document.querySelector("*[id='"+r+"']"):e._document.getElementById(r),n&&null!=n||i(),n.nodeName==o.prototype.getTagNames()[0]?t(new o({objectNode:n},{styleResolver:e._styleResolver})):n.nodeName==a.prototype.getTagNames()[0]?t(new a({objectNode:n},{styleResolver:e._styleResolver})):u.logMessage(u.LEVEL_WARNING,"KmlFile","resolveStyle","Style must contain either Style node or StyleMap node.")})},m.prototype.getExpired=function(){var t=new Date(this._headers.getRequestHeader("Expires")),e=new Date;return e.getTime-t.getTime()},m}),define("worldwind/formats/kml/KmlLatLonAltBox",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlNorth:{get:function(){return this._factory.specific(this,{name:"north",transformer:r.number})}},kmlSouth:{get:function(){return this._factory.specific(this,{name:"south",transformer:r.number})}},kmlEast:{get:function(){return this._factory.specific(this,{name:"east",transformer:r.number})}},kmlWest:{get:function(){return this._factory.specific(this,{name:"west",transformer:r.number})}},kmlMinAltitude:{get:function(){return this._factory.specific(this,{name:"minAltitude",transformer:r.number})}},kmlMaxAltitude:{get:function(){return this._factory.specific(this,{name:"maxAltitude",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["LatLonAltBox"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/KmlLod",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlMinLodPixels:{get:function(){return this._factory.specific(this,{name:"minLodPixels",transformer:r.number})}},kmlMaxLodPixels:{get:function(){return this._factory.specific(this,{name:"maxLodPixels",transformer:r.number})}},kmlMinFadeExtent:{get:function(){return this._factory.specific(this,{name:"minFadeExtent",transformer:r.number})}},kmlMaxFadeExtent:{get:function(){return this._factory.specific(this,{name:"maxFadeExtent",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["Lod"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/KmlRegion",["../../geom/BoundingBox","../../util/Color","./KmlElements","./KmlLatLonAltBox","./KmlLod","./KmlObject","./styles/KmlStyle","./util/NodeTransformers","../../geom/Sector"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(t){o.call(this,t)};return u.prototype=Object.create(o.prototype),Object.defineProperties(u.prototype,{kmlLatLonAltBox:{get:function(){return this._factory.specific(this,{name:i.prototype.getTagNames(),transformer:s.kmlObject})}},kmlLod:{get:function(){return this._factory.specific(this,{name:n.prototype.getTagNames(),transformer:s.kmlObject})}}}),u.prototype.intersectsVisible=function(e){var r=this.kmlLatLonAltBox,i=new t;return i.setToSector(new l(r.kmlSouth,r.kmlNorth,r.kmlWest,r.kmlEast),e.globe,r.kmlMinAltitude,r.kmlMaxAltitude),i.intersectsFrustum(e.navigatorState.frustumInModelCoordinates)&&(!r.kmlMinAltitude||e.eyePosition.altitude>r.kmlMinAltitude)&&(!r.kmlMaxAltitude||e.eyePosition.altitude<r.kmlMaxAltitude)},u.prototype.getTagNames=function(){return["Region"]},r.addKey(u.prototype.getTagNames()[0],u),u}),define("worldwind/formats/kml/features/KmlFeature",["./../KmlObject","../KmlAbstractView","../KmlFile","../styles/KmlStyleMap","../styles/KmlStyleSelector","../KmlRegion","../KmlTimePrimitive","../util/NodeTransformers","../../../util/Promise"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(e){this.isFeature=e.isFeature=!0,t.call(this,e),this._pStyle=null,this.controlledVisibility=null};return u.prototype=Object.create(t.prototype),Object.defineProperties(u.prototype,{style:{get:function(){return this._pStyle}},kmlName:{get:function(){return this._factory.specific(this,{name:"name",transformer:s.string})}},kmlVisibility:{get:function(){return this._factory.specific(this,{name:"visibility",transformer:s.boolean})}},kmlOpen:{get:function(){return this._factory.specific(this,{name:"open",transformer:s.boolean})}},kmlAddress:{get:function(){return this._factory.specific(this,{name:"address",transformer:s.string})}},kmlPhoneNumber:{get:function(){return this._factory.specific(this,{name:"phoneNumber",transformer:s.string})}},kmlDescription:{get:function(){return this._factory.specific(this,{name:"description",transformer:s.string})}},kmlStyleUrl:{get:function(){return this._factory.specific(this,{name:"styleUrl",transformer:s.string})}},kmlSnippet:{get:function(){return this._factory.specific(this,{name:"Snippet",transformer:s.string})}},kmlAbstractView:{get:function(){return this._factory.any(this,{name:e.prototype.getTagNames()})}},kmlTimePrimitive:{get:function(){return this._factory.any(this,{name:a.prototype.getTagNames()})}},kmlStyleSelector:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}},kmlRegion:{get:function(){return this._factory.any(this,{name:o.prototype.getTagNames()})}}}),u.prototype.render=function(e,r){t.prototype.render.call(this,e,r),this.solveStyle(e,r),this.solveVisibility(e,r)},u.prototype.solveStyle=function(t,e){this.getStyle(t,e),null!=this.style&&(e.lastStyle=this.style)},u.prototype.solveRegion=function(t){return!this.kmlRegion||this.kmlRegion.intersectsVisible(t)},u.prototype.solveVisibility=function(t,e){var r=e.lastVisibility!==!1,i=this.solveTimeVisibility(t),n=this.solveRegion(t),o=this.kmlVisibility!==!1,a=this.controlledVisibility!==!1;this.enabled=r&&i&&n&&o&&a,e.lastVisibility=this.enabled,this._renderable&&(this._renderable.enabled=this.enabled)},u.prototype.solveTimeVisibility=function(t){var e=this.kmlTimePrimitive&&this.kmlTimePrimitive.timeRange();if(t.currentLayer.currentTimeInterval&&e){var r=t.currentLayer.currentTimeInterval[0],i=t.currentLayer.currentTimeInterval[1];if(e&&(e.from<r||e.from>i||e.to>i))return!1}return!0},u.prototype.getStyle=function(t,e){if(!this._pStyle&&(this.kmlStyleUrl||this.kmlStyleSelector)){var r=this;new l(function(t,i){window.setTimeout(function(){e.styleResolver.handleRemoteStyle(r.kmlStyleUrl,r.kmlStyleSelector,t,i)},0)}).then(function(e){r._pStyle=e,t.redrawRequested=!0})}},u.prototype.getTagNames=function(){return["NetworkLink","Placemark","PhotoOverlay","ScreenOverlay","GroundOverlay","Folder","Document"]},u}),define("worldwind/formats/kml/features/KmlContainer",["./KmlFeature"],function(t){"use strict";var e=function(e){t.call(this,e)};return e.prototype=Object.create(t.prototype),Object.defineProperties(e.prototype,{kmlShapes:{get:function(){var t=this._factory.all(this);return t.filter(function(t){return t.isFeature})}}}),e.prototype.render=function(e,r){t.prototype.render.call(this,e,r);var i=this;this.kmlShapes.forEach(function(t){t.render(e,{lastStyle:r.lastStyle,lastVisibility:i.enabled,currentTimeInterval:r.currentTimeInterval,regionInvisible:r.regionInvisible,fileCache:r.fileCache,styleResolver:r.styleResolver,listener:r.listener,activeEvents:r.activeEvents})})},e.prototype.getTagNames=function(){return["Folder","Document"]},e}),define("worldwind/formats/kml/util/Schema",["./../KmlElements","../KmlObject"],function(t,e){"use strict";var r=function(t){e.call(this,t)};return r.prototype=Object.create(e.prototype),r.prototype.getTagNames=function(){return["Schema"]},t.addKey(r.prototype.getTagNames()[0],r),r}),define("worldwind/formats/kml/features/KmlDocument",["./KmlContainer","../KmlElements","./KmlFeature","../util/Schema"],function(t,e,r,i){"use strict";var n=function(e){t.call(this,e)};return n.prototype=Object.create(t.prototype),Object.defineProperties(n.prototype,{kmlSchemas:{get:function(){var t=this._factory.all(this);return t.filter(function(t){return t instanceof i})}}}),n.prototype.getTagNames=function(){return["Document"]},e.addKey(n.prototype.getTagNames()[0],n),n}),define("worldwind/formats/kml/features/KmlFolder",["./KmlContainer","./../KmlElements"],function(t,e){"use strict";var r=function(e){t.call(this,e)};return r.prototype=Object.create(t.prototype),r.prototype.getTagNames=function(){return["Folder"]},e.addKey(r.prototype.getTagNames()[0],r),r}),define("worldwind/formats/kml/geom/KmlGeometry",["../KmlObject"],function(t){"use strict";var e=function(e){t.call(this,e),this._renderable=null};return e.prototype=Object.create(t.prototype),e.prototype.render=function(e,r){t.prototype.render.call(this,e,r),this.enabled=r.lastVisibility},e.prototype.getTagNames=e.getTagNames=function(){return["Point","LinearRing","LineString","MultiGeometry","Polygon"]},e}),define("worldwind/formats/kml/KmlLatLonBox",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlNorth:{get:function(){return this._factory.specific(this,{name:"north",transformer:r.number})}},kmlSouth:{get:function(){return this._factory.specific(this,{name:"south",transformer:r.number})}},kmlEast:{get:function(){return this._factory.specific(this,{name:"east",transformer:r.number})}},kmlWest:{get:function(){return this._factory.specific(this,{name:"west",transformer:r.number})}},kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["LatLonBox"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/KmlLatLonQuad",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlCoordinates:{get:function(){return this._factory.specific(this,{name:"coordinates",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["gx:LatLonQuad"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/features/KmlOverlay",["./KmlFeature","./../KmlIcon","../util/NodeTransformers"],function(t,e,r){"use strict";var i=function(e){t.call(this,e)};return i.prototype=Object.create(t.prototype),Object.defineProperties(i.prototype,{kmlColor:{get:function(){return this._factory.specific(this,{name:"color",transformer:r.string})}},kmlDrawOrder:{get:function(){return this._factory.specific(this,{name:"drawOrder",transformer:r.string})}},kmlIcon:{get:function(){return this._factory.any(this,{name:e.prototype.getTagNames()})}}}),i.prototype.getTagNames=function(){return["PhotoOverlay","ScreenOverlay","GroundOverlay"]},i}),define("worldwind/formats/kml/features/KmlGroundOverlay",["./../KmlElements","./KmlFeature","../KmlLatLonBox","../KmlLatLonQuad","./KmlOverlay","../util/NodeTransformers","../../../geom/Sector","../../../shapes/SurfaceImage"],function(t,e,r,i,n,o,a,s){"use strict";var l=function(t){this.isGroundOverlay=!0,n.call(this,t)};return l.prototype=Object.create(n.prototype),Object.defineProperties(l.prototype,{kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:o.string})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:o.string})}},kmlLatLonBox:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}},kmlLatLonQuad:{get:function(){return this._factory.any(this,{name:i.prototype.getTagNames()})}}}),l.prototype.render=function(t,r){e.prototype.render.call(this,t,r),!this._renderable&&this.enabled&&this.kmlIcon&&this.kmlLatLonBox&&(this._renderable=new s(new a(this.kmlLatLonBox.kmlSouth,this.kmlLatLonBox.kmlNorth,this.kmlLatLonBox.kmlWest,this.kmlLatLonBox.kmlEast),this.kmlIcon.kmlHref),t.redrawRequested=!0),this._renderable&&this._renderable.render(t)},l.prototype.getTagNames=function(){return["GroundOverlay"]},t.addKey(l.prototype.getTagNames()[0],l),l}),define("worldwind/shapes/Path",["../shapes/AbstractShape","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolyline","../geom/Vec2","../geom/Vec3"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d){"use strict";var p=function(r,i){if(!r)throw new e(a.logMessage(a.LEVEL_SEVERE,"Path","constructor","missingPositions"));t.call(this,i),this._positions=r,this._pathType=WorldWind.GREAT_CIRCLE,this._terrainConformance=10,this._numSubSegments=10,this.referencePosition=this.determineReferencePosition(this._positions),this.scratchPoint=new d(0,0,0)};return p.prototype=Object.create(t.prototype),Object.defineProperties(p.prototype,{positions:{get:function(){return this._positions},set:function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Path","constructor","missingPositions"));this._positions=t,this.referencePosition=this.determineReferencePosition(this._positions),this.reset()}},followTerrain:{get:function(){return this._followTerrain},set:function(t){this._followTerrain=t,this.reset()}},terrainConformance:{get:function(){return this._terrainConformance},set:function(t){this._terrainConformance=t,this.reset()}},numSubSegments:{get:function(){return this._numSubSegments},set:function(t){this._numSubSegments=t>=0?t:0,this.reset()}},pathType:{get:function(){return this._pathType},set:function(t){this._pathType=t,this.reset()}},extrude:{get:function(){return this._extrude},set:function(t){this._extrude=t,this.reset()}}}),p.prototype.determineReferencePosition=function(t){return t.length>0?t[0]:null},p.prototype.mustGenerateGeometry=function(t){return!this.currentData.tessellatedPoints||(this.currentData.drawInterior!==this.activeAttributes.drawInterior||this.currentData.drawVerticals!==this.activeAttributes.drawVerticals||(!this.followTerrain&&this.currentData.numSubSegments!==this.numSubSegments||(!(!this.followTerrain||this.currentData.terrainConformance===this.terrainConformance)||this.altitudeMode!==WorldWind.ABSOLUTE&&this.currentData.isExpired)))},p.prototype.createSurfaceShape=function(){return new h(this.positions,null)},p.prototype.doMakeOrderedRenderable=function(t){if(!this.referencePosition)return null;if(!this.mustGenerateGeometry(t))return this;var e=this.currentData.referencePoint;t.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude,this._altitudeMode,e),this.currentData.transformationMatrix.setToTranslation(e[0],e[1],e[2]);var r=this.makeTessellatedPositions(t);if(r.length<2)return null;var n=this.computeRenderedPath(t,r);return this.currentData.tessellatedPoints=n,this.currentData.drawInterior=this.activeAttributes.drawInterior,this.currentData.drawVerticals=this.activeAttributes.drawVerticals,this.currentData.numSubSegments=this.numSubSegments,this.currentData.terrainConformance=this.terrainConformance,this.resetExpiration(this.currentData),this.currentData.fillVbo=!0,this.currentData.extent||(this.currentData.extent=new i),this.currentData.extent.setToPoints(n),this.currentData.extent.translate(this.currentData.referencePoint),this},p.prototype.makeTessellatedPositions=function(t){var e,r,i,n=[],o=t.navigatorState,a=this.mustDrawVerticals(t),s=new d(0,0,0),l=new d(0,0,0),u=this._positions[0];a&&(this.currentData.verticalIndices=new Int16Array(2*this.positions.length),this.currentData.verticalIndices[0]=0,this.currentData.verticalIndices[1]=1),n.push(u),t.surfacePointForMode(u.latitude,u.longitude,u.altitude,this._altitudeMode,s);for(var c=1,h=this._positions.length;c<h;c++)if(e=this._positions[c],t.surfacePointForMode(e.latitude,e.longitude,e.altitude,this._altitudeMode,l),r=o.eyePoint.distanceTo(s),i=o.pixelSizeAtDistance(r),s.distanceTo(l)<8*i&&this.altitudeMode!==WorldWind.ABSOLUTE?n.push(e):this.makeSegment(t,u,e,s,l,n),u=e,s.copy(l),a){var f=2*(n.length-1);this.currentData.verticalIndices[2*c]=f,this.currentData.verticalIndices[2*c+1]=f+1}return n},p.prototype.makeSegment=function(t,e,r,i,n,a){var s,l,c,h,f,d,p=t.navigatorState,g=p.eyePoint,m=new o(0,0),y=0;if(this._pathType===WorldWind.LINEAR&&!this._followTerrain)return void(i.equals(n)||a.push(r));if(c=this._pathType===WorldWind.LINEAR?o.linearDistance(e,r):this._pathType===WorldWind.RHUMB_LINE?o.rhumbDistance(e,r):o.greatCircleDistance(e,r),this._altitudeMode!==WorldWind.CLAMP_TO_GROUND&&(y=.5*(e.altitude+r.altitude)),s=c*(t.globe.equatorialRadius+y*t.verticalExaggeration),!(s<=0)){for(l=this._pathType===WorldWind.LINEAR?o.linearAzimuth(e,r):this._pathType===WorldWind.RHUMB_LINE?o.rhumbAzimuth(e,r):o.greatCircleAzimuth(e,r),this.scratchPoint.copy(i),h=0,f=0;h<1&&(f+=this._followTerrain?this._terrainConformance*p.pixelSizeAtDistance(this.scratchPoint.distanceTo(g)):s/this._numSubSegments,!(s<f||s-f<1e-9));)h=f/s,d=h*c,this._pathType===WorldWind.LINEAR?o.linearLocation(e,l,d,m):this._pathType===WorldWind.RHUMB_LINE?o.rhumbLocation(e,l,d,m):o.greatCircleLocation(e,l,d,m),m.altitude=(1-h)*e.altitude+h*r.altitude,a.push(new u(m.latitude,m.longitude,m.altitude)),this._followTerrain&&t.surfacePointForMode(m.latitude,m.longitude,m.altitude,WorldWind.CLAMP_TO_GROUND,this.scratchPoint);a.push(r)}},p.prototype.computeRenderedPath=function(t,e){var r,i,n,o,a=this.mustDrawInterior(t)||this.mustDrawVerticals(t),s=Number.MAX_VALUE,l=t.navigatorState.eyePoint,u=(a?2:1)*e.length,c=new Float32Array(3*u),h=a?6:3,f=new d(0,0,0);r=this._followTerrain&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND?WorldWind.RELATIVE_TO_GROUND:this.altitudeMode;for(var p=0,g=e.length;p<g;p++)i=e[p],t.surfacePointForMode(i.latitude,i.longitude,i.altitude,r,f),o=f.distanceToSquared(l),o<s&&(s=o),f.subtract(this.currentData.referencePoint),n=h*p,c[n]=f[0],c[n+1]=f[1],c[n+2]=f[2],a&&(t.surfacePointForMode(i.latitude,i.longitude,0,WorldWind.CLAMP_TO_GROUND,f),o=f.distanceToSquared(l),o<s&&(s=o),f.subtract(this.currentData.referencePoint),c[n+3]=f[0],c[n+4]=f[1],c[n+5]=f[2]);return this.currentData.pointBufferHasExtrusionPoints=a,this.currentData.eyeDistance=Math.sqrt(s),c},p.prototype.mustDrawInterior=function(t){return this.activeAttributes.drawInterior&&this._extrude&&this._altitudeMode!==WorldWind.CLAMP_TO_GROUND},p.prototype.mustDrawVerticals=function(t){return this.activeAttributes.drawOutline&&this.activeAttributes.drawVerticals&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND},p.prototype.doRenderOrdered=function(t){var e,r,i,n,o,a,s=t.currentGlContext,u=t.currentProgram,c=this.currentData,h=c.tessellatedPoints.length/3;if(this.applyMvpMatrix(t),c.vboCacheKey||(c.vboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(c.vboCacheKey),e||(e=s.createBuffer(),t.gpuResourceCache.putResource(this.currentData.vboCacheKey,e,4*c.tessellatedPoints.length),c.fillVbo=!0),s.bindBuffer(s.ARRAY_BUFFER,e),c.fillVbo&&(s.bufferData(s.ARRAY_BUFFER,c.tessellatedPoints,s.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),u.loadTextureEnabled(s,!1),t.pickingMode&&(n=t.uniquePickColor()),this.mustDrawInterior(t)&&(i=this.activeAttributes.interiorColor,r=i.alpha*t.currentLayer.opacity,r<1&&!t.pickingMode&&s.depthMask(!1),u.loadColor(s,t.pickingMode?n:i),u.loadOpacity(s,t.pickingMode?r>0?1:0:r),s.vertexAttribPointer(u.vertexPointLocation,3,s.FLOAT,!1,0,0),s.drawArrays(s.TRIANGLE_STRIP,0,h)),this.activeAttributes.drawOutline&&((this.mustDrawVerticals(t)&&this.mustDrawInterior(t)||this.altitudeMode===WorldWind.CLAMP_TO_GROUND)&&this.applyMvpMatrixForOutline(t),i=this.activeAttributes.outlineColor,r=i.alpha*t.currentLayer.opacity,r<1&&!t.pickingMode&&s.depthMask(!1),u.loadColor(s,t.pickingMode?n:i),u.loadOpacity(s,t.pickingMode?1:r),s.lineWidth(this.activeAttributes.outlineWidth),this.currentData.pointBufferHasExtrusionPoints?(o=24,a=h/2):(o=12,a=h),s.vertexAttribPointer(u.vertexPointLocation,3,s.FLOAT,!1,o,0),s.drawArrays(s.LINE_STRIP,0,a),this.mustDrawVerticals(t)&&(c.verticalIndicesVboCacheKey||(c.verticalIndicesVboCacheKey=t.gpuResourceCache.generateCacheKey()),e=t.gpuResourceCache.resourceForKey(c.verticalIndicesVboCacheKey),e||(e=s.createBuffer(),t.gpuResourceCache.putResource(c.verticalIndicesVboCacheKey,e,4*c.verticalIndices.length),c.fillVbo=!0),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e),c.fillVbo&&(s.bufferData(s.ELEMENT_ARRAY_BUFFER,c.verticalIndices,s.STATIC_DRAW),t.frameStatistics.incrementVboLoadCount(1)),s.vertexAttribPointer(u.vertexPointLocation,3,s.FLOAT,!1,0,0),s.drawElements(s.LINES,c.verticalIndices.length,s.UNSIGNED_SHORT,0))),c.fillVbo=!1,t.pickingMode){var f=new l(n,this.pickDelegate?this.pickDelegate:this,null,t.currentLayer,!1);t.resolvePick(f)}},p.prototype.beginDrawing=function(t){var e=t.currentGlContext;this.mustDrawInterior(t)&&e.disable(e.CULL_FACE),t.findAndBindProgram(r),e.enableVertexAttribArray(t.currentProgram.vertexPointLocation)},p.prototype.endDrawing=function(t){var e=t.currentGlContext;e.disableVertexAttribArray(t.currentProgram.vertexPointLocation),e.depthMask(!0),e.lineWidth(1),e.enable(e.CULL_FACE)},p}),define("worldwind/formats/kml/geom/KmlLineString",["../../../util/Color","../KmlElements","./KmlGeometry","../styles/KmlStyle","../../../geom/Location","../util/NodeTransformers","../../../shapes/Path","../../../geom/Position","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolyline","../../../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(t){r.call(this,t),this._style=null};return h.prototype=Object.create(r.prototype),Object.defineProperties(h.prototype,{kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:o.boolean})||!1}},kmlTessellate:{get:function(){return this._factory.specific(this,{name:"tessellate",transformer:o.boolean})||!1}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:o.string})||WorldWind.ABSOLUTE}},kmlPositions:{get:function(){return this._factory.specific(this,{name:"coordinates",transformer:o.positions})}},kmlCenter:{get:function(){var t=this.kmlPositions,e=0,r=0,i=0;return t.forEach(function(t){e+=t.latitude,r+=t.longitude,i+=t.altitude}),new s(e/this.kmlPositions.length,r/this.kmlPositions.length,i/this.kmlPositions.length)}}}),h.prototype.createPath=function(t){this.kmlAltitudeMode==WorldWind.CLAMP_TO_GROUND?this._renderable=new u(this.prepareLocations(),this.prepareAttributes(t.normal)):this._renderable=new a(this.prepareLocations(),this.prepareAttributes(t.normal)),t.highlight&&(this._renderable.highlightAttributes=this.prepareAttributes(t.highlight)),this.moveValidProperties()},h.prototype.render=function(t,e){r.prototype.render.call(this,t,e),e.lastStyle&&!this._renderable&&(this.createPath(e.lastStyle),t.redrawRequested=!0),this._renderable&&(this._renderable.enabled=this.enabled,this._renderable.render(t))},h.prototype.prepareAttributes=function(t){var e=t&&t.generate()||{};return e._applyLighting=!0,e._drawOutline=!0,e._drawInterior=!0,e._drawVerticals=this.kmlExtrude||!1,e._outlineStippleFactor=0,e._outlineStipplePattern=61680,e._enableLighting=!0,new l(i.shapeAttributes(e))},h.prototype.prepareLocations=function(){return this.kmlPositions},h.prototype.moveValidProperties=function(){this._renderable.extrude=this.kmlExtrude||!1,this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.ABSOLUTE,this._renderable.tesselate=this.kmlTesselate||!1},h.prototype.equals=function(t){if(!t)return!1;var e=c.arrayEquals(t.kmlPositions,this.kmlPositions);return e&&t.kmlExtrude==this.kmlExtrude&&t.kmlTessellate==this.kmlTessellate&&t.kmlAltitudeMode==this.kmlAltitudeMode},h.prototype.getTagNames=function(){return["LineString"]},e.addKey(h.prototype.getTagNames()[0],h),h}),define("worldwind/formats/kml/geom/KmlLinearRing",["./KmlLineString","../KmlElements"],function(t,e){"use strict";var r=function(e){t.call(this,e)};return r.prototype=Object.create(t.prototype),r.prototype.getTagNames=function(){return["LinearRing"]},e.addKey(r.prototype.getTagNames()[0],r),r}),define("worldwind/formats/kml/KmlLocation",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:r.string})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:r.string})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["Location"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/KmlLookAt",["./KmlAbstractView","./KmlElements","./util/NodeTransformers","../../geom/Position"],function(t,e,r,i){"use strict";var n=function(e){t.call(this,e)};return n.prototype=Object.create(t.prototype),Object.defineProperties(n.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:r.number})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:r.number})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:r.number})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:r.number})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:r.number})}},kmlRange:{get:function(){return this._factory.specific(this,{name:"range",transformer:r.number
})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:r.string})}}}),n.prototype.update=function(t){if(t.wwd){var e=this.kmlAltitude||4e3;t.wwd.goTo(new i(this.kmlLatitude,this.kmlLongitude,e))}},n.prototype.getTagNames=function(){return["LookAt"]},e.addKey(n.prototype.getTagNames()[0],n),n}),define("worldwind/formats/kml/geom/KmlMultiGeometry",["./../KmlElements","./KmlGeometry","../../../geom/Position"],function(t,e,r){"use strict";var i=function(t){e.call(this,t),this._style=t.style};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlShapes:{get:function(){return this._factory.all(this)}},kmlCenter:{get:function(){var t=this.kmlShapes.map(function(t){return t.kmlCenter}),e=0,i=0,n=0;return t.forEach(function(t){e+=t.latitude,i+=t.longitude,n+=t.altitude}),new r(e/t.length,i/t.length,n/t.length)}}}),i.prototype.render=function(t,r){e.prototype.render.call(this,t,r),this.kmlShapes.forEach(function(e){e.render(t,r)})},i.prototype.getTagNames=function(){return["MultiGeometry"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/features/KmlNetworkLink",["./../KmlElements","./KmlFeature","../KmlFile","../KmlLink","../util/NodeTransformers","../util/RefreshListener"],function(t,e,r,i,n,o){"use strict";var a="refreshNetworkLinkEvent",s=function(t){e.call(this,t),this.isFeature=!0,this.resolvedFile=null,this.displayed=!1,this.isDownloading=!1};return s.prototype=Object.create(e.prototype),Object.defineProperties(s.prototype,{kmlRefreshVisibility:{get:function(){return this._factory.specific(this,{name:"refreshVisibility",transformer:n.boolean})}},kmlFlyToView:{get:function(){return this._factory.specific(this,{name:"flyToView",transformer:n.boolean})}},kmlLink:{get:function(){return this._factory.any(this,{name:i.prototype.getTagNames()})}}}),s.prototype.getTagNames=function(){return["NetworkLink"]},s.prototype.render=function(t,i){if(e.prototype.render.call(this,t,i),i.lastVisibility||this.displayed){if(!this.isDownloading&&!this.resolvedFile){this.isDownloading=!0;var n=this;new r(n.buildUrl()).then(function(t){n.resolvedFile=t,n.isDownloading=!1,n.fireEvent(i)})}this.resolvedFile&&!this.displayed&&(this.resolvedFile.render(t,i),this.handleRefresh(i))}},s.prototype.buildUrl=function(){return this.kmlLink.kmlHref},s.prototype.handleRefresh=function(t){var e=t.activeEvents;if(e=e.filter(function(t){return t.type==a}),e.length>0){var i=this;new r(i.buildUrl()).then(function(e){i.resolvedFile=e,i.fireEvent(t)})}},s.prototype.fireEvent=function(t){var e=0;if("onInterval"==this.kmlLink.kmlRefreshMode)e=1e3*this.kmlLink.kmlRefreshInterval;else{if("onExpire"!=this.kmlLink.kmlRefreshMode)return;if(!this.resolvedFile)return;e=this.resolvedFile.getExpired()}t.listener.addEvent(new o.Event(a,e,null))},t.addKey(s.prototype.getTagNames()[0],s),s}),define("worldwind/formats/kml/KmlOrientation",["./KmlElements","./KmlObject","./util/NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:r.number})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:r.number})}},kmlRoll:{get:function(){return this._factory.specific(this,{name:"roll",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["Orientation"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/geom/KmlPoint",["../../../util/Color","../KmlElements","./KmlGeometry","../../../geom/Location","../util/NodeTransformers","../../../shapes/Polygon","../../../geom/Position"],function(t,e,r,i,n,o,a){"use strict";var s=function(t){r.call(this,t),this._shape=null};return s.prototype=Object.create(r.prototype),Object.defineProperties(s.prototype,{kmlPosition:{get:function(){var t=this._factory.specific(this,{name:"coordinates",transformer:n.string}).split(",");return new a(t[1],t[0],t[2]||0)}},kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:n.boolean})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:n.string})}},kmlCenter:{get:function(){return this.kmlPosition}}}),s.prototype.getTagNames=function(){return["Point"]},e.addKey(s.prototype.getTagNames()[0],s),s}),define("worldwind/formats/kml/util/ViewVolume",["../KmlElements","../KmlObject","./NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlLeftFov:{get:function(){return this._factory.specific(this,{name:"leftFov",transformer:r.number})}},kmlRightFov:{get:function(){return this._factory.specific(this,{name:"rightFov",transformer:r.number})}},kmlBottomFov:{get:function(){return this._factory.specific(this,{name:"bottomFov",transformer:r.number})}},kmlTopFov:{get:function(){return this._factory.specific(this,{name:"topFov",transformer:r.number})}},kmlNear:{get:function(){return this._factory.specific(this,{name:"near",transformer:r.string})}}}),i.prototype.getTagNames=function(){return["ViewVolume"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/formats/kml/features/KmlPhotoOverlay",["../util/ImagePyramid","./../KmlElements","./KmlOverlay","../geom/KmlPoint","../util/NodeTransformers","../util/ViewVolume"],function(t,e,r,i,n,o){"use strict";var a=function(t){r.call(this,t)};return a.prototype=Object.create(r.prototype),Object.defineProperties(a.prototype,{kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:n.string})}},kmlShape:{get:function(){return this._factory.specific(this,{name:"shape",transformer:n.string})}},kmlPoint:{get:function(){return this._factory.any(this,{name:i.prototype.getTagNames()})}},kmlViewVolume:{get:function(){return this._factory.any(this,{name:o.prototype.getTagNames()})}},kmlImagePyramid:{get:function(){return this._factory.any(this,{name:t.prototype.getTagNames()})}}}),a.prototype.getTagNames=function(){return["PhotoOverlay"]},e.addKey(a.prototype.getTagNames[0],a),a}),define("worldwind/formats/kml/features/KmlPlacemark",["./../KmlElements","./KmlFeature","../geom/KmlGeometry","../styles/KmlStyle","../KmlTimeSpan","../KmlTimeStamp","../../../shapes/PlacemarkAttributes","../../../shapes/Placemark","../../../util/Color","../../../shapes/ShapeAttributes","../../../shapes/TextAttributes","../../../util/Offset","../../../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c,h,f){"use strict";var d=function(t){e.call(this,t)};return d.prototype=Object.create(e.prototype),Object.defineProperties(d.prototype,{kmlGeometry:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}}}),d.prototype.render=function(t,r){e.prototype.render.call(this,t,r),r=f.clone(r),r.lastStyle&&!this._renderable&&this.kmlGeometry&&(this._renderable=new s(this.kmlGeometry.kmlCenter,!1,this.prepareAttributes(r.lastStyle.normal)),r.lastStyle.highlight&&(this._renderable.highlightAttributes=this.prepareAttributes(r.lastStyle.highlight)),this.moveValidProperties(),t.redrawRequested=!0),this._renderable&&this.kmlGeometry&&(this.kmlGeometry.render(t,r),this._renderable.render(t))},d.prototype.prepareAttributes=function(t){var e=t&&t.generate()||{normal:{},highlight:{}},r=new a(i.placemarkAttributes(e));return r.imageOffset=new h(WorldWind.OFFSET_FRACTION,.3,WorldWind.OFFSET_FRACTION,0),r.imageColor=l.WHITE,r.labelAttributes=new c(i.textAttributes({_offset:new h(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,1),_color:l.YELLOW})),r.drawLeaderLine=!0,r.leaderLineAttributes=new u(i.shapeAttributes({outlineColor:l.RED})),r},d.prototype.moveValidProperties=function(){this._renderable.label=this.kmlName||"",this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.RELATIVE_TO_GROUND,this._renderable.enableLeaderLinePicking=!0},d.prototype.getTagNames=function(){return["Placemark"]},t.addKey(d.prototype.getTagNames()[0],d),d}),define("worldwind/formats/kml/geom/KmlPolygon",["../../../util/Color","../KmlElements","./KmlGeometry","./KmlLinearRing","../styles/KmlStyle","../../../geom/Location","../util/NodeTransformers","../../../shapes/Polygon","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolygon"],function(t,e,r,i,n,o,a,s,l,u){"use strict";var c=function(t){r.call(this,t),this.initialized=!1};return c.prototype=Object.create(r.prototype),Object.defineProperties(c.prototype,{kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:a.boolean})}},kmlTessellate:{get:function(){return this._factory.specific(this,{name:"tessellate",transformer:a.boolean})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:a.string})}},kmlOuterBoundary:{get:function(){return this._factory.specific(this,{name:"outerBoundaryIs",transformer:a.linearRing})}},kmlInnerBoundary:{get:function(){return this._factory.specific(this,{name:"innerBoundaryIs",transformer:a.linearRing})}},kmlCenter:{get:function(){return this.kmlOuterBoundary.kmlCenter}}}),c.prototype.createPolygon=function(t){this.kmlAltitudeMode==WorldWind.CLAMP_TO_GROUND?this._renderable=new u(this.prepareLocations(),this.prepareAttributes(t.normal)):this._renderable=new s(this.prepareLocations(),this.prepareAttributes(t.normal)),t.highlight&&(this._renderable.highlightAttributes=this.prepareAttributes(t.highlight)),this.moveValidProperties()},c.prototype.render=function(t,e){r.prototype.render.call(this,t,e),e.lastStyle&&!this._renderable&&(this.createPolygon(e.lastStyle),t.redrawRequested=!0),this._renderable&&(this._renderable.enabled=this.enabled,this._renderable.render(t))},c.prototype.moveValidProperties=function(){this._renderable.extrude=this.kmlExtrude||!0,this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.CLAMP_TO_GROUND},c.prototype.prepareAttributes=function(t){var e=t&&t.generate()||{};return e._drawVerticals=this.kmlExtrude||!1,e._applyLighting=!0,e._depthTest=!0,e._outlineStippleFactor=0,e._outlineStipplePattern=61680,e._enableLighting=!0,new l(n.shapeAttributes(e))},c.prototype.prepareLocations=function(){var t=[];return null!=this.kmlInnerBoundary?(t[0]=this.kmlInnerBoundary.kmlPositions,t[1]=this.kmlOuterBoundary.kmlPositions):t=this.kmlOuterBoundary.kmlPositions,t},c.prototype.getStyle=function(){return this._style},c.prototype.getTagNames=function(){return["Polygon"]},e.addKey(c.prototype.getTagNames()[0],c),c}),define("worldwind/formats/kml/features/KmlScreenOverlay",["./../KmlElements","./KmlFeature","./KmlOverlay","../util/NodeTransformers","../../../util/Offset","../../../shapes/ScreenImage","../../../util/WWUtil"],function(t,e,r,i,n,o,a){"use strict";var s=function(t){r.call(this,t),console.log("Create Screen Overlay",this)};return s.prototype=Object.create(r.prototype),Object.defineProperties(s.prototype,{kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:i.number})}},kmlOverlayXYx:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:i.attribute("x"),attribute:"kmlOverlayXYx"})}},kmlOverlayXYy:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:i.attribute("y"),attribute:"kmlOverlayXYy"})}},kmlOverlayXYxunits:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:i.attribute("xunits"),attribute:"kmlOverlayXYxunits"})}},kmlOverlayXYyunits:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:i.attribute("yunits"),attribute:"kmlOverlayXYyunits"})}},kmlScreenXYx:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:i.attribute("x"),attribute:"kmlScreenXYx"})}},kmlScreenXYy:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:i.attribute("y"),attribute:"kmlScreenXYy"})}},kmlScreenXYxunits:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:i.attribute("xunits"),attribute:"kmlScreenXYxunits"})}},kmlScreenXYyunits:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:i.attribute("yunits"),attribute:"kmlScreenXYyunits"})}},kmlRotationXYx:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:i.attribute("x"),attribute:"kmlRotationXYx"})}},kmlRotationXYy:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:i.attribute("y"),attribute:"kmlRotationXYy"})}},kmlRotationXYxunits:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:i.attribute("xunits"),attribute:"kmlRotationXYxunits"})}},kmlRotationXYyunits:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:i.attribute("yunits"),attribute:"kmlRotationXYyunits"})}},kmlSizex:{get:function(){return this._factory.specific(this,{name:"size",transformer:i.attribute("x"),attribute:"kmlSizex"})}},kmlSizey:{get:function(){return this._factory.specific(this,{name:"size",transformer:i.attribute("y"),attribute:"kmlSizey"})}},kmlSizexunits:{get:function(){return this._factory.specific(this,{name:"size",transformer:i.attribute("xunits"),attribute:"kmlSizexunits"})}},kmlSizeyunits:{get:function(){return this._factory.specific(this,{name:"size",transformer:i.attribute("yunits"),attribute:"kmlSizeyunits"})}}}),s.prototype.render=function(t,r){e.prototype.render.call(this,t,r),this._renderable||this.kmlIcon&&(this._renderable=new o(new n(this.kmlScreenXYxunits,this.kmlScreenXYx,this.kmlScreenXYyunits,this.kmlScreenXYy),this.kmlIcon.kmlHref),this._renderable.imageOffset=new n(this.kmlOverlayXYxunits,this.kmlOverlayXYx,this.kmlOverlayXYyunits,this.kmlOverlayXYy),t.redrawRequested=!0),this._renderable&&this._renderable.render(t)},s.prototype.getTagNames=function(){return["ScreenOverlay"]},t.addKey(s.prototype.getTagNames()[0],s),s}),define("worldwind/formats/kml/features/KmlTour",["./../KmlElements","./KmlFeature"],function(t,e){"use strict";var r=function(t){e.call(this,t)};return r.prototype=Object.create(e.prototype),r.prototype.getTagNames=function(){return["gx:Tour"]},t.addKey(r.prototype.getTagNames()[0],r),r}),define("worldwind/formats/kml/geom/KmlTrack",["./../KmlElements","./KmlGeometry"],function(t,e){"use strict";var r=function(t){e.call(this,t)};return r.prototype=Object.create(e.prototype),r.prototype.getTagNames=function(){return["gx:Track"]},t.addKey(r.prototype.getTagNames()[0],r),r}),define("worldwind/layer/LandsatRestLayer",["../error/ArgumentError","../geom/Location","../util/Logger","../geom/Sector","../layer/TiledImageLayer","../util/LevelRowColumnUrlBuilder","../util/WWUtil"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,s){var l=a.urlPath(t+"/"+r);n.call(this,i.FULL_SPHERE,new e(36,36),10,"image/png",l,512,512),this.displayName=s,this.pickEnabled=!1,this.urlBuilder=new o(t,r)};return s.prototype=Object.create(n.prototype),s}),define("worldwind/util/measure/LengthMeasurer",["../../error/ArgumentError","../../geom/Location","../Logger","./MeasurerUtils","../../geom/Position","../../geom/Vec3"],function(t,e,r,i,n,o){var a=function(e){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"LengthMeasurer","constructor","missingWorldWindow"));this.wwd=e,this.DEFAULT_MIN_SEGMENT_LENGTH=30,this._maxSegmentLength=1e5,this._lengthTerrainSamplingSteps=128,this.subdividedPositions=null};return Object.defineProperties(a.prototype,{maxSegmentLength:{get:function(){return this._maxSegmentLength},set:function(t){this._maxSegmentLength=t}},lengthTerrainSamplingSteps:{get:function(){return this._lengthTerrainSamplingSteps},set:function(t){this._lengthTerrainSamplingSteps=t}}}),a.prototype.getLength=function(t,e,r){return r=r||WorldWind.GREAT_CIRCLE,this.subdividedPositions=null,this.computeLength(t,e,r)},a.prototype.getPathLength=function(t){return this.subdividedPositions=null,this.computeLength(t.positions,t.followTerrain,t.pathType)},a.prototype.getGeographicDistance=function(t,r){if(t instanceof WorldWind.Path)var i=t.positions,n=t.pathType;else Array.isArray(t)&&(i=t,n=r||WorldWind.GREAT_CIRCLE);if(!i||i.length<2)return-1;var o=e.greatCircleDistance;n===WorldWind.RHUMB_LINE?o=e.rhumbDistance:n===WorldWind.LINEAR&&(o=e.linearDistance);for(var a=0,s=0,l=i.length-1;s<l;s++){var u=i[s],c=i[s+1];a+=o(u,c)}return a*this.wwd.globe.equatorialRadius},a.prototype.computeLength=function(t,e,r){if(!t||t.length<2)return-1;var n=this.wwd.globe;if(null==this.subdividedPositions){var a=this._maxSegmentLength;if(e){var s=this.computeLength(t,!1,r);a=s/this._lengthTerrainSamplingSteps,a=Math.min(Math.max(a,this.DEFAULT_MIN_SEGMENT_LENGTH),this._maxSegmentLength)}this.subdividedPositions=i.subdividePositions(n,t,e,r,a)}var l=0,u=this.subdividedPositions[0],c=new o(0,0,0),h=new o(0,0,0);c=n.computePointFromPosition(u.latitude,u.longitude,u.altitude,c);for(var f=1,d=this.subdividedPositions.length;f<d;f++){var p=this.subdividedPositions[f];h=n.computePointFromPosition(p.latitude,p.longitude,p.altitude,h),l+=c.distanceTo(h),c.copy(h)}return l},a}),define("worldwind/cache/MemoryCacheListener",["../util/Logger","../error/UnsupportedOperationError"],function(t,e){"use strict";var r=function(){};return r.prototype.entryRemoved=function(r,i){throw new e(t.logMessage(t.LEVEL_SEVERE,"MemoryCacheListener","entryRemoved","abstractInvocation"))},r.prototype.removalError=function(r,i,n){throw new e(t.logMessage(t.LEVEL_SEVERE,"MemoryCacheListener","removalError","abstractInvocation"))},r}),define("worldwind/util/NominatimGeocoder",["../util/Logger"],function(t){"use strict";var e=function(){this.service="https://open.mapquestapi.com/nominatim/v1/search/"};return e.prototype.lookup=function(t,e,r){var i=this.service+t.replace(" ","%20")+"?format=json",n=new XMLHttpRequest,o=this;i+="&key="+(r||"lUvVRchXGGDh5Xwk3oidrXeIDAAevOUS"),n.open("GET",i,!0),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var t=JSON.parse(n.responseText);e(o,t)}},n.send(null)},e}),define("worldwind/layer/OpenStreetMapImageLayer",["../geom/Angle","../util/Color","../geom/Location","../geom/Sector","../layer/MercatorTiledImageLayer"],function(t,e,r,i,n){"use strict";var o=function(t){this.imageSize=256,t=t||"Open Street Map",n.call(this,new i(-85.05,85.05,-180,180),new r(85.05,180),19,"image/png",t,this.imageSize,this.imageSize),this.displayName=t,this.pickEnabled=!1,this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d"),this.urlBuilder={urlForTile:function(t,e){return"http://otile1.mqcdn.com/tiles/1.0.0/osm/"+(t.level.levelNumber+1)+"/"+t.column+"/"+t.row+".png"}}};return o.prototype=Object.create(n.prototype),o.prototype.doRender=function(t){n.prototype.doRender.call(this,t),this.inCurrentFrame&&(t.screenCreditController.addStringCredit("©OpenStreetMap",e.DARK_GRAY),t.screenCreditController.addStringCredit("Tiles Courtesy of MapQuest",e.DARK_GRAY))},o.prototype.createTopLevelTiles=function(t){this.topLevelTiles=[],this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))},o.prototype.mapSizeForLevel=function(t){return 256<<t+1},o}),define("worldwind/projections/ProjectionGnomonic",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Sector","../util/WWMath"],function(t,e,r,i,n,o){"use strict";var a=function(t){this.north=!("South"===t);var e=this.north?new n(30,90,-180,180):new n(-90,-30,-180,180);r.call(this,"Polar Gnomonic",!1,e),this._pole=t,this.displayName=this.north?"North Gnomonic":"South Gnomonic",this._stateKey="projection polar gnomonic "+this._pole+" "};return a.prototype=Object.create(r.prototype),Object.defineProperties(a.prototype,{pole:{get:function(){return this._pole},set:function(t){this._pole=t,this.north=!("South"===this._pole),this.projectionLimits=this.north?new n(30,90,-180,180):new n(-90,-30,-180,180),this._stateKey="projection polar gnomonic "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}}),a.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesian","missingResult"));if(this.north&&90===n||!this.north&&n===-90)l[0]=0,l[1]=0,l[2]=a;else{var u=this.north?1:-1,c=r.equatorialRadius/Math.tan(n*t.DEGREES_TO_RADIANS);l[0]=c*Math.sin(o*t.DEGREES_TO_RADIANS)*u,l[1]=c*-Math.cos(o*t.DEGREES_TO_RADIANS),l[2]=a}return l},a.prototype.geographicToCartesianGrid=function(r,n,a,s,l,u,c,h){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingGlobe"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingSector"));if(!l||l.length<a*s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!h)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingResult"));var f,d,p,g,m,y,v=n.minLatitude*t.DEGREES_TO_RADIANS,b=n.maxLatitude*t.DEGREES_TO_RADIANS,E=n.minLongitude*t.DEGREES_TO_RADIANS,w=n.maxLongitude*t.DEGREES_TO_RADIANS,_=(b-v)/(a>1?a-1:1),x=(w-E)/(s>1?s-1:1),S=this.projectionLimits.minLatitude*t.DEGREES_TO_RADIANS,T=this.projectionLimits.maxLatitude*t.DEGREES_TO_RADIANS,M=this.north?1:-1,L=u?u:new Vec3(0,0,0),A=0,N=0;for(f=0,p=v;f<a;f++,p+=_)for(f===a-1&&(p=b),m=o.clamp(p,S,T),y=r.equatorialRadius/Math.tan(m),(this.north&&m===Math.PI/2||!this.north&&m===-Math.PI/2)&&(y=0),d=0,g=E;d<s;d++,g+=x)d===s-1&&(g=w),h[N++]=y*Math.sin(g)*M-L[0],h[N++]=y*-Math.cos(g)-L[1],h[N++]=l[A++]-L[2];return h},a.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","cartesianToGeographic","missingResult"));var u,c=Math.sqrt(n*n+o*o);return c<1e-4?(l.latitude=this.north?90:-90,l.longitude=0,l.altitude=a):(u=Math.atan2(c,r.equatorialRadius),u>Math.PI&&(u=Math.PI),l.latitude=Math.asin(Math.cos(u)*(this.north?1:-1))*t.RADIANS_TO_DEGREES,l.longitude=Math.atan2(n,o*(this.north?-1:1))*t.RADIANS_TO_DEGREES,l.altitude=a),l},a.prototype.northTangentAtLocation=function(r,n,o,a){if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","northTangentAtLocation","missingResult"));return a[0]=Math.sin(o*t.DEGREES_TO_RADIANS)*(this.north?-1:1),a[1]=Math.cos(o*t.DEGREES_TO_RADIANS),a[2]=0,a},a.prototype.northTangentAtPoint=function(t,r,n,o,a,s){if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionGnomonic","northTangentAtLocation","missingResult"));var l=Math.sqrt(r*r+n*n);return l<1e-4?(s[0]=0,s[1]=1,s[2]=0):(s[0]=r/l*(this.north?-1:1),s[1]=n/l*(this.north?-1:1),s[2]=0),s},a}),define("worldwind/projections/ProjectionMercator",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Sector","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(){r.call(this,"Mercator",!0,new n(-78,78,-180,180))};return s.prototype=Object.create(r.prototype),s.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesian","missingResult"));n>this.projectionLimits.maxLatitude&&(n=this.projectionLimits.maxLatitude),n<this.projectionLimits.minLatitude&&(n=this.projectionLimits.minLatitude);var u=Math.sqrt(r.eccentricitySquared),c=Math.sin(n*t.DEGREES_TO_RADIANS),h=(1+c)/(1-c)*Math.pow((1-u*c)/(1+u*c),u);return l[0]=r.equatorialRadius*o*t.DEGREES_TO_RADIANS+(s?s[0]:0),l[1]=.5*r.equatorialRadius*Math.log(h),l[2]=a,l},Object.defineProperties(s.prototype,{stateKey:{get:function(){return"projection mercator "}}}),s.prototype.geographicToCartesianGrid=function(r,n,s,l,u,c,h,f){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingGlobe"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingSector"));if(!u||u.length<s*l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!f)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingResult"));var d,p,g,m,y,v,b,E,w=r.equatorialRadius,_=Math.sqrt(r.eccentricitySquared),x=n.minLatitude*t.DEGREES_TO_RADIANS,S=n.maxLatitude*t.DEGREES_TO_RADIANS,T=n.minLongitude*t.DEGREES_TO_RADIANS,M=n.maxLongitude*t.DEGREES_TO_RADIANS,L=(S-x)/(s>1?s-1:1),A=(M-T)/(l>1?l-1:1),N=this.projectionLimits.minLatitude*t.DEGREES_TO_RADIANS,C=this.projectionLimits.maxLatitude*t.DEGREES_TO_RADIANS,R=c?c:new o(0,0,0),P=h?h[0]:0,O=0,I=0;for(d=0,g=x;d<s;d++,g+=L)for(d===s-1&&(g=S),y=a.clamp(g,N,C),v=Math.sin(y),b=(1+v)/(1-v)*Math.pow((1-_*v)/(1+_*v),_),E=w*Math.log(b)*.5-R[1],p=0,m=T;p<l;p++,m+=A)p===l-1&&(m=M),f[I++]=w*m-R[0]+P,f[I++]=E,f[I++]=u[O++]-R[2];return f},s.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionMercator","cartesianToGeographic","missingResult"));var u=r.eccentricitySquared,c=u*u,h=c*u,f=h*u,d=Math.pow(Math.E,-o/r.equatorialRadius),p=Math.PI/2-2*Math.atan(d),g=u/2+5*c/24+h/12+13*f/360,m=7*c/48+29*h/240+811*f/11520,y=7*h/120+81*f/1120,v=4279*f/161280,b=p-m+v,E=g-3*y,w=2*m-8*v,_=4*y,x=8*v,S=Math.sin(2*p),T=b+S*(E+S*(w+S*(_+x*S)));return l.latitude=T*t.RADIANS_TO_DEGREES,l.longitude=(n-(s?s[0]:0))/r.equatorialRadius*t.RADIANS_TO_DEGREES,l.altitude=a,l},s}),define("worldwind/projections/ProjectionPolarEquidistant",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger"],function(t,e,r,i){"use strict";var n=function(t){r.call(this,"Polar Equidistant",!1,null),this._pole=t,this.north=!("South"===t),this.displayName=this.north?"North Polar":"South Polar",this._stateKey="projection polar equidistant "+this._pole+" "};return n.prototype=Object.create(r.prototype),Object.defineProperties(n.prototype,{pole:{get:function(){return this._pole},set:function(t){this._pole=t,this.north=!("South"===this._pole),this._stateKey="projection polar equidistant "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}}),n.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesian","missingResult"));if(this.north&&90===n||!this.north&&n===-90)l[0]=0,l[1]=0,l[2]=a;else{var u=this.north?-1:1,c=r.equatorialRadius*(Math.PI/2+n*t.DEGREES_TO_RADIANS*u);l[0]=c*Math.sin(o*t.DEGREES_TO_RADIANS),l[1]=c*Math.cos(o*t.DEGREES_TO_RADIANS)*u,l[2]=a}return l},n.prototype.geographicToCartesianGrid=function(r,n,o,a,s,l,u,c){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingGlobe"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingSector"));if(!s||s.length<o*a)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!c)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingResult"));var h,f,d,p,g,m=r.equatorialRadius,y=n.minLatitude*t.DEGREES_TO_RADIANS,v=n.maxLatitude*t.DEGREES_TO_RADIANS,b=n.minLongitude*t.DEGREES_TO_RADIANS,E=n.maxLongitude*t.DEGREES_TO_RADIANS,w=(v-y)/(o>1?o-1:1),_=(E-b)/(a>1?a-1:1),x=this.north?-1:1,S=l?l:new Vec3(0,0,0),T=Math.PI/2,M=0,L=0,A=new Float64Array(a),N=new Float64Array(a);for(f=0,p=b;f<a;f++,p+=_)f===a-1&&(p=E),A[f]=Math.cos(p),N[f]=Math.sin(p);for(h=0,d=y;h<o;h++,d+=w)for(h===o-1&&(d=v),g=m*(T+d*x),(this.north&&d===T||!this.north&&d===-T)&&(g=0),f=0;f<a;f++)c[L++]=g*N[f]-S[0],c[L++]=g*A[f]*x-S[1],c[L++]=s[M++]-S[2];return c},n.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","cartesianToGeographic","missingResult"));var u,c=Math.sqrt(n*n+o*o);return c<1e-4?(l.latitude=this.north?90:-90,l.longitude=0,l.altitude=a):(u=c/r.equatorialRadius,u>Math.PI&&(u=Math.PI),l.latitude=Math.asin(Math.cos(u)*(this.north?1:-1))*t.RADIANS_TO_DEGREES,l.longitude=Math.atan2(n,o*(this.north?-1:1))*t.RADIANS_TO_DEGREES,l.altitude=a),l},n.prototype.northTangentAtLocation=function(r,n,o,a){if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));return a[0]=Math.sin(o*t.DEGREES_TO_RADIANS)*(this.north?-1:1),a[1]=Math.cos(o*t.DEGREES_TO_RADIANS),a[2]=0,a},n.prototype.northTangentAtPoint=function(t,r,n,o,a,s){if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));var l=Math.sqrt(r*r+n*n);return l<1e-4?(s[0]=0,s[1]=1,s[2]=0):(s[0]=r/l*(this.north?-1:1),s[1]=n/l*(this.north?-1:1),s[2]=0),s},n}),define("worldwind/projections/ProjectionUPS",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Sector","../geom/Vec3","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(t){this.north=!("South"===t);var e=this.north?new n(0,90,-180,180):new n(-90,0,-180,180);r.call(this,"Uniform Polar Stereographic",!1,e),this._pole=t,this.displayName=this.north?"North UPS":"South UPS",this._stateKey="projection ups "+this._pole+" "};return s.prototype=Object.create(r.prototype),Object.defineProperties(s.prototype,{pole:{get:function(){return this._pole},set:function(t){this._pole=t,this.north=!("South"===this._pole),this.projectionLimits=this.north?new n(0,90,-180,180):new n(-90,0,-180,180),this._stateKey="projection ups "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}}),s.prototype.geographicToCartesian=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesian","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesian","missingResult"));if(this.north&&90===n||!this.north&&n===-90)l[0]=0,l[1]=0,l[2]=a;else{var u,c,h,f=this.north?1:-1,d=n*t.DEGREES_TO_RADIANS,p=o*t.DEGREES_TO_RADIANS,g=.994,m=Math.sqrt(r.eccentricitySquared),y=Math.sqrt(Math.pow(1+m,1+m)*Math.pow(1-m,1-m));(this.north&&d<0||!this.north&&d>0)&&(d=0),u=Math.sin(d*f),c=Math.sqrt((1-u)/(1+u)*Math.pow((1+m*u)/(1-m*u),m)),h=2*r.equatorialRadius*g*c/y,l[0]=h*Math.sin(p),l[1]=-h*Math.cos(p)*f,l[2]=a}return l},s.prototype.geographicToCartesianGrid=function(r,n,s,l,u,c,h,f){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingGlobe"));if(!n)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingSector"));if(!u||u.length<s*l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!f)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingResult"));var d,p,g,m,y,v,b,E,w=r.equatorialRadius,_=n.minLatitude*t.DEGREES_TO_RADIANS,x=n.maxLatitude*t.DEGREES_TO_RADIANS,S=n.minLongitude*t.DEGREES_TO_RADIANS,T=n.maxLongitude*t.DEGREES_TO_RADIANS,M=(x-_)/(s>1?s-1:1),L=(T-S)/(l>1?l-1:1),A=this.projectionLimits.minLatitude*t.DEGREES_TO_RADIANS,N=this.projectionLimits.maxLatitude*t.DEGREES_TO_RADIANS,C=.994,R=Math.sqrt(r.eccentricitySquared),P=Math.sqrt(Math.pow(1+R,1+R)*Math.pow(1-R,1-R)),O=this.north?1:-1,I=c?c:new o(0,0,0),k=0,D=0;
for(d=0,g=_;d<s;d++,g+=M)for(d===s-1&&(g=x),y=a.clamp(g,A,N),v=Math.sin(y*O),b=Math.sqrt((1-v)/(1+v)*Math.pow((1+R*v)/(1-R*v),R)),E=2*w*C*b/P,p=0,m=S;p<l;p++,m+=L)p===l-1&&(m=T),f[D++]=E*Math.sin(m)-I[0],f[D++]=-E*Math.cos(m)*O-I[1],f[D++]=u[k++]-I[2];return f},s.prototype.cartesianToGeographic=function(r,n,o,a,s,l){if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","cartesianToGeographic","missingGlobe"));if(!l)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","cartesianToGeographic","missingResult"));var u=Math.atan2(n,o*(this.north?-1:1)),c=.994,h=Math.sqrt(r.eccentricitySquared),f=Math.sqrt(n*n+o*o),d=Math.sqrt(Math.pow(1+h,1+h)*Math.pow(1-h,1-h)),p=f*d/(2*r.equatorialRadius*c),g=r.eccentricitySquared,m=g*g,y=m*g,v=y*g,b=Math.PI/2-2*Math.atan(p),E=g/2+5*m/24+y/12+13*v/360,w=7*m/48+29*y/240+811*v/11520,_=7*y/120+81*v/1120,x=4279*v/161280,S=b-w+x,T=E-3*_,M=2*w-8*x,L=4*_,A=8*x,N=Math.sin(2*b),C=S+N*(T+N*(M+N*(L+A*N)));return C*=this.north?1:-1,l.latitude=C*t.RADIANS_TO_DEGREES,l.longitude=u*t.RADIANS_TO_DEGREES,l.altitude=a,l},s.prototype.northTangentAtLocation=function(r,n,o,a){if(!a)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionUPS","northTangentAtLocation","missingResult"));return a[0]=Math.sin(o*t.DEGREES_TO_RADIANS)*(this.north?-1:1),a[1]=Math.cos(o*t.DEGREES_TO_RADIANS),a[2]=0,a},s.prototype.northTangentAtPoint=function(t,r,n,o,a,s){if(!s)throw new e(i.logMessage(i.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));var l=Math.sqrt(r*r+n*n);return l<1e-4?(s[0]=0,s[1]=1,s[2]=0):(s[0]=r/l*(this.north?-1:1),s[1]=n/l*(this.north?-1:1),s[2]=0),s},s}),define("worldwind/formats/kml/util/Scale",["./../KmlElements","../KmlObject","./NodeTransformers"],function(t,e,r){"use strict";var i=function(t){e.call(this,t)};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{kmlX:{get:function(){return this._factory.specific(this,{name:"x",transformer:r.number})}},kmlY:{get:function(){return this._factory.specific(this,{name:"y",transformer:r.number})}},kmlZ:{get:function(){return this._factory.specific(this,{name:"z",transformer:r.number})}}}),i.prototype.getTagNames=function(){return["Scale"]},t.addKey(i.prototype.getTagNames()[0],i),i}),define("worldwind/util/ByteBuffer",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"ByteBuffer","constructor","missingArray"));this.array=i,this.data=new DataView(i),this.position=0,this._order=r.LITTLE_ENDIAN};return r.prototype.getByte=function(){var t=this.data.getUint8(this.position);return this.position+=r.BYTE_SIZE,t},r.prototype.getByteArray=function(t){var e=new Uint8Array(this.array,this.position,t);return this.position+=r.BYTE_SIZE*t,e},r.prototype.getInt16=function(){var t=this.data.getInt16(this.position,this._order);return this.position+=r.INT16_SIZE,t},r.prototype.getInt16Array=function(t){var e=new Int16Array(this.array,this.position,t);return this.position+=r.INT16_SIZE*t,e},r.prototype.getInt32=function(){var t=this.data.getInt32(this.position,this._order);return this.position+=r.INT32_SIZE,t},r.prototype.getInt32Array=function(t){var e=new Int32Array(this.array,this.position,t);return this.position+=r.INT32_SIZE*t,e},r.prototype.getFloat=function(){var t=this.data.getFloat32(this.position,this._order);return this.position+=r.FLOAT_SIZE,t},r.prototype.getFloatArray=function(t){var e=new Float32Array(this.array,this.position,t);return this.position+=r.FLOAT_SIZE*t,e},r.prototype.getDouble=function(){var t=this.data.getFloat64(this.position,this._order);return this.position+=r.DOUBLE_SIZE,t},r.prototype.getDoubleArray=function(t){var e;if(this.position%8!=0){var i=this.array.slice(this.position,this.position+t*r.DOUBLE_SIZE);e=new Float64Array(i)}else e=new Float64Array(this.array,this.position,t);return this.position+=r.DOUBLE_SIZE*t,e},r.prototype.skipBytes=function(t){this.position+=t*r.BYTE_SIZE},r.prototype.skipInt16s=function(t){this.position+=t*r.INT16_SIZE},r.prototype.skipInt32s=function(t){this.position+=t*r.INT32_SIZE},r.prototype.skipFloats=function(t){this.position+=t*r.FLOAT_SIZE},r.prototype.skipDoubles=function(t){this.position+=t*r.DOUBLE_SIZE},r.prototype.seek=function(t){this.position=t},r.prototype.order=function(t){this._order=t},r.prototype.limit=function(){return this.data.byteLength},r.prototype.hasRemaining=function(){return this.position<this.data.byteLength},r.BIG_ENDIAN=!1,r.LITTLE_ENDIAN=!0,r.BYTE_SIZE=1,r.INT16_SIZE=2,r.INT32_SIZE=4,r.FLOAT_SIZE=4,r.DOUBLE_SIZE=8,r}),define("worldwind/formats/shapefile/DBaseField",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseFile","../../util/Logger"],function(t,e,r,i){"use strict";var n=function(e,r){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"DBaseField","constructor","missingAttributeName"));if(!r)throw new t(i.logMessage(i.LEVEL_SEVERE,"DBaseField","constructor","missingBuffer"));this.name=null,this.type=null,this.typeCode=-1,this.length=-1,this.decimals=-1,this.readFieldDescriptor(e,r)};return n.prototype.getName=function(){return this.name},n.prototype.getType=function(){return this.type},n.prototype.getLength=function(){return this.length},n.prototype.getDecimals=function(){return this.decimals},n.prototype.readFieldDescriptor=function(t,r){r.order(e.LITTLE_ENDIAN);var o=r.position;if(this.name=t.readNullTerminatedString(r,n.FIELD_NAME_LENGTH),r.seek(o+n.FIELD_NAME_LENGTH),this.typeCode=String.fromCharCode(r.getByte()),this.type=n.getFieldType(this.typeCode),null==this.type)throw new Error(i.log(i.LEVEL_SEVERE,"Shapefile dBase encountered unsupported field type: "+this.typeCode));r.skipBytes(4),this.length=r.getByte(),this.decimals=r.getByte(),r.seek(o+n.FIELD_DESCRIPTOR_LENGTH)},n.getFieldType=function(t){switch(t){case"C":return n.TYPE_CHAR;case"D":return n.TYPE_DATE;case"F":return n.TYPE_NUMBER;case"L":return n.TYPE_BOOLEAN;case"N":return n.TYPE_NUMBER;default:return null}},n.prototype.toString=function(){return this.name+"("+this.typeCode+")"},n.TYPE_CHAR="DBase.FieldTypeChar",n.TYPE_NUMBER="DBase.FieldTypeNumber",n.TYPE_DATE="DBase.FieldTypeDate",n.TYPE_BOOLEAN="DBase.FieldTypeBoolean",n.FIELD_NAME_LENGTH=11,n.FIELD_DESCRIPTOR_LENGTH=32,n}),define("worldwind/formats/shapefile/DBaseRecord",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseField","../../formats/shapefile/DBaseFile","../../util/Logger"],function(t,e,r,i,n){"use strict";var o=function(e,r,i){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"DBaseRecord","constructor","missingAttributeName"));if(!r)throw new t(n.logMessage(n.LEVEL_SEVERE,"DBaseRecord","constructor","missingBuffer"));this.deleted=!1,this.recordNumber=i,this.values=null,this.readFromBuffer(e,r,i)};return o.prototype.isDeleted=function(){return this.deleted},o.prototype.getRecordNumber=function(){return this.recordNumber},o.prototype.readFromBuffer=function(t,i,o){i.order(e.LITTLE_ENDIAN),this.recordNumber=o;var a=i.getByte();this.deleted=42==a;var s=t.getFields();this.values={};for(var l=0,u=s.length;l<u;l+=1){var c=s[l],h=c.getName(),f=t.readNullTerminatedString(i,c.getLength()).trim();try{if(c.getType()==r.TYPE_BOOLEAN){var d=f.charAt(0);this.values[h]="t"==d||"T"==d||"Y"==d||"y"==d}else c.getType()==r.TYPE_CHAR?this.values[h]=f:c.getType()==r.TYPE_DATE?this.values[h]=new Date(f):c.getType()==r.TYPE_NUMBER&&(this.values[h]=+f)}catch(t){n.log(n.LEVEL_WARNING,"Shapefile attribute parsing error:"+c.toString()+" -> "+f.toString()+" ["+t+"]")}}},o}),define("worldwind/formats/shapefile/DBaseFile",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseField","../../formats/shapefile/DBaseRecord","../../util/Logger"],function(t,e,r,i,n){"use strict";var o=function(e){if(!e)throw new t(n.logMessage(n.LEVEL_SEVERE,"DBaseFile","constructor","missingUrl"));this.url=e,this.header=null,this.fields=null,this.buffer=null,this.boolean=!0,this.numRecordsRead=0,this._completionCallback=null};return o.prototype.getLastModificationDate=function(){return this.header.lastModificationDate},o.prototype.getNumberOfRecords=function(){return this.header.numberOfRecords},o.prototype.getHeaderLength=function(){return this.header.headerLength},o.prototype.getRecordLength=function(){return this.header.recordLength},o.prototype.getNumberOfFields=function(){return(this.header.headerLength-1-o.FIXED_HEADER_LENGTH)/o.FIELD_DESCRIPTOR_LENGTH},o.prototype.getFields=function(){return this.fields},o.prototype.hasNext=function(){return this.numRecordsRead<this.header.numberOfRecords},o.prototype.nextRecord=function(){return this.numRecordsRead>=this.getNumberOfRecords()?null:this.readNextRecord(this._buffer,++this.numRecordsRead)},o.prototype.load=function(t){this._completionCallback=t,this.requestUrl(this.url)},o.prototype.requestUrl=function(t){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){4===r.readyState&&(200===r.status?(this._buffer=new e(r.response),this.parse(),this._completionCallback&&this._completionCallback(this)):(n.log(n.LEVEL_WARNING,"DBaseFile retrieval failed ("+r.statusText+"): "+t),this._completionCallback&&this._completionCallback(this)))}.bind(this),r.onerror=function(){n.log(n.LEVEL_WARNING,"DBaseFile retrieval failed: "+t),this._completionCallback&&this._completionCallback(this)},r.ontimeout=function(){n.log(n.LEVEL_WARNING,"DBaseFile retrieval timed out: "+t),this._completionCallback&&this._completionCallback(this)},r.send(null)},o.prototype.parse=function(){this.header=this.readHeader(this._buffer),this.fields=this.readFieldDescriptors(this._buffer,this.getNumberOfFields())},o.prototype.readHeader=function(t){var r=t.position;t.order(e.LITTLE_ENDIAN);var i=t.getByte();if(i>5)throw new Error("???");var n=t.getByte(),a=t.getByte(),s=t.getByte(),l=t.getInt32(),u=t.getInt16(),c=t.getInt16(),h={year:1900+n,month:a-1,day:s},f={fileCode:i,lastModificationDate:h,numberOfRecords:l,headerLength:u,recordLength:c};return t.seek(r+o.FIXED_HEADER_LENGTH),f},o.prototype.readFieldDescriptors=function(t,e){for(var i=t.position,n=[],a=0;a<e;a+=1)n[a]=new r(this,t);var s=this.header.headerLength-o.FIXED_HEADER_LENGTH;return t.seek(i+s),n},o.prototype.readNextRecord=function(t,e){return new i(this,t,e)},o.prototype.readNullTerminatedString=function(t,e){if(e<=0)return 0;for(var r="",i=0;i<e;i+=1){var n=t.getByte();if(0==n)break;r+=String.fromCharCode(n)}return this.isStringEmpty(r)?"":r},o.prototype.isStringEmpty=function(t){return t.length<=0||o.isStringFilled(t,32)||o.isStringFilled(t,42)},o.isStringFilled=function(t,e){if(t.length<=0)return!1;for(var r=0;r<t.length;r++)if(t.charAt(r)!=e)return!1;return!0},o.FIXED_HEADER_LENGTH=32,o.FIELD_DESCRIPTOR_LENGTH=32,o}),define("worldwind/formats/shapefile/PrjFile",["../../error/ArgumentError","../../util/Logger","../../error/NotYetImplementedError"],function(t,e,r){"use strict";var i=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"DBaseFile","constructor","missingUrl"));this._url=r,this._completionCallback=null,this._params=null};return Object.defineProperties(i.prototype,{url:{get:function(){return this._url}},coordinateSystem:{get:function(){return this.params?this.params[i.COORDINATE_SYSTEM]:null}},params:{get:function(){return this._params}}}),i.prototype.load=function(t){this._completionCallback=t,this.requestUrl(this._url)},i.prototype.requestUrl=function(t){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var i=String.fromCharCode.apply(null,new Uint8Array(r.response));this._params=this.decodeOGCCoordinateSystem(i)}else e.log(e.LEVEL_WARNING,"PrjFile retrieval failed ("+r.statusText+"): "+t);this._completionCallback&&this._completionCallback(this)}}.bind(this),r.onerror=function(){e.log(e.LEVEL_WARNING,"PrjFile retrieval failed: "+t),this._completionCallback&&this._completionCallback(this)}.bind(this),r.ontimeout=function(){e.log(e.LEVEL_WARNING,"PrjFile retrieval timed out: "+t),this._completionCallback&&this._completionCallback(this)}.bind(this),r.send(null)},i.prototype.decodeOGCCoordinateSystem=function(n){n||new t(e.logMessage(e.LEVEL_SEVERE,"PrjFile","decodeOGCCoordinateSystem","missingText"));var o={};if(n=n.trim().toUpperCase(),i.GEOGCS_WKT_PATTERN.test(n))o[i.COORDINATE_SYSTEM]=i.COORDINATE_SYSTEM_GEOGRAPHIC;else{var a=n.match(i.PROJCS_WKT_PATTERN);if(a)throw o[PrfFile.COORDINATE_SYSTEM]=i.COORDINATE_SYSTEM_PROJECTED,new r(e.log(e.LEVEL_SEVERE,"PrjFile implementation  for projected coordinate systems in incomplete."));o[i.COORDINATE_SYSTEM]=i.COORDINATE_SYSTEM_UNKNOWN}return o},i.prototype.isUnknownCoordinateSystem=function(){return!this.params||this.params.coordinateSystem===i.COORDINATE_SYSTEM_UNKNOWN},i.prototype.isKnownCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem!==i.COORDINATE_SYSTEM_UNKNOWN},i.prototype.isGeographicCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem===i.COORDINATE_SYSTEM_GEOGRAPHIC},i.prototype.isProjectedCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem===i.COORDINATE_SYSTEM_PROJECTED},i.GEOGCS_WKT_PATTERN=new RegExp("\\{*GEOGCS[\\[\\(](.*)[\\]\\)]\\}*"),i.PROJCS_WKT_PATTERN=new RegExp("\\{*PROJCS[\\[\\(](.*)[\\]\\)]\\}*"),i.UTM_NAME_WKT_PATTERN=new RegExp(".*UTM.*ZONE.*?(\\d+).*?([\\w\\s]+).*?"),i.COORDINATE_SYSTEM="Coordinate_system",i.COORDINATE_SYSTEM_GEOGRAPHIC="Coordinate_system_geographic",i.COORDINATE_SYSTEM_PROJECTED="Coordinate_system_projected",i.COORDINATE_SYSTEM_UNKNOWN="Coordinate_system_unknown",i.PROJECTION_NAME="Projection_name",i.PROJECTION_UTM="Projection_UTM",i.PROJECTION_ZONE="Projection_zone",i.PROJECTION_HEMISPHERE="Projection_hemisphere",i.PROJECTION_HEMISPHERE_NORTH="Projection_hemisphere_north",i.PROJECTION_HEMISPHERE_SOUTH="Projection_hemisphere_south",i}),define("worldwind/formats/shapefile/ShapefileRecord",["../../geom/Angle","../../error/ArgumentError","../../util/ByteBuffer","../../geom/Location","../../util/Logger","../../formats/shapefile/Shapefile"],function(t,e,r,i,n,o){"use strict";var a=function(t,r){if(!t)throw new e(n.logMessage(n.LEVEL_SEVERE,"ShapefileRecord","constructor","The specified shapefile is null or undefined"));if(!r)throw new e(n.logMessage(n.LEVEL_SEVERE,"ShapefileRecord","constructor","The specified buffer is null or undefined"));this._shapefile=t,this._recordNumber=-1,this._attributes={},this._numberOfParts=0,this._firstPartNumber=0,this._lastPartNumber=0,this._numberOfPoints=0,this._boundingRectangle=[],this._zRange=null,this._zValues=null,this._mRange=null,this._mValues=null,this._contentLengthInBytes=-1,this._buffer=r,this._isNormalized=!1,this._parts=[],this.readRecord()};return Object.defineProperties(a.prototype,{shapefile:{get:function(){return this._shapefile}},recordNumber:{get:function(){return this._recordNumber}},attributes:{get:function(){return this._attributes}},numberOfParts:{get:function(){return this._numberOfParts}},firstPartNumber:{get:function(){return this._firstPartNumber}},lastPartNumber:{get:function(){return this._lastPartNumber}},numberOfPoints:{get:function(){return this._numberOfPoints}},boundingRectangle:{get:function(){return this._boundingRectangle}},zRange:{get:function(){return this._zRange}},zValues:{get:function(){return this._zValues}},mRange:{get:function(){return this._mRange}},mValues:{get:function(){return this._mValues}}}),a.prototype.pointBuffer=function(t){return t>=0&&t<this._parts.length?this._parts[t]:null},a.prototype.readRecord=function(){this.readHeader(),this._buffer.order(r.LITTLE_ENDIAN);var t=this._buffer.getInt32(),e=this.shapefile.getShapeType(t);this.validateShapeType(e),this.readContents()},a.prototype.readHeader=function(){this._buffer.order(r.BIG_ENDIAN),this._recordNumber=this._buffer.getInt32(),this._contentLengthInBytes=2*this._buffer.getInt32()},a.prototype.validateShapeType=function(t){if(t!==this.shapefile.NULL&&t!==this.shapefile.shapeType)throw new Error(n.log(n.LEVEL_SEVERE,"Shapefile record is not supported."))},a.prototype.readNullContents=function(){this._numberOfParts=0,this._numberOfPoints=0,this._parts=null,this._boundingRectangle=null,this._buffer.seek(this._contentLengthInBytes-r.INT32_SIZE)},a.prototype.readPointContents=function(){this._numberOfParts=1,this._firstPartNumber=0,this._lastPartNumber=this._numberOfParts-1,this._numberOfPoints=1,this._parts=[this._buffer.getDoubleArray(2)];var t=this._parts[0][1],e=this._parts[0][0];this._boundingRectangle=[t,t,e,e],this.isZType()&&this.readZ(!0),this.isMeasureType()&&this.readOptionalMeasures(!0)},a.prototype.readPolylineContents=function(){var t=this.shapefile.readBoundingRectangle(this._buffer);if(this._boundingRectangle=t.coords,this._isNormalized=t.isNormalized,this._numberOfParts=this._buffer.getInt32(),this._firstPartNumber=0,this._lastPartNumber=this._numberOfParts-1,this._numberOfPoints=this._buffer.getInt32(),this._numberOfParts>0&&this._numberOfPoints>0)for(var e=this._buffer.getInt32Array(this.numberOfParts),r=0;r<this.numberOfParts;r+=1){var i=r==this.numberOfParts-1?this._numberOfPoints-e[r]:e[r+1]-e[r];this._parts[r]=this._buffer.getDoubleArray(2*i),a.normalizeLocations(this._parts[r])}this.isZType()&&this.readZ(!1),this.isMeasureType()&&this.readOptionalMeasures(!1)},a.prototype.readMultiPointContents=function(){var t=this.shapefile.readBoundingRectangle(this._buffer);this._boundingRectangle=t.coords,this._isNormalized=t.isNormalized,this._numberOfParts=1,this._numberOfPoints=this._buffer.getInt32(),this._parts=[this._buffer.getDoubleArray(2*this._numberOfPoints)],a.normalizeLocations(this._parts[0]),this.isZType()&&this.readZ(!1),this.isMeasureType()&&this.readOptionalMeasures(!1)},a.prototype.readZ=function(t){if(t){this._zValues=this._buffer.getDoubleArray(1);var e=this._zValues[0];this._zRange=[e,e]}else this._zRange=this._buffer.getDoubleArray(2),this._zValues=this._buffer.getDoubleArray(this.numberOfPoints)},a.prototype.readOptionalMeasures=function(t){if(this._buffer.hasRemaining()&&this._buffer.limit()-this._buffer.position>=8*this.numberOfPoints)if(t){this._mValues=this._buffer.getDoubleArray(1);var e=this._mValues[0];this._mRange=[e,e]}else this._mRange=this._buffer.getDoubleArray(2),this._mValues=this._buffer.getDoubleArray(this.numberOfPoints)},a.normalizeLocations=function(e){for(var r=0,i=e.length;r<i;r+=2){var n=e[r],o=e[r+1];e[r]=t.normalizedDegreesLongitude(n),e[r+1]=t.normalizedDegreesLatitude(o)}},a.prototype.isPointType=function(){return this.shapefile.isPointType()},a.prototype.isMultiPointType=function(){return this.shapefile.isMultiPointType()},a.prototype.isPolylineType=function(){return this.shapefile.isPolylineType()},a.prototype.isPolygonType=function(){return this.shapefile.isPolygonType()},a.prototype.isZType=function(){return this.shapefile.isZType()},a.prototype.isMeasureType=function(){return this.shapefile.isMeasureType()},a.prototype.setAttributes=function(t){this._attributes=t},a.RECORD_HEADER_LENGTH=8,a}),define("worldwind/formats/shapefile/ShapefileRecordMultiPoint",["../../util/ByteBuffer","../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e,r){"use strict";var i=function(t,e){r.call(this,t,e)};return i.prototype=Object.create(r.prototype),i.prototype.readContents=function(){this.readMultiPointContents()},i}),define("worldwind/formats/shapefile/ShapefileRecordNull",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r)};return r.prototype=Object.create(e.prototype),r.prototype.readContents=function(){this.readNullContents()},r}),define("worldwind/formats/shapefile/ShapefileRecordPoint",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r)};return r.prototype=Object.create(e.prototype),r.prototype.readContents=function(){this.readPointContents()},r}),define("worldwind/formats/shapefile/ShapefileRecordPolygon",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r)};return r.prototype=Object.create(e.prototype),r.prototype.readContents=function(){this.readPolylineContents()},r}),define("worldwind/formats/shapefile/ShapefileRecordPolyline",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(t,e){"use strict";var r=function(t,r){e.call(this,t,r)};return r.prototype=Object.create(e.prototype),r.prototype.readContents=function(){this.readPolylineContents()},r}),define("worldwind/formats/shapefile/Shapefile",["../../geom/Angle","../../error/ArgumentError","../../util/ByteBuffer","../../util/Color","../../formats/shapefile/DBaseFile","../../geom/Location","../../util/Logger","../../error/NotYetImplementedError","../../shapes/Path","../../shapes/Placemark","../../shapes/PlacemarkAttributes","../../shapes/Polygon","../../geom/Position","../../formats/shapefile/PrjFile","../../layer/RenderableLayer","../../shapes/ShapeAttributes","../../formats/shapefile/ShapefileRecord","../../formats/shapefile/ShapefileRecordMultiPoint","../../formats/shapefile/ShapefileRecordNull","../../formats/shapefile/ShapefileRecordPoint","../../formats/shapefile/ShapefileRecordPolygon","../../formats/shapefile/ShapefileRecordPolyline","../../shapes/SurfacePolygon","../../shapes/SurfacePolyline"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E,w,_,x){"use strict";var S=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","constructor","missingUrl"));this._url=t,this._shapeType=null,this._layer=null,this._shapeConfigurationCallback=this.defaultShapeConfigurationCallback,this._parserCompletionCallback=this.defaultParserCompletionCallback,this._buffer=null,this.attributeFile=new n(t.replace(".shp",".dbf")),this.projectionFile=new d(t.replace(".shp",".prj")),this.defaultPlacemarkAttributes=new c(null),this.defaultShapeAttributes=new g(null)};return Object.defineProperties(S.prototype,{url:{get:function(){return this._url}},shapeType:{get:function(){return this._shapeType}},layer:{get:function(){return this._layer}},parserCompletionCallback:{get:function(){return this._parserCompletionCallback}},shapeConfigurationCallback:{get:function(){return this._shapeConfigurationCallback}}}),S.prototype.load=function(t,e,r){t&&(this._parserCompletionCallback=t),e&&(this._shapeConfigurationCallback=e),this._layer=r||new p;var i=function(){var t=function(){this.requestUrl(this.url)}.bind(this);this.attributeFile.load(t)}.bind(this);this.projectionFile.load(i)},S.prototype.defaultParserCompletionCallback=function(t){this.addRenderablesForShapefile(this.layer)},S.prototype.defaultShapeConfigurationCallback=function(t,e){var r={},i=t.values.name||t.values.Name||t.values.NAME;if(i&&(r.name=i),e.isPointType())r.attributes=this.defaultPlacemarkAttributes;else if(e.isMultiPointType())r.attributes=this.defaultPlacemarkAttributes;else if(e.isPolylineType())r.attributes=this.defaultShapeAttributes;else if(e.isPolygonType()){r.attributes=this.defaultShapeAttributes;var n=t.values.height||t.values.Height||t.values.HEIGHT;n&&(r.height=n)}return r},S.prototype.addRenderablesForShapefile=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForShapefile","missingLayer"));this.isPointType()?this.addRenderablesForPoints(t):this.isMultiPointType()?this.addRenderablesForMultiPoints(t):this.isPolylineType()?this.addRenderablesForPolylines(t):this.isPolygonType()&&this.addRenderablesForPolygons(t)},S.prototype.addRenderablesForPoints=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForPoints","missingLayer"));for(var r=this.next();r;r=this.next()){var i=this.shapeConfigurationCallback(r.attributes,r),n=i&&i.altitude?i.altitude:0;if(i)for(var o=0,s=r.numberOfParts;o<s;o+=1)for(var l=r.pointBuffer(o),c=0,h=l.length;c<h;c+=2){var d=l[c],p=l[c+1],g=new f(p,d,n),m=new u(g,!1,i.attributes);m.altitudeMode=i.altitudeMode||WorldWind.RELATIVE_TO_GROUND,i.highlightAttributes&&(m.highlightAttributes=i.highlightAttributes),i.name&&(m.label=i.name),i.pickDelegate&&(m.pickDelegate=i.pickDelegate),i.userProperties&&(m.userProperties=i.userProperties),t.addRenderable(m)}}},S.prototype.addRenderablesForMultiPoints=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForMultiPoints","missingLayer"));for(var r=this.next();r;r=this.next()){var i=this.shapeConfigurationCallback(r.attributes,r),n=i&&i.altitude?i.altitude:0;if(i)for(var o=0,s=r.numberOfParts;o<s;o+=1)for(var l=r.pointBuffer(o),c=0,h=l.length;c<h;c+=2){var d=l[c],p=l[c+1],g=new f(p,d,n),m=new u(g,!1,i.attributes);m.altitudeMode=i.altitudeMode||WorldWind.RELATIVE_TO_GROUND,i.highlightAttributes&&(m.highlightAttributes=i.highlightAttributes),i.name&&(m.label=i.name),i.pickDelegate&&(m.pickDelegate=i.pickDelegate),i.userProperties&&(m.userProperties=i.userProperties),t.addRenderable(m)}}},S.prototype.addRenderablesForPolylines=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForPolylines","missingLayer"));for(var r=this.next();r;r=this.next()){var i=this.shapeConfigurationCallback(r.attributes,r),n=i&&i.altitude?i.altitude:0;if(i)for(var s=0,u=r.numberOfParts;s<u;s+=1){for(var c=r.pointBuffer(s),h=[],d=0,p=c.length;d<p;d+=2){var g=c[d],m=c[d+1],y=n?new f(m,g,n):new o(m,g);h.push(y)}var v;n?(v=new l(h,i.attributes),v.altitudeMode=i.altitudeMode||WorldWind.RELATIVE_TO_GROUND):v=new x(h,i.attributes),i.highlightAttributes&&(v.highlightAttributes=i.highlightAttributes),i.name&&(v.displayName=i.name),i.pickDelegate&&(v.pickDelegate=i.pickDelegate),i.userProperties&&(v.userProperties=i.userProperties),t.addRenderable(v)}}},S.prototype.addRenderablesForPolygons=function(t){if(!t)throw new e(a.logMessage(a.LEVEL_SEVERE,"Shapefile","addRenderablesForPolygons","missingLayer"));for(var r=this.next();r;r=this.next()){for(var i,n=this.shapeConfigurationCallback(r.attributes,r),s=[],l=n.height,u=n.altitude,c=0,d=r.numberOfParts;c<d;c+=1){for(var p=r.pointBuffer(c),g=[],m=0,y=p.length-2;m<y;m+=2){var v=p[m],b=p[m+1];i=l?new f(b,v,l):u?new f(b,v,u):new o(b,v),g.push(i)}s.push(g)}var E;l?(E=new h(s,n.attributes),E.extrude=!0,E.altitudeMode=n.altitudeMode||WorldWind.RELATIVE_TO_GROUND):u?(E=new h(s,n.attributes),E.altitudeMode=n.altitudeMode||WorldWind.RELATIVE_TO_GROUND):E=new _(s,n.attributes),n.highlightAttributes&&(E.highlightAttributes=n.highlightAttributes),n.name&&(E.displayName=n.name),n.pickDelegate&&(E.pickDelegate=n.pickDelegate),n.userProperties&&(E.userProperties=n.userProperties),t.addRenderable(E)}},S.prototype.next=function(){for(;this._buffer.position<this._buffer.limit();){var t=this.readRecord(this._buffer);if(!(t instanceof v))return t}return null},S.prototype.requestUrl=function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onreadystatechange=function(){4===e.readyState&&(200===e.status?(this._buffer=new r(e.response),this.parse()):a.log(a.LEVEL_WARNING,"Shapefile retrieval failed ("+e.statusText+"): "+t),this._parserCompletionCallback&&this._parserCompletionCallback(this))}.bind(this),e.onerror=function(){a.log(a.LEVEL_WARNING,"Shapefile retrieval failed: "+t),this._parserCompletionCallback&&this._parserCompletionCallback(this)},e.ontimeout=function(){a.log(a.LEVEL_WARNING,"Shapefile retrieval timed out: "+t),this._parserCompletionCallback&&this._parserCompletionCallback(this)},e.send(null)},S.prototype.parse=function(){try{var t=this.readHeader(this._buffer);this._shapeType=t.shapeType}catch(t){console.log(t)}finally{}},S.prototype.readHeader=function(t){t.order(r.BIG_ENDIAN);var e=t.getInt32();if(e!=S.FILE_CODE)throw new Error(a.log(a.LEVEL_SEVERE,"Shapefile header is invalid"));t.skipInt32s(5);var i=t.getInt32();t.order(r.LITTLE_ENDIAN);var n=t.getInt32(),o=t.getInt32(),s=this.readBoundingRectangle(t),l=this.getShapeType(o);if(null==l)throw new Error(a.log(a.LEVEL_SEVERE,"Shapefile type is unsupported: "+o.toString()));var u={fileLength:2*i,version:n,shapeType:l,boundingRectangle:s.coords,normalizePoints:s.isNormalized};return t.skipDoubles(4),u},S.prototype.readBoundingRectangle=function(t){return this.projectionFile?this.projectionFile.isGeographicCoordinateSystem()?this.readGeographicBoundingRectangle(t):this.projectionFile.isProjectedCoordinateSystem()?this.readProjectedBoundingRectangle(t):this.readUnspecifiedBoundingRectangle(t):this.readUnspecifiedBoundingRectangle(t)},S.prototype.readUnspecifiedBoundingRectangle=function(t){var e=this.readBoundingRectangleCoordinates(t);return{coords:e,isNormalized:!1}},S.prototype.readGeographicBoundingRectangle=function(e){var r=this.readBoundingRectangleCoordinates(e),i=!1,n=0;return r[0]<-90&&(n=t.normalizedDegreesLatitude(r[0]),r[0]=90,i=!0,r[1]<n&&(r[1]=n)),r[1]>90&&(n=t.normalizedDegreesLatitude(r[1]),r[1]=90,i=!0,r[0]>n&&(r[0]=n)),(r[2]<-180||r[3]>180)&&(r[2]=-180,r[3]=180,i=!0),{coords:r,isNormalized:i}},S.prototype.readProjectedBoundingRectangle=function(t){throw new s(a.log(a.LEVEL_SEVERE,"Shapefile.readProjectedBoundingRectangle() not yet implemented"))},S.prototype.readBoundingRectangleCoordinates=function(t){var e=t.getDouble(),r=t.getDouble(),i=t.getDouble(),n=t.getDouble();return[r,n,e,i]},S.prototype.readRecord=function(t){var e=this.createRecord(t);if(null!=e&&null!=this.attributeFile&&this.attributeFile.hasNext()){var r=this.attributeFile.nextRecord();e.setAttributes(r)}return e},S.prototype.createRecord=function(t){return this.isNullType()?this.createNull(t):this.isPointType()?this.createPoint(t):this.isMultiPointType()?this.createMultiPoint(t):this.isPolygonType()?this.createPolygon(t):this.isPolylineType()?this.createPolyline(t):null},S.prototype.createNull=function(t){return new v(this,t)},S.prototype.createPoint=function(t){return new b(this,t)},S.prototype.createMultiPoint=function(t){return new y(this,t)},S.prototype.createPolyline=function(t){return new w(this,t)},S.prototype.createPolygon=function(t){return new E(this,t)},S.prototype.getShapeType=function(t){switch(t){case 0:return S.NULL;case 1:return S.POINT;case 3:return S.POLYLINE;case 5:return S.POLYGON;case 8:return S.MULTI_POINT;case 11:return S.POINT_Z;case 13:return S.POLYLINE_Z;case 15:return S.POLYGON_Z;case 18:return S.MULTI_POINT_Z;case 21:return S.POINT_M;case 23:return S.POLYLINE_M;case 25:return S.POLYGON_M;case 28:return S.MULTI_POINT_M;default:return null}},S.prototype.isMeasureType=function(){return S.measureTypes.hasOwnProperty(this._shapeType)},S.prototype.isZType=function(){return S.zTypes.hasOwnProperty(this._shapeType)},S.prototype.isNullType=function(){return this._shapeType===S.NULL},S.prototype.isPointType=function(){return S.pointTypes.hasOwnProperty(this._shapeType)},S.prototype.isMultiPointType=function(){return S.multiPointTypes.hasOwnProperty(this._shapeType)},S.prototype.isPolylineType=function(){return S.polylineTypes.hasOwnProperty(this._shapeType)},S.prototype.isPolygonType=function(){return S.polygonTypes.hasOwnProperty(this._shapeType)},S.NULL="null",S.POINT="point",S.MULTI_POINT="multiPoint",S.POLYLINE="polyline",S.POLYGON="polygon",S.POINT_M=S.POINT+"M",S.MULTI_POINT_M=S.MULTI_POINT+"M",S.POLYLINE_M=S.POLYLINE+"M",S.POLYGON_M=S.POLYGON+"M",S.POINT_Z=S.POINT+"Z",S.MULTI_POINT_Z=S.MULTI_POINT+"Z",S.POLYLINE_Z=S.POLYLINE+"Z",S.POLYGON_Z=S.POLYGON+"Z",S.SHAPE_MULTI_PATCH="multiPatch",S.measureTypes={pointM:S.POINT_M,pointZ:S.POINT_Z,multiPointM:S.MULTI_POINT_M,multiPointZ:S.MULTI_POINT_Z,polylineM:S.POLYLINE_M,polylineZ:S.POLYLINE_Z,polygonM:S.POLYGON_M,polygonZ:S.POLYGON_Z},S.zTypes={pointZ:S.POINT_Z,multiPointZ:S.MULTI_POINT_Z,polylineZ:S.POLYLINE_Z,polygonZ:S.POLYGON_Z},S.pointTypes={point:S.POINT,pointZ:S.POINT_Z,pointM:S.POINT_M},S.multiPointTypes={multiPoint:S.MULTI_POINT,multiPointZ:S.MULTI_POINT_Z,
multiPointM:S.MULTI_POINT_M},S.polylineTypes={polyline:S.POLYLINE,polylineZ:S.POLYLINE_Z,polylineM:S.POLYLINE_M},S.polygonTypes={polygon:S.POLYGON,polygonZ:S.POLYGON_Z,polygonM:S.POLYGON_M},S.FILE_CODE=9994,S}),define("worldwind/layer/ShowTessellationLayer",["../shaders/BasicProgram","../layer/Layer"],function(t,e){"use strict";var r=function(){e.call(this,"Show Tessellation"),this.enableTerrainGeometry=!0,this.enableTerrainExtent=!1};return r.prototype=Object.create(e.prototype),r.prototype.doRender=function(t){try{this.beginRendering(t),this.enableTerrainGeometry&&this.drawTerrainGeometry(t),this.enableTerrainExtent&&this.drawTerrainExtent(t)}finally{this.endRendering(t)}},r.prototype.beginRendering=function(t){var e=t.currentGlContext;e.depthMask(!1)},r.prototype.endRendering=function(t){var e=t.currentGlContext;e.depthMask(!0)},r.prototype.drawTerrainGeometry=function(e){if(e.terrain&&e.terrain.tessellator){var r,i,n=e.currentGlContext,o=e.terrain,a=o.tessellator,s=o.surfaceGeometry;try{r=e.findAndBindProgram(t),a.beginRendering(e);for(var l=0,u=s.length;l<u;l++)i=s[l],a.beginRenderingTile(e,i),r.loadColorComponents(n,1,1,1,.3),a.renderWireframeTile(e,i),r.loadColorComponents(n,1,0,0,.6),a.renderTileOutline(e,i),a.endRenderingTile(e,i)}finally{a.endRendering(e)}}},r.prototype.drawTerrainExtent=function(t){for(var e,r=t.terrain.surfaceGeometry,i=0,n=r.length;i<n;i++)e=r[i],e.extent.render(t)},r}),define("worldwind/shaders/StarFieldProgram",["../error/ArgumentError","../shaders/GpuProgram","../util/Logger"],function(t,e,r){"use strict";var i=function(t){var r="attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nuniform float numDays;\nuniform vec2 magnitudeRange;\nvarying float magnitudeWeight;\nfloat normalizeAngle(float angle) {\n   float angleDivisions = angle / 360.0;\n   return 360.0 * (angleDivisions - floor(angleDivisions));\n}\nvec3 computePosition(float dec, float ra) {\n   float GMST = normalizeAngle(280.46061837 + 360.98564736629 * numDays);\n   float GHA = normalizeAngle(GMST - ra);\n   float lon = -GHA + 360.0 * step(180.0, GHA);\n   float latRad = radians(dec);\n   float lonRad = radians(lon);\n   float radCosLat = cos(latRad);\n   return vec3(radCosLat * sin(lonRad), sin(latRad), radCosLat * cos(lonRad));\n}\nfloat normalizeScalar(float value, float minValue, float maxValue){\n   return (value - minValue) / (maxValue - minValue);\n}\nvoid main() {\n   vec3 vertexPosition = computePosition(vertexPoint.x, vertexPoint.y);\n   gl_Position = mvpMatrix * vec4(vertexPosition.xyz, 1.0);\n   gl_Position.z = gl_Position.w - 0.00001;\n   gl_PointSize = vertexPoint.z;\n   magnitudeWeight = normalizeScalar(vertexPoint.w, magnitudeRange.x, magnitudeRange.y);\n}",i="precision mediump float;\nuniform sampler2D textureSampler;\nuniform int textureEnabled;\nvarying float magnitudeWeight;\nconst vec4 white = vec4(1.0, 1.0, 1.0, 1.0);\nconst vec4 grey = vec4(0.5, 0.5, 0.5, 1.0);\nvoid main() {\n   if (textureEnabled == 1) {\n       gl_FragColor = texture2D(textureSampler, gl_PointCoord);\n   }\n   else {\n       gl_FragColor = mix(white, grey, magnitudeWeight);\n   }\n}";e.call(this,t,r,i,["vertexPoint"]),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.numDaysLocation=this.uniformLocation(t,"numDays"),this.magnitudeRangeLocation=this.uniformLocation(t,"magnitudeRange"),this.textureUnitLocation=this.uniformLocation(t,"textureSampler"),this.textureEnabledLocation=this.uniformLocation(t,"textureEnabled")};return i.key="WorldWindGpuStarFieldProgram",i.prototype=Object.create(e.prototype),i.prototype.loadModelviewProjection=function(e,i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"StarFieldProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(e,i,this.mvpMatrixLocation)},i.prototype.loadNumDays=function(e,i){if(null==i)throw new t(r.logMessage(r.LEVEL_SEVERE,"StarFieldProgram","loadNumDays","missingNumDays"));e.uniform1f(this.numDaysLocation,i)},i.prototype.loadMagnitudeRange=function(e,i,n){if(null==i)throw new t(r.logMessage(r.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMinMag"));if(null==n)throw new t(r.logMessage(r.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMaxMag"));e.uniform2f(this.magnitudeRangeLocation,i,n)},i.prototype.loadTextureUnit=function(t,e){t.uniform1i(this.textureUnitLocation,e-t.TEXTURE0)},i.prototype.loadTextureEnabled=function(t,e){t.uniform1i(this.textureEnabledLocation,e?1:0)},i}),define("worldwind/util/SunPosition",["../geom/Angle","../error/ArgumentError","./Logger","./WWMath"],function(t,e,r,i){"use strict";var n={getAsGeographicLocation:function(t){if(t instanceof Date==!1)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","getAsGeographicLocation","missingDate"));var i=this.getAsCelestialLocation(t);return this.celestialToGeographic(i,t)},getAsCelestialLocation:function(n){if(n instanceof Date==!1)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","getAsCelestialLocation","missingDate"));var o=this.computeJulianDate(n),a=o-2451545,s=i.normalizeAngle360(280.46+.9856474*a),l=i.normalizeAngle360(357.528+.9856003*a)*t.DEGREES_TO_RADIANS,u=s+1.915*Math.sin(l)+.02*Math.sin(2*l),c=u*t.DEGREES_TO_RADIANS,h=(23.439-4e-7*a)*t.DEGREES_TO_RADIANS,f=Math.asin(Math.sin(h)*Math.sin(c))*t.RADIANS_TO_DEGREES,d=Math.atan(Math.cos(h)*Math.tan(c))*t.RADIANS_TO_DEGREES;return u>=90&&u<270&&(d+=180),d=i.normalizeAngle360(d),{declination:f,rightAscension:d}},celestialToGeographic:function(n,o){if(!n)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingCelestialLocation"));if(o instanceof Date==!1)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingDate"));var a=this.computeJulianDate(o),s=a-2451545,l=i.normalizeAngle360(280.46061837+360.98564736629*s),u=i.normalizeAngle360(l-n.rightAscension),c=t.normalizedDegreesLongitude(-u);return{latitude:n.declination,longitude:c}},computeJulianDate:function(t){if(t instanceof Date==!1)throw new e(r.logMessage(r.LEVEL_SEVERE,"SunPosition","computeJulianDate","missingDate"));var i=t.getUTCFullYear(),n=t.getUTCMonth()+1,o=t.getUTCDate(),a=t.getUTCHours(),s=t.getUTCMinutes(),l=t.getUTCSeconds(),u=(a+s/60+l/3600)/24;n<=2&&(i-=1,n+=12);var c=Math.floor(i/100),h=2-c+Math.floor(c/4),f=Math.floor(365.25*(i+4716))+Math.floor(30.6001*(n+1))+o+h-1524.5;return f+u}};return n}),define("worldwind/layer/StarFieldLayer",["./Layer","../util/Logger","../geom/Matrix","../shaders/StarFieldProgram","../util/SunPosition"],function(t,e,r,i,n){"use strict";var o=function(e){t.call(this,"StarField"),this.pickEnabled=!1,this.sunSize=128,this.showSun=!0,this._starDataSource=e||WorldWind.configuration.baseUrl+"images/stars.json",this._sunImageSource=WorldWind.configuration.baseUrl+"images/sunTexture.png",this._matrix=r.fromIdentity(),this._starsPositionsVboCacheKey=null,this._numStars=0,this._starData=null,this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE,this._loadStarted=!1,this._minScale=1e7,this._sunPositionsCacheKey="",this._sunBufferView=new Float32Array(4),this._MAX_GL_POINT_SIZE=0};return o.prototype=Object.create(t.prototype),Object.defineProperties(o.prototype,{starDataSource:{get:function(){return this._starDataSource},set:function(t){this._starDataSource=t,this.invalidateStarData()}},sunImageSource:{get:function(){return this._sunImageSource},set:function(t){this._sunImageSource=t}}}),o.prototype.doRender=function(t){if(!t.globe.is2D()){if(!this.haveResources(t))return void this.loadResources(t);this.beginRendering(t);try{this.doDraw(t)}finally{this.endRendering(t)}}},o.prototype.haveResources=function(t){var e=t.gpuResourceCache.resourceForKey(this._sunImageSource);return null!=this._starData&&null!=e},o.prototype.loadResources=function(t){var e=t.currentGlContext,r=t.gpuResourceCache;this._starData||this.fetchStarData();var i=r.resourceForKey(this._sunImageSource);i||r.retrieveTexture(e,this._sunImageSource)},o.prototype.beginRendering=function(t){var e=t.currentGlContext;t.findAndBindProgram(i),e.enableVertexAttribArray(0),e.depthMask(!1)},o.prototype.doDraw=function(t){this.loadCommonUniforms(t),this.renderStars(t),this.showSun&&this.renderSun(t)},o.prototype.loadCommonUniforms=function(t){var e=t.currentGlContext,r=t.currentProgram,i=t.navigatorState.eyePoint,o=t.globe.computePositionFromPoint(i[0],i[1],i[2],{}),a=Math.max(1.5*o.altitude,this._minScale);this._matrix.copy(t.navigatorState.modelviewProjection),this._matrix.multiplyByScale(a,a,a),r.loadModelviewProjection(e,this._matrix);var s=n.computeJulianDate(this.time||new Date);r.loadNumDays(e,s-2451545)},o.prototype.renderStars=function(t){var e=t.currentGlContext,r=t.gpuResourceCache,i=t.currentProgram;this._starsPositionsVboCacheKey||(this._starsPositionsVboCacheKey=r.generateCacheKey());var n=r.resourceForKey(this._starsPositionsVboCacheKey);if(n)e.bindBuffer(e.ARRAY_BUFFER,n);else{n=e.createBuffer();var o=this.createStarsGeometry();r.putResource(this._starsPositionsVboCacheKey,n,4*o.length),e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW)}t.frameStatistics.incrementVboLoadCount(1),e.vertexAttribPointer(0,4,e.FLOAT,!1,0,0),i.loadMagnitudeRange(e,this._minMagnitude,this._maxMagnitude),i.loadTextureEnabled(e,!1),e.drawArrays(e.POINTS,0,this._numStars)},o.prototype.renderSun=function(t){var r=t.currentGlContext,i=t.currentProgram,o=t.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&e.log(e.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE);var a=n.getAsCelestialLocation(this.time||new Date);this._sunBufferView[0]=a.declination,this._sunBufferView[1]=a.rightAscension,this._sunBufferView[2]=Math.min(this.sunSize,this._MAX_GL_POINT_SIZE),this._sunBufferView[3]=1,this._sunPositionsCacheKey||(this._sunPositionsCacheKey=o.generateCacheKey());var s=o.resourceForKey(this._sunPositionsCacheKey);s?(r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferSubData(r.ARRAY_BUFFER,0,this._sunBufferView)):(s=r.createBuffer(),o.putResource(this._sunPositionsCacheKey,s,4*this._sunBufferView.length),r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferData(r.ARRAY_BUFFER,this._sunBufferView,r.DYNAMIC_DRAW)),t.frameStatistics.incrementVboLoadCount(1),r.vertexAttribPointer(0,4,r.FLOAT,!1,0,0),i.loadTextureEnabled(r,!0);var l=t.gpuResourceCache.resourceForKey(this._sunImageSource);l.bind(t),r.drawArrays(r.POINTS,0,1)},o.prototype.endRendering=function(t){var e=t.currentGlContext;e.depthMask(!0),e.disableVertexAttribArray(0)},o.prototype.fetchStarData=function(){if(!this._loadStarted){this._loadStarted=!0;var t=this,r=new XMLHttpRequest;r.onload=function(){if(this.status>=200&&this.status<300)try{t._starData=JSON.parse(this.response),t.sendRedrawRequest()}catch(t){e.log(e.LEVEL_SEVERE,"StarFieldLayer unable to parse JSON for star data "+t.toString())}else e.log(e.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data. Status: "+this.status+" "+this.statusText);t._loadStarted=!1},r.onerror=function(){e.log(e.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data"),t._loadStarted=!1},r.ontimeout=function(){e.log(e.LEVEL_SEVERE,"StarFieldLayer fetch star data has timeout"),t._loadStarted=!1},r.open("GET",this._starDataSource,!0),r.send()}},o.prototype.createStarsGeometry=function(){var t=this.parseStarsMetadata(this._starData.metadata);if(t.raIndex===-1)throw new Error(e.logMessage(e.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing ra field in star data."));if(t.decIndex===-1)throw new Error(e.logMessage(e.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing dec field in star data."));if(t.magIndex===-1)throw new Error(e.logMessage(e.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing vmag field in star data."));var r=this._starData.data,i=[];this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE;for(var n=0,o=r.length;n<o;n++){var a=r[n],s=a[t.decIndex],l=a[t.raIndex],u=a[t.magIndex],c=u<2?2:1;i.push(s,l,c,u),this._minMagnitude=Math.min(this._minMagnitude,u),this._maxMagnitude=Math.max(this._maxMagnitude,u)}return this._numStars=Math.floor(i.length/4),i},o.prototype.parseStarsMetadata=function(t){for(var e=-1,r=-1,i=-1,n=0,o=t.length;n<o;n++){var a=t[n];"ra"===a.name&&(e=n),"dec"===a.name&&(r=n),"vmag"===a.name&&(i=n)}return{raIndex:e,decIndex:r,magIndex:i}},o.prototype.invalidateStarData=function(){this._starData=null,this._starsPositionsVboCacheKey=null},o.prototype.sendRedrawRequest=function(){var t=document.createEvent("Event");t.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(t)},o}),define("worldwind/shapes/SurfaceEllipse",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,n,a,l){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"SurfaceEllipse","constructor","missingLocation"));if(r<0||n<0)throw new e(i.logMessage(i.LEVEL_SEVERE,"SurfaceEllipse","constructor","Radius is negative."));o.call(this,l),this._center=t,this._majorRadius=r,this._minorRadius=n,this._heading=a,this._intervals=s.DEFAULT_NUM_INTERVALS};return s.prototype=Object.create(o.prototype),Object.defineProperties(s.prototype,{center:{get:function(){return this._center},set:function(t){this.stateKeyInvalid=!0,this._center=t}},majorRadius:{get:function(){return this._majorRadius},set:function(t){this.stateKeyInvalid=!0,this._majorRadius=t}},minorRadius:{get:function(){return this._minorRadius},set:function(t){this.stateKeyInvalid=!0,this._minorRadius=t}},heading:{get:function(){return this._heading},set:function(t){this.stateKeyInvalid=!0,this._heading=t}},intervals:{get:function(){return this._intervals},set:function(t){this.stateKeyInvalid=!0,this._intervals=t}}}),s.staticStateKey=function(t){var e=o.staticStateKey(t);return e+" ce "+t.center.toString()+" ma "+t.majorRadius.toString()+" mi "+t.minorRadius.toString()+" he "+t.heading.toString()+" in "+t.intervals.toString()},s.prototype.computeStateKey=function(){return s.staticStateKey(this)},s.prototype.computeBoundaries=function(e){if(0==this.majorRadius&&0==this.minorRadius)return null;var i=e.globe,n=1+Math.max(s.MIN_NUM_INTERVALS,this.intervals),o=2*Math.PI/(n-1),l=i.radiusAt(this.center.latitude,this.center.longitude);this._boundaries=new Array(n);for(var u=0;u<n;u++){var c=u!=n-1?u*o:0,h=this.majorRadius*Math.cos(c),f=this.minorRadius*Math.sin(c),d=Math.sqrt(h*h+f*f),p=Math.PI/2-(Math.acos(h/d)*a.signum(f)-this.heading*t.DEGREES_TO_RADIANS);this._boundaries[u]=r.greatCircleLocation(this.center,p*t.RADIANS_TO_DEGREES,d/l,new r(0,0))}},s.MIN_NUM_INTERVALS=8,s.DEFAULT_NUM_INTERVALS=64,s}),define("worldwind/shapes/SurfaceCircle",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceEllipse"],function(t,e,r,i){"use strict";var n=function(r,n,o){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceCircle","constructor","missingLocation"));if(n<0)throw new t(e.logMessage(e.LEVEL_SEVERE,"SurfaceCircle","constructor","Radius is negative"));i.call(this,r,n,n,0,o),this._radius=n};return n.prototype=Object.create(i.prototype),Object.defineProperties(n.prototype,{radius:{get:function(){return this._radius},set:function(t){this.stateKeyInvalid=!0,this._radius=t}}}),n.staticStateKey=function(t){var e=i.staticStateKey(t);return e+" ra "+t.radius.toString()},n.prototype.computeStateKey=function(){return n.staticStateKey(this)},n}),define("worldwind/shapes/SurfaceRectangle",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape","../util/WWMath"],function(t,e,r,i,n,o,a){"use strict";var s=function(t,r,n,a,s){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"SurfaceRectangle","constructor","missingLocation"));if(r<0||n<0)throw new e(i.logMessage(i.LEVEL_SEVERE,"SurfaceRectangle","constructor","Size is negative."));o.call(this,s),this._center=t,this._width=r,this._height=n,this._heading=a};return s.prototype=Object.create(o.prototype),Object.defineProperties(s.prototype,{center:{get:function(){return this._center},set:function(t){this.stateKeyInvalid=!0,this._center=t}},width:{get:function(){return this._width},set:function(t){this.stateKeyInvalid=!0,this._width=t}},height:{get:function(){return this._height},set:function(t){this.stateKeyInvalid=!0,this._height=t}},heading:{get:function(){return this._heading},set:function(t){this.stateKeyInvalid=!0,this._heading=t}}}),s.staticStateKey=function(t){var e=o.staticStateKey(t);return e+" ce "+t.center.toString()+" wi "+t.width.toString()+" he "+t.height.toString()+" hd "+t.heading.toString()},s.prototype.computeStateKey=function(){return s.staticStateKey(this)},s.prototype.computeBoundaries=function(t){var e=.5*this.width,r=.5*this.height,i=t.globe.radiusAt(this.center.latitude,this.center.longitude);this._boundaries=new Array(4),this.addLocation(0,-e,-r,i),this.addLocation(1,e,-r,i),this.addLocation(2,e,r,i),this.addLocation(3,-e,r,i)},s.prototype.addLocation=function(e,i,n,o){var s=Math.sqrt(i*i+n*n),l=Math.PI/2-(Math.acos(i/s)*a.signum(n)-this.heading*t.DEGREES_TO_RADIANS);this._boundaries[e]=r.greatCircleLocation(this.center,l*t.RADIANS_TO_DEGREES,s/o,new r(0,0))},s}),define("worldwind/render/SurfaceRenderable",["../util/Logger","../error/UnsupportedOperationError"],function(t,e){"use strict";var r=function(){throw this.displayName="Renderable",this.enabled=!0,new e(t.logMessage(t.LEVEL_SEVERE,"SurfaceRenderable","constructor","abstractInvocation"))};return r.prototype.renderSurface=function(r){throw new e(t.logMessage(t.LEVEL_SEVERE,"SurfaceRenderable","renderSurface","abstractInvocation"))},r}),define("worldwind/shapes/SurfaceSector",["../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(t,e,r,i,n){"use strict";var o=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"SurfaceSector","constructor","missingSector"));n.call(this,i),this._sector=e};return o.prototype=Object.create(n.prototype),o.staticStateKey=function(t){var e=n.staticStateKey(t);return e},o.prototype.computeStateKey=function(){return o.staticStateKey(this)},o.prototype.computeBoundaries=function(t){var r=this._sector;this._boundaries=new Array(4),this._boundaries[0]=new e(r.minLatitude,r.minLongitude),this._boundaries[1]=new e(r.maxLatitude,r.minLongitude),this._boundaries[2]=new e(r.maxLatitude,r.maxLongitude),this._boundaries[3]=new e(r.minLatitude,r.maxLongitude)},o}),define("worldwind/gesture/TapRecognizer",["../gesture/GestureRecognizer"],function(t){"use strict";var e=function(e,r){t.call(this,e,r),this.numberOfTaps=1,this.numberOfTouches=1,this.maxTouchMovement=20,this.maxTapDuration=500,this.maxTapInterval=400,this.taps=[],this.timeout=null};return e.prototype=Object.create(t.prototype),e.prototype.reset=function(){t.prototype.reset.call(this),this.taps=[],this.cancelFailAfterDelay()},e.prototype.mouseDown=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.touchStart=function(t){if(this.state==WorldWind.POSSIBLE){var e;this.touchCount>this.numberOfTouches?this.state=WorldWind.FAILED:1==this.touchCount?(e={touchCount:this.touchCount,clientX:this.clientX,clientY:this.clientY},this.taps.push(e),this.failAfterDelay(this.maxTapDuration)):(e=this.taps[this.taps.length-1],e.touchCount=this.touchCount,e.clientX=this.clientX,e.clientY=this.clientY)}},e.prototype.touchMove=function(t){if(this.state==WorldWind.POSSIBLE){var e=this.translationX,r=this.translationY,i=Math.sqrt(e*e+r*r);i>this.maxTouchMovement&&(this.state=WorldWind.FAILED)}},e.prototype.touchEnd=function(t){if(this.state==WorldWind.POSSIBLE&&0==this.touchCount){var e=this.taps.length,r=this.taps[e-1];r.touchCount!=this.numberOfTouches?this.state=WorldWind.FAILED:e==this.numberOfTaps?(this.clientX=this.taps[0].clientX,this.clientY=this.taps[0].clientY,this.state=WorldWind.RECOGNIZED):this.failAfterDelay(this.maxTapInterval)}},e.prototype.touchCancel=function(t){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},e.prototype.failAfterDelay=function(t){var e=this;e.timeout&&window.clearTimeout(e.timeout),e.timeout=window.setTimeout(function(){e.timeout=null,e.state==WorldWind.POSSIBLE&&(e.state=WorldWind.FAILED)},t)},e.prototype.cancelFailAfterDelay=function(){var t=this;t.timeout&&(window.clearTimeout(t.timeout),t.timeout=null)},e}),define("worldwind/layer/TectonicPlatesLayer",["../error/ArgumentError","../util/Color","../geom/Location","../util/Logger","../layer/RenderableLayer","../shapes/ShapeAttributes","../shapes/SurfacePolygon"],function(t,e,r,i,n,o,a){"use strict";var s=function(t){n.call(this,"Tectonic Plates"),t?this._attributes=t:(this._attributes=new o(null),this._attributes.drawInterior=!1,this._attributes.drawOutline=!0,this._attributes.outlineColor=e.RED),this.loadPlateData()};return s.prototype=Object.create(n.prototype),Object.defineProperties(a.prototype,{attributes:{get:function(){return this._attributes},set:function(t){t&&this.renderables.map(function(e,r,i){e.attributes=t})}}}),s.prototype.loadPlateData=function(){var t="http://worldwindserver.net/webworldwind/data/TectonicPlates.json",e=new XMLHttpRequest;e.open("GET",t,!0),e.onreadystatechange=function(){4===e.readyState&&(200===e.status?this.parse(e.responseText):i.log(i.LEVEL_WARNING,"Tectonic plate data retrieval failed ("+e.statusText+"): "+t))}.bind(this),e.onerror=function(){i.log(i.LEVEL_WARNING,"Tectonic plate data retrieval failed: "+t)},e.ontimeout=function(){i.log(i.LEVEL_WARNING,"Tectonic plate data retrieval timed out: "+t)},e.send(null)},s.prototype.parse=function(t){var e=JSON.parse(t),i=this;e.features.map(function(t,e,n){var o=[];t.geometry.coordinates.map(function(t,e,i){o.push(new r(t[1],t[0]))});var s=new a(o,i._attributes);i.addRenderable(s)})},s}),define("worldwind/util/TileFactory",["../util/Logger","../error/UnsupportedOperationError"],function(t,e){"use strict";var r=function(){};return r.prototype.createTile=function(r,i,n,o){throw new e(t.logMessage(t.LEVEL_SEVERE,"TileFactory","createTile","abstractInvocation"))},r}),define("worldwind/shapes/TriangleMesh",["../shapes/AbstractMesh","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolygon","../geom/Vec2","../geom/Vec3"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p){"use strict";var g=function(r,i,n){if(!r)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","missingPositions"));if(r.length<1)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","missingPositions"));if(r.length>65536)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","Too many positions. Must be fewer than 65537. Use TriangleMesh.split to split the shape."));if(!i)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","Indices array is null or undefined"));if(i.length<3)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","Too few indices."));t.call(this,n),this._positions=r,this._indices=i,this.referencePosition=this._positions[0]};return g.prototype=Object.create(t.prototype),Object.defineProperties(g.prototype,{positions:{get:function(){return this._positions},set:function(t){if(!t)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","positions","missingPositions"));this._positions=t,this.referencePosition=this._positions[0],this.reset()}},indices:{get:function(){return this._indices},set:function(t){if(!t)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","indices","Indices array is null or undefined"));this._indices=t,this.meshIndices=null,this.reset()}},outlineIndices:{get:function(){return this._outlineIndices},set:function(t){this._outlineIndices=t,this.meshOutlineIndices=null,this.reset()}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(t){if(t&&t.length!=this._positions.length)throw new e(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","textureCoordinates","Number of texture coordinates is inconsistent with the currently specified positions."));this._textureCoordinates=t,this.reset(),this.texCoords=null}}}),g.prototype.createSurfaceShape=function(){if(this._outlineIndices){for(var t=[],e=0;e<this._outlineIndices.length;e++)t.push(this._positions[this._outlineIndices[e]]);return new f(t,null)}return null},g.prototype.computeMeshPoints=function(t,e){for(var r,i,n=Number.MAX_VALUE,o=t.navigatorState.eyePoint,a=new Float32Array(3*this._positions.length),s=new p(0,0,0),l=0,u=0;u<this._positions.length;u++)r=this._positions[u],t.surfacePointForMode(r.latitude,r.longitude,r.altitude*this._altitudeScale,this.altitudeMode,s),i=s.distanceToSquared(o),i<n&&(n=i),s.subtract(this.currentData.referencePoint),a[l++]=s[0],a[l++]=s[1],a[l++]=s[2];return e.eyeDistance=Math.sqrt(n),a},g.prototype.computeTexCoords=function(){if(this._textureCoordinates){for(var t=new Float32Array(2*this._textureCoordinates.length),e=0,r=0,i=this._textureCoordinates.length;r<i;r++){var n=this._textureCoordinates[r];t[e++]=n[0],t[e++]=n[1]}return t}return null},g.prototype.computeMeshIndices=function(){for(var t=new Uint16Array(this._indices.length),e=0,r=this._indices.length;e<r;e++)t[e]=this._indices[e];return t},g.prototype.computeOutlineIndices=function(){if(this._outlineIndices){for(var t=new Uint16Array(this._outlineIndices.length),e=0;e<this._outlineIndices.length;e++)t[e]=this._outlineIndices[e];return t}return null},g.split=function(t,e,r,i){for(var n,o,a=[],s=[],l=[],u=[],c=[],h=0;h<=e.length;h++){if(h===e.length||a.length>65533&&l.length%3===0){if(a.length>0){var f={positions:a,indices:l};if(r&&(f.textureCoords=s),i){for(var d=[],p=0;p<i.length;p++)n=i[p],o=u[n],o&&d.push(u[i[p]]);f.outlineIndices=d}c.push(f)}if(h===e.length)break;a=[],l=[],u=[]}n=e[h],o=u[n],o||(o=a.length,u[n]=o,a.push(t[n]),r&&s.push(r[n])),l.push(o)}return c},g}),define("worldwind/layer/ViewControlsLayer",["../geom/Angle","../error/ArgumentError","../layer/Layer","../geom/Location","../navigate/LookAt","../util/Logger","../util/Offset","../shapes/ScreenImage","../geom/Vec2","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u){"use strict";var c=function(t){if(!t)throw new e(o.logMessage(o.LEVEL_SEVERE,"ViewControlsLayer","constructor","missingWorldWindow"));r.call(this,"View Controls"),this.wwd=t,this.placement=new a(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0),this.alignment=new a(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0),this.exaggerationIncrement=.01,this.zoomIncrement=.04,this.headingIncrement=1,this.tiltIncrement=1,this.fieldOfViewIncrement=.1,this.panIncrement=.001,this._inactiveOpacity=.5,this._activeOpacity=1;var i=new a(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0),n=WorldWind.configuration.baseUrl+"images/view/";this.panControl=new s(i.clone(),n+"view-pan-64x64.png"),this.zoomInControl=new s(i.clone(),n+"view-zoom-in-32x32.png"),this.zoomOutControl=new s(i.clone(),n+"view-zoom-out-32x32.png"),this.headingLeftControl=new s(i.clone(),n+"view-heading-left-32x32.png"),this.headingRightControl=new s(i.clone(),n+"view-heading-right-32x32.png"),this.tiltUpControl=new s(i.clone(),n+"view-pitch-up-32x32.png"),this.tiltDownControl=new s(i.clone(),n+"view-pitch-down-32x32.png"),this.exaggerationUpControl=new s(i.clone(),n+"view-elevation-up-32x32.png"),this.exaggerationDownControl=new s(i.clone(),n+"view-elevation-down-32x32.png"),this.fovNarrowControl=new s(i.clone(),n+"view-fov-narrow-32x32.png"),this.fovWideControl=new s(i.clone(),n+"view-fov-wide-32x32.png"),this.fovNarrowControl.enabled=!1,this.fovWideControl.enabled=!1,this.controls=[this.panControl,this.zoomInControl,this.zoomOutControl,this.headingLeftControl,this.headingRightControl,this.tiltUpControl,this.tiltDownControl,this.exaggerationUpControl,this.exaggerationDownControl,this.fovNarrowControl,this.fovWideControl];for(var u=0;u<this.controls.length;u++)this.controls[u].imageOffset=i.clone(),this.controls[u].opacity=this._inactiveOpacity,this.controls[u]===this.panControl?this.controls[u].size=64:this.controls[u].size=32;this.panControlCenter=new l(0,0),this.isTouchDevice=!1,this.pickEnabled=!1,this.setupInteraction()};return c.prototype=Object.create(r.prototype),Object.defineProperties(c.prototype,{showPanControl:{get:function(){return this.panControl.enabled},set:function(t){this.panControl.enabled=t}},showZoomControl:{get:function(){return this.zoomInControl.enabled},set:function(t){this.zoomInControl.enabled=t,this.zoomOutControl.enabled=t}},showHeadingControl:{get:function(){return this.headingLeftControl.enabled},set:function(t){this.headingLeftControl.enabled=t,this.headingRightControl.enabled=t}},showTiltControl:{get:function(){return this.tiltUpControl.enabled},set:function(t){this.tiltUpControl.enabled=t,this.tiltDownControl.enabled=t}},showExaggerationControl:{get:function(){return this.exaggerationUpControl.enabled},set:function(t){this.exaggerationUpControl.enabled=t,this.exaggerationDownControl.enabled=t}},showFieldOfViewControl:{get:function(){return this.fovNarrowControl.enabled},set:function(t){this.fovNarrowControl.enabled=t,this.fovWideControl.enabled=t}},inactiveOpacity:{get:function(){return this._inactiveOpacity},set:function(t){this._inactiveOpacity=t;for(var e=0;e<this.controls.length;e++)this.controls[e].opacity=t}},activeOpacity:{get:function(){return this._activeOpacity},set:function(t){this._activeOpacity=t;for(var e=0;e<this.controls.length;e++)this.controls[e].opacity=t}}}),c.prototype.doRender=function(t){var e,r,i,n,o=0,a=64;this.inCurrentFrame=!1,this.showPanControl&&(o+=this.panControl.size,this.inCurrentFrame=!0),this.showZoomControl&&(o+=this.zoomInControl.size,this.inCurrentFrame=!0),this.showHeadingControl&&(o+=this.headingLeftControl.size,this.inCurrentFrame=!0),this.showTiltControl&&(o+=this.tiltDownControl.size,this.inCurrentFrame=!0),this.showExaggerationControl&&(o+=this.exaggerationDownControl.size,this.inCurrentFrame=!0),this.showFieldOfViewControl&&(o+=this.fovNarrowControl.size,this.inCurrentFrame=!0),r=this.placement.offsetForSize(t.navigatorState.viewport.width,t.navigatorState.viewport.height),e=this.alignment.offsetForSize(o,a),i=r[0]-e[0],n=r[1]-e[1],this.showPanControl&&(this.panControl.screenOffset.x=i,this.panControl.screenOffset.y=n,this.panControl.render(t),this.panControlCenter[0]=i+this.panControl.size/2,this.panControlCenter[1]=n+this.panControl.size/2,i+=this.panControl.size),this.showZoomControl&&(this.zoomOutControl.screenOffset.x=i,this.zoomOutControl.screenOffset.y=n,this.zoomInControl.screenOffset.x=i,this.zoomInControl.screenOffset.y=n+this.zoomOutControl.size,this.zoomOutControl.render(t),this.zoomInControl.render(t),i+=this.zoomOutControl.size),this.showHeadingControl&&(this.headingRightControl.screenOffset.x=i,this.headingRightControl.screenOffset.y=n,this.headingLeftControl.screenOffset.x=i,this.headingLeftControl.screenOffset.y=n+this.headingLeftControl.size,this.headingRightControl.render(t),this.headingLeftControl.render(t),i+=this.headingLeftControl.size),this.showTiltControl&&(this.tiltDownControl.screenOffset.x=i,this.tiltDownControl.screenOffset.y=n,this.tiltUpControl.screenOffset.x=i,this.tiltUpControl.screenOffset.y=n+this.tiltDownControl.size,this.tiltDownControl.render(t),this.tiltUpControl.render(t),i+=this.tiltDownControl.size),this.showExaggerationControl&&(this.exaggerationDownControl.screenOffset.x=i,this.exaggerationDownControl.screenOffset.y=n,this.exaggerationUpControl.screenOffset.x=i,this.exaggerationUpControl.screenOffset.y=n+this.exaggerationDownControl.size,this.exaggerationUpControl.render(t),this.exaggerationDownControl.render(t),i+=this.exaggerationDownControl.size),
this.showFieldOfViewControl&&(this.fovNarrowControl.screenOffset.x=i,this.fovNarrowControl.screenOffset.y=n,this.fovWideControl.screenOffset.x=i,this.fovWideControl.screenOffset.y=n+this.fovNarrowControl.size,this.fovNarrowControl.render(t),this.fovWideControl.render(t))},c.prototype.setupInteraction=function(){var t=this.wwd,e=this,r=function(r){if(e.enabled&&!e.isTouchDevice){var i,n;e.highlightedControl&&(e.highlight(e.highlightedControl,!1),e.wwd.redraw()),r.type&&"mouseup"===r.type&&1===r.which&&e.activeControl?(e.activeControl=null,e.activeOperation=null,r.preventDefault()):(e.activeOperation?(e.activeOperation.call(e,r,null),r.preventDefault()):(i=e.pickControl(t.canvasCoordinates(r.clientX,r.clientY)),n=e.determineOperation(r,i),n&&n.call(e,r,i)),e.handleHighlight(r,i),e.wwd.redraw())}};t.addEventListener("mousedown",r),t.addEventListener("mouseup",r),t.addEventListener("mousemove",r),window.addEventListener("mouseup",r),window.addEventListener("mousemove",r);var i=function(r){if(this.isTouchDevice=!0,e.enabled){if(e.highlightedControl&&(e.highlight(e.highlightedControl,!1),e.wwd.redraw()),!r.type||"touchend"!==r.type&&"touchcancel"!==r.type)if(e.activeOperation)e.activeOperation.call(e,r,null),r.preventDefault();else{var i,n,o=r.changedTouches.item(0);i=e.pickControl(t.canvasCoordinates(o.clientX,o.clientY)),n=e.determineOperation(r,i),n&&n.call(e,r,i)}else e.activeControl&&e.isCurrentTouch(r)&&(e.activeControl=null,e.activeOperation=null,r.preventDefault());e.handleHighlight(r,i),e.wwd.redraw()}};t.addEventListener("touchstart",i),t.addEventListener("touchend",i),t.addEventListener("touchcancel",i),t.addEventListener("touchmove",i)},c.prototype.isControl=function(t){for(var e=0;e<this.controls.length;e++)if(this.controls[e]==t)return!0;return!1},c.prototype.pickControl=function(t){for(var e,r=t[0],i=this.wwd.canvas.height-t[1],n=0;n<this.controls.length;n++)if(e=this.controls[n],e.enabled&&r>=e.screenOffset.x&&r<=e.screenOffset.x+e.size&&i>=e.screenOffset.y&&i<=e.screenOffset.y+e.size)return e;return null},c.prototype.determineOperation=function(t,e){var r=null;return e&&e instanceof s&&(e===this.panControl?r=this.handlePan:e===this.zoomInControl||e===this.zoomOutControl?r=this.handleZoom:e===this.headingLeftControl||e===this.headingRightControl?r=this.handleHeading:e===this.tiltUpControl||e===this.tiltDownControl?r=this.handleTilt:e===this.exaggerationUpControl||e===this.exaggerationDownControl?r=this.handleExaggeration:e!==this.fovNarrowControl&&e!==this.fovWideControl||(r=this.handleFov)),r},c.prototype.isCurrentTouch=function(t){for(var e=0;e<t.changedTouches.length;e++)if(t.changedTouches.item(e).identifier===this.currentTouchId)return!0;return!1},c.prototype.handlePan=function(e,r){if("mousedown"===e.type||"mousemove"===e.type)this.currentEventPoint=this.wwd.canvasCoordinates(e.clientX,e.clientY);else if("touchstart"===e.type||"touchmove"===e.type){var o=e.changedTouches.item(0);this.currentEventPoint=this.wwd.canvasCoordinates(o.clientX,o.clientY)}if("mousedown"===e.type&&1===e.which||"touchstart"===e.type){this.activeControl=r,this.activeOperation=this.handlePan,e.preventDefault(),"touchstart"===e.type&&(this.currentTouchId=e.changedTouches.item(0).identifier);var a=new n;this.wwd.navigator.getAsLookAt(this.wwd.globe,a);var s=this,l=function(){if(s.activeControl){var e=s.panControlCenter[0]-s.currentEventPoint[0],r=s.panControlCenter[1]-(s.wwd.viewport.height-s.currentEventPoint[1]),n=a.latitude,o=a.longitude,u=s.panIncrement*(a.range/s.wwd.globe.radiusAt(n,o)),c=a.heading+Math.atan2(e,r)*t.RADIANS_TO_DEGREES,h=u*Math.sqrt(e*e+r*r);i.greatCircleLocation(a,c,-h,a),s.wwd.navigator.setAsLookAt(s.wwd.globe,a),s.wwd.redraw(),setTimeout(l,50)}};setTimeout(l,50)}},c.prototype.handleZoom=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleZoom,t.preventDefault();var r=new n;this.wwd.navigator.getAsLookAt(this.wwd.globe,r),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var i=this,o=function(){i.activeControl&&(i.activeControl===i.zoomInControl?r.range*=1-i.zoomIncrement:i.activeControl===i.zoomOutControl&&(r.range*=1+i.zoomIncrement),i.wwd.navigator.setAsLookAt(i.wwd.globe,r),i.wwd.redraw(),setTimeout(o,50))};setTimeout(o,50)}},c.prototype.handleHeading=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleHeading,t.preventDefault();var r=new n;this.wwd.navigator.getAsLookAt(this.wwd.globe,r),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var i=this,o=function(){i.activeControl&&(i.activeControl===i.headingLeftControl?r.heading+=i.headingIncrement:i.activeControl===i.headingRightControl&&(r.heading-=i.headingIncrement),i.wwd.navigator.setAsLookAt(i.wwd.globe,r),i.wwd.redraw(),setTimeout(o,50))};setTimeout(o,50)}},c.prototype.handleTilt=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleTilt,t.preventDefault();var r=new n;this.wwd.navigator.getAsLookAt(this.wwd.globe,r),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var i=this,o=function(){i.activeControl&&(i.activeControl===i.tiltUpControl?r.tilt=Math.max(0,r.tilt-i.tiltIncrement):i.activeControl===i.tiltDownControl&&(r.tilt=Math.min(90,r.tilt+i.tiltIncrement)),i.wwd.navigator.setAsLookAt(i.wwd.globe,r),i.wwd.redraw(),setTimeout(o,50))};setTimeout(o,50)}},c.prototype.handleExaggeration=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleExaggeration,t.preventDefault(),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var r=this,i=function(){r.activeControl&&(r.activeControl===r.exaggerationUpControl?r.wwd.verticalExaggeration+=r.exaggerationIncrement:r.activeControl===r.exaggerationDownControl&&(r.wwd.verticalExaggeration=Math.max(1,r.wwd.verticalExaggeration-r.exaggerationIncrement)),r.wwd.redraw(),setTimeout(i,50))};setTimeout(i,50)}},c.prototype.handleFov=function(t,e){if("mousedown"===t.type&&1===t.which||"touchstart"===t.type){this.activeControl=e,this.activeOperation=this.handleFov,t.preventDefault(),"touchstart"===t.type&&(this.currentTouchId=t.changedTouches.item(0).identifier);var r=this,i=function(){r.activeControl&&(r.activeControl===r.fovWideControl?r.wwd.navigator.fieldOfView=Math.max(90,r.wwd.navigator.fieldOfView+r.fieldOfViewIncrement):r.activeControl===r.fovNarrowControl&&(r.wwd.navigator.fieldOfView=Math.min(0,r.wwd.navigator.fieldOfView-r.fieldOfViewIncrement)),r.wwd.redraw(),setTimeout(i,50))};setTimeout(i,50)}},c.prototype.handleHighlight=function(t,e){this.activeControl?this.highlight(this.activeControl,!0):e&&this.isControl(e)&&this.highlight(e,!0)},c.prototype.highlight=function(t,e){t.opacity=e?this._activeOpacity:this._inactiveOpacity,e?this.highlightedControl=t:this.highlightedControl=null},c}),define("worldwind/util/WcsTileUrlBuilder",["../error/ArgumentError","../util/Logger"],function(t,e){"use strict";var r=function(r,i,n){if(!r||0===r.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsTileUrlBuilder","constructor","The WCS service address is missing."));if(!i||0===i.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsTileUrlBuilder","constructor","The WCS coverage name is missing."));this.serviceAddress=r,this.coverageName=i,this.wcsVersion=n&&n.length>0?n:"1.0.0",this.crs="EPSG:4326"};return r.prototype.urlForTile=function(i,n){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsUrlBuilder","urlForTile","missingTile"));if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsUrlBuilder","urlForTile","The coverage format is null or undefined."));var o=i.sector,a=r.fixGetCoverageString(this.serviceAddress);return a.search(/service=wcs/i)<0&&(a+="service=WCS"),a+="&request=GetCoverage",a=a+"&version="+this.wcsVersion,a=a+"&coverage="+this.coverageName,a=a+"&format="+n,a=a+"&width="+i.tileWidth,a=a+"&height="+i.tileHeight,a=a+"&crs="+this.crs,a+="&bbox=",a=a+o.minLongitude+","+o.minLatitude+",",a=a+o.maxLongitude+","+o.maxLatitude,a=a.replace(" ","%20")},r.fixGetCoverageString=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WcsTileUrlBuilder","fixGetCoverageString","The specified service address is null or undefined."));var i=r.indexOf("?");return i<0?r+="?":i!==r.length-1&&(i=r.search(/&$/),i<0&&(r+="&")),r},r}),define("worldwind/ogc/ows/OwsWfsConstraint",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsWfsConstraint","constructor","missingDomElement"));r.hasAttribute("name")&&(this.name=r.getAttribute("name"));for(var i=r.children||r.childNodes,n=0;n<i.length;n++){var o=i[n];if("AllowedValues"===o.localName)for(var a=o.children||o.childNodes,s=0;s<a.length;s++)"Value"===a[s].localName&&(this.allowedValues=this.allowedValues||[],this.allowedValues.push(a[s].textContent));else"DefaultValue"===o.localName?this.defaultValue=o.textContent:"NoValues"===o.localName&&(this.NoValues="true")}};return r}),define("worldwind/ogc/ows/OwsWfsOperationsMetadata",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsWfsConstraint"],function(t,e,r){"use strict";var i=function(n){if(!n)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsWfsOperationsMetadata","constructor","missingDomElement"));for(var o=n.children||n.childNodes,a=0;a<o.length;a++){var s=o[a];"Operation"===s.localName?(this.operation=this.operation||[],this.operation.push(i.prototype.assembleOperation(s))):"Constraint"===s.localName&&(this.Constraint=this.Constraint||[],this.Constraint.push(new r(s)))}};return i.prototype.assembleOperation=function(t){var e={};e.name=t.getAttribute("name");for(var n=t.children||t.childNodes,o=0;o<n.length;o++){var a=n[o];"DCP"===a.localName?(e.dcp=e.dcp||[],e.dcp.push(i.prototype.assembleDcp(a))):"Parameter"===a.localName?(e.Parameter=e.Parameter||[],e.Parameter.push(i.prototype.assembleParameterVal(a))):"Constraints"===a.localName&&(e.Constraints=e.Constraints||[],e.Constraints.push(new r(a)))}return e},i.prototype.assembleDcp=function(t){for(var e={},r=t.children||t.childNodes,n=0;n<r.length;n++){var o=r[n];if("HTTP"===o.localName)for(var a=o.children||o.childNodes,s=0;s<a.length;s++){var l=a[s];"Get"===l.localName?(e.getMethods=e.getMethods||[],e.getMethods.push(i.prototype.assembleMethod(l))):"Post"===l.localName&&(e.postMethods=e.postMethods||[],e.postMethods.push(i.prototype.assembleMethod(l)))}}return e},i.prototype.assembleMethod=function(t){var e={};e.url=t.getAttribute("xlink:href");for(var r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Constraint"===n.localName&&(e.constraint=e.constraint||[],e.constraint.push(new OwsConstraint(n)))}return e},i.prototype.assembleParameterVal=function(t){var e=t.children||t.childNodes,i={};i.name=t.getAttribute("name");for(var n=0;n<e.length;n++){var o=e[n];i.allowedValues=new r(o)}return i},i}),define("worldwind/ogc/ows/OwsLanguageString",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"LanguageString","constructor","missingDomElement"));this.value=r.textContent,this.lang;var i=r.getAttribute("lang");i&&(this.lang=i)};return r}),define("worldwind/ogc/ows/OwsDescription",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsLanguageString"],function(t,e,r){"use strict";var i=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsDescription","assembleDescriptions","missingDomElement"));for(var n=i.children||i.childNodes,o=0;o<n.length;o++){var a=n[o];if("Title"===a.localName)this.titles=this.titles||[],this.titles.push(new r(a));else if("Abstract"===a.localName)this.abstracts=this.abstracts||[],this.abstracts.push(new r(a));else if("Keywords"===a.localName){this.keywords=this.keywords||[];for(var s=a.children||a.childNodes,l=0;l<s.length;l++){var u=s[l];"Keyword"===u.localName&&this.keywords.push(new r(u))}}}};return i}),define("worldwind/ogc/ows/OwsWfsServiceIdentification",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsDescription"],function(t,e,r){"use strict";var i=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsWfsServiceIdentification","constructor","missingDomElement"));r.call(this,i);for(var n=i.children||i.childNodes,o=0;o<n.length;o++){var a=n[o];"ServiceType"===a.localName?this.serviceType=a.textContent:"ServiceTypeVersion"===a.localName?this.serviceTypeVersion=a.textContent:"Fees"===a.localName?this.fees=a.textContent:"AccessConstraints"===a.localName&&(this.accessConstraints=this.accessConstraints||[],this.accessConstraints.push(a.textContent))}};return i.prototype=Object.create(r.prototype),i}),define("worldwind/ogc/ows/OwsWfsServiceProvider",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","constructor","missingDomElement"));for(var n=i.children||i.childNodes,o=0;o<n.length;o++){var a=n[o];"ProviderName"===a.localName?this.providerName=a.textContent:"ServiceContact"===a.localName&&(this.serviceContact=r.assembleServiceContact(a))}};return r.assembleServiceContact=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assembleServiceContact","missingDomElement"));for(var n={},o=i.children||i.childNodes,a=0;a<o.length;a++){var s=o[a];"IndividualName"===s.localName?n.individualName=s.textContent:"PositionName"===s.localName?n.positionName=s.textContent:"ContactInfo"===s.localName&&(n.contactInfo=r.assembleContacts(s))}return n},r.assembleContacts=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assembleContacts","missingDomElement"));for(var n={},o=i.children||i.childNodes,a=0;a<o.length;a++){var s=o[a];"Phone"===s.localName?n.phone=r.assemblePhone(s):"Address"===s.localName&&(n.address=r.assembleAddress(s))}return n},r.assemblePhone=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assemblePhone","missingDomElement"));for(var i={},n=r.children||r.childNodes,o=0;o<n.length;o++){var a=n[o];"Voice"===a.localName?i.voice=a.textContent:"Facsimile"===a.localName&&(i.facsimile=a.textContent)}return i},r.assembleAddress=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assembleAddress","missingDomElement"));for(var i={},n=r.children||r.childNodes,o=0;o<n.length;o++){var a=n[o];"DeliveryPoint"===a.localName?(i.deliveryPoints=i.deliveryPoints||[],i.deliveryPoints.push(a.textContent)):"City"===a.localName?i.city=a.textContent:"AdministrativeArea"===a.localName?i.administrativeArea=a.textContent:"PostalCode"===a.localName?(i.postalCodes=i.postalCodes||[],i.postalCodes.push(a.textContent)):"Country"===a.localName?(i.countries=i.countries||[],i.countries.push(a.textContent)):"ElectronicMailAddress"===a.localName&&(i.electronicMailAddresses=i.electronicMailAddresses||[],i.electronicMailAddresses.push(a.textContent))}return i},r}),define("worldwind/ogc/ows/OwsWfsKeywords",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsLanguageString"],function(t,e,r){"use strict";var i=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsKeywords","constructor","missingDomElement"));var n=i.children||i.childNodes;if(1===n.length)this.keywords=i.textContent;else for(var o=0;o<n.length;o++){var a=n[o];"keyword"!==a.localName&&"Keyword"!==a.localName||(this.keywords=this.keywords||[],this.keywords.push(new r(a)))}};return i}),define("worldwind/ogc/wfs/WfsCapabilities",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsWfsOperationsMetadata","../../ogc/ows/OwsWfsServiceIdentification","../../ogc/ows/OwsWfsServiceProvider","../../ogc/ows/OwsWfsKeywords","../../ogc/ows/OwsWfsConstraint"],function(t,e,r,i,n,o,a){"use strict";var s=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WfsCapabilities","constructor","missingDom"));this.xmlDom=r,this.assembleDocument()};return s.prototype.assembleDocument=function(){var r=this.xmlDom.documentElement;if(this.version=r.getAttribute("version"),this.updateSequence=r.getAttribute("updateSequence"),"1.0.0"===this.version)this.assembleDocument100(r);else{if("1.1.0"!==this.version&&"2.0.0"!==this.version)throw new t(e.logMessage(e.LEVEL_SEVERE,"WfsCapabilities","assembleDocument","unsupportedVersion"));this.assembleDocument200x(r)}},s.prototype.assembleDocument100=function(t){for(var e=t.children||t.childNodes,r=0;r<e.length;r++){var i=e[r];"Service"===i.localName?this.Service=this.assembleService100(i):"Capability"===i.localName?this.capability=this.assembleCapability100(i):"FeatureTypeList"===i.localName?this.assembleFeatureType(i):"Filter_Capabilities"===i.localName&&(this.filterCapabilities=this.assembleContents100(i))}},s.prototype.assembleDocument200x=function(t){for(var e=t.children||t.childNodes,o=0;o<e.length;o++){var a=e[o];"ServiceIdentification"===a.localName?this.serviceWfsIdentification=new i(a):"ServiceProvider"===a.localName?this.serviceProvider=new n(a):"OperationsMetadata"===a.localName?this.operationsMetadata=new r(a):"FeatureTypeList"===a.localName?this.assembleFeatureType(a):"Filter_Capabilities"===a.localName&&(this.filterCapabilities=this.assembleFilterCapabilities(a))}},s.prototype.assembleFeatureType=function(t){for(var e=t.children||t.childNodes,r=0;r<e.length;r++){var i=e[r];"FeatureType"===i.localName?(this.featureType=this.featureType||[],this.featureType.push(this.assembleFeatureTypeAttributes(i))):"Operations"===i.localName&&(this.Operations=this.assembleOperations100(i))}},s.prototype.assembleOperations100=function(t){for(var e=t.children||t.childNodes,r=0;r<e.length;r++){var i=e[r];this.operations=this.operations||[],this.operations.push(i.localName)}},s.prototype.assembleContents100=function(t){for(var e=t.children||t.childNodes,r=0;r<e.length;r++){var i=e[r];"Spatial_Capabilities"===i.localName?this.spatialCapabilities=this.assembleSpatialCapabilities(i):"Scalar_Capabilities"===i.localName&&(this.scalarCapabilities=this.assembleScalarCapabilities(i))}},s.prototype.assembleSpatialCapabilities=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];"Spatial_Operators"===n.localName?r.spop=this.assembleOperator100(n):"GeometryOperands"===n.localName?r.geop=this.getOperatorName(n):"SpatialOperators"===n.localName&&(r.spop=this.getOperatorName(n))}return r},s.prototype.assembleOperator100=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];e.name=e.name||[],e.name.push(n.localName)}return e},s.prototype.assembleScalarCapabilities=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];"Logical_Operators"===n.localName?r.logicalOperators=n.localName:"Comparison_Operators"===n.localName?r.comparison_Operators=this.assembleOperator100(n):"Arithmetic_Operators"===n.localName?r.arithmetic_Operators=this.assembleArthmeticOperator(n):"ComparisonOperators"===n.localName?r.comparisonOperators=this.getOperatorName(n):"LogicalOperators"===n.localName?r.logicalOperators=n.localName:"ArithmeticOperators"===n.localName&&(r.arithmeticOperators=this.assembleArthmeticOperator(n))}return r},s.prototype.assembleArthmeticOperator=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];"Simple_Arithmetic"===n.localName?r.simpleArithmetic=n.localName:"Functions"===n.localName&&(r.functions=this.assembleFunction100(n))}return r},s.prototype.assembleFunction100=function(t){for(var e=t.children||t.childNodes,r={},i=e[0],n=i.children1||i.childNodes,o=0;o<n.length;o++){var a=n[o];r.functionName=r.functionName||[],r.functionName.push(this.nameArgument(a))}return r},s.prototype.nameArgument=function(t){var e={};return e.name=t.textContent,e.nArgs=t.getAttribute("nArgs"),e},s.prototype.assembleFeatureTypeAttributes=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];"Name"===n.localName?r.name=n.textContent:"Title"===n.localName?r.title=n.textContent:"Keywords"===n.localName?r.keywords=new o(n):"SRS"===n.localName?r.SRS=n.textContent:"LatLongBoundingBox"===n.localName?r.latLongBoundingBox=this.assembleLatLonBoundingBox(n):"Abstract"===n.localName?r.abstract=n.textContent:"KeywordList"===n.localName?r.keywordList=new o(n):"DefaultCRS"===n.localName?r.defaultCRS=n.textContent:"DefaultSRS"===n.localName?r.defaultSRS=n.textContent:"WGS84BoundingBox"===n.localName&&(r.wgs84BoundingBox=this.assembleBoundingBox(n))}return r},s.prototype.assembleLatLonBoundingBox=function(t){var e={};return e.minx=t.getAttribute("minx"),e.miny=t.getAttribute("miny"),e.maxx=t.getAttribute("maxx"),e.maxy=t.getAttribute("maxy"),e},s.prototype.assembleService100=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];"Name"===n.localName?r.name=n.textContent:"Title"===n.localName?r.title=n.textContent:"Abstract"===n.localName?r.abstract=n.textContent:"Keywords"===n.localName?r.keywords=n.textContent:"AccessConstraints"===n.localName?r.accessConstraints=n.textContent:"Fees"===n.localName?r.fees=n.textContent:"OnlineResource"===n.localName&&(r.onlineResource=n.textContent)}return r},s.prototype.assembleCapability100=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];"Request"===n.localName&&(r.request=this.assembleRequestCapabilities100(n))}return r},s.prototype.assembleRequestCapabilities100=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];r.name=r.name||[],r.name.push(n.localName),r.request=r.request||[],r.request.push(this.assembleDCPType100(n))}return r},s.prototype.assembleDCPType100=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];"DCPType"===n.localName?this.assembleHttp100(n,r):"ResultFormat"===n.localName?r.resultFormat=this.assembleResultFormat100(n):"SchemaDescriptionLanguage"===n.localName&&(r.schemaDescriptionLanguage=this.assembleSchemaDescriptionLanguage(n))}return r},s.prototype.assembleResultFormat100=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];e.resfom=e.resfom||[],e.resfom.push(n.localName)}return e},s.prototype.assembleSchemaDescriptionLanguage=function(t){var e={},r=t.children||t.childNodes,i=r[0];return e.name=i.localName,i.localName},s.prototype.assembleHttp100=function(t,e){for(var r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];if("HTTP"===n.localName)return this.assembleMethod100(n,e)}},s.prototype.assembleMethod100=function(t,e){for(var r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Get"===n.localName?e.get=this.assembleOnlineResource100(n):"Post"===n.localName&&(e.post=this.assembleOnlineResource100(n))}},s.prototype.assembleOnlineResource100=function(t){return t.getAttribute("onlineResource")},s.prototype.assembleBoundingBox=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];if("LowerCorner"===n.localName){var o=n.textContent.split(" ");e.lowerCorner=[parseFloat(o[0]),parseFloat(o[1])]}else if("UpperCorner"===n.localName){var a=n.textContent.split(" ");e.upperCorner=[parseFloat(a[0]),parseFloat(a[1])]}}return e},s.prototype.assembleFilterCapabilities=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Conformance"===n.localName?e.conformance=this.assembleConformance(n):"Id_Capabilities"===n.localName?e.idCap=this.assembleIdCapabilities(n):"Scalar_Capabilities"===n.localName?e.assCap=this.assembleScalarCapabilities(n):"Spatial_Capabilities"===n.localName?e.assSpCap=this.assembleSpatialCapabilities(n):"Temporal_Capabilities"===n.localName?e.temporalCap=this.assembleTemporalCapabilities(n):"Functions"===n.localName&&(e.func=this.assembleFunctions(n))}return e},s.prototype.assembleConformance=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];e.constraints=e.constraints||[],e.constraints.push(new a(n))}return e},s.prototype.assembleIdCapabilities=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];"ResourceIdentifier"===n.localName&&(r.resourceIdentifierName=r.resourceIdentifierName||[],r.resourceIdentifierName.push(n.getAttribute("name")))}return r},s.prototype.getOperatorName=function(t){for(var e,r=t.children||t.childNodes,i={},n=0;n<r.length;n++)e=r[n],e.textContent?(i.attributeName=i.attributeName||[],i.attributeName.push(e.textContent)):(i.attributeName=i.attributeName||[],i.attributeName.push(e.getAttribute("name")));return i},s.prototype.assembleTemporalCapabilities=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"TemporalOperands"===n.localName?e.temporalOperands=this.getOperatorName(n):"TemporalOperators"===n.localName&&(e.temporalOperator=this.getOperatorName(n))}return e},s.prototype.assembleFunctions=function(t){for(var e=t.children||t.childNodes,r={Name:[],subChild:[]},i=0;i<e.length;i++){var n=e[i];r.Name[i]=n.getAttribute("name"),r.subChild[i]=this.assembleFunctionsSubChild(n)}return r},s.prototype.assembleFunctionsSubChild=function(t){for(var e=t.children||t.childNodes,r={},i=0;i<e.length;i++){var n=e[i];"Returns"===n.localName?r.retValue=n.textContent:"Arguments"===n.localName&&(r.funcArg=this.assembleFunctionArguments(n))}return r},s.prototype.assembleFunctionArguments=function(t){for(var e=t.children||t.childNodes,r={name:[],type:[]},i=0;i<e.length;i++){var n=e[i];if("Argument"===n.localName){r.name[i]=n.getAttribute("name");var o=n.children||t.childNodes,a=o[0];r.type[i]=a.textContent}}return r},s}),define("worldwind/ogc/wms/WmsLayerCapabilities",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(r,i){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsLayerCapabilities","constructor","Layer element is null or undefined."));this.parent=i,this.layers,this.name,this.title,this.abstract,this.keywordList,this.identifiers,this.metadataUrls,this.dataUrls,this.featureListUrls,this.assembleLayer(r)};return Object.defineProperties(r.prototype,{capability:{get:function(){for(var t=this;t&&t instanceof r;)t=t.parent;return t}},queryable:{get:function(){return r.replace(this,"_queryable")}},cascaded:{get:function(){return r.replace(this,"_cascaded")}},opaque:{get:function(){return r.replace(this,"_opaque")}},noSubsets:{get:function(){return r.replace(this,"_noSubsets")}},fixedWidth:{get:function(){return r.replace(this,"_fixedWidth")}},fixedHeight:{get:function(){return r.replace(this,"_fixedHeight")}},styles:{get:function(){return r.accumulate(this,"_styles",[])}},crses:{get:function(){return r.accumulate(this,"_crses",[])}},srses:{get:function(){return r.accumulate(this,"_srses",[])}},geographicBoundingBox:{get:function(){return r.replace(this,"_geographicBoundingBox")}},latLonBoundingBox:{get:function(){return r.replace(this,"_latLonBoundingBox")}},boundingBoxes:{get:function(){return r.replace(this,"_boundingBoxes")}},dimensions:{get:function(){for(var t=[],e=this;e&&e instanceof r;)e._dimensions&&e._dimensions.length>0&&e._dimensions.forEach(function(e){var r=e.name,i=!0;t.forEach(function(t){t.name===r&&(i=!1)}),i&&t.push(e)}),e=e.parent;return t.length>0?t:void 0}},extents:{get:function(){for(var t=[],e=this;e&&e instanceof r;)e._extents&&e._extents.length>0&&e._extents.forEach(function(e){var r=e.name,i=!0;t.forEach(function(t){t.name===r&&(i=!1)}),i&&t.push(e)}),e=e.parent;return t.length>0?t:void 0}},attribution:{get:function(){return r.replace(this,"_attribution")}},authorityUrls:{get:function(){return r.accumulate(this,"_authorityUrls",[])}},minScaleDenominator:{get:function(){return r.replace(this,"_minScaleDenominator")}},maxScaleDenominator:{get:function(){return r.replace(this,"_maxScaleDenominator")}},scaleHint:{get:function(){return r.replace(this,"_scaleHint")}}}),r.prototype.style=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsLayerCapabilities","style","Style name is null or undefined."));var i=this.styles;if(!i)return null;for(var n,o=0,a=i.length;o<a;o++)if(n=i[o],n.name===r)return n},r.accumulate=function(t,e,i){for(;t&&t instanceof r;){var n=t[e];if(n)for(var o=0;o<n.length;o++)i.push(n[o]);t=t.parent}return i.length>0?i:null},r.replace=function(t,e){for(;t&&t instanceof r;){var i=t[e];if(i)return i;t=t.parent}},r.prototype.assembleLayer=function(t){var e,i;e=t.getAttribute("queryable"),e&&(this._queryable="1"===e||"true"===e),e=t.getAttribute("opaque"),e&&(this._opaque="1"===e||"true"===e),e=t.getAttribute("noSubsets"),e&&(this._noSubsets="1"===e||"true"===e),e=t.getAttribute("cascaded"),e&&(this._cascaded=parseInt("10")),e=t.getAttribute("fixedWidth"),e&&(this._fixedWidth=parseInt("10")),e=t.getAttribute("fixedHeight"),e&&(this._fixedHeight=parseInt("10"));var n=t.children||t.childNodes;for(i=0;i<n.length;i++){var o=n[i];if("Layer"===o.localName)this.layers||(this.layers=[]),this.layers.push(new r(o,this));else if("Name"===o.localName)this.name=o.textContent;else if("Title"===o.localName)this.title=o.textContent;else if("Abstract"===o.localName)this.abstract=o.textContent;else if("KeywordList"===o.localName){this.keywordList=this.keywordList||[];for(var a=o.children||o.childNodes,s=0;s<a.length;s++){var l=a[s];"Keyword"===l.localName&&this.keywordList.push(l.textContent)}}else"Style"===o.localName?(this._styles||(this._styles=[]),this._styles.push(r.assembleStyle(o))):"CRS"===o.localName?(this._crses||(this._crses=[]),this._crses.push(o.textContent)):"SRS"===o.localName?(this._srses||(this._srses=[]),this._srses.push(o.textContent)):"EX_GeographicBoundingBox"===o.localName?this._geographicBoundingBox=r.assembleGeographicBoundingBox(o):"LatLonBoundingBox"===o.localName?this._geographicBoundingBox=r.assembleLatLonBoundingBox(o):"BoundingBox"===o.localName?(this._boundingBoxes||(this._boundingBoxes=[]),this._boundingBoxes.push(r.assembleBoundingBox(o))):"Dimension"===o.localName?(this._dimensions||(this._dimensions=[]),this._dimensions.push(r.assembleDimension(o))):"Extent"===o.localName?(this._extents||(this._extents=[]),this._extents.push(r.assembleDimension(o))):"Attribution"===o.localName?this._attribution=r.assembleAttribution(o):"AuthorityURL"===o.localName?(this._authorityUrls||(this._authorityUrls=[]),this._authorityUrls.push(r.assembleAuthorityUrl(o))):"Identifier"===o.localName?(this.identifiers||(this.identifiers=[]),this.identifiers.push(r.assembleIdentifier(o))):"MetadataURL"===o.localName?(this.metadataUrls||(this.metadataUrls=[]),this.metadataUrls.push(r.assembleMetadataUrl(o))):"DataURL"===o.localName?(this.dataUrls||(this.dataUrls=[]),this.dataUrls.push(r.assembleUrl(o))):"FeatureListURL"===o.localName?(this.featureListUrls||(this.featureListUrls=[]),this.featureListUrls.push(r.assembleUrl(o))):"MinScaleDenominator"===o.localName?this._minScaleDenominator=parseFloat(o.textContent):"MaxScaleDenominator"===o.localName?this._maxScaleDenominator=parseFloat(o.textContent):"ScaleHint"===o.localName&&(this._scaleHint={},this._scaleHint.min=r.getFloatAttribute(o,"min"),this._scaleHint.max=r.getFloatAttribute(o,"max"))}},r.assembleStyle=function(t){for(var e={},i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Name"===o.localName?e.name=o.textContent:"Title"===o.localName?e.title=o.textContent:"Abstract"===o.localName?e.abstract=o.textContent:"LegendURL"===o.localName?(e.legendUrls||(e.legendUrls=[]),e.legendUrls.push(r.assembleLegendUrl(o))):"StyleSheetURL"===o.localName?e.styleSheetUrl=r.assembleUrl(o):"StyleURL"===o.localName&&(e.styleUrl=r.assembleUrl(o))}return e},r.assembleGeographicBoundingBox=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"westBoundLongitude"===n.localName?e.westBoundLongitude=parseFloat(n.textContent):"eastBoundLongitude"===n.localName?e.eastBoundLongitude=parseFloat(n.textContent):"southBoundLatitude"===n.localName?e.southBoundLatitude=parseFloat(n.textContent):"northBoundLatitude"===n.localName&&(e.northBoundLatitude=parseFloat(n.textContent));
}return e},r.assembleLatLonBoundingBox=function(t){var e={};return e.minx=r.getFloatAttribute(t,"minx"),e.miny=r.getFloatAttribute(t,"miny"),e.maxx=r.getFloatAttribute(t,"maxx"),e.maxy=r.getFloatAttribute(t,"maxy"),e},r.assembleBoundingBox=function(t){var e={};return e.crs=t.getAttribute("CRS"),e.minx=r.getFloatAttribute(t,"minx"),e.miny=r.getFloatAttribute(t,"miny"),e.maxx=r.getFloatAttribute(t,"maxx"),e.maxy=r.getFloatAttribute(t,"maxy"),e.resx=r.getFloatAttribute(t,"resx"),e.resy=r.getFloatAttribute(t,"resy"),e},r.assembleDimension=function(t){var e={};return e.name=t.getAttribute("name"),e.units=t.getAttribute("units"),e.unitSymbol=t.getAttribute("unitSymbol"),e.default=t.getAttribute("default"),e.multipleValues=t.getAttribute("multipleValues"),e.multipleValues&&(e.multipleValues="true"===e.multipleValues||"1"===e.multipleValues),e.nearestValue=t.getAttribute("nearestValue"),e.nearestValue&&(e.nearestValue="true"===e.nearestValue||"1"===e.nearestValue),e.current=t.getAttribute("current"),e.current&&(e.current="true"===e.current||"1"===e.current),e.content=t.textContent,e},r.assembleAttribution=function(t){for(var e={},i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Title"===o.localName?e.title=o.textContent:"OnlineResource"===o.localName?e.url=o.getAttribute("xlink:href"):"LogoUrul"===o.localName&&(e.logoUrl=r.assembleLogoUrl(o))}return e},r.assembleAuthorityUrl=function(t){var e={};e.name=t.getAttribute("name");for(var r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"OnlineResource"===n.localName&&(e.url=n.getAttribute("xlink:href"))}return e},r.assembleIdentifier=function(t){var e={};return e.authority=t.getAttribute("authority"),e.content=t.textContent,e},r.assembleMetadataUrl=function(t){var e={};e.type=t.getAttribute("type");for(var r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Format"===n.localName?e.format=n.textContent:"OnlineResource"===n.localName&&(e.url=n.getAttribute("xlink:href"))}return e},r.assembleLegendUrl=function(t){var e={};e.width=r.getIntegerAttribute(t,"width"),e.height=r.getIntegerAttribute(t,"height");for(var i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Format"===o.localName?e.format=o.textContent:"OnlineResource"===o.localName&&(e.url=o.getAttribute("xlink:href"))}return e},r.assembleLogoUrl=function(t){var e={};e.width=r.getIntegerAttribute(t,"width"),e.height=r.getIntegerAttribute(t,"height");for(var i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Format"===o.localName?e.format=o.textContent:"OnlineResource"===o.localName&&(e.url=o.getAttribute("xlink:href"))}return e},r.assembleUrl=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Format"===n.localName?e.format=n.textContent:"OnlineResource"===n.localName&&(e.url=n.getAttribute("xlink:href"))}return e},r.getIntegerAttribute=function(t,e){var r=t.getAttribute(e);return r=r?parseInt(r):void 0},r.getFloatAttribute=function(t,e){var r=t.getAttribute(e);return r=r?parseFloat(r):void 0},r}),define("worldwind/ogc/wms/WmsCapabilities",["../../error/ArgumentError","../../util/Logger","../../ogc/wms/WmsLayerCapabilities"],function(t,e,r){"use strict";var i=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(r)};return i.prototype.getNamedLayers=function(){return this.accumulateNamedLayers(this.capability.layers)},i.prototype.accumulateNamedLayers=function(t,e){var r=e||[];if(!t)return r;for(var i=0,n=t.length;i<n;i++){var o=t[i];o.name&&r.push(o),o.layers&&this.accumulateNamedLayers(o.layers,r)}return r},i.prototype.getNamedLayer=function(r){if(!r||0===r.length)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmsCapabilities","getNamedLayer","No WMS layer name provided."));for(var i=this.getNamedLayers(),n=0,o=i.length;n<o;n++)if(r===i[n].name)return i[n];return null},i.prototype.assembleDocument=function(t){var e=t.documentElement;this.version=e.getAttribute("version"),this.updateSequence=e.getAttribute("updateSequence");for(var r=e.children||e.childNodes,i=0;i<r.length;i++){var n=r[i];"Service"===n.localName?this.service=this.assembleService(n):"Capability"===n.localName&&(this.capability=this.assembleCapability(n))}},i.prototype.assembleService=function(t){for(var e={capsDoc:this},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Name"===n.localName?e.name=n.textContent:"Title"===n.localName?e.title=n.textContent:"Abstract"===n.localName?e.abstract=n.textContent:"KeywordList"===n.localName?e.keywordList=this.assembleKeywordList(n):"OnlineResource"===n.localName?e.url=n.getAttribute("xlink:href"):"Fees"===n.localName?e.fees=n.textContent:"AccessConstraints"===n.localName?e.accessConstraints=n.textContent:"LayerLimit"==n.localName?e.layerLimit=parseInt(n.textContent):"MaxWidth"==n.localName?e.maxWidth=parseInt(n.textContent):"MaxHeight"==n.localName?e.maxHeight=parseInt(n.textContent):"ContactInformation"===n.localName&&(e.contactInformation=this.assembleContactInformation(n))}return e},i.prototype.assembleKeywordList=function(t){for(var e=[],r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Keyword"===n.localName&&e.push(n.textContent)}return e},i.prototype.assembleContactInformation=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"ContactPersonPrimary"===n.localName?e.contactPersonPrimary=this.assembleContactPersonPrimary(n):"ContactPosition"===n.localName?e.contactPosition=n.textContent:"ContactVoiceTelephone"===n.localName?e.contactVoiceTelephone=n.textContent:"ContactFacsimileTelephone"===n.localName?e.contactFacsimileTelephone=n.textContent:"ContactElectronicMailAddress"===n.localName?e.contactElectronicMailAddress=n.textContent:"ContactAddress"===n.localName&&(e.contactAddress=this.assembleContactAddress(n))}return e},i.prototype.assembleContactPersonPrimary=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"ContactPerson"===n.localName?e.contactPerson=n.textContent:"ContactOrganization"===n.localName&&(e.contactOrganization=n.textContent)}return e},i.prototype.assembleContactAddress=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"AddressType"===n.localName?e.addressType=n.textContent:"Address"===n.localName?e.address=n.textContent:"City"===n.localName?e.city=n.textContent:"StateOrProvince"===n.localName?e.stateOrProvince=n.textContent:"PostCode"===n.localName?e.postCode=n.textContent:"Country"===n.localName&&(e.country=n.textContent)}return e},i.prototype.assembleCapability=function(t){for(var e={capsDoc:this},i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Request"===o.localName?e.request=this.assembleRequests(o):"Exception"===o.localName?e.exception=this.assembleException(o):"Layer"===o.localName&&(e.layers=e.layers||[],e.layers.push(new r(o,e)))}return e},i.prototype.assembleRequests=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"GetCapabilities"===n.localName?e.getCapabilities=this.assembleRequest(n):"GetMap"===n.localName?e.getMap=this.assembleRequest(n):"GetFeatureInfo"===n.localName&&(e.getFeatureInfo=this.assembleRequest(n))}return e},i.prototype.assembleRequest=function(t){for(var e={name:t.localName},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];if("Format"===n.localName)e.formats=e.formats||[],e.formats.push(n.textContent);else if("DCPType"===n.localName)for(var o=n.children||n.childNodes,a=0;a<o.length;a++){var s=o[a];if("HTTP"===s.localName)for(var l=s.children||s.childNodes,u=0;u<l.length;u++){var c=l[u];if("Get"===c.localName)for(var h=c.children||c.childNodes,f=0;f<h.length;f++){var d=h[f];"OnlineResource"===d.localName&&(e.getUrl=d.getAttribute("xlink:href"))}}}}return e},i.prototype.assembleException=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Format"===n.localName&&(e.formats=e.formats||[],e.formats.push(n.textContent))}return e},i}),define("worldwind/layer/WmsLayer",["../error/ArgumentError","../geom/Location","../util/Logger","../util/PeriodicTimeSequence","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(t,e,r,i,n,o,a){"use strict";var s=function(e,i){if(!e)throw new t(r.logMessage(r.LEVEL_SEVERE,"WmsLayer","constructor","No configuration specified."));var n=e.service+e.layerNames+e.styleNames;i&&(n+=i),o.call(this,e.sector,e.levelZeroDelta,e.numLevels,e.format,n,e.size,e.size),this.displayName=e.title,this.pickEnabled=!1,this.urlBuilder=new a(e.service,e.layerNames,e.styleNames,e.version,i),e.coordinateSystem&&(this.urlBuilder.crs=e.coordinateSystem),this.timeString=i};return s.prototype=Object.create(o.prototype),s.formLayerConfiguration=function(t){var r={title:t.title,version:t.capability.capsDoc.version},i=t.geographicBoundingBox||t.latLonBoundingBox;i&&i.westBoundLongitude?r.sector=new n(i.southBoundLatitude,i.northBoundLatitude,i.westBoundLongitude,i.eastBoundLongitude):i&&i.minx?r.sector=new n(i.miny,i.maxy,i.minx,i.maxx):r.sector=n.FULL_SPHERE,r.levelZeroDelta=new e(36,36),r.numLevels=19,r.size=256,r.layerNames=t.name;var o=t.capability.request.getMap,a=o.formats;a.indexOf("image/png")>=0?r.format="image/png":a.indexOf("image/jpeg")>=0?r.format="image/jpeg":a.indexOf("image/tiff")>=0?r.format="image/tiff":a.indexOf("image/gif")>=0&&(r.format="image/gif"),r.service=o.getUrl;var l=t.crses;l||(l=t.srses),l&&(l.indexOf("EPSG:4326")>=0||l.indexOf("epsg:4326")>=0?r.coordinateSystem="EPSG:4326":(l.indexOf("CRS84")>=0||l.indexOf("CRS:84")>=0)&&(r.coordinateSystem="CRS:84"));var u=s.parseTimeDimensions(t);return u&&u.length>0&&(r.timeSequences=u),r},s.parseTimeDimensions=function(t){var e=t.extents||t.dimensions,r=null;if(e){r=[];for(var n=0;n<e.length;n++){var o=e[n];if("time"===o.name.toLowerCase()&&(!o.units||"iso8601"===o.units.toLowerCase()))for(var a=o.content.split(","),s=0;s<a.length;s++){var l=a[s],u=l.split("/");1===u.length?r.push(new Date(l)):3===u.length&&r.push(new i(l))}}}return r},s}),define("worldwind/layer/WmsTimeDimensionedLayer",["../error/ArgumentError","../layer/Layer","../util/Logger","../layer/WmsLayer"],function(t,e,r,i){"use strict";var n=function(i){if(!i)throw new t(r.logMessage(r.LEVEL_SEVERE,"WmsTimeDimensionedLayer","constructor","No configuration specified."));e.call(this,"WMS Time Dimensioned Layer"),this.config=i,this.displayName=i.title,this.pickEnabled=!1,this.layers={}};return n.prototype=Object.create(e.prototype),n.prototype.doRender=function(t){if(this.time){var e=this.time.toISOString(),r=this.layers[e];r||(r=new i(this.config,e),this.layers[e]=r),r.opacity=this.opacity,r.doRender(t),this.inCurrentFrame=r.inCurrentFrame}},n}),define("worldwind/ogc/wmts/OwsLanguageString",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"LanguageString","constructor","missingDomElement"));this.value=r.textContent,this.lang;var i=r.getAttribute("lang");i&&(this.lang=i)};return r}),define("worldwind/ogc/wmts/OwsDescription",["../../error/ArgumentError","../../util/Logger","../../ogc/wmts/OwsLanguageString"],function(t,e,r){"use strict";var i=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsDescription","assembleDescriptions","missingDomElement"));for(var n=i.children||i.childNodes,o=0;o<n.length;o++){var a=n[o];if("Title"===a.localName)this.titles=this.titles||[],this.titles.push(new r(a));else if("Abstract"===a.localName)this.abstracts=this.abstracts||[],this.abstracts.push(new r(a));else if("Keywords"===a.localName){this.keywords=this.keywords||[];for(var s=a.children||a.childNodes,l=0;l<s.length;l++){var u=s[l];this.keywords.push(new r(u))}}}};return i}),define("worldwind/ogc/wmts/OwsConstraint",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsConstraint","constructor","missingDomElement"));this.name=r.getAttribute("name");for(var i=r.children,n=0;n<i.length;n++){var o=i[n];if("AllowedValues"===o.localName){this.allowedValues=this.allowedValues||[];for(var a=0;a<o.children.length;a++)"Value"===o.children[a].localName&&this.allowedValues.push(o.children[a].textContent)}else"AnyValue"===o.localName?this.anyValue=!0:"NoValues"===o.localName&&(this.noValues=!0)}};return r}),define("worldwind/ogc/wmts/OwsOperationsMetadata",["../../error/ArgumentError","../../util/Logger","../../ogc/wmts/OwsConstraint"],function(t,e,r){"use strict";var i=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsOperationsMetadata","constructor","missingDomElement"));for(var n=r.children,o=0;o<n.length;o++){var a=n[o];"Operation"===a.localName&&(this.operation=this.operation||[],this.operation.push(i.assembleOperation(a)))}};return i.prototype.getGetCapabilities=function(){return this.getOperationMetadataByName("GetCapabilities")},i.prototype.getGetTile=function(){return this.getOperationMetadataByName("GetTile")},i.prototype.getOperationMetadataByName=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsOperationsMetadata","getOperationsMetadataByName","missingName"));for(var i=0;i<this.operation.length;i++)if(this.operation[i].name===r)return this.operation[i];return null},i.assembleOperation=function(t){var e={};e.name=t.getAttribute("name");for(var r=t.children,n=0;n<r.length;n++){var o=r[n];"DCP"===o.localName&&(e.dcp=e.dcp||[],e.dcp.push(i.assembleDcp(o)))}return e},i.assembleDcp=function(t){for(var e={},r=t.children,n=0;n<r.length;n++){var o=r[n];if("HTTP"===o.localName)for(var a=o.children||o.childNodes,s=0;s<a.length;s++){var l=a[s];"Get"===l.localName?(e.getMethods=e.getMethods||[],e.getMethods.push(i.assembleMethod(l))):"Post"===l.localName&&(e.postMethods=e.postMethods||[],e.postMethods.push(i.assembleMethod(l)))}}return e},i.assembleMethod=function(t){var e={};e.url=t.getAttribute("xlink:href");for(var i=t.children,n=0;n<i.length;n++){var o=i[n];"Constraint"===o.localName&&(e.constraint=e.constraint||[],e.constraint.push(new r(o)))}return e},i}),define("worldwind/ogc/wmts/OwsServiceIdentification",["../../error/ArgumentError","../../util/Logger","../../ogc/wmts/OwsDescription"],function(t,e,r){"use strict";var i=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceIdentification","constructor","missingDomElement"));r.call(this,i);for(var n=i.children,o=0;o<n.length;o++){var a=n[o];"ServiceType"===a.localName?this.serviceType=a.textContent:"ServiceTypeVersion"===a.localName?(this.serviceTypeVersions=this.serviceTypeVersions||[],this.serviceTypeVersions.push(a.textContent)):"Profile"===a.localName?(this.profile=this.profiles||[],this.profile.push(a.textContent)):"Fees"===a.localName?this.fees=a.textContent:"AccessConstraints"===a.localName&&(this.accessConstraints=this.accessConstraints||[],this.accessConstraints.push(a.textContent))}};return i.prototype=Object.create(r.prototype),i}),define("worldwind/ogc/wmts/OwsServiceProvider",["../../error/ArgumentError","../../util/Logger"],function(t,e){"use strict";var r=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","constructor","missingDomElement"));for(var n=i.children||i.childNodes,o=0;o<n.length;o++){var a=n[o];"ProviderName"===a.localName?this.providerName=a.textContent:"ProviderSite"===a.localName?this.providerSiteUrl=a.getAttribute("xlink:href"):"ServiceContact"===a.localName&&(this.serviceContact=r.assembleServiceContact(a))}};return r.assembleServiceContact=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assembleServiceContact","missingDomElement"));for(var n={},o=i.children||i.childNodes,a=0;a<o.length;a++){var s=o[a];"IndividualName"===s.localName?n.individualName=s.textContent:"PositionName"===s.localName?n.positionName=s.textContent:"ContactInfo"===s.localName&&(n.contactInfo=r.assembleContacts(s))}return n},r.assembleContacts=function(i){if(!i)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assembleContacts","missingDomElement"));for(var n={},o=i.children||i.childNodes,a=0;a<o.length;a++){var s=o[a];"HoursOfService"===s.localName?n.hoursOfService=s.textContent:"ContactInstructions"===s.localName?n.contactInstructions=s.textContent:"Phone"===s.localName?n.phone=r.assemblePhone(s):"Address"===s.localName&&(n.address=r.assembleAddress(s))}return n},r.assemblePhone=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assemblePhone","missingDomElement"));for(var i={},n=r.children||r.childNodes,o=0;o<n.length;o++){var a=n[o];"Voice"===a.localName?i.voice=a.textContent:"Facsimile"===a.localName&&(i.facsimile=a.textContent)}return i},r.assembleAddress=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"OwsServiceProvider","assembleAddress","missingDomElement"));for(var i={},n=r.children||r.childNodes,o=0;o<n.length;o++){var a=n[o];"DeliveryPoint"===a.localName?(i.deliveryPoints=i.deliveryPoints||[],i.deliveryPoints.push(a.textContent)):"City"===a.localName?i.city=a.textContent:"AdministrativeArea"===a.localName?i.administrativeArea=a.textContent:"PostalCode"===a.localName?(i.postalCodes=i.postalCodes||[],i.postalCodes.push(a.textContent)):"Country"===a.localName?(i.countries=i.countries||[],i.countries.push(a.textContent)):"ElectronicMailAddress"===a.localName&&(i.electronicMailAddresses=i.electronicMailAddresses||[],i.electronicMailAddresses.push(a.textContent))}return i},r}),define("worldwind/ogc/wmts/WmtsLayerCapabilities",["../../error/ArgumentError","../../geom/Sector","../../ogc/wmts/OwsDescription","../../util/Logger"],function(t,e,r,i){"use strict";var n=function(e,n){if(!e)throw new t(i.logMessage(i.LEVEL_SEVERE,"WmtsLayerCapabilities","constructor","missingDomElement"));r.call(this,e),this.capabilities=n,this.identifier,this.title,this.abstract,this.keywords,this.wgs84BoundingBox,this.boundingBox,this.styles,this.formats,this.infoFormat,this.dimension,this.metadata,this.tileMatrixSetLink,this.resourceUrl,this.assembleLayer(e)};return n.prototype=Object.create(r.prototype),n.prototype.getLayerSupportedTileMatrixSets=function(){for(var t=[],e=0,r=this.tileMatrixSetLink.length;e<r;e++)for(var i=this.tileMatrixSetLink[e].tileMatrixSet,n=0,o=this.capabilities.contents.tileMatrixSet.length;n<o;n++){var a=this.capabilities.contents.tileMatrixSet[n].identifier;a===i&&t.push(this.capabilities.contents.tileMatrixSet[n])}return t},n.prototype.assembleLayer=function(t){for(var e=t.children||t.childNodes,r=0;r<e.length;r++){var i=e[r];"Identifier"===i.localName?this.identifier=i.textContent:"WGS84BoundingBox"===i.localName?this.wgs84BoundingBox=n.assembleBoundingBox(i):"BoundingBox"===i.localName?(this.boundingBox=this.boundingBox||[],this.boundingBox.push(n.assembleBoundingBox(i))):"Style"===i.localName?(this.style=this.style||[],this.style.push(n.assembleStyle(i))):"Format"===i.localName?(this.format=this.format||[],this.format.push(i.textContent)):"InfoFormat"===i.localName?(this.infoFormat=this.infoFormat||[],this.infoFormat.push(i.textContent)):"Dimension"===i.localName?(this.dimension=this.dimension||[],this.dimension.push(n.assembleDimension(i))):"Metadata"===i.localName?(this.metadata=this.metadata||[],this.metadata.push(n.assembleMetadata(i))):"ResourceURL"===i.localName?(this.resourceUrl=this.resourceUrl||[],this.resourceUrl.push(n.assembleResourceUrl(i))):"TileMatrixSetLink"===i.localName&&(this.tileMatrixSetLink=this.tileMatrixSetLink||[],this.tileMatrixSetLink.push(n.assembleTileMatrixSetLink(i)))}},n.assembleStyle=function(t){var e=new r(t);e.isDefault=t.getAttribute("isDefault");for(var i=t.children||t.childNodes,o=0;o<i.length;o++){var a=i[o];"Identifier"===a.localName?e.identifier=a.textContent:"LegendURL"===a.localName&&(e.legendUrl=e.legendUrl||[],e.legendUrl.push(n.assembleLegendUrl(a)))}return e},n.assembleBoundingBox=function(t){var r={},i=t.getAttribute("crs");i&&(r.crs=i);for(var n=t.children||t.childNodes,o=0;o<n.length;o++){var a=n[o];if("LowerCorner"===a.localName){var s=a.textContent.split(" ");r.lowerCorner=[parseFloat(s[0]),parseFloat(s[1])]}else if("UpperCorner"===a.localName){var l=a.textContent.split(" ");r.upperCorner=[parseFloat(l[0]),parseFloat(l[1])]}}return"WGS84BoundingBox"===t.localName&&(r.getSector=function(){return new e(r.lowerCorner[1],r.upperCorner[1],r.lowerCorner[0],r.upperCorner[0])}),r},n.assembleDimension=function(t){for(var e=new r(t),i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Identifier"===o.localName?e.identifier=o.textContent:"UOM"===o.localName?e.uom={name:o.getAttribute("name"),reference:o.getAttribute("reference")}:"UnitSymbol"==o.localName?e.unitSymbol=o.textContent:"Default"===o.localName?e.default=o.textContent:"Current"===o.localName?e.current="true"===o.textContent:"Value"===o.localName&&(e.value=e.value||[],e.value.push(o.textContent))}return e},n.assembleMetadata=function(t){var e={},r=t.getAttribute("xlink:href");r&&(e.url=r);var i=t.getAttribute("about");r&&(e.about=i);var n=t.getAttribute("xlink:type");n&&(e.type=n);var o=t.getAttribute("xlink:role");o&&(e.role=o);var a=t.getAttribute("xlink:title");a&&(e.title=a);for(var s=t.children||t.childNodes,l=0;l<s.length;l++){var u=s[l];"Metadata"===u.localName&&(e.metadata=WmsLayerCapabilities.assembleMetadata(u))}return e},n.assembleResourceUrl=function(t){var e={};return e.format=t.getAttribute("format"),e.resourceType=t.getAttribute("resourceType"),e.template=t.getAttribute("template"),e},n.assembleLegendUrl=function(t){var e={};return e.format=t.getAttribute("format"),e.minScaleDenominator=t.getAttribute("minScaleDenominator"),e.maxScaleDenominator=t.getAttribute("maxScaleDenominator"),e.href=t.getAttribute("xlink:href"),e.width=t.getAttribute("width"),e.height=t.getAttribute("height"),e},n.assembleTileMatrixSetLink=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var o=r[i];"TileMatrixSet"===o.localName?e.tileMatrixSet=o.textContent:"TileMatrixSetLimits"===o.localName&&(e.tileMatrixSetLimits=n.assembleTileMatrixSetLimits(o))}return e},n.assembleTileMatrixSetLimits=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var o=r[i];"TileMatrixLimits"===o.localName&&(e.tileMatrixLimits=e.tileMatrixLimits||[],e.tileMatrixLimits.push(n.assembleTileMatrixLimits(o)))}return e},n.assembleTileMatrixLimits=function(t){for(var e={},r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"TileMatrix"===n.localName?e.tileMatrix=n.textContent:"MinTileRow"===n.localName?e.minTileRow=parseInt(n.textContent):"MaxTileRow"===n.localName?e.maxTileRow=parseInt(n.textContent):"MinTileCol"===n.localName?e.minTileCol=parseInt(n.textContent):"maxTileCol"===n.localName&&(e.maxTileCol=parseInt(n.textContent))}return e},n}),define("worldwind/ogc/wmts/WmtsCapabilities",["../../error/ArgumentError","../../util/Logger","../../ogc/wmts/OwsDescription","../../ogc/wmts/OwsLanguageString","../../ogc/wmts/OwsOperationsMetadata","../../ogc/wmts/OwsServiceIdentification","../../ogc/wmts/OwsServiceProvider","../../ogc/wms/WmsCapabilities","../../ogc/wmts/WmtsLayerCapabilities"],function(t,e,r,i,n,o,a,s,l){"use strict";var u=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmtsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(r)};return u.prototype.getLayers=function(){return this.contents.layer},u.prototype.getLayer=function(r){if(!r)throw new t(e.logMessage(e.LEVEL_SEVERE,"WmtsCapabilities","getLayer","empty identifier"));for(var i=0,n=this.contents.layer.length;i<n;i++){var o=this.contents.layer[i];if(o.identifier===r)return o}return null},u.prototype.assembleDocument=function(t){var e=t.documentElement;this.version=e.getAttribute("version"),this.updateSequence=e.getAttribute("updateSequence");for(var r=e.children||e.childNodes,i=0;i<r.length;i++){var s=r[i];"ServiceIdentification"===s.localName?this.serviceIdentification=new o(s):"ServiceProvider"===s.localName?this.serviceProvider=new a(s):"OperationsMetadata"===s.localName?this.operationsMetadata=new n(s):"Contents"===s.localName?this.contents=this.assembleContents(s):"Themes"===s.localName?this.themes=u.assembleThemes(s):"ServiceMetadataURL"===s.localName&&(this.serviceMetadataUrls=this.serviceMetadataUrls||[],this.serviceMetadataUrls.push(u.assembleServiceMetadataURL(s)))}},u.prototype.assembleContents=function(t){for(var r={},i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];if("Layer"===o.localName){r.layer=r.layer||[];try{r.layer.push(new l(o,this))}catch(t){e.logMessage(e.LEVEL_SEVERE,"WmtsCapabilities","constructor","Exception reading WMTS layer description: "+t.message)}}else if("TileMatrixSet"===o.localName){r.tileMatrixSet=r.tileMatrixSet||[];try{r.tileMatrixSet.push(u.assembleTileMatrixSet(o))}catch(t){e.logMessage(e.LEVEL_SEVERE,"WmtsCapabilities","constructor","Exception reading WMTS tile matrix set description: "+t.message)}}}return r},u.assembleTileMatrixSet=function(t){for(var e=new r(t),i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Identifier"===o.localName?e.identifier=o.textContent:"SupportedCRS"===o.localName?e.supportedCRS=o.textContent:"WellKnownScaleSet"===o.localName?e.wellKnownScaleSet=o.textContent:"BoundingBox"===o.localName?e.boundingBox=l.assembleBoundingBox(o):"TileMatrix"===o.localName&&(e.tileMatrix=e.tileMatrix||[],e.tileMatrix.push(u.assembleTileMatrix(o)))}u.sortTileMatrices(e);for(var a=0;a<e.tileMatrix.length;a++)e.tileMatrix[a].levelNumber=a;return e},u.assembleTileMatrix=function(t){for(var e=new r(t),i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];if("Identifier"===o.localName)e.identifier=o.textContent;else if("ScaleDenominator"===o.localName)e.scaleDenominator=parseFloat(o.textContent);else if("TileWidth"===o.localName)e.tileWidth=parseFloat(o.textContent);else if("TileHeight"===o.localName)e.tileHeight=parseFloat(o.textContent);else if("MatrixWidth"===o.localName)e.matrixWidth=parseFloat(o.textContent);else if("MatrixHeight"===o.localName)e.matrixHeight=parseFloat(o.textContent);else if("TopLeftCorner"===o.localName){var a=o.textContent.split(" ");e.topLeftCorner=[parseFloat(a[0]),parseFloat(a[1])]}}return e},u.assembleThemes=function(t){for(var e,r=t.children||t.childNodes,i=0;i<r.length;i++){var n=r[i];"Theme"===n.localName&&(e=e||[],e.push(u.assembleTheme(n)))}return e},u.assembleTheme=function(t){for(var e=new r(t),i=t.children||t.childNodes,n=0;n<i.length;n++){var o=i[n];"Identifier"===o.localName?e.identifier=o.textContent:"LayerRef"===o.localName?(e.layerRef=e.layerRef||[],e.layerRef.push(o.textContent)):"Theme"===o.localName&&(e.themes=e.themes||[],e.themes.push(u.assembleTheme(o)))}return e},u.assembleServiceMetadataURL=function(t){var e={},r=t.getAttribute("xlink:href");return r&&(e.url=r),e},u.sortTileMatrices=function(t){t.tileMatrix.sort(function(t,e){return e.scaleDenominator-t.scaleDenominator})},u.prototype.getGetTileKvpAddress=function(){for(var t=0;t<this.operationsMetadata.operation.length;t++){var e=this.operationsMetadata.operation[t];if("GetTile"===e.name)return e.dcp[0].getMethods[0].url}return null},u}),define("worldwind/layer/WmtsLayerTile",["../geom/Angle","../error/ArgumentError","../geom/BoundingBox","../util/Logger","../geom/Vec3","../util/WWUtil"],function(t,e,r,i,n,o){"use strict";var a=function(e,r,i,n,o){this.sector=e,this.tileMatrix=r,this.row=i,this.column=n,this.imagePath=o,this.texelSize=e.deltaLatitude()*t.DEGREES_TO_RADIANS/r.tileHeight,this.tileKey=r.levelNumber.toString()+"."+i.toString()+"."+n.toString(),this.gpuCacheKey=o};return a.prototype.isEqual=function(t){return!!t&&(!!t.tileKey&&this.tileKey==t.tileKey)},a.prototype.distanceTo=function(t){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Tile","distanceTo","missingVector"));for(var r,n,o,a=t[0],s=t[1],l=t[2],u=this.samplePoints,c=Number.POSITIVE_INFINITY,h=0,f=u.length;h<f;h+=3)r=a-u[h],n=s-u[h+1],o=l-u[h+2],c=Math.min(c,r*r+n*n+o*o);return Math.sqrt(c)},a.prototype.subdivide=function(t,r){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"WmtsLayerTile","subdivide","The specified tile matrix is null or undefined."));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"WmtsLayerTile","subdivide","The specified tile factory is null or undefined."));for(var n,o,a=[],s=t.matrixHeight/this.tileMatrix.matrixHeight,l=t.matrixWidth/this.tileMatrix.matrixWidth,u=0;u<s;u++)for(var c=0;c<l;c++)n=s*this.row+u,o=l*this.column+c,a.push(r.createTile(t,n,o));return a},a.prototype.subdivideToCache=function(t,r,n){if(!t)throw new e(i.logMessage(i.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile matrix is null or undefined."));if(!r)throw new e(i.logMessage(i.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile factory is null or undefined."));var o=n?n.entryForKey(this.tileKey):null;return o||(o=this.subdivide(t,r),o&&n&&n.putEntry(this.tileKey,o,o.length)),o},a.prototype.mustSubdivide=function(t,e){var r=t.globe.equatorialRadius*this.texelSize,i=this.distanceTo(t.navigatorState.eyePoint),n=t.navigatorState.pixelSizeAtDistance(i);return r>Math.max(e*n,.5)},a.prototype.update=function(t){var e=t.globe.elevationTimestamp(),r=t.verticalExaggeration,i=t.globeStateKey;this.updateTimestamp==e&&this.updateVerticalExaggeration==r&&this.updateGlobeStateKey==i||(this.doUpdate(t),t.frameStatistics.incrementTileUpdateCount(1),this.updateTimestamp=e,this.updateVerticalExaggeration=r,this.updateGlobeStateKey=i)},a.prototype.doUpdate=function(t){var e=t.globe,i=t.verticalExaggeration,a=e.minAndMaxElevationsForSector(this.sector),s=a?a[0]*i:0,l=a?a[1]*i:0;s==l&&(s=l+10),this.extent||(this.extent=new r),this.extent.setToSector(this.sector,e,s,l),this.samplePoints||(this.sampleElevations=new Float64Array(9),this.samplePoints=new Float64Array(3*this.sampleElevations.length)),o.fillArray(this.sampleElevations,.5*(s+l)),e.computePointsForGrid(this.sector,3,3,this.sampleElevations,n.ZERO,this.samplePoints),this.referencePoint||(this.referencePoint=new n(0,0,0)),e.computePointFromPosition(this.sector.centroidLatitude(),this.sector.centroidLongitude(),0,this.referencePoint)},a.prototype.bind=function(t){var e=t.gpuResourceCache.resourceForKey(this.gpuCacheKey);return!(!e||!e.bind(t))||!!this.fallbackTile&&this.fallbackTile.bind(t)},a.prototype.applyInternalTransform=function(t,e){},a}),define("worldwind/layer/WmtsLayer",["../util/AbsentResourceList","../error/ArgumentError","../util/Logger","../geom/Sector","../layer/Layer","../cache/MemoryCache","../render/Texture","../util/WmsUrlBuilder","../layer/WmtsLayerTile","../util/WWMath","../util/WWUtil"],function(t,e,r,i,n,o,a,s,l,u,c){"use strict";var h=function(a,s){if(!a)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","No layer configuration specified."));if(n.call(this,"WMTS Layer"),this.layerIdentifier=a.identifier,this.styleIdentifier=a.style,this.timeString=s,this.imageFormat=a.format,this.resourceUrl=a.resourceUrl,this.serviceUrl=a.service,this.tileMatrixSet=a.tileMatrixSet,a.wgs84BoundingBox||a.boundingBox){if(a.wgs84BoundingBox)this.sector=a.wgs84BoundingBox.getSector();else if(this.tileMatrixSet.boundingBox&&h.isEpsg4326Crs(this.tileMatrixSet.boundingBox.crs))this.sector=new i(this.tileMatrixSet.boundingBox.lowerCorner[1],this.tileMatrixSet.boundingBox.upperCorner[1],this.tileMatrixSet.boundingBox.lowerCorner[0],this.tileMatrixSet.boundingBox.upperCorner[0]);else if(h.isEpsg4326Crs(this.tileMatrixSet.supportedCRS))throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","No EPSG:4326 bounding box was specified in the layer or tile matrix set capabilities."))}else{if(!this.tileMatrixSet.boundingBox)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","No bounding box was specified in the layer or tile matrix set capabilities."));this.sector=new i(a.tileMatrixSet.boundingBox.lowerCorner[1],a.tileMatrixSet.boundingBox.upperCorner[1],a.tileMatrixSet.boundingBox.lowerCorner[0],a.tileMatrixSet.boundingBox.upperCorner[0])}var l,u=a.tileMatrixSet.tileMatrix,c=[],f=[];u.forEach(function(t){c.push(t.matrixWidth),f.push(t.matrixHeight);
}),0!==h.checkTileSubdivision(c)?(l=h.checkTileSubdivision(c),r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","Tile subdivision not supported for layer : "+a.identifier+". Display until level "+(l-1)),u.splice(l)):0!==h.checkTileSubdivision(f)&&(l=h.checkTileSubdivision(f),r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","constructor","Tile subdivision not supported for layer : "+a.identifier+". Display until level "+(l-1)),u.splice(l)),this.cachePath=(this.resourceUrl||this.serviceUrl)+this.layerIdentifier+this.styleIdentifier+this.tileMatrixSet.identifier,s&&(this.cachePath=this.cachePath+s),this.displayName=a.title,this.currentTiles=[],this.currentTilesInvalid=!0,this.tileCache=new o(500,400),this.currentRetrievals=[],this.absentResourceList=new t(3,5e4),this.pickEnabled=!1,this.detailControl=1.75};return h.checkTileSubdivision=function(t){if(t.length<1)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","checkTileSubdivision","Empty dimension array"));for(var i,n=0,o=0;++o<t.length&&0==n;){var a=t[o]/t[o-1];t[o]%t[o-1]!==0?n=o:i&&i!==a&&(n=o),i=a}return n},h.createTileMatrixSet=function(t){if(!t.matrixSet)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No matrixSet provided."));if(!t.projection)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No projection provided."));if(!t.extent||4!=t.extent.length)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No extent provided."));var i={lowerCorner:[t.extent[0],t.extent[1]],upperCorner:[t.extent[2],t.extent[3]]};if(!t.resolutions)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No resolutions provided."));if(!t.tileSize)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No tile size provided."));if(!t.topLeftCorner||2!=t.topLeftCorner.length)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No extent provided."));if(void 0===t.prefix)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","Prefix not provided."));if(!(h.isEpsg4326Crs(t.projection)||h.isOGCCrs84(t.projection)||h.isEpsg3857Crs(t.projection)))throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","Projection provided not supported."));for(var n,o=[],a=0;a<t.resolutions.length;a++){h.isEpsg4326Crs(t.projection)||h.isOGCCrs84(t.projection)?n=6378137*t.resolutions[a]*2*Math.PI/360/28e-5:h.isEpsg3857Crs(t.projection)&&(n=t.resolutions[a]/28e-5);var s=t.tileSize*t.resolutions[a],l=t.tileSize*t.resolutions[a],u=Math.ceil((t.extent[2]-t.extent[0]-.01*s)/s),c=Math.ceil((t.extent[3]-t.extent[1]-.01*l)/l),f={identifier:t.prefix?t.matrixSet+":"+a:a,levelNumber:a,matrixHeight:c,matrixWidth:u,tileHeight:t.tileSize,tileWidth:t.tileSize,topLeftCorner:t.topLeftCorner,scaleDenominator:n};o.push(f)}return{identifier:t.matrixSet,supportedCRS:t.projection,boundingBox:i,tileMatrix:o}},h.formLayerConfiguration=function(t,i,n,o){var a={};if(a.identifier=t.identifier,o){for(var l=!1,u=0;u<t.format.length;u++)if(t.format[u]===o){l=!0,a.format=t.format[u];break}l||(r.logMessage(r.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","The specified image format is not available. Another one will be used."),a.format=null)}if(a.format||(t.format.indexOf("image/png")>=0?a.format="image/png":t.format.indexOf("image/jpeg")>=0?a.format="image/jpeg":t.format.indexOf("image/tiff")>=0?a.format="image/tiff":t.format.indexOf("image/gif")>=0?a.format="image/gif":a.format=t.format[0]),!a.format)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","formLayerConfiguration","Layer does not provide a supported image format."));if(t.resourceUrl&&t.resourceUrl.length>=1){for(var u=0;u<t.resourceUrl.length;u++)if(a.format===t.resourceUrl[u].format){a.resourceUrl=t.resourceUrl[u].template;break}}else a.service=t.capabilities.getGetTileKvpAddress(),a.service&&(a.service=s.fixGetMapString(a.service));if(!a.resourceUrl&&!a.service)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","formLayerConfiguration","No resource URL or KVP GetTile service URL specified in WMTS capabilities."));if(i){for(var c=!1,u=0;u<t.style.length;u++)if(t.style[u].identifier===i){c=!0,a.style=t.style[u].identifier;break}c||(r.logMessage(r.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","The specified style identifier is not available. The server's default style will be used."),a.style=null)}if(!a.style)for(u=0;u<t.style.length;u++)if(t.style[u].isDefault){a.style=t.style[u].identifier;break}a.styleIdentifier||r.logMessage(r.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","No default style available. A style will not be specified in tile requests.");var f=t.getLayerSupportedTileMatrixSets();if(n){for(var d=!1,u=0,p=f.length;u<p;u++)if(f[u].identifier===n){d=!0,a.tileMatrixSet=f[u];break}d||(r.logMessage(r.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","The specified tileMatrixSet is not available. Another one will be used."),a.tileMatrixSet=null)}if(!a.tileMatrixSet){for(var g,m=null,y=null,v=null,u=0,p=f.length;u<p;u++)g=f[u],h.isEpsg4326Crs(g.supportedCRS)?m=m||g:h.isEpsg3857Crs(g.supportedCRS)?y=y||g:h.isOGCCrs84(g.supportedCRS)&&(v=v||g);a.tileMatrixSet=m||y||v}if(!a.tileMatrixSet)throw new e(r.logMessage(r.LEVEL_SEVERE,"WmtsLayer","formLayerConfiguration","No supported Tile Matrix Set could be found."));return a.boundingBox=t.boundingBox,a.wgs84BoundingBox=t.wgs84BoundingBox,t.titles.length>0?a.title=t.titles[0].value:a.title=t.identifier,a},h.prototype=Object.create(n.prototype),h.prototype.doRender=function(t){t.terrain&&(!this.currentTilesInvalid&&this.lasTtMVP&&t.navigatorState.modelviewProjection.equals(this.lasTtMVP)&&t.globeStateKey==this.lastGlobeStateKey||(this.currentTilesInvalid=!1,this.assembleTiles(t)),this.lasTtMVP=t.navigatorState.modelviewProjection,this.lastGlobeStateKey=t.globeStateKey,this.currentTiles.length>0&&(t.surfaceTileRenderer.renderTiles(t,this.currentTiles,this.opacity),t.frameStatistics.incrementImageTileCount(this.currentTiles.length),this.inCurrentFrame=!0))},h.prototype.isLayerInView=function(t){return t.terrain&&t.terrain.sector&&t.terrain.sector.intersects(this.sector)},h.prototype.isTileVisible=function(t,e){return!(t.globe.projectionLimits&&!e.sector.overlaps(t.globe.projectionLimits))&&e.extent.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)},h.prototype.assembleTiles=function(t){this.currentTiles=[],this.topLevelTiles&&0!==this.topLevelTiles.length||this.createTopLevelTiles(t);for(var e=0,r=this.topLevelTiles.length;e<r;e++){var i=this.topLevelTiles[e];i.update(t),this.currentAncestorTile=null,this.isTileVisible(t,i)&&this.addTileOrDescendants(t,i)}},h.prototype.addTileOrDescendants=function(t,e){if(e.column>=e.tileMatrix.matrixWidth&&(e.column=e.column-e.tileMatrix.matrixWidth),e.column<0&&(e.column=e.column+e.tileMatrix.matrixWidth),this.tileMeetsRenderingCriteria(t,e))return void this.addTile(t,e);var r=null;try{(this.isTileTextureInMemory(t,e)||0===e.tileMatrix.levelNumber)&&(r=this.currentAncestorTile,this.currentAncestorTile=e);for(var i=this.tileMatrixSet.tileMatrix[e.tileMatrix.levelNumber+1],n=e.subdivideToCache(i,this,this.tileCache),o=0,a=n.length;o<a;o++){var s=n[o];s.update(t),this.sector.intersects(s.sector)&&this.isTileVisible(t,s)&&this.addTileOrDescendants(t,s)}}finally{r&&(this.currentAncestorTile=r)}},h.prototype.addTile=function(t,e){e.fallbackTile=null;var r=t.gpuResourceCache.resourceForKey(e.imagePath);return r?(this.currentTiles.push(e),void(this.expiration&&this.isTextureExpired(r)&&this.retrieveTileImage(t,e))):(this.retrieveTileImage(t,e),void(this.currentAncestorTile&&this.isTileTextureInMemory(t,this.currentAncestorTile)&&this.currentTiles.push(this.currentAncestorTile)))},h.prototype.isTextureExpired=function(t){return this.expiration&&t.creationTime.getTime()<=this.expiration.getTime()},h.prototype.isTileTextureInMemory=function(t,e){return t.gpuResourceCache.containsResource(e.imagePath)},h.prototype.tileMeetsRenderingCriteria=function(t,e){var r=this.detailControl;return(e.sector.minLatitude>=75||e.sector.maxLatitude<=-75)&&(r*=1.2),e.tileMatrix.levelNumber===this.tileMatrixSet.tileMatrix.length-1||!e.mustSubdivide(t,r)},h.prototype.retrieveTileImage=function(t,e){if(this.currentRetrievals.indexOf(e.imagePath)<0){if(this.absentResourceList.isResourceAbsent(e.imagePath))return;var i=this.resourceUrlForTile(e,this.imageFormat),n=new Image,o=e.imagePath,a=t.gpuResourceCache,s=t.currentGlContext.canvas,l=this;if(!i)return void(this.currentTilesInvalid=!0);n.onload=function(){r.log(r.LEVEL_INFO,"Image retrieval succeeded: "+i);var u=l.createTexture(t,e,n);if(l.removeFromCurrentRetrievals(o),u){a.putResource(o,u,u.size),l.currentTilesInvalid=!0,l.absentResourceList.unmarkResourceAbsent(o);var c=document.createEvent("Event");c.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),s.dispatchEvent(c)}},n.onerror=function(){l.removeFromCurrentRetrievals(o),l.absentResourceList.markResourceAbsent(o),r.log(r.LEVEL_WARNING,"Image retrieval failed: "+i)},this.currentRetrievals.push(o),n.crossOrigin="anonymous",n.src=i}},h.prototype.resourceUrlForTile=function(t,e){var r;return this.resourceUrl?(r=this.resourceUrl.replace("{Style}",this.styleIdentifier).replace("{TileMatrixSet}",this.tileMatrixSet.identifier).replace("{TileMatrix}",t.tileMatrix.identifier).replace("{TileCol}",t.column).replace("{TileRow}",t.row),this.timeString&&(r=r.replace("{Time}",this.timeString))):(r=this.serviceUrl+"service=WMTS&request=GetTile&version=1.0.0",r+="&Layer="+this.layerIdentifier,this.styleIdentifier&&(r+="&Style="+this.styleIdentifier),r+="&Format="+e,this.timeString&&(r+="&Time="+this.timeString),r+="&TileMatrixSet="+this.tileMatrixSet.identifier,r+="&TileMatrix="+t.tileMatrix.identifier,r+="&TileRow="+t.row,r+="&TileCol="+t.column),r},h.prototype.removeFromCurrentRetrievals=function(t){var e=this.currentRetrievals.indexOf(t);e>-1&&this.currentRetrievals.splice(e,1)},h.prototype.createTopLevelTiles=function(t){var e=this.tileMatrixSet.tileMatrix[0];this.topLevelTiles=[];for(var r=0;r<e.matrixHeight;r++)for(var i=0;i<e.matrixWidth;i++)this.topLevelTiles.push(this.createTile(e,r,i))},h.prototype.createTile=function(t,e,r){return h.isEpsg4326Crs(this.tileMatrixSet.supportedCRS)?this.createTile4326(t,e,r):h.isEpsg3857Crs(this.tileMatrixSet.supportedCRS)?this.createTile3857(t,e,r):h.isOGCCrs84(this.tileMatrixSet.supportedCRS)?this.createTileCrs84(t,e,r):void 0},h.prototype.createTileCrs84=function(t,e,r){var n=this.sector.deltaLatitude()/t.matrixHeight,o=this.sector.deltaLongitude()/t.matrixWidth,a=t.topLeftCorner[1]-e*n,s=a-n,l=t.topLeftCorner[0]+o*r,u=l+o,c=new i(s,a,l,u);return this.makeTile(c,t,e,r)},h.prototype.createTile4326=function(t,e,r){var n=this.sector.deltaLatitude()/t.matrixHeight,o=this.sector.deltaLongitude()/t.matrixWidth,a=t.topLeftCorner[0]-e*n,s=a-n,l=t.topLeftCorner[1]+o*r,u=l+o,c=new i(s,a,l,u);return this.makeTile(c,t,e,r)},h.prototype.createTile3857=function(t,e,r){t.mapWidth||this.computeTileMatrixValues3857(t);var n,o,a,s,l,c,h=u.clamp(r*t.tileWidth-.5,0,t.mapWidth),f=u.clamp(e*t.tileHeight-.5,0,t.mapHeight),d=u.clamp(h+t.tileWidth+.5,0,t.mapWidth),p=u.clamp(f+t.tileHeight+.5,0,t.mapHeight);n=h/t.mapWidth,o=p/t.mapHeight,s=t.topLeftCorner[0]+n*t.tileMatrixDeltaX,a=t.topLeftCorner[1]-o*t.tileMatrixDeltaY;var g=u.epsg3857ToEpsg4326(s,a);n=d/t.mapWidth,o=f/t.mapHeight,c=t.topLeftCorner[0]+n*t.tileMatrixDeltaX,l=t.topLeftCorner[1]-o*t.tileMatrixDeltaY;var m=u.epsg3857ToEpsg4326(c,l),y=new i(g[0],m[0],g[1],m[1]);return this.makeTile(y,t,e,r)},h.prototype.computeTileMatrixValues3857=function(t){var e=28e-5*t.scaleDenominator,r=t.tileWidth*e,i=t.tileHeight*e,n=t.topLeftCorner[0]+r*t.matrixWidth,o=t.topLeftCorner[1]-i*t.matrixHeight,a=[n,o],s=t.topLeftCorner;t.tileMatrixDeltaX=a[0]-s[0],t.tileMatrixDeltaY=s[1]-a[1],t.mapWidth=t.tileWidth*t.matrixWidth,t.mapHeight=t.tileHeight*t.matrixHeight},h.prototype.makeTile=function(t,e,r,i){var n=this.cachePath+"-layer/"+e.identifier+"/"+r+"/"+i+"."+c.suffixForMimeType(this.imageFormat);return new l(t,e,r,i,n)},h.prototype.createTexture=function(t,e,r){return h.isEpsg4326Crs(this.tileMatrixSet.supportedCRS)?new a(t.currentGlContext,r):h.isEpsg3857Crs(this.tileMatrixSet.supportedCRS)?this.createTexture3857(t,e,r):h.isOGCCrs84(this.tileMatrixSet.supportedCRS)?new a(t.currentGlContext,r):void 0},h.prototype.createTexture3857=function(t,e,r){this.destCanvas||(this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d"));var i,n,o,s,l,c,h,f,d=t.canvas2D,p=t.ctx2D,g=this.destCanvas,m=this.destContext,y=m.createImageData(r.width,r.height),v=e.sector,b=u.gudermannianInverse(v.minLatitude),E=u.gudermannianInverse(v.maxLatitude);d.width=r.width,d.height=r.height,g.width=r.width,g.height=r.height,p.drawImage(r,0,0,r.width,r.height),i=p.getImageData(0,0,r.width,r.height);for(var w=0;w<1;w++)for(var _=0;_<r.height;_++){h=1-_/(r.height-1),n=h*v.deltaLatitude()+v.minLatitude,o=u.gudermannianInverse(n),f=1-(o-b)/(E-b),f=u.clamp(f,0,1),s=Math.floor(f*(r.height-1));for(var x=0;x<r.width;x++)l=4*(x+s*r.width),c=4*(x+_*r.width),y.data[c]=i.data[l],y.data[c+1]=i.data[l+1],y.data[c+2]=i.data[l+2],y.data[c+3]=i.data[l+3]}return m.putImageData(y,0,0),new a(t.currentGlContext,g)},h.isEpsg4326Crs=function(t){return t.indexOf("EPSG")>=0&&t.indexOf("4326")>=0},h.isEpsg3857Crs=function(t){return t.indexOf("EPSG")>=0&&(t.indexOf("3857")>=0||t.indexOf("900913")>=0)},h.isOGCCrs84=function(t){return t.indexOf("OGC")>=0&&t.indexOf("CRS84")>=0},h}),define("worldwind/WorldWindow",["./error/ArgumentError","./navigate/Camera","./render/DrawContext","./globe/EarthElevationModel","./util/FrameStatistics","./globe/Globe","./globe/Globe2D","./util/GoToAnimator","./cache/GpuResourceCache","./util/Logger","./navigate/Navigator","./navigate/NavigatorState","./pick/PickedObjectList","./geom/Rectangle","./geom/Sector","./shapes/SurfaceShape","./shapes/SurfaceShapeTileBuilder","./globe/Terrain","./geom/Vec2","./navigate/WorldWindowController","./util/WWMath"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E){"use strict";var w=function(a,l,h){function f(t){v.handleContextLost(t)}function p(t){v.handleContextRestored(t)}function g(t){v.handleRedrawEvent(t)}if(!window.WebGLRenderingContext)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","constructor","The specified canvas does not support WebGL."));var m=document.getElementById(a);if(!m)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","constructor","The specified canvas name is not in the document."));var y=this.createContext(m);this.drawContext=new r(y),this.eventListeners={},this.redrawRequested=!0,this.redrawRequestId=null,this.scratchCamera=new e,this.canvas=m,this.depthBits=y.getParameter(y.DEPTH_BITS),this.viewport=new d(0,0,y.drawingBufferWidth,y.drawingBufferHeight),this.globe=new o(l||new i),this.layers=[],this.navigator=new c(this),this.controller=h&&new h(this)||new b(this),this.verticalExaggeration=1,this.deepPicking=!1,this.subsurfaceMode=!1,this.surfaceOpacity=1,this.frameStatistics=new n,this.fieldOfView=45,this.goToAnimator=new s(this),this._redrawCallbacks=[],this._orderedRenderingFilters=[function(t){v.declutter(t,1)},function(t){v.declutter(t,2)}],this.pixelScale=1;var v=this;this.canvas.addEventListener("webglcontextlost",f,!1),this.canvas.addEventListener("webglcontextrestored",p,!1),this.canvas.addEventListener(WorldWind.REDRAW_EVENT_TYPE,g,!1),window.addEventListener(WorldWind.REDRAW_EVENT_TYPE,g,!1),this.animationFrameLoop()};return Object.defineProperties(w.prototype,{orderedRenderingFilters:{get:function(){return this._orderedRenderingFilters}},redrawCallbacks:{get:function(){return this._redrawCallbacks}}}),w.prototype.canvasCoordinates=function(t,e){var r=this.canvas.getBoundingClientRect(),i=t-(r.left+this.canvas.clientLeft),n=e-(r.top+this.canvas.clientTop);return new v(i,n)},w.prototype.addEventListener=function(e,r){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","addEventListener","missingType"));if(!r)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","addEventListener","missingListener"));var i=this,n=this.eventListeners[e];n||(n={listeners:[],callback:function(t){t.worldWindow=i;for(var e=0,r=n.listeners.length;e<r;e++)n.listeners[e](t)}},this.eventListeners[e]=n);var o=n.listeners.indexOf(r);o==-1&&(n.listeners.splice(0,0,r),1==n.listeners.length&&this.canvas.addEventListener(e,n.callback,!1))},w.prototype.removeEventListener=function(e,r){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingType"));if(!r)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingListener"));var i=this.eventListeners[e];if(i){var n=i.listeners.indexOf(r);n!=-1&&(i.listeners.splice(n,1),0==i.listeners.length&&this.canvas.removeEventListener(e,i.callback,!1))}},w.prototype.redraw=function(){this.redrawRequested=!0},w.prototype.pick=function(e){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","pick","missingPoint"));return this.drawContext.currentGlContext.isContextLost()?new f:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.pickPoint=e,this.drawFrame(),this.drawContext.objectsAtPickPoint)},w.prototype.pickTerrain=function(e){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","pickTerrain","missingPoint"));return this.drawContext.currentGlContext.isContextLost()?new f:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.pickTerrainOnly=!0,this.drawContext.pickPoint=e,this.drawFrame(),this.drawContext.objectsAtPickPoint)},w.prototype.pickShapesInRegion=function(e){if(!e)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","pickShapesInRegion","missingRectangle"));return this.drawContext.currentGlContext.isContextLost()?new f:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.regionPicking=!0,this.drawContext.pickRectangle=new d(e.x,this.canvas.height-e.y,e.width,e.height),this.drawFrame(),this.drawContext.objectsAtPickPoint)},w.prototype.createContext=function(t){var e={antialias:!1,stencil:!0},r=t.getContext("webgl",e);r||(r=t.getContext("experimental-webgl",e));var i=r.getContextAttributes();return this.hasStencilBuffer=i.stencil,r},w.prototype.handleContextLost=function(t){u.log(u.LEVEL_INFO,"WebGL context event: "+t.statusMessage),t.preventDefault(),this.drawContext.contextLost(),window.cancelAnimationFrame(this.redrawRequestId)},w.prototype.handleContextRestored=function(t){u.log(u.LEVEL_INFO,"WebGL context event: "+t.statusMessage),this.drawContext.contextRestored(),this.redraw(),this.animationFrameLoop()},w.prototype.handleRedrawEvent=function(t){this.redraw()},w.prototype.animationFrameLoop=function(){function t(){e.animationFrameLoop()}this.redrawIfNeeded();var e=this;this.redrawRequestId=window.requestAnimationFrame(t)},w.prototype.redrawIfNeeded=function(){if(this.resize(),this.redrawRequested)try{this.redrawRequested=!1,this.drawContext.previousRedrawTimestamp=this.drawContext.timestamp,this.callRedrawCallbacks(WorldWind.BEFORE_REDRAW),this.resetDrawContext(),this.drawFrame()}catch(t){u.logMessage(u.LEVEL_SEVERE,"WorldWindow","redrawIfNeeded","Exception occurred during redrawing.\n"+t.toString())}finally{this.callRedrawCallbacks(WorldWind.AFTER_REDRAW),this.drawContext.redrawRequested&&(this.redrawRequested=!0)}},w.prototype.resize=function(){var t=this.drawContext.currentGlContext,e=t.canvas.clientWidth*this.pixelScale,r=t.canvas.clientHeight*this.pixelScale;t.canvas.width==e&&t.canvas.height==r||(t.canvas.width=e,t.canvas.height=r,t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),this.viewport=new d(0,0,t.drawingBufferWidth,t.drawingBufferHeight),this.redrawRequested=!0)},w.prototype.resetDrawContext=function(){this.globe.offset=0;var t=this.drawContext;t.reset(),t.globe=this.globe,t.layers=this.layers,t.navigatorState=this.navigator.currentState(this.globe),t.verticalExaggeration=this.verticalExaggeration,t.surfaceOpacity=this.surfaceOpacity,t.deepPicking=this.deepPicking,t.frameStatistics=this.frameStatistics,t.pixelScale=this.pixelScale,t.update()},w.prototype.drawFrame=function(){try{this.drawContext.frameStatistics.beginFrame(),this.beginFrame(),this.drawContext.globe.is2D()&&this.drawContext.globe.continuous?this.do2DContiguousRepaint():this.doNormalRepaint()}finally{this.endFrame(),this.drawContext.frameStatistics.endFrame()}},w.prototype.doNormalRepaint=function(){this.createTerrain(),this.clearFrame(),this.deferOrderedRendering=!1,this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.doPick(),this.resolvePick()):(this.doDraw(),this.subsurfaceMode&&this.hasStencilBuffer&&(this.redrawSurface(),this.drawScreenRenderables()))},w.prototype.do2DContiguousRepaint=function(){this.createTerrain2DContiguous(),this.clearFrame(),this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.pick2DContiguous(),this.resolvePick()):this.draw2DContiguous()},w.prototype.resolvePick=function(){this.drawContext.pickTerrainOnly?this.resolveTerrainPick():this.drawContext.regionPicking?this.resolveRegionPick():this.resolveTopPick()},w.prototype.beginFrame=function(){var t=this.drawContext.currentGlContext;t.enable(t.BLEND),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.depthFunc(t.LEQUAL),this.drawContext.pickingMode&&(this.drawContext.makePickFramebuffer(),this.drawContext.bindFramebuffer(this.drawContext.pickFramebuffer))},w.prototype.endFrame=function(){var t=this.drawContext.currentGlContext;t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.blendFunc(t.ONE,t.ZERO),t.depthFunc(t.LESS),t.clearColor(0,0,0,1),this.drawContext.bindFramebuffer(null),this.drawContext.bindProgram(null)},w.prototype.clearFrame=function(){var t=this.drawContext,e=t.currentGlContext;e.clearColor(t.clearColor.red,t.clearColor.green,t.clearColor.blue,t.clearColor.alpha),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)},w.prototype.doDraw=function(){this.drawContext.renderShapes=!0,this.subsurfaceMode&&this.hasStencilBuffer?(this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables(),this.drawContext.screenCreditController.drawCredits(this.drawContext))):(this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables()),this.drawContext.screenCreditController.drawCredits(this.drawContext))},w.prototype.redrawSurface=function(){this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.EQUAL,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.KEEP,this.drawContext.currentGlContext.KEEP,this.drawContext.currentGlContext.KEEP),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!1),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST)},w.prototype.doPick=function(){this.drawContext.terrain&&this.drawContext.terrain.pick(this.drawContext),this.drawContext.pickTerrainOnly||(this.subsurfaceMode&&this.hasStencilBuffer?(this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables(),this.drawContext.terrain.pick(this.drawContext),this.drawScreenRenderables())):(this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables())))},w.prototype.createTerrain=function(){var t=this.drawContext;t.terrain=this.globe.tessellator.tessellate(t),t.frameStatistics.setTerrainTileCount(t.terrain?t.terrain.surfaceGeometry.length:0)},w.prototype.makeCurrent=function(t){var e=this.drawContext;switch(e.globe.offset=t,e.globeStateKey=e.globe.stateKey,t){case-1:e.terrain=this.terrainLeft;break;case 0:e.terrain=this.terrainCenter;break;case 1:e.terrain=this.terrainRight}},w.prototype.createTerrain2DContiguous=function(){var t=this.drawContext;this.terrainCenter=null,t.globe.offset=0,t.globeStateKey=t.globe.stateKey,t.globe.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)&&(this.terrainCenter=t.globe.tessellator.tessellate(t)),this.terrainRight=null,t.globe.offset=1,t.globeStateKey=t.globe.stateKey,t.globe.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)&&(this.terrainRight=t.globe.tessellator.tessellate(t)),this.terrainLeft=null,t.globe.offset=-1,t.globeStateKey=t.globe.stateKey,t.globe.intersectsFrustum(t.navigatorState.frustumInModelCoordinates)&&(this.terrainLeft=t.globe.tessellator.tessellate(t))},w.prototype.draw2DContiguous=function(){var t="";this.terrainCenter&&(t+=" 0 ",this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doDraw()),this.terrainRight&&(t+=" 1 ",this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doDraw()),this.deferOrderedRendering=!1,this.terrainLeft&&(t+=" -1 ",this.makeCurrent(-1),this.doDraw()),this.subsurfaceMode&&this.hasStencilBuffer&&(this.deferOrderedRendering=!0,this.terrainCenter&&(t+=" 0 ",this.makeCurrent(0),this.redrawSurface()),this.terrainRight&&(t+=" 1 ",this.makeCurrent(1),this.redrawSurface()),this.terrainLeft&&(t+=" -1 ",this.makeCurrent(-1),this.redrawSurface())),this.drawScreenRenderables()},w.prototype.pick2DContiguous=function(){this.terrainCenter&&(this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doPick()),this.terrainRight&&(this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doPick()),this.deferOrderedRendering=!1,this.terrainLeft&&(this.makeCurrent(-1),this.doPick())},w.prototype.drawLayers=function(t){var e,r=Date.now(),i=this.drawContext,n=i.layers;i.accumulateOrderedRenderables=t;for(var o=0,a=n.length;o<a;o++)if(e=n[o]){i.currentLayer=e;try{e.render(i)}catch(t){u.log(u.LEVEL_SEVERE,"Error while rendering layer "+e.displayName+".\n"+t.toString())}}var s=Date.now();i.frameStatistics.layerRenderingTime=s-r},w.prototype.addLayer=function(t){this.layers.push(t)},w.prototype.removeLayer=function(t){if(t){for(var e=-1,r=0,i=this.layers.length;r<i;r++)if(this.layers[r]==t){e=r;break}e>=0&&this.layers.splice(e,1)}},w.prototype.insertLayer=function(t,e){e&&this.layers.splice(t,0,e)},w.prototype.drawSurfaceRenderables=function(){var t,e=this.drawContext;for(e.reverseSurfaceRenderables();t=e.popSurfaceRenderable();)try{t.renderSurface(e)}catch(t){u.logMessage(u.LEVEL_WARNING,"WorldWindow","drawSurfaceRenderables","Error while rendering a surface renderable.\n"+t.message)}},w.prototype.drawOrderedRenderables=function(){var t,e=Date.now(),r=this.drawContext;if(r.sortOrderedRenderables(),this._orderedRenderingFilters)for(var i=0;i<this._orderedRenderingFilters.length;i++)this._orderedRenderingFilters[i](this.drawContext);for(r.orderedRenderingMode=!0;t=r.popOrderedRenderable();)try{t.renderOrdered(r)}catch(t){u.logMessage(u.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering an ordered renderable.\n"+t.message)}r.orderedRenderingMode=!1,r.frameStatistics.orderedRenderingTime=Date.now()-e},w.prototype.drawScreenRenderables=function(){for(var t,e=this.drawContext;t=e.nextScreenRenderable();)try{t.renderOrdered(e)}catch(t){u.logMessage(u.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering a screen renderable.\n"+t.message)}},w.prototype.resolveTopPick=function(){if(0!=this.drawContext.objectsAtPickPoint.objects.length){var t=this.drawContext.objectsAtPickPoint,e=this.drawContext.readPickColor(this.drawContext.pickPoint),r=null,i=null;if(e){for(var n=0,o=t.objects.length;n<o;n++){var a=t.objects[n];if(a.isTerrain&&(i=a),a.color.equals(e)&&(a.isOnTop=!0,r=a,i))break}this.drawContext.deepPicking||(t.clear(),r&&t.add(r),i&&i!=r&&t.add(i))}else t.clear()}},w.prototype.resolveTerrainPick=function(){for(var t,e=this.drawContext.objectsAtPickPoint,r=0,i=e.objects.length;r<i;r++)if(t=e.objects[r],t.isTerrain){t.isOnTop=!0;break}},w.prototype.resolveRegionPick=function(){if(0!=this.drawContext.objectsAtPickPoint.objects.length)for(var t,e,r=this.drawContext.objectsAtPickPoint,i=this.drawContext.readPickColors(this.drawContext.pickRectangle),n=0,o=r.objects.length;n<o;n++)if(t=r.objects[n]){var a=t.color.toByteString();e=i[a],e?t.isOnTop=!0:t.userObject instanceof g&&(r.objects.splice(n,1),n-=1)}},w.prototype.callRedrawCallbacks=function(t){for(var e=0,r=this._redrawCallbacks.length;e<r;e++)try{this._redrawCallbacks[e](this,t)}catch(t){u.log(u.LEVEL_SEVERE,"Exception calling redraw callback.\n"+t.toString())}},w.prototype.goTo=function(t,e){this.goToAnimator.goTo(t,e)},w.prototype.declutter=function(e,r){if(!r)throw new t(u.logMessage(u.LEVEL_SEVERE,"WorldWindow","declutter","Group ID is null, undefined or 0."));for(var i=[],n=0;n<e.orderedRenderables.length;n++){var o=e.orderedRenderables[n].orderedRenderable;o.declutterGroup===r&&i.push(o)}for(var a=[],s=0;s<i.length;s++){var l=i[s],c=l.screenBounds;c&&c.intersectsRectangles(a)?l.targetVisibility=0:(l.targetVisibility=1,c&&a.push(c))}},w.prototype.computeViewingTransform=function(t,e){var r=.5*this.navigator.altitude,i=this.globe.horizonDistance(this.navigator.altitude);if(0!=this.depthBits){var n=(1<<this.depthBits)-1,o=10,a=i/(n/(1-o/i)-n+1);r>a&&(r=a)}t.setToPerspectiveProjection(this.viewport.width,this.viewport.height,this.fieldOfView,r,i),this.navigator.getAsCamera(this.globe,this.scratchCamera),this.globe.cameraToCartesianTransform(this.scratchCamera,e).invertOrthonormal(e)},w.prototype.distanceToViewGlobeExtents=function(){var t=Math.sin(E.toRadians(.5*this.fieldOfView)),e=this.globe.equatorialRadius;return e/t-e},w}),define("worldwind/util/WWMessage",[],function(){"use strict";var t=function(t,e){this.type=t,this.source=e};return t}),define("worldwind/WorldWind",["./error/AbstractError","./geom/Angle","./shapes/Annotation","./shapes/AnnotationAttributes","./util/measure/AreaMeasurer","./error/ArgumentError","./layer/AtmosphereLayer","./shaders/AtmosphereProgram","./shaders/BasicProgram","./shaders/BasicTextureProgram","./util/BasicTimeSequence","./navigate/WorldWindowController","./layer/BingAerialLayer","./layer/BingAerialWithLabelsLayer","./layer/BingRoadsLayer","./layer/BingWMSLayer","./layer/BMNGLandsatLayer","./layer/BMNGLayer","./layer/BMNGOneImageLayer","./layer/BMNGRestLayer","./geom/BoundingBox","./navigate/Camera","./gesture/ClickRecognizer","./formats/collada/ColladaLoader","./util/Color","./shapes/Compass","./layer/CompassLayer","./layer/CoordinatesDisplayLayer","./util/Date","./layer/DigitalGlobeTiledImageLayer","./gesture/DragRecognizer","./render/DrawContext","./globe/EarthElevationModel","./globe/EarthRestElevationModel","./globe/ElevationModel","./util/Font","./util/FrameStatistics","./layer/FrameStatisticsLayer","./render/FramebufferTexture","./render/FramebufferTile","./render/FramebufferTileController","./geom/Frustum","./shapes/GeographicMesh","./projections/GeographicProjection","./shapes/GeographicText","./formats/geojson/GeoJSONGeometry","./formats/geojson/GeoJSONGeometryCollection","./formats/geojson/GeoJSONGeometryLineString","./formats/geojson/GeoJSONGeometryMultiLineString","./formats/geojson/GeoJSONGeometryMultiPoint","./formats/geojson/GeoJSONGeometryMultiPolygon","./formats/geojson/GeoJSONGeometryPoint","./formats/geojson/GeoJSONGeometryPolygon","./formats/geojson/GeoJSONParser","./formats/geotiff/GeoTiffReader","./gesture/GestureRecognizer","./globe/Globe","./globe/Globe2D","./util/GoToAnimator","./shaders/GpuProgram","./cache/GpuResourceCache","./shaders/GpuShader","./shaders/GroundProgram","./util/HashMap","./util/HighlightController","./formats/kml/util/ImagePyramid","./util/ImageSource","./render/ImageTile","./util/Insets","./formats/kml/util/ItemIcon","./formats/kml/KmlAbstractView","./formats/kml/styles/KmlBalloonStyle","./formats/kml/KmlCamera","./formats/kml/styles/KmlColorStyle","./formats/kml/features/KmlContainer","./formats/kml/features/KmlDocument","./formats/kml/KmlElements","./formats/kml/features/KmlFeature","./formats/kml/KmlFile","./formats/kml/features/KmlFolder","./formats/kml/geom/KmlGeometry","./formats/kml/features/KmlGroundOverlay","./formats/kml/KmlIcon","./formats/kml/styles/KmlIconStyle","./formats/kml/styles/KmlLabelStyle","./formats/kml/KmlLatLonAltBox","./formats/kml/KmlLatLonBox","./formats/kml/KmlLatLonQuad","./formats/kml/geom/KmlLinearRing","./formats/kml/geom/KmlLineString","./formats/kml/styles/KmlLineStyle","./formats/kml/KmlLink","./formats/kml/styles/KmlListStyle","./formats/kml/KmlLocation","./formats/kml/KmlLod","./formats/kml/KmlLookAt","./formats/kml/geom/KmlMultiGeometry","./formats/kml/features/KmlNetworkLink","./formats/kml/KmlObject","./formats/kml/KmlOrientation","./formats/kml/features/KmlOverlay","./formats/kml/features/KmlPhotoOverlay","./formats/kml/features/KmlPlacemark","./formats/kml/geom/KmlPoint","./formats/kml/geom/KmlPolygon","./formats/kml/styles/KmlPolyStyle","./formats/kml/KmlRegion","./formats/kml/features/KmlScreenOverlay","./formats/kml/styles/KmlStyle","./formats/kml/styles/KmlStyleMap","./formats/kml/styles/KmlStyleSelector","./formats/kml/styles/KmlSubStyle","./formats/kml/KmlTimePrimitive","./formats/kml/KmlTimeSpan","./formats/kml/KmlTimeStamp","./formats/kml/features/KmlTour","./formats/kml/geom/KmlTrack","./layer/LandsatRestLayer","./layer/Layer","./util/measure/LengthMeasurer","./util/Level","./util/LevelRowColumnUrlBuilder","./util/LevelSet","./geom/Line","./geom/Location","./util/Logger","./navigate/LookAt","./geom/Matrix","./util/measure/MeasurerUtils","./cache/MemoryCache","./cache/MemoryCacheListener","./layer/MercatorTiledImageLayer","./navigate/Navigator","./navigate/NavigatorState","./util/NominatimGeocoder","./error/NotYetImplementedError","./util/Offset","./layer/OpenStreetMapImageLayer","./formats/kml/util/Pair","./gesture/PanRecognizer","./shapes/Path","./util/PeriodicTimeSequence","./pick/PickedObject","./pick/PickedObjectList","./gesture/PinchRecognizer","./shapes/Placemark","./shapes/PlacemarkAttributes","./geom/Plane","./shapes/Polygon","./util/PolygonSplitter","./geom/Position","./projections/ProjectionEquirectangular","./projections/ProjectionGnomonic","./projections/ProjectionMercator","./projections/ProjectionPolarEquidistant","./projections/ProjectionUPS","./projections/ProjectionWgs84","./geom/Rectangle","./render/Renderable","./layer/RenderableLayer","./layer/RestTiledImageLayer","./gesture/RotationRecognizer","./formats/kml/util/Scale","./formats/kml/util/Schema","./shapes/ScreenImage","./shapes/ScreenText","./geom/Sector","./shapes/ShapeAttributes","./formats/shapefile/Shapefile","./layer/ShowTessellationLayer","./shaders/SkyProgram","./layer/StarFieldLayer","./shaders/StarFieldProgram","./util/SunPosition","./shapes/SurfaceImage","./shapes/SurfaceCircle","./shapes/SurfaceEllipse","./shapes/SurfacePolygon","./shapes/SurfacePolyline","./shapes/SurfaceRectangle","./render/SurfaceRenderable","./shapes/SurfaceSector","./shapes/SurfaceShape","./shapes/SurfaceShapeTile","./shapes/SurfaceShapeTileBuilder","./render/SurfaceTile","./render/SurfaceTileRenderer","./shaders/SurfaceTileRendererProgram","./gesture/TapRecognizer","./layer/TectonicPlatesLayer","./globe/Terrain","./globe/TerrainTile","./globe/TerrainTileList","./globe/Tessellator","./shapes/Text","./shapes/TextAttributes","./render/TextSupport","./render/Texture","./render/TextureTile","./util/Tile","./layer/TiledImageLayer","./util/TileFactory","./gesture/TiltRecognizer","./gesture/Touch","./shapes/TriangleMesh","./error/UnsupportedOperationError","./geom/Vec2","./geom/Vec3","./layer/ViewControlsLayer","./formats/kml/util/ViewVolume","./util/WcsTileUrlBuilder","./ogc/wfs/WfsCapabilities","./ogc/wms/WmsCapabilities","./layer/WmsLayer","./ogc/wms/WmsLayerCapabilities","./layer/WmsTimeDimensionedLayer","./util/WmsUrlBuilder","./ogc/wmts/WmtsCapabilities","./layer/WmtsLayer","./ogc/wmts/WmtsLayerCapabilities","./WorldWindow","./navigate/WorldWindowController","./util/WWMath","./util/WWMessage","./util/WWUtil","./util/XmlDocument","./globe/ZeroElevationModel"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b,E,w,_,x,S,T,M,L,A,N,C,R,P,O,I,k,D,V,F,G,B,W,U,z,j,K,q,Z,H,$,Y,X,J,Q,tt,et,rt,it,nt,ot,at,st,lt,ut,ct,ht,ft,dt,pt,gt,mt,yt,vt,bt,Et,wt,_t,xt,St,Tt,Mt,Lt,At,Nt,Ct,Rt,Pt,Ot,It,kt,Dt,Vt,Ft,Gt,Bt,Wt,Ut,zt,jt,Kt,qt,Zt,Ht,$t,Yt,Xt,Jt,Qt,te,ee,re,ie,ne,oe,ae,se,le,ue,ce,he,fe,de,pe,ge,me,ye,ve,be,Ee,we,_e,xe,Se,Te,Me,Le,Ae,Ne,Ce,Re,Pe,Oe,Ie,ke,De,Ve,Fe,Ge,Be,We,Ue,ze,je,Ke,qe,Ze,He,$e,Ye,Xe,Je,Qe,tr,er,rr,ir,nr,or,ar,sr,lr,ur,cr,hr,fr,dr,pr,gr,mr,yr,vr,br,Er,wr,_r,xr,Sr,Tr,Mr,Lr,Ar,Nr,Cr,Rr,Pr,Or,Ir,kr,Dr,Vr,Fr,Gr,Br,Wr,Ur,zr,jr,Kr,qr,Zr,Hr,$r,Yr,Xr,Jr,Qr,ti,ei,ri,ii,ni,oi,ai,si,li,ui,ci){
"use strict";var hi={VERSION:"0.0.0",ABSOLUTE:"absolute",AFTER_REDRAW:"afterRedraw",BEFORE_REDRAW:"beforeRedraw",BEGAN:"began",CANCELLED:"cancelled",CHANGED:"changed",CLAMP_TO_GROUND:"clampToGround",EARTH_RADIUS:6371e3,EAST:"east",ENDED:"ended",FAILED:"failed",GREAT_CIRCLE:"greatCircle",LINEAR:"linear",MULTI_POINT:"multiPoint",NORTH:"north",NULL:"null",OFFSET_FRACTION:"fraction",OFFSET_INSET_PIXELS:"insetPixels",OFFSET_PIXELS:"pixels",POINT:"point",POLYLINE:"polyline",POLYGON:"polygon",POSSIBLE:"possible",RECOGNIZED:"recognized",REDRAW_EVENT_TYPE:"WorldWindRedraw",RELATIVE_TO_GLOBE:"relativeToGlobe",RELATIVE_TO_GROUND:"relativeToGround",RELATIVE_TO_SCREEN:"relativeToScreen",RHUMB_LINE:"rhumbLine",SOUTH:"south",WEST:"west"};return hi.AbstractError=t,hi.Angle=e,hi.Annotation=r,hi.AnnotationAttributes=i,hi.AreaMeasurer=n,hi.ArgumentError=o,hi.AtmosphereLayer=a,hi.AtmosphereProgram=s,hi.BasicProgram=l,hi.BasicTextureProgram=u,hi.BasicTimeSequence=c,hi.BasicWorldWindowController=h,hi.BingAerialLayer=f,hi.BingAerialWithLabelsLayer=d,hi.BingRoadsLayer=p,hi.BingWMSLayer=g,hi.BMNGLandsatLayer=m,hi.BMNGLayer=y,hi.BMNGOneImageLayer=v,hi.BMNGRestLayer=b,hi.BoundingBox=E,hi.Camera=w,hi.ClickRecognizer=_,hi.ColladaLoader=x,hi.Color=S,hi.Compass=T,hi.CompassLayer=M,hi.CoordinatesDisplayLayer=L,hi.DateWW=A,hi.DigitalGlobeTiledImageLayer=N,hi.DragRecognizer=C,hi.DrawContext=R,hi.EarthElevationModel=P,hi.EarthRestElevationModel=O,hi.ElevationModel=I,hi.Font=k,hi.FrameStatistics=D,hi.FrameStatisticsLayer=V,hi.FramebufferTexture=F,hi.FramebufferTile=G,hi.FramebufferTileController=B,hi.Frustum=W,hi.GeographicMesh=U,hi.GeographicProjection=z,hi.GeographicText=j,hi.GeoJSONGeometry=K,hi.GeoJSONGeometryCollection=q,hi.GeoJSONGeometryLineString=Z,hi.GeoJSONGeometryMultiLineString=H,hi.GeoJSONGeometryMultiPoint=$,hi.GeoJSONGeometryMultiPolygon=Y,hi.GeoJSONGeometryPoint=X,hi.GeoJSONGeometryPolygon=J,hi.GeoJSONParser=Q,hi.GeoTiffReader=tt,hi.GestureRecognizer=et,hi.Globe=rt,hi.Globe2D=it,hi.GoToAnimator=nt,hi.GpuProgram=ot,hi.GpuResourceCache=at,hi.GpuShader=st,hi.GroundProgram=lt,hi.HashMap=ut,hi.HighlightController=ct,hi.ImageSource=ft,hi.ImageTile=dt,hi.Insets=pt,hi.KmlFile=St,hi.LandsatRestLayer=ue,hi.Layer=ce,hi.LengthMeasurer=he,hi.Level=fe,hi.LevelRowColumnUrlBuilder=de,hi.LevelSet=pe,hi.Line=ge,hi.Location=me,hi.Logger=ye,hi.LookAt=ve,hi.Matrix=be,hi.MeasurerUtils=Ee,hi.MemoryCache=we,hi.MemoryCacheListener=_e,hi.MercatorTiledImageLayer=xe,hi.Navigator=Se,hi.NavigatorState=Te,hi.NominatimGeocoder=Me,hi.NotYetImplementedError=Le,hi.Offset=Ae,hi.OpenStreetMapImageLayer=Ne,hi.PanRecognizer=Re,hi.Path=Pe,hi.PeriodicTimeSequence=Oe,hi.PickedObject=Ie,hi.PickedObjectList=ke,hi.PinchRecognizer=De,hi.Placemark=Ve,hi.PlacemarkAttributes=Fe,hi.Plane=Ge,hi.Polygon=Be,hi.PolygonSplitter=We,hi.Position=Ue,hi.ProjectionEquirectangular=ze,hi.ProjectionGnomonic=je,hi.ProjectionMercator=Ke,hi.ProjectionPolarEquidistant=qe,hi.ProjectionUPS=Ze,hi.ProjectionWgs84=He,hi.Rectangle=$e,hi.Renderable=Ye,hi.RenderableLayer=Xe,hi.RestTiledImageLayer=Je,hi.RotationRecognizer=Qe,hi.ScreenText=ir,hi.ScreenImage=rr,hi.Sector=nr,hi.ShapeAttributes=or,hi.Shapefile=ar,hi.ShowTessellationLayer=sr,hi.SkyProgram=lr,hi.StarFieldLayer=ur,hi.StarFieldProgram=cr,hi.SunPosition=hr,hi.SurfaceImage=fr,hi.SurfaceCircle=dr,hi.SurfaceEllipse=pr,hi.SurfacePolygon=gr,hi.SurfacePolyline=mr,hi.SurfaceRectangle=yr,hi.SurfaceRenderable=vr,hi.SurfaceSector=br,hi.SurfaceShape=Er,hi.SurfaceShapeTile=wr,hi.SurfaceShapeTileBuilder=_r,hi.SurfaceTile=xr,hi.SurfaceTileRenderer=Sr,hi.SurfaceTileRendererProgram=Tr,hi.TapRecognizer=Mr,hi.TectonicPlatesLayer=Lr,hi.Terrain=Ar,hi.TerrainTile=Nr,hi.TerrainTileList=Cr,hi.Tessellator=Rr,hi.Text=Pr,hi.TextAttributes=Or,hi.TextSupport=Ir,hi.Texture=kr,hi.TextureTile=Dr,hi.Tile=Vr,hi.TiledImageLayer=Fr,hi.TileFactory=Gr,hi.TiltRecognizer=Br,hi.Touch=Wr,hi.TriangleMesh=Ur,hi.UnsupportedOperationError=zr,hi.Vec2=jr,hi.Vec3=Kr,hi.ViewControlsLayer=qr,hi.WcsTileUrlBuilder=Hr,hi.WfsCapabilities=$r,hi.WmsCapabilities=Yr,hi.WmsLayer=Xr,hi.WmsLayerCapabilities=Jr,hi.WmsTimeDimensionedLayer=Qr,hi.WmsUrlBuilder=ti,hi.WmtsCapabilities=ei,hi.WmtsLayer=ri,hi.WmtsLayerCapabilities=ii,hi.WWMath=ai,hi.WWMessage=si,hi.WWUtil=li,hi.WorldWindow=ni,hi.WorldWindowController=oi,hi.ZeroElevationModel=ci,hi.configuration={gpuCacheSize:25e7,baseUrl:li.worldwindlibLocation()||li.currentUrlSansFilePart()+"/../"},hi.BingMapsKey=null,window.WorldWind=hi,hi}),define("scripts/Layer",["../worldwind/WorldWind"],function(t){var e=t.RenderableLayer,r=function(e){t.RenderableLayer.call(this,e)};return r.prototype=Object.create(e.prototype),r}),define("scripts/LayerGroup",["./Layer"],function(t){var e=function(){this.layers=[]};return e.prototype.addLayer=function(e,r){this.layers[e]=new t(r)},e.prototype.pushLayer=function(e){this.layers.push(new t(e))},e.prototype.setAll=function(t){this.layers.forEach(function(e){$.each(t,function(t,r){e[t]=r})})},e.prototype.setAllRend=function(t){var e=this;this.layers.forEach(function(r){r.renderables.forEach(function(r){$.each(t,function(t,i){e.setValue(r,t,i)})})})},e.prototype.setValue=function(t,e,r){"string"==typeof e&&(e=e.split(".")),e.length>1?this.setValue(t[e.shift()],e,r):t[e[0]]=r},e});var wwd,layers;define("scripts/AppConstructor",["./DataLoader","./GlobeHelper","./csvToGrid/Converter","./LayerGroup"],function(t,e,r,i){var n=function(){this.helper=e};return n.prototype.cleanAll=function(t){e.clean(t.smallVoxels,t.bigVoxels,t.gridlayer,t.globe)},n.prototype.init=function(t,e){e.init(t,this),this.cleanAll(e),(t.isCSV||t.isUrl)&&this.initCSV(t,e)},n.prototype.initCSV=function(t,i,n,o){e.clean(i.smallVoxels.layers,i.bigVoxels.layers,i.gridLayer,i.globe);var a=[];i.options=t,a[0]=t.config_0,a[0].data=t.csv.data,a[0].time=t.csv.time,a[0].delimiter=t.csv.delimiter;var s=t.sub,l=this,u=new Promise(function(e){n||t.isUrl?n&&!t.isUrl?e(i.allData):t.isUrl&&l.prepareWCS(t.config_0,e):r.loadData(t.csv.csvUrl,e,a[0].delimiter)});u.then(function(e){if(i.allData=e,n){for(n=i.getArea(),n||(n=i._navigator.getVisibleAreaBoundaries());n._top-n._bottom>30;)n._top-=1,n._bottom+=1;for(;n._right-n._left>30;)n._right-=1,n._left+=1;for(;(n._right-n._left)/(n._top-n._bottom)>1.3;)n._top+=.1,n._bottom+=.1}else n=i.getArea(),n||(n=i._navigator.getVisibleAreaBoundaries());t.isUrl&&(a[0].data=[0],a[0].time=3,a[0].lat=1,a[0].lng=2);try{if(o&&(e=r.filterData(e,a[0],n,o)),e.length>0){var l=r.initData(e,a[0],0);e.bounds=r.getDataBounds(e,a[0],0),a[0].heightExtrusion&&(e.bounds1=r.getDataBounds(e,a[0],1));var u=JSON.stringify(r.initJson(l,t.csv.zone,t.csv.quadSub,t.csv.source)),c=new Promise(function(t){i.gridLayer=i.loadGrid(u,1,t)});c.then(function(){var t,n=i.createRect(s,i.gridLayer);if("undefined"!=typeof Worker)var o=new Promise(function(e){t=new Worker("src/scripts/workers/setGridtoData.js"),t.postMessage([u,l.times,a[0]]),t.onmessage=function(t){e(t.data)}});else l.times=r.setGridtoData(u,l.times,a[0]);o.then(function(t){l.times=JSON.parse(t),i.myData[0]=e,i.doxelFromData(l.allTime,l.times,a),i.allTime=l.allTime,i.times=l.times,i.rectInit(n),i.tiling=!1}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})}else $("#loading").show()}catch(t){$("#loading").hide(),alert("Error occurred"),i.tiling=!1,console.log(t+"Error in parsing file")}}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})},n.prototype.initGridData=function(e,r){var i=[];i[0]=e.config_0;var n=e.sub,o=[],a=new t(this,0);r.dataLoaded=0;var s=new Promise(function(t){var i=e.gridUrl;if(e.isLocal){var n=new FileReader;n.onload=function(){i=n.result},n.readAsText(e.gridUrl),n.onloadend=function(){r.gridLayer=r.loadGrid(i,1,t)}}else r.gridLayer=r.loadGrid(i,0,t)}),l=new Promise(function(t){s.then(function(){a.getData(i[0].url,t,i[0])}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})});l.then(function(t){r.myData[0]=t;var e=[],n={},o=r.dataParser(t,e,n,i[0],0);r.allTime=o.allTime,r.times=o.times,r.doxelFromData(o.allTime,o.times,i)}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)}),i[0].half&&new Promise(function(t){o[1].getData(i[1].url,t,i[0])}),Promise.all([l,s]).then(function(){var t=r.createRect(n,r.gridLayer);r.rectInit(t)}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})},n.prototype.newData=function(r,n){for(var o=n.globe.layers.length,a=4;a<=o;a++)n.globe.removeLayer(n.globe.layers[a]);e.clean(n.smallVoxels.layers,n.bigVoxels.layers,n.gridLayer,n.globe),n.smallVoxels=new i,n.config[1]=r;var s=new t(this,1),l=new Promise(function(t){s.getData(r.url,t,r)});l.then(function(t){n.myData[1]=t;var e=n.dataParser(t,n.allTime,n.times,r,1);n.allTime=e.allTime,n.times=e.times,[n.allTime,n.times]=n.sliceTime(n.allTime,n.times),n.doxelFromData(n.allTime,n.times,n.config,1)}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})},n.prototype.addCsv=function(t){if(t.options&&t.autoTile&&!t.tiling){$("#loading").show(),t.tiling=!0;var r=e.getMaxTile();this.initCSV(t.options,t,1,r)}},n.prototype.prepareWCS=function(t,e){var r=gInterface.getArea();for(r||(r=gInterface._navigator.getVisibleAreaBoundaries());r._top-r._bottom>40;)r._top-=1,r._bottom+=1;for(;r._right-r._left>40;)r._right-=1,r._left+=1;var i=t.monthRange1,n=t.monthRange2,o=new Promise(function(e){var o=t.url,a=t.coverage,s='<?xml version="1.0" encoding="UTF-8" ?><ProcessCoveragesRequest xmlns="http://www.opengis.net/wcps/1.0" service="WCPS" version="1.0.0">  <query>    <abstractSyntax>      for c in ('+a+") return encode(c[Lat("+r._bottom+":"+r._top+"), Long("+r._left+":"+r._right+'), ansi("2014-'+i+'":"2014-'+n+'")], "csv")    </abstractSyntax>  </query></ProcessCoveragesRequest>';$.ajax({type:"POST",url:o,data:s,contentType:"application/json; charset=utf-8",success:function(t){e(t)}})});o.then(function(t){var o=[],a=n-i+1;t=t.split("}},");for(var s=-.1,l=0;l<t.length;l++){var u=t[l].replace(/\{|\}/g,"");u=u.split(","),s+=.1;for(var c=-.1,h=0;h<u.length/a;h++){c+=.1;for(var f=0;f<a;f++){var d=Number(u[h+f]);d<999&&o.push([d,r._bottom+c,r._left+s,f+1])}}}e(o)}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})},n}),define("scripts/Voxel",[],function(){var t=function(t,e){var r=[],i=[],n=[],o=[],a=[];n[0]=t[0].lat,o[0]=t[0].lng,n[1]=t[3].lat,o[1]=t[3].lng,n[2]=t[1].lat,o[2]=t[1].lng,n[3]=t[2].lat,o[3]=t[2].lng,a[0]=t.altitude,a[1]=a[0]+t.height;var s=[];r.push(new WorldWind.Position(n[1],o[1],a[0])),r.push(new WorldWind.Position(n[1],o[1],a[1])),r.push(new WorldWind.Position(n[0],o[0],a[0])),i.push(0),i.push(1),i.push(2),r.push(new WorldWind.Position(n[0],o[0],a[1])),r.push(new WorldWind.Position(n[0],o[0],a[0])),r.push(new WorldWind.Position(n[1],o[1],a[1])),i.push(3),i.push(4),i.push(5),r.push(new WorldWind.Position(n[1],o[1],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[1])),r.push(new WorldWind.Position(n[0],o[0],a[1])),i.push(6),i.push(7),i.push(8),r.push(new WorldWind.Position(n[1],o[1],a[1])),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[1])),i.push(9),i.push(10),i.push(11),r.push(new WorldWind.Position(n[1],o[1],a[1])),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[1],o[1],a[0])),i.push(12),i.push(13),i.push(14),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[3],o[3],a[0])),r.push(new WorldWind.Position(n[1],o[1],a[0])),i.push(15),i.push(16),i.push(17),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[0])),r.push(new WorldWind.Position(n[3],o[3],a[0])),i.push(18),i.push(19),i.push(20),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),r.push(new WorldWind.Position(n[3],o[3],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[0])),i.push(21),i.push(22),i.push(23),r.push(new WorldWind.Position(n[2],o[2],a[1])),r.push(new WorldWind.Position(n[2],o[2],a[0])),r.push(new WorldWind.Position(n[0],o[0],a[1])),i.push(24),i.push(25),i.push(26),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),r.push(new WorldWind.Position(n[2],o[2],a[0])),r.push(new WorldWind.Position(n[0],o[0],a[0])),r.push(new WorldWind.Position(n[0],o[0],a[1])),i.push(27),i.push(28),i.push(29);var l=new WorldWind.ShapeAttributes(null);l.drawOutline=!1,l.applyLighting=!0;var u=new WorldWind.TriangleMesh(r,i,l);if(e.length>1){var c=document.createElement("canvas"),h=c.getContext("2d"),f=h.createLinearGradient(0,0,0,c.height);f.addColorStop(0,e[0]),f.addColorStop(.49,e[0]),f.addColorStop(.51,e[1]),f.addColorStop(1,e[1]),h.fillStyle=f,h.fillRect(0,0,c.width,c.height),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(0,0)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),s.push(new WorldWind.Vec2(1,1)),l.imageSource=new WorldWind.ImageSource(c),u.textureCoordinates=s}else l.interiorColor=e;return u.point={0:n[0],1:o[0]},u};return t}),define("scripts/GlobeInterface",["./Voxel","./GlobeHelper","../worldwind/WorldWind","./Layer","./LayerGroup"],function(t,e,r,i,n){var o=function(t){this.globe=t};return o.prototype.getArea=function(){var t=this.globe.canvas.width,e=this.globe.canvas.height,i=this.globe.controller.lookAt.range;if(this.globe.pickTerrain(new r.Vec2(t/2,e/2)).objects){var n=this.globe.pickTerrain(new r.Vec2(t/2,e/2));n=n.objects[0].position;var o=i/Math.cos(Math.PI/8),a=Math.sqrt(Math.pow(o,2)-Math.pow(i,2));a/=1e5;var s=n.latitude-a,l=n.latitude+a,u=n.longitude-a,c=n.longitude+a,h=(l-s)/10,f={_bottom:s-h,_left:u-h,_top:l+h,_right:c+h};return f}return null},o.prototype.init=function(t,e){this.heightCube=t.heightCube,this.gridUrl=t.gridUrl,this.heightDim=t.heightDim,this.maxShown=t.maxShown,this.maxInApp=t.maxInApp,this.startHeight=t.startHeight,this.autoTime=t.autoTime,this.statIndex=t.statIndex,this.maxDownload=t.maxDownload,this.colors=t.colors,this.config=[],this.config[0]=t.config_0,this.sub=t.sub,this.times={},this.smallVoxels=new n,this.bigVoxels=new n,this.dim={},this.rect=[],this.minTime=0,this.activeLayers=0,this.compare=0,this.parent=e,this.myData=[]},o.prototype.updateOpt=function(t){this.UI.resetTime(t[0]),this.autoTime=t[1],this.statIndex=t[2]},o.prototype.setUI=function(t){this.UI=t},o.prototype.dataParser=function(t,e,r,i,n){for(var o=t.length,a=0;a<o;a++){var s=t[a],l=s[i.time];if(e.indexOf(l)==-1){if(e.length>=this.maxInApp)break;e.push(l)}r[l]||(r[l]=[]),r[l][n]||(r[l][n]=[]);var u=[s[i.id]];for(var c in i.data)u.push(s[i.data[c]]);r[l][n].push(u)}return{allTime:e,times:r}},o.prototype.sliceTime=function(t,e){var r;for(r in e)e[r].length<2&&delete e[r];for(r in t)e[t[r]]||t.splice(r);return[t,e]},o.prototype.doxelFromData=function(t,e,r){if(this.dataLoaded++,this.config[1]){gInterface.maxShown=1;var i=this.config[1].reference}else var i=0;this.makeSmallLayers(t,e);var n=[this.colors,this.startHeight,this.heightCube];results=this.makeSmallDoxels(n,this.myData,this.gridLayer,t,e,r,i),this.resolveDoxel(results)},o.prototype.resolveDoxel=function(t){for(var e=0;e<t.length;e++)this.smallVoxels.layers[t[e][0]].addRenderables(t[e][1]);if(2==this.dataLoaded){this.UI.disableNewData(),this.UI.start();var r=this.createRect(this.sub,this.gridLayer);this.movingTemplate=r[0],this.rect=r[1],this.dim.x=r[2],this.dim.y=r[3],this.assignVoxels(r[1],this.gridLayer.renderables,this.smallVoxels.layers)}},o.prototype.loadGrid=function(t,e,i){var n=new r.RenderableLayer("GridLayer");return this.createJson(n,t,e,i),this.globe.addLayer(n),n},o.prototype.createJson=function(t,e,i,n){var o=function(t,e){var i={};return(t.isPolygonType()||t.isMultiPolygonType())&&(i.attributes=new r.ShapeAttributes(null),i.attributes.id=e.id,i.attributes.interiorColor=new r.Color(.3,.3,.3,.5),i.attributes.outlineColor=new r.Color(1,1,1,.8)),i},a=new r.GeoJSONParser(e);a.load(n,o,t)},o.prototype.makeBigDoxels=function(){var t,i,o=new n,a=this.heightDim,s=this.compare,l=this.smallVoxels.layers;l.forEach(function(t){t.renderables.forEach(function(t){t.enabled=!1,t.bigCubed=!0})}),a>this.maxShown&&(a=this.maxShown);var u={altitude:this.startHeight,height:this.activeLayers*this.heightCube/a};for(t=0;t<a;t++){this.bigVoxels&&this.bigVoxels.layers[t]&&this.globe.removeLayer(this.bigVoxels.layers[t]),o.pushLayer("bigVoxels_"+t),o.csv=!0,this.globe.addLayer(o.layers[t]);var c=this.rect;for(i=0;i<c.length;i++){var h=c[i],f=t+this.minTime,d=e.getStatistics(h,f,this.myData[s],this.statIndex,this.colors,this.config,this.compare),p=r.Color.colorFromBytes(d[0][0],d[0][1],d[0][2],d[0][3]),g=this.getBigVoxels(h,u,p);g.data=d[1],g.showAlt=!0,g.bigShow=!0,o.layers[t].addRenderable(g)}u.altitude=u.altitude+u.height}this.bigVoxels=o},o.prototype.makeSmallLayers=function(t,e){this.activeLayers=0;for(var r=this.smallVoxels,i=[],n=t.length,o=0;o<n&&i.indexOf(o)==-1&&(i.push(o),!this.config[1]||e[t[o]][0]&&e[t[o]][1]);o++)r.addLayer(o,o),r.layers[o].enabled=!0,r.layers[o].active=!0,this.activeLayers++,o>=this.maxShown&&(r.layers[o].enabled=!1,r.layers[o].active=!1,this.activeLayers--),r.layers[o].heightLayer=o,r.csv=!0,this.globe.addLayer(r.layers[o])},o.prototype.makeSmallDoxels=function(i,n,o,a,s,l,u,c){for(var h=[],f=i[0],d=i[1],p=i[2],g=a.length,m=0;m<g;m++){var y,v,b,E,w,_,x,S=[],T=s[a[m]][u],M=T.length;l[1]&&(M=Math.min(s[a[m]][0].length,s[a[m]][1].length));for(var L=0;L<o.renderables.length&&(!l[1]||s[a[m]][1][L]);L++){var A,N=o.renderables,C=N[L].attributes.id,R=!1,P=[];P.number=0,P.values=0,P.position=0;for(var O=0;O<M-1;O++){var I=T[O][0];if(C==I&&(A=N[L],A&&A._boundaries)){if(R=!0,l[1]&&(y=[],w=[]),s[a[m]][1]){v=s[a[m]][1][O][1].split(".").join("");var k=n[1].bounds[0],D=n[1].bounds[1],V=e.getColor((v-D)/(k-D)*100,f);y.push("rgb("+V[0]+","+V[1]+","+V[2]+")"),w.push(s[a[m]][1][O]),x=v}v=l[0].separator?s[a[m]][u][O][1].split(l[0].separator).join(""):s[a[m]][u][O][1],_=v,P.values+=Number(v),P.number++,_=P.values/P.number;var F=n[0].bounds[0],G=n[0].bounds[1],B=e.getColor((v-G)/(F-G)*100,f);if(l[1]?(y.push("rgb("+B[0]+","+B[1]+","+B[2]+")"),w.push(s[a[m]][0][O])):(y=r.Color.colorFromBytes(B[0],B[1],B[2],B[3]),w=s[a[m]][u][O]),b=e.getCoords(A),b.altitude=d+m*p,b.height=p,l[0].heightExtrusion){v=l[0].separator?s[a[m]][u][O][2].split(l[0].separator).join(""):s[a[m]][u][O][2];var F=n[0].bounds1[0],G=n[0].bounds1[1],W=(v-G)/(F-G)*100;b.height=p+W*p/10}E=A.attributes.id;var U=new t(b,y);U.enabled=!0,U.info=w,U.heightLayer=m,U.data=[],U.data.push(_),l[1]&&U.data.push(x),U.filtered=!1,U.latlongfilter=!1,U.id=E,P.position?S[P.position]=U:(P.position=S.length,S.push(U))}}}h.push([m,S])}return h},o.prototype.assignVoxels=function(t,e,r){for(var i in e)for(var n=0;n<t.length;n++)r.forEach(function(e){e.renderables[i]&&t[n].containsPoint(e.renderables[i].point)&&t[n].cubes.push(e.renderables[i])})},o.prototype.getBigVoxels=function(e,r,i){var n={},o=this.dim;n[0]={},n[1]={},n[2]={},n[3]={},n[0].lat=e.x,n[0].lng=e.y,n[1].lat=e.x+o.x,n[1].lng=e.y,n[2].lat=e.x+o.x,n[2].lng=e.y+o.y,n[3].lat=e.x,n[3].lng=e.y+o.y,n.altitude=r.altitude,n.height=r.height;var a=new t(n,i);return a.enabled=!0,a.active=!0,a.height=n.height,a},o.prototype.createRect=function(t,e){var i,n=1/0,o=1/0,a=-(1/0),s=-(1/0);e.renderables.forEach(function(t){o=Math.min(o,t._boundaries[0].longitude),o=Math.min(o,t._boundaries[1].longitude),n=Math.min(n,t._boundaries[0].latitude),n=Math.min(n,t._boundaries[1].latitude),s=Math.max(s,t._boundaries[1].longitude),s=Math.max(s,t._boundaries[2].longitude),a=Math.max(a,t._boundaries[1].latitude),a=Math.max(a,t._boundaries[3].latitude),t.point={0:t._boundaries[0].latitude,1:t._boundaries[0].longitude}}),e.bounds={},e.bounds.minLng=o,e.bounds.minLat=n,e.bounds.maxLng=s,e.bounds.maxLat=a;var l=(a-n)/t,u=(s-o)/t,c=0,h=n,f=o,d=[];for(i=0;i<t;i++){for(var p=0;p<t;p++)d[c]=new r.Rectangle(h,f,l,u),d[c].cubes=[],c++,h+=l;f+=u,h=n}var g=new r.Rectangle(n-1e-5,o-1e-5,l*t,u*t);return[g,d,l,u]},o.prototype.rectInit=function(t){this.movingTemplate=t[0],this.rect=t[1],this.dim.x=t[2],this.dim.y=t[3],this.assignVoxels(t[1],this.gridLayer.renderables,this.smallVoxels.layers),this.UI.start()},o.prototype.changeAltitude=function(t){this.smallVoxels.setAll.call(this.smallVoxels,{enabled:!1}),this.bigVoxels.setAllRend.call(this.bigVoxels,{enabled:!1,showAlt:!1});var e,r=[Math.floor(this.heightDim*t[0]/this.activeLayers),Math.floor(this.heightDim*t[1]/this.activeLayers)],i=this.bigVoxels.layers;for(e=r[0];e<r[1];e++)i[e]&&i[e].renderables.forEach(function(t){t.active?(t.bigShow&&(t.enabled=!0),t.showAlt=!0):t.showAlt=!1});var n=this.smallVoxels.layers;for(e=t[0]+this.minTime;e<t[1]+this.minTime;e++)n[e].active&&(n[e].enabled=!0);this.globe.redraw()},o.prototype.setOpacity=function(t){this.smallVoxels.setAllRend.call(this.smallVoxels,{"_attributes.interiorColor.alpha":t}),this.bigVoxels.setAllRend.call(this.bigVoxels,{"_attributes.interiorColor.alpha":t})},o.prototype.filterValues=function(t){var e=this.compare,r=this.smallVoxels.layers;r.forEach(function(r){r.renderables.forEach(function(r){var i=r.data[e];i<t[0]||i>t[1]?(r.enabled=!1,r.filtered=!0):r.filtered&&(r.filtered=!1,r.latlongfilter||r.bigCubed||(r.enabled=!0))})})},o.prototype.changeTime=function(t){this.minTime=t;var e,r=this.startHeight;for(layers=this.smallVoxels.layers,layers.forEach(function(e,i){e.renderables.forEach(function(n,o){var a=n.positions[0].altitude,s=n.positions[7].altitude,l=n.positions;l.forEach(function(e){var n=e.altitude,o=s-a,l=Number(r+o*Number(i)-t*o);l+=n==a?0:s-a,e.altitude=l}),e.renderables[o].reset()})}),layers.forEach(function(t){t.enabled=!1,t.active=!1}),e=t;e<=this.activeLayers-1+t;e++)layers[e].enabled=!0,layers[e].active=!0;this.globe.redraw()},o.prototype.changeSize=function(t,e){var r,i=this.dim,n=this.movingTemplate,o=this.sub,a=this.gridLayer;e?(n.y=a.bounds.minLng+t[0],r=i.y*o-t[0],n.height=r,n.height=r-(i.y*o-t[1])):(n.x=a.bounds.minLat+t[0],r=i.x*o-t[0],n.width=r,n.width=r-(i.x*o-t[1]))},o.prototype.moveWindow=function(t){var e=this.rect,r=this.smallVoxels.layers,i=this.bigVoxels.layers,n=this.movingTemplate;t?r.forEach(function(t){t.renderables.forEach(function(t){n.containsPoint(t.point)&&t.enabled===!1&&e.forEach(function(e,r){t&&e.cubes.indexOf(t)!==-1&&n.intersects(e)&&(i.length>0?i.forEach(function(e){e.renderables[r].active?e.renderables[r].showAlt&&(e.renderables[r].enabled=!0,e.renderables[r].bigShow=!0):(t.latlongfilter=!1,t.filtered||(t.enabled=!0))}):(t.latlongfilter=!1,t.filtered||(t.enabled=!0)))})})}):r.forEach(function(t){t.renderables.forEach(function(t){n.containsPoint(t.point)||e.forEach(function(e,r){t&&e.cubes.indexOf(t)!==-1&&(i.length>0?i.forEach(function(e){e.renderables[r].active?(e.renderables[r].enabled=!1,e.renderables[r].bigShow=!1):(t.enabled=!1,t.latlongfilter=!0)}):(t.enabled=!1,t.latlongfilter=!0))})})})},o}),define("scripts/Globe",["../worldwind/WorldWind"],function(t){"use strict";var e=window.WorldWind,r=function(r){e.WorldWindow.call(this,r.id),this.addLayer(new e.BingAerialWithLabelsLayer),t.configuration.baseUrl=t.configuration.baseUrl.split("../")[0];var i="images/dnb_land.png",n=new t.StarFieldLayer("images/stars.json");this.atmosphereLayer=new t.AtmosphereLayer(i),this.addLayer(n),this.addLayer(this.atmosphereLayer),n.time=new Date,this.atmosphereLayer.lightLocation=t.SunPosition.getAsGeographicLocation(n.time),this.addLayer(new e.CoordinatesDisplayLayer(this)),this.layers[0].detailControl=1,this.layers[1].detailControl=1};return r.prototype=Object.create(t.WorldWindow.prototype),r}),define("scripts/Configurator",[],function(){var t=function(t){this.parent=t};return t.prototype.getConfig=function(t,e){Papa.parse(t,{worker:!1,download:!0,preview:1,fastMode:!0,complete:function(t){e(t.data[0])}})},t}),define("scripts/Chart",[],function(){var t=function(){google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback()};return t.prototype.draw=function(t,e){this.chart=new google.visualization.AreaChart($("#chart_div")[0]),this.chart.draw(t,e),this.started=1},t.prototype.setPoint=function(t,e){this.chart.setSelection([{row:t,column:e+1}])},t}),define("scripts/Correlation",[],function(){var t=function(){};return t.getCorrelationDatasets=function(t,e,r){var i,n,o,a,s=[],l=[],u=0,c=0;if(r[1]){for(i in e)if(e[i][0]&&e[i][1]){var h=Math.min(e[i][0].length,e[i][1].length);for(n=0;n<h;n++)o=e[i][0][n][0],a=r[0].separator?Number(e[i][0][n][1].split(r[0].separator).join("")):Number(e[i][0][n][1]),u+=a,o=e[i][1][n][0],a=r[0].separator?Number(e[i][1][n][1].split(r[1].separator).join("")):Number(e[i][1][n][1]),c+=a;s.push(u/e[i][0].length),l.push(c/e[i][1].length)}}else for(i in e){for(n=0;n<e[i][0].length;n++){if(o=e[i][0][n][0],e[i][0][n].length<3)return;a=r[0].separator?Number(e[i][0][n][1].split(r[0].separator).join("")):Number(e[i][0][n][1]),u+=a,a=r[0].separator?Number(e[i][0][n][2].split(r[0].separator).join("")):Number(e[i][0][n][2]),c+=a}s.push(u/e[i][0].length),l.push(c/e[i][0].length)}var f=[s,l],d=this.correlation(f,0,1);t(d)},t.getCorrelationVariables=function(t,e,r,i){var n,o,a,s,l,u,c=t.id,h=t.names,f=[h];for(n in e){var d=e[n];if(r[1]){if(d[0]&&d[1])for(o in d[0])if(d[0][o][0]==c){s=[],l=[n],u=d[0][o][1],r[0].separator&&(u=Number(u.split(r[0].separator).join(""))),l.push(Number(u));for(a in d[1])d[1][a][r[1].id]==c&&(u=d[1][o][r[1].data[0]],r[1].separator&&(u=Number(u.split(r[1].separator).join(""))));l.push(u),f.push(l)}}else for(o in d[0])if(d[0][o][0]==c){s=[],l=[n];for(var p=1;p<i+1;p++)u=d[0][o][p],r[0].separator&&(u=Number(u.split(r[0].separator).join(""))),l.push(Number(u));f.push(l)}}return f},t.correlation=function(t,e,r){var i=[];for(var n in t[e])t[r][n]&&i.push(n);var o=i.length;if(0===o)return 0;var a,s=0;for(a=0;a<i.length;a++)s+=t[e][i[a]];var l=0;for(a=0;a<i.length;a++)l+=t[r][i[a]];var u=0;for(a=0;a<i.length;a++)u+=Math.pow(t[e][i[a]],2);var c=0;for(a=0;a<i.length;a++)c+=Math.pow(t[r][i[a]],2);var h=0;for(a=0;a<i.length;a++)h+=t[e][i[a]]*t[r][i[a]];var f=h-s*l/o,d=Math.sqrt((u-Math.pow(s,2)/o)*(c-Math.pow(l,2)/o));return 0===d?0:f/d},t}),define("scripts/HandlePicks",["./Chart","./Correlation"],function(t,e){var r=function(){this.chart=new t};return r.prototype.getBigDoxels=function(t,e,r){var i=function(i){var n,o=i.clientX,a=i.clientY,s=r.pick(r.canvasCoordinates(o,a));if(s.objects.length>0)for(var l=0;l<s.objects.length;l++)if(s.objects[l].isOnTop){for(o in t)if(t[o].cubes.indexOf(s.objects[l].userObject)!=-1){for(n in e)e[n].renderables[o].enabled=!0,e[n].renderables[o].active=!0;var u;for(u in t[o].cubes)t[o].cubes[u]&&(t[o].cubes[u].enabled=!1,t[o].cubes[u].bigCubed=!0);r.redraw();break}for(n in e)for(o in e[n].renderables)if(e[n].renderables[o]==s.objects[l].userObject){for(var c in e)e[c].renderables[o].enabled=!1,e[c].renderables[o].active=!1;for(var h in t[o].cubes)t[o].cubes[h]&&(t[o].cubes[h].enabled=!0,t[o].cubes[h].bigCubed=!1);r.redraw();break}}};return i},r.prototype.getDoxel=function(t){var r=this,i=t.globe,n=t.compare,o=t.config,a=function(a){var s=a.clientX,l=a.clientY,u=i.pick(i.canvasCoordinates(s,l));if(u.objects.length>0)for(var c=0;c<u.objects.length;c++)if(u.objects[c].isOnTop){if(r.highLighted&&r.highLighted.userObject==u.objects[c].userObject)r.resetSelected();else{r.resetSelected(),r.highLighted=u.objects[c];for(s in u.objects[c].userObject._positions)u.objects[c].userObject._positions[s].altitude+=500;var h=u.objects[c].userObject.id;if(void 0!==h){var f=["Time"],d=[o[0].data];if(o[1])f.push("Set 1","Set 2"),d=[o[0].data,o[1].data];else for(var p=0;p<o[0].data.length;p++)f.push("Variable "+(p+1));var g={names:f,values:d,id:h};$("#bottomMenu").show();var m=t.myData[n].bounds[1],y=t.config[0].data.length,v=e.getCorrelationVariables(g,t.times,t.config,y);if(v.length>0)var b=google.visualization.arrayToDataTable(v);var E={title:"Voxel Data",hAxis:{title:"Timestamp",titleTextStyle:{color:"#333"},slantedText:!1},vAxis:{minValue:m,format:"scientific"}};if(r.chart.draw(b,E),o[0]||o[1].data.length>0){var w=[];for(w[0]=[],w[1]=[],s=0;s<v.length;s++)0!==s&&(w[0].push(v[s][1]),w[1].push(v[s][2]));var _=e.correlation(w,0,1);_=Number(Math.round(_+"e5")+"e-5");var x="variables";o[0]&&(x="datasets"),$("#correlationVoxel").text("Correlation between "+x+" in selected voxel: "+_)}var S=t.allTime[t.UI.oldValTime],T=0;for(s in v)v[s][0]==S&&(T=s-1);r.chart.setPoint(T,n),u.objects[c].userObject.reset(),u.objects[c].userObject._attributes._outlineColor=new WorldWind.Color(1,1,1,.65),u.objects[c].userObject._attributes._drawOutline=!0,i.redraw()}else b=u.objects[c].userObject.data,b&&($("#correlationVoxel").text("Value of selected Big Doxel: "+b),$("#bottomMenu").show())}$("#chart_div").show();break}};return a},r.prototype.resetSelected=function(){try{if(this.highLighted){for(var t in this.highLighted.userObject._positions)this.highLighted.userObject._positions[t].altitude-=500;this.highLighted.userObject._attributes._drawOutline=!1,this.highLighted.userObject.reset()}this.highLighted=""}catch(t){}},r}),define("scripts/UserInterface",["./Correlation"],function(t){var e=function(t){this.parent=t};return e.prototype.start=function(){var e=this.parent;this.oldValLng=[0,e.dim.y*e.sub],this.oldValLat=[0,e.dim.x*e.sub],this.oldValAlt=[0,e.activeLayers],this.oldValTime=0,this.startSlider(e),$("#minVal").html("Min: <br>"+e.myData[0].bounds[1]),$("#maxVal").html("Max: <br>"+e.myData[0].bounds[0]);if(e.config[0].data.length>1){var r=new Promise(function(r){t.getCorrelationDatasets(r,e.times,e.config)});r.then(function(t){var r=Number(Math.round(t+"e7")+"e-7");r||(r="unavailable");var i;i=e.config[1]?"datasets":"variables",$("#correlation").text("Correlation between "+i+": "+r)})}},e.prototype.disableNewData=function(){$("#compare").attr("disabled",!0),$("#compareOptions").hide()},e.prototype.resetTime=function(t){var e=this.parent;e.startHeight=t,e.changeAltitude(this.oldValAlt),e.changeTime(0),$("#sliderTime").slider("value",0),$("#timeSpan").html(e.allTime[0])},e.prototype.alert=function(t){var e=$("#alert");e.css("visibility","visible"),e.css("opacity",1),$("#alertContent").html(t)},e.prototype.startSlider=function(t){for(var e=this,r=t.rect,i=$("#sliderLng"),n=$("#LngSpan"),o=$("#sliderLat"),a=$("#LatSpan"),s=$("#sliderAlt"),l=$("#AltSpan"),u=$("#sliderTime"),c=$("#TimeSpan"),h=$("#sliderOpacity"),f=$("#OpacitySpan"),d=$("#sliderValues"),p=$("#ValuesSpan"),g=0,m=0;m<r.length;m++)g=Math.max(r[m].cubes.length,g);g=Math.floor(Math.sqrt(g)),i.slider({min:0,max:t.dim.y*t.sub,range:!0,step:t.dim.y/g,values:[0,t.dim.y*t.sub],slide:function(r,i){if(i.values[0]!=i.values[1]){n.html(Math.floor(i.values[0]/(t.dim.y*t.sub)*100)+" - "+Math.floor(i.values[1]/(t.dim.y*t.sub)*100)+"%"),t.changeSize(i.values,1);var o;o=i.values[0]>e.oldValLng[0]||i.values[1]<e.oldValLng[1]?0:1,t.moveWindow(o),t.globe.redraw(),e.oldValLng=i.values}}}),o.slider({min:0,max:t.dim.x*t.sub,range:!0,step:t.dim.x/g,values:[0,t.dim.x*t.sub],slide:function(r,i){if(i.values[0]!=i.values[1]){a.html(Math.floor(i.values[0]/(t.dim.x*t.sub)*100)+" - "+Math.floor(i.values[1]/(t.dim.x*t.sub)*100)+"%"),t.changeSize(i.values,0);var n;n=i.values[0]>e.oldValLat[0]||i.values[1]<e.oldValLat[1]?0:1,t.moveWindow(n),t.globe.redraw(),e.oldValLat=i.values}}}),p.html(t.myData[0].bounds[1]+" - "+t.myData[0].bounds[0]),d.slider({
min:t.myData[0].bounds[1],max:t.myData[0].bounds[0],range:!0,step:(t.myData[0].bounds[0]-t.myData[0].bounds[1])/100,values:[t.myData[0].bounds[1],t.myData[0].bounds[0]],slide:function(e,r){r.values[0]!=r.values[1]&&(p.html(r.values[0]+" - "+r.values[1]),t.filterValues(r.values),t.globe.redraw())}}),s.slider({min:0,max:t.activeLayers,step:1,range:!0,values:[0,t.activeLayers],slide:function(r,i){i.values[0]!=i.values[1]&&(l.html(i.values[0]+" - "+i.values[1]),t.changeAltitude(i.values),e.oldValAlt=i.values)}});var y=t.smallVoxels.layers.length-t.allTime.slice(0,t.activeLayers).length,v=t.allTime[0];if(c.html(v),u.slider({min:0,max:y,range:!1,step:1,slide:function(r,i){var n=t.allTime[i.value];if(c.html(n),t.changeTime(i.value),t.autoTime){var o=$("#checkCompare").is(":checked")?1:0;t.compare=o,t.UI.resetValueFilter(),t.makeBigDoxels()}var a=t.allTime[i.value],s=0;for(m in t.allTime)t.allTime[m]==a&&(s=m-1);var o=$("#checkCompare").is(":checked")?1:0;e.handlePick.chart.started&&e.handlePick.chart.setPoint(s,o),t.changeAltitude(e.oldValAlt),e.oldValTime=i.value}}),h.slider({min:0,max:100,range:!1,step:1,value:0,slide:function(e,r){var i=r.value;r.value<100&&r.value>95&&(i=95),r.value<5&&r.value>0&&(i=0),f.html(100-r.value+"%"),t.setOpacity((100-i)/100),t.globe.redraw()}}),$("#loading").hide(),!t.started){t.started=1,t.globe.navigator.latitude=t.gridLayer.renderables[1].point[0],t.globe.navigator.longitude=t.gridLayer.renderables[1].point[1],t.globe.controller.lookAt.range=2e5;var b=$("#my-tour-id1").tourbus({}),E=$("#my-tour-id").tourbus({});E.trigger("stop.tourbus"),tourStarted&&b.trigger("depart.tourbus")}},e.prototype.resetValueFilter=function(){gInterface=this.parent;var t=gInterface.compare;gInterface.filterValues([gInterface.myData[t].bounds[1],gInterface.myData[t].bounds[0]]),$("#sliderValues").slider("values",[gInterface.myData[t].bounds[1],gInterface.myData[t].bounds[0]]),$("#ValuesSpan").html(gInterface.myData[t].bounds[1]+" - "+gInterface.myData[t].bounds[0])},e}),define("scripts/map/BoundingBox",[],function(){"use strict";var t=function(t,e,r,i){this._top=r,this._left=e,this._bottom=t,this._right=i};return Object.defineProperties(t.prototype,{top:{get:function(){return this._top}},left:{get:function(){return this._left}},bottom:{get:function(){return this._bottom}},right:{get:function(){return this._right}}}),t.prototype.isPartiallyInArea=function(t){return this.isFullyInArea(t)||this.isFullyInAreaCrossingDateline(t)||this.isEnclosedByArea(t)||this.isPartInArea(t)},t.prototype.isPartInArea=function(t){var e=!(this.left>=t.right||t.left>=this.right||this.top<=t.bottom||t.top<=this.bottom);return e},t.prototype.isFullyInArea=function(t){var e=this.top<t.top&&this.left>t.left&&this.right<t.right&&this.bottom>t.bottom;return e},t.prototype.isFullyInAreaCrossingDateline=function(t){var e=this.top<t.top&&this.bottom>t.bottom&&this.left>t.left&&this.right>t.right&&t.right<t.left||this.top<t.top&&this.bottom>t.bottom&&this.right<t.right&&this.left<t.left&&t.right<t.left;return e},t.prototype.isEnclosedByArea=function(t){var e=this.top>t.top&&this.left<t.left&&this.right>t.right&&this.bottom<t.bottom;return e},t.prototype.toString=function(){return"["+this.top+","+this.left+","+this.bottom+","+this.right+"]"},t}),define("scripts/map/CoordConversions",[],function(){"use strict";var t=function(){};return t.prototype.isDatelineInViewport=function(t){for(var e=0,r=!1,i=0;i<t.length;i++)Math.abs(t[i][1]-e)>180&&(r=!0),e=t[i][1];return r},t.prototype.isPoleInViewport=function(t){var e=t.length,r=t[e/8],i=t[5*e/8];return Math.abs(r[1])+Math.abs(i[1])==180?r[0]>0&&i[0]>0?"north":r[0]<0&&i[0]<0?"south":"none":"none"},t.prototype.isPoleVisible=function(t){return t[0][1]-t[t.length/2][1]==0?"none":Math.abs(t[t.length/2][0])>=Math.abs(t[0][0])&&t[t.length/2][0]>0?"north":"south"},t.prototype.transformVisibleToBoundaries=function(t){return t<-180?360+t:t>180?-360+t:t},t.prototype.carto2geoConversion=function(t,e,r,i,n){t=t*Math.PI/180,e=e*Math.PI/180,i=i*Math.PI/180;var o,a=[],s=Math.asin(Math.sin(t)*Math.sin(r)-Math.cos(r)*Math.cos(t)*Math.cos(i));return o=this.poleVisibility(r,t)===!0&&t>=0?n===!0?Math.PI+Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e:-Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e:this.poleVisibility(r,t)===!0&&t<0?this.poleVisibility(r,t)===!0&&n===!0?Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e:Math.PI-Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e:-Math.asin(Math.sin(i)*Math.cos(r)/Math.cos(s))+e,s=Math.round(180*s/Math.PI*10)/10,o=Math.round(180*o/Math.PI*10)/10,a.push(s,o),a},t.prototype.poleVisibility=function(t,e){var r=180*t/Math.PI,i=180*e/Math.PI;return i>=0?90-r+i>90:90-r-i>90},t}),define("scripts/map/VisibleArea",["./BoundingBox","./CoordConversions","../../worldwind/WorldWind"],function(t,e){var r=WorldWind.Vec2,i=function(t){this._viewport=t.viewport,this._eyeGeoCoord=t.eyeGeoCoord,this._range=t.range,this._worldWindow=t.wwd,this._conversions=new e};return i.prototype.getPosition=function(t){var e=this._worldWindow.pickTerrain(t).objects;return e.length>0?e[0].position:null},i.prototype.visibilityStatus=function(){var t=this.getPosition([1,1]),e=this.getPosition([this._viewport().width-1,this._viewport().height/2]),r=this.getPosition([this._viewport().width/2,this._viewport().height-1]),i=this.getPosition([1,this._viewport().height/2]);return null==t&&null==e&&null==r&&null==i?0:null!=t&&null!=e&&null!=r&&null!=i?2:1},i.prototype.getVisibleArea4FullViewport=function(){for(var t=this._viewport(),e=t.width-2,i=t.height-2,n=2,o=[],a=[],s=0;s<n;s++)o[s]=new r(1+s*(e/n),1),o[s+n]=new r(1+e,1+s*(i/n)),o[s+2*n]=new r(2+e-(1+s*(e/n)),1+i),o[s+3*n]=new r(1,2+i-(1+s*(i/n)));for(var l=0;l<o.length;l++){var u=this.getPosition(o[l]);null!=u&&a.push([Math.round(10*u.latitude)/10,Math.round(10*u.longitude)/10])}return this.inBoundingBox(a)},i.prototype.getVisibleArea4PartGlobe=function(){for(var t=this._viewport(),e=t.width-2,i=t.height-2,n=10,o=[],a=0;a<n+1;a++)for(var s=0;s<n+1;s++){var l=new r(1+s*(e/n),1+a*(i/n)),u=this.getPosition(l);null!=u&&o.push([Math.round(u.latitude),Math.round(u.longitude)])}return this.inBoundingBox(o)},i.prototype.getVisibleArea4FullGlobe=function(){for(var t=6378e3,e={lat:this._eyeGeoCoord().latitude,lon:this._eyeGeoCoord().longitude},r={lat:Math.asin(t/(t+this._range())),lon:[0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350]},i=[],n=!1,o=360,a=0;a<r.lon.length;a++)i[a]=this._conversions.carto2geoConversion(e.lat,e.lon,r.lat,r.lon[a],n),n=0==n?i[a][1]>o:i[a][1]<o,i[a]=this._conversions.carto2geoConversion(e.lat,e.lon,r.lat,r.lon[a],n),o=i[a][1],i[a][1]=this._conversions.transformVisibleToBoundaries(i[a][1]);return this.inBoundingBox(i)},i.prototype.inBoundingBox=function(e){var r=-90,i=90,n=180,o=-180,a=this.visibilityStatus();return this._conversions.isDatelineInViewport(e)?(n=180,o=-180,e.forEach(function(t){var e=t[0],a=t[1];e>r&&(r=e),e<i&&(i=e),a<n&&a>0&&(n=a),a>o&&a<0&&(o=a)})):e.forEach(function(t){var e=t[0],a=t[1];e>r&&(r=e),e<i&&(i=e),a<n&&(n=a),a>o&&(o=a)}),2==a?"north"==this._conversions.isPoleInViewport(e)?(r=90,n=-180,o=180):"south"==this._conversions.isPoleInViewport(e)&&(i=-90,n=-180,o=180):0==a?"north"==this._conversions.isPoleVisible(e)?(r=90,n=-180,o=180):"south"==this._conversions.isPoleVisible(e)&&(i=-90,n=-180,o=180):1==a&&(r+=5,i-=5,n-=5,o+=5,r>84?(r=90,n=-180,o=180):i<-84&&(i=-90,n=-180,o=180)),new t(i,n,r,o)},i}),define("scripts/navigator/MoveNavigator",["../map/VisibleArea","../../worldwind/navigate/LookAt"],function(t,e){var r=e,i=function(e){r.call(this,e.wwd),this._lastRange=0,this._zoomLevelListeners=e.zoomLevelListeners||[],this._zoomLevel=10,this._viewPortChangeListeners=e.viewPortChangedListeners||[],this.range=23440143,this.worldWindow=e.wwd,this.lookAtLocation={},this.lookAtLocation.latitude=10,this.lookAtLocation.longitude=15;var i=this;this._visibleArea=new t({viewport:function(){return i.worldWindow.viewport},eyeGeoCoord:function(){return i.lookAtLocation},range:function(){return i.range},wwd:i.worldWindow})};return i.prototype=Object.create(r.prototype),i.prototype.handleWheelEvent=function(t){r.prototype.handleWheelEvent.apply(this,arguments);var e=this._zoomLevel;e!=this.getZoomLevel()&&this.callListeners(this._zoomLevelListeners),this._lastRange=this.range},i.prototype.getRange=function(){return this.range},i.prototype.getZoomLevel=function(){var t=1e6,e=[.8*t,2*t,5*t,10*t];return this.getRange()<e[0]&&this._lastRange>e[0]&&(this._zoomLevel=1),this.getRange()>e[0]&&this.getRange()<e[1]&&(this._lastRange<e[0]||this._lastRange>e[1])&&(this._zoomLevel=2),this.getRange()>e[1]&&this.getRange()<e[2]&&(this._lastRange<e[1]||this._lastRange>e[2])&&(this._zoomLevel=5),this.getRange()>e[2]&&this.getRange()<e[3]&&(this._lastRange<e[2]||this._lastRange>e[3])&&(this._zoomLevel=10),this.getRange()>e[e.length-1]&&this._lastRange<e[e.length-1]&&(this._zoomLevel=20),this._zoomLevel},r.prototype.handlePanOrDrag=function(t){this.worldWindow.globe.is2D()?this.handlePanOrDrag2D(t):this.handlePanOrDrag3D(t)},r.prototype.handlePanOrDrag3D=function(t){var e=t.state,r=t.translationX,i=t.translationY;if(e==WorldWind.BEGAN)this.lastPoint.set(0,0);else if(e==WorldWind.CHANGED){var n=this.worldWindow.canvas,o=this.worldWindow.globe,a=WorldWind.WWMath.max(o.equatorialRadius,o.polarRadius),s=WorldWind.WWMath.max(1,this.range),l=WorldWind.WWMath.perspectivePixelSize(n.clientWidth,n.clientHeight,s),u=(i-this.lastPoint[1])*l,c=-(r-this.lastPoint[0])*l,h=u/a*WorldWind.Angle.RADIANS_TO_DEGREES,f=c/a*WorldWind.Angle.RADIANS_TO_DEGREES,d=Math.sin(this.heading*WorldWind.Angle.DEGREES_TO_RADIANS),p=Math.cos(this.heading*WorldWind.Angle.DEGREES_TO_RADIANS);this.lookAtLocation.latitude+=h*p-f*d,this.lookAtLocation.longitude+=h*d+f*p,this.lastPoint.set(r,i),this.applyLimits(),this.worldWindow.redraw()}},r.prototype.handlePanOrDrag2D=function(t){var e=t.state,r=t.clientX,i=t.clientY,n=t.translationX,o=t.translationY;if(e==WorldWind.BEGAN)this.beginPoint.set(r,i),this.lastPoint.set(r,i);else if(e==WorldWind.CHANGED){var a=this.lastPoint[0],s=this.lastPoint[1],l=this.beginPoint[0]+n,u=this.beginPoint[1]+o;this.lastPoint.set(l,u);var c=this.currentState(),h=this.worldWindow.globe,f=c.rayFromScreenPoint(this.worldWindow.canvasCoordinates(a,s)),d=new Vec3(0,0,0),p=new Vec3(0,0,0),g=new Vec3(0,0,0);if(!h.intersectsLine(f,d))return;if(f=c.rayFromScreenPoint(this.worldWindow.canvasCoordinates(l,u)),!h.intersectsLine(f,p))return;var m=Matrix.fromIdentity();if(m.copy(c.modelview),m.multiplyByTranslation(p[0]-d[0],p[1]-d[1],p[2]-d[2]),m.extractEyePoint(f.origin),m.extractForwardVector(f.direction),!h.intersectsLine(f,g))return;var y=m.extractViewingParameters(g,this.roll,h,{});this.lookAtLocation.copy(y.origin),this.range=y.range,this.heading=y.heading,this.tilt=y.tilt,this.roll=y.roll,this.applyLimits(),this.worldWindow.redraw()}},i.prototype.getVisibleAreaBoundaries=function(){var t=this._visibleArea.visibilityStatus();return 0==t?this._visibleArea.getVisibleArea4FullGlobe():1==t?this._visibleArea.getVisibleArea4PartGlobe():this._visibleArea.getVisibleArea4FullViewport()},i.prototype.callListeners=function(t){t.forEach(function(t){t()})},i}),define("scripts/Controls",["../worldwind/navigate/LookAt"],function(t){"use strict";var e=function(t){this.wwd=t,this.exaggerationIncrement=.01,this.zoomIncrement=.08,this.headingIncrement=1,this.tiltIncrement=1,this.fieldOfViewIncrement=.1,this.panIncrement=.001,this.setupInteraction()};return e.prototype.setupInteraction=function(){$("#zoom-plus-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleZoomIn),mouseup:this.handleMouseEvent.bind(this,this.handleZoomIn)}),$("#zoom-minus-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleZoomOut),mouseup:this.handleMouseEvent.bind(this,this.handleZoomOut)}),$("#tilt-less-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleTiltUp),mouseup:this.handleMouseEvent.bind(this,this.handleTiltUp)}),$("#tilt-more-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleTiltDown),mouseup:this.handleMouseEvent.bind(this,this.handleTiltDown)}),$("#rotate-right-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleHeadingRight),mouseup:this.handleMouseEvent.bind(this,this.handleHeadingRight)}),$("#rotate-left-control").on({mousedown:this.handleMouseEvent.bind(this,this.handleHeadingLeft),mouseup:this.handleMouseEvent.bind(this,this.handleHeadingLeft)}),$("#rotate-needle-control").on({mouseup:this.handleHeadingReset.bind(this)}),this.wwd.addEventListener("mousemove",this.handleManualRedraw.bind(this))},e.prototype.handleMouseEvent=function(t,e){e.type&&("mouseup"===e.type&&1===e.which||"touchend"===e.type||"touchcancel"===e.type)?this.handleOperationEnd(e):this.handleOperationStart(t,e)},e.prototype.handleOperationStart=function(t,e){if("mousedown"===e.type&&1===e.which||"touchstart"===e.type){this.activeOperation=t,e.preventDefault();var r=this,i=function(){r.activeOperation&&(t.call(r),setTimeout(i,50))};setTimeout(i,50)}},e.prototype.handleOperationEnd=function(t){this.activeOperation=null,t.preventDefault()},e.prototype.handleZoomIn=function(){var e=new t;this.wwd.navigator.getAsLookAt(this.wwd.globe,e);var r=this,i=function(){e.range*=1-r.zoomIncrement,r.wwd.navigator.setAsLookAt(r.wwd.globe,e),r.wwd.redraw()};this.heatmap&&this.heatmap(e.range),setTimeout(i,5)},e.prototype.handleZoomOut=function(){var e=new t;this.wwd.navigator.getAsLookAt(this.wwd.globe,e);var r=this,i=function(){e.range*=1+r.zoomIncrement,r.wwd.navigator.setAsLookAt(r.wwd.globe,e),r.wwd.redraw()};this.heatmap&&this.heatmap(e.range),setTimeout(i,5)},e.prototype.handleHeadingRight=function(){this.wwd.navigator.heading-=this.headingIncrement,this.wwd.redraw(),this.redrawHeadingIndicator()},e.prototype.handleHeadingLeft=function(){this.wwd.navigator.heading+=this.headingIncrement,this.wwd.redraw(),this.redrawHeadingIndicator()},e.prototype.handleHeadingReset=function(){var t=1;Math.abs(this.wwd.navigator.heading)>60?t=2:Math.abs(this.wwd.navigator.heading)>120&&(t=3),this.wwd.navigator.heading>0&&(t=-t);var e=this,r=function(){Math.abs(e.wwd.navigator.heading)>Math.abs(t)?(e.wwd.navigator.heading+=t,e.wwd.redraw(),e.redrawHeadingIndicator(),setTimeout(r,10)):(e.wwd.navigator.heading=0,e.wwd.redraw(),e.redrawHeadingIndicator())};setTimeout(r,10)},e.prototype.redrawHeadingIndicator=function(){var t=45,e=this.wwd.navigator.heading,r=0-e-t;$("#rotate-needle-control").find("i").css("transform","rotate("+r+"deg)")},e.prototype.handleTiltUp=function(){this.wwd.navigator.tilt=Math.max(0,this.wwd.navigator.tilt-this.tiltIncrement),this.wwd.redraw()},e.prototype.handleTiltDown=function(){this.wwd.navigator.tilt=Math.min(90,this.wwd.navigator.tilt+this.tiltIncrement),this.wwd.redraw()},e.prototype.handleManualRedraw=function(t){t.which&&(this._lastHeading=this._lastHeading||0,this.wwd.navigator.heading!=this._lastHeading&&this.redrawHeadingIndicator(),this._lastHeading=this.wwd.navigator.heading)},e}),define("scripts/util/ServersPanel",[],function(){"use strict";var t=function(t,e){var r=this;this.wwd=t,this.idCounter=1,this.legends={},$("#addServerBox").find("button").on("click",function(t){r.onAddServerButton(t)}),$("#addServerText").on("keypress",function(t){r.onAddServerTextKeyPress($(this),t)})};return t.prototype.onAddServerButton=function(t){this.attachServer($("#addServerText")[0].value),$("#addServerText").val("")},t.prototype.onAddServerTextKeyPress=function(t,e){13===e.keyCode&&(t.blur(),this.attachServer($("#addServerText")[0].value),$("#addServerText").val(""))},t.prototype.attachServer=function(t){if(t){t=t.trim(),t=t.replace("Http","http"),0!=t.lastIndexOf("http",0)&&(t="http://"+t);var e=this,r=new XMLHttpRequest,i=WorldWind.WmsUrlBuilder.fixGetMapString(t);i+="service=WMS&request=GetCapabilities&vers",r.open("GET",i,!0),r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var i=r.responseXML;if(i||0!==r.responseText.indexOf("<?xml")||(i=(new window.DOMParser).parseFromString(r.responseText,"text/xml")),!i)return void alert(t+" retrieval failed. It is probably not a WMS server.");var n=new WorldWind.WmsCapabilities(i);n.version?e.addServerPanel(t,n):alert(t+" WMS capabilities document invalid. The server is probably not a WMS server.")}else 4===r.readyState&&(r.statusText?alert(r.responseURL+" "+r.status+" ("+r.statusText+")"):alert("Failed to retrieve WMS capabilities from "+t+"."))},r.send(null)}},t.prototype.addServerPanel=function(t,e){var r=this.idCounter++,i=this.idCounter++,n=this.idCounter++,o=e.service,a=o.title&&o.title.length>0?o.title:t,s=$('<div class="panel panel-default"></div>'),l=$('<div class="panel-heading" role="tab" id="'+i+'"></div>'),u=$('<h4 class="panel-title wrap-panel-heading"></h4>'),c=$('<a data-toggle="collapse" href="#'+n+'" aria-expanded="true" aria-controls="'+n+'">'+a+"</a>"),h=$('<a href="#"><small><span class="pull-right  clickable_space"></span></small></a>'),f=$('<div id="'+n+'" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="'+i+'"></div>'),d=$('<div style="max-height: 250px; overflow-y: scroll; -webkit-overflow-scrolling: touch;"></div>'),p=this.makeTree(t,r);h.on("click",function(){s.remove()}),u.append(c),u.append(h),l.append(u),s.append(l),d.append(p),f.append(d),s.append(f);var g=$("#servers");g.append(s);var m=p.fancytree("getRootNode"),y=e.capability.layers;1!==y.length||!y[0].layers||y[0].title!==e.service.title||y[0].name&&y[0].name.length>0||(y=y[0].layers),m.addChildren(this.assembleLayers(y,[]));var v=0;m.visit(function(t){++v}),v>10&&m.visit(function(t){t.setExpanded(!1)})},t.prototype.makeTree=function(t,e){var r=this,i="treeDiv"+e,n="treeData"+e,o=$('<div id="'+i+'">'),a=$('<ul id="'+n+'style="display: none;">');return o.append(a),o.fancytree({click:function(t,e){var r=e.node,i=r.data.layer;if(i)return r.setSelected(!1),!1},select:function(t,e){var i=e.node,n=i.data.layer;return n?i.selected||(i.data.layer=null,r.removeLayer(n)):i.selected&&i.data.layerCaps&&i.data.layerCaps.name&&(i.data.layer=r.addLayer(i.data.layerCaps)),r.wwd.redraw(),!1}}),o.fancytree("option","checkbox",!0),o.fancytree("option","icons",!1),$("form").submit(!1),o},t.prototype.assembleLayers=function(t,e){for(var r=0;r<t.length;r++){var i=t[r],n=null,o={title:i.title,tooltip:i.title,layerCaps:i};i.layers&&i.layers.length>0&&(n=this.assembleLayers(i.layers,[])),i.name||(o.expanded=!0,o.unselectable=!0,o.hideCheckbox=!0,o.folder=!0),n&&(o.children=n),e.push(o)}return e},t.prototype.addLayer=function(t){if(t.name){var e,r=WorldWind.WmsLayer.formLayerConfiguration(t,null);if(r.timeSequences&&r.timeSequences[r.timeSequences.length-1]instanceof WorldWind.PeriodicTimeSequence){var i=r.timeSequences[r.timeSequences.length-1];r.levelZeroDelta=new WorldWind.Location(180,180),e=new WorldWind.WmsTimeDimensionedLayer(r),e.opacity=.8,e.time=i.startTime,e.timeSequence=i}else r.timeSequences&&r.timeSequences[r.timeSequences.length-1]instanceof Date?(i=r.timeSequences[r.timeSequences.length-1],r.levelZeroDelta=new WorldWind.Location(180,180),e=new WorldWind.WmsTimeDimensionedLayer(r),e.opacity=.8,e.time=r.timeSequences[0],e.timeSequence=i):e=new WorldWind.WmsLayer(r,null);return t.styles&&t.styles.length>0&&t.styles[0].legendUrls&&t.styles[0].legendUrls.length>0&&(e.companionLayer=this.addLegend(t.styles[0].legendUrls[0])),e.enabled=!0,this.wwd.addLayer(e),this.wwd.redraw(),e}return null},t.prototype.removeLayer=function(t){this.removeLegend(t.companionLayer),this.wwd.removeLayer(t),this.timeSeriesPlayer&&this.timeSeriesPlayer.layer===t&&(this.timeSeriesPlayer.timeSequence=null,this.timeSeriesPlayer.layer=null),this.wwd.redraw()},t.prototype.addLegend=function(t){var e=this.legends[t.url];if(e)++e.refCount,e.layer.enabled=!0;else{e={refCount:1,legendCaps:t},e.layer=new WorldWind.RenderableLayer;var r=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0),i=new WorldWind.ScreenImage(r,t.url);i.imageOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_INSET_PIXELS,0),e.layer.addRenderable(i),e.layer.hide=!0,e.layer.refCount=0,this.wwd.addLayer(e.layer),this.legends[t.url]=e,this.updateLegendOffsets()}return++e.layer.refCount,e.layer},t.prototype.removeLegend=function(t){for(var e in this.legends)if(this.legends.hasOwnProperty(e)){var r=this.legends[e];if(r.layer===t){--r.refCount,--r.layer.refCount,r.refCount<=0&&(this.wwd.removeLayer(r.layer),delete this.legends[r.legendCaps.url]);break}}this.updateLegendOffsets()},t.prototype.updateLegendOffsets=function(){var t=0,e=5;for(var r in this.legends)if(this.legends.hasOwnProperty(r)){var i=this.legends[r],n=i.layer.renderables[0];n.screenOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_INSET_PIXELS,t),t+=i.legendCaps.height+e}},t}),define("scripts/util/FeaturesPanel",[],function(){"use strict";var t=function(t,e){var r=this;this.wwd=t,this.featuresPanel=r,this.idCounter=1,this.legends={},$("#addServerBox1").find("button").on("click",function(t){r.onAddServerButton(t)}),$("#addServerText1").on("keypress",function(t){r.onAddServerTextKeyPress($(this),t)})};t.prototype.onAddServerButton=function(t){this.attachServer($("#addServerText1")[0].value),$("#addServerText1").val("")},t.prototype.onAddServerTextKeyPress=function(t,e){13===e.keyCode&&(t.blur(),this.attachServer($("#addServerText1")[0].value),$("#addServerText1").val(""))},t.prototype.attachServer=function(t){if(t){t=t.trim(),t=t.replace(/https|http/i,"http"),0!=t.lastIndexOf("http",0)&&(t="http://"+t),console.log(t);var e=this,r=new XMLHttpRequest,i=t;i+="/ows?service=wfs&version=2.0.0&request=getCapabilities",r.open("GET",i,!0),r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var i=r.responseXML;if(i||0!==r.responseText.indexOf("<?xml")||(i=(new window.DOMParser).parseFromString(r.responseText,"text/xml")),!i)return void alert(t+" retrieval failed. It is probably not a wfs server.");var n=new WorldWind.WfsCapabilities(i);n.version?e.addFeaturePanel(t,n):alert(t+" wfs capabilities document invalid. The server is probably not a wfs server.")}else 4===r.readyState&&(r.statusText?alert(r.responseURL+" "+r.status+" ("+r.statusText+")"):alert("Failed to retrieve wfs capabilities from "+t+"."))},r.send(null)}};var e=function(t,e){var r={};if(t.isPointType()||t.isMultiPointType()){if(r.attributes=new WorldWind.PlacemarkAttributes(placemarkAttributes),e&&(e.name||e.Name||e.NAME)&&(r.name=e.name||e.Name||e.NAME),e&&e.POP_MAX){var i=e.POP_MAX;r.attributes.imageScale=.01*Math.log(i)}}else t.isLineStringType()||t.isMultiLineStringType()?(r.attributes=new WorldWind.ShapeAttributes(null),r.attributes.drawOutline=!0,r.attributes.outlineColor=new WorldWind.Color(.1*r.attributes.interiorColor.red,.3*r.attributes.interiorColor.green,.7*r.attributes.interiorColor.blue,1),r.attributes.outlineWidth=1):(t.isPolygonType()||t.isMultiPolygonType())&&(r.attributes=new WorldWind.ShapeAttributes(null),r.attributes.interiorColor=new WorldWind.Color(255,255,255,1),r.attributes.outlineColor=new WorldWind.Color(255,0,0,1));return r};return t.prototype.addFeaturePanel=function(t,e){var r=this.idCounter++,i=this.idCounter++,n=this.idCounter++,o="WFS",a=$('<div class="panel panel-default"></div>'),s=$('<div class="panel-heading" role="tab" id="'+i+'"></div>'),l=$('<h4 class="panel-title wrap-panel-heading"></h4>'),u=$('<a data-toggle="collapse" href="#'+n+'" aria-expanded="true" aria-controls="'+n+'">'+o+"</a>"),c=$('<a href="#"><small><span class="pull-right glyphicon glyphicon-remove clickable_space"></span></small></a>'),h=$('<div id="'+n+'" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="'+i+'"></div>'),f=$('<div style="max-height: 250px; overflow-y: scroll; -webkit-overflow-scrolling: touch;"></div>'),d=this.makeTree(t,r);c.on("click",function(){a.remove()}),l.append(u),l.append(c),s.append(l),a.append(s),f.append(d),h.append(f),a.append(h);var p=$("#servers1");p.append(a);var g=d.fancytree("getRootNode"),m=e.featureType;g.addChildren(this.assemblefeatures(m,[]));var y=0;g.visit(function(t){++y}),y>10&&g.visit(function(t){t.setExpanded(!1)})},t.prototype.makeTree=function(t,e){var r=this,i="treeDiv"+e,n="treeData"+e,o=$('<div id="'+i+'">'),a=$('<ul id="'+n+'style="display: none;">');return o.append(a),o.fancytree({click:function(t,e){var r=e.node,i=r.data.layer;if(i)return r.setSelected(!1),!1},select:function(e,i){var n=i.node,o=n.data.layer;return o?n.selected||(n.data.layer=null,r.removeLayer(o)):n.selected&&n.data.layerCaps&&n.data.layerCaps.name&&(n.data.layer=r.addLayer(n.data.layerCaps,t)),r.wwd.redraw(),!1}}),o.fancytree("option","checkbox",!0),o.fancytree("option","icons",!1),$("form").submit(!1),o},t.prototype.assemblefeatures=function(t,e){for(var r=0;r<t.length;r++){var i=t[r],n=null,o={title:i.title,tooltip:i.title,layerCaps:i};i.features&&i.features.length>0&&(n=this.assemblefeatures(i.features,[])),i.name||(o.expanded=!0,o.unselectable=!0,o.hideCheckbox=!0,o.folder=!0),n&&(o.children=n),e.push(o)}return e},t.prototype.addLayer=function(t,r){if(t.name){var i=r+"/wfs?request=GetFeature&outputFormat=application/json&version=1.1.0&typeName="+t.name,n=new WorldWind.RenderableLayer(t.name),o=new WorldWind.GeoJSONParser(i);o.load(null,e,n);var a=this.wwd;n.enabled=!0,this.wwd.addLayer(n);try{setTimeout(function(){a.layers[a.layers.length-1].renderables[0]._boundaries[0][0].altitude=1e4,a.goTo(a.layers[a.layers.length-1].renderables[0]._boundaries[0][0])},2e3)}catch(t){console.log(t)}return this.wwd.redraw(),n}return null},t.prototype.removeLayer=function(t){this.removeLegend(t.companionLayer),this.wwd.removeLayer(t),this.timeSeriesPlayer&&this.timeSeriesPlayer.layer===t&&(this.timeSeriesPlayer.timeSequence=null,this.timeSeriesPlayer.layer=null),this.wwd.redraw()},t.prototype.addLegend=function(t){var e=this.legends[t.url];if(e)++e.refCount,e.layer.enabled=!0;else{e={refCount:1,legendCaps:t},e.layer=new WorldWind.RenderableLayer;var r=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0),i=new WorldWind.ScreenImage(r,t.url);i.imageOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_INSET_PIXELS,0),e.layer.addRenderable(i),e.layer.hide=!0,e.layer.refCount=0,this.wwd.addLayer(e.layer),this.legends[t.url]=e,this.updateLegendOffsets()}return++e.layer.refCount,e.layer},t.prototype.removeLegend=function(t){for(var e in this.legends)if(this.legends.hasOwnProperty(e)){var r=this.legends[e];if(r.layer===t){--r.refCount,--r.layer.refCount,r.refCount<=0&&(this.wwd.removeLayer(r.layer),delete this.legends[r.legendCaps.url]);break}}this.updateLegendOffsets()},t.prototype.updateLegendOffsets=function(){var t=0,e=5;for(var r in this.legends)if(this.legends.hasOwnProperty(r)){var i=this.legends[r],n=i.layer.renderables[0];n.screenOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_INSET_PIXELS,t),t+=i.legendCaps.height+e}},t}),define("scripts/util/GeoJSONPanel",[],function(){var t=function(t){this.wwd=t,this.myJsons={};var e=this;this.index=0,this.fileTypeGeoJSON=0,$("#fileTypeGeoJSON").change(function(){var t=$("#fileTypeGeoJSON").val();"0"==t?($("#csv-geojson").hide(),$("#geoJsonTxtArea").show(),$("#geoJsonUrl").hide(),e.fileTypeGeoJSON=0):"1"==t?($("#csv-geojson").hide(),$("#geoJsonTxtArea").hide(),$("#geoJsonUrl").show(),e.fileTypeGeoJSON=1):"2"==t&&($("#csv-geojson").show(),$("#geoJsonTxtArea").hide(),$("#geoJsonUrl").hide(),e.fileTypeGeoJSON=2)}),$("#loadGeoJsonBtn").on("click",function(){e.addJSON(e.wwd)})};return t.prototype.addJSON=function(t){function e(e){var r=e.renderables[0].boundaries[0];((r[0]||r.latitude)&&"number"==typeof r[0]||"number"==typeof r.latitude)&&(t.controller.lookAt.longitude=r.latitude,t.controller.lookAt.latitude=r.longitude)}if(2==this.fileTypeGeoJSON)var r=$("#csv-geojson").get(0).files[0];else if(1==this.fileTypeGeoJSON)var r=document.getElementById("geoJsonUrl").value;else var r=document.getElementById("geoJsonTxtArea").value;r=r.replace(/ /g,"");var i=new WorldWind.PlacemarkAttributes(null);i.imageScale=.05,i.imageColor=WorldWind.Color.WHITE,i.labelAttributes.offset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,1.5),i.imageSource=WorldWind.configuration.baseUrl+"images/white-dot.png";var n=function(t,e){var r={};if(t.isPointType()||t.isMultiPointType()){if(r.attributes=new WorldWind.PlacemarkAttributes(i),e&&(e.name||e.Name||e.NAME)&&(r.name=e.name||e.Name||e.NAME),e&&e.POP_MAX){var n=e.POP_MAX;r.attributes.imageScale=.01*Math.log(n)}}else t.isLineStringType()||t.isMultiLineStringType()?(r.attributes=new WorldWind.ShapeAttributes(null),r.attributes.drawOutline=!0,r.attributes.outlineColor=new WorldWind.Color(.1*r.attributes.interiorColor.red,.3*r.attributes.interiorColor.green,.7*r.attributes.interiorColor.blue,1),r.attributes.outlineWidth=1):(t.isPolygonType()||t.isMultiPolygonType())&&(r.attributes=new WorldWind.ShapeAttributes(null),r.attributes.interiorColor=new WorldWind.Color(.375+.5*Math.random(),.375+.5*Math.random(),.375+.5*Math.random(),.7),r.attributes.outlineColor=new WorldWind.Color(.5*r.attributes.interiorColor.red,.5*r.attributes.interiorColor.green,.5*r.attributes.interiorColor.blue,1));return r},o=new WorldWind.RenderableLayer("GeoJSON");o.index=this.index++,t.addLayer(o),this.myJsons[this.index]=o;var a=new WorldWind.GeoJSONParser(r);a.load(e,n,o),t.redraw(),this.createInterface(t)},t.prototype.createInterface=function(t){$("#GeoJSONList").html("");var e=this;for(var r in e.myJsons){var i=e.myJsons[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#GeoJSONList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myJsons[r]),$(this).remove(),delete e.myJsons[r],t.redraw()})}},t}),define("scripts/util/GeoTIFFPanel",[],function(){var t=function(t){this.wwd=t,this.myTiff={};var e=this;this.index=0,$("#loadGeoTIFFBtn").on("click",function(){e.addTIFF(e.wwd)})};return t.prototype.addTIFF=function(t){var e=this,r=new WorldWind.RenderableLayer("GeoTiff");r.index=this.index++,this.myTiff[this.index]=r,$("#loading").show();var i=document.getElementById("geoTIFFTxtArea").value,n=new WorldWind.GeoTiffReader(i);try{n.readAsImage(function(i){var o=new WorldWind.SurfaceImage(n.metadata.bbox,new WorldWind.ImageSource(i));r.addRenderable(o),t.addLayer(r),t.redraw(),$("#loading").hide(),e.createInterface(t),t.goTo(new WorldWind.Position(n.metadata.bbox.minLatitude,n.metadata.bbox.minLongitude))})}catch(t){$("#loading").hide(),alert("Error occurred:"+t)}},t.prototype.createInterface=function(t){$("#GeoTIFFList").html("");var e=this;for(var r in e.myTiff){var i=e.myTiff[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#GeoTIFFList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myTiff[r]),$(this).remove(),delete e.myTiff[r],t.redraw()})}},t}),define("scripts/util/KMLPanel",[],function(){var t=function(t,e){this.wwd=t,this.KmlFile=e,this.myKML={};var r=this;this.index=0,this.fileTypeKML=1,$("#fileTypeKML").change(function(){var t=$("#fileTypeKML").val();"0"==t?($("#csv-KML").show(),$("#KMLTxtArea").hide(),r.fileTypeKML=0):"1"==t&&($("#csv-KML").hide(),$("#KMLTxtArea").show(),r.fileTypeKML=1)}),$("#loadKMLBtn").on("click",function(){r.addTIFF(r.wwd)})};return t.prototype.addTIFF=function(t){var e=this,r=new WorldWind.RenderableLayer("KML");r.index=this.index++,this.myKML[this.index]=r,$("#loading").show();try{if(0===this.fileTypeKML)var i=$("#csv-KML").get(0).files[0];else var i=document.getElementById("KMLTxtArea").value;var n=new this.KmlFile(i)}catch(t){$("#loading").hide(),alert("Error occurred:"+t)}n.then(function(i){r.addRenderable(i),t.addLayer(r),t.redraw(),$("#loading").hide(),e.createInterface(t);try{var n=i.node.children[0];n=$(n).find("Folder").children(),n=$(n).find("LookAt").children();
var o=n[0].textContent,a=n[1].textContent;t.goTo(new WorldWind.Position(a,o))}catch(t){console.log("cannot find psoition of KML")}}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})},t.prototype.createInterface=function(t){$("#KMLList").html("");var e=this;for(var r in e.myKML){var i=e.myKML[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#KMLList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myKML[r]),$(this).remove(),delete e.myKML[r],t.redraw()})}},t}),define("scripts/util/SurfaceImagePanel",[],function(){var t=function(t){this.wwd=t,this.mySurfaceImage={};var e=this;this.index=0,$("#loadSurfaceImageBtn").on("click",function(){e.addTIFF(e.wwd)})};return t.prototype.addTIFF=function(t){var e=this,r=new WorldWind.RenderableLayer("SurfaceImage");r.index=this.index++,this.mySurfaceImage[this.index]=r,$("#loading").show();try{var i=document.getElementById("SurfaceImageTxtArea").value,n=document.getElementById("minLat").value,o=document.getElementById("maxLat").value,a=document.getElementById("minLng").value,s=document.getElementById("maxLng").value,l=new WorldWind.SurfaceImage(new WorldWind.Sector(n,o,a,s),i);r.addRenderable(l),t.addLayer(r),t.redraw()}catch(t){$("#loading").hide(),alert("Error occurred:"+t)}$("#loading").hide(),e.createInterface(t),t.goTo(new WorldWind.Position(n,a))},t.prototype.createInterface=function(t){$("#SurfaceImageList").html("");var e=this;for(var r in e.mySurfaceImage){var i=e.mySurfaceImage[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#SurfaceImageList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.mySurfaceImage[r]),$(this).remove(),delete e.mySurfaceImage[r]})}},t}),define("scripts/util/NDVIPanel",[],function(){var t=function(t,e){this.wwd=t,this.NDVILayers=[];var r=this;this.index=0,$("#loadNDVIBtn").on("click",function(){r.addSurface(r.wwd,e),$("#resetNDVIBtn").show(),$("#loadNDVIBtn").hide()}),$("#resetNDVIBtn").on("click",function(){for(var e in r.NDVILayers)t.removeLayer(r.NDVILayers[e]);$("#graph").hide(),$("#resetNDVIBtn").hide(),$("#loadNDVIBtn").show(),t.removeEventListener("click",r.handle),t.redraw()})};return t.prototype.addSurface=function(t,e){function r(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status){p=JSON.parse(e.response),$("#scene-date").val(c(p[0].filenameList[0]));for(var t=0;t<p.length;t++)p[t].paragraphId="p"+p[t].regionName,p[t].loadingStatus=0,i(p[t].paragraphId,p[t].regionName,p[t].loadingStatus,p[t].filenameList.length),o(p[t].url,p[t].regionName,p[t].filenameList[0],!0)}else console.log("retrieve failed")},e.onerror=function(){console.log("error")},e.ontimeout=function(){console.log("timeout")},e.send(null)}function i(t,e,r,i){var n=document.createElement("p");n.setAttribute("id",t),n.textContent=e+": "+r+"/"+i,document.getElementById("surfacesStatus").appendChild(n)}function n(t,e,r,i){$("#"+t).text("Loading "+e+": "+r+"/"+i)}function o(t,e,r,i){var t=t+r,n=new XMLHttpRequest;i?n.open("GET",t,!1):n.open("GET",t,!0),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var t=n.response.split("\n");if(0===w.filter(function(t){return t.regionName===e}).length){var i=Number(t.shift().replace(/  +/g," ").split(" ")[1]),o=Number(t.shift().replace(/  +/g," ").split(" ")[1]),s=Number(t.shift().replace(/  +/g," ").split(" ")[1]),l=Number(t.shift().replace(/  +/g," ").split(" ")[1]),c=Number(t.shift().replace(/  +/g," ").split(" ")[1]),h=Number(l+o*c),d=t.shift().replace(/  +/g," ").split(" ")[1],p=document.createElement("canvas");p.width=i,p.height=o;var g=p.getContext("2d"),m=g.createImageData(p.width,p.height);w.push({regionName:e,width:i,height:o,referenceX:s,referenceY:h,cellSize:c,noDataValue:d,imageList:[{filename:r,dataArray:t,imageData:m}],canvas:p,context2d:g,"loadingStatus:":0}),u(t,e,r,g,m,d)}else{t.splice(0,6);var y=f(w,"regionName",e),m=w[y].context2d.createImageData(w[y].canvas.width,w[y].canvas.height);w[y].imageList.push({filename:r,dataArray:t,imageData:m}),u(t,e,r,w[y].context2d,w[y].imageList[w[y].imageList.length-1].imageData,w[y].noDataValue),w[y].imageList.sort(a)}}else console.log("retrieve failed")},n.onerror=function(){console.log("error")},n.ontimeout=function(){console.log("timeout")},n.send(null)}function a(t,e){return t.filename<e.filename?-1:t.filename>e.filename?1:0}function s(t){for(var e=[],r=0;r<t.length;r++){var i=new WorldWind.RenderableLayer;i.displayName=t[r].regionName;var n=new WorldWind.SurfaceImage(new WorldWind.Sector(t[r].referenceY-t[r].height*t[r].cellSize,t[r].referenceY,t[r].referenceX,t[r].referenceX+t[r].width*t[r].cellSize),new WorldWind.ImageSource(t[r].canvas));n.displayName=t[r].regionName,i.addRenderable(n),e.push(i)}return e}function l(t,e){setTimeout(function(){o(p[t].url,p[t].regionName,p[t].filenameList[e],!1)},1e3*E++)}function u(e,r,i,o,a,u){var c=new Worker("src/scripts/util/CanvasWorker.js");c.onmessage=function(e){b++;var a=f(w,"regionName",r),u=f(w[a].imageList,"filename",i);if(w[a].imageList[u].imageData=e.data.imageData,w[a].imageList[u].dataArray=e.data.dataArray,p[a].loadingStatus++,n(p[a].paragraphId,p[a].regionName,p[a].loadingStatus,p[a].filenameList.length),b!==p.length||x)b<p.length&&!x&&o.putImageData(e.data.imageData,0,0);else{o.putImageData(e.data.imageData,0,0),_=s(w);for(var c=0;c<_.length;c++)$("#select-region").append($("<option>",{value:_[c].displayName,text:_[c].displayName})),g.NDVILayers.push(_[c]),t.addLayer(_[c]);t.goTo(new WorldWind.Position(41.77,12.77,4e4)),x=!0;for(var h=0;h<p.length;h++)for(var d=1;d<p[h].filenameList.length;d++)l(h,d)}},c.onerror=function(t){alert("Error: Line "+t.lineno+" in "+t.filename+": "+t.message)},c.postMessage({imageData:a,dataArray:e,colorPaletteArray:v,regionName:r,filename:i,noDataValue:u})}function c(t){var e=t.split("_")[4];return e.substring(0,4)+"/"+e.substring(4,6)+"/"+e.substring(6,8)}function h(e){for(var r=0;r<t.layers.length;r++)if(t.layers[r].displayName===$("#select-region").val())for(var i=0;i<t.layers[r].renderables.length;i++)t.layers[r].renderables[i].opacity=e;$("#transparency").val(e)}function f(t,e,r){return t.map(function(t){return t[e]}).indexOf(r)}function d(e){for(var r=0;r<t.layers.length;r++)if(t.layers[r].displayName===$("#select-region").val())try{var i=f(w,"regionName",t.layers[r].displayName);w[i].context2d.putImageData(w[i].imageList[e].imageData,0,0),t.layers[r].renderables[0].imageSource=new WorldWind.ImageSource(w[i].canvas);var n=w[i].imageList[e].filename;$("#scene-date").val(c(n)),t.redraw();break}catch(t){$("#loading").hide(),alert("Error occurred:"+t)}}var p,g=this,m=document.getElementById("NDVITxtArea").value,y=m,v=[0,25.5,.701,.921,1,1,25.5,51,1,1,.9412,1,51,76.5,1,1,.898,1,76.5,102,.9686,.9882,.7255,1,102,127.5,.851,.9412,.6392,1,127.5,153,.6784,.8667,.5569,1,153,175.5,.2549,.6706,.3647,1,175.5,204,.1373,.5176,.2627,1,204,229.5,0,.3529,.1608,1,229.5,255,0,.2706,.1608,1],b=0,E=0,w=[],_=[],x=!1;r(y);var S=function(e){var r=e.clientX,i=e.clientY,n=t.canvasCoordinates(r,i),o=t.pick(n);if(o.objects.length>0)for(var a=0;a<o.objects.length;a++)if(o.objects[a].userObject instanceof WorldWind.SurfaceImage&&o.objects[a].userObject.displayName===$("#select-region").val()){for(var s=f(w,"regionName",o.objects[a].userObject.displayName),l=w[s].referenceY,u=w[s].referenceX,h=w[s].cellSize,d=w[s].width,p=t.pickTerrain(n).terrainObject(),g=p.position.latitude,m=p.position.longitude,y=l-g,v=m-u,b=Math.round(v/h),E=Math.round(y/h),_=E*d+b,x=[],S=[],T=0;T<w[s].imageList.length;T++)w[s].imageList[T].dataArray[_]===w[s].noDataValue?x.push(0):x.push(w[s].imageList[T].dataArray[_]),S.push(c(w[s].imageList[T].filename));for(var M=[10,60,80,60],L=1e3-M[1]-M[3],A=300-M[0]-M[2],N=L/x.length,C=[],T=0;T<x.length;T++)C.push(T*N);var r=d3.scale.ordinal().domain(S).range(C),i=d3.scale.linear().domain([0,255]).range([A,0]),R=d3.svg.line().x(function(t,e){return r(e)}).y(function(t){return i(t)});d3.select("svg").remove(),d3.select("svg").remove();var P=d3.select("#graph").append("svg").attr("width",L+M[1]+M[3]).attr("height",A+M[0]+M[2]).append("svg:g").attr("transform","translate("+M[3]+","+M[0]+")"),O=d3.svg.axis().scale(r).tickSize(-A).tickSubdivide(!0);P.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+A+")").call(O).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-65)");var I=d3.svg.axis().scale(i).ticks(4).orient("left");P.append("svg:g").attr("class","y axis").attr("transform","translate(-25,0)").call(I),P.append("svg:path").attr("d",R(x)),$("#bottomMenu").show(),$("#graph").show()}};t.addEventListener("click",S),g.handle=S,$("#scene-slider").slider({orientation:"horizontal",range:"min",min:0,max:12,value:0,slide:function(t,e){d(e.value)}}),$("#transparency-slider").slider({orientation:"horizontal",range:"min",min:0,max:1,step:.01,value:1,slide:function(t,e){h(e.value)}}),$("#transparency").val(1),$("#select-region").change(function(){var t="";$("select option:selected").each(function(){t+=$(this).text()}),"Sicily"===t?e.goToAnimator.goTo(new WorldWind.Position(37.51,14,4e5)):"Rome"===t&&e.goToAnimator.goTo(new WorldWind.Position(41.77,12.77,4e4));for(var r=0;r<w.length;r++)if(w[r].regionName===t){$("#scene-slider").slider("option","max",w[r].imageList.length-1);break}}),g.createInterface(t)},t.prototype.createInterface=function(t){$("#NDVIList").html("");var e=this;for(var r in e.myNDVI){var i=e.myNDVI[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#NDVIList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myNDVI[r]),$(this).remove(),delete e.myNDVI[r]})}},t}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("scripts/util/math",[],e):"object"==typeof exports?exports.math=e():t.math=e()}(this,function(){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){function i(t){var e=n.create(t);return e.create=i,e.import(r(13)),e}var n=r(1);t.exports=i()},function(t,e,r){t.exports=r(2)},function(t,e,r){var i=r(3).isFactory,n=(r(3).deepExtend,r(4)),o=r(8),a=r(10),s=r(12);e.create=function(t){function e(t){if(!i(t))throw new Error("Factory object with properties `type`, `name`, and `factory` expected");var n,o=r.indexOf(t);return o===-1?(n=t.math===!0?t.factory(u.type,c,e,u.typed,u):t.factory(u.type,c,e,u.typed),r.push(t),l.push(n)):n=l[o],n}if("function"!=typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var r=[],l=[],u=o.mixin({});u.type={},u.expression={transform:Object.create(u)},u.typed=n.create(u.type);var c={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1};return u.import=e(a),u.config=e(s),t&&u.config(t),u}},function(t,e){"use strict";e.clone=function t(e){var r=typeof e;if("number"===r||"string"===r||"boolean"===r||null===e||void 0===e)return e;if("function"==typeof e.clone)return e.clone();if(Array.isArray(e))return e.map(function(e){return t(e)});if(e instanceof Number)return new Number(e.valueOf());if(e instanceof String)return new String(e.valueOf());if(e instanceof Boolean)return new Boolean(e.valueOf());if(e instanceof Date)return new Date(e.valueOf());if(e&&e.isBigNumber===!0)return e;if(e instanceof RegExp)throw new TypeError("Cannot clone "+e);var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=t(e[n]));return i},e.extend=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},e.deepExtend=function t(e,r){if(Array.isArray(r))throw new TypeError("Arrays are not supported by deepExtend");for(var i in r)if(r.hasOwnProperty(i))if(r[i]&&r[i].constructor===Object)void 0===e[i]&&(e[i]={}),e[i].constructor===Object?t(e[i],r[i]):e[i]=r[i];else{if(Array.isArray(r[i]))throw new TypeError("Arrays are not supported by deepExtend");e[i]=r[i]}return e},e.deepEqual=function(t,r){var i,n,o;if(Array.isArray(t)){if(!Array.isArray(r))return!1;if(t.length!=r.length)return!1;for(n=0,o=t.length;n<o;n++)if(!e.deepEqual(t[n],r[n]))return!1;return!0}if(t instanceof Object){if(Array.isArray(r)||!(r instanceof Object))return!1;for(i in t)if(!e.deepEqual(t[i],r[i]))return!1;for(i in r)if(!e.deepEqual(t[i],r[i]))return!1;return!0}return typeof t==typeof r&&t==r},e.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},"x",{get:function(){}}),!0}catch(t){}return!1},e.lazy=function(t,r,i){if(e.canDefineProperty()){var n,o=!0;Object.defineProperty(t,r,{get:function(){return o&&(n=i(),o=!1),n},set:function(t){n=t,o=!1},configurable:!0,enumerable:!0})}else t[r]=i()},e.traverse=function(t,e){var r=t;if(e)for(var i=e.split("."),n=0;n<i.length;n++){var o=i[n];o in r||(r[o]={}),r=r[o]}return r},e.isFactory=function(t){return t&&"function"==typeof t.factory}},function(t,e,r){var i=r(5),n=r(6).digits,o=function(){return o=i.create,i};e.create=function(t){var e=o();return e.types=[{name:"number",test:function(t){return"number"==typeof t}},{name:"Complex",test:function(t){return t&&t.isComplex}},{name:"BigNumber",test:function(t){return t&&t.isBigNumber}},{name:"Fraction",test:function(t){return t&&t.isFraction}},{name:"Unit",test:function(t){return t&&t.isUnit}},{name:"string",test:function(t){return"string"==typeof t}},{name:"Array",test:Array.isArray},{name:"Matrix",test:function(t){return t&&t.isMatrix}},{name:"DenseMatrix",test:function(t){return t&&t.isDenseMatrix}},{name:"SparseMatrix",test:function(t){return t&&t.isSparseMatrix}},{name:"ImmutableDenseMatrix",test:function(t){return t&&t.isImmutableDenseMatrix}},{name:"Range",test:function(t){return t&&t.isRange}},{name:"Index",test:function(t){return t&&t.isIndex}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"ResultSet",test:function(t){return t&&t.isResultSet}},{name:"Help",test:function(t){return t&&t.isHelp}},{name:"function",test:function(t){return"function"==typeof t}},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],e.conversions=[{from:"number",to:"BigNumber",convert:function(e){if(n(e)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t.BigNumber(e)}},{from:"number",to:"Complex",convert:function(e){return new t.Complex(e,0)}},{from:"number",to:"string",convert:function(t){return t+""}},{from:"BigNumber",to:"Complex",convert:function(e){return new t.Complex(e.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return new t.Complex(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){if(n(e)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to Fraction (value: "+e+"). Use function fraction(x) to convert to Fraction.");return new t.Fraction(e)}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(e){return new t.BigNumber(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return new t.Fraction(+e)}},{from:"boolean",to:"string",convert:function(t){return+t}},{from:"null",to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},{from:"null",to:"BigNumber",convert:function(){return new t.BigNumber(0)}},{from:"null",to:"Fraction",convert:function(){return new t.Fraction(0)}},{from:"Array",to:"Matrix",convert:function(e){return new t.DenseMatrix(e)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}],e}},function(t,e,r){var i,n,o;!function(r,a){n=[],i=a,o="function"==typeof i?i.apply(e,n):i,!(void 0!==o&&(t.exports=o))}(this,function(){function t(){function e(t){for(var e,r=0;r<_.types.length;r++){var i=_.types[r];if(i.name===t){e=i.test;break}}if(!e){var n;for(r=0;r<_.types.length;r++)if(i=_.types[r],i.name.toLowerCase()==t.toLowerCase()){n=i.name;break}throw new Error('Unknown type "'+t+'"'+(n?'. Did you mean "'+n+'"?':""))}return e}function r(t){for(var e="",r=0;r<t.length;r++){var i=t[r];if(i.signatures&&""!=i.name)if(""==e)e=i.name;else if(e!=i.name){var n=new Error("Function names do not match (expected: "+e+", actual: "+i.name+")");throw n.data={actual:i.name,expected:e},n}}return e}function i(t,e,r,i,n){var o,a=p(i),s=n?n.split(","):null,l=t||"unnamed",u=s&&g(s,"any"),c={fn:t,index:r,actual:i,expected:s};o=s?e>r&&!u?"Unexpected type of argument in function "+l+" (expected: "+s.join(" or ")+", actual: "+a+", index: "+r+")":"Too few arguments in function "+l+" (expected: "+s.join(" or ")+", index: "+r+")":"Too many arguments in function "+l+" (expected: "+r+", actual: "+e+")";var h=new TypeError(o);return h.data=c,h}function n(t){this.name=t||"refs",this.categories={}}function o(t,e){if("string"==typeof t){var r=t.trim(),i="..."===r.substr(0,3);if(i&&(r=r.substr(3)),""===r)this.types=["any"];else{this.types=r.split("|");for(var n=0;n<this.types.length;n++)this.types[n]=this.types[n].trim()}}else{if(!Array.isArray(t)){if(t instanceof o)return t.clone();throw new Error("String or Array expected")}this.types=t}this.conversions=[],this.varArgs=i||e||!1,this.anyType=this.types.indexOf("any")!==-1}function a(t,e){var r;if("string"==typeof t)r=""!==t?t.split(","):[];else{if(!Array.isArray(t))throw new Error("string or Array expected");r=t}this.params=new Array(r.length);for(var i=0;i<r.length;i++){var n=new o(r[i]);if(this.params[i]=n,i===r.length-1)this.varArgs=n.varArgs;else if(n.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."')}this.fn=e}function s(t,e,r){this.path=t||[],this.param=t[t.length-1]||null,this.signature=e||null,this.childs=r||[]}function l(t){var e,r,i={},n=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];if(e=new a(o,s),e.ignore())continue;var l=e.expand();for(r=0;r<l.length;r++){var u=l[r],c=u.toString(),h=i[c];if(h){var f=a.compare(u,h);if(f<0)i[c]=u;else if(0===f)throw new Error('Signature "'+c+'" is defined twice')}else i[c]=u}}for(c in i)i.hasOwnProperty(c)&&n.push(i[c]);for(n.sort(function(t,e){return a.compare(t,e)}),r=0;r<n.length;r++)if(e=n[r],e.varArgs)for(var d=e.params.length-1,p=e.params[d],m=0;m<p.types.length;){if(p.conversions[m])for(var y=p.types[m],v=0;v<n.length;v++){var b=n[v],E=b.params[d];if(b!==e&&E&&g(E.types,y)&&!E.conversions[d]){p.types.splice(m,1),p.conversions.splice(m,1),m--;break}}m++}return n}function u(t){for(var e={},r=0;r<t.length;r++){var i=t[r];if(i.fn&&!i.hasConversions()){var n=i.params.join(",");e[n]=i.fn}}return e}function c(t,e){var r,i,n,a=e.length,l=[];for(r=0;r<t.length;r++)i=t[r],i.params.length!==a||n||(n=i),void 0!=i.params[a]&&l.push(i);l.sort(function(t,e){return o.compare(t.params[a],e.params[a])});var u=[];for(r=0;r<l.length;r++){i=l[r];var h=i.params[a],f=u.filter(function(t){return t.param.overlapping(h)})[0];if(f){if(f.param.varArgs)throw new Error('Conflicting types "'+f.param+'" and "'+h+'"');f.signatures.push(i)}else u.push({param:h,signatures:[i]})}var d=new Array(u.length);for(r=0;r<u.length;r++){var p=u[r];d[r]=c(p.signatures,e.concat(p.param))}return new s(e,n,d)}function h(t){for(var e=[],r=0;r<t;r++)e[r]="arg"+r;return e}function f(t,e){var r=new n,o=l(e);if(0==o.length)throw new Error("No signatures provided");var a=c(o,[]),s=[],f=t||"",p=h(d(o));s.push("function "+f+"("+p.join(", ")+") {"),s.push('  "use strict";'),s.push("  var name = '"+f+"';"),s.push(a.toCode(r,"  ")),s.push("}");var g=[r.toCode(),"return "+s.join("\n")].join("\n"),m=new Function(r.name,"createError",g),y=m(r,i);return y.signatures=u(o),y}function d(t){for(var e=0,r=0;r<t.length;r++){var i=t[r].params.length;i>e&&(e=i)}return e}function p(t){for(var e,r=0;r<_.types.length;r++){var i=_.types[r];if("Object"===i.name)e=i;else if(i.test(t))return i.name}return e&&e.test(t)?e.name:"unknown"}function g(t,e){return t.indexOf(e)!==-1}function m(t,e){if(!t.signatures)throw new TypeError("Function is no typed-function");var r;if("string"==typeof e){r=e.split(",");for(var i=0;i<r.length;i++)r[i]=r[i].trim()}else{if(!Array.isArray(e))throw new TypeError("String array or a comma separated string expected");r=e}var n=r.join(","),o=t.signatures[n];if(o)return o;throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+r.join(", ")+"))")}function y(t,e){var r=p(t);if(e===r)return t;for(var i=0;i<_.conversions.length;i++){var n=_.conversions[i];if(n.from===r&&n.to===e)return n.convert(t)}throw new Error("Cannot convert from "+r+" to "+e)}n.prototype.add=function(t,e){var r=e||"fn";this.categories[r]||(this.categories[r]=[]);var i=this.categories[r].indexOf(t);return i==-1&&(i=this.categories[r].length,this.categories[r].push(t)),r+i},n.prototype.toCode=function(){var t=[],e=this.name+".categories",r=this.categories;for(var i in r)if(r.hasOwnProperty(i))for(var n=r[i],o=0;o<n.length;o++)t.push("var "+i+o+" = "+e+"['"+i+"']["+o+"];");return t.join("\n")},o.compare=function(t,e){if(t.anyType)return 1;if(e.anyType)return-1;if(g(t.types,"Object"))return 1;if(g(e.types,"Object"))return-1;if(t.hasConversions()){if(e.hasConversions()){var r,i,n;for(r=0;r<t.conversions.length;r++)if(void 0!==t.conversions[r]){i=t.conversions[r];break}for(r=0;r<e.conversions.length;r++)if(void 0!==e.conversions[r]){n=e.conversions[r];break}return _.conversions.indexOf(i)-_.conversions.indexOf(n)}return 1}if(e.hasConversions())return-1;var o,a;for(r=0;r<_.types.length;r++)if(_.types[r].name===t.types[0]){o=r;break}for(r=0;r<_.types.length;r++)if(_.types[r].name===e.types[0]){a=r;break}return o-a},o.prototype.overlapping=function(t){for(var e=0;e<this.types.length;e++)if(g(t.types,this.types[e]))return!0;return!1},o.prototype.clone=function(){var t=new o(this.types.slice(),this.varArgs);return t.conversions=this.conversions.slice(),t},o.prototype.hasConversions=function(){return this.conversions.length>0},o.prototype.contains=function(t){for(var e=0;e<this.types.length;e++)if(t[this.types[e]])return!0;return!1},o.prototype.toString=function(t){for(var e=[],r={},i=0;i<this.types.length;i++){var n=this.conversions[i],o=t&&n?n.to:this.types[i];o in r||(r[o]=!0,e.push(o))}return(this.varArgs?"...":"")+e.join("|")},a.prototype.clone=function(){return new a(this.params.slice(),this.fn)},a.prototype.expand=function(){function t(r,i){if(i.length<r.params.length){var n,s,l,u=r.params[i.length];if(u.varArgs){for(s=u.clone(),n=0;n<_.conversions.length;n++)if(l=_.conversions[n],!g(u.types,l.from)&&g(u.types,l.to)){var c=s.types.length;s.types[c]=l.from,s.conversions[c]=l}t(r,i.concat(s))}else{for(n=0;n<u.types.length;n++)t(r,i.concat(new o(u.types[n])));for(n=0;n<_.conversions.length;n++)l=_.conversions[n],!g(u.types,l.from)&&g(u.types,l.to)&&(s=new o(l.from),s.conversions[0]=l,t(r,i.concat(s)))}}else e.push(new a(i,r.fn))}var e=[];return t(this,[]),e},a.compare=function(t,e){if(t.params.length>e.params.length)return 1;if(t.params.length<e.params.length)return-1;var r,i=t.params.length,n=0,a=0;for(r=0;r<i;r++)t.params[r].hasConversions()&&n++,e.params[r].hasConversions()&&a++;if(n>a)return 1;if(n<a)return-1;for(r=0;r<t.params.length;r++){var s=o.compare(t.params[r],e.params[r]);if(0!==s)return s}return 0},a.prototype.hasConversions=function(){for(var t=0;t<this.params.length;t++)if(this.params[t].hasConversions())return!0;return!1},a.prototype.ignore=function(){for(var t={},e=0;e<_.ignore.length;e++)t[_.ignore[e]]=!0;for(e=0;e<this.params.length;e++)if(this.params[e].contains(t))return!0;return!1},a.prototype.toCode=function(t,e){for(var r=[],i=new Array(this.params.length),n=0;n<this.params.length;n++){var o=this.params[n],a=o.conversions[0];o.varArgs?i[n]="varArgs":a?i[n]=t.add(a.convert,"convert")+"(arg"+n+")":i[n]="arg"+n}var s=this.fn?t.add(this.fn,"signature"):void 0;return s?e+"return "+s+"("+i.join(", ")+"); // signature: "+this.params.join(", "):r.join("\n")},a.prototype.toString=function(){return this.params.join(", ")},s.prototype.toCode=function(t,r,i){var n=[];if(this.param){var o=this.path.length-1,a=this.param.conversions[0],s="// type: "+(a?a.from+" (convert to "+a.to+")":this.param);if(this.param.varArgs)if(this.param.anyType)n.push(r+"if (arguments.length > "+o+") {"),n.push(r+"  var varArgs = [];"),n.push(r+"  for (var i = "+o+"; i < arguments.length; i++) {"),n.push(r+"    varArgs.push(arguments[i]);"),n.push(r+"  }"),n.push(this.signature.toCode(t,r+"  ")),n.push(r+"}");else{for(var l=function(r,i){for(var n=[],o=0;o<r.length;o++)n[o]=t.add(e(r[o]),"test")+"("+i+")";return n.join(" || ")}.bind(this),u=this.param.types,c=[],h=0;h<u.length;h++)void 0===this.param.conversions[h]&&c.push(u[h]);n.push(r+"if ("+l(u,"arg"+o)+") { "+s),n.push(r+"  var varArgs = [arg"+o+"];"),n.push(r+"  for (var i = "+(o+1)+"; i < arguments.length; i++) {"),n.push(r+"    if ("+l(c,"arguments[i]")+") {"),n.push(r+"      varArgs.push(arguments[i]);");for(var h=0;h<u.length;h++){var f=this.param.conversions[h];if(f){var d=t.add(e(u[h]),"test"),p=t.add(f.convert,"convert");n.push(r+"    }"),n.push(r+"    else if ("+d+"(arguments[i])) {"),n.push(r+"      varArgs.push("+p+"(arguments[i]));")}}n.push(r+"    } else {"),n.push(r+"      throw createError(name, arguments.length, i, arguments[i], '"+c.join(",")+"');"),n.push(r+"    }"),n.push(r+"  }"),n.push(this.signature.toCode(t,r+"  ")),n.push(r+"}")}else if(this.param.anyType)n.push(r+"// type: any"),n.push(this._innerCode(t,r,i));else{var g=this.param.types[0],d="any"!==g?t.add(e(g),"test"):null;n.push(r+"if ("+d+"(arg"+o+")) { "+s),n.push(this._innerCode(t,r+"  ",i)),n.push(r+"}")}}else n.push(this._innerCode(t,r,i));return n.join("\n")},s.prototype._innerCode=function(t,e,r){var i,n=[];this.signature&&(n.push(e+"if (arguments.length === "+this.path.length+") {"),n.push(this.signature.toCode(t,e+"  ")),n.push(e+"}"));var o;for(i=0;i<this.childs.length;i++)if(this.childs[i].param.anyType){o=this.childs[i];break}for(i=0;i<this.childs.length;i++)n.push(this.childs[i].toCode(t,e,o));r&&!this.param.anyType&&n.push(r.toCode(t,e,o));var a=this._exceptions(t,e);return a&&n.push(a),n.join("\n")},s.prototype._exceptions=function(t,e){var r=this.path.length;if(0===this.childs.length)return[e+"if (arguments.length > "+r+") {",e+"  throw createError(name, arguments.length, "+r+", arguments["+r+"]);",e+"}"].join("\n");for(var i={},n=[],o=0;o<this.childs.length;o++){var a=this.childs[o];if(a.param)for(var s=0;s<a.param.types.length;s++){var l=a.param.types[s];l in i||a.param.conversions[s]||(i[l]=!0,n.push(l))}}return e+"throw createError(name, arguments.length, "+r+", arguments["+r+"], '"+n.join(",")+"');"};var v=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],b={},E=[],w=[],_={config:b,types:v,conversions:E,ignore:w};return _=f("typed",{Object:function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(t[i]);var n=r(e);return f(n,t)},"string, Object":f,"...Function":function(t){for(var e,i=r(t),n={},o=0;o<t.length;o++){var a=t[o];if("object"!=typeof a.signatures)throw e=new TypeError("Function is no typed-function (index: "+o+")"),e.data={index:o},e;for(var s in a.signatures)if(a.signatures.hasOwnProperty(s))if(n.hasOwnProperty(s)){if(a.signatures[s]!==n[s])throw e=new Error('Signature "'+s+'" is defined twice'),e.data={signature:s},e}else n[s]=a.signatures[s]}return f(i,n)}}),_.config=b,_.types=v,_.conversions=E,_.ignore=w,_.create=t,_.find=m,_.convert=y,_.addType=function(t){if(!t||"string"!=typeof t.name||"function"!=typeof t.test)throw new TypeError("Object with properties {name: string, test: function} expected");_.types.push(t)},_.addConversion=function(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");_.conversions.push(t)},_}return t()})},function(t,e,r){"use strict";var i=r(7);e.isNumber=function(t){return"number"==typeof t},e.isInteger=function(t){return!!isFinite(t)&&t==Math.round(t)},e.sign=Math.sign||function(t){return t>0?1:t<0?-1:0},e.format=function(t,r){if("function"==typeof r)return r(t);if(t===1/0)return"Infinity";if(t===-(1/0))return"-Infinity";if(isNaN(t))return"NaN";var i="auto",n=void 0;switch(r&&(r.notation&&(i=r.notation),e.isNumber(r)?n=r:r.precision&&(n=r.precision)),i){case"fixed":return e.toFixed(t,n);case"exponential":return e.toExponential(t,n);case"engineering":return e.toEngineering(t,n);case"auto":return e.toPrecision(t,n,r&&r.exponential).replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", or "fixed".')}},e.toExponential=function(t,e){return new i(t).toExponential(e)},e.toEngineering=function(t,e){return new i(t).toEngineering(e)},e.toFixed=function(t,e){return new i(t).toFixed(e)},e.toPrecision=function(t,e,r){return new i(t).toPrecision(e,r)},e.digits=function(t){return t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length},e.DBL_EPSILON=Number.EPSILON||2.220446049250313e-16,e.nearlyEqual=function(t,r,i){if(null==i)return t==r;if(t==r)return!0;if(isNaN(t)||isNaN(r))return!1;if(isFinite(t)&&isFinite(r)){var n=Math.abs(t-r);return n<e.DBL_EPSILON||n<=Math.max(Math.abs(t),Math.abs(r))*i}return!1}},function(t,e){"use strict";function r(t){var e=String(t).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number");var r=e[1],i=e[2],n=parseFloat(e[4]||"0"),o=i.indexOf(".");n+=o!==-1?o-1:i.length-1,this.sign=r,this.coefficients=i.replace(".","").replace(/^0*/,function(t){return n-=t.length,""}).replace(/0*$/,"").split("").map(function(t){return parseInt(t)}),0===this.coefficients.length&&(this.coefficients.push(0),n++),this.exponent=n}function i(t){for(var e=[],r=0;r<t;r++)e.push(0);return e}r.prototype.toEngineering=function(t){var e=this.roundDigits(t),r=e.exponent,n=e.coefficients,o=r%3===0?r:r<0?r-3-r%3:r-r%3,a=r>=0?r:Math.abs(o);n.length-1<a&&(n=n.concat(i(a-(n.length-1))));for(var s=Math.abs(r-o),l=1,u="";--s>=0;)l++;var c=n.slice(l).join(""),h=c.match(/[1-9]/)?"."+c:"";return u=n.slice(0,l).join("")+h,u+="e"+(r>=0?"+":"")+o.toString(),e.sign+u},r.prototype.toFixed=function(t){var e=this.roundDigits(this.exponent+1+(t||0)),r=e.coefficients,n=e.exponent+1,o=n+(t||0);return r.length<o&&(r=r.concat(i(o-r.length))),n<0&&(r=i(-n+1).concat(r),n=1),t&&r.splice(n,0,0===n?"0.":"."),this.sign+r.join("")},r.prototype.toExponential=function(t){var e=t?this.roundDigits(t):this.clone(),r=e.coefficients,n=e.exponent;r.length<t&&(r=r.concat(i(t-r.length)));var o=r.shift();return this.sign+o+(r.length>0?"."+r.join(""):"")+"e"+(n>=0?"+":"")+n;
},r.prototype.toPrecision=function(t,e){var r=e&&void 0!==e.lower?e.lower:.001,n=e&&void 0!==e.upper?e.upper:1e5,o=Math.abs(Math.pow(10,this.exponent));if(o<r||o>=n)return this.toExponential(t);var a=t?this.roundDigits(t):this.clone(),s=a.coefficients,l=a.exponent;s.length<t&&(s=s.concat(i(t-s.length))),s=s.concat(i(l-s.length+1+(s.length<t?t-s.length:0))),s=i(-l).concat(s);var u=l>0?l:0;return u<s.length-1&&s.splice(u+1,0,"."),this.sign+s.join("")},r.prototype.clone=function(){var t=new r("0");return t.sign=this.sign,t.coefficients=this.coefficients.slice(0),t.exponent=this.exponent,t},r.prototype.roundDigits=function(t){for(var e=this.clone(),r=e.coefficients;t<=0;)r.unshift(0),e.exponent++,t++;if(r.length>t){var i=r.splice(t,r.length-t);if(i[0]>=5){var n=t-1;for(r[n]++;10===r[n];)r.pop(),0===n&&(r.unshift(0),e.exponent++,n++),n--,r[n]++}}return e},t.exports=r},function(t,e,r){var i=r(9);e.mixin=function(t){var e=new i;return t.on=e.on.bind(e),t.off=e.off.bind(e),t.once=e.once.bind(e),t.emit=e.emit.bind(e),t}},function(t,e){function r(){}r.prototype={on:function(t,e,r){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){function i(){n.off(t,i),e.apply(r,arguments)}var n=this;return i._=e,this.on(t,i,r)},emit:function(t){var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),i=0,n=r.length;for(i;i<n;i++)r[i].fn.apply(r[i].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),i=r[t],n=[];if(i&&e)for(var o=0,a=i.length;o<a;o++)i[o].fn!==e&&i[o].fn._!==e&&n.push(i[o]);return n.length?r[t]=n:delete r[t],this}},t.exports=r},function(t,e,r){"use strict";function i(t,e,r,i,l){function u(t,e){var r=arguments.length;if(1!=r&&2!=r)throw new s("import",r,1,2);if(e||(e={}),o(t))d(t,e);else if(Array.isArray(t))t.forEach(function(t){u(t,e)});else if("object"==typeof t){for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];p(n)?c(i,n,e):o(t)?d(t,e):u(n,e)}}else if(!e.silent)throw new TypeError("Factory, Object, or Array expected")}function c(t,e,r){if(r.wrap&&"function"==typeof e&&(e=f(e)),g(l[t])&&g(e))return e=r.override?i(t,e.signatures):i(l[t],e),l[t]=e,h(t,e),void l.emit("import",t,function(){return e});if(void 0===l[t]||r.override)return l[t]=e,h(t,e),void l.emit("import",t,function(){return e});if(!r.silent)throw new Error('Cannot import "'+t+'": already exists')}function h(t,e){e&&"function"==typeof e.transform&&(l.expression.transform[t]=e.transform)}function f(t){var e=function(){for(var e=[],r=0,i=arguments.length;r<i;r++){var n=arguments[r];e[r]=n&&n.valueOf()}return t.apply(l,e)};return t.transform&&(e.transform=t.transform),e}function d(t,e){if("string"==typeof t.name){var o=t.name,s=t.path?a(l,t.path):l,u=s.hasOwnProperty(o)?s[o]:void 0,c=function(){var n=r(t);if(g(u)&&g(n))return e.override||(n=i(u,n)),n;if(void 0===u||e.override)return n;if(!e.silent)throw new Error('Cannot import "'+o+'": already exists')};t.lazy!==!1?n(s,o,c):s[o]=c(),l.emit("import",o,c,t.path)}else r(t)}function p(t){return"function"==typeof t||"number"==typeof t||"string"==typeof t||"boolean"==typeof t||null===t||t&&t.isUnit===!0||t&&t.isComplex===!0||t&&t.isBigNumber===!0||t&&t.isFraction===!0||t&&t.isMatrix===!0||t&&Array.isArray(t)===!0}function g(t){return"function"==typeof t&&"object"==typeof t.signatures}return u}var n=r(3).lazy,o=r(3).isFactory,a=r(3).traverse,s=(r(3).extend,r(11));e.math=!0,e.name="import",e.factory=i,e.lazy=!0},function(t,e){"use strict";function r(t,e,i,n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=i,this.max=n,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+i+(void 0!=n?"-"+n:"")+" expected)",this.stack=(new Error).stack}r.prototype=new Error,r.prototype.constructor=Error,r.prototype.name="ArgumentsError",r.prototype.isArgumentsError=!0,t.exports=r},function(t,e,r){"use strict";function i(t,e,r,i,n){function o(t){if(t){var r=s.clone(e);a(t,"matrix",l),a(t,"number",u),s.deepExtend(e,t);var i=s.clone(e);return n.emit("config",i,r),i}return s.clone(e)}var l=["Matrix","Array"],u=["number","BigNumber","Fraction"];return o.MATRIX=l,o.NUMBER=u,o}function n(t,e){return t.indexOf(e)!==-1}function o(t,e){return t.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())}function a(t,e,r){if(void 0!==t[e]&&!n(r,t[e])){var i=o(r,t[e]);i!==-1?(console.warn('Warning: Wrong casing for configuration option "'+e+'", should be "'+r[i]+'" instead of "'+t[e]+'".'),t[e]=r[i]):console.warn('Warning: Unknown value "'+t[e]+'" for configuration option "'+e+'". Available options: '+r.map(JSON.stringify).join(", ")+".")}}var s=r(3);e.name="config",e.math=!0,e.factory=i},function(t,e,r){t.exports=[r(14),r(100),r(102),r(336),r(502),r(504)]},function(t,e,r){t.exports=[r(15),r(20),r(21),r(26),r(33),r(37),r(70),r(71),r(73),r(74)]},function(t,e,r){t.exports=[r(16),r(18)]},function(t,e,r){function i(t,e,r,i,o){var a=n.clone({precision:e.precision});return a.prototype.type="BigNumber",a.prototype.isBigNumber=!0,a.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},a.fromJSON=function(t){return new a(t.value)},o.on("config",function(t,e){t.precision!==e.precision&&a.config({precision:t.precision})}),a}var n=r(17);e.name="BigNumber",e.path="type",e.factory=i,e.math=!0},function(t,e,r){var i;!function(n){"use strict";function o(t){var e,r,i,n=t.length-1,o="",a=t[0];if(n>0){for(o+=a,e=1;e<n;e++)i=t[e]+"",r=kt-i.length,r&&(o+=m(r)),o+=i;a=t[e],i=a+"",r=kt-i.length,r&&(o+=m(r))}else if(0===a)return"0";for(;a%10===0;)a/=10;return o+a}function a(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Mt+t)}function s(t,e,r,i){var n,o,a,s;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=kt,n=0):(n=Math.ceil((e+1)/kt),e%=kt),o=Nt(10,kt-e),s=t[n]%o|0,null==i?e<3?(0==e?s=s/100|0:1==e&&(s=s/10|0),a=r<4&&99999==s||r>3&&49999==s||5e4==s||0==s):a=(r<4&&s+1==o||r>3&&s+1==o/2)&&(t[n+1]/o/100|0)==Nt(10,e-2)-1||(s==o/2||0==s)&&0==(t[n+1]/o/100|0):e<4?(0==e?s=s/1e3|0:1==e?s=s/100|0:2==e&&(s=s/10|0),a=(i||r<4)&&9999==s||!i&&r>3&&4999==s):a=((i||r<4)&&s+1==o||!i&&r>3&&s+1==o/2)&&(t[n+1]/o/1e3|0)==Nt(10,e-3)-1,a}function l(t,e,r){for(var i,n,o=[0],a=0,s=t.length;a<s;){for(n=o.length;n--;)o[n]*=e;for(o[0]+=bt.indexOf(t.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(void 0===o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}function u(t,e){var r,i,n=e.d.length;n<32?(r=Math.ceil(n/3),i=Math.pow(4,-r).toString()):(r=16,i="2.3283064365386962890625e-10"),t.precision+=r,e=M(t,1,e.times(i),new t(1));for(var o=r;o--;){var a=e.times(e);e=a.times(a).minus(a).times(8).plus(1)}return t.precision-=r,e}function c(t,e,r,i){var n,o,a,s,l,u,c,h,f,d=t.constructor;t:if(null!=e){if(h=t.d,!h)return t;for(n=1,s=h[0];s>=10;s/=10)n++;if(o=e-n,o<0)o+=kt,a=e,c=h[f=0],l=c/Nt(10,n-a-1)%10|0;else if(f=Math.ceil((o+1)/kt),s=h.length,f>=s){if(!i)break t;for(;s++<=f;)h.push(0);c=l=0,n=1,o%=kt,a=o-kt+1}else{for(c=s=h[f],n=1;s>=10;s/=10)n++;o%=kt,a=o-kt+n,l=a<0?0:c/Nt(10,n-a-1)%10|0}if(i=i||e<0||void 0!==h[f+1]||(a<0?c:c%Nt(10,n-a-1)),u=r<4?(l||i)&&(0==r||r==(t.s<0?3:2)):l>5||5==l&&(4==r||i||6==r&&(o>0?a>0?c/Nt(10,n-a):0:h[f-1])%10&1||r==(t.s<0?8:7)),e<1||!h[0])return h.length=0,u?(e-=t.e+1,h[0]=Nt(10,(kt-e%kt)%kt),t.e=-e||0):h[0]=t.e=0,t;if(0==o?(h.length=f,s=1,f--):(h.length=f+1,s=Nt(10,kt-o),h[f]=a>0?(c/Nt(10,n-a)%Nt(10,a)|0)*s:0),u)for(;;){if(0==f){for(o=1,a=h[0];a>=10;a/=10)o++;for(a=h[0]+=s,s=1;a>=10;a/=10)s++;o!=s&&(t.e++,h[0]==It&&(h[0]=1));break}if(h[f]+=s,h[f]!=It)break;h[f--]=0,s=1}for(o=h.length;0===h[--o];)h.pop()}return St&&(t.e>d.maxE?(t.d=null,t.e=NaN):t.e<d.minE&&(t.e=0,t.d=[0])),t}function h(t,e,r){if(!t.isFinite())return _(t);var i,n=t.e,a=o(t.d),s=a.length;return e?(r&&(i=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+m(i):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):n<0?(a="0."+m(-n-1)+a,r&&(i=r-s)>0&&(a+=m(i))):n>=s?(a+=m(n+1-s),r&&(i=r-n-1)>0&&(a=a+"."+m(i))):((i=n+1)<s&&(a=a.slice(0,i)+"."+a.slice(i)),r&&(i=r-s)>0&&(n+1===s&&(a+="."),a+=m(i))),a}function f(t,e){for(var r=1,i=t[0];i>=10;i/=10)r++;return r+e*kt-1}function d(t,e,r){if(e>Vt)throw St=!0,r&&(t.precision=r),Error(Lt);return c(new t(Et),e,1,!0)}function p(t,e,r){if(e>Ft)throw Error(Lt);return c(new t(wt),e,r,!0)}function g(t){var e=t.length-1,r=e*kt+1;if(e=t[e]){for(;e%10==0;e/=10)r--;for(e=t[0];e>=10;e/=10)r++}return r}function m(t){for(var e="";t--;)e+="0";return e}function y(t,e,r,i){var n,o=new t(1),a=Math.ceil(i/kt+4);for(St=!1;;){if(r%2&&(o=o.times(e),N(o.d,a)&&(n=!0)),r=At(r/2),0===r){r=o.d.length-1,n&&0===o.d[r]&&++o.d[r];break}e=e.times(e),N(e.d,a)}return St=!0,o}function v(t){return 1&t.d[t.d.length-1]}function b(t,e,r){for(var i,n=new t(e[0]),o=0;++o<e.length;){if(i=new t(e[o]),!i.s){n=i;break}n[r](i)&&(n=i)}return n}function E(t,e){var r,i,n,a,l,u,h,f=0,d=0,p=0,g=t.constructor,m=g.rounding,y=g.precision;if(!t.d||!t.d[0]||t.e>17)return new g(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(St=!1,h=y):h=e,u=new g(.03125);t.e>-2;)t=t.times(u),p+=5;for(i=Math.log(Nt(2,p))/Math.LN10*2+5|0,h+=i,r=a=l=new g(1),g.precision=h;;){if(a=c(a.times(t),h,1),r=r.times(++d),u=l.plus(Bt(a,r,h,1)),o(u.d).slice(0,h)===o(l.d).slice(0,h)){for(n=p;n--;)l=c(l.times(l),h,1);if(null!=e)return g.precision=y,l;if(!(f<3&&s(l.d,h-i,m,f)))return c(l,g.precision=y,m,St=!0);g.precision=h+=10,r=a=u=new g(1),d=0,f++}l=u}}function w(t,e){var r,i,n,a,l,u,h,f,p,g,m,y=1,v=10,b=t,E=b.d,_=b.constructor,x=_.rounding,S=_.precision;if(b.s<0||!E||!E[0]||!b.e&&1==E[0]&&1==E.length)return new _(E&&!E[0]?-1/0:1!=b.s?NaN:E?0:b);if(null==e?(St=!1,p=S):p=e,_.precision=p+=v,r=o(E),i=r.charAt(0),!(Math.abs(a=b.e)<15e14))return f=d(_,p+2,S).times(a+""),b=w(new _(i+"."+r.slice(1)),p-v).plus(f),_.precision=S,null==e?c(b,S,x,St=!0):b;for(;i<7&&1!=i||1==i&&r.charAt(1)>3;)b=b.times(t),r=o(b.d),i=r.charAt(0),y++;for(a=b.e,i>1?(b=new _("0."+r),a++):b=new _(i+"."+r.slice(1)),g=b,h=l=b=Bt(b.minus(1),b.plus(1),p,1),m=c(b.times(b),p,1),n=3;;){if(l=c(l.times(m),p,1),f=h.plus(Bt(l,new _(n),p,1)),o(f.d).slice(0,p)===o(h.d).slice(0,p)){if(h=h.times(2),0!==a&&(h=h.plus(d(_,p+2,S).times(a+""))),h=Bt(h,new _(y),p,1),null!=e)return _.precision=S,h;if(!s(h.d,p-v,x,u))return c(h,_.precision=S,x,St=!0);_.precision=p+=v,f=l=b=Bt(g.minus(1),g.plus(1),p,1),m=c(b.times(b),p,1),n=u=1}h=f,n+=2}}function _(t){return String(t.s*t.s/0)}function x(t,e){var r,i,n;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(r<0&&(r=i),r+=+e.slice(i+1),e=e.substring(0,i)):r<0&&(r=e.length),i=0;48===e.charCodeAt(i);i++);for(n=e.length;48===e.charCodeAt(n-1);--n);if(e=e.slice(i,n)){if(n-=i,t.e=r=r-i-1,t.d=[],i=(r+1)%kt,r<0&&(i+=kt),i<n){for(i&&t.d.push(+e.slice(0,i)),n-=kt;i<n;)t.d.push(+e.slice(i,i+=kt));e=e.slice(i),i=kt-e.length}else i-=n;for(;i--;)e+="0";t.d.push(+e),St&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function S(t,e){var r,i,n,o,a,s,u,c,h;if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(Rt.test(e))r=16,e=e.toLowerCase();else if(Ct.test(e))r=2;else{if(!Pt.test(e))throw Error(Mt+e);r=8}for(o=e.search(/p/i),o>0?(u=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),o=e.indexOf("."),a=o>=0,i=t.constructor,a&&(e=e.replace(".",""),s=e.length,o=s-o,n=y(i,new i(r),o,2*o)),c=l(e,r,It),h=c.length-1,o=h;0===c[o];--o)c.pop();return o<0?new i(0*t.s):(t.e=f(c,h),t.d=c,St=!1,a&&(t=Bt(t,n,4*s)),u&&(t=t.times(Math.abs(u)<54?Math.pow(2,u):_t.pow(2,u))),St=!0,t)}function T(t,e){var r,i=e.d.length;if(i<3)return M(t,2,e,e);r=1.4*Math.sqrt(i),r=r>16?16:0|r,e=e.times(Math.pow(5,-r)),e=M(t,2,e,e);for(var n,o=new t(5),a=new t(16),s=new t(20);r--;)n=e.times(e),e=e.times(o.plus(n.times(a.times(n).minus(s))));return e}function M(t,e,r,i,n){var o,a,s,l,u=1,c=t.precision,h=Math.ceil(c/kt);for(St=!1,l=r.times(r),s=new t(i);;){if(a=Bt(s.times(l),new t(e++*e++),c,1),s=n?i.plus(a):i.minus(a),i=Bt(a.times(l),new t(e++*e++),c,1),a=s.plus(i),void 0!==a.d[h]){for(o=h;a.d[o]===s.d[o]&&o--;);if(o==-1)break}o=s,s=i,i=a,a=o,u++}return St=!0,a.d.length=h+1,a}function L(t,e){var r,i=e.s<0,n=p(t,t.precision,1),o=n.times(.5);if(e=e.abs(),e.lte(o))return mt=i?4:1,e;if(r=e.divToInt(n),r.isZero())mt=i?3:2;else{if(e=e.minus(r.times(n)),e.lte(o))return mt=v(r)?i?2:3:i?4:1,e;mt=v(r)?i?1:4:i?3:2}return e.minus(n).abs()}function A(t,e,r,i){var n,o,s,u,c,f,d,p,g,m=t.constructor,y=void 0!==r;if(y?(a(r,1,vt),void 0===i?i=m.rounding:a(i,0,8)):(r=m.precision,i=m.rounding),t.isFinite()){for(d=h(t),s=d.indexOf("."),y?(n=2,16==e?r=4*r-3:8==e&&(r=3*r-2)):n=e,s>=0&&(d=d.replace(".",""),g=new m(1),g.e=d.length-s,g.d=l(h(g),10,n),g.e=g.d.length),p=l(d,10,n),o=c=p.length;0==p[--c];)p.pop();if(p[0]){if(s<0?o--:(t=new m(t),t.d=p,t.e=o,t=Bt(t,g,r,i,0,n),p=t.d,o=t.e,f=gt),s=p[r],u=n/2,f=f||void 0!==p[r+1],f=i<4?(void 0!==s||f)&&(0===i||i===(t.s<0?3:2)):s>u||s===u&&(4===i||f||6===i&&1&p[r-1]||i===(t.s<0?8:7)),p.length=r,f)for(;++p[--r]>n-1;)p[r]=0,r||(++o,p.unshift(1));for(c=p.length;!p[c-1];--c);for(s=0,d="";s<c;s++)d+=bt.charAt(p[s]);if(y){if(c>1)if(16==e||8==e){for(s=16==e?4:3,--c;c%s;c++)d+="0";for(p=l(d,n,e),c=p.length;!p[c-1];--c);for(s=1,d="1.";s<c;s++)d+=bt.charAt(p[s])}else d=d.charAt(0)+"."+d.slice(1);d=d+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)d="0"+d;d="0."+d}else if(++o>c)for(o-=c;o--;)d+="0";else o<c&&(d=d.slice(0,o)+"."+d.slice(o))}else d=y?"0p+0":"0";d=(16==e?"0x":2==e?"0b":8==e?"0o":"")+d}else d=_(t);return t.s<0?"-"+d:d}function N(t,e){if(t.length>e)return t.length=e,!0}function C(t){return new this(t).abs()}function R(t){return new this(t).acos()}function P(t){return new this(t).acosh()}function O(t,e){return new this(t).plus(e)}function I(t){return new this(t).asin()}function k(t){return new this(t).asinh()}function D(t){return new this(t).atan()}function V(t){return new this(t).atanh()}function F(t,e){t=new this(t),e=new this(e);var r,i=this.precision,n=this.rounding,o=i+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(r=e.s<0?p(this,i,n):new this(0),r.s=t.s):!t.d||e.isZero()?(r=p(this,o,1).times(.5),r.s=t.s):e.s<0?(this.precision=o,this.rounding=1,r=this.atan(Bt(t,e,o,1)),e=p(this,o,1),this.precision=i,this.rounding=n,r=t.s<0?r.minus(e):r.plus(e)):r=this.atan(Bt(t,e,o,1)):(r=p(this,o,1).times(e.s>0?.25:.75),r.s=t.s):r=new this(NaN),r}function G(t){return new this(t).cbrt()}function B(t){return c(t=new this(t),t.e+1,2)}function W(t){if(!t||"object"!=typeof t)throw Error(Tt+"Object expected");var e,r,i,n=["precision",1,vt,"rounding",0,8,"toExpNeg",-yt,0,"toExpPos",0,yt,"maxE",0,yt,"minE",-yt,0,"modulo",0,9];for(e=0;e<n.length;e+=3)if(void 0!==(i=t[r=n[e]])){if(!(At(i)===i&&i>=n[e+1]&&i<=n[e+2]))throw Error(Mt+r+": "+i);this[r]=i}if(t.hasOwnProperty(r="crypto"))if(void 0===(i=t[r]))this[r]=i;else{if(i!==!0&&i!==!1&&0!==i&&1!==i)throw Error(Mt+r+": "+i);this[r]=!(!i||!xt||!xt.getRandomValues&&!xt.randomBytes)}return this}function U(t){return new this(t).cos()}function z(t){return new this(t).cosh()}function j(t){function e(t){var r,i,n,o=this;if(!(o instanceof e))return new e(t);if(o.constructor=e,t instanceof e)return o.s=t.s,o.e=t.e,void(o.d=(t=t.d)?t.slice():t);if(n=typeof t,"number"===n){if(0===t)return o.s=1/t<0?-1:1,o.e=0,void(o.d=[0]);if(t<0?(t=-t,o.s=-1):o.s=1,t===~~t&&t<1e7){for(r=0,i=t;i>=10;i/=10)r++;return o.e=r,void(o.d=[t])}return 0*t!==0?(t||(o.s=NaN),o.e=NaN,void(o.d=null)):x(o,t.toString())}if("string"!==n)throw Error(Mt+t);return 45===t.charCodeAt(0)?(t=t.slice(1),o.s=-1):o.s=1,Ot.test(t)?x(o,t):S(o,t)}var r,i,n;if(e.prototype=Gt,e.ROUND_UP=0,e.ROUND_DOWN=1,e.ROUND_CEIL=2,e.ROUND_FLOOR=3,e.ROUND_HALF_UP=4,e.ROUND_HALF_DOWN=5,e.ROUND_HALF_EVEN=6,e.ROUND_HALF_CEIL=7,e.ROUND_HALF_FLOOR=8,e.EUCLID=9,e.config=W,e.clone=j,e.abs=C,e.acos=R,e.acosh=P,e.add=O,e.asin=I,e.asinh=k,e.atan=D,e.atanh=V,e.atan2=F,e.cbrt=G,e.ceil=B,e.cos=U,e.cosh=z,e.div=K,e.exp=q,e.floor=Z,e.fromJSON=H,e.hypot=$,e.ln=Y,e.log=X,e.log10=Q,e.log2=J,e.max=tt,e.min=et,e.mod=rt,e.mul=it,e.pow=nt,e.random=ot,e.round=at,e.sign=st,e.sin=lt,e.sinh=ut,e.sqrt=ct,e.sub=ht,e.tan=ft,e.tanh=dt,e.trunc=pt,void 0===t&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<n.length;)t.hasOwnProperty(i=n[r++])||(t[i]=this[i]);return e.config(t),e}function K(t,e){return new this(t).div(e)}function q(t){return new this(t).exp()}function Z(t){return c(t=new this(t),t.e+1,3)}function H(t){var e,r,i,n;if("string"!=typeof t||!t)throw Error(Mt+t);if(i=t.length,n=bt.indexOf(t.charAt(0)),1===i)return new this(n>81?[-1/0,1/0,NaN][n-82]:n>40?-(n-41):n);if(64&n)r=16&n,e=r?(7&n)-3:(15&n)-7,i=1;else{if(2===i)return n=88*n+bt.indexOf(t.charAt(1)),new this(n>=2816?-(n-2816)-41:n+41);if(r=32&n,!(31&n))return t=l(t.slice(1),88,10).join(""),new this(r?"-"+t:t);e=15&n,i=e+1,e=1===e?bt.indexOf(t.charAt(1)):2===e?88*bt.indexOf(t.charAt(1))+bt.indexOf(t.charAt(2)):+l(t.slice(1,i),88,10).join(""),16&n&&(e=-e)}return t=l(t.slice(i),88,10).join(""),e=e-t.length+1,t=t+"e"+e,new this(r?"-"+t:t)}function $(){var t,e,r=new this(0);for(St=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)r.d&&(r=r.plus(e.times(e)));else{if(e.s)return St=!0,new this(1/0);r=e}return St=!0,r.sqrt()}function Y(t){return new this(t).ln()}function X(t,e){return new this(t).log(e)}function J(t){return new this(t).log(2)}function Q(t){return new this(t).log(10)}function tt(){return b(this,arguments,"lt")}function et(){return b(this,arguments,"gt")}function rt(t,e){return new this(t).mod(e)}function it(t,e){return new this(t).mul(e)}function nt(t,e){return new this(t).pow(e)}function ot(t){var e,r,i,n,o=0,s=new this(1),l=[];if(void 0===t?t=this.precision:a(t,1,vt),i=Math.ceil(t/kt),this.crypto===!1)for(;o<i;)l[o++]=1e7*Math.random()|0;else if(xt&&xt.getRandomValues)for(e=xt.getRandomValues(new Uint32Array(i));o<i;)n=e[o],n>=429e7?e[o]=xt.getRandomValues(new Uint32Array(1))[0]:l[o++]=n%1e7;else if(xt&&xt.randomBytes){for(e=xt.randomBytes(i*=4);o<i;)n=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((127&e[o+3])<<24),n>=214e7?xt.randomBytes(4).copy(e,o):(l.push(n%1e7),o+=4);o=i/4}else{if(this.crypto)throw Error(Tt+"crypto unavailable");for(;o<i;)l[o++]=1e7*Math.random()|0}for(i=l[--o],t%=kt,i&&t&&(n=Nt(10,kt-t),l[o]=(i/n|0)*n);0===l[o];o--)l.pop();if(o<0)r=0,l=[0];else{for(r=-1;0===l[0];r-=kt)l.shift();for(i=1,n=l[0];n>=10;n/=10)i++;i<kt&&(r-=kt-i)}return s.e=r,s.d=l,s}function at(t){return c(t=new this(t),t.e+1,this.rounding)}function st(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function lt(t){return new this(t).sin()}function ut(t){return new this(t).sinh()}function ct(t){return new this(t).sqrt()}function ht(t,e){return new this(t).sub(e)}function ft(t){return new this(t).tan()}function dt(t){return new this(t).tanh()}function pt(t){return c(t=new this(t),t.e+1,1)}var gt,mt,yt=9e15,vt=1e9,bt="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%()*+,-./:;=?@[]^_`{|}~",Et="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",wt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",_t={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-yt,maxE:yt,crypto:void 0},xt="undefined"!=typeof crypto?crypto:null,St=!0,Tt="[DecimalError] ",Mt=Tt+"Invalid argument: ",Lt=Tt+"Precision limit exceeded",At=Math.floor,Nt=Math.pow,Ct=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Rt=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Pt=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ot=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,It=1e7,kt=7,Dt=9007199254740991,Vt=Et.length-1,Ft=wt.length-1,Gt={};Gt.absoluteValue=Gt.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),c(t)},Gt.ceil=function(){return c(new this.constructor(this),this.e+1,2)},Gt.comparedTo=Gt.cmp=function(t){var e,r,i,n,o=this,a=o.d,s=(t=new o.constructor(t)).d,l=o.s,u=t.s;if(!a||!s)return l&&u?l!==u?l:a===s?0:!a^l<0?1:-1:NaN;if(!a[0]||!s[0])return a[0]?l:s[0]?-u:0;if(l!==u)return l;if(o.e!==t.e)return o.e>t.e^l<0?1:-1;for(i=a.length,n=s.length,e=0,r=i<n?i:n;e<r;++e)if(a[e]!==s[e])return a[e]>s[e]^l<0?1:-1;return i===n?0:i>n^l<0?1:-1},Gt.cosine=Gt.cos=function(){var t,e,r=this,i=r.constructor;return r.d?r.d[0]?(t=i.precision,e=i.rounding,i.precision=t+Math.max(r.e,r.sd())+kt,i.rounding=1,r=u(i,L(i,r)),i.precision=t,i.rounding=e,c(2==mt||3==mt?r.neg():r,t,e,!0)):new i(1):new i(NaN)},Gt.cubeRoot=Gt.cbrt=function(){var t,e,r,i,n,a,s,l,u,h,f=this,d=f.constructor;if(!f.isFinite()||f.isZero())return new d(f);for(St=!1,a=f.s*Math.pow(f.s*f,1/3),a&&Math.abs(a)!=1/0?i=new d(a.toString()):(r=o(f.d),t=f.e,(a=(t-r.length+1)%3)&&(r+=1==a||a==-2?"0":"00"),a=Math.pow(r,1/3),t=At((t+1)/3)-(t%3==(t<0?-1:2)),a==1/0?r="5e"+t:(r=a.toExponential(),r=r.slice(0,r.indexOf("e")+1)+t),i=new d(r),i.s=f.s),s=(t=d.precision)+3;;)if(l=i,u=l.times(l).times(l),h=u.plus(f),i=Bt(h.plus(f).times(l),h.plus(u),s+2,1),o(l.d).slice(0,s)===(r=o(i.d)).slice(0,s)){if(r=r.slice(s-3,s+1),"9999"!=r&&(n||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(c(i,t+1,1),e=!i.times(i).times(i).eq(f));break}if(!n&&(c(l,t+1,0),l.times(l).times(l).eq(f))){i=l;break}s+=4,n=1}return St=!0,c(i,t,d.rounding,e)},Gt.decimalPlaces=Gt.dp=function(){var t,e=this.d,r=NaN;if(e){if(t=e.length-1,r=(t-At(this.e/kt))*kt,t=e[t])for(;t%10==0;t/=10)r--;r<0&&(r=0)}return r},Gt.dividedBy=Gt.div=function(t){return Bt(this,new this.constructor(t))},Gt.dividedToIntegerBy=Gt.divToInt=function(t){var e=this,r=e.constructor;return c(Bt(e,new r(t),0,1,1),r.precision,r.rounding)},Gt.equals=Gt.eq=function(t){return 0===this.cmp(t)},Gt.floor=function(){return c(new this.constructor(this),this.e+1,3)},Gt.greaterThan=Gt.gt=function(t){return this.cmp(t)>0},Gt.greaterThanOrEqualTo=Gt.gte=function(t){var e=this.cmp(t);return 1==e||0===e},Gt.hyperbolicCosine=Gt.cosh=function(){var t,e,r,i,n,o=this,a=o.constructor,s=new a(1);if(!o.isFinite())return new a(o.s?1/0:NaN);if(o.isZero())return s;r=a.precision,i=a.rounding,a.precision=r+Math.max(o.e,o.sd())+4,a.rounding=1,n=o.d.length,n<32?(t=Math.ceil(n/3),e=Math.pow(4,-t).toString()):(t=16,e="2.3283064365386962890625e-10"),o=M(a,1,o.times(e),new a(1),!0);for(var l,u=t,h=new a(8);u--;)l=o.times(o),o=s.minus(l.times(h.minus(l.times(h))));return c(o,a.precision=r,a.rounding=i,!0)},Gt.hyperbolicSine=Gt.sinh=function(){var t,e,r,i,n=this,o=n.constructor;if(!n.isFinite()||n.isZero())return new o(n);if(e=o.precision,r=o.rounding,o.precision=e+Math.max(n.e,n.sd())+4,o.rounding=1,i=n.d.length,i<3)n=M(o,2,n,n,!0);else{t=1.4*Math.sqrt(i),t=t>16?16:0|t,n=n.times(Math.pow(5,-t)),n=M(o,2,n,n,!0);for(var a,s=new o(5),l=new o(16),u=new o(20);t--;)a=n.times(n),n=n.times(s.plus(a.times(l.times(a).plus(u))))}return o.precision=e,o.rounding=r,c(n,e,r,!0)},Gt.hyperbolicTangent=Gt.tanh=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+7,i.rounding=1,Bt(r.sinh(),r.cosh(),i.precision=t,i.rounding=e)):new i(r.s)},Gt.inverseCosine=Gt.acos=function(){var t,e=this,r=e.constructor,i=e.abs().cmp(1),n=r.precision,o=r.rounding;return i!==-1?0===i?e.isNeg()?p(r,n,o):new r(0):new r(NaN):e.isZero()?p(r,n+4,o).times(.5):(r.precision=n+6,r.rounding=1,e=e.asin(),t=p(r,n+4,o).times(.5),r.precision=n,r.rounding=o,t.minus(e))},Gt.inverseHyperbolicCosine=Gt.acosh=function(){var t,e,r=this,i=r.constructor;return r.lte(1)?new i(r.eq(1)?0:NaN):r.isFinite()?(t=i.precision,e=i.rounding,i.precision=t+Math.max(Math.abs(r.e),r.sd())+4,i.rounding=1,St=!1,r=r.times(r).minus(1).sqrt().plus(r),St=!0,i.precision=t,i.rounding=e,r.ln()):new i(r)},Gt.inverseHyperbolicSine=Gt.asinh=function(){var t,e,r=this,i=r.constructor;return!r.isFinite()||r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+2*Math.max(Math.abs(r.e),r.sd())+6,i.rounding=1,St=!1,r=r.times(r).plus(1).sqrt().plus(r),St=!0,i.precision=t,i.rounding=e,r.ln())},Gt.inverseHyperbolicTangent=Gt.atanh=function(){var t,e,r,i,n=this,o=n.constructor;return n.isFinite()?n.e>=0?new o(n.abs().eq(1)?n.s/0:n.isZero()?n:NaN):(t=o.precision,e=o.rounding,i=n.sd(),Math.max(i,t)<2*-n.e-1?c(new o(n),t,e,!0):(o.precision=r=i-n.e,n=Bt(n.plus(1),new o(1).minus(n),r+t,1),o.precision=t+4,o.rounding=1,n=n.ln(),o.precision=t,o.rounding=e,n.times(.5))):new o(NaN)},Gt.inverseSine=Gt.asin=function(){var t,e,r,i,n=this,o=n.constructor;return n.isZero()?new o(n):(e=n.abs().cmp(1),r=o.precision,i=o.rounding,e!==-1?0===e?(t=p(o,r+4,i).times(.5),t.s=n.s,t):new o(NaN):(o.precision=r+6,o.rounding=1,n=n.div(new o(1).minus(n.times(n)).sqrt().plus(1)).atan(),o.precision=r,o.rounding=i,n.times(2)))},Gt.inverseTangent=Gt.atan=function(){var t,e,r,i,n,o,a,s,l,u=this,h=u.constructor,f=h.precision,d=h.rounding;if(u.isFinite()){if(u.isZero())return new h(u);if(u.abs().eq(1)&&f+4<=Ft)return a=p(h,f+4,d).times(.25),a.s=u.s,a}else{if(!u.s)return new h(NaN);if(f+4<=Ft)return a=p(h,f+4,d).times(.5),a.s=u.s,a}for(h.precision=s=f+10,h.rounding=1,r=Math.min(28,s/kt+2|0),t=r;t;--t)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(St=!1,e=Math.ceil(s/kt),i=1,l=u.times(u),a=new h(u),n=u;t!==-1;)if(n=n.times(l),o=a.minus(n.div(i+=2)),n=n.times(l),a=o.plus(n.div(i+=2)),void 0!==a.d[e])for(t=e;a.d[t]===o.d[t]&&t--;);return r&&(a=a.times(2<<r-1)),St=!0,c(a,h.precision=f,h.rounding=d,!0)},Gt.isFinite=function(){return!!this.d},Gt.isInteger=Gt.isInt=function(){return!!this.d&&At(this.e/kt)>this.d.length-2},Gt.isNaN=function(){return!this.s},Gt.isNegative=Gt.isNeg=function(){return this.s<0},Gt.isPositive=Gt.isPos=function(){return this.s>0},Gt.isZero=function(){return!!this.d&&0===this.d[0]},Gt.lessThan=Gt.lt=function(t){return this.cmp(t)<0},Gt.lessThanOrEqualTo=Gt.lte=function(t){return this.cmp(t)<1},Gt.logarithm=Gt.log=function(t){var e,r,i,n,a,l,u,h,f=this,p=f.constructor,g=p.precision,m=p.rounding,y=5;if(null==t)t=new p(10),e=!0;else{if(t=new p(t),r=t.d,t.s<0||!r||!r[0]||t.eq(1))return new p(NaN);e=t.eq(10)}if(r=f.d,f.s<0||!r||!r[0]||f.eq(1))return new p(r&&!r[0]?-1/0:1!=f.s?NaN:r?0:1/0);if(e)if(r.length>1)a=!0;else{for(n=r[0];n%10===0;)n/=10;a=1!==n}if(St=!1,u=g+y,l=w(f,u),i=e?d(p,u+10):w(t,u),h=Bt(l,i,u,1),s(h.d,n=g,m))do if(u+=10,l=w(f,u),i=e?d(p,u+10):w(t,u),h=Bt(l,i,u,1),!a){+o(h.d).slice(n+1,n+15)+1==1e14&&(h=c(h,g+1,0));break}while(s(h.d,n+=10,m));return St=!0,c(h,g,m)},Gt.minus=Gt.sub=function(t){var e,r,i,n,o,a,s,l,u,h,d,p,g=this,m=g.constructor;if(t=new m(t),!g.d||!t.d)return g.s&&t.s?g.d?t.s=-t.s:t=new m(t.d||g.s!==t.s?g:NaN):t=new m(NaN),t;if(g.s!=t.s)return t.s=-t.s,g.plus(t);if(u=g.d,p=t.d,s=m.precision,l=m.rounding,!u[0]||!p[0]){if(p[0])t.s=-t.s;else{if(!u[0])return new m(3===l?-0:0);t=new m(g)}return St?c(t,s,l):t}if(r=At(t.e/kt),h=At(g.e/kt),u=u.slice(),o=h-r){for(d=o<0,d?(e=u,o=-o,a=p.length):(e=p,r=h,a=u.length),i=Math.max(Math.ceil(s/kt),a)+2,o>i&&(o=i,e.length=1),e.reverse(),i=o;i--;)e.push(0);e.reverse()}else{for(i=u.length,a=p.length,d=i<a,d&&(a=i),i=0;i<a;i++)if(u[i]!=p[i]){d=u[i]<p[i];break}o=0}for(d&&(e=u,u=p,p=e,t.s=-t.s),a=u.length,i=p.length-a;i>0;--i)u[a++]=0;for(i=p.length;i>o;){if(u[--i]<p[i]){for(n=i;n&&0===u[--n];)u[n]=It-1;--u[n],u[i]+=It}u[i]-=p[i]}for(;0===u[--a];)u.pop();for(;0===u[0];u.shift())--r;return u[0]?(t.d=u,t.e=f(u,r),St?c(t,s,l):t):new m(3===l?-0:0)},Gt.modulo=Gt.mod=function(t){var e,r=this,i=r.constructor;return t=new i(t),!r.d||!t.s||t.d&&!t.d[0]?new i(NaN):!t.d||r.d&&!r.d[0]?c(new i(r),i.precision,i.rounding):(St=!1,9==i.modulo?(e=Bt(r,t.abs(),0,3,1),e.s*=t.s):e=Bt(r,t,0,i.modulo,1),e=e.times(t),St=!0,r.minus(e))},Gt.naturalExponential=Gt.exp=function(){return E(this)},Gt.naturalLogarithm=Gt.ln=function(){return w(this)},Gt.negated=Gt.neg=function(){var t=new this.constructor(this);return t.s=-t.s,c(t)},Gt.plus=Gt.add=function(t){var e,r,i,n,o,a,s,l,u,h,d=this,p=d.constructor;if(t=new p(t),!d.d||!t.d)return d.s&&t.s?d.d||(t=new p(t.d||d.s===t.s?d:NaN)):t=new p(NaN),t;if(d.s!=t.s)return t.s=-t.s,d.minus(t);if(u=d.d,h=t.d,s=p.precision,l=p.rounding,!u[0]||!h[0])return h[0]||(t=new p(d)),St?c(t,s,l):t;if(o=At(d.e/kt),i=At(t.e/kt),u=u.slice(),n=o-i){for(n<0?(r=u,n=-n,a=h.length):(r=h,i=o,a=u.length),o=Math.ceil(s/kt),a=o>a?o+1:a+1,n>a&&(n=a,r.length=1),r.reverse();n--;)r.push(0);r.reverse()}for(a=u.length,n=h.length,a-n<0&&(n=a,r=h,h=u,u=r),e=0;n;)e=(u[--n]=u[n]+h[n]+e)/It|0,u[n]%=It;for(e&&(u.unshift(e),++i),a=u.length;0==u[--a];)u.pop();return t.d=u,t.e=f(u,i),St?c(t,s,l):t},Gt.precision=Gt.sd=function(t){var e,r=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(Mt+t);return r.d?(e=g(r.d),t&&r.e+1>e&&(e=r.e+1)):e=NaN,e},Gt.round=function(){var t=this,e=t.constructor;return c(new e(t),t.e+1,e.rounding)},Gt.sine=Gt.sin=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+Math.max(r.e,r.sd())+kt,i.rounding=1,r=T(i,L(i,r)),i.precision=t,i.rounding=e,c(mt>2?r.neg():r,t,e,!0)):new i(NaN)},Gt.squareRoot=Gt.sqrt=function(){var t,e,r,i,n,a,s=this,l=s.d,u=s.e,h=s.s,f=s.constructor;if(1!==h||!l||!l[0])return new f(!h||h<0&&(!l||l[0])?NaN:l?s:1/0);for(St=!1,h=Math.sqrt(+s),0==h||h==1/0?(e=o(l),(e.length+u)%2==0&&(e+="0"),h=Math.sqrt(e),u=At((u+1)/2)-(u<0||u%2),h==1/0?e="1e"+u:(e=h.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),i=new f(e)):i=new f(h.toString()),r=(u=f.precision)+3;;)if(a=i,i=a.plus(Bt(s,a,r+2,1)).times(.5),o(a.d).slice(0,r)===(e=o(i.d)).slice(0,r)){if(e=e.slice(r-3,r+1),"9999"!=e&&(n||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(c(i,u+1,1),t=!i.times(i).eq(s));break}if(!n&&(c(a,u+1,0),a.times(a).eq(s))){i=a;break}r+=4,n=1}return St=!0,c(i,u,f.rounding,t)},Gt.tangent=Gt.tan=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+10,i.rounding=1,r=r.sin(),r.s=1,r=Bt(r,new i(1).minus(r.times(r)).sqrt(),t+10,0),i.precision=t,i.rounding=e,c(2==mt||4==mt?r.neg():r,t,e,!0)):new i(NaN)},Gt.times=Gt.mul=function(t){var e,r,i,n,o,a,s,l,u,h=this,d=h.constructor,p=h.d,g=(t=new d(t)).d;if(t.s*=h.s,!(p&&p[0]&&g&&g[0]))return new d(!t.s||p&&!p[0]&&!g||g&&!g[0]&&!p?NaN:p&&g?0*t.s:t.s/0);for(r=At(h.e/kt)+At(t.e/kt),l=p.length,u=g.length,l<u&&(o=p,p=g,g=o,a=l,l=u,u=a),o=[],
a=l+u,i=a;i--;)o.push(0);for(i=u;--i>=0;){for(e=0,n=l+i;n>i;)s=o[n]+g[i]*p[n-i-1]+e,o[n--]=s%It|0,e=s/It|0;o[n]=(o[n]+e)%It|0}for(;!o[--a];)o.pop();for(e?++r:o.shift(),i=o.length;!o[--i];)o.pop();return t.d=o,t.e=f(o,r),St?c(t,d.precision,d.rounding):t},Gt.toBinary=function(t,e){return A(this,2,t,e)},Gt.toDecimalPlaces=Gt.toDP=function(t,e){var r=this,i=r.constructor;return r=new i(r),void 0===t?r:(a(t,0,vt),void 0===e?e=i.rounding:a(e,0,8),c(r,t+r.e+1,e))},Gt.toExponential=function(t,e){var r,i=this,n=i.constructor;return void 0===t?r=h(i,!0):(a(t,0,vt),void 0===e?e=n.rounding:a(e,0,8),i=c(new n(i),t+1,e),r=h(i,!0,t+1)),i.isNeg()&&!i.isZero()?"-"+r:r},Gt.toFixed=function(t,e){var r,i,n=this,o=n.constructor;return void 0===t?r=h(n):(a(t,0,vt),void 0===e?e=o.rounding:a(e,0,8),i=c(new o(n),t+n.e+1,e),r=h(i,!1,t+i.e+1)),n.isNeg()&&!n.isZero()?"-"+r:r},Gt.toFraction=function(t){var e,r,i,n,a,s,l,u,c,h,f,d,p=this,m=p.d,y=p.constructor;if(!m)return new y(p);if(c=r=new y(1),i=u=new y(0),e=new y(i),a=e.e=g(m)-p.e-1,s=a%kt,e.d[0]=Nt(10,s<0?kt+s:s),null==t)t=a>0?e:c;else{if(l=new y(t),!l.isInt()||l.lt(c))throw Error(Mt+l);t=l.gt(e)?a>0?e:c:l}for(St=!1,l=new y(o(m)),h=y.precision,y.precision=a=m.length*kt*2;f=Bt(l,e,0,1,1),n=r.plus(f.times(i)),1!=n.cmp(t);)r=i,i=n,n=c,c=u.plus(f.times(n)),u=n,n=e,e=l.minus(f.times(n)),l=n;return n=Bt(t.minus(r),i,0,1,1),u=u.plus(n.times(c)),r=r.plus(n.times(i)),u.s=c.s=p.s,d=Bt(c,i,a,1).minus(p).abs().cmp(Bt(u,r,a,1).minus(p).abs())<1?[c,i]:[u,r],y.precision=h,St=!0,d},Gt.toHexadecimal=Gt.toHex=function(t,e){return A(this,16,t,e)},Gt.toJSON=function(){var t,e,r,i,n,a,s,u,c=this,h=c.s<0;if(!c.d)return bt.charAt(c.s?h?82:83:84);if(e=c.e,1===c.d.length&&e<4&&e>=0&&(a=c.d[0],a<2857))return a<41?bt.charAt(h?a+41:a):(a-=41,h&&(a+=2816),i=a/88|0,bt.charAt(i)+bt.charAt(a-88*i));if(u=o(c.d),s="",!h&&e<=8&&e>=-7)i=64+e+7;else if(h&&e<=4&&e>=-3)i=80+e+3;else if(u.length===e+1)i=32*h;else if(i=32*h+16*(e<0),e=Math.abs(e),e<88)i+=1,s=bt.charAt(e);else if(e<7744)i+=2,a=e/88|0,s=bt.charAt(a)+bt.charAt(e-88*a);else for(t=l(String(e),10,88),n=t.length,i+=n,r=0;r<n;r++)s+=bt.charAt(t[r]);for(s=bt.charAt(i)+s,t=l(u,10,88),n=t.length,r=0;r<n;r++)s+=bt.charAt(t[r]);return s},Gt.toNearest=function(t,e){var r=this,i=r.constructor;if(r=new i(r),null==t){if(!r.d)return r;t=new i(1),e=i.rounding}else{if(t=new i(t),void 0!==e&&a(e,0,8),!r.d)return t.s?r:t;if(!t.d)return t.s&&(t.s=r.s),t}return t.d[0]?(St=!1,e<4&&(e=[4,5,7,8][e]),r=Bt(r,t,0,e,1).times(t),St=!0,c(r)):(t.s=r.s,r=t),r},Gt.toNumber=function(){return+this},Gt.toOctal=function(t,e){return A(this,8,t,e)},Gt.toPower=Gt.pow=function(t){var e,r,i,n,a,l,u,h=this,f=h.constructor,d=+(t=new f(t));if(!(h.d&&t.d&&h.d[0]&&t.d[0]))return new f(Nt(+h,d));if(h=new f(h),h.eq(1))return h;if(i=f.precision,a=f.rounding,t.eq(1))return c(h,i,a);if(e=At(t.e/kt),r=t.d.length-1,u=e>=r,l=h.s,u){if((r=d<0?-d:d)<=Dt)return n=y(f,h,r,i),t.s<0?new f(1).div(n):c(n,i,a)}else if(l<0)return new f(NaN);return l=l<0&&1&t.d[Math.max(e,r)]?-1:1,r=Nt(+h,d),e=0!=r&&isFinite(r)?new f(r+"").e:At(d*(Math.log("0."+o(h.d))/Math.LN10+h.e+1)),e>f.maxE+1||e<f.minE-1?new f(e>0?l/0:0):(St=!1,f.rounding=h.s=1,r=Math.min(12,(e+"").length),n=E(t.times(w(h,i+r)),i),n=c(n,i+5,1),s(n.d,i,a)&&(e=i+10,n=c(E(t.times(w(h,e+r)),e),e+5,1),+o(n.d).slice(i+1,i+15)+1==1e14&&(n=c(n,i+1,0))),n.s=l,St=!0,f.rounding=a,c(n,i,a))},Gt.toPrecision=function(t,e){var r,i=this,n=i.constructor;return void 0===t?r=h(i,i.e<=n.toExpNeg||i.e>=n.toExpPos):(a(t,1,vt),void 0===e?e=n.rounding:a(e,0,8),i=c(new n(i),t,e),r=h(i,t<=i.e||i.e<=n.toExpNeg,t)),i.isNeg()&&!i.isZero()?"-"+r:r},Gt.toSignificantDigits=Gt.toSD=function(t,e){var r=this,i=r.constructor;return void 0===t?(t=i.precision,e=i.rounding):(a(t,1,vt),void 0===e?e=i.rounding:a(e,0,8)),c(new i(r),t,e)},Gt.toString=function(){var t=this,e=t.constructor,r=h(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+r:r},Gt.truncated=Gt.trunc=function(){return c(new this.constructor(this),this.e+1,1)},Gt.valueOf=function(){var t=this,e=t.constructor,r=h(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+r:r};var Bt=function(){function t(t,e,r){var i,n=0,o=t.length;for(t=t.slice();o--;)i=t[o]*e+n,t[o]=i%r|0,n=i/r|0;return n&&t.unshift(n),t}function e(t,e,r,i){var n,o;if(r!=i)o=r>i?1:-1;else for(n=o=0;n<r;n++)if(t[n]!=e[n]){o=t[n]>e[n]?1:-1;break}return o}function r(t,e,r,i){for(var n=0;r--;)t[r]-=n,n=t[r]<e[r]?1:0,t[r]=n*i+t[r]-e[r];for(;!t[0]&&t.length>1;)t.shift()}return function(i,n,o,a,s,l){var u,h,f,d,p,g,m,y,v,b,E,w,_,x,S,T,M,L,A,N,C=i.constructor,R=i.s==n.s?1:-1,P=i.d,O=n.d;if(!(P&&P[0]&&O&&O[0]))return new C(i.s&&n.s&&(P?!O||P[0]!=O[0]:O)?P&&0==P[0]||!O?0*R:R/0:NaN);for(l?(p=1,h=i.e-n.e):(l=It,p=kt,h=At(i.e/p)-At(n.e/p)),A=O.length,M=P.length,v=new C(R),b=v.d=[],f=0;O[f]==(P[f]||0);f++);if(O[f]>(P[f]||0)&&h--,null==o?(x=o=C.precision,a=C.rounding):x=s?o+(i.e-n.e)+1:o,x<0)b.push(1),g=!0;else{if(x=x/p+2|0,f=0,1==A){for(d=0,O=O[0],x++;(f<M||d)&&x--;f++)S=d*l+(P[f]||0),b[f]=S/O|0,d=S%O|0;g=d||f<M}else{for(d=l/(O[0]+1)|0,d>1&&(O=t(O,d,l),P=t(P,d,l),A=O.length,M=P.length),T=A,E=P.slice(0,A),w=E.length;w<A;)E[w++]=0;N=O.slice(),N.unshift(0),L=O[0],O[1]>=l/2&&++L;do d=0,u=e(O,E,A,w),u<0?(_=E[0],A!=w&&(_=_*l+(E[1]||0)),d=_/L|0,d>1?(d>=l&&(d=l-1),m=t(O,d,l),y=m.length,w=E.length,u=e(m,E,y,w),1==u&&(d--,r(m,A<y?N:O,y,l))):(0==d&&(u=d=1),m=O.slice()),y=m.length,y<w&&m.unshift(0),r(E,m,w,l),u==-1&&(w=E.length,u=e(O,E,A,w),u<1&&(d++,r(E,A<w?N:O,w,l))),w=E.length):0===u&&(d++,E=[0]),b[f++]=d,u&&E[0]?E[w++]=P[T]||0:(E=[P[T]],w=1);while((T++<M||void 0!==E[0])&&x--);g=void 0!==E[0]}b[0]||b.shift()}if(1==p)v.e=h,gt=g;else{for(f=1,d=b[0];d>=10;d/=10)f++;v.e=f+h*p-1,c(v,s?o+v.e+1:o,a,g)}return v}}();_t=j(_t),Et=new _t(Et),wt=new _t(wt),i=function(){return _t}.call(e,r,e,t),!(void 0!==i&&(t.exports=i))}(this)},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("bignumber",{"":function(){return new t.BigNumber(0)},number:function(e){return new t.BigNumber(e+"")},string:function(e){return new t.BigNumber(e)},BigNumber:function(t){return t},Fraction:function(e){return new t.BigNumber(e.n).div(e.d)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)"},o}var n=r(19);e.name="bignumber",e.factory=i},function(t,e){"use strict";t.exports=function t(e,r,i){return e&&"function"==typeof e.map?e.map(function(e){return t(e,r,i)}):r(e)}},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("bool",{"":function(){return!1},boolean:function(t){return t},number:function(t){return!!t},BigNumber:function(t){return!t.isZero()},string:function(t){var e=t.toLowerCase();if("true"===e)return!0;if("false"===e)return!1;var r=Number(t);if(""!=t&&!isNaN(r))return!!r;throw new Error('Cannot convert "'+t+'" to a boolean')},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);e.name="boolean",e.factory=i},function(t,e,r){t.exports=[r(22),r(25)]},function(t,e,r){"use strict";function i(t,e,r,i,a){function s(t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");t&&t.isChain?this.value=t.value:this.value=t}function l(t,e){"function"==typeof e&&(s.prototype[t]=c(e))}function u(t,e){o(s.prototype,t,function(){var t=e();if("function"==typeof t)return c(t)})}function c(t){return function(){for(var e=[this.value],r=0;r<arguments.length;r++)e[r+1]=arguments[r];return new s(t.apply(t,e))}}return s.prototype.type="Chain",s.prototype.isChain=!0,s.prototype.done=function(){return this.value},s.prototype.valueOf=function(){return this.value},s.prototype.toString=function(){return n(this.value)},s.createProxy=function(t,e){if("string"==typeof t)l(t,e);else for(var r in t)t.hasOwnProperty(r)&&l(r,t[r])},s.createProxy(a),a.on("import",function(t,e,r){void 0===r&&u(t,e)}),s}var n=r(23).format,o=r(3).lazy;e.name="Chain",e.path="type",e.factory=i,e.math=!0,e.lazy=!1},function(t,e,r){"use strict";function i(t,r){if(Array.isArray(t)){for(var n="[",o=t.length,a=0;a<o;a++)0!=a&&(n+=", "),n+=i(t[a],r);return n+="]"}return e.format(t,r)}var n=r(6).format,o=r(24).format;e.isString=function(t){return"string"==typeof t},e.endsWith=function(t,e){var r=t.length-e.length,i=t.length;return t.substring(r,i)===e},e.format=function(t,r){if("number"==typeof t)return n(t,r);if(t&&t.isBigNumber===!0)return o(t,r);if(t&&t.isFraction===!0)return r&&"decimal"===r.fraction?t.toString():t.s*t.n+"/"+t.d;if(Array.isArray(t))return i(t,r);if(e.isString(t))return'"'+t+'"';if("function"==typeof t)return t.syntax?String(t.syntax):"function";if(t&&"object"==typeof t){if("function"==typeof t.format)return t.format(r);if(t&&t.toString()!=={}.toString())return t.toString();var a=[];for(var s in t)t.hasOwnProperty(s)&&a.push('"'+s+'": '+e.format(t[s],r));return"{"+a.join(", ")+"}"}return String(t)}},function(t,e){e.format=function(t,r){if("function"==typeof r)return r(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var i="auto",n=void 0;switch(void 0!==r&&(r.notation&&(i=r.notation),"number"==typeof r?n=r:r.precision&&(n=r.precision)),i){case"fixed":return e.toFixed(t,n);case"exponential":return e.toExponential(t,n);case"auto":var o=.001,a=1e5;r&&r.exponential&&(void 0!==r.exponential.lower&&(o=r.exponential.lower),void 0!==r.exponential.upper&&(a=r.exponential.upper));({toExpNeg:t.constructor.toExpNeg,toExpPos:t.constructor.toExpPos});if(t.constructor.config({toExpNeg:Math.round(Math.log(o)/Math.LN10),toExpPos:Math.round(Math.log(a)/Math.LN10)}),t.isZero())return"0";var s,l=t.abs();return s=l.gte(o)&&l.lt(a)?t.toSignificantDigits(n).toFixed():e.toExponential(t,n),s.replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", or "fixed".')}},e.toExponential=function(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()},e.toFixed=function(t,e){return t.toFixed(e||0)}},function(t,e){"use strict";function r(t,e,r,i){return i("chain",{"":function(){return new t.Chain},any:function(e){return new t.Chain(e)}})}e.name="chain",e.factory=r},function(t,e,r){t.exports=[r(27),r(31)]},function(t,e,r){function i(t,e,r,i,s){return n.prototype.type="Complex",n.prototype.isComplex=!0,n.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},n.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},n.prototype.format=function(t){var e="",r=this.im,i=this.re,n=o(this.re,t),s=o(this.im,t),l=a(t)?t:t?t.precision:null;if(null!==l){var u=Math.pow(10,-l);Math.abs(i/r)<u&&(i=0),Math.abs(r/i)<u&&(r=0)}return e=0==r?n:0==i?1==r?"i":r==-1?"-i":s+"i":r>0?1==r?n+" + i":n+" + "+s+"i":r==-1?n+" - i":n+" - "+s.substring(1)+"i"},n.fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return n(e);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var r=arguments[0],i=arguments[1];if(a(r)){if(i&&i.isUnit&&i.hasBase("ANGLE")&&(i=i.toNumber("rad")),a(i))return new n({r:r,phi:i});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},n.prototype.valueOf=n.prototype.toString,n.fromJSON=function(t){return new n(t)},n.EPSILON=e.epsilon,s.on("config",function(t,e){t.epsilon!==e.epsilon&&(n.EPSILON=t.epsilon)}),n}var n=r(28),o=r(6).format,a=r(6).isNumber;e.name="Complex",e.path="type",e.factory=i,e.math=!0},function(t,e,r){var i,n;(function(t){!function(o){"use strict";function a(t,e){var r=Math.abs(t),i=Math.abs(e);return 0===t?Math.log(i):0===e?Math.log(r):r<3e3&&i<3e3?.5*Math.log(t*t+e*e):Math.log(t/Math.cos(Math.atan2(e,t)))}function s(t,e){return this instanceof s?(c(t,e),this.re=l.re,void(this.im=l.im)):new s(t,e)}var l={re:0,im:0};Math.cosh=Math.cosh||function(t){return.5*(Math.exp(t)+Math.exp(-t))},Math.sinh=Math.sinh||function(t){return.5*(Math.exp(t)-Math.exp(-t))};var u=function(){throw SyntaxError("Invalid Param")},c=function(t,e){if(void 0===t||null===t)l.re=l.im=0;else if(void 0!==e)l.re=t,l.im=e;else switch(typeof t){case"object":"im"in t&&"re"in t?(l.re=t.re,l.im=t.im):"abs"in t&&"arg"in t?(l.re=t.abs*Math.cos(t.arg),l.im=t.abs*Math.sin(t.arg)):"r"in t&&"phi"in t?(l.re=t.r*Math.cos(t.phi),l.im=t.r*Math.sin(t.phi)):u();break;case"string":l.im=l.re=0;var r=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),i=1,n=0;null===r&&u();for(var o=0;o<r.length;o++){var a=r[o];" "===a||"\t"===a||"\n"===a||("+"===a?i++:"-"===a?n++:"i"===a||"I"===a?(i+n===0&&u()," "===r[o+1]||isNaN(r[o+1])?l.im+=parseFloat((n%2?"-":"")+"1"):(l.im+=parseFloat((n%2?"-":"")+r[o+1]),o++),i=n=0):((i+n===0||isNaN(a))&&u(),"i"===r[o+1]||"I"===r[o+1]?(l.im+=parseFloat((n%2?"-":"")+a),o++):l.re+=parseFloat((n%2?"-":"")+a),i=n=0))}i+n>0&&u();break;case"number":l.im=0,l.re=t;break;default:u()}isNaN(l.re)||isNaN(l.im)};s.prototype={re:0,im:0,sign:function(){var t=this.abs();return new s(this.re/t,this.im/t)},add:function(t,e){return c(t,e),new s(this.re+l.re,this.im+l.im)},sub:function(t,e){return c(t,e),new s(this.re-l.re,this.im-l.im)},mul:function(t,e){return c(t,e),0===l.im&&0===this.im?new s(this.re*l.re,0):new s(this.re*l.re-this.im*l.im,this.re*l.im+this.im*l.re)},div:function(t,e){c(t,e),t=this.re,e=this.im;var r,i,n=l.re,o=l.im;return 0===n&&0===o?new s(0!==t?t/0:0,0!==e?e/0:0):0===o?new s(t/n,e/n):Math.abs(n)<Math.abs(o)?(i=n/o,r=n*i+o,new s((t*i+e)/r,(e*i-t)/r)):(i=o/n,r=o*i+n,new s((t+e*i)/r,(e-t*i)/r))},pow:function(t,e){if(c(t,e),t=this.re,e=this.im,0===t&&0===e)return new s(0,0);var r=Math.atan2(e,t),i=a(t,e);if(0===l.im){if(0===e&&t>=0)return new s(Math.pow(t,l.re),0);if(0===t)switch(l.re%4){case 0:return new s(Math.pow(e,l.re),0);case 1:return new s(0,Math.pow(e,l.re));case 2:return new s(-Math.pow(e,l.re),0);case 3:return new s(0,-Math.pow(e,l.re))}}return t=Math.exp(l.re*i-l.im*r),e=l.im*i+l.re*r,new s(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,r=this.re,i=this.im,n=this.abs();return r>=0&&0===i?new s(Math.sqrt(r),0):(t=r>=0?.5*Math.sqrt(2*(n+r)):Math.abs(i)/Math.sqrt(2*(n-r)),e=r<=0?.5*Math.sqrt(2*(n-r)):Math.abs(i)/Math.sqrt(2*(n+r)),new s(t,i>=0?e:-e))},exp:function(){var t=Math.exp(this.re);return 0===this.im,new s(t*Math.cos(this.im),t*Math.sin(this.im))},log:function(){var t=this.re,e=this.im;return new s(a(t,e),Math.atan2(e,t))},abs:function(){var t=Math.abs(this.re),e=Math.abs(this.im);return t<3e3&&e<3e3?Math.sqrt(t*t+e*e):(t<e?(t=e,e=this.re/this.im):e=this.im/this.re,t*Math.sqrt(1+e*e))},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,e=this.im;return new s(Math.sin(t)*Math.cosh(e),Math.cos(t)*Math.sinh(e))},cos:function(){var t=this.re,e=this.im;return new s(Math.cos(t)*Math.cosh(e),-Math.sin(t)*Math.sinh(e))},tan:function(){var t=2*this.re,e=2*this.im,r=Math.cos(t)+Math.cosh(e);return new s(Math.sin(t)/r,Math.sinh(e)/r)},cot:function(){var t=2*this.re,e=2*this.im,r=Math.cos(t)-Math.cosh(e);return new s(-Math.sin(t)/r,Math.sinh(e)/r)},sec:function(){var t=this.re,e=this.im,r=.5*Math.cosh(2*e)+.5*Math.cos(2*t);return new s(Math.cos(t)*Math.cosh(e)/r,Math.sin(t)*Math.sinh(e)/r)},csc:function(){var t=this.re,e=this.im,r=.5*Math.cosh(2*e)-.5*Math.cos(2*t);return new s(Math.sin(t)*Math.cosh(e)/r,-Math.cos(t)*Math.sinh(e)/r)},asin:function(){var t=this.re,e=this.im,r=new s(e*e-t*t+1,-2*t*e).sqrt(),i=new s(r.re-e,r.im+t).log();return new s(i.im,-i.re)},acos:function(){var t=this.re,e=this.im,r=new s(e*e-t*t+1,-2*t*e).sqrt(),i=new s(r.re-e,r.im+t).log();return new s(Math.PI/2-i.im,i.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new s(0,1/0);if(e===-1)return new s(0,-(1/0))}var r=t*t+(1-e)*(1-e),i=new s((1-e*e-t*t)/r,-2*t/r).log();return new s(-.5*i.im,.5*i.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new s(Math.atan2(1,t),0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).atan():new s(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(0,1/0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).acos():new s(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(Math.PI/2,1/0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).asin():new s(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,e=this.im;return new s(Math.sinh(t)*Math.cos(e),Math.cosh(t)*Math.sin(e))},cosh:function(){var t=this.re,e=this.im;return new s(Math.cosh(t)*Math.cos(e),Math.sinh(t)*Math.sin(e))},tanh:function(){var t=2*this.re,e=2*this.im,r=Math.cosh(t)+Math.cos(e);return new s(Math.sinh(t)/r,Math.sin(e)/r)},coth:function(){var t=2*this.re,e=2*this.im,r=Math.cosh(t)-Math.cos(e);return new s(Math.sinh(t)/r,-Math.sin(e)/r)},csch:function(){var t=this.re,e=this.im,r=Math.cos(2*e)-Math.cosh(2*t);return new s(-2*Math.sinh(t)*Math.cos(e)/r,2*Math.cosh(t)*Math.sin(e)/r)},sech:function(){var t=this.re,e=this.im,r=Math.cos(2*e)+Math.cosh(2*t);return new s(2*Math.cosh(t)*Math.cos(e)/r,-2*Math.sinh(t)*Math.sin(e)/r)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t,e=this.acos();return e.im<=0?(t=e.re,e.re=-e.im,e.im=t):(t=e.im,e.im=-e.re,e.re=t),e},atanh:function(){var t=this.re,e=this.im,r=t>1&&0===e,i=1-t,n=1+t,o=i*i+e*e,l=0!==o?new s((n*i-e*e)/o,(e*i+n*e)/o):new s(t!==-1?t/0:0,0!==e?e/0:0),u=l.re;return l.re=a(l.re,l.im)/2,l.im=Math.atan2(l.im,u)/2,r&&(l.im=-l.im),l},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(0,Math.PI/2);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).atanh():new s(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new s(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).asinh():new s(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(1/0,0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).acosh():new s(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){var t=this.re,e=this.im,r=t*t+e*e;return new s(0!==t?t/r:0,0!==e?-e/r:0)},conjugate:function(){return new s(this.re,-this.im)},neg:function(){return new s(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new s(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new s(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new s(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){return c(t,e),Math.abs(l.re-this.re)<=s.EPSILON&&Math.abs(l.im-this.im)<=s.EPSILON},clone:function(){return new s(this.re,this.im)},toString:function(){var t=this.re,e=this.im,r="";return isNaN(t)||isNaN(e)?"NaN":(0!==t&&(r+=t),0!==e&&(0!==t?r+=e<0?" - ":" + ":e<0&&(r+="-"),e=Math.abs(e),1!==e&&(r+=e),r+="i"),r?r:"0")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)}},s.ZERO=new s(0,0),s.ONE=new s(1,0),s.I=new s(0,1),s.PI=new s(Math.PI,0),s.E=new s(Math.E,0),s.EPSILON=1e-16,r(30).amd?(i=[],n=function(){return s}.apply(e,i),!(void 0!==n&&(t.exports=n))):t.exports=s}(this)}).call(e,r(29)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=o("complex",{"":function(){return t.Complex.ZERO},number:function(e){return new t.Complex(e,0)},"number, number":function(e,r){return new t.Complex(e,r)},"BigNumber, BigNumber":function(e,r){return new t.Complex(e.toNumber(),r.toNumber())},Complex:function(t){return t.clone()},string:function(e){return t.Complex(e)},Object:function(e){if("re"in e&&"im"in e)return new t.Complex(e.re,e.im);if("r"in e&&"phi"in e)return new t.Complex(e);throw new Error("Expected object with either properties re and im, or properties r and phi.")},"Array | Matrix":function(t){return n(t,s)}});return s.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+"+a.symbols.i+"\\cdot\\left(${args[1]}\\right)\\right)"},s}var n=r(19);e.name="complex",e.factory=i},function(t,e){"use strict";e.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},e.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},e.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var r={deg:"^\\circ"};e.toSymbol=function(t,i){if(i="undefined"!=typeof i&&i)return r.hasOwnProperty(t)?r[t]:"\\mathrm{"+t+"}";if(e.symbols.hasOwnProperty(t))return e.symbols[t];if(t.indexOf("_")!==-1){var n=t.indexOf("_");return e.toSymbol(t.substring(0,n))+"_{"+e.toSymbol(t.substring(n+1))+"}"}return t}},function(t,e,r){t.exports=[r(34),r(36)]},function(t,e,r){function i(t,e,r,i){return n}var n=r(35);n.prototype.type="Fraction",n.prototype.isFraction=!0,n.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},n.fromJSON=function(t){return new n(t)},e.name="Fraction",e.path="type",e.factory=i},function(t,e,r){var i,n;(function(t){!function(o){"use strict";function a(t,e){return isNaN(t=parseInt(t,10))&&s(),t*e}function s(){throw"Invalid Param"}function l(t,e){return this instanceof l?(h(t,e),t=l.REDUCE?g(c.d,c.n):1,this.s=c.s,this.n=c.n/t,void(this.d=c.d/t)):new l(t,e)}var u=2e3,c={s:1,n:0,d:1},h=function(t,e){var r,i=0,n=1,o=1,l=0,u=0,h=0,f=1,d=1,p=0,g=1,m=1,y=1,v=1e7;if(void 0===t||null===t);else if(void 0!==e)i=t,n=e,o=i*n;else switch(typeof t){case"object":"d"in t&&"n"in t?(i=t.n,n=t.d,"s"in t&&(i*=t.s)):0 in t?(i=t[0],1 in t&&(n=t[1])):s(),o=i*n;break;case"number":if(t<0&&(o=t,t=-t),t%1===0)i=t;else if(t>0){for(t>=1&&(d=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)),t/=d);g<=v&&y<=v;){if(r=(p+m)/(g+y),t===r){g+y<=v?(i=p+m,n=g+y):y>g?(i=m,n=y):(i=p,n=g);break}t>r?(p+=m,g+=y):(m+=p,y+=g),g>v?(i=m,n=y):(i=p,n=g)}i*=d}else(isNaN(t)||isNaN(e))&&(n=i=NaN);break;case"string":if(g=t.match(/\d+|./g),"-"===g[p]?(o=-1,p++):"+"===g[p]&&p++,g.length===p+1?u=a(g[p++],o):"."===g[p+1]||"."===g[p]?("."!==g[p]&&(l=a(g[p++],o)),p++,(p+1===g.length||"("===g[p+1]&&")"===g[p+3]||"'"===g[p+1]&&"'"===g[p+3])&&(u=a(g[p],o),f=Math.pow(10,g[p].length),p++),("("===g[p]&&")"===g[p+2]||"'"===g[p]&&"'"===g[p+2])&&(h=a(g[p+1],o),d=Math.pow(10,g[p+1].length)-1,p+=3)):"/"===g[p+1]||":"===g[p+1]?(u=a(g[p],o),f=a(g[p+2],1),p+=3):"/"===g[p+3]&&" "===g[p+1]&&(l=a(g[p],o),u=a(g[p+2],o),f=a(g[p+4],1),p+=5),g.length<=p){n=f*d,o=i=h+n*l+d*u;break}default:s()}if(0===n)throw"DIV/0";c.s=o<0?-1:1,c.n=Math.abs(i),c.d=Math.abs(n)},f=function(t,e,r){for(var i=1;e>0;t=t*t%r,e>>=1)1&e&&(i=i*t%r);return i},d=function(t,e){for(;e%2===0;e/=2);for(;e%5===0;e/=5);if(1===e)return 0;for(var r=10%e,i=1;1!==r;i++)if(r=10*r%e,i>u)return 0;return i},p=function(t,e,r){for(var i=1,n=f(10,r,e),o=0;o<300;o++){if(i===n)return o;i=10*i%e,n=10*n%e}return 0},g=function(t,e){if(!t)return e;if(!e)return t;for(;;){if(t%=e,!t)return e;if(e%=t,!e)return t}};l.REDUCE=1,l.prototype={s:1,n:0,d:1,abs:function(){return new l(this.n,this.d)},neg:function(){return new l(-this.s*this.n,this.d)},add:function(t,e){return h(t,e),new l(this.s*this.n*c.d+c.s*this.d*c.n,this.d*c.d)},sub:function(t,e){return h(t,e),new l(this.s*this.n*c.d-c.s*this.d*c.n,this.d*c.d)},mul:function(t,e){return h(t,e),new l(this.s*c.s*this.n*c.n,this.d*c.d)},div:function(t,e){return h(t,e),new l(this.s*c.s*this.n*c.d,this.d*c.n)},clone:function(){return new l(this)},mod:function(t,e){return isNaN(this.n)||isNaN(this.d)?new l(NaN):void 0===t?new l(this.s*this.n%this.d,1):(h(t,e),0===c.n&&0===this.d&&l(0,0),new l(this.s*c.d*this.n%(c.n*this.d),c.d*this.d))},gcd:function(t,e){return h(t,e),new l(g(c.n,this.n),c.d*this.d/g(c.d,this.d))},lcm:function(t,e){return h(t,e),0===c.n&&0===this.n?new l:new l(c.n*this.n/g(c.n,this.n),g(c.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):new l(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):new l(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):new l(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return new l(this.s*this.d,this.n)},pow:function(t){return t<0?new l(Math.pow(this.s*this.d,-t),Math.pow(this.n,-t)):new l(Math.pow(this.s*this.n,t),Math.pow(this.d,t))},equals:function(t,e){return h(t,e),this.s*this.n*c.d===c.s*c.n*this.d},compare:function(t,e){h(t,e);var r=this.s*this.n*c.d-c.s*c.n*this.d;return(0<r)-(r<0)},divisible:function(t,e){return h(t,e),!(!(c.n*this.d)||this.n*c.d%(c.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,r="",i=this.n,n=this.d;return this.s<0&&(r+="-"),1===n?r+=i:(t&&(e=Math.floor(i/n))>0&&(r+=e,r+=" ",i%=n),r+=i,r+="/",r+=n),r},toLatex:function(t){var e,r="",i=this.n,n=this.d;return this.s<0&&(r+="-"),1===n?r+=i:(t&&(e=Math.floor(i/n))>0&&(r+=e,i%=n),r+="\\frac{",r+=i,r+="}{",r+=n,r+="}"),r},toContinued:function(){var t,e=this.n,r=this.d,i=[];do i.push(Math.floor(e/r)),t=e%r,e=r,r=t;while(1!==e);return i},toString:function(){var t,e=this.n,r=this.d;if(isNaN(e)||isNaN(r))return"NaN";l.REDUCE||(t=g(e,r),e/=t,r/=t);for(var i=String(e).split(""),n=0,o=[~this.s?"":"-","",""],a="",s=d(e,r),u=p(e,r,s),c=-1,h=1,f=15+s+u+i.length,m=0;m<f;m++,n*=10){if(m<i.length?n+=Number(i[m]):(h=2,c++),s>0)if(c===u)o[h]+=a+"(",a="";else if(c===s+u){o[h]+=a+")";break}n>=r?(o[h]+=a+(n/r|0),a="",n%=r):h>1?a+="0":o[h]&&(o[h]+="0")}return o[0]+=o[1]||"0",o[2]?o[0]+"."+o[2]:o[0]}},r(30).amd?(i=[],n=function(){return l}.apply(e,i),!(void 0!==n&&(t.exports=n))):t.exports=l}(this)}).call(e,r(29)(t))},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new t.Fraction(e)},string:function(e){return new t.Fraction(e)},"number, number":function(e,r){return new t.Fraction(e,r)},BigNumber:function(e){return new t.Fraction(e.toString())},Fraction:function(t){return t},Object:function(e){return new t.Fraction(e)},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);e.name="fraction",e.factory=i},function(t,e,r){t.exports=[r(38),r(46),r(47),r(50),r(59),r(65),r(66),r(67),r(68),r(52),r(69)]},function(t,e,r){"use strict";function i(t,e,r,i){function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator")}return n.prototype.type="Matrix",n.prototype.isMatrix=!0,n.storage=function(t){if(!a(t))throw new TypeError("format must be a string value");var e=n._storage[t];if(!e)throw new SyntaxError("Unsupported matrix storage format: "+t);return e},n._storage={},n.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},n.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},n.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},n.prototype.subset=function(t,e,r){throw new Error("Cannot invoke subset on a Matrix interface")},n.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},n.prototype.set=function(t,e,r){throw new Error("Cannot invoke set on a Matrix interface")},n.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},n.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},n.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},n.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},n.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},n.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},n.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},n.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},n.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},n}var n=r(39),o=n.string,a=o.isString;e.name="Matrix",e.path="type",e.factory=i},function(t,e,r){"use strict";e.array=r(40),e.boolean=r(44),e.function=r(45),e.number=r(6),e.object=r(3),e.string=r(23),e.types=r(41),e.emitter=r(8)},function(t,e,r){"use strict";function i(t,e,r){var n,o=t.length;if(o!=e[r])throw new u(o,e[r]);if(r<e.length-1){var a=r+1;for(n=0;n<o;n++){var s=t[n];if(!Array.isArray(s))throw new u(e.length-1,e.length,"<");i(t[n],e,a)}}else for(n=0;n<o;n++)if(Array.isArray(t[n]))throw new u(e.length+1,e.length,">")}function n(t,r,i,o){var a,s,l=t.length,u=r[i],c=Math.min(l,u);if(t.length=u,i<r.length-1){var h=i+1;for(a=0;a<c;a++)s=t[a],Array.isArray(s)||(s=[s],t[a]=s),n(s,r,h,o);for(a=c;a<u;a++)s=[],t[a]=s,n(s,r,h,o)}else{for(a=0;a<c;a++)for(;Array.isArray(t[a]);)t[a]=t[a][0];if(o!==e.UNINITIALIZED)for(a=c;a<u;a++)t[a]=o}}function o(t,e,r){var i,n;if(r<e){var a=r+1;for(i=0,n=t.length;i<n;i++)t[i]=o(t[i],e,a)}else for(;Array.isArray(t);)t=t[0];return t}function a(t,e,r){var i,n;if(Array.isArray(t)){var o=r+1;for(i=0,n=t.length;i<n;i++)t[i]=a(t[i],e,o)}else for(var s=r;s<e;s++)t=[t];return t}var s=r(6),l=r(23),u=(r(3),r(41),r(42)),c=r(43);e.size=function(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e},e.validate=function(t,e){var r=0==e.length;if(r){if(Array.isArray(t))throw new u(t.length,0)}else i(t,e,0)},e.validateIndex=function(t,e){if(!s.isNumber(t)||!s.isInteger(t))throw new TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"==typeof e&&t>=e)throw new c(t,e)},e.UNINITIALIZED={},e.resize=function(t,e,r){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");e.forEach(function(t){if(!s.isNumber(t)||!s.isInteger(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+l.format(e)+")")});var i=void 0!==r?r:0;return n(t,e,0,i),t},e.squeeze=function(t,r){for(var i=r||e.size(t);Array.isArray(t)&&1===t.length;)t=t[0],i.shift();for(var n=i.length;1===i[n-1];)n--;return n<i.length&&(t=o(t,n,0),i.length=n),t},e.unsqueeze=function(t,r,i,n){var o=n||e.size(t);if(i)for(var s=0;s<i;s++)t=[t],o.unshift(1);for(t=a(t,r,0);o.length<r;)o.push(1);return t},e.flatten=function(t){if(!Array.isArray(t))return t;var e=[];return t.forEach(function t(r){Array.isArray(r)?r.forEach(t):e.push(r)}),e},e.isArray=Array.isArray;
},function(t,e){"use strict";e.type=function(t){var e=typeof t;return"object"===e?null===t?"null":t instanceof Boolean?"boolean":t instanceof Number?"number":t instanceof String?"string":Array.isArray(t)?"Array":t instanceof Date?"Date":t instanceof RegExp?"RegExp":"Object":"function"===e?"Function":e},e.isScalar=function(t){return!(t&&t.isMatrix||Array.isArray(t))}},function(t,e){"use strict";function r(t,e,i){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=i,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}r.prototype=new RangeError,r.prototype.constructor=RangeError,r.prototype.name="DimensionError",r.prototype.isDimensionError=!0,t.exports=r},function(t,e){"use strict";function r(t,e,i){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=i),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}r.prototype=new RangeError,r.prototype.constructor=RangeError,r.prototype.name="IndexError",r.prototype.isIndexError=!0,t.exports=r},function(t,e){"use strict";e.isBoolean=function(t){return"boolean"==typeof t}},function(t,e){e.memoize=function(t,e){return function r(){"object"!=typeof r.cache&&(r.cache={});for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var o=e?e(i):JSON.stringify(i);return o in r.cache?r.cache[o]:r.cache[o]=t.apply(t,i)}},e.maxArgumentCount=function(t){return Object.keys(t.signatures||{}).reduce(function(t,e){var r=(e.match(/,/g)||[]).length+1;return Math.max(t,r)},-1)}},function(t,e,r){"use strict";function i(t,e,i,u){function g(t,e){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!d(e))throw new Error("Invalid datatype: "+e);if(t&&t.isMatrix===!0)"DenseMatrix"===t.type?(this._data=l.clone(t._data),this._size=l.clone(t._size),this._datatype=e||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=e||t._datatype);else if(t&&c(t.data)&&c(t.size))this._data=t.data,this._size=t.size,this._datatype=e||t.datatype;else if(c(t))this._data=w(t),this._size=s.size(this._data),s.validate(this._data,this._size),this._datatype=e;else{if(t)throw new TypeError("Unsupported type of data ("+n.types.type(t)+")");this._data=[],this._size=[0],this._datatype=e}}function m(t,e){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var r=e.isScalar();if(r)return t.get(e.min());var i=e.size();if(i.length!=t._size.length)throw new o(i.length,t._size.length);for(var n=e.min(),a=e.max(),s=0,l=t._size.length;s<l;s++)p(n[s],t._size[s]),p(a[s],t._size[s]);return new g(y(t._data,e,i.length,0),t._datatype)}function y(t,e,r,i){var n=i==r-1,o=e.dimension(i);return n?o.map(function(e){return t[e]}).valueOf():o.map(function(n){var o=t[n];return y(o,e,r,i+1)}).valueOf()}function v(t,e,r,i){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var n,a=e.size(),u=e.isScalar();if(r&&r.isMatrix===!0?(n=r.size(),r=r.valueOf()):n=s.size(r),u){if(0!==n.length)throw new TypeError("Scalar expected");t.set(e.min(),r,i)}else{if(a.length<t._size.length)throw new o(a.length,t._size.length,"<");if(n.length<a.length){for(var c=0,h=0;1===a[c]&&1===n[c];)c++;for(;1===a[c];)h++,c++;r=s.unsqueeze(r,a.length,h,n)}if(!l.deepEqual(a,n))throw new o(a,n,">");var f=e.max().map(function(t){return t+1});E(t,f,i);var d=a.length,p=0;b(t._data,e,r,d,p)}return t}function b(t,e,r,i,n){var o=n==i-1,a=e.dimension(n);o?a.forEach(function(e,i){p(e),t[e]=r[i[0]]}):a.forEach(function(o,a){p(o),b(t[o],e,r[a[0]],i,n+1)})}function E(t,e,r){for(var i=t._size.slice(0),n=!1;i.length<e.length;)i.push(0),n=!0;for(var o=0,a=e.length;o<a;o++)e[o]>i[o]&&(i[o]=e[o],n=!0);n&&x(t,i,r)}function w(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];c(i)?t[e]=w(i):i&&i.isMatrix===!0&&(t[e]=w(i.valueOf()))}return t}var _=i(r(38));g.prototype=new _,g.prototype.type="DenseMatrix",g.prototype.isDenseMatrix=!0,g.prototype.storage=function(){return"dense"},g.prototype.datatype=function(){return this._datatype},g.prototype.create=function(t,e){return new g(t,e)},g.prototype.subset=function(t,e,r){switch(arguments.length){case 1:return m(this,t);case 2:case 3:return v(this,t,e,r);default:throw new SyntaxError("Wrong number of arguments")}},g.prototype.get=function(t){if(!c(t))throw new TypeError("Array expected");if(t.length!=this._size.length)throw new o(t.length,this._size.length);for(var e=0;e<t.length;e++)p(t[e],this._size[e]);for(var r=this._data,i=0,n=t.length;i<n;i++){var a=t[i];p(a,r.length),r=r[a]}return r},g.prototype.set=function(t,e,r){if(!c(t))throw new TypeError("Array expected");if(t.length<this._size.length)throw new o(t.length,this._size.length,"<");var i,n,a,s=t.map(function(t){return t+1});E(this,s,r);var l=this._data;for(i=0,n=t.length-1;i<n;i++)a=t[i],p(a,l.length),l=l[a];return a=t[t.length-1],p(a,l.length),l[a]=e,this},g.prototype.resize=function(t,e,r){if(!c(t))throw new TypeError("Array expected");var i=r?this.clone():this;return x(i,t,e)};var x=function(t,e,r){if(0===e.length){for(var i=t._data;c(i);)i=i[0];return i}return t._size=e.slice(0),t._data=s.resize(t._data,t._size,r),t};return g.prototype.clone=function(){var t=new g({data:l.clone(this._data),size:l.clone(this._size),datatype:this._datatype});return t},g.prototype.size=function(){return this._size.slice(0)},g.prototype.map=function(t){var e=this,r=function(i,n){return c(i)?i.map(function(t,e){return r(t,n.concat(e))}):t(i,n,e)};return new g({data:r(this._data,[]),size:l.clone(this._size),datatype:this._datatype})},g.prototype.forEach=function(t){var e=this,r=function(i,n){c(i)?i.forEach(function(t,e){r(t,n.concat(e))}):t(i,n,e)};r(this._data,[])},g.prototype.toArray=function(){return l.clone(this._data)},g.prototype.valueOf=function(){return this._data},g.prototype.format=function(t){return a.format(this._data,t)},g.prototype.toString=function(){return a.format(this._data)},g.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},g.prototype.diagonal=function(t){if(t){if(t.isBigNumber===!0&&(t=t.toNumber()),!h(t)||!f(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,r=t<0?-t:0,i=this._size[0],n=this._size[1],o=Math.min(i-r,n-e),a=[],s=0;s<o;s++)a[s]=this._data[s+r][s+e];return new g({data:a,size:[o],datatype:this._datatype})},g.diagonal=function(e,r,i,n,o){if(!c(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map(function(t){if(t&&t.isBigNumber===!0&&(t=t.toNumber()),!h(t)||!f(t)||t<1)throw new Error("Size values must be positive integers");return t}),i){if(i&&i.isBigNumber===!0&&(i=i.toNumber()),!h(i)||!f(i))throw new TypeError("The parameter k must be an integer number")}else i=0;n&&d(o)&&(n=u.convert(n,o));var a,l=i>0?i:0,p=i<0?-i:0,m=e[0],y=e[1],v=Math.min(m-p,y-l);if(c(r)){if(r.length!==v)throw new Error("Invalid value array length");a=function(t){return r[t]}}else if(r&&r.isMatrix===!0){var b=r.size();if(1!==b.length||b[0]!==v)throw new Error("Invalid matrix length");a=function(t){return r.get([t])}}else a=function(){return r};n||(n=a(0)&&a(0).isBigNumber===!0?new t.BigNumber(0):0);var E=[];if(e.length>0){E=s.resize(E,e,n);for(var w=0;w<v;w++)E[w+p][w+l]=a(w)}return new g({data:E,size:[m,y]})},g.fromJSON=function(t){return new g(t)},g.prototype.swapRows=function(t,e){if(!(h(t)&&f(t)&&h(e)&&f(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return p(t,this._size[0]),p(e,this._size[0]),g._swapRows(t,e,this._data),this},g._swapRows=function(t,e,r){var i=r[t];r[t]=r[e],r[e]=i},t.Matrix._storage.dense=g,t.Matrix._storage.default=g,g}var n=r(39),o=r(42),a=n.string,s=n.array,l=n.object,u=n.number,c=Array.isArray,h=u.isNumber,f=u.isInteger,d=a.isString,p=s.validateIndex;e.name="DenseMatrix",e.path="type",e.factory=i,e.lazy=!1},function(t,e,r){"use strict";function i(t,e,i,g){function m(t,e){if(!(this instanceof m))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!d(e))throw new Error("Invalid datatype: "+e);if(t&&t.isMatrix===!0)b(this,t,e);else if(t&&c(t.index)&&c(t.ptr)&&c(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(c(t))E(this,t,e);else{if(t)throw new TypeError("Unsupported type of data ("+n.types.type(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}var y=i(r(38)),v=i(r(48)),b=function(t,e,r){"SparseMatrix"===e.type?(t._values=e._values?s.clone(e._values):void 0,t._index=s.clone(e._index),t._ptr=s.clone(e._ptr),t._size=s.clone(e._size),t._datatype=r||e._datatype):E(t,e.valueOf(),r||e._datatype)},E=function(t,e,r){t._values=[],t._index=[],t._ptr=[],t._datatype=r;var i=e.length,n=0,o=v,a=0;if(d(r)&&(o=g.find(v,[r,r])||v,a=g.convert(0,r)),i>0){var s=0;do{t._ptr.push(t._index.length);for(var l=0;l<i;l++){var u=e[l];if(c(u)){if(0===s&&n<u.length&&(n=u.length),s<u.length){var h=u[s];o(h,a)||(t._values.push(h),t._index.push(l))}}else 0===s&&n<1&&(n=1),o(u,a)||(t._values.push(u),t._index.push(l))}s++}while(s<n)}t._ptr.push(t._index.length),t._size=[i,n]};m.prototype=new y,m.prototype.type="SparseMatrix",m.prototype.isSparseMatrix=!0,m.prototype.storage=function(){return"sparse"},m.prototype.datatype=function(){return this._datatype},m.prototype.create=function(t,e){return new m(t,e)},m.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},m.prototype.subset=function(t,e,r){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return w(this,t);case 2:case 3:return _(this,t,e,r);default:throw new SyntaxError("Wrong number of arguments")}};var w=function(t,e){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var r=e.isScalar();if(r)return t.get(e.min());var i=e.size();if(i.length!=t._size.length)throw new o(i.length,t._size.length);var n,a,s,l,u=e.min(),c=e.max();for(n=0,a=t._size.length;n<a;n++)p(u[n],t._size[n]),p(c[n],t._size[n]);var h=t._values,f=t._index,d=t._ptr,g=e.dimension(0),y=e.dimension(1),v=[],b=[];g.forEach(function(t,e){b[t]=e[0],v[t]=!0});var E=h?[]:void 0,w=[],_=[];return y.forEach(function(t){for(_.push(w.length),s=d[t],l=d[t+1];s<l;s++)n=f[s],v[n]===!0&&(w.push(b[n]),E&&E.push(h[s]))}),_.push(w.length),new m({values:E,index:w,ptr:_,size:i,datatype:t._datatype})},_=function(t,e,r,i){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var n,l=e.size(),u=e.isScalar();if(r&&r.isMatrix===!0?(n=r.size(),r=r.toArray()):n=a.size(r),u){if(0!==n.length)throw new TypeError("Scalar expected");t.set(e.min(),r,i)}else{if(1!==l.length&&2!==l.length)throw new o(l.length,t._size.length,"<");if(n.length<l.length){for(var c=0,h=0;1===l[c]&&1===n[c];)c++;for(;1===l[c];)h++,c++;r=a.unsqueeze(r,l.length,h,n)}if(!s.deepEqual(l,n))throw new o(l,n,">");for(var f=e.min()[0],d=e.min()[1],p=n[0],g=n[1],m=0;m<p;m++)for(var y=0;y<g;y++){var v=r[m][y];t.set([m+f,y+d],v,i)}}return t};m.prototype.get=function(t){if(!c(t))throw new TypeError("Array expected");if(t.length!=this._size.length)throw new o(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=t[0],r=t[1];p(e,this._size[0]),p(r,this._size[1]);var i=x(e,this._ptr[r],this._ptr[r+1],this._index);return i<this._ptr[r+1]&&this._index[i]===e?this._values[i]:0},m.prototype.set=function(t,e,r){if(!c(t))throw new TypeError("Array expected");if(t.length!=this._size.length)throw new o(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var i=t[0],n=t[1],a=this._size[0],s=this._size[1],l=v,u=0;d(this._datatype)&&(l=g.find(v,[this._datatype,this._datatype])||v,u=g.convert(0,this._datatype)),(i>a-1||n>s-1)&&(M(this,Math.max(i+1,a),Math.max(n+1,s),r),a=this._size[0],s=this._size[1]),p(i,a),p(n,s);var h=x(i,this._ptr[n],this._ptr[n+1],this._index);return h<this._ptr[n+1]&&this._index[h]===i?l(e,u)?S(h,n,this._values,this._index,this._ptr):this._values[h]=e:T(h,i,n,e,this._values,this._index,this._ptr),this};var x=function(t,e,r,i){if(r-e===0)return r;for(var n=e;n<r;n++)if(i[n]===t)return n;return e},S=function(t,e,r,i,n){r.splice(t,1),i.splice(t,1);for(var o=e+1;o<n.length;o++)n[o]--},T=function(t,e,r,i,n,o,a){n.splice(t,0,i),o.splice(t,0,e);for(var s=r+1;s<a.length;s++)a[s]++};m.prototype.resize=function(t,e,r){if(!c(t))throw new TypeError("Array expected");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");t.forEach(function(e){if(!u.isNumber(e)||!u.isInteger(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+l.format(t)+")")});var i=r?this.clone():this;return M(i,t[0],t[1],e)};var M=function(t,e,r,i){var n=i||0,o=v,a=0;d(t._datatype)&&(o=g.find(v,[t._datatype,t._datatype])||v,a=g.convert(0,t._datatype),n=g.convert(n,t._datatype));var s,l,u,c=!o(n,a),h=t._size[0],f=t._size[1];if(r>f){for(l=f;l<r;l++)if(t._ptr[l]=t._values.length,c)for(s=0;s<h;s++)t._values.push(n),t._index.push(s);t._ptr[r]=t._values.length}else r<f&&(t._ptr.splice(r+1,f-r),t._values.splice(t._ptr[r],t._values.length),t._index.splice(t._ptr[r],t._index.length));if(f=r,e>h){if(c){var p=0;for(l=0;l<f;l++){t._ptr[l]=t._ptr[l]+p,u=t._ptr[l+1]+p;var m=0;for(s=h;s<e;s++,m++)t._values.splice(u+m,0,n),t._index.splice(u+m,0,s),p++}t._ptr[f]=t._values.length}}else if(e<h){var y=0;for(l=0;l<f;l++){t._ptr[l]=t._ptr[l]-y;var b=t._ptr[l],E=t._ptr[l+1]-y;for(u=b;u<E;u++)s=t._index[u],s>e-1&&(t._values.splice(u,1),t._index.splice(u,1),y++)}t._ptr[l]=t._values.length}return t._size[0]=e,t._size[1]=r,t};m.prototype.clone=function(){var t=new m({values:this._values?s.clone(this._values):void 0,index:s.clone(this._index),ptr:s.clone(this._ptr),size:s.clone(this._size),datatype:this._datatype});return t},m.prototype.size=function(){return this._size.slice(0)},m.prototype.map=function(t,e){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var r=this,i=this._size[0],n=this._size[1],o=function(e,i,n){return t(e,[i,n],r)};return L(this,0,i-1,0,n-1,o,e)};var L=function(t,e,r,i,n,o,a){var s=[],l=[],u=[],c=v,h=0;d(t._datatype)&&(c=g.find(v,[t._datatype,t._datatype])||v,h=g.convert(0,t._datatype));for(var f=function(t,e,r){t=o(t,e,r),c(t,h)||(s.push(t),l.push(e))},p=i;p<=n;p++){u.push(s.length);for(var y=t._ptr[p],b=t._ptr[p+1],E=e,w=y;w<b;w++){var _=t._index[w];if(_>=e&&_<=r){if(!a)for(var x=E;x<_;x++)f(0,x-e,p-i);f(t._values[w],_-e,p-i)}E=_+1}if(!a)for(var S=E;S<=r;S++)f(0,S-e,p-i)}return u.push(s.length),new m({values:s,index:l,ptr:u,size:[r-e+1,n-i+1]})};m.prototype.forEach=function(t,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var r=this,i=this._size[0],n=this._size[1],o=0;o<n;o++){for(var a=this._ptr[o],s=this._ptr[o+1],l=0,u=a;u<s;u++){var c=this._index[u];if(!e)for(var h=l;h<c;h++)t(0,[h,o],r);t(this._values[u],[c,o],r),l=c+1}if(!e)for(var f=l;f<i;f++)t(0,[f,o],r)}},m.prototype.toArray=function(){return A(this._values,this._index,this._ptr,this._size,!0)},m.prototype.valueOf=function(){return A(this._values,this._index,this._ptr,this._size,!1)};var A=function(t,e,r,i,n){var o,a,l=i[0],u=i[1],c=[];for(o=0;o<l;o++)for(c[o]=[],a=0;a<u;a++)c[o][a]=0;for(a=0;a<u;a++)for(var h=r[a],f=r[a+1],d=h;d<f;d++)o=e[d],c[o][a]=t?n?s.clone(t[d]):t[d]:1;return c};return m.prototype.format=function(t){for(var e=this._size[0],r=this._size[1],i=this.density(),n="Sparse Matrix ["+l.format(e,t)+" x "+l.format(r,t)+"] density: "+l.format(i,t)+"\n",o=0;o<r;o++)for(var a=this._ptr[o],s=this._ptr[o+1],u=a;u<s;u++){var c=this._index[u];n+="\n    ("+l.format(c,t)+", "+l.format(o,t)+") ==> "+(this._values?l.format(this._values[u],t):"X")}return n},m.prototype.toString=function(){return l.format(this.toArray())},m.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},m.prototype.diagonal=function(t){if(t){if(t.isBigNumber===!0&&(t=t.toNumber()),!h(t)||!f(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,r=t<0?-t:0,i=this._size[0],n=this._size[1],o=Math.min(i-r,n-e),a=[],s=[],l=[];l[0]=0;for(var u=e;u<n&&a.length<o;u++)for(var c=this._ptr[u],d=this._ptr[u+1],p=c;p<d;p++){var g=this._index[p];if(g===u-e+r){a.push(this._values[p]),s[a.length-1]=g-r;break}}return l.push(a.length),new m({values:a,index:s,ptr:l,size:[o,1]})},m.fromJSON=function(t){return new m(t)},m.diagonal=function(t,e,r,i,n){if(!c(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map(function(t){if(t&&t.isBigNumber===!0&&(t=t.toNumber()),!h(t)||!f(t)||t<1)throw new Error("Size values must be positive integers");return t}),r){if(r.isBigNumber===!0&&(r=r.toNumber()),!h(r)||!f(r))throw new TypeError("The parameter k must be an integer number")}else r=0;var o=v,a=0;d(n)&&(o=g.find(v,[n,n])||v,a=g.convert(0,n));var s,l=r>0?r:0,u=r<0?-r:0,p=t[0],y=t[1],b=Math.min(p-u,y-l);if(c(e)){if(e.length!==b)throw new Error("Invalid value array length");s=function(t){return e[t]}}else if(e&&e.isMatrix===!0){var E=e.size();if(1!==E.length||E[0]!==b)throw new Error("Invalid matrix length");s=function(t){return e.get([t])}}else s=function(){return e};for(var w=[],_=[],x=[],S=0;S<y;S++){x.push(w.length);var T=S-l;if(T>=0&&T<b){var M=s(T);o(M,a)||(_.push(T+u),w.push(M))}}return x.push(w.length),new m({values:w,index:_,ptr:x,size:[p,y]})},m.prototype.swapRows=function(t,e){if(!(h(t)&&f(t)&&h(e)&&f(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return p(t,this._size[0]),p(e,this._size[0]),m._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},m._forEachRow=function(t,e,r,i,n){for(var o=i[t],a=i[t+1],s=o;s<a;s++)n(r[s],e[s])},m._swapRows=function(t,e,r,i,n,o){for(var a=0;a<r;a++){var s=o[a],l=o[a+1],u=x(t,s,l,n),c=x(e,s,l,n);if(u<l&&c<l&&n[u]===t&&n[c]===e){if(i){var h=i[u];i[u]=i[c],i[c]=h}}else if(u<l&&n[u]===t&&(c>=l||n[c]!==e)){var f=i?i[u]:void 0;n.splice(c,0,e),i&&i.splice(c,0,f),n.splice(c<=u?u+1:u,1),i&&i.splice(c<=u?u+1:u,1)}else if(c<l&&n[c]===e&&(u>=l||n[u]!==t)){var d=i?i[c]:void 0;n.splice(u,0,t),i&&i.splice(u,0,d),n.splice(u<=c?c+1:c,1),i&&i.splice(u<=c?c+1:c,1)}}},t.Matrix._storage.sparse=m,m}var n=r(39),o=r(42),a=n.array,s=n.object,l=n.string,u=n.number,c=Array.isArray,h=u.isNumber,f=u.isInteger,d=l.isString,p=a.validateIndex;e.name="SparseMatrix",e.path="type",e.factory=i,e.lazy=!1},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("equalScalar",{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,r){return t===r||n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.eq(r)||o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){return t.equals(e)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return a(t.value,e.value)},"string, string":function(t,e){return t===e}});return a}var n=r(6).nearlyEqual,o=r(49);e.factory=i},function(t,e){"use strict";t.exports=function(t,e,r){if(null==r)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var i=t.minus(e).abs();if(i.isZero())return!0;var n=t.constructor.max(t.abs(),e.abs());return i.lte(n.times(r))}return!1}},function(t,e,r){"use strict";function i(t,e,i){function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new t.FibonacciHeap}var o=i(r(51)),a=i(r(48));return n.prototype.type="Spa",n.prototype.isSpa=!0,n.prototype.set=function(t,e){if(this._values[t])this._values[t].value=e;else{var r=this._heap.insert(t,e);this._values[t]=r}},n.prototype.get=function(t){var e=this._values[t];return e?e.value:0},n.prototype.accumulate=function(t,e){var r=this._values[t];r?r.value=o(r.value,e):(r=this._heap.insert(t,e),this._values[t]=r)},n.prototype.forEach=function(t,e,r){var i=this._heap,n=this._values,o=[],s=i.extractMinimum();for(s&&o.push(s);s&&s.key<=e;)s.key>=t&&(a(s.value,0)||r(s.key,s.value,this)),s=i.extractMinimum(),s&&o.push(s);for(var l=0;l<o.length;l++){var u=o[l];s=i.insert(u.key,u.value),n[s.key]=s}},n.prototype.swap=function(t,e){var r=this._values[t],i=this._values[e];if(!r&&i)r=this._heap.insert(t,i.value),this._heap.remove(i),this._values[t]=r,this._values[e]=void 0;else if(r&&!i)i=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=i,this._values[t]=void 0;else if(r&&i){var n=r.value;r.value=i.value,i.value=n}},n}e.name="Spa",e.path="type",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(52)),s=i(r(53)),l=r(32),u=i(r(54)),c=i(r(55)),h=i(r(56)),f=i(r(57)),d=i(r(58)),p=o("add",n({"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,s);break;default:r=u(e,t,s,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,s,!1);break;default:r=f(t,e,s)}}return r},"Array, Array":function(t,e){return p(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return p(a(t),e)},"Matrix, Array":function(t,e){return p(t,a(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,s,!1);break;default:r=d(t,e,s,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,s,!0);break;default:r=d(e,t,s,!0)}return r},"Array, any":function(t,e){return d(a(t),e,s,!1).valueOf()},"any, Array":function(t,e){return d(a(e),t,s,!0).valueOf()}},s.signatures));return p.toTex={2:"\\left(${args[0]}"+l.operators.add+"${args[1]}\\right)"},p}var n=r(3).extend;e.name="add",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){function n(e,r,i){var n=t.Matrix.storage(r||"default");return new n(e,i)}var o=i("matrix",{"":function(){return n([])},string:function(t){return n([],t)},"string, string":function(t,e){return n([],t,e)},Array:function(t){return n(t)},Matrix:function(t){return n(t,t.storage())},"Array | Matrix, string":n,"Array | Matrix, string, string":n});return o.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},o}e.name="matrix",e.factory=r},function(t,e){"use strict";function r(t,e,r,i){var n=i("add",{"number, number":function(t,e){return t+e},"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":function(t,e){if(null==t.value)throw new Error("Parameter x contains a unit with undefined value");if(null==e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var r=t.clone();return r.value=n(r.value,e.value),r.fixPrefix=!1,r}});return n}e.factory=r},function(t,e,r){"use strict";function i(t,e,r,i){var o=t.DenseMatrix,a=function(t,e,r,a){var s=t._data,l=t._size,u=t._datatype,c=e._values,h=e._index,f=e._ptr,d=e._size,p=e._datatype;if(l.length!==d.length)throw new n(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g,m,y=l[0],v=l[1],b="string"==typeof u&&u===p?u:void 0,E=b?i.find(r,[b,b]):r,w=[];for(g=0;g<y;g++)w[g]=[];var _=[],x=[];for(m=0;m<v;m++){for(var S=m+1,T=f[m],M=f[m+1],L=T;L<M;L++)g=h[L],_[g]=a?E(c[L],s[g][m]):E(s[g][m],c[L]),x[g]=S;for(g=0;g<y;g++)x[g]===S?w[g][m]=_[g]:w[g][m]=s[g][m]}return new o({data:w,size:[y,v],datatype:b})};return a}var n=r(42);e.name="algorithm01",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r){var i=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype,f=e._values,d=e._index,p=e._ptr,g=e._size,m=e._datatype;if(c.length!==g.length)throw new n(c.length,g.length);if(c[0]!==g[0]||c[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+g+")");var y,v=c[0],b=c[1],E=a,w=0,_=r;"string"==typeof h&&h===m&&(y=h,E=o.find(a,[y,y]),w=o.convert(0,y),_=o.find(r,[y,y]));var x,S,T,M,L,A=i&&f?[]:void 0,N=[],C=[],R=new s({values:A,index:N,ptr:C,size:[v,b],datatype:y}),P=i&&f?[]:void 0,O=i&&f?[]:void 0,I=[],k=[];for(S=0;S<b;S++){C[S]=N.length;var D=S+1;for(M=u[S],L=u[S+1],T=M;T<L;T++)x=l[T],N.push(x),I[x]=D,P&&(P[x]=i[T]);for(M=p[S],L=p[S+1],T=M;T<L;T++)if(x=d[T],I[x]===D){if(P){var V=_(P[x],f[T]);E(V,w)?I[x]=null:P[x]=V}}else N.push(x),k[x]=D,O&&(O[x]=f[T]);if(P&&O)for(T=C[S];T<N.length;)x=N[T],I[x]===D?(A[T]=P[x],T++):k[x]===D?(A[T]=O[x],T++):N.splice(T,1)}return C[b]=N.length,R};return l}var n=r(42);e.name="algorithm04",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){var n=t.DenseMatrix,o=function(t,e,r,o){var a=t._values,s=t._index,l=t._ptr,u=t._size,c=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,f=u[0],d=u[1],p=r;"string"==typeof c&&(h=c,e=i.convert(e,h),p=i.find(r,[h,h]));for(var g=[],m=new n({data:g,size:[f,d],datatype:h}),y=[],v=[],b=0;b<d;b++){for(var E=b+1,w=l[b],_=l[b+1],x=w;x<_;x++){var S=s[x];y[S]=a[x],v[S]=E}for(var T=0;T<f;T++)0===b&&(g[T]=[]),v[T]===E?g[T][b]=o?p(e,y[T]):p(y[T],e):g[T][b]=e}return m};return o}e.name="algorithm10",e.factory=r},function(t,e,r){"use strict";function i(t,e,r,i){var n=t.DenseMatrix,a=function(t,e,r){var a=t._data,l=t._size,u=t._datatype,c=e._data,h=e._size,f=e._datatype,d=[];if(l.length!==h.length)throw new o(l.length,h.length);for(var p=0;p<l.length;p++){if(l[p]!==h[p])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+h+")");d[p]=l[p]}var g,m=r;"string"==typeof u&&u===f&&(g=u,e=i.convert(e,g),m=i.find(r,[g,g]));var y=d.length>0?s(m,0,d,d[0],a,c):[];return new n({data:y,size:d,datatype:g})},s=function(t,e,r,i,n,o){var a=[];if(e===r.length-1)for(var l=0;l<i;l++)a[l]=t(n[l],o[l]);else for(var u=0;u<i;u++)a[u]=s(t,e+1,r,r[e+1],n[u],o[u]);return a};return a}var n=r(39),o=r(42),a=n.string;a.isString;e.name="algorithm13",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=t.DenseMatrix,a=function(t,e,r,a){var l,u=t._data,c=t._size,h=t._datatype,f=r;"string"==typeof h&&(l=h,e=i.convert(e,l),f=i.find(r,[l,l]));var d=c.length>0?s(f,0,c,c[0],u,e,a):[];return new o({data:d,size:n(c),datatype:l})},s=function(t,e,r,i,n,o,a){var l=[];if(e===r.length-1)for(var u=0;u<i;u++)l[u]=a?t(o,n[u]):t(n[u],o);else for(var c=0;c<i;c++)l[c]=s(t,e+1,r,r[e+1],n[c],o,a);return l};return a}var n=r(3).clone;e.name="algorithm14",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}var a=i(r(60)),s=i(r(64)),l=1/Math.log((1+Math.sqrt(5))/2);o.prototype.type="FibonacciHeap",o.prototype.isFibonacciHeap=!0,o.prototype.insert=function(t,e){var r={key:t,value:e,degree:0};if(this._minimum){var i=this._minimum;r.left=i,r.right=i.right,i.right=r,r.right.left=r,a(t,i.key)&&(this._minimum=r)}else r.left=r,r.right=r,this._minimum=r;return this._size++,r},o.prototype.size=function(){return this._size},o.prototype.clear=function(){this._minimum=null,this._size=0},o.prototype.isEmpty=function(){return!!this._minimum},o.prototype.extractMinimum=function(){var t=this._minimum;if(null===t)return t;for(var e=this._minimum,r=t.degree,i=t.child;r>0;){var n=i.right;i.left.right=i.right,i.right.left=i.left,i.left=e,i.right=e.right,e.right=i,i.right.left=i,i.parent=null,i=n,r--}return t.left.right=t.right,t.right.left=t.left,t==t.right?e=null:(e=t.right,e=d(e,this._size)),this._size--,this._minimum=e,t},o.prototype.remove=function(t){this._minimum=u(this._minimum,t,-1),this.extractMinimum()};var u=function(t,e,r){e.key=r;var i=e.parent;return i&&a(e.key,i.key)&&(c(t,e,i),h(t,i)),a(e.key,t.key)&&(t=e),t},c=function(t,e,r){e.left.right=e.right,e.right.left=e.left,r.degree--,r.child==e&&(r.child=e.right),0===r.degree&&(r.child=null),e.left=t,e.right=t.right,t.right=e,e.right.left=e,e.parent=null,e.mark=!1},h=function(t,e){var r=e.parent;r&&(e.mark?(c(t,e,r),h(r)):e.mark=!0)},f=function(t,e){t.left.right=t.right,t.right.left=t.left,t.parent=e,e.child?(t.left=e.child,t.right=e.child.right,e.child.right=t,t.right.left=t):(e.child=t,t.right=t,t.left=t),e.degree++,t.mark=!1},d=function(t,e){var r=Math.floor(Math.log(e)*l)+1,i=new Array(r),n=0,o=t;if(o)for(n++,o=o.right;o!==t;)n++,o=o.right;for(var u;n>0;){for(var c=o.degree,h=o.right;;){if(u=i[c],!u)break;if(s(o.key,u.key)){var d=u;u=o,o=d}f(u,o),i[c]=null,c++}i[c]=o,o=h,n--}t=null;for(var p=0;p<r;p++)u=i[p],u&&(t?(u.left.right=u.right,u.right.left=u.left,u.left=t,u.right=t.right,t.right=u,u.right.left=u,a(u.key,t.key)&&(t=u)):t=u);return t};return o}e.name="FibonacciHeap",e.path="type",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("smaller",{"boolean, boolean":function(t,e){return t<e},"number, number":function(t,r){return t<r&&!n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.lt(r)&&!o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return t.compare(e)===-1},"Complex, Complex":function(t,e){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return t<e},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,p);break;default:r=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,p,!1);break;default:r=h(t,e,p)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=f(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,p,!0);break;default:r=f(e,t,p,!0)}return r},"Array, any":function(t,e){return f(s(t),e,p,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+d.operators.smaller+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="smaller",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=t.DenseMatrix,a=function(t,e,r,a){var s=t._data,l=t._size,u=t._datatype,c=e._values,h=e._index,f=e._ptr,d=e._size,p=e._datatype;if(l.length!==d.length)throw new n(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g,m=l[0],y=l[1],v=0,b=r;"string"==typeof u&&u===p&&(g=u,v=i.convert(0,g),b=i.find(r,[g,g]));for(var E=[],w=0;w<m;w++)E[w]=[];for(var _=[],x=[],S=0;S<y;S++){for(var T=S+1,M=f[S],L=f[S+1],A=M;A<L;A++){var N=h[A];_[N]=a?b(c[A],s[N][S]):b(s[N][S],c[A]),x[N]=T}for(var C=0;C<m;C++)x[C]===T?E[C][S]=_[C]:E[C][S]=a?b(v,s[C][S]):b(s[C][S],v)}return new o({
data:E,size:[m,y],datatype:g})};return a}var n=r(42);e.name="algorithm03",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=t.DenseMatrix,a=function(t,e,r){var a=t._size,l=t._datatype,u=e._size,c=e._datatype;if(a.length!==u.length)throw new n(a.length,u.length);if(a[0]!==u[0]||a[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+u+")");var h,f=a[0],d=a[1],p=0,g=r;"string"==typeof l&&l===c&&(h=l,p=i.convert(0,h),g=i.find(r,[h,h]));var m,y,v=[];for(m=0;m<f;m++)v[m]=[];var b=new o({data:v,size:[f,d],datatype:h}),E=[],w=[],_=[],x=[];for(y=0;y<d;y++){var S=y+1;for(s(t,y,_,E,S),s(e,y,x,w,S),m=0;m<f;m++){var T=_[m]===S?E[m]:p,M=x[m]===S?w[m]:p;v[m][y]=g(T,M)}}return b},s=function(t,e,r,i,n){for(var o=t._values,a=t._index,s=t._ptr,l=s[e],u=s[e+1];l<u;l++){var c=a[l];r[c]=n,i[c]=o[l]}};return a}var n=r(42);e.name="algorithm07",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){var n=t.DenseMatrix,o=function(t,e,r,o){var a=t._values,s=t._index,l=t._ptr,u=t._size,c=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,f=u[0],d=u[1],p=r;"string"==typeof c&&(h=c,e=i.convert(e,h),p=i.find(r,[h,h]));for(var g=[],m=new n({data:g,size:[f,d],datatype:h}),y=[],v=[],b=0;b<d;b++){for(var E=b+1,w=l[b],_=l[b+1],x=w;x<_;x++){var S=s[x];y[S]=a[x],v[S]=E}for(var T=0;T<f;T++)0===b&&(g[T]=[]),v[T]===E?g[T][b]=o?p(e,y[T]):p(y[T],e):g[T][b]=o?p(e,0):p(0,e)}return m};return o}e.name="algorithm12",e.factory=r},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("larger",{"boolean, boolean":function(t,e){return t>e},"number, number":function(t,r){return t>r&&!n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.gt(r)&&!o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return 1===t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return t>e},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,p);break;default:r=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,p,!1);break;default:r=h(t,e,p)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=f(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,p,!0);break;default:r=f(e,t,p,!0)}return r},"Array, any":function(t,e){return f(s(t),e,p,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+d.operators.larger+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="larger",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!l(e))throw new Error("Invalid datatype: "+e);if(t&&t.isMatrix===!0||s(t)){var r=new u(t,e);this._data=r._data,this._size=r._size,this._datatype=r._datatype,this._min=null,this._max=null}else if(t&&s(t.data)&&s(t.size))this._data=t.data,this._size=t.size,this._datatype=t.datatype,this._min="undefined"!=typeof t.min?t.min:null,this._max="undefined"!=typeof t.max?t.max:null;else{if(t)throw new TypeError("Unsupported type of data ("+n.types.type(t)+")");this._data=[],this._size=[0],this._datatype=e,this._min=null,this._max=null}}var u=i(r(46)),c=i(r(60));return o.prototype=new u,o.prototype.type="ImmutableDenseMatrix",o.prototype.isImmutableDenseMatrix=!0,o.prototype.subset=function(t){switch(arguments.length){case 1:var e=u.prototype.subset.call(this,t);return e.isMatrix?new o({data:e._data,size:e._size,datatype:e._datatype}):e;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},o.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},o.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},o.prototype.clone=function(){var t=new o({data:a.clone(this._data),size:a.clone(this._size),datatype:this._datatype});return t},o.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},o.fromJSON=function(t){return new o(t)},o.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},o.prototype.min=function(){if(null===this._min){var t=null;this.forEach(function(e){(null===t||c(e,t))&&(t=e)}),this._min=null!==t?t:void 0}return this._min},o.prototype.max=function(){if(null===this._max){var t=null;this.forEach(function(e){(null===t||c(t,e))&&(t=e)}),this._max=null!==t?t:void 0}return this._max},o}var n=r(39),o=n.string,a=n.object,s=Array.isArray,l=o.isString;e.name="ImmutableDenseMatrix",e.path="type",e.factory=i},function(t,e,r){"use strict";function i(t){function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var i=0,n=arguments.length;i<n;i++){var o=arguments[i];if(o&&o.isRange===!0)this._dimensions.push(o),this._isScalar=!1;else if(o&&(Array.isArray(o)||o.isMatrix===!0)){var a=r(o.valueOf());this._dimensions.push(a);var s=a.size();1===s.length&&1===s[0]||(this._isScalar=!1)}else if("number"==typeof o)this._dimensions.push(r([o]));else{if("string"!=typeof o)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(o)}}}function r(e){for(var r=0,i=e.length;r<i;r++)if("number"!=typeof e[r]||!o(e[r]))throw new TypeError("Index parameters must be positive integer numbers");return new t.ImmutableDenseMatrix(e)}return e.prototype.type="Index",e.prototype.isIndex=!0,e.prototype.clone=function(){var t=new e;return t._dimensions=n(this._dimensions),t._isScalar=this._isScalar,t},e.create=function(t){var r=new e;return e.apply(r,t),r},e.prototype.size=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];t[e]="string"==typeof i?1:i.size()[0]}return t},e.prototype.max=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];t[e]="string"==typeof i?i:i.max()}return t},e.prototype.min=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];t[e]="string"==typeof i?i:i.min()}return t},e.prototype.forEach=function(t){for(var e=0,r=this._dimensions.length;e<r;e++)t(this._dimensions[e],e,this)},e.prototype.dimension=function(t){return this._dimensions[t]||null},e.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},e.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},e.prototype.isScalar=function(){return this._isScalar},e.prototype.toArray=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];t.push("string"==typeof i?i:i.toArray())}return t},e.prototype.valueOf=e.prototype.toArray,e.prototype.toString=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];"string"==typeof i?t.push(JSON.stringify(i)):t.push(i.toString())}return"["+t.join(", ")+"]"},e.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},e.fromJSON=function(t){return e.create(t.dimensions)},e}var n=r(3).clone,o=r(6).isInteger;e.name="Index",e.path="type",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){function o(t,e,r){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(null!=t)if(t.isBigNumber===!0)t=t.toNumber();else if("number"!=typeof t)throw new TypeError("Parameter start must be a number");if(null!=e)if(e.isBigNumber===!0)e=e.toNumber();else if("number"!=typeof e)throw new TypeError("Parameter end must be a number");if(null!=r)if(r.isBigNumber===!0)r=r.toNumber();else if("number"!=typeof r)throw new TypeError("Parameter step must be a number");this.start=null!=t?parseFloat(t):0,this.end=null!=e?parseFloat(e):0,this.step=null!=r?parseFloat(r):1}return o.prototype.type="Range",o.prototype.isRange=!0,o.parse=function(t){if("string"!=typeof t)return null;var e=t.split(":"),r=e.map(function(t){return parseFloat(t)}),i=r.some(function(t){return isNaN(t)});if(i)return null;switch(r.length){case 2:return new o(r[0],r[1]);case 3:return new o(r[0],r[2],r[1]);default:return null}},o.prototype.clone=function(){return new o(this.start,this.end,this.step)},o.prototype.size=function(){var t=0,e=this.start,r=this.step,i=this.end,o=i-e;return n.sign(r)==n.sign(o)?t=Math.ceil(o/r):0==o&&(t=0),isNaN(t)&&(t=0),[t]},o.prototype.min=function(){var t=this.size()[0];return t>0?this.step>0?this.start:this.start+(t-1)*this.step:void 0},o.prototype.max=function(){var t=this.size()[0];return t>0?this.step>0?this.start+(t-1)*this.step:this.start:void 0},o.prototype.forEach=function(t){var e=this.start,r=this.step,i=this.end,n=0;if(r>0)for(;e<i;)t(e,[n],this),e+=r,n++;else if(r<0)for(;e>i;)t(e,[n],this),e+=r,n++},o.prototype.map=function(t){var e=[];return this.forEach(function(r,i,n){e[i[0]]=t(r,i,n)}),e},o.prototype.toArray=function(){var t=[];return this.forEach(function(e,r){t[r[0]]=e}),t},o.prototype.valueOf=function(){return this.toArray()},o.prototype.format=function(t){var e=n.format(this.start,t);return 1!=this.step&&(e+=":"+n.format(this.step,t)),e+=":"+n.format(this.end,t)},o.prototype.toString=function(){return this.format()},o.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},o.fromJSON=function(t){return new o(t.start,t.end,t.step)},o}var n=r(6);e.name="Range",e.path="type",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){return i("index",{"...number | string | BigNumber | Range | Array | Matrix":function(e){var r=e.map(function(t){return t&&t.isBigNumber===!0?t.toNumber():t&&(Array.isArray(t)||t.isMatrix===!0)?t.map(function(t){return t&&t.isBigNumber===!0?t.toNumber():t}):t}),i=new t.Index;return t.Index.apply(i,r),i}})}e.name="index",e.factory=r},function(t,e){"use strict";function r(t,e,r,i){var n=t.SparseMatrix,o=i("sparse",{"":function(){return new n([])},string:function(t){return new n([],t)},"Array | Matrix":function(t){return new n(t)},"Array | Matrix, string":function(t,e){return new n(t,e)}});return o.toTex={0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},o}e.name="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("number",{"":function(){return 0},number:function(t){return t},string:function(t){var e=Number(t);if(isNaN(e))throw new SyntaxError('String "'+t+'" is no valid number');return e},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:function(t){throw new Error("Second argument with valueless unit expected")},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},o}var n=r(19);e.name="number",e.factory=i},function(t,e,r){t.exports=[r(72)]},function(t,e){"use strict";function r(t,e,r,i){function n(t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.entries=t||[]}return n.prototype.type="ResultSet",n.prototype.isResultSet=!0,n.prototype.valueOf=function(){return this.entries},n.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},n.fromJSON=function(t){return new n(t.entries)},n}e.name="ResultSet",e.path="type",e.factory=r},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("string",{"":function(){return""},number:o.format,null:function(t){return"null"},boolean:function(t){return t+""},string:function(t){return t},"Array | Matrix":function(t){return n(t,a)},any:function(t){return String(t)}});return a.toTex={0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},a}var n=r(19),o=r(6);e.name="string",e.factory=i},function(t,e,r){t.exports=[r(75),r(96),r(97),r(98),r(99)]},function(t,e,r){"use strict";function i(t,e,i,s,l){function u(t,e){if(!(this instanceof u))throw new Error("Constructor must be called with the new operator");if(void 0!==t&&!N(t)&&!t.isComplex)throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(void 0!=e&&("string"!=typeof e||""==e))throw new TypeError("Second parameter in Unit constructor must be a string");if(void 0!=e){var r=u.parse(e);this.units=r.units,this.dimensions=r.dimensions}else{this.units=[{unit:z,prefix:F.NONE,power:0}],this.dimensions=[];for(var i=0;i<B.length;i++)this.dimensions[i]=0}this.value=void 0!=t?this._normalize(t):null,this.fixPrefix=!1,this.isUnitListSimplified=!0}function c(){for(;" "==D||"\t"==D;)d()}function h(t){return t>="0"&&t<="9"||"."==t}function f(t){return t>="0"&&t<="9"}function d(){k++,D=I.charAt(k)}function p(t){k=t,D=I.charAt(k)}function g(){var t,e="";if(t=k,"+"==D?d():"-"==D&&(e+=D,d()),!h(D))return p(t),null;if("."==D){if(e+=D,d(),!f(D))return p(t),null}else{for(;f(D);)e+=D,d();"."==D&&(e+=D,d())}for(;f(D);)e+=D,d();if("E"==D||"e"==D){var r="",i=k;if(r+=D,d(),"+"!=D&&"-"!=D||(r+=D,d()),!f(D))return p(i),e;for(e+=r;f(D);)e+=D,d()}return e}function m(){for(var t="",e=I.charCodeAt(k);e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122;)t+=D,d(),e=I.charCodeAt(k);return e=t.charCodeAt(0),e>=65&&e<=90||e>=97&&e<=122?t||null:null}function y(t){return D===t?(d(),t):null}function v(t){if(j.hasOwnProperty(t)){var e=j[t],r=e.prefixes[""];return{unit:e,prefix:r}}for(var i in j)if(j.hasOwnProperty(i)&&n(t,i)){var e=j[i],o=t.length-i.length,a=t.substring(0,o),r=e.prefixes[a];if(void 0!==r)return{unit:e,prefix:r}}return null}function b(e){if("BigNumber"===e.number){var r=a.pi(t.BigNumber);j.rad.value=new t.BigNumber(1),j.deg.value=r.div(180),j.grad.value=r.div(200),j.cycle.value=r.times(2),j.arcsec.value=r.div(648e3),j.arcmin.value=r.div(10800)}else j.rad.value=1,j.deg.value=Math.PI/180,j.grad.value=Math.PI/200,j.cycle.value=2*Math.PI,j.arcsec.value=Math.PI/648e3,j.arcmin.value=Math.PI/10800}function E(t){for(var e=0;e<t.length;e++){var r=t.charAt(e),i=function(t){return/^[a-zA-Z]$/.test(t)},n=function(t){return t>="0"&&t<="9"};if(0===e&&!i(r))throw new Error('Invalid unit name (must begin with alpha character): "'+t+'"');if(e>0&&!i(r)&&!n(r))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+t+'"')}}var w=i(r(53)),_=i(r(77)),x=i(r(80)),S=i(r(81)),T=i(r(82)),M=i(r(86)),L=i(r(87)),A=i(r(88)),N=i(r(89)),C=i(r(90)),R=i(r(91)),P=i(r(70)),O=i(r(27));u.prototype.type="Unit",u.prototype.isUnit=!0;var I,k,D;u.parse=function(r,i){if(i=i||{},I=r,k=-1,D="","string"!=typeof I)throw new TypeError("Invalid argument in Unit.parse, string expected");var n=new u;n.units=[],d(),c();var o=g(),a=null;o&&(a="BigNumber"===e.number?new t.BigNumber(o):"Fraction"===e.number?new t.Fraction(o):parseFloat(o)),c();for(var s=1,l=!1,h=[],f=1;;){for(c();"("===D;)h.push(s),f*=s,s=1,d(),c();if(!D)break;var p=D,b=m();if(null==b)throw new SyntaxError('Unexpected "'+p+'" in "'+I+'" at index '+k.toString());var E=v(b);if(null==E)throw new SyntaxError('Unit "'+b+'" not found.');var w=s*f;if(c(),y("^")){c();var _=g();if(null==_)throw new SyntaxError('In "'+r+'", "^" must be followed by a floating-point number');w*=_}n.units.push({unit:E.unit,prefix:E.prefix,power:w});for(var x=0;x<B.length;x++)n.dimensions[x]+=(E.unit.dimensions[x]||0)*w;for(c();")"===D;){if(0===h.length)throw new SyntaxError('Unmatched ")" in "'+I+'" at index '+k.toString());f/=h.pop(),d(),c()}if(l=!1,y("*")?(s=1,l=!0):y("/")?(s=-1,l=!0):s=1,E.unit.base){var S=E.unit.base.key;q.auto[S]={unit:E.unit,prefix:E.prefix}}}if(c(),D)throw new SyntaxError('Could not parse: "'+r+'"');if(l)throw new SyntaxError('Trailing characters: "'+r+'"');if(0!==h.length)throw new SyntaxError('Unmatched "(" in "'+I+'"');if(0==n.units.length&&!i.allowNoUnits)throw new SyntaxError('"'+r+'" contains no units');return n.value=void 0!=a?n._normalize(a):null,n},u.prototype.clone=function(){var t=new u;t.fixPrefix=this.fixPrefix,t.isUnitListSimplified=this.isUnitListSimplified,t.value=o(this.value),t.dimensions=this.dimensions.slice(0),t.units=[];for(var e=0;e<this.units.length;e++){t.units[e]={};for(var r in this.units[e])this.units[e].hasOwnProperty(r)&&(t.units[e][r]=this.units[e][r])}return t},u.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},u.prototype._normalize=function(t){var e,r,i,n,o;if(null==t||0===this.units.length)return t;if(this._isDerived()){var a=t;o=u._getNumberConverter(R(t));for(var s=0;s<this.units.length;s++)e=o(this.units[s].unit.value),n=o(this.units[s].prefix.value),i=o(this.units[s].power),a=x(a,T(x(e,n),i));return a}return o=u._getNumberConverter(R(t)),e=o(this.units[0].unit.value),r=o(this.units[0].unit.offset),n=o(this.units[0].prefix.value),x(w(t,r),x(e,n))},u.prototype._denormalize=function(t,e){var r,i,n,o,a;if(null==t||0===this.units.length)return t;if(this._isDerived()){var s=t;a=u._getNumberConverter(R(t));for(var l=0;l<this.units.length;l++)r=a(this.units[l].unit.value),o=a(this.units[l].prefix.value),n=a(this.units[l].power),s=S(s,T(x(r,o),n));return s}return a=u._getNumberConverter(R(t)),r=a(this.units[0].unit.value),o=a(this.units[0].prefix.value),i=a(this.units[0].unit.offset),void 0==e?_(S(S(t,r),o),i):_(S(S(t,r),e),i)},u.isValuelessUnit=function(t){return null!=v(t)},u.prototype.hasBase=function(t){if("string"==typeof t&&(t=W[t]),!t)return!1;for(var e=0;e<B.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},u.prototype.equalBase=function(t){for(var e=0;e<B.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},u.prototype.equals=function(t){return this.equalBase(t)&&A(this.value,t.value)},u.prototype.multiply=function(t){for(var e=this.clone(),r=0;r<B.length;r++)e.dimensions[r]=(this.dimensions[r]||0)+(t.dimensions[r]||0);for(var r=0;r<t.units.length;r++){var i={};for(var n in t.units[r])i[n]=t.units[r][n];e.units.push(i)}if(null!=this.value||null!=t.value){var o=null==this.value?this._normalize(1):this.value,a=null==t.value?t._normalize(1):t.value;e.value=x(o,a)}else e.value=null;return e.isUnitListSimplified=!1,V(e)},u.prototype.divide=function(t){for(var e=this.clone(),r=0;r<B.length;r++)e.dimensions[r]=(this.dimensions[r]||0)-(t.dimensions[r]||0);for(var r=0;r<t.units.length;r++){var i={};for(var n in t.units[r])i[n]=t.units[r][n];i.power=-i.power,e.units.push(i)}if(null!=this.value||null!=t.value){var o=null==this.value?this._normalize(1):this.value,a=null==t.value?t._normalize(1):t.value;e.value=S(o,a)}else e.value=null;return e.isUnitListSimplified=!1,V(e)},u.prototype.pow=function(t){for(var e=this.clone(),r=0;r<B.length;r++)e.dimensions[r]=(this.dimensions[r]||0)*t;for(var r=0;r<e.units.length;r++)e.units[r].power*=t;return null!=e.value?e.value=T(e.value,t):e.value=null,e.isUnitListSimplified=!1,V(e)};var V=function(t){return t.equalBase(W.NONE)&&null!==t.value&&!e.predictable?t.value:t};u.prototype.abs=function(){var t=this.clone();t.value=M(t.value);for(var e in t.units)"VA"!==t.units[e].unit.name&&"VAR"!==t.units[e].unit.name||(t.units[e].unit=j.W);return t},u.prototype.to=function(t){var e,r=null==this.value?this._normalize(1):this.value;if("string"==typeof t){if(e=u.parse(t),!this.equalBase(e))throw new Error("Units do not match");if(null!==e.value)throw new Error("Cannot convert to a unit with a value");return e.value=o(r),e.fixPrefix=!0,e.isUnitListSimplified=!0,e}if(t&&t.isUnit){if(!this.equalBase(t))throw new Error("Units do not match");if(null!==t.value)throw new Error("Cannot convert to a unit with a value");return e=t.clone(),e.value=o(r),e.fixPrefix=!0,e.isUnitListSimplified=!0,e}throw new Error("String or Unit expected as parameter")},u.prototype.toNumber=function(t){return P(this.toNumeric(t))},u.prototype.toNumeric=function(t){var e=this;return t&&(e=this.to(t)),e._isDerived()?e._denormalize(e.value):e._denormalize(e.value,e.units[0].prefix.value)},u.prototype.toString=function(){return this.format()},u.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},u.fromJSON=function(t){var e=new u(t.value,t.unit);return e.fixPrefix=t.fixPrefix||!1,e},u.prototype.valueOf=u.prototype.toString,u.prototype.simplifyUnitListLazy=function(){if(!this.isUnitListSimplified&&null!=this.value){var t,e=[];for(var i in Z)if(this.hasBase(W[i])){t=i;break}if("NONE"===t)this.units=[];else{var n;t&&Z.hasOwnProperty(t)&&(n=Z[t]);if(n)this.units=[{unit:n.unit,prefix:n.prefix,power:1}];else{for(var o=!1,a=0;a<B.length;a++){var s=B[a];Math.abs(this.dimensions[a]||0)>1e-12&&(Z.hasOwnProperty(s)?e.push({unit:Z[s].unit,prefix:Z[s].prefix,power:this.dimensions[a]||0}):o=!0)}r(92);e.length<this.units.length&&!o&&(this.units=e)}}this.isUnitListSimplified=!0}},u.prototype.formatUnits=function(){this.simplifyUnitListLazy();for(var t="",e="",r=0,i=0,n=0;n<this.units.length;n++)this.units[n].power>0?(r++,t+=" "+this.units[n].prefix.name+this.units[n].unit.name,Math.abs(this.units[n].power-1)>1e-15&&(t+="^"+this.units[n].power)):this.units[n].power<0&&i++;if(i>0)for(var n=0;n<this.units.length;n++)this.units[n].power<0&&(r>0?(e+=" "+this.units[n].prefix.name+this.units[n].unit.name,Math.abs(this.units[n].power+1)>1e-15&&(e+="^"+-this.units[n].power)):(e+=" "+this.units[n].prefix.name+this.units[n].unit.name,e+="^"+this.units[n].power));t=t.substr(1),e=e.substr(1),r>1&&i>0&&(t="("+t+")"),i>1&&r>0&&(e="("+e+")");var o=t;return r>0&&i>0&&(o+=" / "),o+=e},u.prototype.format=function(t){this.simplifyUnitListLazy();var e=!1,r=!0;"undefined"!=typeof this.value&&null!==this.value&&this.value.isComplex&&(e=Math.abs(this.value.re)<1e-14,r=Math.abs(this.value.im)<1e-14);for(var i in this.units)this.units[i].unit&&("VA"===this.units[i].unit.name&&e?this.units[i].unit=j.VAR:"VAR"!==this.units[i].unit.name||e||(this.units[i].unit=j.VA));1!==this.units.length||this.fixPrefix||Math.abs(this.units[0].power-Math.round(this.units[0].power))<1e-14&&(this.units[0].prefix=this._bestPrefix());var n=this._denormalize(this.value),o=null!==this.value?C(n,t||{}):"",a=this.formatUnits();return this.value&&this.value.isComplex&&(o="("+o+")"),a.length>0&&o.length>0&&(o+=" "),o+=a},u.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var t=M(this.value),e=M(this.units[0].unit.value),r=this.units[0].prefix;if(0===t)return r;var i=this.units[0].power,n=Math.abs(Math.log(t/Math.pow(r.value*e,i))/Math.LN10-1.2),o=this.units[0].unit.prefixes;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];if(s.scientific){var l=Math.abs(Math.log(t/Math.pow(s.value*e,i))/Math.LN10-1.2);(l<n||l===n&&s.name.length<r.name.length)&&(r=s,n=l)}}return r},u.prototype.splitUnit=function(t){for(var e=this.clone(),r=[],i=0;i<t.length&&(e=e.to(t[i]),i!=t.length-1);i++){var n=L(e.toNumeric()),o=new u(n,t[i].toString());r.push(o),e=_(e,o)}return r.push(e),r};var F={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};F.SHORTLONG={};for(var G in F.SHORT)F.SHORT.hasOwnProperty(G)&&(F.SHORTLONG[G]=F.SHORT[G]);for(var G in F.LONG)F.LONG.hasOwnProperty(G)&&(F.SHORTLONG[G]=F.LONG[G]);var B=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],W={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var G in W)W[G].key=G;var U={},z={name:"",base:U,value:1,offset:0,dimensions:[0,0,0,0,0,0,0,0,0]},j={meter:{name:"meter",base:W.LENGTH,prefixes:F.LONG,value:1,offset:0},inch:{name:"inch",base:W.LENGTH,prefixes:F.NONE,value:.0254,offset:0},foot:{name:"foot",base:W.LENGTH,prefixes:F.NONE,value:.3048,offset:0},yard:{name:"yard",base:W.LENGTH,prefixes:F.NONE,value:.9144,offset:0},mile:{name:"mile",base:W.LENGTH,prefixes:F.NONE,value:1609.344,offset:0},link:{name:"link",base:W.LENGTH,prefixes:F.NONE,value:.201168,offset:0},rod:{name:"rod",base:W.LENGTH,prefixes:F.NONE,value:5.02921,offset:0},chain:{name:"chain",base:W.LENGTH,prefixes:F.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:W.LENGTH,prefixes:F.NONE,value:1e-10,offset:0},m:{name:"m",base:W.LENGTH,prefixes:F.SHORT,value:1,offset:0},in:{name:"in",base:W.LENGTH,prefixes:F.NONE,value:.0254,offset:0},ft:{name:"ft",base:W.LENGTH,prefixes:F.NONE,value:.3048,offset:0},yd:{name:"yd",base:W.LENGTH,prefixes:F.NONE,value:.9144,offset:0},mi:{name:"mi",base:W.LENGTH,prefixes:F.NONE,value:1609.344,offset:0},li:{name:"li",base:W.LENGTH,prefixes:F.NONE,value:.201168,offset:0},rd:{name:"rd",base:W.LENGTH,prefixes:F.NONE,value:5.02921,offset:0},ch:{name:"ch",base:W.LENGTH,prefixes:F.NONE,value:20.1168,offset:0},mil:{name:"mil",base:W.LENGTH,prefixes:F.NONE,value:254e-7,offset:0},m2:{name:"m2",base:W.SURFACE,prefixes:F.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:W.SURFACE,prefixes:F.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:W.SURFACE,prefixes:F.NONE,value:.09290304,offset:0
},sqyd:{name:"sqyd",base:W.SURFACE,prefixes:F.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:W.SURFACE,prefixes:F.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:W.SURFACE,prefixes:F.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:W.SURFACE,prefixes:F.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:W.SURFACE,prefixes:F.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:W.SURFACE,prefixes:F.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:W.SURFACE,prefixes:F.NONE,value:1e4,offset:0},m3:{name:"m3",base:W.VOLUME,prefixes:F.CUBIC,value:1,offset:0},L:{name:"L",base:W.VOLUME,prefixes:F.SHORT,value:.001,offset:0},l:{name:"l",base:W.VOLUME,prefixes:F.SHORT,value:.001,offset:0},litre:{name:"litre",base:W.VOLUME,prefixes:F.LONG,value:.001,offset:0},cuin:{name:"cuin",base:W.VOLUME,prefixes:F.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:W.VOLUME,prefixes:F.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:W.VOLUME,prefixes:F.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:W.VOLUME,prefixes:F.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:W.VOLUME,prefixes:F.NONE,value:15e-6,offset:0},drop:{name:"drop",base:W.VOLUME,prefixes:F.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:W.VOLUME,prefixes:F.NONE,value:5e-8,offset:0},minim:{name:"minim",base:W.VOLUME,prefixes:F.NONE,value:6.161152e-8,offset:0},fluiddram:{name:"fluiddram",base:W.VOLUME,prefixes:F.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:W.VOLUME,prefixes:F.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:W.VOLUME,prefixes:F.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:W.VOLUME,prefixes:F.NONE,value:1e-6,offset:0},cup:{name:"cup",base:W.VOLUME,prefixes:F.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:W.VOLUME,prefixes:F.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:W.VOLUME,prefixes:F.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:W.VOLUME,prefixes:F.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:W.VOLUME,prefixes:F.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:W.VOLUME,prefixes:F.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:W.VOLUME,prefixes:F.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:W.VOLUME,prefixes:F.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:W.VOLUME,prefixes:F.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:W.VOLUME,prefixes:F.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:W.VOLUME,prefixes:F.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:W.VOLUME,prefixes:F.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:W.VOLUME,prefixes:F.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:W.VOLUME,prefixes:F.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:W.VOLUME,prefixes:F.NONE,value:.1173478,offset:0},obl:{name:"obl",base:W.VOLUME,prefixes:F.NONE,value:.1589873,offset:0},g:{name:"g",base:W.MASS,prefixes:F.SHORT,value:.001,offset:0},gram:{name:"gram",base:W.MASS,prefixes:F.LONG,value:.001,offset:0},ton:{name:"ton",base:W.MASS,prefixes:F.SHORT,value:907.18474,offset:0},tonne:{name:"tonne",base:W.MASS,prefixes:F.SHORT,value:1e3,offset:0},grain:{name:"grain",base:W.MASS,prefixes:F.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:W.MASS,prefixes:F.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:W.MASS,prefixes:F.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:W.MASS,prefixes:F.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:W.MASS,prefixes:F.NONE,value:45.359237,offset:0},stick:{name:"stick",base:W.MASS,prefixes:F.NONE,value:.115,offset:0},stone:{name:"stone",base:W.MASS,prefixes:F.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:W.MASS,prefixes:F.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:W.MASS,prefixes:F.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:W.MASS,prefixes:F.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:W.MASS,prefixes:F.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:W.MASS,prefixes:F.NONE,value:45.359237,offset:0},s:{name:"s",base:W.TIME,prefixes:F.SHORT,value:1,offset:0},min:{name:"min",base:W.TIME,prefixes:F.NONE,value:60,offset:0},h:{name:"h",base:W.TIME,prefixes:F.NONE,value:3600,offset:0},second:{name:"second",base:W.TIME,prefixes:F.LONG,value:1,offset:0},sec:{name:"sec",base:W.TIME,prefixes:F.LONG,value:1,offset:0},minute:{name:"minute",base:W.TIME,prefixes:F.NONE,value:60,offset:0},hour:{name:"hour",base:W.TIME,prefixes:F.NONE,value:3600,offset:0},day:{name:"day",base:W.TIME,prefixes:F.NONE,value:86400,offset:0},week:{name:"week",base:W.TIME,prefixes:F.NONE,value:604800,offset:0},month:{name:"month",base:W.TIME,prefixes:F.NONE,value:2629800,offset:0},year:{name:"year",base:W.TIME,prefixes:F.NONE,value:31557600,offset:0},decade:{name:"year",base:W.TIME,prefixes:F.NONE,value:315576e3,offset:0},century:{name:"century",base:W.TIME,prefixes:F.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:W.TIME,prefixes:F.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:W.FREQUENCY,prefixes:F.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:W.FREQUENCY,prefixes:F.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:W.ANGLE,prefixes:F.NONE,value:1,offset:0},deg:{name:"deg",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},grad:{name:"grad",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},cycle:{name:"cycle",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:W.ANGLE,prefixes:F.NONE,value:null,offset:0},A:{name:"A",base:W.CURRENT,prefixes:F.SHORT,value:1,offset:0},ampere:{name:"ampere",base:W.CURRENT,prefixes:F.LONG,value:1,offset:0},K:{name:"K",base:W.TEMPERATURE,prefixes:F.NONE,value:1,offset:0},degC:{name:"degC",base:W.TEMPERATURE,prefixes:F.NONE,value:1,offset:273.15},degF:{name:"degF",base:W.TEMPERATURE,prefixes:F.NONE,value:1/1.8,offset:459.67},degR:{name:"degR",base:W.TEMPERATURE,prefixes:F.NONE,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:W.TEMPERATURE,prefixes:F.NONE,value:1,offset:0},celsius:{name:"celsius",base:W.TEMPERATURE,prefixes:F.NONE,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:W.TEMPERATURE,prefixes:F.NONE,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:W.TEMPERATURE,prefixes:F.NONE,value:1/1.8,offset:0},mol:{name:"mol",base:W.AMOUNT_OF_SUBSTANCE,prefixes:F.SHORT,value:1,offset:0},mole:{name:"mole",base:W.AMOUNT_OF_SUBSTANCE,prefixes:F.LONG,value:1,offset:0},cd:{name:"cd",base:W.LUMINOUS_INTENSITY,prefixes:F.NONE,value:1,offset:0},candela:{name:"candela",base:W.LUMINOUS_INTENSITY,prefixes:F.NONE,value:1,offset:0},N:{name:"N",base:W.FORCE,prefixes:F.SHORT,value:1,offset:0},newton:{name:"newton",base:W.FORCE,prefixes:F.LONG,value:1,offset:0},dyn:{name:"dyn",base:W.FORCE,prefixes:F.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:W.FORCE,prefixes:F.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:W.FORCE,prefixes:F.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:W.FORCE,prefixes:F.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:W.FORCE,prefixes:F.LONG,value:4448.2216,offset:0},J:{name:"J",base:W.ENERGY,prefixes:F.SHORT,value:1,offset:0},joule:{name:"joule",base:W.ENERGY,prefixes:F.SHORT,value:1,offset:0},erg:{name:"erg",base:W.ENERGY,prefixes:F.NONE,value:1e-5,offset:0},Wh:{name:"Wh",base:W.ENERGY,prefixes:F.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:W.ENERGY,prefixes:F.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:W.ENERGY,prefixes:F.SHORT,value:1.602176565e-19,offset:0},electronvolt:{name:"electronvolt",base:W.ENERGY,prefixes:F.LONG,value:1.602176565e-19,offset:0},W:{name:"W",base:W.POWER,prefixes:F.SHORT,value:1,offset:0},watt:{name:"W",base:W.POWER,prefixes:F.LONG,value:1,offset:0},hp:{name:"hp",base:W.POWER,prefixes:F.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:W.POWER,prefixes:F.SHORT,value:O.I,offset:0},VA:{name:"VA",base:W.POWER,prefixes:F.SHORT,value:1,offset:0},Pa:{name:"Pa",base:W.PRESSURE,prefixes:F.SHORT,value:1,offset:0},psi:{name:"psi",base:W.PRESSURE,prefixes:F.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:W.PRESSURE,prefixes:F.NONE,value:101325,offset:0},bar:{name:"bar",base:W.PRESSURE,prefixes:F.NONE,value:1e5,offset:0},torr:{name:"torr",base:W.PRESSURE,prefixes:F.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:W.PRESSURE,prefixes:F.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:W.PRESSURE,prefixes:F.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:W.PRESSURE,prefixes:F.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:W.ELECTRIC_CHARGE,prefixes:F.LONG,value:1,offset:0},C:{name:"C",base:W.ELECTRIC_CHARGE,prefixes:F.SHORT,value:1,offset:0},farad:{name:"farad",base:W.ELECTRIC_CAPACITANCE,prefixes:F.LONG,value:1,offset:0},F:{name:"F",base:W.ELECTRIC_CAPACITANCE,prefixes:F.SHORT,value:1,offset:0},volt:{name:"volt",base:W.ELECTRIC_POTENTIAL,prefixes:F.LONG,value:1,offset:0},V:{name:"V",base:W.ELECTRIC_POTENTIAL,prefixes:F.SHORT,value:1,offset:0},ohm:{name:"ohm",base:W.ELECTRIC_RESISTANCE,prefixes:F.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:W.ELECTRIC_INDUCTANCE,prefixes:F.LONG,value:1,offset:0},H:{name:"H",base:W.ELECTRIC_INDUCTANCE,prefixes:F.SHORT,value:1,offset:0},siemens:{name:"siemens",base:W.ELECTRIC_CONDUCTANCE,prefixes:F.LONG,value:1,offset:0},S:{name:"S",base:W.ELECTRIC_CONDUCTANCE,prefixes:F.SHORT,value:1,offset:0},weber:{name:"weber",base:W.MAGNETIC_FLUX,prefixes:F.LONG,value:1,offset:0},Wb:{name:"Wb",base:W.MAGNETIC_FLUX,prefixes:F.SHORT,value:1,offset:0},tesla:{name:"tesla",base:W.MAGNETIC_FLUX_DENSITY,prefixes:F.LONG,value:1,offset:0},T:{name:"T",base:W.MAGNETIC_FLUX_DENSITY,prefixes:F.SHORT,value:1,offset:0},b:{name:"b",base:W.BIT,prefixes:F.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:W.BIT,prefixes:F.BINARY_LONG,value:1,offset:0},B:{name:"B",base:W.BIT,prefixes:F.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:W.BIT,prefixes:F.BINARY_LONG,value:8,offset:0}},K={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",hertz:"hertz",radians:"rad",degree:"deg",degrees:"deg",gradian:"grad",gradians:"grad",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole"};b(e),l.on("config",function(t,e){t.number!==e.number&&b(t)});var q={si:{NONE:{unit:z,prefix:F.NONE[""]},LENGTH:{unit:j.m,prefix:F.SHORT[""]},MASS:{unit:j.g,prefix:F.SHORT.k},TIME:{unit:j.s,prefix:F.SHORT[""]},CURRENT:{unit:j.A,prefix:F.SHORT[""]},TEMPERATURE:{unit:j.K,prefix:F.SHORT[""]},LUMINOUS_INTENSITY:{unit:j.cd,prefix:F.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:j.mol,prefix:F.SHORT[""]},ANGLE:{unit:j.rad,prefix:F.SHORT[""]},BIT:{unit:j.bit,prefix:F.SHORT[""]},FORCE:{unit:j.N,prefix:F.SHORT[""]},ENERGY:{unit:j.J,prefix:F.SHORT[""]},POWER:{unit:j.W,prefix:F.SHORT[""]},PRESSURE:{unit:j.Pa,prefix:F.SHORT[""]},ELECTRIC_CHARGE:{unit:j.C,prefix:F.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:j.F,prefix:F.SHORT[""]},ELECTRIC_POTENTIAL:{unit:j.V,prefix:F.SHORT[""]},ELECTRIC_RESISTANCE:{unit:j.ohm,prefix:F.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:j.H,prefix:F.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:j.S,prefix:F.SHORT[""]},MAGNETIC_FLUX:{unit:j.Wb,prefix:F.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:j.T,prefix:F.SHORT[""]},FREQUENCY:{unit:j.Hz,prefix:F.SHORT[""]}}};q.cgs=JSON.parse(JSON.stringify(q.si)),q.cgs.LENGTH={unit:j.m,prefix:F.SHORT.c},q.cgs.MASS={unit:j.g,prefix:F.SHORT[""]},q.cgs.FORCE={unit:j.dyn,prefix:F.SHORT[""]},q.cgs.ENERGY={unit:j.erg,prefix:F.NONE[""]},q.us=JSON.parse(JSON.stringify(q.si)),q.us.LENGTH={unit:j.ft,prefix:F.NONE[""]},q.us.MASS={unit:j.lbm,prefix:F.NONE[""]},q.us.TEMPERATURE={unit:j.degF,prefix:F.NONE[""]},q.us.FORCE={unit:j.lbf,prefix:F.NONE[""]},q.us.ENERGY={unit:j.BTU,prefix:F.BTU[""]},q.us.POWER={unit:j.hp,prefix:F.NONE[""]},q.us.PRESSURE={unit:j.psi,prefix:F.NONE[""]},q.auto=JSON.parse(JSON.stringify(q.si));var Z=q.auto;u.setUnitSystem=function(t){if(!q.hasOwnProperty(t))throw new Error("Unit system "+t+" does not exist. Choices are: "+Object.keys(q).join(", "));Z=q[t]},u.getUnitSystem=function(){for(var t in q)if(q[t]===Z)return t},u.typeConverters={BigNumber:function(e){return new t.BigNumber(e+"")},Fraction:function(e){return new t.Fraction(e)},Complex:function(t){return t},number:function(t){return t}},u._getNumberConverter=function(t){if(!u.typeConverters[t])throw new TypeError('Unsupported type "'+t+'"');return u.typeConverters[t]};for(var G in j){var H=j[G];H.dimensions=H.base.dimensions}for(var $ in K)if(K.hasOwnProperty($)){var H=j[K[$]],Y={};for(var G in H)H.hasOwnProperty(G)&&(Y[G]=H[G]);Y.name=$,j[$]=Y}return u.createUnit=function(t,e){if("object"!=typeof t)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(e&&e.override)for(var r in t)if(t.hasOwnProperty(r)&&u.deleteUnit(r),t[r].aliases)for(var i=0;i<t[r].aliases.length;i++)u.deleteUnit(t[r].aliases[i]);var n;for(var r in t)t.hasOwnProperty(r)&&(n=u.createUnitSingle(r,t[r]));return n},u.createUnitSingle=function(t,e,r){if("undefined"!=typeof e&&null!==e||(e={}),"string"!=typeof t)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(j.hasOwnProperty(t))throw new Error('Cannot create unit "'+t+'": a unit with that name already exists');E(t);var i,n,o=null,a=[],s=0;if(e&&"Unit"===e.type)o=e.clone();else if("string"==typeof e)""!==e&&(i=e);else{if("object"!=typeof e)throw new TypeError('Cannot create unit "'+t+'" from "'+e.toString()+'": expecting "string" or "Unit" or "Object"');i=e.definition,n=e.prefixes,s=e.offset,a=e.aliases}if(a)for(var l=0;l<a.length;l++)if(j.hasOwnProperty(a[l]))throw new Error('Cannot create alias "'+a[l]+'": a unit with that name already exists');if(i&&"string"==typeof i&&!o)try{o=u.parse(i,{allowNoUnits:!0})}catch(e){throw e.message='Could not create unit "'+t+'" from "'+i+'": '+e.message,e}else i&&"Unit"===i.type&&(o=i.clone());a=a||[],s=s||0,n=n&&n.toUpperCase?F[n.toUpperCase()]||F.NONE:F.NONE;var c={};if(o){c={name:t,value:o.value,dimensions:o.dimensions.slice(0),prefixes:n,offset:s};var h=!1;for(var l in W)if(W.hasOwnProperty(l)){for(var f=!0,d=0;d<B.length;d++)if(Math.abs((c.dimensions[d]||0)-(W[l].dimensions[d]||0))>1e-12){f=!1;break}if(f){h=!0;break}}if(!h){var p=t+"_STUFF",g={dimensions:o.dimensions.slice(0)};g.key=p,W[p]=g,Z[p]={unit:c,prefix:F.NONE[""]},c.base=p}}else{var p=t+"_STUFF";if(B.indexOf(p)>=0)throw new Error('Cannot create new base unit "'+t+'": a base unit with that name already exists (and cannot be overridden)');B.push(p);for(var m in W)W.hasOwnProperty(m)&&(W[m].dimensions[B.length-1]=0);for(var g={dimensions:[]},l=0;l<B.length;l++)g.dimensions[l]=0;g.dimensions[B.length-1]=1,g.key=p,W[p]=g,c={name:t,value:1,dimensions:W[p].dimensions.slice(0),prefixes:n,offset:s,base:p},Z[p]={unit:c,prefix:F.NONE[""]}}u.UNITS[t]=c;for(var l=0;l<a.length;l++){var y=a[l],v={};for(var b in c)c.hasOwnProperty(b)&&(v[b]=c[b]);v.name=y,u.UNITS[y]=v}return new u(null,t)},u.deleteUnit=function(t){delete u.UNITS[t]},u.PREFIXES=F,u.BASE_UNITS=W,u.UNITS=j,u.UNIT_SYSTEMS=q,u}var n=r(23).endsWith,o=r(3).clone,a=r(76);e.name="Unit",e.path="type",e.factory=i,e.math=!0},function(t,e,r){function i(t){return t[0].precision}var n=r(45).memoize;e.e=n(function(t){return new t(1).exp()},i),e.phi=n(function(t){return new t(1).plus(new t(5).sqrt()).div(2)},i),e.pi=n(function(t){return pi=t.acos(-1)},i),e.tau=n(function(t){return e.pi(t).times(2)},i)},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=i(r(52)),l=i(r(53)),u=i(r(78)),c=i(r(54)),h=i(r(61)),f=i(r(79)),d=i(r(56)),p=i(r(57)),g=i(r(58)),m=o("subtract",{"number, number":function(t,e){return t-e},"Complex, Complex":function(t,e){return t.sub(e)},"BigNumber, BigNumber":function(t,e){return t.minus(e)},"Fraction, Fraction":function(t,e){return t.sub(e)},"Unit, Unit":function(t,e){if(null==t.value)throw new Error("Parameter x contains a unit with undefined value");if(null==e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var r=t.clone();return r.value=m(r.value,e.value),r.fixPrefix=!1,r},"Matrix, Matrix":function(t,e){var r=t.size(),i=e.size();if(r.length!==i.length)throw new n(r.length,i.length);var o;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":o=f(t,e,m);break;default:o=h(e,t,m,!0)}break;default:switch(e.storage()){case"sparse":o=c(t,e,m,!1);break;default:o=p(t,e,m)}}return o},"Array, Array":function(t,e){return m(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return m(s(t),e)},"Matrix, Array":function(t,e){return m(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=d(t,u(e),l);break;default:r=g(t,e,m)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=d(e,t,m,!0);break;default:r=g(e,t,m,!0)}return r},"Array, any":function(t,e){return g(s(t),e,m,!1).valueOf()},"any, Array":function(t,e){return g(s(e),t,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+a.operators.subtract+"${args[1]}\\right)"},m}var n=r(42);e.name="subtract",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=o("unaryMinus",{number:function(t){return-t},Complex:function(t){return t.neg()},BigNumber:function(t){return t.neg()},Fraction:function(t){return t.neg()},Unit:function(t){var e=t.clone();return e.value=s(t.value),e},"Array | Matrix":function(t){return n(t,s,!0)}});return s.toTex={1:a.operators.unaryMinus+"\\left(${args[0]}\\right)"},s}var n=r(19);e.name="unaryMinus",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r){var i=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype,f=e._values,d=e._index,p=e._ptr,g=e._size,m=e._datatype;if(c.length!==g.length)throw new n(c.length,g.length);if(c[0]!==g[0]||c[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+g+")");var y,v=c[0],b=c[1],E=a,w=0,_=r;"string"==typeof h&&h===m&&(y=h,E=o.find(a,[y,y]),w=o.convert(0,y),_=o.find(r,[y,y]));var x,S,T,M,L=i&&f?[]:void 0,A=[],N=[],C=new s({values:L,index:A,ptr:N,size:[v,b],datatype:y}),R=L?[]:void 0,P=L?[]:void 0,O=[],I=[];for(S=0;S<b;S++){N[S]=A.length;var k=S+1;for(T=u[S],M=u[S+1];T<M;T++)x=l[T],A.push(x),O[x]=k,R&&(R[x]=i[T]);for(T=p[S],M=p[S+1];T<M;T++)x=d[T],O[x]!==k&&A.push(x),I[x]=k,P&&(P[x]=f[T]);if(L)for(T=N[S];T<A.length;){x=A[T];var D=O[x],V=I[x];if(D===k||V===k){var F=D===k?R[x]:w,G=V===k?P[x]:w,B=_(F,G);E(B,w)?A.splice(T,1):(L.push(B),T++)}}}return N[b]=A.length,C};return l}var n=r(42);e.name="algorithm05",e.factory=i},function(t,e){"use strict";function r(t,e,r,i){var n=i("multiplyScalar",{"number, number":function(t,e){return t*e},"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":function(t,e){var r=e.clone();return r.value=null===r.value?r._normalize(t):n(r.value,t),r},"Unit, number | Fraction | BigNumber | Complex":function(t,e){var r=t.clone();return r.value=null===r.value?r._normalize(e):n(r.value,e),r},"Unit, Unit":function(t,e){return t.multiply(e)}});return n}e.factory=r},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(80)),a=n("divide",{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Fraction | BigNumber":function(t,e){var r=t.clone();return r.value=a(null===r.value?r._normalize(1):r.value,e),r},"number | Fraction | BigNumber, Unit":function(t,e){var r=e.pow(-1);return r.value=o(null===r.value?r._normalize(1):r.value,t),r},"Unit, Unit":function(t,e){return t.divide(e)}});return a}e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(r,i){if(e.predictable&&!n(i)&&r<0)try{var o=p(i),a=g(o);if((i===a||Math.abs((i-a)/i)<1e-14)&&o.d%2===1)return(o.n%2===0?1:-1)*Math.pow(-r,i)}catch(t){}return n(i)||r>=0||e.predictable?Math.pow(r,i):new t.Complex(r,0).pow(i,0)}function l(t,e){if(!n(e)||e<0)throw new TypeError("For A^b, b must be a positive integer (value is "+e+")");var r=o(t);if(2!=r.length)throw new Error("For A^b, A must be 2 dimensional (A has "+r.length+" dimensions)");if(r[0]!=r[1])throw new Error("For A^b, A must be square (size is "+r[0]+"x"+r[1]+")");for(var i=h(r[0]).valueOf(),a=t;e>=1;)1==(1&e)&&(i=f(a,i)),e>>=1,a=f(a,a);return i}function u(t,e){return d(l(t.valueOf(),e))}var c=r(32),h=i(r(83)),f=i(r(84)),d=i(r(52)),p=i(r(36)),g=i(r(70)),m=a("pow",{"number, number":s,"Complex, Complex":function(t,e){return t.pow(e)},"BigNumber, BigNumber":function(r,i){return i.isInteger()||r>=0||e.predictable?r.pow(i):new t.Complex(r.toNumber(),0).pow(i.toNumber(),0)},"Fraction, Fraction":function(t,r){if(1!==r.d){if(e.predictable)throw new Error("Function pow does not support non-integer exponents for fractions.");return s(t.valueOf(),r.valueOf())}return t.pow(r)},"Array, number":l,"Array, BigNumber":function(t,e){return l(t,e.toNumber())},"Matrix, number":u,"Matrix, BigNumber":function(t,e){return u(t,e.toNumber())},"Unit, number":function(t,e){return t.pow(e)}});return m.toTex={2:"\\left(${args[0]}\\right)"+c.operators.pow+"{${args[1]}}"},m}var n=r(6).isInteger,o=r(40).size;e.name="pow",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(t,e){switch(t.length){case 0:return e?u(e):[];case 1:return l(t[0],t[0],e);case 2:return l(t[0],t[1],e);default:throw new Error("Vector containing two values expected")}}function l(e,r,i){var a=e&&e.isBigNumber===!0?t.BigNumber:r&&r.isBigNumber===!0?t.BigNumber:null;if(e&&e.isBigNumber===!0&&(e=e.toNumber()),r&&r.isBigNumber===!0&&(r=r.toNumber()),!o(e)||e<1)throw new Error("Parameters in function eye must be positive integers");if(!o(r)||r<1)throw new Error("Parameters in function eye must be positive integers");var s=a?new t.BigNumber(1):1,l=a?new a(0):0,u=[e,r];if(i){var c=t.Matrix.storage(i);return c.diagonal(u,s,0,l)}for(var h=n.resize([],u,l),f=e<r?e:r,d=0;d<f;d++)h[d][d]=s;return h}var u=i(r(52)),c=a("eye",{"":function(){return"Matrix"===e.matrix?u([]):[]},string:function(t){return u(t)},"number | BigNumber":function(t){return l(t,t,"Matrix"===e.matrix?"default":void 0)},"number | BigNumber, string":function(t,e){return l(t,t,e)},"number | BigNumber, number | BigNumber":function(t,r){return l(t,r,"Matrix"===e.matrix?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,r){return l(t,e,r)},Array:function(t){return s(t)},"Array, string":function(t,e){return s(t,e)},Matrix:function(t){return s(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return s(t.valueOf(),e)}});return c.toTex=void 0,c}var n=r(40),o=r(6).isInteger;e.name="eye",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(53)),c=i(r(80)),h=i(r(48)),f=i(r(85)),d=i(r(58)),p=t.DenseMatrix,g=t.SparseMatrix,m=a("multiply",n({"Array, Array":function(t,e){y(o.size(t),o.size(e));var r=m(l(t),l(e));return r&&r.isMatrix===!0?r.valueOf():r},"Matrix, Matrix":function(t,e){var r=t.size(),i=e.size();return y(r,i),1===r.length?1===i.length?v(t,e,r[0]):b(t,e):1===i.length?w(t,e):_(t,e)},"Matrix, Array":function(t,e){return m(t,l(e))},"Array, Matrix":function(t,e){return m(l(t,e.storage()),e)},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=f(t,e,c,!1);break;case"dense":r=d(t,e,c,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=f(e,t,c,!0);break;case"dense":r=d(e,t,c,!0)}return r},"Array, any":function(t,e){return d(l(t),e,c,!1).valueOf()},"any, Array":function(t,e){return d(l(e),t,c,!0).valueOf()}},c.signatures)),y=function(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}},v=function(t,e,r){if(0===r)throw new Error("Cannot multiply two empty vectors");var i,n=t._data,o=t._datatype,s=e._data,l=e._datatype,h=u,f=c;o&&l&&o===l&&"string"==typeof o&&(i=o,h=a.find(u,[i,i]),f=a.find(c,[i,i]));for(var d=f(n[0],s[0]),p=1;p<r;p++)d=h(d,f(n[p],s[p]));return d},b=function(t,e){switch(e.storage()){case"dense":return E(t,e)}throw new Error("Not implemented")},E=function(t,e){var r,i=t._data,n=t._size,o=t._datatype,s=e._data,l=e._size,h=e._datatype,f=n[0],d=l[1],g=u,m=c;o&&h&&o===h&&"string"==typeof o&&(r=o,g=a.find(u,[r,r]),m=a.find(c,[r,r]));for(var y=[],v=0;v<d;v++){for(var b=m(i[0],s[0][v]),E=1;E<f;E++)b=g(b,m(i[E],s[E][v]));y[v]=b}return new p({data:y,size:[d],datatype:r})},w=function(t,e){switch(t.storage()){case"dense":return x(t,e);case"sparse":return M(t,e)}},_=function(t,e){switch(t.storage()){case"dense":switch(e.storage()){case"dense":return S(t,e);case"sparse":return T(t,e)}break;case"sparse":switch(e.storage()){case"dense":return L(t,e);case"sparse":return A(t,e)}}},x=function(t,e){var r,i=t._data,n=t._size,o=t._datatype,s=e._data,l=e._datatype,h=n[0],f=n[1],d=u,g=c;o&&l&&o===l&&"string"==typeof o&&(r=o,d=a.find(u,[r,r]),g=a.find(c,[r,r]));for(var m=[],y=0;y<h;y++){for(var v=i[y],b=g(v[0],s[0]),E=1;E<f;E++)b=d(b,g(v[E],s[E]));m[y]=b}return new p({data:m,size:[h],datatype:r})},S=function(t,e){var r,i=t._data,n=t._size,o=t._datatype,s=e._data,l=e._size,h=e._datatype,f=n[0],d=n[1],g=l[1],m=u,y=c;o&&h&&o===h&&"string"==typeof o&&(r=o,m=a.find(u,[r,r]),y=a.find(c,[r,r]));for(var v=[],b=0;b<f;b++){var E=i[b];v[b]=[];for(var w=0;w<g;w++){for(var _=y(E[0],s[0][w]),x=1;x<d;x++)_=m(_,y(E[x],s[x][w]));v[b][w]=_}}return new p({data:v,size:[f,g],datatype:r})},T=function(t,e){var r=t._data,i=t._size,n=t._datatype,o=e._values,s=e._index,l=e._ptr,f=e._size,d=e._datatype;if(!o)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var p,m=i[0],y=f[1],v=u,b=c,E=h,w=0;n&&d&&n===d&&"string"==typeof n&&(p=n,v=a.find(u,[p,p]),b=a.find(c,[p,p]),E=a.find(h,[p,p]),w=a.convert(0,p));for(var _=[],x=[],S=[],T=new g({values:_,index:x,ptr:S,size:[m,y],datatype:p}),M=0;M<y;M++){S[M]=x.length;var L=l[M],A=l[M+1];if(A>L)for(var N=0,C=0;C<m;C++){for(var R,P=C+1,O=L;O<A;O++){var I=s[O];N!==P?(R=b(r[C][I],o[O]),N=P):R=v(R,b(r[C][I],o[O]))}N!==P||E(R,w)||(x.push(C),_.push(R))}}return S[y]=x.length,T},M=function(t,e){var r=t._values,i=t._index,n=t._ptr,o=t._datatype;if(!r)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s,l=e._data,f=e._datatype,d=t._size[0],p=e._size[0],m=[],y=[],v=[],b=u,E=c,w=h,_=0;o&&f&&o===f&&"string"==typeof o&&(s=o,b=a.find(u,[s,s]),E=a.find(c,[s,s]),w=a.find(h,[s,s]),_=a.convert(0,s));var x=[],S=[];v[0]=0;for(var T=0;T<p;T++){var M=l[T];if(!w(M,_))for(var L=n[T],A=n[T+1],N=L;N<A;N++){var C=i[N];S[C]?x[C]=b(x[C],E(M,r[N])):(S[C]=!0,y.push(C),x[C]=E(M,r[N]))}}for(var R=y.length,P=0;P<R;P++){var O=y[P];m[P]=x[O]}return v[1]=y.length,new g({values:m,index:y,ptr:v,size:[d,1],datatype:s})},L=function(t,e){var r=t._values,i=t._index,n=t._ptr,o=t._datatype;if(!r)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s,l=e._data,f=e._datatype,d=t._size[0],p=e._size[0],m=e._size[1],y=u,v=c,b=h,E=0;o&&f&&o===f&&"string"==typeof o&&(s=o,y=a.find(u,[s,s]),v=a.find(c,[s,s]),b=a.find(h,[s,s]),E=a.convert(0,s));for(var w=[],_=[],x=[],S=new g({values:w,index:_,ptr:x,size:[d,m],datatype:s}),T=[],M=[],L=0;L<m;L++){x[L]=_.length;for(var A=L+1,N=0;N<p;N++){var C=l[N][L];if(!b(C,E))for(var R=n[N],P=n[N+1],O=R;O<P;O++){var I=i[O];M[I]!==A?(M[I]=A,_.push(I),T[I]=v(C,r[O])):T[I]=y(T[I],v(C,r[O]))}}for(var k=x[L],D=_.length,V=k;V<D;V++){var F=_[V];w[V]=T[F]}}return x[m]=_.length,S},A=function(t,e){var r,i=t._values,n=t._index,o=t._ptr,s=t._datatype,l=e._values,h=e._index,f=e._ptr,d=e._datatype,p=t._size[0],m=e._size[1],y=i&&l,v=u,b=c;s&&d&&s===d&&"string"==typeof s&&(r=s,v=a.find(u,[r,r]),b=a.find(c,[r,r]));for(var E,w,_,x,S,T,M,L,A=y?[]:void 0,N=[],C=[],R=new g({values:A,index:N,ptr:C,size:[p,m],datatype:r}),P=y?[]:void 0,O=[],I=0;I<m;I++){C[I]=N.length;var k=I+1;for(S=f[I],T=f[I+1],x=S;x<T;x++)if(L=h[x],y)for(w=o[L],_=o[L+1],E=w;E<_;E++)M=n[E],O[M]!==k?(O[M]=k,N.push(M),P[M]=b(l[x],i[E])):P[M]=v(P[M],b(l[x],i[E]));else for(w=o[L],_=o[L+1],E=w;E<_;E++)M=n[E],O[M]!==k&&(O[M]=k,N.push(M));if(y)for(var D=C[I],V=N.length,F=D;F<V;F++){var G=N[F];A[F]=P[G]}}return C[m]=N.length,R};return m.toTex={2:"\\left(${args[0]}"+s.operators.multiply+"${args[1]}\\right)"},m}var n=r(3).extend,o=r(40);e.name="multiply",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(48)),a=t.SparseMatrix,s=function(t,e,r,i){var s=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f,d=c[0],p=c[1],g=o,m=0,y=r;"string"==typeof h&&(f=h,g=n.find(o,[f,f]),m=n.convert(0,f),e=n.convert(e,f),y=n.find(r,[f,f]));for(var v=[],b=[],E=[],w=new a({values:v,index:b,ptr:E,size:[d,p],datatype:f}),_=0;_<p;_++){E[_]=b.length;for(var x=u[_],S=u[_+1],T=x;T<S;T++){var M=l[T],L=i?y(e,s[T]):y(s[T],e);g(L,m)||(b.push(M),v.push(L))}}return E[p]=b.length,w};return s}e.name="algorithm11",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("abs",{number:Math.abs,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},Fraction:function(t){return t.abs()},"Array | Matrix":function(t){return n(t,o,!0)},Unit:function(t){return t.abs()}});return o.toTex={1:"\\left|${args[0]}\\right|"},o}var n=r(19);e.name="abs",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("fix",{number:function(t){return t>0?Math.floor(t):Math.ceil(t)},Complex:function(e){return new t.Complex(e.re>0?Math.floor(e.re):Math.ceil(e.re),e.im>0?Math.floor(e.im):Math.ceil(e.im))},BigNumber:function(t){return t.isNegative()?t.ceil():t.floor()},Fraction:function(t){return t.s<0?t.ceil():t.floor()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="fix",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){
var o=i(r(52)),a=i(r(48)),s=i(r(61)),l=i(r(62)),u=i(r(63)),c=i(r(57)),h=i(r(58)),f=r(32),d=n("equal",{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:a(t,e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=l(t,e,a);break;default:r=s(e,t,a,!0)}break;default:switch(e.storage()){case"sparse":r=s(t,e,a,!1);break;default:r=c(t,e,a)}}return r},"Array, Array":function(t,e){return d(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return d(o(t),e)},"Matrix, Array":function(t,e){return d(t,o(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=u(t,e,a,!1);break;default:r=h(t,e,a,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=u(e,t,a,!0);break;default:r=h(e,t,a,!0)}return r},"Array, any":function(t,e){return h(o(t),e,a,!1).valueOf()},"any, Array":function(t,e){return h(o(e),t,a,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+f.operators.equal+"${args[1]}\\right)"},d}e.name="equal",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isNumeric",{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string":function(){return!1},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);r(6);e.name="isNumeric",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("format",{any:n.format,"any, Object | function | number":n.format});return o.toTex=void 0,o}var n=r(23);e.name="format",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("_typeof",{any:function(t){var e=n.type(t);if("Object"===e){if(t.isBigNumber===!0)return"BigNumber";if(t.isComplex===!0)return"Complex";if(t.isFraction===!0)return"Fraction";if(t.isMatrix===!0)return"Matrix";if(t.isUnit===!0)return"Unit";if(t.isIndex===!0)return"Index";if(t.isRange===!0)return"Range";if(t.isChain===!0)return"Chain";if(t.isHelp===!0)return"Help"}return e}});return o.toTex=void 0,o}var n=r(41);e.name="typeof",e.factory=i},function(t,e,r){(function(t,i){function n(t,r){var i={seen:[],stylize:a};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),g(r)?i.showHidden=r:r&&e._extend(i,r),w(i.showHidden)&&(i.showHidden=!1),w(i.depth)&&(i.depth=2),w(i.colors)&&(i.colors=!1),w(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=o),l(i,t,i.depth)}function o(t,e){var r=n.styles[e];return r?"["+n.colors[r][0]+"m"+t+"["+n.colors[r][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}function l(t,r,i){if(t.customInspect&&r&&M(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(i,t);return b(n)||(n=l(t,n,i)),n}var o=u(t,r);if(o)return o;var a=Object.keys(r),g=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(r)),T(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(r);if(0===a.length){if(M(r)){var m=r.name?": "+r.name:"";return t.stylize("[Function"+m+"]","special")}if(_(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(S(r))return t.stylize(Date.prototype.toString.call(r),"date");if(T(r))return c(r)}var y="",v=!1,E=["{","}"];if(p(r)&&(v=!0,E=["[","]"]),M(r)){var w=r.name?": "+r.name:"";y=" [Function"+w+"]"}if(_(r)&&(y=" "+RegExp.prototype.toString.call(r)),S(r)&&(y=" "+Date.prototype.toUTCString.call(r)),T(r)&&(y=" "+c(r)),0===a.length&&(!v||0==r.length))return E[0]+y+E[1];if(i<0)return _(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special");t.seen.push(r);var x;return x=v?h(t,r,i,g,a):a.map(function(e){return f(t,r,i,g,e,v)}),t.seen.pop(),d(x,y,E)}function u(t,e){if(w(e))return t.stylize("undefined","undefined");if(b(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return v(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,r,i,n){for(var o=[],a=0,s=e.length;a<s;++a)R(e,String(a))?o.push(f(t,e,r,i,String(a),!0)):o.push("");return n.forEach(function(n){n.match(/^\d+$/)||o.push(f(t,e,r,i,n,!0))}),o}function f(t,e,r,i,n,o){var a,s,u;if(u=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},u.get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),R(i,n)||(a="["+n+"]"),s||(t.seen.indexOf(u.value)<0?(s=m(r)?l(t,u.value,null):l(t,u.value,r-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),w(a)){if(o&&n.match(/^\d+$/))return s;a=JSON.stringify(""+n),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t,e,r){var i=0,n=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function p(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function m(t){return null===t}function y(t){return null==t}function v(t){return"number"==typeof t}function b(t){return"string"==typeof t}function E(t){return"symbol"==typeof t}function w(t){return void 0===t}function _(t){return x(t)&&"[object RegExp]"===A(t)}function x(t){return"object"==typeof t&&null!==t}function S(t){return x(t)&&"[object Date]"===A(t)}function T(t){return x(t)&&("[object Error]"===A(t)||t instanceof Error)}function M(t){return"function"==typeof t}function L(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function A(t){return Object.prototype.toString.call(t)}function N(t){return t<10?"0"+t.toString(10):t.toString(10)}function C(){var t=new Date,e=[N(t.getHours()),N(t.getMinutes()),N(t.getSeconds())].join(":");return[t.getDate(),k[t.getMonth()],e].join(" ")}function R(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var P=/%[sdj%]/g;e.format=function(t){if(!b(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(n(arguments[r]));return e.join(" ")}for(var r=1,i=arguments,o=i.length,a=String(t).replace(P,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return t}}),s=i[r];r<o;s=i[++r])a+=m(s)||!x(s)?" "+s:" "+n(s);return a},e.deprecate=function(r,n){function o(){if(!a){if(i.throwDeprecation)throw new Error(n);i.traceDeprecation?console.trace(n):console.error(n),a=!0}return r.apply(this,arguments)}if(w(t.process))return function(){return e.deprecate(r,n).apply(this,arguments)};if(i.noDeprecation===!0)return r;var a=!1;return o};var O,I={};e.debuglog=function(t){if(w(O)&&(O=i.env.NODE_DEBUG||""),t=t.toUpperCase(),!I[t])if(new RegExp("\\b"+t+"\\b","i").test(O)){var r=i.pid;I[t]=function(){var i=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,i)}}else I[t]=function(){};return I[t]},e.inspect=n,n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=g,e.isNull=m,e.isNullOrUndefined=y,e.isNumber=v,e.isString=b,e.isSymbol=E,e.isUndefined=w,e.isRegExp=_,e.isObject=x,e.isDate=S,e.isError=T,e.isFunction=M,e.isPrimitive=L,e.isBuffer=r(94);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",C(),e.format.apply(e,arguments))},e.inherits=r(95),e._extend=function(t,e){if(!e||!x(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t}}).call(e,function(){return this}(),r(93))},function(t,e){function r(){u=!1,a.length?l=a.concat(l):c=-1,l.length&&i()}function i(){if(!u){var t=setTimeout(r);u=!0;for(var e=l.length;e;){for(a=l,l=[];++c<e;)a&&a[c].run();c=-1,e=l.length}a=null,u=!1,clearTimeout(t)}}function n(t,e){this.fun=t,this.array=e}function o(){}var a,s=t.exports={},l=[],u=!1,c=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new n(t,e)),1!==l.length||u||setTimeout(i,0)},n.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=o,s.addListener=o,s.once=o,s.off=o,s.removeListener=o,s.removeAllListeners=o,s.emit=o,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("unit",{Unit:function(t){return t.clone()},string:function(e){return t.Unit.isValuelessUnit(e)?new t.Unit(null,e):t.Unit.parse(e)},"number | BigNumber | Fraction | Complex, string":function(e,r){return new t.Unit(e,r)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},o}var n=r(19);e.name="unit",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var n=i("createUnit",{"Object, Object":function(e,r){return t.Unit.createUnit(e,r)},Object:function(e){return t.Unit.createUnit(e,{})},"string, Unit | string | Object, Object":function(e,r,i){var n={};return n[e]=r,t.Unit.createUnit(n,i)},"string, Unit | string | Object":function(e,r){var i={};return i[e]=r,t.Unit.createUnit(i,{})},string:function(e){var r={};return r[e]={},t.Unit.createUnit(r,{})}});return n}r(19);e.name="createUnit",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var n=i("splitUnit",{"Unit, Array":function(t,e){return t.splitUnit(e)}});return n}r(19);e.name="splitUnit",e.factory=i},function(t,e,r){function i(t,e,r,i,o){function a(e){var r=t.Unit.parse(e);return r.fixPrefix=!0,r}n(o,"speedOfLight",function(){return a("299792458 m s^-1")}),n(o,"gravitationConstant",function(){return a("6.6738480e-11 m^3 kg^-1 s^-2")}),n(o,"planckConstant",function(){return a("6.626069311e-34 J s")}),n(o,"reducedPlanckConstant",function(){return a("1.05457172647e-34 J s")}),n(o,"magneticConstant",function(){return a("1.2566370614e-6 N A^-2")}),n(o,"electricConstant",function(){return a("8.854187817e-12 F m^-1")}),n(o,"vacuumImpedance",function(){return a("376.730313461 ohm")}),n(o,"coulomb",function(){return a("8.9875517873681764e9 N m^2 C^-2")}),n(o,"elementaryCharge",function(){return a("1.60217656535e-19 C")}),n(o,"bohrMagneton",function(){return a("9.2740096820e-24 J T^-1")}),n(o,"conductanceQuantum",function(){return a("7.748091734625e-5 S")}),n(o,"inverseConductanceQuantum",function(){return a("12906.403721742 ohm")}),n(o,"magneticFluxQuantum",function(){return a("2.06783375846e-15 Wb")}),n(o,"nuclearMagneton",function(){return a("5.0507835311e-27 J T^-1")}),n(o,"klitzing",function(){return a("25812.807443484 ohm")}),n(o,"bohrRadius",function(){return a("5.291772109217e-11 m")}),n(o,"classicalElectronRadius",function(){return a("2.817940326727e-15 m")}),n(o,"electronMass",function(){return a("9.1093829140e-31 kg")}),n(o,"fermiCoupling",function(){return a("1.1663645e-5 GeV^-2")}),n(o,"fineStructure",function(){return.007297352569824}),n(o,"hartreeEnergy",function(){return a("4.3597443419e-18 J")}),n(o,"protonMass",function(){return a("1.67262177774e-27 kg")}),n(o,"deuteronMass",function(){return a("3.3435830926e-27 kg")}),n(o,"neutronMass",function(){return a("1.6749271613e-27 kg")}),n(o,"quantumOfCirculation",function(){return a("3.636947552024e-4 m^2 s^-1")}),n(o,"rydberg",function(){return a("10973731.56853955 m^-1")}),n(o,"thomsonCrossSection",function(){return a("6.65245873413e-29 m^2")}),n(o,"weakMixingAngle",function(){return.222321}),n(o,"efimovFactor",function(){return 22.7}),n(o,"atomicMass",function(){return a("1.66053892173e-27 kg")}),n(o,"avogadro",function(){return a("6.0221412927e23 mol^-1")}),n(o,"boltzmann",function(){return a("1.380648813e-23 J K^-1")}),n(o,"faraday",function(){return a("96485.336521 C mol^-1")}),n(o,"firstRadiation",function(){return a("3.7417715317e-16 W m^2")}),n(o,"loschmidt",function(){return a("2.686780524e25 m^-3")}),n(o,"gasConstant",function(){return a("8.314462175 J K^-1 mol^-1")}),n(o,"molarPlanckConstant",function(){return a("3.990312717628e-10 J s mol^-1")}),n(o,"molarVolume",function(){return a("2.241396820e-10 m^3 mol^-1")}),n(o,"sackurTetrode",function(){return-1.164870823}),n(o,"secondRadiation",function(){return a("1.438777013e-2 m K")}),n(o,"stefanBoltzmann",function(){return a("5.67037321e-8 W m^-2 K^-4")}),n(o,"wienDisplacement",function(){return a("2.897772126e-3 m K")}),n(o,"molarMass",function(){return a("1e-3 kg mol^-1")}),n(o,"molarMassC12",function(){return a("1.2e-2 kg mol^-1")}),n(o,"gravity",function(){return a("9.80665 m s^-2")}),n(o,"planckLength",function(){return a("1.61619997e-35 m")}),n(o,"planckMass",function(){return a("2.1765113e-8 kg")}),n(o,"planckTime",function(){return a("5.3910632e-44 s")}),n(o,"planckCharge",function(){return a("1.87554595641e-18 C")}),n(o,"planckTemperature",function(){return a("1.41683385e+32 K")})}var n=r(3).lazy;e.factory=i,e.lazy=!1,e.math=!0},function(t,e,r){"use strict";function i(t,e,a,s,l){l.on("config",function(r,n){r.number!==n.number&&i(t,e,a,s,l)}),l.true=!0,l.false=!1,l.null=null,l.uninitialized=r(40).UNINITIALIZED,"BigNumber"===e.number?(l.Infinity=new t.BigNumber(1/0),l.NaN=new t.BigNumber(NaN),n.lazy(l,"pi",function(){return o.pi(t.BigNumber)}),n.lazy(l,"tau",function(){return o.tau(t.BigNumber)}),n.lazy(l,"e",function(){return o.e(t.BigNumber)}),n.lazy(l,"phi",function(){return o.phi(t.BigNumber)}),n.lazy(l,"E",function(){return l.e}),n.lazy(l,"LN2",function(){return new t.BigNumber(2).ln()}),n.lazy(l,"LN10",function(){return new t.BigNumber(10).ln()}),n.lazy(l,"LOG2E",function(){return new t.BigNumber(1).div(new t.BigNumber(2).ln())}),n.lazy(l,"LOG10E",function(){return new t.BigNumber(1).div(new t.BigNumber(10).ln())}),n.lazy(l,"PI",function(){return l.pi}),n.lazy(l,"SQRT1_2",function(){return new t.BigNumber("0.5").sqrt()}),n.lazy(l,"SQRT2",function(){return new t.BigNumber(2).sqrt()})):(l.Infinity=1/0,l.NaN=NaN,l.pi=Math.PI,l.tau=2*Math.PI,l.e=Math.E,l.phi=1.618033988749895,l.E=l.e,l.LN2=Math.LN2,l.LN10=Math.LN10,l.LOG2E=Math.LOG2E,l.LOG10E=Math.LOG10E,l.PI=l.pi,l.SQRT1_2=Math.SQRT1_2,l.SQRT2=Math.SQRT2),l.i=t.Complex.I,l.version=r(101)}var n=r(3),o=r(76);e.factory=i,e.lazy=!1,e.math=!0},function(t,e){t.exports="3.7.0"},function(t,e,r){t.exports=[r(103),r(278),r(307),r(309),r(335),r(280),r(306)]},function(t,e,r){function i(t,e,i,n){var o={};return o.bignumber=r(104),o.boolean=r(105),o.complex=r(106),o.fraction=r(107),o.index=r(108),o.matrix=r(109),o.number=r(110),o.sparse=r(111),o.string=r(112),o.unit=r(113),o.e=r(114),o.E=r(114),o.false=r(115),o.i=r(116),o.Infinity=r(117),o.LN2=r(118),o.LN10=r(119),o.LOG2E=r(120),o.LOG10E=r(121),o.NaN=r(122),o.null=r(123),o.pi=r(124),o.PI=r(124),o.phi=r(125),o.SQRT1_2=r(126),o.SQRT2=r(127),o.tau=r(128),o.true=r(129),o.version=r(130),o.speedOfLight={description:"Speed of light in vacuum",examples:["speedOfLight"]},o.gravitationConstant={description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},o.planckConstant={description:"Planck constant",examples:["planckConstant"]},o.reducedPlanckConstant={description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},o.magneticConstant={description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},o.electricConstant={description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},o.vacuumImpedance={description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},o.coulomb={description:"Coulomb's constant",examples:["coulomb"]},o.elementaryCharge={description:"Elementary charge",examples:["elementaryCharge"]},o.bohrMagneton={description:"Borh magneton",examples:["bohrMagneton"]},o.conductanceQuantum={description:"Conductance quantum",examples:["conductanceQuantum"]},o.inverseConductanceQuantum={description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},o.magneticFluxQuantum={description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},o.nuclearMagneton={description:"Nuclear magneton",examples:["nuclearMagneton"]},o.klitzing={description:"Von Klitzing constant",examples:["klitzing"]},o.bohrRadius={description:"Borh radius",examples:["bohrRadius"]},o.classicalElectronRadius={description:"Classical electron radius",examples:["classicalElectronRadius"]},o.electronMass={description:"Electron mass",examples:["electronMass"]},o.fermiCoupling={description:"Fermi coupling constant",examples:["fermiCoupling"]},o.fineStructure={description:"Fine-structure constant",examples:["fineStructure"]},o.hartreeEnergy={description:"Hartree energy",examples:["hartreeEnergy"]},o.protonMass={description:"Proton mass",examples:["protonMass"]},o.deuteronMass={description:"Deuteron Mass",examples:["deuteronMass"]},o.neutronMass={description:"Neutron mass",examples:["neutronMass"]},o.quantumOfCirculation={description:"Quantum of circulation",examples:["quantumOfCirculation"]},o.rydberg={description:"Rydberg constant",examples:["rydberg"]},o.thomsonCrossSection={description:"Thomson cross section",examples:["thomsonCrossSection"]},o.weakMixingAngle={description:"Weak mixing angle",examples:["weakMixingAngle"]},o.efimovFactor={description:"Efimov factor",examples:["efimovFactor"]},o.atomicMass={description:"Atomic mass constant",examples:["atomicMass"]},o.avogadro={description:"Avogadro's number",examples:["avogadro"]},o.boltzmann={description:"Boltzmann constant",examples:["boltzmann"]},o.faraday={description:"Faraday constant",examples:["faraday"]},o.firstRadiation={description:"First radiation constant",examples:["firstRadiation"]},o.loschmidt={description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},o.gasConstant={description:"Gas constant",examples:["gasConstant"]},o.molarPlanckConstant={description:"Molar Planck constant",examples:["molarPlanckConstant"]},o.molarVolume={description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},o.sackurTetrode={description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},o.secondRadiation={description:"Second radiation constant",examples:["secondRadiation"]},o.stefanBoltzmann={description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},o.wienDisplacement={description:"Wien displacement law constant",examples:["wienDisplacement"]},o.molarMass={description:"Molar mass constant",examples:["molarMass"]},o.molarMassC12={description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},o.gravity={description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},o.planckLength={description:"Planck length",examples:["planckLength"]},o.planckMass={description:"Planck mass",examples:["planckMass"]},o.planckTime={description:"Planck time",examples:["planckTime"]},o.planckCharge={description:"Planck charge",examples:["planckCharge"]},o.planckTemperature={description:"Planck temperature",examples:["planckTemperature"]},o.lsolve=r(131),o.lup=r(132),o.lusolve=r(133),o.slu=r(134),o.usolve=r(135),o.abs=r(136),o.add=r(137),o.cbrt=r(138),o.ceil=r(139),o.cube=r(140),o.divide=r(141),o.dotDivide=r(142),o.dotMultiply=r(143),o.dotPow=r(144),o.exp=r(145),o.fix=r(146),o.floor=r(147),o.gcd=r(148),o.hypot=r(149),o.lcm=r(150),o.log=r(151),o.log10=r(152),o.mod=r(153),o.multiply=r(154),o.norm=r(155),o.nthRoot=r(156),o.pow=r(157),o.round=r(158),o.sign=r(159),o.sqrt=r(160),o.square=r(161),o.subtract=r(162),o.unaryMinus=r(163),o.unaryPlus=r(164),o.xgcd=r(165),o.bitAnd=r(166),o.bitNot=r(167),o.bitOr=r(168),o.bitXor=r(169),o.leftShift=r(170),o.rightArithShift=r(171),o.rightLogShift=r(172),o.bellNumbers=r(173),o.catalan=r(174),o.composition=r(175),o.stirlingS2=r(176),o.config=r(177),o.import=r(178),o.typed=r(179),o.arg=r(180),o.conj=r(181),o.re=r(182),o.im=r(183),o.eval=r(184),o.help=r(185),o.distance=r(186),o.intersect=r(187),o.and=r(188),o.not=r(189),o.or=r(190),o.xor=r(191),o.concat=r(192),o.cross=r(193),o.det=r(194),o.diag=r(195),o.dot=r(196),o.eye=r(197),o.filter=r(198),o.flatten=r(199),o.forEach=r(200),o.inv=r(201),o.map=r(202),o.ones=r(203),o.partitionSelect=r(204),o.range=r(205),o.resize=r(206),o.size=r(207),o.sort=r(208),o.squeeze=r(209),o.subset=r(210),o.trace=r(211),o.transpose=r(212),o.zeros=r(213),o.combinations=r(214),o.factorial=r(215),o.gamma=r(216),o.kldivergence=r(217),o.multinomial=r(218),o.permutations=r(219),o.pickRandom=r(220),o.random=r(221),o.randomInt=r(222),o.compare=r(223),o.deepEqual=r(224),o.equal=r(225),o.larger=r(226),o.largerEq=r(227),o.smaller=r(228),o.smallerEq=r(229),o.unequal=r(230),o.erf=r(231),o.max=r(232),o.mean=r(233),o.median=r(234),o.min=r(235),o.mode=r(236),o.prod=r(237),o.quantileSeq=r(238),o.std=r(239),o.sum=r(240),o.var=r(241),o.acos=r(242),o.acosh=r(243),o.acot=r(244),o.acoth=r(245),o.acsc=r(246),o.acsch=r(247),o.asec=r(248),o.asech=r(249),o.asin=r(250),o.asinh=r(251),o.atan=r(252),o.atanh=r(253),o.atan2=r(254),o.cos=r(255),o.cosh=r(256),o.cot=r(257),o.coth=r(258),o.csc=r(259),o.csch=r(260),o.sec=r(261),o.sech=r(262),o.sin=r(263),o.sinh=r(264),o.tan=r(265),o.tanh=r(266),o.to=r(267),o.clone=r(268),o.format=r(269),o.isNaN=r(270),o.isInteger=r(271),o.isNegative=r(272),o.isNumeric=r(273),o.isPositive=r(274),o.isPrime=r(275),o.isZero=r(276),o.typeof=r(277),o}e.name="docs",e.path="expression",e.factory=i},function(t,e){t.exports={name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","complex","fraction","index","matrix","string","unit"]}},function(t,e){t.exports={name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]}},function(t,e){t.exports={name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]}},function(t,e){t.exports={name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(num,den)"],description:"Create a fraction from a number or from a numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]}},function(t,e){t.exports={name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["[]","[1, 2, 3]","A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[0:2, 0:2] = ones(2, 2)"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]}},function(t,e){t.exports={name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]}},function(t,e){t.exports={name:"number",category:"Construction",syntax:["x","number(x)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number("52cm", "m")'],seealso:["bignumber","boolean","complex","fraction","index","matrix","string","unit"]}},function(t,e){t.exports={name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]}},function(t,e){t.exports={name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]}},function(t,e){t.exports={name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]}},function(t,e){t.exports={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]}},function(t,e){t.exports={name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]}},function(t,e){t.exports={name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]}},function(t,e){t.exports={name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]}},function(t,e){t.exports={name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]}},function(t,e){t.exports={name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]}},function(t,e){t.exports={name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]}},function(t,e){t.exports={name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]}},function(t,e){t.exports={name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]}},function(t,e){t.exports={name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]}},function(t,e){t.exports={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]}},function(t,e){t.exports={name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["tau"],seealso:[]}},function(t,e){t.exports={name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]}},function(t,e){t.exports={name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]}},function(t,e){t.exports={name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]}},function(t,e){t.exports={name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]}},function(t,e){t.exports={name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]}},function(t,e){t.exports={name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Solves the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lup","lusolve","usolve","matrix","sparse"]}},function(t,e){t.exports={name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu"]}},function(t,e){t.exports={name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]}},function(t,e){t.exports={name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup"]}},function(t,e){t.exports={name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Solves the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["lup","lusolve","lsolve","matrix","sparse"]}},function(t,e){t.exports={name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]}},function(t,e){t.exports={name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]}},function(t,e){t.exports={name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",
examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]}},function(t,e){t.exports={name:"ceil",category:"Arithmetic",syntax:["ceil(x)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)"],seealso:["floor","fix","round"]}},function(t,e){t.exports={name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]}},function(t,e){t.exports={name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]}},function(t,e){t.exports={name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]}},function(t,e){t.exports={name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]}},function(t,e){t.exports={name:"dotpow",category:"Operators",syntax:["x .^ y","dotpow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]}},function(t,e){t.exports={name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["pow","log"]}},function(t,e){t.exports={name:"fix",category:"Arithmetic",syntax:["fix(x)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)"],seealso:["ceil","floor","round"]}},function(t,e){t.exports={name:"floor",category:"Arithmetic",syntax:["floor(x)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)"],seealso:["ceil","fix","round"]}},function(t,e){t.exports={name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]}},function(t,e){t.exports={name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenusa of a list with values. ",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]}},function(t,e){t.exports={name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]}},function(t,e){t.exports={name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log10"]}},function(t,e){t.exports={name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]}},function(t,e){t.exports={name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","function isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]}},function(t,e){t.exports={name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]}},function(t,e){t.exports={name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i))","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)","norm([[1, 2], [3, 4]], 'inf')","norm([[1, 2], [3, 4]], 'fro')"]}},function(t,e){t.exports={name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["sqrt","pow"]}},function(t,e){t.exports={name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3 = 8","2*2*2","1 + e ^ (pi * i)"],seealso:["multiply"]}},function(t,e){t.exports={name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)"],seealso:["ceil","floor","fix"]}},function(t,e){t.exports={name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>1, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]}},function(t,e){t.exports={name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","multiply"]}},function(t,e){t.exports={name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]}},function(t,e){t.exports={name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]}},function(t,e){t.exports={name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]}},function(t,e){t.exports={name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]}},function(t,e){t.exports={name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]}},function(t,e){t.exports={name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"rightArithShift",category:"Bitwise",syntax:["x >> y","leftShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]}},function(t,e){t.exports={name:"rightLogShift",category:"Bitwise",syntax:["x >> y","leftShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]}},function(t,e){t.exports={name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]}},function(t,e){t.exports={name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]}},function(t,e){t.exports={name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]}},function(t,e){t.exports={name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]}},function(t,e){t.exports={name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]}},function(t,e){t.exports={name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]}},function(t,e){t.exports={name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number, number": f(x)=x+x })',"double(2)",'double("hello")'],seealso:[]}},function(t,e){t.exports={name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]}},function(t,e){t.exports={name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]}},function(t,e){t.exports={name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]}},function(t,e){t.exports={name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]}},function(t,e){t.exports={name:"eval",category:"Expression",syntax:["eval(expression)","eval([expr1, expr2, expr3, ...])"],description:"Evaluate an expression or an array with expressions.",examples:['eval("2 + 3")','eval("sqrt(" + 4 + ")")'],seealso:[]}},function(t,e){t.exports={name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]}},function(t,e){t.exports={name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]}},function(t,e){t.exports={name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]}},function(t,e){t.exports={name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]}},function(t,e){t.exports={name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]}},function(t,e){t.exports={name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]}},function(t,e){t.exports={name:"xor",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 or 4"],seealso:["not","and","or"]}},function(t,e){t.exports={name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]}},function(t,e){t.exports={name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"dot",category:"Matrix",syntax:["dot(A, B)"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]}},function(t,e){t.exports={name:"eye",category:"Matrix",syntax:["eye(n)","eye(m, n)","eye([m, n])","eye"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["eye(3)","eye(3, 5)","a = [1, 2, 3; 4, 5, 6]","eye(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]}},function(t,e){t.exports={name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]}},function(t,e){t.exports={name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["forEach([1, 2, 3], function(val) { console.log(val) })"],seealso:["map","sort","filter"]}},function(t,e){t.exports={name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","eye","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"map",category:"Matrix",syntax:["map(x, callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array.",examples:["map([1, 2, 3], function(val) { return value * value })"],seealso:["filter","forEach"]}},function(t,e){t.exports={name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])","ones"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","eye","inv","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1)'],seealso:["sort"]}},function(t,e){t.exports={name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","eye","inv","ones","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze"]}},function(t,e){t.exports={name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","det","diag","eye","inv","ones","range","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc" or "desc", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"])',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)'],seealso:["map","filter","forEach"]}},function(t,e){t.exports={name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","eye","inv","ones","range","size","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of a matrix or string. Indexes are one-based. Both the ranges lower-bound and upper-bound are included.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","trace","transpose","zeros"]}},function(t,e){t.exports={name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","transpose","zeros"]}},function(t,e){t.exports={name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","zeros"]}},function(t,e){t.exports={name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])","zeros"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose"]}},function(t,e){t.exports={name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["permutations","factorial"]}},function(t,e){t.exports={name:"factorial",category:"Probability",syntax:["kldivergence(x, y)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","permutations","gamma"]}},function(t,e){t.exports={name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]}},function(t,e){t.exports={name:"kldivergence",category:"Probability",syntax:["n!","factorial(n)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["math.kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]}},function(t,e){t.exports={name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai <= 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]}},function(t,e){t.exports={name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","factorial"]}},function(t,e){t.exports={name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]}},function(t,e){t.exports={name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]}},function(t,e){t.exports={name:"randInt",category:"Probability",syntax:["randInt(max)","randInt(min, max)","randInt(size)","randInt(size, max)","randInt(size, min, max)"],description:"Return a random integer number",examples:["randInt(10, 20)","randInt([2, 3], 10)"],seealso:["pickRandom","random"]}},function(t,e){t.exports={name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 if x is larger than y, -1 if x is smaller than y, and 0 if x and y are equal.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq"]}},function(t,e){t.exports={name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["[1,3,4] == [1,3,4]","[1,3,4] == [1,3]"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]}},function(t,e){t.exports={name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(t,e){t.exports={name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]}},function(t,e){t.exports={name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 > 1+1","2 >= 1+1","a = 3.2","b = 6-2.8","(a > b)"],seealso:["equal","unequal","smallerEq","smaller","largerEq","compare"]}},function(t,e){t.exports={name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]}},function(t,e){t.exports={name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 1+1","2 <= 1+1","a = 3.2","b = 6-2.8","(a < b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]}},function(t,e){t.exports={name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(t,e){t.exports={name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]}},function(t,e){t.exports={name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dim)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dim)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dim)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","var"]}},function(t,e){t.exports={name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(5, 2, 7)","mode([3, -1, 5, 7])"],seealso:["max","mean","min","median","prod","std","sum","var"]}},function(t,e){t.exports={name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],
seealso:["max","mean","min","median","min","std","sum","var"]}},function(t,e){t.exports={name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probablity are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","var"]}},function(t,e){t.exports={name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(var(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","sum","var"]}},function(t,e){t.exports={name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"var",category:"Statistics",syntax:["var(a, b, c, ...)","var(A)","var(A, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["var(2, 4, 6)","var([2, 4, 6, 8])",'var([2, 4, 6, 8], "uncorrected")','var([2, 4, 6, 8], "biased")',"var([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]}},function(t,e){t.exports={name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]}},function(t,e){t.exports={name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]}},function(t,e){t.exports={name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]}},function(t,e){t.exports={name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the hyperbolic arccotangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(0.5)"],seealso:["acsch","asech"]}},function(t,e){t.exports={name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(0.5)","acsc(csc(0.5))","acsc(2)"],seealso:["csc","asin","asec"]}},function(t,e){t.exports={name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the hyperbolic arccosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]}},function(t,e){t.exports={name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]}},function(t,e){t.exports={name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]}},function(t,e){t.exports={name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(2.3))"],seealso:["sin","acos","atan"]}},function(t,e){t.exports={name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]}},function(t,e){t.exports={name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(2.3))"],seealso:["tan","acos","asin"]}},function(t,e){t.exports={name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]}},function(t,e){t.exports={name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]}},function(t,e){t.exports={name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]}},function(t,e){t.exports={name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]}},function(t,e){t.exports={name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]}},function(t,e){t.exports={name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]}},function(t,e){t.exports={name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]}},function(t,e){t.exports={name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]}},function(t,e){t.exports={name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]}},function(t,e){t.exports={name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]}},function(t,e){t.exports={name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]}},function(t,e){t.exports={name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]}},function(t,e){t.exports={name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]}},function(t,e){t.exports={name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]}},function(t,e){t.exports={name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]}},function(t,e){t.exports={name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables,and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]}},function(t,e){t.exports={name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]}},function(t,e){t.exports={name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]}},function(t,e){t.exports={name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]}},function(t,e){t.exports={name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]}},function(t,e){t.exports={name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)","isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))",'isNumeric("3")',"isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN"]}},function(t,e){t.exports={name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]}},function(t,e){t.exports={name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]}},function(t,e){t.exports={name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]}},function(t,e){t.exports={name:"typeof",category:"Utils",syntax:["typeof(x)"],description:"Get the type of a variable.",examples:["typeof(3.5)","typeof(2 - 4i)","typeof(45 deg)",'typeof("hello world")'],seealso:[]}},function(t,e,r){t.exports=[r(279),r(302),r(303),r(304),r(305)]},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(280));return o("compile",{string:function(t){return a(t).compile()},"Array | Matrix":function(t){return n(t,function(t){return a(t).compile()})}})}var n=r(19);e.name="compile",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){if(1!=arguments.length&&2!=arguments.length)throw new n("parse",arguments.length,1,2);if(dt=r&&r.nodes?r.nodes:{},"string"==typeof e)return pt=e,y();if(Array.isArray(e)||e instanceof t.Matrix)return o(e,function(t){if("string"!=typeof t)throw new TypeError("String expected");return pt=t,y()});throw new TypeError("String or matrix expected")}function l(){mt=0,yt=pt.charAt(0),Et=0,wt=null}function u(){mt++,yt=pt.charAt(mt)}function c(){return pt.charAt(mt-1)}function h(){return pt.charAt(mt+1)}function f(){return pt.charAt(mt+2)}function d(){for(bt=ct.NULL,vt="",gt="";s.isWhitespace(yt,Et);)u();if("#"==yt)for(;"\n"!=yt&&""!=yt;)gt+=yt,u();if(""==yt)return void(bt=ct.DELIMITER);if("\n"==yt&&!Et)return bt=ct.DELIMITER,vt=yt,void u();var t=yt+h(),e=t+f();if(3==e.length&&ht[e])return bt=ct.DELIMITER,vt=e,u(),u(),void u();if(2==t.length&&ht[t])return bt=ct.DELIMITER,vt=t,u(),void u();if(ht[yt])return bt=ct.DELIMITER,vt=yt,void u();if(!s.isDigitDot(yt)){if(s.isAlpha(yt,c(),h())){for(;s.isAlpha(yt,c(),h())||s.isDigit(yt);)vt+=yt,u();return void(bt=ft.hasOwnProperty(vt)?ct.DELIMITER:ct.SYMBOL)}for(bt=ct.UNKNOWN;""!=yt;)vt+=yt,u();throw H('Syntax error in part "'+vt+'"')}if(bt=ct.NUMBER,"."==yt)vt+=yt,u(),s.isDigit(yt)||(bt=ct.DELIMITER);else{for(;s.isDigit(yt);)vt+=yt,u();s.isDecimalMark(yt,h())&&(vt+=yt,u())}for(;s.isDigit(yt);)vt+=yt,u();if(t=h(),"E"==yt||"e"==yt)if(s.isDigit(t)||"-"==t||"+"==t){if(vt+=yt,u(),"+"!=yt&&"-"!=yt||(vt+=yt,u()),!s.isDigit(yt))throw H('Digit expected, got "'+yt+'"');for(;s.isDigit(yt);)vt+=yt,u();if(s.isDecimalMark(yt,h()))throw H('Digit expected, got "'+yt+'"')}else if("."==t)throw u(),H('Digit expected, got "'+yt+'"')}function p(){do d();while("\n"==vt)}function g(){Et++}function m(){Et--}function y(){l(),d();var t=v();if(""!=vt)throw bt==ct.DELIMITER?$("Unexpected operator "+vt):H('Unexpected part "'+vt+'"');return t}function v(){var t,e,r=[];if(""==vt)return t=new et("undefined","undefined"),t.comment=gt,t;for("\n"!=vt&&";"!=vt&&(t=b(),t.comment=gt);"\n"==vt||";"==vt;)0==r.length&&t&&(e=";"!=vt,r.push({node:t,visible:e})),d(),"\n"!=vt&&";"!=vt&&""!=vt&&(t=b(),t.comment=gt,e=";"!=vt,r.push({node:t,visible:e}));return r.length>0?new Q(r):t}function b(){var t,e,r,i,n=E();if("="==vt){if(n&&n.isSymbolNode)return t=n.name,p(),r=b(),new J(new ut(t),r);if(n&&n.isAccessorNode)return p(),r=b(),new J(n.object,n.index,r);if(n&&n.isFunctionNode&&(i=!0,e=[],t=n.name,n.args.forEach(function(t,r){t&&t.isSymbolNode?e[r]=t.name:i=!1}),i))return p(),r=b(),new rt(t,e,r);throw H("Invalid left hand side of assignment operator =")}return n}function E(){for(var t=w();"?"==vt;){var e=wt;wt=Et,p();var r=t,i=b();if(":"!=vt)throw H("False part of conditional expression expected");wt=null,p();var n=b();t=new tt(r,i,n),wt=e}return t}function w(){for(var t=_();"or"==vt;)p(),t=new ot("or","or",[t,_()]);return t}function _(){for(var t=x();"xor"==vt;)p(),t=new ot("xor","xor",[t,x()]);return t}function x(){for(var t=S();"and"==vt;)p(),t=new ot("and","and",[t,S()]);return t}function S(){for(var t=T();"|"==vt;)p(),t=new ot("|","bitOr",[t,T()]);return t}function T(){for(var t=M();"^|"==vt;)p(),t=new ot("^|","bitXor",[t,M()]);return t}function M(){for(var t=L();"&"==vt;)p(),t=new ot("&","bitAnd",[t,L()]);return t}function L(){var t,e,r,i,n;for(t=A(),e={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};vt in e;)r=vt,i=e[r],p(),n=[t,A()],t=new ot(r,i,n);return t}function A(){var t,e,r,i,n;for(t=N(),e={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};vt in e;)r=vt,i=e[r],p(),n=[t,N()],t=new ot(r,i,n);return t}function N(){var t,e,r,i,n;for(t=C(),e={to:"to",in:"to"};vt in e;)r=vt,i=e[r],p(),"in"===r&&""===vt?t=new ot("*","multiply",[t,new ut("in")],!0):(n=[t,C()],t=new ot(r,i,n));return t}function C(){var t,e=[];if(t=":"==vt?new et("1","number"):R(),":"==vt&&wt!==Et){for(e.push(t);":"==vt&&e.length<3;)p(),")"==vt||"]"==vt||","==vt||""==vt?e.push(new ut("end")):e.push(R());t=3==e.length?new lt(e[0],e[2],e[1]):new lt(e[0],e[1])}return t}function R(){var t,e,r,i,n;for(t=P(),e={"+":"add","-":"subtract"};vt in e;)r=vt,i=e[r],p(),n=[t,P()],t=new ot(r,i,n);return t}function P(){var t,e,r,i,n;for(t=O(),e=t,r={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};;)if(vt in r)i=vt,n=r[i],p(),e=O(),t=new ot(i,n,[t,e]);else{if(!(bt==ct.SYMBOL||"in"==vt&&t&&t.isConstantNode)&&(bt!=ct.NUMBER||e.isConstantNode||e.isOperatorNode&&"!"!==e.op)&&"("!=vt)break;e=O(),t=new ot("*","multiply",[t,e],!0)}return t}function O(){var t,e,r={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"}[vt];return r?(t=vt,p(),e=[O()],new ot(t,r,e)):I()}function I(){var t,e,r,i;return t=k(),"^"!=vt&&".^"!=vt||(e=vt,r="^"==e?"pow":"dotPow",p(),i=[t,O()],t=new ot(e,r,i)),t}function k(){var t,e,r,i,n;for(t=D(),e={"!":"factorial","'":"transpose"};vt in e;)r=vt,i=e[r],d(),n=[t],t=new ot(r,i,n),t=F(t);return t}function D(){var t,e=[];if(bt==ct.SYMBOL&&dt[vt]){if(t=dt[vt],d(),"("==vt){if(e=[],g(),d(),")"!=vt)for(e.push(b());","==vt;)d(),e.push(b());if(")"!=vt)throw H("Parenthesis ) expected");m(),d()}return new t(e)}return V()}function V(){var t,e;return bt==ct.SYMBOL||bt==ct.DELIMITER&&vt in ft?(e=vt,d(),t=new ut(e),t=F(t)):G()}function F(t,e){for(var r;!("("!=vt&&"["!=vt&&"."!=vt||e&&e.indexOf(vt)===-1);)if(r=[],"("==vt){if(!t.isSymbolNode&&!t.isAccessorNode)return t;if(g(),d(),")"!=vt)for(r.push(b());","==vt;)d(),r.push(b());if(")"!=vt)throw H("Parenthesis ) expected");m(),d(),t=new st(t,r)}else if("["==vt){if(g(),d(),"]"!=vt)for(r.push(b());","==vt;)d(),r.push(b());if("]"!=vt)throw H("Parenthesis ] expected");m(),d(),t=new Y(t,new it(r))}else{if(d(),bt!=ct.SYMBOL)throw H("Property name expected after dot");r.push(new et(vt)),d();var i=!0;t=new Y(t,new it(r,i))}return t}function G(){var t,e;return'"'==vt?(e=B(),t=new et(e,"string"),t=F(t)):W()}function B(){for(var t="";""!=yt&&'"'!=yt;)"\\"==yt&&(t+=yt,u()),t+=yt,u();if(d(),'"'!=vt)throw H('End of string " expected');return d(),t}function W(){var t,e,r,i;if("["==vt){if(g(),d(),"]"!=vt){var n=U();if(";"==vt){for(r=1,e=[n];";"==vt;)d(),e[r]=U(),r++;if("]"!=vt)throw H("End of matrix ] expected");m(),d(),i=e[0].items.length;for(var o=1;o<r;o++)if(e[o].items.length!=i)throw $("Column dimensions mismatch ("+e[o].items.length+" != "+i+")");t=new X(e)}else{if("]"!=vt)throw H("End of matrix ] expected");m(),d(),t=n}}else m(),d(),t=new X([]);return F(t)}return z()}function U(){for(var t=[b()],e=1;","==vt;)d(),t[e]=b(),e++;return new X(t)}function z(){if("{"==vt){var t,e={};do if(d(),"}"!=vt){if('"'==vt)t=B();else{if(bt!=ct.SYMBOL)throw H("Symbol or string expected as object key");t=vt,d()}if(":"!=vt)throw H("Colon : expected after object key");d(),e[t]=b()}while(","==vt);if("}"!=vt)throw H("Comma , or bracket } expected after object value");d();var r=new nt(e);return r=F(r)}return j()}function j(){var t;return bt==ct.NUMBER?(t=vt,d(),new et(t,"number")):K()}function K(){var t;if("("==vt){if(g(),d(),t=b(),")"!=vt)throw H("Parenthesis ) expected");return m(),d(),t=new at(t),t=F(t)}return q()}function q(){throw H(""==vt?"Unexpected end of expression":"Value expected")}function Z(){return mt-vt.length+1}function H(t){var e=Z(),r=new SyntaxError(t+" (char "+e+")");return r.char=e,r}function $(t){var e=Z(),r=new SyntaxError(t+" (char "+e+")");return r.char=e,r}var Y=i(r(281)),X=i(r(287)),J=i(r(288)),Q=i(r(291)),tt=i(r(292)),et=i(r(293)),rt=i(r(294)),it=i(r(295)),nt=i(r(298)),ot=i(r(299)),at=i(r(301)),st=i(r(300)),lt=i(r(296)),ut=i(r(297)),ct={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},ht={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"'":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},ft={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},dt={},pt="",gt="",mt=0,yt="",vt="",bt=ct.NULL,Et=0,wt=null;return s.isAlpha=function(t,e,r){return s.isValidLatinOrGreek(t)||s.isValidMathSymbol(t,r)||s.isValidMathSymbol(e,t)},s.isValidLatinOrGreek=function(t){return/^[a-zA-Z_\u00C0-\u02AF\u0370-\u03FF]$/.test(t)},s.isValidMathSymbol=function(t,e){return/^[\uD835]$/.test(t)&&/^[\uDC00-\uDFFF]$/.test(e)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(e)},s.isWhitespace=function(t,e){return" "==t||"\t"==t||"\n"==t&&e>0},s.isDecimalMark=function(t,e){return"."==t&&"/"!==e&&"*"!==e&&"^"!==e},s.isDigitDot=function(t){return t>="0"&&t<="9"||"."==t},s.isDigit=function(t){return t>="0"&&t<="9"},s}var n=r(11),o=r(19);e.name="parse",e.path="expression",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError('Node expected for parameter "object"');if(!e||!e.isIndexNode)throw new TypeError('IndexNode expected for parameter "index"');this.object=t||null,this.index=e,Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function a(t){return!(t.isAccessorNode||t.isArrayNode||t.isConstantNode||t.isFunctionNode||t.isObjectNode||t.isParenthesisNode||t.isSymbolNode)}var s=i(r(282)),l=i(r(284));return o.prototype=new s,o.prototype.type="AccessorNode",o.prototype.isAccessorNode=!0,o.prototype._compile=function(t,e){t.access=l;var r=this.object._compile(t,e),i=this.index._compile(t,e);return this.index.isObjectProperty()?r+'["'+this.index.getObjectProperty()+'"]':this.index.needsSize()?"(function () {  var object = "+r+";  var size = math.size(object).valueOf();  return access(object, "+i+");})()":"access("+r+", "+i+")"},o.prototype.forEach=function(t){t(this.object,"object",this),t(this.index,"index",this)},o.prototype.map=function(t){return new o(this._ifNode(t(this.object,"object",this)),this._ifNode(t(this.index,"index",this)))},o.prototype.clone=function(){return new o(this.object,this.index)},o.prototype._toString=function(t){var e=this.object.toString(t);return a(this.object)&&(e="("+e+")"),e+this.index.toString(t)},o.prototype._toTex=function(t){var e=this.object.toTex(t);return a(this.object)&&(e="\\left("+e+"\\right)"),e+this.index.toTex(t)},o}e.name="AccessorNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i,a){function s(){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator")}function l(t){for(var e in t)if(t.hasOwnProperty(e)&&e in n)throw new Error('Scope contains an illegal symbol, "'+e+'" is a reserved keyword')}return s.prototype.eval=function(t){return this.compile().eval(t)},s.prototype.type="Node",s.prototype.isNode=!0,s.prototype.comment="",s.prototype.compile=function(){if(arguments.length>0)throw new Error("Calling compile(math) is deprecated. Call the function as compile() instead.");var t={math:a.expression.transform,args:{},_validateScope:l},e={},r=this._compile(t,e),i=Object.keys(t).map(function(t){return"    var "+t+' = defs["'+t+'"];'}),n=i.join(" ")+'return {  "eval": function (scope) {    if (scope) _validateScope(scope);    scope = scope || {};    return '+r+";  }};",o=new Function("defs",n);return o(t)},s.prototype._compile=function(t,e){throw new Error("Cannot compile a Node interface")},s.prototype.forEach=function(t){throw new Error("Cannot run forEach on a Node interface")},s.prototype.map=function(t){throw new Error("Cannot run map on a Node interface")},s.prototype._ifNode=function(t){if(!t||!t.isNode)throw new TypeError("Callback function must return a Node");return t},s.prototype.traverse=function(t){function e(t,r){t.forEach(function(t,i,n){r(t,i,n),e(t,r)})}t(this,null,null),e(this,t)},s.prototype.transform=function(t){function e(t,r){return t.map(function(t,i,n){var o=r(t,i,n);return e(o,r)})}var r=t(this,null,null);return e(r,t)},s.prototype.filter=function(t){var e=[];return this.traverse(function(r,i,n){t(r,i,n)&&e.push(r)}),e},s.prototype.find=function(){throw new Error("Function Node.find is deprecated. Use Node.filter instead.")},s.prototype.match=function(){throw new Error("Function Node.match is deprecated. See functions Node.filter, Node.transform, Node.traverse.")},s.prototype.clone=function(){throw new Error("Cannot clone a Node interface")},s.prototype.equals=function(t){return!!t&&o(this,t)},s.prototype.toString=function(t){var e;if(t&&"object"==typeof t)switch(typeof t.handler){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return"undefined"!=typeof e?e:this._toString(t)},s.prototype._toString=function(){throw new Error("_toString not implemented for "+this.type)},s.prototype.toTex=function(t){var e;if(t&&"object"==typeof t)switch(typeof t.handler){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return"undefined"!=typeof e?e:this._toTex(t)},s.prototype._toTex=function(t){throw new Error("_toTex not implemented for "+this.type)},s.prototype.getIdentifier=function(){return this.type},s.prototype.getContent=function(){return this},s}var n=r(283),o=(r(3).extend,r(3).deepEqual);e.name="Node",e.path="expression.node",e.math=!0,e.factory=i},function(t,e){"use strict";t.exports={end:!0}},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(286)),s=i(r(52));return function(t,e){try{if(Array.isArray(t))return s(t).subset(e).valueOf();if(t&&"function"==typeof t.subset)return t.subset(e);if("string"==typeof t)return a(t,e);if("object"==typeof t){if(!e.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return t[e.getObjectProperty()]}throw new TypeError("Cannot apply index: unsupported type of object")}catch(t){throw n(t)}}}var n=r(285).transform;e.factory=i},function(t,e,r){var i=r(43);e.transform=function(t){return t&&t.isIndexError?new i(t.index+1,t.min+1,void 0!==t.max?t.max+1:void 0):t}},function(t,e,r){"use strict";function i(t,e,i,u){function c(t,e){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(1!=e.size().length)throw new l(e.size().length,1);var r=t.length;s(e.min()[0],r),s(e.max()[0],r);var i=e.dimension(0),n="";return i.forEach(function(e){n+=t.charAt(e)}),n}function h(t,e,r,i){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(1!=e.size().length)throw new l(e.size().length,1);if(void 0!==i){if("string"!=typeof i||1!==i.length)throw new TypeError("Single character expected as defaultValue")}else i=" ";var n=e.dimension(0),o=n.size()[0];if(o!=r.length)throw new l(n.size()[0],r.length);var a=t.length;s(e.min()[0]),s(e.max()[0]);for(var u=[],c=0;c<a;c++)u[c]=t.charAt(c);if(n.forEach(function(t,e){u[t]=r.charAt(e[0])}),u.length>a)for(c=a-1,o=u.length;c<o;c++)u[c]||(u[c]=i);return u.join("")}var f=i(r(52)),d=u("subset",{"Array, Index":function(t,e){var r=f(t),i=r.subset(e);return i&&i.valueOf()},"Matrix, Index":function(t,e){return t.subset(e)},"Object, Index":n,"string, Index":c,"Array, Index, any":function(t,e,r){return f(a(t)).subset(e,r,void 0).valueOf()},"Array, Index, any, any":function(t,e,r,i){return f(a(t)).subset(e,r,i).valueOf()},"Matrix, Index, any":function(t,e,r){return t.clone().subset(e,r)},"Matrix, Index, any, any":function(t,e,r,i){return t.clone().subset(e,r,i)},"string, Index, string":h,"string, Index, string, string":h,"Object, Index, any":o});return d.toTex=void 0,d}function n(t,e){if(1!==e.size().length)throw new l(e.size(),1);var r=e.dimension(0);if("string"!=typeof r)throw new TypeError("String expected as index to retrieve an object property");return t[r]}function o(t,e,r){if(1!==e.size().length)throw new l(e.size(),1);var i=e.dimension(0);if("string"!=typeof i)throw new TypeError("String expected as index to retrieve an object property");var n=a(t);return n[i]=r,n}var a=r(3).clone,s=r(40).validateIndex,l=r(42);e.name="subset",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.items=t||[],!Array.isArray(this.items)||!this.items.every(function(t){return t&&t.isNode}))throw new TypeError("Array containing Nodes expected");var e=function(){throw new Error("Property `ArrayNode.nodes` is deprecated, use `ArrayNode.items` instead")};Object.defineProperty(this,"nodes",{get:e,set:e})}var a=i(r(282));return o.prototype=new a,o.prototype.type="ArrayNode",o.prototype.isArrayNode=!0,o.prototype._compile=function(t,e){var r="Array"!==t.math.config().matrix,i=this.items.map(function(r){return r._compile(t,e)});return(r?"math.matrix([":"[")+i.join(",")+(r?"])":"]")},o.prototype.forEach=function(t){for(var e=0;e<this.items.length;e++){var r=this.items[e];t(r,"items["+e+"]",this)}},o.prototype.map=function(t){for(var e=[],r=0;r<this.items.length;r++)e[r]=this._ifNode(t(this.items[r],"items["+r+"]",this));return new o(e)},o.prototype.clone=function(){return new o(this.items.slice(0))},o.prototype._toString=function(t){var e=this.items.map(function(e){return e.toString(t)});return"["+e.join(", ")+"]"},o.prototype._toTex=function(t){var e="\\begin{bmatrix}";return this.items.forEach(function(r){e+=r.items?r.items.map(function(e){return e.toTex(t)}).join("&"):r.toTex(t),e+="\\\\"}),e+="\\end{bmatrix}"},o}e.name="ArrayNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e,r){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.object=t,this.index=r?e:null,this.value=r?r:e,!t||!t.isSymbolNode&&!t.isAccessorNode)throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(t&&t.isSymbolNode&&"end"===t.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!this.index.isIndexNode)throw new TypeError('IndexNode expected as "index"');if(!this.value||!this.value.isNode)throw new TypeError('Node expected as "value"');Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function a(t,e){e||(e="keep");var r=c.getPrecedence(t,e),i=c.getPrecedence(t.value,e);return"all"===e||null!==i&&i<=r}var s=i(r(282)),l=(i(r(287)),i(r(52)),i(r(289))),u=i(r(284)),c=(r(283),r(290));return o.prototype=new s,o.prototype.type="AssignmentNode",o.prototype.isAssignmentNode=!0,o.prototype._compile=function(t,e){t.assign=l,t.access=u;var r,i=this.object._compile(t,e),n=this.index?this.index._compile(t,e):null,o=this.value._compile(t,e);if(this.index){if(this.index.isObjectProperty())return i+'["'+this.index.getObjectProperty()+'"] = '+o;if(this.object.isSymbolNode)return r=this.index.needsSize()?"var size = math.size(object).valueOf();":"","(function () {  var object = "+i+";  var value = "+o+";  "+r+'  scope["'+this.object.name+'"] = assign(object, '+n+", value);  return value;})()";r=this.index.needsSize()?"var size = math.size(object).valueOf();":"";var a=this.object.object._compile(t,e);if(this.object.index.isObjectProperty()){var s='["'+this.object.index.getObjectProperty()+'"]';return"(function () {  var parent = "+a+";  var object = parent"+s+";  var value = "+o+";"+r+"  parent"+s+" = assign(object, "+n+", value);  return value;})()"}var c=this.object.index.needsSize()?"var size = math.size(parent).valueOf();":"",h=this.object.index._compile(t,e);return"(function () {  var parent = "+a+";  "+c+"  var parentIndex = "+h+";  var object = access(parent, parentIndex);  var value = "+o+";  "+r+"  assign(parent, parentIndex, assign(object, "+n+", value));  return value;})()"}if(!this.object.isSymbolNode)throw new TypeError("SymbolNode expected as object");return'scope["'+this.object.name+'"] = '+o},o.prototype.forEach=function(t){t(this.object,"object",this),this.index&&t(this.index,"index",this),t(this.value,"value",this)},o.prototype.map=function(t){var e=this._ifNode(t(this.object,"object",this)),r=this.index?this._ifNode(t(this.index,"index",this)):null,i=this._ifNode(t(this.value,"value",this));return new o(e,r,i)},o.prototype.clone=function(){return new o(this.object,this.index,this.value)},o.prototype._toString=function(t){var e=this.object.toString(t),r=this.index?this.index.toString(t):"",i=this.value.toString(t);return a(this,t&&t.parenthesis)&&(i="("+i+")"),e+r+" = "+i},o.prototype._toTex=function(t){var e=this.object.toTex(t),r=this.index?this.index.toTex(t):"",i=this.value.toTex(t);
return a(this,t&&t.parenthesis)&&(i="\\left("+i+"\\right)"),e+r+":="+i},o}r(32);e.name="AssignmentNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(286)),s=i(r(52));return function(t,e,r){try{if(Array.isArray(t))return s(t).subset(e,r).valueOf();if(t&&"function"==typeof t.subset)return t.subset(e,r);if("string"==typeof t)return a(t,e,r);if("object"==typeof t){if(!e.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return t[e.getObjectProperty()]=r,t}throw new TypeError("Cannot apply index: unsupported type of object")}catch(t){throw n(t)}}}var n=r(285).transform;e.factory=i},function(t,e){"use strict";function r(t,e){var r=t;"keep"!==e&&(r=t.getContent());for(var i=r.getIdentifier(),n=0;n<o.length;n++)if(i in o[n])return n;return null}function i(t,e){var i=t;"keep"!==e&&(i=t.getContent());var n=i.getIdentifier(),a=r(i,e);if(null===a)return null;var s=o[a][n];if(s.hasOwnProperty("associativity")){if("left"===s.associativity)return"left";if("right"===s.associativity)return"right";throw Error("'"+n+"' has the invalid associativity '"+s.associativity+"'.")}return null}function n(t,e,i){var n=t,a=e;if("keep"!==i)var n=t.getContent(),a=e.getContent();var s=n.getIdentifier(),l=a.getIdentifier(),u=r(n,i);if(null===u)return null;var c=o[u][s];if(c.hasOwnProperty("associativeWith")&&c.associativeWith instanceof Array){for(var h=0;h<c.associativeWith.length;h++)if(c.associativeWith[h]===l)return!0;return!1}return null}var o=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{associativity:"left",associativeWith:[]}},{"OperatorNode:and":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{associativity:"left",associativeWith:[]},"OperatorNode:unequal":{associativity:"left",associativeWith:[]},"OperatorNode:smaller":{associativity:"left",associativeWith:[]},"OperatorNode:larger":{associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{associativity:"left",associativeWith:[]}},{"OperatorNode:to":{associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{associativity:"left",associativeWith:[]},"OperatorNode:mod":{associativity:"left",associativeWith:[]}},{"OperatorNode:unaryPlus":{associativity:"right"},"OperatorNode:unaryMinus":{associativity:"right"},"OperatorNode:bitNot":{associativity:"right"},"OperatorNode:not":{associativity:"right"}},{"OperatorNode:pow":{associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{associativity:"left"}},{"OperatorNode:transpose":{associativity:"left"}}];t.exports.properties=o,t.exports.getPrecedence=r,t.exports.getAssociativity=i,t.exports.isAssociativeWith=n},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(t))throw new Error("Array expected");this.blocks=t.map(function(t){var e=t&&t.node,r=!t||void 0===t.visible||t.visible;if(!e||!e.isNode)throw new TypeError('Property "node" must be a Node');if("boolean"!=typeof r)throw new TypeError('Property "visible" must be a boolean');return{node:e,visible:r}})}var a=i(r(282)),s=i(r(72));return o.prototype=new a,o.prototype.type="BlockNode",o.prototype.isBlockNode=!0,o.prototype._compile=function(t,e){t.ResultSet=s;var r=this.blocks.map(function(r){var i=r.node._compile(t,e);return r.visible?"results.push("+i+");":i+";"});return"(function () {var results = [];"+r.join("")+"return new ResultSet(results);})()"},o.prototype.forEach=function(t){for(var e=0;e<this.blocks.length;e++)t(this.blocks[e].node,"blocks["+e+"].node",this)},o.prototype.map=function(t){for(var e=[],r=0;r<this.blocks.length;r++){var i=this.blocks[r],n=this._ifNode(t(i.node,"blocks["+r+"].node",this));e[r]={node:n,visible:i.visible}}return new o(e)},o.prototype.clone=function(){var t=this.blocks.map(function(t){return{node:t.node,visible:t.visible}});return new o(t)},o.prototype._toString=function(t){return this.blocks.map(function(e){return e.node.toString(t)+(e.visible?"":";")}).join("\n")},o.prototype._toTex=function(t){return this.blocks.map(function(e){return e.node.toTex(t)+(e.visible?"":";")}).join("\\;\\;\n")},o}e.name="BlockNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e,r){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError("Parameter condition must be a Node");if(!e||!e.isNode)throw new TypeError("Parameter trueExpr must be a Node");if(!r||!r.isNode)throw new TypeError("Parameter falseExpr must be a Node");this.condition=t,this.trueExpr=e,this.falseExpr=r}var s=i(r(282));return a.prototype=new s,a.prototype.type="ConditionalNode",a.prototype.isConditionalNode=!0,a.prototype._compile=function(t,e){return t.testCondition=function(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e)return!!e;if(e){if(e.isBigNumber===!0)return!e.isZero();if(e.isComplex===!0)return!(!e.re&&!e.im);if(e.isUnit===!0)return!!e.value}if(null===e||void 0===e)return!1;throw new TypeError('Unsupported type of condition "'+t.math.typeof(e)+'"')},"testCondition("+this.condition._compile(t,e)+") ? ( "+this.trueExpr._compile(t,e)+") : ( "+this.falseExpr._compile(t,e)+")"},a.prototype.forEach=function(t){t(this.condition,"condition",this),t(this.trueExpr,"trueExpr",this),t(this.falseExpr,"falseExpr",this)},a.prototype.map=function(t){return new a(this._ifNode(t(this.condition,"condition",this)),this._ifNode(t(this.trueExpr,"trueExpr",this)),this._ifNode(t(this.falseExpr,"falseExpr",this)))},a.prototype.clone=function(){return new a(this.condition,this.trueExpr,this.falseExpr)},a.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=n.getPrecedence(this,e),i=this.condition.toString(t),o=n.getPrecedence(this.condition,e);("all"===e||"OperatorNode"===this.condition.type||null!==o&&o<=r)&&(i="("+i+")");var a=this.trueExpr.toString(t),s=n.getPrecedence(this.trueExpr,e);("all"===e||"OperatorNode"===this.trueExpr.type||null!==s&&s<=r)&&(a="("+a+")");var l=this.falseExpr.toString(t),u=n.getPrecedence(this.falseExpr,e);return("all"===e||"OperatorNode"===this.falseExpr.type||null!==u&&u<=r)&&(l="("+l+")"),i+" ? "+a+" : "+l},a.prototype._toTex=function(t){return"\\begin{cases} {"+this.trueExpr.toTex(t)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(t)+"}\\\\{"+this.falseExpr.toTex(t)+"}, &\\quad{\\text{otherwise}}\\end{cases}"},a}var n=(r(32),r(290));e.name="ConditionalNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(e){if("string"!=typeof e)throw new TypeError('String expected for parameter "valueType"');if("string"!=typeof t)throw new TypeError('String expected for parameter "value"');this.value=t,this.valueType=e}else this.value=t+"",this.valueType=n(t);if(!l[this.valueType])throw new TypeError('Unsupported type of value "'+this.valueType+'"')}var s=i(r(282)),l={number:!0,string:!0,boolean:!0,undefined:!0,null:!0};return a.prototype=new s,a.prototype.type="ConstantNode",a.prototype.isConstantNode=!0,a.prototype._compile=function(t,e){switch(this.valueType){case"number":var r=t.math.config().number;return"BigNumber"===r?'math.bignumber("'+this.value+'")':"Fraction"===r?'math.fraction("'+this.value+'")':this.value.replace(/^(0*)[0-9]/,function(t,e){return t.substring(e.length)});case"string":return'"'+this.value+'"';case"boolean":return this.value;case"undefined":return this.value;case"null":return this.value;default:throw new TypeError('Unsupported type of constant "'+this.valueType+'"')}},a.prototype.forEach=function(t){},a.prototype.map=function(t){return this.clone()},a.prototype.clone=function(){return new a(this.value,this.valueType)},a.prototype._toString=function(t){switch(this.valueType){case"string":return'"'+this.value+'"';default:return this.value}},a.prototype._toTex=function(t){var e,r=this.value;switch(this.valueType){case"string":return'\\mathtt{"'+r+'"}';case"number":return e=r.toLowerCase().indexOf("e"),e!==-1?r.substring(0,e)+"\\cdot10^{"+r.substring(e+1)+"}":r;default:return r}},a}var n=r(41).type;e.name="ConstantNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,s){function l(t,e,r){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(e))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!r||!r.isNode)throw new TypeError('Node expected for parameter "expr"');if(t in n)throw new Error('Illegal function name, "'+t+'" is a reserved keyword');this.name=t,this.params=e.map(function(t){return t&&t.name||t}),this.types=e.map(function(t){return t&&t.type||"any"}),this.expr=r}function u(t,e){var r=a.getPrecedence(t,e),i=a.getPrecedence(t.expr,e);return"all"===e||null!==i&&i<=r}var c=i(r(282));return l.prototype=new c,l.prototype.type="FunctionAssignmentNode",l.prototype.isFunctionAssignmentNode=!0,l.prototype._compile=function(t,e){t.typed=s;var r=Object.create(e);this.params.forEach(function(t){r[t]=!0});var i=this.expr._compile(t,r);return'scope["'+this.name+'"] =   (function () {    var fn = typed("'+this.name+'", {      "'+this.types.join(",")+'": function ('+this.params.join(",")+") {        return "+i+'      }    });    fn.syntax = "'+this.name+"("+this.params.join(", ")+')";    return fn;  })()'},l.prototype.forEach=function(t){t(this.expr,"expr",this)},l.prototype.map=function(t){var e=this._ifNode(t(this.expr,"expr",this));return new l(this.name,this.params.slice(0),e)},l.prototype.clone=function(){return new l(this.name,this.params.slice(0),this.expr)},l.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=this.expr.toString(t);return u(this,e)&&(r="("+r+")"),"function "+this.name+"("+this.params.join(", ")+") = "+r},l.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=this.expr.toTex(t);return u(this,e)&&(r="\\left("+r+"\\right)"),"\\mathrm{"+this.name+"}\\left("+this.params.map(o.toSymbol).join(",")+"\\right):="+r},l}var n=r(283),o=r(32),a=r(290);e.name="FunctionAssignmentNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.dimensions=t,this.dotNotation=e||!1,!l(t)||!t.every(function(t){return t&&t.isNode}))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties");var r=function(){throw new Error("Property `IndexNode.object` is deprecated, use `IndexNode.fn` instead")};Object.defineProperty(this,"object",{get:r,set:r})}var a=i(r(282)),s=(i(r(296)),i(r(297)),i(r(67))),l=Array.isArray;return o.prototype=new a,o.prototype.type="IndexNode",o.prototype.isIndexNode=!0,o.prototype._compile=function(t,e){var r=Object.create(e);t.range=function(t,e,r){return new s(t&&t.isBigNumber===!0?t.toNumber():t,e&&e.isBigNumber===!0?e.toNumber():e,r&&r.isBigNumber===!0?r.toNumber():r)};var i=this.dimensions.map(function(e,i){return e&&e.isRangeNode?e.needsEnd()?(r.end=!0,"(function () {var end = size["+i+"]; return range("+e.start._compile(t,r)+", "+e.end._compile(t,r)+", "+(e.step?e.step._compile(t,r):"1")+"); })()"):"range("+e.start._compile(t,r)+", "+e.end._compile(t,r)+", "+(e.step?e.step._compile(t,r):"1")+")":e.isSymbolNode&&"end"===e.name?(r.end=!0,"(function () {var end = size["+i+"]; return "+e._compile(t,r)+"; })()"):e._compile(t,r)});return"math.index("+i.join(", ")+")"},o.prototype.forEach=function(t){for(var e=0;e<this.dimensions.length;e++)t(this.dimensions[e],"dimensions["+e+"]",this)},o.prototype.map=function(t){for(var e=[],r=0;r<this.dimensions.length;r++)e[r]=this._ifNode(t(this.dimensions[r],"dimensions["+r+"]",this));return new o(e)},o.prototype.clone=function(){return new o(this.dimensions.slice(0))},o.prototype.isObjectProperty=function(){return 1===this.dimensions.length&&this.dimensions[0].isConstantNode&&"string"===this.dimensions[0].valueType},o.prototype.getObjectProperty=function(){return this.isObjectProperty()?this.dimensions[0].value:null},o.prototype._toString=function(t){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"},o.prototype._toTex=function(t){var e=this.dimensions.map(function(e){return e.toTex(t)});return this.dotNotation?"."+this.getObjectProperty():"_{"+e.join(",")+"}"},o.prototype.needsSize=function(){return this.dimensions.some(function(t){return t.isRangeNode&&t.needsEnd()||t.isSymbolNode&&"end"===t.name})},o}e.name="IndexNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e,r){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError("Node expected");if(!e||!e.isNode)throw new TypeError("Node expected");if(r&&(!r||!r.isNode))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=t,this.end=e,this.step=r||null}function s(t,e){var r=n.getPrecedence(t,e),i={},o=n.getPrecedence(t.start,e);if(i.start=null!==o&&o<=r||"all"===e,t.step){var a=n.getPrecedence(t.step,e);i.step=null!==a&&a<=r||"all"===e}var s=n.getPrecedence(t.end,e);return i.end=null!==s&&s<=r||"all"===e,i}var l=i(r(282));return a.prototype=new l,a.prototype.type="RangeNode",a.prototype.isRangeNode=!0,a.prototype.needsEnd=function(){var t=this.filter(function(t){return t&&t.isSymbolNode&&"end"==t.name});return t.length>0},a.prototype._compile=function(t,e){return"math.range("+this.start._compile(t,e)+", "+this.end._compile(t,e)+(this.step?", "+this.step._compile(t,e):"")+")"},a.prototype.forEach=function(t){t(this.start,"start",this),t(this.end,"end",this),this.step&&t(this.step,"step",this)},a.prototype.map=function(t){return new a(this._ifNode(t(this.start,"start",this)),this._ifNode(t(this.end,"end",this)),this.step&&this._ifNode(t(this.step,"step",this)))},a.prototype.clone=function(){return new a(this.start,this.end,this.step&&this.step)},a.prototype._toString=function(t){var e,r=t&&t.parenthesis?t.parenthesis:"keep",i=s(this,r),n=this.start.toString(t);if(i.start&&(n="("+n+")"),e=n,this.step){var o=this.step.toString(t);i.step&&(o="("+o+")"),e+=":"+o}var a=this.end.toString(t);return i.end&&(a="("+a+")"),e+=":"+a},a.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=s(this,e),i=this.start.toTex(t);if(r.start&&(i="\\left("+i+"\\right)"),this.step){var n=this.step.toTex(t);r.step&&(n="\\left("+n+"\\right)"),i+=":"+n}var o=this.end.toTex(t);return r.end&&(o="\\left("+o+"\\right)"),i+=":"+o},a}var n=r(290);e.name="RangeNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o,a){function s(t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('String expected for parameter "name"');this.name=t}function l(t){throw new Error("Undefined symbol "+t)}var u=i(r(282)),c=i(r(75));return s.prototype=new u,s.prototype.type="SymbolNode",s.prototype.isSymbolNode=!0,s.prototype._compile=function(t,e){return t.undef=l,t.Unit=c,e[this.name]?this.name:this.name in t.math?'("'+this.name+'" in scope ? scope["'+this.name+'"] : math["'+this.name+'"])':'("'+this.name+'" in scope ? scope["'+this.name+'"] : '+(c.isValuelessUnit(this.name)?'new Unit(null, "'+this.name+'")':'undef("'+this.name+'")')+")"},s.prototype.forEach=function(t){},s.prototype.map=function(t){return this.clone()},s.prototype.clone=function(){return new s(this.name)},s.prototype._toString=function(t){return this.name},s.prototype._toTex=function(t){var e=!1;"undefined"==typeof a[this.name]&&c.isValuelessUnit(this.name)&&(e=!0);var r=n.toSymbol(this.name,e);return"\\"===r[0]?r:" "+r},s}var n=r(32);e.name="SymbolNode",e.path="expression.node",e.math=!0,e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.properties=t||{},t&&("object"!=typeof t||Object.keys(t).some(function(e){return!t[e]||!t[e].isNode})))throw new TypeError("Object containing Nodes expected")}var a=i(r(282));return o.prototype=new a,o.prototype.type="ObjectNode",o.prototype.isObjectNode=!0,o.prototype._compile=function(t,e){var r=[];for(var i in this.properties)this.properties.hasOwnProperty(i)&&r.push('"'+i+'": '+this.properties[i]._compile(t,e));return"{"+r.join(", ")+"}"},o.prototype.forEach=function(t){for(var e in this.properties)this.properties.hasOwnProperty(e)&&t(this.properties[e],'properties["'+e+'"]',this)},o.prototype.map=function(t){var e={};for(var r in this.properties)this.properties.hasOwnProperty(r)&&(e[r]=this._ifNode(t(this.properties[r],'properties["'+r+'"]',this)));return new o(e)},o.prototype.clone=function(){var t={};for(var e in this.properties)this.properties.hasOwnProperty(e)&&(t[e]=this.properties[e]);return new o(t)},o.prototype._toString=function(t){var e=[];for(var r in this.properties)this.properties.hasOwnProperty(r)&&e.push('"'+r+'": '+this.properties[r].toString(t));return"{"+e.join(", ")+"}"},o.prototype._toTex=function(t){var e=[];for(var r in this.properties)this.properties.hasOwnProperty(r)&&e.push("\\mathbf{"+r+":} & "+this.properties[r].toTex(t)+"\\\\");return"\\left\\{\\begin{array}{ll}"+e.join("\n")+"\\end{array}\\right\\}"},o}r(23);e.name="ObjectNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a,s){function l(t,e,r,i){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('string expected for parameter "op"');if("string"!=typeof e)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(r)||!r.every(function(t){return t&&t.isNode}))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=i===!0,this.op=t,this.fn=e,this.args=r||[]}function u(t,e,r,i){var n=o.getPrecedence(t,e),a=o.getAssociativity(t,e);if("all"===e||r.length>2){var s=[];return r.forEach(function(t){switch(t.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":s.push(!1);break;default:s.push(!0)}}),s}switch(r.length){case 0:return[];case 1:var l=o.getPrecedence(r[0],e);if(i&&null!==l){var u,c;if("keep"===e?(u=r[0].getIdentifier(),c=t.getIdentifier()):(u=r[0].getContent().getIdentifier(),c=t.getContent().getIdentifier()),o.properties[n][c].latexLeftParens===!1)return[!1];if(o.properties[l][u].latexParens===!1)return[!1]}return null===l?[!1]:l<=n?[!0]:[!1];case 2:var h,f=o.getPrecedence(r[0],e),d=o.isAssociativeWith(t,r[0],e);h=null!==f&&(f===n&&"right"===a&&!d||f<n);var p,g=o.getPrecedence(r[1],e),m=o.isAssociativeWith(t,r[1],e);if(p=null!==g&&(g===n&&"left"===a&&!m||g<n),i){var c,y,v;"keep"===e?(c=t.getIdentifier(),y=t.args[0].getIdentifier(),v=t.args[1].getIdentifier()):(c=t.getContent().getIdentifier(),y=t.args[0].getContent().getIdentifier(),v=t.args[1].getContent().getIdentifier()),null!==f&&(o.properties[n][c].latexLeftParens===!1&&(h=!1),o.properties[f][y].latexParens===!1&&(h=!1)),null!==g&&(o.properties[n][c].latexRightParens===!1&&(p=!1),o.properties[g][v].latexParens===!1&&(p=!1))}return[h,p]}}var c=i(r(282));i(r(293)),i(r(297)),i(r(300));return l.prototype=new c,l.prototype.type="OperatorNode",l.prototype.isOperatorNode=!0,l.prototype._compile=function(t,e){if(!t.math[this.fn])throw new Error("Function "+this.fn+' missing in provided namespace "math"');var r=this.args.map(function(r){return r._compile(t,e)});return"math."+this.fn+"("+r.join(", ")+")"},l.prototype.forEach=function(t){for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},l.prototype.map=function(t){for(var e=[],r=0;r<this.args.length;r++)e[r]=this._ifNode(t(this.args[r],"args["+r+"]",this));return new l(this.op,this.fn,e)},l.prototype.clone=function(){return new l(this.op,this.fn,this.args.slice(0))},l.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=t&&t.implicit?t.implicit:"hide",i=this.args,n=u(this,e,i,!1);switch(i.length){case 1:var a=o.getAssociativity(this,e),s=i[0].toString(t);return n[0]&&(s="("+s+")"),"right"===a?this.op+s:"left"===a?s+this.op:s+this.op;case 2:var l=i[0].toString(t),c=i[1].toString(t);return n[0]&&(l="("+l+")"),n[1]&&(c="("+c+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"==r?l+" "+c:l+" "+this.op+" "+c;default:return this.fn+"("+this.args.join(", ")+")"}},l.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=t&&t.implicit?t.implicit:"hide",i=this.args,a=u(this,e,i,!0),s=n.operators[this.fn];switch(s="undefined"==typeof s?this.op:s,i.length){case 1:var l=o.getAssociativity(this,e),c=i[0].toTex(t);return a[0]&&(c="\\left("+c+"\\right)"),"right"===l?s+c:"left"===l?c+s:c+s;case 2:var h=i[0],f=h.toTex(t);a[0]&&(f="\\left("+f+"\\right)");var d=i[1],p=d.toTex(t);a[1]&&(p="\\left("+p+"\\right)");var g;switch(g="keep"===e?h.getIdentifier():h.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return s+"{"+f+"}{"+p+"}";case"OperatorNode:pow":switch(f="{"+f+"}",p="{"+p+"}",g){case"ConditionalNode":case"OperatorNode:divide":f="\\left("+f+"\\right)"}case"OperatorNode:multiply":if(this.implicit&&"hide"===r)return f+"~"+p}return f+s+p;default:return"\\mathrm{"+this.fn+"}\\left("+i.map(function(e){return e.toTex(t)}).join(",")+"\\right)"}},l.prototype.getIdentifier=function(){return this.type+":"+this.fn},l}var n=r(32),o=r(290);e.name="OperatorNode",e.path="expression.node",e.math=!0,e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o,a){function s(t,e){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if("string"==typeof t&&(console.warn("WARNING: passing a string to FunctionNode is deprecated, pass a SymbolNode instead."),t=new c(t)),!t||!t.isNode)throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(e)||!e.every(function(t){return t&&t.isNode}))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=t,this.args=e||[],Object.defineProperty(this,"name",{get:function(){return this.fn.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}});var r=function(){throw new Error("Property `FunctionNode.object` is deprecated, use `FunctionNode.fn` instead")};Object.defineProperty(this,"object",{get:r,set:r})}function l(t,e,r){for(var i,n="",o=new RegExp("\\$(?:\\{([a-z_][a-z_0-9]*)(?:\\[([0-9]+)\\])?\\}|\\$)","ig"),a=0;null!==(i=o.exec(t));)if(n+=t.substring(a,i.index),a=i.index,"$$"===i[0])n+="$",a++;else{a+=i[0].length;var s=e[i[1]];if(!s)throw new ReferenceError("Template: Property "+i[1]+" does not exist.");if(void 0===i[2])switch(typeof s){case"string":n+=s;break;case"object":if(s.isNode)n+=s.toTex(r);else{if(!Array.isArray(s))throw new TypeError("Template: "+i[1]+" has to be a Node, String or array of Nodes");n+=s.map(function(t,e){if(t&&t.isNode)return t.toTex(r);throw new TypeError("Template: "+i[1]+"["+e+"] is not a Node.")}).join(",")}break;default:throw new TypeError("Template: "+i[1]+" has to be a Node, String or array of Nodes")}else{if(!s[i[2]]||!s[i[2]].isNode)throw new TypeError("Template: "+i[1]+"["+i[2]+"] is not a Node.");n+=s[i[2]].toTex(r)}}return n+=t.slice(a)}var u=i(r(282)),c=i(r(297));s.prototype=new u,s.prototype.type="FunctionNode",s.prototype.isFunctionNode=!0,s.prototype._compile=function(t,e){var r,i=this.fn._compile(t,e),n=this.args.map(function(r){return r._compile(t,e)});if(this.fn.isSymbolNode){var o=this.fn.name,a=t.math[o],s="function"==typeof a&&1==a.rawArgs;return s?(r=this._getUniqueArgumentsName(t),t[r]=this.args,i+"("+r+", math, scope)"):i+"("+n.join(", ")+")"}if(this.fn.isAccessorNode&&this.fn.index.isObjectProperty()){r=this._getUniqueArgumentsName(t),t[r]=this.args;var l=this.fn.object._compile(t,e),u=this.fn.index.getObjectProperty();return"(function () {var object = "+l+';return (object["'+u+'"] && object["'+u+'"].rawArgs)  ? object["'+u+'"]('+r+', math, scope) : object["'+u+'"]('+n.join(", ")+")})()"}return r=this._getUniqueArgumentsName(t),t[r]=this.args,"(function () {var fn = "+i+";return (fn && fn.rawArgs)  ? fn("+r+", math, scope) : fn("+n.join(", ")+")})()"},s.prototype._getUniqueArgumentsName=function(t){var e,r=0;do e="args"+r,r++;while(e in t);return e},s.prototype.forEach=function(t){for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},s.prototype.map=function(t){for(var e=this.fn.map(t),r=[],i=0;i<this.args.length;i++)r[i]=this._ifNode(t(this.args[i],"args["+i+"]",this));return new s(e,r)},s.prototype.clone=function(){return new s(this.fn,this.args.slice(0))};var h=s.prototype.toString;s.prototype.toString=function(t){var e,r=this.fn.toString(t);return t&&"object"==typeof t.handler&&t.handler.hasOwnProperty(r)&&(e=t.handler[r](this,t)),"undefined"!=typeof e?e:h.call(this,t)},s.prototype._toString=function(t){var e=this.args.map(function(e){return e.toString(t)});return this.fn.toString(t)+"("+e.join(", ")+")"};var f=s.prototype.toTex;return s.prototype.toTex=function(t){var e;return t&&"object"==typeof t.handler&&t.handler.hasOwnProperty(this.name)&&(e=t.handler[this.name](this,t)),"undefined"!=typeof e?e:f.call(this,t)},s.prototype._toTex=function(t){var e,r=this.args.map(function(e){return e.toTex(t)});!a[this.name]||"function"!=typeof a[this.name].toTex&&"object"!=typeof a[this.name].toTex&&"string"!=typeof a[this.name].toTex||(e=a[this.name].toTex);var i;switch(typeof e){case"function":i=e(this,t);break;case"string":i=l(e,this,t);break;case"object":switch(typeof e[r.length]){case"function":i=e[r.length](this,t);break;case"string":i=l(e[r.length],this,t)}}return"undefined"!=typeof i?i:l(n.defaultTemplate,this,t)},s.prototype.getIdentifier=function(){return this.type+":"+this.name},s}var n=r(32);e.name="FunctionNode",e.path="expression.node",e.math=!0,e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError('Node expected for parameter "content"');this.content=t}var a=i(r(282));return o.prototype=new a,o.prototype.type="ParenthesisNode",o.prototype.isParenthesisNode=!0,o.prototype._compile=function(t,e){return this.content._compile(t,e)},o.prototype.getContent=function(){return this.content.getContent()},o.prototype.forEach=function(t){t(this.content,"content",this)},o.prototype.map=function(t){var e=t(this.content,"content",this);return new o(e)},o.prototype.clone=function(){return new o(this.content)},o.prototype._toString=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"("+this.content.toString(t)+")":this.content.toString(t)},o.prototype._toTex=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"\\left("+this.content.toTex(t)+"\\right)":this.content.toTex(t)},o}e.name="ParenthesisNode",e.path="expression.node",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(280));return o("compile",{string:function(t){var e={};return a(t).compile().eval(e)},"string, Object":function(t,e){return a(t).compile().eval(e)},"Array | Matrix":function(t){var e={};return n(t,function(t){return a(t).compile().eval(e)})},"Array | Matrix, Object":function(t,e){return n(t,function(t){return a(t).compile().eval(e)})}})}var n=r(19);e.name="eval",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n,o){var a=i(r(103));return n("help",{any:function(e){var r,i=e;if("string"!=typeof e)for(r in o)if(o.hasOwnProperty(r)&&e===o[r]){i=r;break}var n=a[i];if(!n)throw new Error('No documentation found on "'+i+'"');return new t.Help(n)}})}e.math=!0,e.name="help",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(280));return n("parse",{"string | Array | Matrix":o,"string | Array | Matrix, Object":o})}e.name="parse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n,o){var a=i(r(306));return n("parser",{"":function(){return new a(o)}})}e.name="parser",e.factory=i,e.math=!0},function(t,e,r){"use strict";function i(t,e,i,o,a){function s(){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");this.scope={}}var l=i(r(280));return s.prototype.type="Parser",s.prototype.isParser=!0,s.prototype.parse=function(t){throw new Error("Parser.parse is deprecated. Use math.parse instead.")},s.prototype.compile=function(t){throw new Error("Parser.compile is deprecated. Use math.compile instead.")},s.prototype.eval=function(t){return l(t).compile().eval(this.scope)},s.prototype.get=function(t){return this.scope[t]},s.prototype.getAll=function(){return n({},this.scope)},s.prototype.set=function(t,e){return this.scope[t]=e},s.prototype.remove=function(t){delete this.scope[t]},s.prototype.clear=function(){for(var t in this.scope)this.scope.hasOwnProperty(t)&&delete this.scope[t]},s}var n=r(3).extend;e.name="Parser",e.path="expression",e.factory=i,e.math=!0},function(t,e,r){t.exports=[r(281),r(287),r(288),r(291),r(292),r(293),r(295),r(294),r(300),r(282),r(298),r(299),r(301),r(296),r(297),r(308)]},function(t,e){"use strict";function r(t,e,r,i){function n(){throw new Error("UpdateNode is deprecated. Use AssignmentNode instead.")}return n}e.name="UpdateNode",e.path="expression.node",e.factory=r},function(t,e,r){t.exports=[r(310),r(312),r(314),r(316),r(317),r(319),r(325),r(330),r(332),r(334)]},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(311));return o("concat",{"...any":function(t){var e=t.length-1,r=t[e];"number"==typeof r?t[e]=r-1:r&&r.isBigNumber===!0&&(t[e]=r.minus(1));try{return a.apply(null,t)}catch(t){throw n(t)}}})}var n=r(285).transform;e.name="concat",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,c){var h=i(r(52)),f=c("concat",{"...Array | Matrix | number | BigNumber":function(t){var e,r,i=t.length,c=-1,f=!1,d=[];for(e=0;e<i;e++){var p=t[e];if(p&&p.isMatrix===!0&&(f=!0),"number"==typeof p||p&&p.isBigNumber===!0){if(e!==i-1)throw new Error("Dimension must be specified as last argument");if(r=c,c=p.valueOf(),!a(c))throw new TypeError("Integer number expected for dimension");
if(c<0||e>0&&c>r)throw new l(c,r+1)}else{var g=o(p).valueOf(),m=s.size(g);if(d[e]=g,r=c,c=m.length-1,e>0&&c!=r)throw new u(r+1,c+1)}}if(0==d.length)throw new SyntaxError("At least one matrix expected");for(var y=d.shift();d.length;)y=n(y,d.shift(),c,0);return f?h(y):y},"...string":function(t){return t.join("")}});return f.toTex=void 0,f}function n(t,e,r,i){if(i<r){if(t.length!=e.length)throw new u(t.length,e.length);for(var o=[],a=0;a<t.length;a++)o[a]=n(t[a],e[a],r,i+1);return o}return t.concat(e)}var o=r(3).clone,a=r(6).isInteger,s=r(40),l=r(43),u=r(42);e.name="concat",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e,r){var i,n;if(t[0]&&(i=t[0].compile().eval(r)),t[1])if(t[1]&&t[1].isSymbolNode)n=t[1].compile().eval(r);else{var o=r||{},s=t[1].filter(function(t){return t&&t.isSymbolNode&&!(t.name in e)&&!(t.name in o)})[0],l=Object.create(o),u=t[1].compile();if(!s)throw new Error("No undefined variable found in filter equation");var c=s.name;n=function(t){return l[c]=t,u.eval(l)}}return a(i,n)}var a=i(r(313));i(r(297));return o.rawArgs=!0,o}r(45).maxArgumentCount;e.name="filter",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=a("filter",{"Array, function":n,"Array, RegExp":o,"Matrix, function":function(t,e){return s(n(t.toArray(),e))},"Matrix, RegExp":function(t,e){return s(o(t.toArray(),e))}});return l.toTex=void 0,l}function n(t,e){if(1!==a(t).length)throw new Error("Only one dimensional matrices supported");var r=s(e);return t.filter(function(t,i,n){return 1===r?e(t):2===r?e(t,[i]):e(t,[i],n)})}function o(t,e){if(1!==a(t).length)throw new Error("Only one dimensional matrices supported");return t.filter(function(t){return e.test(t)})}var a=r(40).size,s=r(45).maxArgumentCount;e.name="filter",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){i(r(315));return o("forEach",{"Array | Matrix, function":function(t,e){var r=n(e),i=function(n,o){Array.isArray(n)?n.forEach(function(t,e){i(t,o.concat(e+1))}):1===r?e(n):2===r?e(n,o):e(n,o,t)};i(t.valueOf(),[])}})}var n=r(45).maxArgumentCount;e.name="forEach",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("forEach",{"Array, function":n,"Matrix, function":function(t,e){return t.forEach(e)}});return o.toTex=void 0,o}function n(t,e){var r=o(e),i=function(n,o){Array.isArray(n)?n.forEach(function(t,e){i(t,o.concat(e))}):1===r?e(n):2===r?e(n,o):e(n,o,t)};i(t,[])}var o=r(45).maxArgumentCount;e.name="forEach",e.factory=i},function(t,e){"use strict";function r(t,e,r){return function(){for(var e=[],r=0,i=arguments.length;r<i;r++){var n=arguments[r];if(n&&n.isRange===!0)n.start--,n.end-=n.step>0?0:2;else if(n&&n.isSet===!0)n=n.map(function(t){return t-1});else if(n&&(n.isArray===!0||n.isMatrix))n=n.map(function(t){return t-1});else if("number"==typeof n)n--;else if(n&&n.isBigNumber===!0)n=n.toNumber()-1;else if("string"!=typeof n)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");e[r]=n}var o=new t.Index;return t.Index.apply(o,e),o}}e.name="index",e.path="expression.transform",e.factory=r},function(t,e,r){"use strict";function i(t,e,i,o){var a=(i(r(318)),i(r(52)));return o("max",{"Array, function":function(t,e){return n(t,e,t)},"Matrix, function":function(t,e){return a(n(t.valueOf(),e,t))}})}function n(t,e,r){function i(t,o){return Array.isArray(t)?t.map(function(t,e){return i(t,o.concat(e+1))}):1===n?e(t):2===n?e(t,o):e(t,o,r)}var n=o(e);return i(t,[])}var o=r(45).maxArgumentCount;e.name="map",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("map",{"Array, function":n,"Matrix, function":function(t,e){return t.map(e)}});return o.toTex=void 0,o}function n(t,e){var r=o(e),i=function(n,o){return Array.isArray(n)?n.map(function(t,e){return i(t,o.concat(e))}):1===r?e(n):2===r?e(n,o):e(n,o,t)};return i(t,[])}var o=r(45).maxArgumentCount;e.name="map",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(321));return a("max",{"...any":function(t){if(2==t.length&&o(t[0])){var e=t[1];"number"==typeof e?t[1]=e-1:e&&e.isBigNumber===!0&&(t[1]=e.minus(1))}try{return s.apply(null,t)}catch(t){throw n(t)}}})}var n=r(285).transform,o=r(320);e.name="max",e.path="expression.transform",e.factory=i},function(t,e){"use strict";t.exports=function(t){return Array.isArray(t)||t&&t.isMatrix===!0}},function(t,e,r){"use strict";function i(t,e,i,s){function l(t,e){return c(t,e)?t:e}function u(t){var e=void 0;if(n(t,function(t){(void 0===e||c(t,e))&&(e=t)}),void 0===e)throw new Error("Cannot calculate max of an empty array");return e}var c=i(r(64)),h=s("max",{"Array | Matrix":u,"Array | Matrix, number | BigNumber":function(t,e){return o(t,e.valueOf(),l)},"...":function(t){if(a(t))throw new TypeError("Scalar values expected in function max");return u(t)}});return h.toTex="\\max\\left(${args}\\right)",h}var n=r(322),o=r(323),a=r(324);e.name="max",e.factory=i},function(t,e){"use strict";t.exports=function t(e,r){e&&e.isMatrix===!0&&(e=e.valueOf());for(var i=0,n=e.length;i<n;i++){var o=e[i];Array.isArray(o)?t(o,r):r(o)}}},function(t,e,r){"use strict";function i(t,e,r){var o,a,s,l;if(e<=0){if(Array.isArray(t[0])){for(l=n(t),a=[],o=0;o<l.length;o++)a[o]=i(l[o],e-1,r);return a}for(s=t[0],o=1;o<t.length;o++)s=r(s,t[o]);return s}for(a=[],o=0;o<t.length;o++)a[o]=i(t[o],e-1,r);return a}function n(t){var e,r,i=t.length,n=t[0].length,o=[];for(r=0;r<n;r++){var a=[];for(e=0;e<i;e++)a.push(t[e][r]);o.push(a)}return o}var o=r(40).size,a=r(43);t.exports=function(t,e,r){var n=Array.isArray(t)?o(t):t.size();if(e<0||e>=n.length)throw new a(e,n.length);return t&&t.isMatrix===!0?t.create(i(t.valueOf(),e,r)):i(t,e,r)}},function(t,e,r){"use strict";var i=r(320);t.exports=function(t){for(var e=0;e<t.length;e++)if(i(t[e]))return!0;return!1}},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(326));return a("mean",{"...any":function(t){if(2==t.length&&o(t[0])){var e=t[1];"number"==typeof e?t[1]=e-1:e&&e.isBigNumber===!0&&(t[1]=e.minus(1))}try{return s.apply(null,t)}catch(t){throw n(t)}}})}var n=r(285).transform,o=r(320);e.name="mean",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,l){function u(t,e){var r=a(t,e,h),i=Array.isArray(t)?n(t):t.size();return f(r,i[e])}function c(t){var e=0,r=0;if(o(t,function(t){e=h(e,t),r++}),0===r)throw new Error("Cannot calculate mean of an empty array");return f(e,r)}var h=i(r(51)),f=i(r(327)),d=l("mean",{"Array | Matrix":c,"Array | Matrix, number | BigNumber":u,"...":function(t){if(s(t))throw new TypeError("Scalar values expected in function mean");return c(t)}});return d.toTex=void 0,d}var n=r(40).size,o=r(322),a=r(323),s=r(324);e.name="mean",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(81)),s=i(r(84)),l=i(r(328)),u=i(r(52)),c=i(r(85)),h=i(r(58)),f=o("divide",n({"Array | Matrix, Array | Matrix":function(t,e){return s(t,l(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,a,!1);break;case"dense":r=h(t,e,a,!1)}return r},"Array, any":function(t,e){return h(u(t),e,a,!1).valueOf()},"any, Array | Matrix":function(t,e){return s(t,l(e))}},a.signatures));return f.toTex={2:"\\frac{${args[0]}}{${args[1]}}"},f}var n=r(3).extend;e.name="divide",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e,r){var i,n,o,a,s;if(1==e){if(a=t[0][0],0==a)throw Error("Cannot calculate inverse, determinant is zero");return[[l(1,a)]]}if(2==e){var p=f(t);if(0==p)throw Error("Cannot calculate inverse, determinant is zero");return[[l(t[1][1],p),l(h(t[0][1]),p)],[l(h(t[1][0]),p),l(t[0][0],p)]]}var g=t.concat();for(i=0;i<e;i++)g[i]=g[i].concat();for(var m=d(e).valueOf(),y=0;y<r;y++){for(i=y;i<e&&0==g[i][y];)i++;if(i==e||0==g[i][y])throw Error("Cannot calculate inverse, determinant is zero");i!=y&&(s=g[y],g[y]=g[i],g[i]=s,s=m[y],m[y]=m[i],m[i]=s);var v=g[y],b=m[y];for(i=0;i<e;i++){var E=g[i],w=m[i];if(i!=y){if(0!=E[y]){for(o=l(h(E[y]),v[y]),n=y;n<r;n++)E[n]=u(E[n],c(o,v[n]));for(n=0;n<r;n++)w[n]=u(w[n],c(o,b[n]))}}else{for(o=v[y],n=y;n<r;n++)E[n]=l(E[n],o);for(n=0;n<r;n++)w[n]=l(w[n],o)}}}return m}var s=i(r(52)),l=i(r(81)),u=i(r(53)),c=i(r(84)),h=i(r(78)),f=i(r(329)),d=i(r(83)),p=o("inv",{"Array | Matrix":function(t){var e=t.isMatrix===!0?t.size():n.array.size(t);switch(e.length){case 1:if(1==e[0])return t.isMatrix===!0?s([l(1,t.valueOf()[0])]):[l(1,t[0])];throw new RangeError("Matrix must be square (size: "+n.string.format(e)+")");case 2:var r=e[0],i=e[1];if(r==i)return t.isMatrix===!0?s(a(t.valueOf(),r,i),t.storage()):a(t,r,i);throw new RangeError("Matrix must be square (size: "+n.string.format(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+n.string.format(e)+")")}},any:function(t){return l(1,t)}});return p.toTex={1:"\\left(${args[0]}\\right)^{-1}"},p}var n=r(39);e.name="inv",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function s(t,e,r){if(1==e)return o.clone(t[0][0]);if(2==e)return c(h(t[0][0],t[1][1]),h(t[1][0],t[0][1]));for(var i=function(t){var e,r,i=new Array(t.length),n=0;for(e=1;e<t.length;e++)n=u(n,t[e][e]);for(e=0;e<t.length;e++){for(i[e]=new Array(t.length),i[e][e]=f(n),r=0;r<e;r++)i[e][r]=0;for(r=e+1;r<t.length;r++)i[e][r]=t[e][r];e+1<t.length&&(n=c(n,t[e+1][e+1]))}return i},n=t,a=0;a<e-1;a++)n=h(i(n),t);return e%2==0?f(n[0][0]):n[0][0]}var l=i(r(52)),u=i(r(51)),c=i(r(77)),h=i(r(84)),f=i(r(78)),d=n("det",{any:function(t){return o.clone(t)},"Array | Matrix":function(t){var e;switch(t&&t.isMatrix===!0?e=t.size():Array.isArray(t)?(t=l(t),e=t.size()):e=[],e.length){case 0:return o.clone(t);case 1:if(1==e[0])return o.clone(t.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+a.format(e)+")");case 2:var r=e[0],i=e[1];if(r==i)return s(t.clone().valueOf(),r,i);throw new RangeError("Matrix must be square (size: "+a.format(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+a.format(e)+")")}}});return d.toTex={1:"\\det\\left(${args[0]}\\right)"},d}var n=r(39),o=n.object,a=n.string;e.name="det",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(331));return a("min",{"...any":function(t){if(2==t.length&&o(t[0])){var e=t[1];"number"==typeof e?t[1]=e-1:e&&e.isBigNumber===!0&&(t[1]=e.minus(1))}try{return s.apply(null,t)}catch(t){throw n(t)}}})}var n=r(285).transform,o=r(320);e.name="min",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,s){function l(t,e){return c(t,e)?t:e}function u(t){var e=void 0;if(n(t,function(t){(void 0===e||c(t,e))&&(e=t)}),void 0===e)throw new Error("Cannot calculate min of an empty array");return e}var c=i(r(60)),h=s("min",{"Array | Matrix":u,"Array | Matrix, number | BigNumber":function(t,e){return o(t,e.valueOf(),l)},"...":function(t){if(a(t))throw new TypeError("Scalar values expected in function min");return u(t)}});return h.toTex="\\min\\left(${args}\\right)",h}var n=r(322),o=r(323),a=r(324);e.name="min",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(333));return n("range",{"...any":function(t){var e=t.length-1,r=t[e];return"boolean"!=typeof r&&t.push(!0),o.apply(null,t)}})}e.name="range",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){return"Array"===e.matrix?t:f(t)}function a(r,i){var n=h(r);if(!n)throw new SyntaxError('String "'+r+'" is no valid range');var a;return"BigNumber"===e.number?(a=i?c:u,o(a(new t.BigNumber(n.start),new t.BigNumber(n.end),new t.BigNumber(n.step)))):(a=i?l:s,o(a(n.start,n.end,n.step)))}function s(t,e,r){var i=[],n=t;if(r>0)for(;n<e;)i.push(n),n+=r;else if(r<0)for(;n>e;)i.push(n),n+=r;return i}function l(t,e,r){var i=[],n=t;if(r>0)for(;n<=e;)i.push(n),n+=r;else if(r<0)for(;n>=e;)i.push(n),n+=r;return i}function u(t,e,r){var i=[],n=t;if(r.gt(d))for(;n.lt(e);)i.push(n),n=n.plus(r);else if(r.lt(d))for(;n.gt(e);)i.push(n),n=n.plus(r);return i}function c(t,e,r){var i=[],n=t;if(r.gt(d))for(;n.lte(e);)i.push(n),n=n.plus(r);else if(r.lt(d))for(;n.gte(e);)i.push(n),n=n.plus(r);return i}function h(t){var e=t.split(":"),r=e.map(function(t){return Number(t)}),i=r.some(function(t){return isNaN(t)});if(i)return null;switch(r.length){case 2:return{start:r[0],end:r[1],step:1};case 3:return{start:r[0],end:r[2],step:r[1]};default:return null}}var f=i(r(52)),d=new t.BigNumber(0),p=new t.BigNumber(1),g=n("range",{string:a,"string, boolean":a,"number, number":function(t,e){return o(s(t,e,1))},"number, number, number":function(t,e,r){return o(s(t,e,r))},"number, number, boolean":function(t,e,r){return o(r?l(t,e,1):s(t,e,1))},"number, number, number, boolean":function(t,e,r,i){return o(i?l(t,e,r):s(t,e,r))},"BigNumber, BigNumber":function(t,e){return o(u(t,e,p))},"BigNumber, BigNumber, BigNumber":function(t,e,r){return o(u(t,e,r))},"BigNumber, BigNumber, boolean":function(t,e,r){return o(r?c(t,e,p):u(t,e,p))},"BigNumber, BigNumber, BigNumber, boolean":function(t,e,r,i){return o(i?c(t,e,r):u(t,e,r))}});return g.toTex=void 0,g}e.name="range",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(286));return o("subset",{"...any":function(t){try{return a.apply(null,t)}catch(t){throw n(t)}}})}var n=r(285).transform;e.name="subset",e.path="expression.transform",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(!t)throw new Error('Argument "doc" missing');this.doc=t}var l=i(r(305))();return s.prototype.type="Help",s.prototype.isHelp=!0,s.prototype.toString=function(){var t=this.doc||{},e="\n";if(t.name&&(e+="Name: "+t.name+"\n\n"),t.category&&(e+="Category: "+t.category+"\n\n"),t.description&&(e+="Description:\n    "+t.description+"\n\n"),t.syntax&&(e+="Syntax:\n    "+t.syntax.join("\n    ")+"\n\n"),t.examples){e+="Examples:\n";for(var r=0;r<t.examples.length;r++){var i=t.examples[r];e+="    "+i+"\n";var n;try{n=l.eval(i)}catch(t){n=t}n&&!n.isHelp&&(e+="        "+o.format(n,{precision:14})+"\n")}e+="\n"}return t.seealso&&(e+="See also: "+t.seealso.join(", ")+"\n"),e},s.prototype.toJSON=function(){var t=n.clone(this.doc);return t.mathjs="Help",t},s.fromJSON=function(t){var e={};for(var r in t)"mathjs"!==r&&(e[r]=t[r]);return new s(e)},s.prototype.valueOf=s.prototype.toString,s}var n=r(3),o=r(23);e.name="Help",e.path="type",e.factory=i},function(t,e,r){t.exports=[r(337),r(364),r(395),r(411),r(420),r(425),r(428),r(434),r(446),r(455),r(459),r(461),r(468),r(470),r(496),r(498)]},function(t,e,r){t.exports=[r(338),r(339),r(359),r(361),r(363)]},function(t,e,r){"use strict";function i(t,e,i,n){var a=i(r(52)),s=i(r(86)),l=i(r(53)),u=i(r(81)),c=i(r(80)),h=i(r(77)),f=i(r(64)),d=i(r(48)),p=i(r(78)),g=t.SparseMatrix,m=t.DenseMatrix,y=t.Spa,v=n("lup",{DenseMatrix:function(t){return b(t)},SparseMatrix:function(t){return E(t)},Array:function(t){var e=a(t),r=b(e);return{L:r.L.valueOf(),U:r.U.valueOf(),p:r.p}}}),b=function(t){var e,r,i,n=t._size[0],a=t._size[1],p=Math.min(n,a),g=o.clone(t._data),y=[],v=[n,p],b=[],E=[p,a],w=[];for(e=0;e<n;e++)w[e]=e;for(r=0;r<a;r++){if(r>0)for(e=0;e<n;e++){var _=Math.min(e,r),x=0;for(i=0;i<_;i++)x=l(x,c(g[e][i],g[i][r]));g[e][r]=h(g[e][r],x)}var S=r,T=0,M=0;for(e=r;e<n;e++){var L=g[e][r],A=s(L);f(A,T)&&(S=e,T=A,M=L)}if(r!==S&&(w[r]=[w[S],w[S]=w[r]][0],m._swapRows(r,S,g)),r<n)for(e=r+1;e<n;e++){var N=g[e][r];d(N,0)||(g[e][r]=u(g[e][r],M))}}for(r=0;r<a;r++)for(e=0;e<n;e++)0===r&&(e<a&&(b[e]=[]),y[e]=[]),e<r?(e<a&&(b[e][r]=g[e][r]),r<n&&(y[e][r]=0)):e!==r?(e<a&&(b[e][r]=0),r<n&&(y[e][r]=g[e][r])):(e<a&&(b[e][r]=g[e][r]),r<n&&(y[e][r]=1));var C=new m({data:y,size:v}),R=new m({data:b,size:E}),P=[];for(e=0,p=w.length;e<p;e++)P[w[e]]=e;return{L:C,U:R,p:P,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}},E=function(t){var e,r,i,n=t._size[0],o=t._size[1],a=Math.min(n,o),l=t._values,h=t._index,m=t._ptr,v=[],b=[],E=[],w=[n,a],_=[],x=[],S=[],T=[a,o],M=[],L=[];for(e=0;e<n;e++)M[e]=e,L[e]=e;var A=function(t,e){var r=L[t],i=L[e];M[r]=e,M[i]=t,L[t]=i,L[e]=r};for(r=0;r<o;r++){var N=new y;r<n&&(E.push(v.length),v.push(1),b.push(r)),S.push(_.length);var C=m[r],R=m[r+1];for(i=C;i<R;i++)e=h[i],N.set(M[e],l[i]);r>0&&N.forEach(0,r-1,function(t,e){g._forEachRow(t,v,b,E,function(r,i){r>t&&N.accumulate(r,p(c(i,e)))})});var P=r,O=N.get(r),I=s(O);N.forEach(r+1,n-1,function(t,e){var r=s(e);f(r,I)&&(P=t,I=r,O=e)}),r!==P&&(g._swapRows(r,P,w[1],v,b,E),g._swapRows(r,P,T[1],_,x,S),N.swap(r,P),A(r,P)),N.forEach(0,n-1,function(t,e){t<=r?(_.push(e),x.push(t)):(e=u(e,O),d(e,0)||(v.push(e),b.push(t)))})}return S.push(_.length),E.push(v.length),{L:new g({values:v,index:b,ptr:E,size:w}),U:new g({values:_,index:x,ptr:S,size:T}),p:M,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}};return v}var n=r(39),o=n.object;e.name="lup",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(340)),s=i(r(351)),l=n("slu",{"SparseMatrix, number, number":function(t,e,r){if(!a(e)||e<0||e>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(r<0||r>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var i=o(e,t,!1),n=s(t,i,r);return{L:n.L,U:n.U,p:n.pinv,q:i.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}});return l}var n=r(39),o=n.number,a=o.isInteger;e.name="slu",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(341)),o=i(r(346)),a=i(r(347)),s=i(r(348)),l=i(r(349)),u=function(t,e,r){var i,u=e._ptr,h=e._size,f=h[1],d={};if(d.q=n(t,e),t&&!d.q)return null;if(r){var p=t?o(e,null,d.q,0):e;d.parent=a(p,1);var g=s(d.parent,f);if(d.cp=l(p,d.parent,g,1),p&&d.parent&&d.cp&&c(p,d))for(d.unz=0,i=0;i<f;i++)d.unz+=d.cp[i]}else d.unz=4*u[f]+f,d.lnz=d.unz;return d},c=function(t,e){var r=t._ptr,i=t._index,n=t._size,o=n[0],a=n[1];e.pinv=[],e.leftmost=[];var s,l,u,c,h,f=e.parent,d=e.pinv,p=e.leftmost,g=[],m=0,y=o,v=o+a,b=o+2*a;for(l=0;l<a;l++)g[y+l]=-1,g[v+l]=-1,g[b+l]=0;for(s=0;s<o;s++)p[s]=-1;for(l=a-1;l>=0;l--)for(c=r[l],h=r[l+1],u=c;u<h;u++)p[i[u]]=l;for(s=o-1;s>=0;s--)d[s]=-1,l=p[s],l!=-1&&(0===g[b+l]++&&(g[v+l]=s),g[m+s]=g[y+l],g[y+l]=s);for(e.lnz=0,e.m2=o,l=0;l<a;l++)if(s=g[y+l],e.lnz++,s<0&&(s=e.m2++),d[s]=l,!(--b[l]<=0)){e.lnz+=g[b+l];var E=f[l];E!=-1&&(0===g[b+E]&&(g[v+E]=g[v+l]),g[m+g[v+l]]=g[y+E],g[y+E]=g[m+s],g[b+E]+=g[b+l])}for(s=0;s<o;s++)d[s]<0&&(d[s]=l++);return!0};return u}e.name="cs_sqr",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(342)),o=i(r(343)),a=i(r(344)),s=i(r(51)),l=i(r(84)),u=i(r(345)),c=function(t,e){if(!e||t<=0||t>3)return null;var r=e._size,i=r[0],s=r[1],l=0,u=Math.max(16,10*Math.sqrt(s));u=Math.min(s-2,u);var c=h(t,e,i,s,u);o(c,g,null);for(var m,y,v,b,E,w,_,x,S,T,M,L,A,N,C,R,P=c._index,O=c._ptr,I=O[s],k=[],D=[],V=0,F=s+1,G=2*(s+1),B=3*(s+1),W=4*(s+1),U=5*(s+1),z=6*(s+1),j=7*(s+1),K=k,q=f(s,O,D,V,B,K,G,j,F,z,W,U),Z=d(s,O,D,U,W,z,u,F,B,K,G),H=0;Z<s;){for(v=-1;H<s&&(v=D[B+H])==-1;H++);D[G+v]!=-1&&(K[D[G+v]]=-1),D[B+H]=D[G+v];var $=D[W+v],Y=D[F+v];Z+=Y;var X=0;D[F+v]=-Y;var J=O[v],Q=0===$?J:I,tt=Q;for(b=1;b<=$+1;b++){for(b>$?(w=v,_=J,x=D[V+v]-$):(w=P[J++],_=O[w],x=D[V+w]),E=1;E<=x;E++)m=P[_++],(S=D[F+m])<=0||(X+=S,D[F+m]=-S,P[tt++]=m,D[G+m]!=-1&&(K[D[G+m]]=K[m]),K[m]!=-1?D[G+K[m]]=D[G+m]:D[B+D[U+m]]=D[G+m]);w!=v&&(O[w]=n(v),D[z+w]=0)}for(0!==$&&(I=tt),D[U+v]=X,O[v]=Q,D[V+v]=tt-Q,D[W+v]=-2,q=p(q,l,D,z,s),T=Q;T<tt;T++)if(m=P[T],!((M=D[W+m])<=0)){S=-D[F+m];var et=q-S;for(J=O[m],L=O[m]+M-1;J<=L;J++)w=P[J],D[z+w]>=q?D[z+w]-=S:0!==D[z+w]&&(D[z+w]=D[U+w]+et)}for(T=Q;T<tt;T++){for(m=P[T],L=O[m],A=L+D[W+m]-1,N=L,C=0,R=0,J=L;J<=A;J++)if(w=P[J],0!==D[z+w]){var rt=D[z+w]-q;rt>0?(R+=rt,P[N++]=w,C+=w):(O[w]=n(v),D[z+w]=0)}D[W+m]=N-L+1;var it=N,nt=L+D[V+m];for(J=A+1;J<nt;J++){y=P[J];var ot=D[F+y];ot<=0||(R+=ot,P[N++]=y,C+=y)}0===R?(O[m]=n(v),S=-D[F+m],X-=S,Y+=S,Z+=S,D[F+m]=0,D[W+m]=-1):(D[U+m]=Math.min(D[U+m],R),P[N]=P[it],P[it]=P[L],P[L]=v,D[V+m]=N-L+1,C=(C<0?-C:C)%s,D[G+m]=D[j+C],D[j+C]=m,K[m]=C)}for(D[U+v]=X,l=Math.max(l,X),q=p(q+l,l,D,z,s),T=Q;T<tt;T++)if(m=P[T],!(D[F+m]>=0))for(C=K[m],m=D[j+C],D[j+C]=-1;m!=-1&&D[G+m]!=-1;m=D[G+m],q++){for(x=D[V+m],M=D[W+m],J=O[m]+1;J<=O[m]+x-1;J++)D[z+P[J]]=q;var at=m;for(y=D[G+m];y!=-1;){var st=D[V+y]===x&&D[W+y]===M;for(J=O[y]+1;st&&J<=O[y]+x-1;J++)D[z+P[J]]!=q&&(st=0);st?(O[y]=n(m),D[F+m]+=D[F+y],D[F+y]=0,D[W+y]=-1,y=D[G+y],D[G+at]=y):(at=y,y=D[G+y])}}for(J=Q,T=Q;T<tt;T++)m=P[T],(S=-D[F+m])<=0||(D[F+m]=S,R=D[U+m]+X-S,R=Math.min(R,s-Z-S),D[B+R]!=-1&&(K[D[B+R]]=m),D[G+m]=D[B+R],K[m]=-1,D[B+R]=m,H=Math.min(H,R),D[U+m]=R,P[J++]=m);D[F+v]=Y,0===(D[V+v]=J-Q)&&(O[v]=-1,D[z+v]=0),0!==$&&(I=J)}for(m=0;m<s;m++)O[m]=n(O[m]);for(y=0;y<=s;y++)D[B+y]=-1;for(y=s;y>=0;y--)D[F+y]>0||(D[G+y]=D[B+O[y]],D[B+O[y]]=y);for(w=s;w>=0;w--)D[F+w]<=0||O[w]!=-1&&(D[G+w]=D[B+O[w]],D[B+O[w]]=w);for(v=0,m=0;m<=s;m++)O[m]==-1&&(v=a(m,v,D,B,G,k,z));return k.splice(k.length-1,1),k},h=function(t,e,r,i,n){var o=u(e);if(1===t&&i===r)return s(e,o);if(2==t){for(var a=o._index,c=o._ptr,h=0,f=0;f<r;f++){var d=c[f];if(c[f]=h,!(c[f+1]-d>n))for(var p=c[f+1];d<p;d++)a[h++]=a[d]}return c[r]=h,e=u(o),l(o,e)}return l(o,e)},f=function(t,e,r,i,n,o,a,s,l,u,c,h){for(var f=0;f<t;f++)r[i+f]=e[f+1]-e[f];r[i+t]=0;for(var d=0;d<=t;d++)r[n+d]=-1,o[d]=-1,r[a+d]=-1,r[s+d]=-1,r[l+d]=1,r[u+d]=1,r[c+d]=0,r[h+d]=r[i+d];var g=p(0,0,r,u,t);return r[c+t]=-2,e[t]=-1,r[u+t]=0,g},d=function(t,e,r,i,o,a,s,l,u,c,h){for(var f=0,d=0;d<t;d++){var p=r[i+d];if(0===p)r[o+d]=-2,f++,e[d]=-1,r[a+d]=0;else if(p>s)r[l+d]=0,r[o+d]=-1,f++,e[d]=n(t),r[l+t]++;else{var g=r[u+p];g!=-1&&(c[g]=d),r[h+d]=r[u+p],r[u+p]=d}}return f},p=function(t,e,r,i,n){if(t<2||t+e<0){for(var o=0;o<n;o++)0!==r[i+o]&&(r[i+o]=1);t=2}return t},g=function(t,e){return t!=e};return c}e.name="cs_amd",e.path="sparse",e.factory=i},function(t,e){"use strict";function r(){var t=function(t){return-t-2};return t}e.name="cs_flip",e.path="sparse",e.factory=r},function(t,e){"use strict";function r(){var t=function(t,e,r){for(var i=t._values,n=t._index,o=t._ptr,a=t._size,s=a[1],l=0,u=0;u<s;u++){var c=o[u];for(o[u]=l;c<o[u+1];c++)e(n[c],u,i?i[c]:1,r)&&(n[l]=n[c],i&&(i[l]=i[c]),l++)}return o[s]=l,n.splice(l,n.length-l),i&&i.splice(l,i.length-l),l};return t}e.name="cs_fkeep",e.path="sparse",e.factory=r},function(t,e){"use strict";function r(){var t=function(t,e,r,i,n,o,a){var s=0;for(r[a]=t;s>=0;){var l=r[a+s],u=r[i+l];u==-1?(s--,o[e++]=l):(r[i+l]=r[n+u],++s,r[a+s]=u)}return e};return t}e.name="cs_tdfs",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=t.DenseMatrix,c=t.SparseMatrix,h=a("transpose",{Array:function(t){return h(l(t)).valueOf()},Matrix:function(t){var e,r=t.size();switch(r.length){case 1:e=t.clone();break;case 2:var i=r[0],n=r[1];if(0===n)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+o(r)+")");switch(t.storage()){case"dense":e=f(t,i,n);break;case"sparse":e=d(t,i,n)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+o(this._size)+")")}return e},any:function(t){return n(t)}}),f=function(t,e,r){for(var i,o=t._data,a=[],s=0;s<r;s++){i=a[s]=[];for(var l=0;l<e;l++)i[l]=n(o[l][s])}return new u({data:a,size:[r,e],datatype:t._datatype})},d=function(t,e,r){for(var i=t._values,o=t._index,a=t._ptr,s=i?[]:void 0,l=[],u=[],h=[],f=0;f<e;f++)h[f]=0;var d,p,g;for(d=0,p=o.length;d<p;d++)h[o[d]]++;for(var m=0,y=0;y<e;y++)u.push(m),m+=h[y],h[y]=u[y];for(u.push(m),g=0;g<r;g++)for(var v=a[g],b=a[g+1],E=v;E<b;E++){var w=h[o[E]]++;l[w]=g,i&&(s[w]=n(i[E]))}return new c({values:s,index:l,ptr:u,size:[r,e],datatype:t._datatype})};return h.toTex={1:"\\left(${args[0]}\\right)"+s.operators.transpose},h}var n=r(3).clone,o=r(23).format;e.name="transpose",e.factory=i},function(t,e){"use strict";function r(t){var e=t.SparseMatrix,r=function(t,r,i,n){for(var o=t._values,a=t._index,s=t._ptr,l=t._size,u=t._datatype,c=l[0],h=l[1],f=n&&t._values?[]:null,d=[],p=[],g=0,m=0;m<h;m++){p[m]=g;for(var y=i?i[m]:m,v=s[y],b=s[y+1],E=v;E<b;E++){var w=r?r[a[E]]:a[E];d[g]=w,f&&(f[g]=o[E]),g++}}return p[h]=g,new e({values:f,index:d,ptr:p,size:[c,h],datatype:u})};return r}e.name="cs_permute",e.path="sparse",e.factory=r},function(t,e){"use strict";function r(){var t=function(t,e){if(!t)return null;var r,i,n=t._index,o=t._ptr,a=t._size,s=a[0],l=a[1],u=[],c=[],h=0,f=l;if(e)for(r=0;r<s;r++)c[f+r]=-1;for(var d=0;d<l;d++){u[d]=-1,c[h+d]=-1;for(var p=o[d],g=o[d+1],m=p;m<g;m++){var y=n[m];for(r=e?c[f+y]:y;r!=-1&&r<d;r=i)i=c[h+r],c[h+r]=d,i==-1&&(u[r]=d);e&&(c[f+y]=d)}}return u};return t}e.name="cs_etree",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(344)),o=function(t,e){if(!t)return null;var r,i=0,o=[],a=[],s=0,l=e,u=2*e;for(r=0;r<e;r++)a[s+r]=-1;for(r=e-1;r>=0;r--)t[r]!=-1&&(a[l+r]=a[s+t[r]],a[s+t[r]]=r);for(r=0;r<e;r++)t[r]==-1&&(i=n(r,i,a,s,l,o,u));return o};return o}e.name="cs_post",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(345)),o=i(r(350)),a=function(t,e,r,i){if(!t||!e||!r)return null;var a,s,l,u,c,h,f,d=t._size,p=d[0],g=d[1],m=4*g+(i?g+p+1:0),y=[],v=0,b=g,E=2*g,w=3*g,_=4*g,x=5*g+1;for(l=0;l<m;l++)y[l]=-1;var S=[],T=n(t),M=T._index,L=T._ptr;for(l=0;l<g;l++)for(s=r[l],S[s]=y[w+s]==-1?1:0;s!=-1&&y[w+s]==-1;s=e[s])y[w+s]=l;if(i){for(l=0;l<g;l++)y[r[l]]=l;for(a=0;a<p;a++){for(l=g,h=L[a],f=L[a+1],c=h;c<f;c++)l=Math.min(l,y[M[c]]);y[x+a]=y[_+l],y[_+l]=a}}for(a=0;a<g;a++)y[v+a]=a;for(l=0;l<g;l++){for(s=r[l],e[s]!=-1&&S[e[s]]--,u=i?y[_+l]:s;u!=-1;u=i?y[x+u]:-1)for(c=L[u];c<L[u+1];c++){a=M[c];var A=o(a,s,y,w,b,E,v);A.jleaf>=1&&S[s]++,2==A.jleaf&&S[A.q]--}e[s]!=-1&&(y[v+s]=e[s])}for(s=0;s<g;s++)e[s]!=-1&&(S[e[s]]+=S[s]);return S};return a}e.name="cs_counts",e.path="sparse",e.factory=i},function(t,e){"use strict";function r(){var t=function(t,e,r,i,n,o,a){var s,l,u,c,h=0;if(t<=e||r[i+e]<=r[n+t])return-1;if(r[n+t]=r[i+e],u=r[o+t],r[o+t]=e,u===-1)h=1,c=t;else{for(h=2,c=u;c!=r[a+c];c=r[a+c]);for(s=u;s!=c;s=l)l=r[a+s],r[a+s]=c}return{jleaf:h,q:c}};return t}e.name="cs_leaf",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(86)),o=i(r(81)),a=i(r(84)),s=i(r(64)),l=i(r(352)),u=i(r(353)),c=t.SparseMatrix,h=function(t,e,r){if(!t)return null;var i,h=t._size,f=h[1],d=100,p=100;e&&(i=e.q,d=e.lnz||d,p=e.unz||p);var g,m,y=[],v=[],b=[],E=new c({values:y,index:v,ptr:b,size:[f,f]}),w=[],_=[],x=[],S=new c({values:w,index:_,ptr:x,size:[f,f]}),T=[],M=[],L=[];for(g=0;g<f;g++)M[g]=0,T[g]=-1,b[g+1]=0;d=0,p=0;for(var A=0;A<f;A++){b[A]=d,x[A]=p;var N=i?i[A]:A,C=u(E,t,N,L,M,T,1),R=-1,P=-1;for(m=C;m<f;m++)if(g=L[m],T[g]<0){var O=n(M[g]);s(O,P)&&(P=O,R=g)}else _[p]=T[g],w[p++]=M[g];if(R==-1||P<=0)return null;T[N]<0&&l(n(M[N]),a(P,r))&&(R=N);var I=M[R];for(_[p]=A,w[p++]=I,T[R]=A,v[d]=R,y[d++]=1,m=C;m<f;m++)g=L[m],T[g]<0&&(v[d]=g,y[d++]=o(M[g],I)),M[g]=0}for(b[f]=d,x[f]=p,m=0;m<d;m++)v[m]=T[v[m]];return y.splice(d,y.length-d),v.splice(d,v.length-d),w.splice(p,w.length-p),_.splice(p,_.length-p),{L:E,U:S,pinv:T}};return h}e.name="cs_lu",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("largerEq",{"boolean, boolean":function(t,e){return t>=e},"number, number":function(t,r){return t>=r||n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.gte(r)||o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return t.compare(e)!==-1},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return t>=e},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,p);break;default:r=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,p,!1);break;default:r=h(t,e,p)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=f(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,p,!0);break;default:r=f(e,t,p,!0)}return r},"Array, any":function(t,e){return f(s(t),e,p,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+d.operators.largerEq+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="largerEq",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(81)),o=i(r(84)),a=i(r(77)),s=i(r(354)),l=function(t,e,r,i,l,u,c){var h,f,d,p,g=t._values,m=t._index,y=t._ptr,v=t._size,b=v[1],E=e._values,w=e._index,_=e._ptr,x=s(t,e,r,i,u);for(h=x;h<b;h++)l[i[h]]=0;for(f=_[r],d=_[r+1],h=f;h<d;h++)l[w[h]]=E[h];for(var S=x;S<b;S++){var T=i[S],M=u?u[T]:T;if(!(M<0))for(f=y[M],d=y[M+1],l[T]=n(l[T],g[c?f:d-1]),h=c?f+1:f,p=c?d:d-1;h<p;h++){var L=m[h];l[L]=a(l[L],o(g[h],l[T]))}}return x};return l}e.name="cs_spsolve",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(355)),o=i(r(356)),a=i(r(357)),s=function(t,e,r,i,s){var l,u,c,h=t._ptr,f=t._size,d=e._index,p=e._ptr,g=f[1],m=g;for(u=p[r],c=p[r+1],l=u;l<c;l++){var y=d[l];o(h,y)||(m=n(y,t,m,i,s))}for(l=m;l<g;l++)a(h,i[l]);return m};return s}e.name="cs_reach",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(356)),o=i(r(357)),a=i(r(358)),s=function(t,e,r,i,s){var l,u,c,h=e._index,f=e._ptr,d=e._size,p=d[1],g=0;for(i[0]=t;g>=0;){t=i[g];var m=s?s[t]:t;n(f,t)||(o(f,t),i[p+g]=m<0?0:a(f[m]));var y=1;for(u=i[p+g],c=m<0?0:a(f[m+1]);u<c;u++)if(l=h[u],!n(f,l)){i[p+g]=u,i[++g]=l,y=0;break}y&&(g--,i[--r]=t)}return r};return s}e.name="cs_dfs",e.path="sparse",e.factory=i},function(t,e){"use strict";function r(){var t=function(t,e){return t[e]<0};return t}e.name="cs_marked",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(342)),o=function(t,e){t[e]=n(t[e])};return o}e.name="cs_mark",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i){var n=i(r(342)),o=function(t){return t<0?n(t):t};return o}e.name="cs_unflip",e.path="sparse",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(81)),s=i(r(80)),l=i(r(77)),u=i(r(48)),c=i(r(360)),h=t.DenseMatrix,f=n("lsolve",{"SparseMatrix, Array | Matrix":function(t,e){return p(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return d(t,e)},"Array, Array | Matrix":function(t,e){var r=o(t),i=d(r,e);return i.valueOf()}}),d=function(t,e){e=c(t,e,!0);for(var r=e._data,i=t._size[0],n=t._size[1],o=[],f=t._data,d=0;d<n;d++){var p,g=r[d][0]||0;if(u(g,0))p=0;else{var m=f[d][d];if(u(m,0))throw new Error("Linear system cannot be solved since matrix is singular");p=a(g,m);for(var y=d+1;y<i;y++)r[y]=[l(r[y][0]||0,s(p,f[y][d]))]}o[d]=[p]}return new h({data:o,size:[i,1]})},p=function(t,e){e=c(t,e,!0);for(var r,i,n=e._data,o=t._size[0],f=t._size[1],d=t._values,p=t._index,g=t._ptr,m=[],y=0;y<f;y++){var v=n[y][0]||0;if(u(v,0))m[y]=[0];else{var b=0,E=[],w=[],_=g[y+1];for(i=g[y];i<_;i++)r=p[i],r===y?b=d[i]:r>y&&(E.push(d[i]),w.push(r));if(u(b,0))throw new Error("Linear system cannot be solved since matrix is singular");var x=a(v,b);for(i=0,_=w.length;i<_;i++)r=w[i],n[r]=[l(n[r][0]||0,s(x,E[i]))];m[y]=[x]}}return new h({data:m,size:[o,1]})};return f}e.name="lsolve",e.factory=i},function(t,e,r){"use strict";function i(t){var e=t.DenseMatrix,r=function(t,r,i){var n=t.size();if(2!==n.length)throw new RangeError("Matrix must be two dimensional (size: "+o.format(n)+")");var l=n[0],u=n[1];if(l!==u)throw new RangeError("Matrix must be square (size: "+o.format(n)+")");
var c,h,f;if(r&&r.isMatrix===!0){var d=r.size();if(1===d.length){if(d[0]!==l)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(c=[],f=r._data,h=0;h<l;h++)c[h]=[f[h]];return new e({data:c,size:[l,1],datatype:r._datatype})}if(2===d.length){if(d[0]!==l||1!==d[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(r.isDenseMatrix===!0){if(i){for(c=[],f=r._data,h=0;h<l;h++)c[h]=[f[h][0]];return new e({data:c,size:[l,1],datatype:r._datatype})}return r}for(c=[],h=0;h<l;h++)c[h]=[0];for(var p=r._values,g=r._index,m=r._ptr,y=m[1],v=m[0];v<y;v++)h=g[v],c[h][0]=p[v];return new e({data:c,size:[l,1],datatype:r._datatype})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}if(s(r)){var b=a.size(r);if(1===b.length){if(b[0]!==l)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(c=[],h=0;h<l;h++)c[h]=[r[h]];return new e({data:c,size:[l,1]})}if(2===b.length){if(b[0]!==l||1!==b[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(c=[],h=0;h<l;h++)c[h]=[r[h][0]];return new e({data:c,size:[l,1]})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}};return r}var n=r(39),o=n.string,a=n.array,s=Array.isArray;e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(52)),s=i(r(338)),l=i(r(339)),u=i(r(362)),c=i(r(360)),h=i(r(363)),f=i(r(359)),d=o("lusolve",{"Array, Array | Matrix":function(t,e){t=a(t);var r=s(t),i=g(r.L,r.U,r.p,null,e);return i.valueOf()},"DenseMatrix, Array | Matrix":function(t,e){var r=s(t);return g(r.L,r.U,r.p,null,e)},"SparseMatrix, Array | Matrix":function(t,e){var r=s(t);return g(r.L,r.U,r.p,null,e)},"SparseMatrix, Array | Matrix, number, number":function(t,e,r,i){var n=l(t,r,i);return g(n.L,n.U,n.p,n.q,e)},"Object, Array | Matrix":function(t,e){return g(t.L,t.U,t.p,t.q,e)}}),p=function(t){if(t&&t.isMatrix===!0)return t;if(n(t))return a(t);throw new TypeError("Invalid Matrix LU decomposition")},g=function(t,e,r,i,n){t=p(t),e=p(e),n=c(t,n,!1),r&&(n._data=u(r,n._data));var o=f(t,n),a=h(e,o);return i&&(a._data=u(i,a._data)),a};return d}var n=Array.isArray;e.name="lusolve",e.factory=i},function(t,e){"use strict";function r(){var t=function(t,e,r){var i,r=e.length,n=[];if(t)for(i=0;i<r;i++)n[t[i]]=e[i];else for(i=0;i<r;i++)n[i]=e[i];return n};return t}e.name="cs_ipvec",e.path="sparse",e.factory=r},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(81)),s=i(r(80)),l=i(r(77)),u=i(r(48)),c=i(r(360)),h=t.DenseMatrix,f=n("usolve",{"SparseMatrix, Array | Matrix":function(t,e){return p(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return d(t,e)},"Array, Array | Matrix":function(t,e){var r=o(t),i=d(r,e);return i.valueOf()}}),d=function(t,e){e=c(t,e,!0);for(var r=e._data,i=t._size[0],n=t._size[1],o=[],f=t._data,d=n-1;d>=0;d--){var p,g=r[d][0]||0;if(u(g,0))p=0;else{var m=f[d][d];if(u(m,0))throw new Error("Linear system cannot be solved since matrix is singular");p=a(g,m);for(var y=d-1;y>=0;y--)r[y]=[l(r[y][0]||0,s(p,f[y][d]))]}o[d]=[p]}return new h({data:o,size:[i,1]})},p=function(t,e){e=c(t,e,!0);for(var r,i,n=e._data,o=t._size[0],f=t._size[1],d=t._values,p=t._index,g=t._ptr,m=[],y=f-1;y>=0;y--){var v=n[y][0]||0;if(u(v,0))m[y]=[0];else{var b=0,E=[],w=[],_=g[y],x=g[y+1];for(i=x-1;i>=_;i--)r=p[i],r===y?b=d[i]:r<y&&(E.push(d[i]),w.push(r));if(u(b,0))throw new Error("Linear system cannot be solved since matrix is singular");var S=a(v,b);for(i=0,x=w.length;i<x;i++)r=w[i],n[r]=[l(n[r][0],s(S,E[i]))];m[y]=[S]}}return new h({data:m,size:[o,1]})};return f}e.name="usolve",e.factory=i},function(t,e,r){t.exports=[r(86),r(51),r(53),r(365),r(367),r(368),r(327),r(369),r(371),r(373),r(374),r(87),r(375),r(376),r(377),r(380),r(383),r(384),r(385),r(84),r(386),r(388),r(82),r(389),r(391),r(378),r(392),r(77),r(78),r(393),r(394)]},function(t,e,r){"use strict";function i(t,e,i,a){function s(r,i){var n=r.arg()/3,a=r.abs(),s=new t.Complex(o(a),0).mul(new t.Complex(0,n).exp());if(i){var l=[s,new t.Complex(o(a),0).mul(new t.Complex(0,n+2*Math.PI/3).exp()),new t.Complex(o(a),0).mul(new t.Complex(0,n-2*Math.PI/3).exp())];return"Array"===e.matrix?l:h(l)}return s}function l(e){if(e.value&&e.value.isComplex){var r=e.clone();return r.value=1,r=r.pow(1/3),r.value=s(e.value),r}var i=c(e.value);i&&(e.value=u(e.value));var n;n=e.value&&e.value.isBigNumber?new t.BigNumber(1).div(3):e.value&&e.value.isFraction?new t.Fraction(1,3):1/3;var r=e.pow(n);return i&&(r.value=u(r.value)),r}var u=i(r(78)),c=i(r(366)),h=i(r(52)),f=a("cbrt",{number:o,Complex:s,"Complex, boolean":s,BigNumber:function(t){return t.cbrt()},Unit:l,"Array | Matrix":function(t){return n(t,f,!0)}});return f.toTex={1:"\\sqrt[3]{${args[0]}}"},f}var n=r(19),o=Math.cbrt||function(t){if(0===t)return t;var e,r=t<0;return r&&(t=-t),isFinite(t)?(e=Math.exp(Math.log(t)/3),e=(t/(e*e)+2*e)/3):e=t,r?-e:e};e.name="cbrt",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isNegative",{number:function(t){return t<0},BigNumber:function(t){return t.isNeg()&&!t.isZero()&&!t.isNaN()},Fraction:function(t){return t.s<0},Unit:function(t){return o(t.value)},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);r(6);e.name="isNegative",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("ceil",{number:Math.ceil,Complex:function(t){return t.ceil()},BigNumber:function(t){return t.ceil()},Fraction:function(t){return t.ceil()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\left\\lceil${args[0]}\\right\\rceil"},o}var n=r(19);e.name="ceil",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("cube",{number:function(t){return t*t*t},Complex:function(t){return t.mul(t).mul(t)},BigNumber:function(t){return t.times(t).times(t)},Fraction:function(t){return t.pow(3)},"Array | Matrix":function(t){return n(t,o,!0)},Unit:function(t){return t.pow(3)}});return o.toTex={1:"\\left(${args[0]}\\right)^3"},o}var n=r(19);e.name="cube",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(81)),s=r(32),l=i(r(370)),u=i(r(61)),c=i(r(62)),h=i(r(85)),f=i(r(63)),d=i(r(57)),p=i(r(58)),g=n("dotDivide",{"any, any":a,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,a,!1);break;default:r=l(e,t,a,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,a,!1);break;default:r=d(t,e,a)}}return r},"Array, Array":function(t,e){return g(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return g(o(t),e)},"Matrix, Array":function(t,e){return g(t,o(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,a,!1);break;default:r=p(t,e,a,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=f(e,t,a,!0);break;default:r=p(e,t,a,!0)}return r},"Array, any":function(t,e){return p(o(t),e,a,!1).valueOf()},"any, Array":function(t,e){return p(o(e),t,a,!0).valueOf()}});return g.toTex={2:"\\left(${args[0]}"+s.operators.dotDivide+"${args[1]}\\right)"},g}e.name="dotDivide",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r,i){var l=t._data,u=t._size,c=t._datatype,h=e._values,f=e._index,d=e._ptr,p=e._size,g=e._datatype;if(u.length!==p.length)throw new n(u.length,p.length);if(u[0]!==p[0]||u[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+p+")");if(!h)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m,y=u[0],v=u[1],b=a,E=0,w=r;"string"==typeof c&&c===g&&(m=c,b=o.find(a,[m,m]),E=o.convert(0,m),w=o.find(r,[m,m]));for(var _=[],x=[],S=[],T=0;T<v;T++){S[T]=x.length;for(var M=d[T],L=d[T+1],A=M;A<L;A++){var N=f[A],C=i?w(h[A],l[N][T]):w(l[N][T],h[A]);b(C,E)||(x.push(N),_.push(C))}}return S[v]=x.length,new s({values:_,index:x,ptr:S,size:[y,v],datatype:m})};return l}var n=r(42);e.name="algorithm02",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(80)),s=r(32),l=i(r(370)),u=i(r(372)),c=i(r(85)),h=i(r(57)),f=i(r(58)),d=n("dotMultiply",{"any, any":a,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,a,!1);break;default:r=l(e,t,a,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,a,!1);break;default:r=h(t,e,a)}}return r},"Array, Array":function(t,e){return d(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return d(o(t),e)},"Matrix, Array":function(t,e){return d(t,o(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,a,!1);break;default:r=f(t,e,a,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,a,!0);break;default:r=f(e,t,a,!0)}return r},"Array, any":function(t,e){return f(o(t),e,a,!1).valueOf()},"any, Array":function(t,e){return f(o(e),t,a,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+s.operators.dotMultiply+"${args[1]}\\right)"},d}e.name="dotMultiply",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r){var i=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype,f=e._values,d=e._index,p=e._ptr,g=e._size,m=e._datatype;if(c.length!==g.length)throw new n(c.length,g.length);if(c[0]!==g[0]||c[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+g+")");var y,v=c[0],b=c[1],E=a,w=0,_=r;"string"==typeof h&&h===m&&(y=h,E=o.find(a,[y,y]),w=o.convert(0,y),_=o.find(r,[y,y]));var x,S,T,M,L,A=i&&f?[]:void 0,N=[],C=[],R=new s({values:A,index:N,ptr:C,size:[v,b],datatype:y}),P=A?[]:void 0,O=[];for(S=0;S<b;S++){C[S]=N.length;var I=S+1;if(P)for(M=p[S],L=p[S+1],T=M;T<L;T++)x=d[T],O[x]=I,P[x]=f[T];for(M=u[S],L=u[S+1],T=M;T<L;T++)if(x=l[T],P){var k=O[x]===I?P[x]:w,D=_(i[T],k);E(D,w)||(N.push(x),A.push(D))}else N.push(x)}return C[b]=N.length,R};return l}var n=r(42);e.name="algorithm09",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(82)),s=r(32),l=i(r(61)),u=i(r(62)),c=i(r(85)),h=i(r(63)),f=i(r(57)),d=i(r(58)),p=n("dotPow",{"any, any":a,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,a,!1);break;default:r=l(e,t,a,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,a,!1);break;default:r=f(t,e,a)}}return r},"Array, Array":function(t,e){return p(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return p(o(t),e)},"Matrix, Array":function(t,e){return p(t,o(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return d(o(t),e,p,!1).valueOf()},"any, Array":function(t,e){return d(o(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+s.operators.dotPow+"${args[1]}\\right)"},p}e.name="dotPow",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("exp",{number:Math.exp,Complex:function(t){return t.exp()},BigNumber:function(t){return t.exp()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\exp\\left(${args[0]}\\right)"},o}var n=r(19);e.name="exp",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("floor",{number:Math.floor,Complex:function(t){return t.floor()},BigNumber:function(t){return t.floor()},Fraction:function(t){return t.floor()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\left\\lfloor${args[0]}\\right\\rfloor"},o}var n=r(19);e.name="floor",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(e,r){if(!e.isInt()||!r.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var i=new t.BigNumber(0);!r.isZero();){var n=e.mod(r);e=r,r=n}return e.lt(i)?e.neg():e}var s=i(r(52)),l=i(r(54)),u=i(r(55)),c=i(r(56)),h=i(r(57)),f=i(r(58)),d=o("gcd",{"number, number":n,"BigNumber, BigNumber":a,"Fraction, Fraction":function(t,e){return t.gcd(e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,d);break;default:r=l(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,d,!1);break;default:r=h(t,e,d)}}return r},"Array, Array":function(t,e){return d(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return d(s(t),e)},"Matrix, Array":function(t,e){return d(t,s(e))},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,d,!1);break;default:r=f(t,e,d,!1)}return r},"number | BigNumber, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,d,!0);break;default:r=f(e,t,d,!0)}return r},"Array, number | BigNumber":function(t,e){return f(s(t),e,d,!1).valueOf()},"number | BigNumber, Array":function(t,e){return f(s(e),t,d,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(t,e,r){for(var i=d(t,e),n=0;n<r.length;n++)i=d(i,r[n]);return i}});return d.toTex="\\gcd\\left(${args}\\right)",d}function n(t,e){if(!o(t)||!o(e))throw new Error("Parameters in function gcd must be integer numbers");for(var r;0!=e;)r=t%e,t=e,e=r;return t<0?-t:t}var o=r(6).isInteger;e.name="gcd",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t){for(var e=0,r=0,i=0;i<t.length;i++){var n=s(t[i]);f(r,n)?(e=c(e,c(u(r,n),u(r,n))),e=l(e,1),r=n):e=l(e,d(n)?c(u(n,r),u(n,r)):n)}return c(r,h(e))}var s=i(r(86)),l=i(r(53)),u=i(r(81)),c=i(r(80)),h=i(r(378)),f=i(r(60)),d=i(r(379)),p=o("hypot",{"... number | BigNumber":a,Array:function(t){return p.apply(p,n(t))},Matrix:function(t){return p.apply(p,n(t.toArray()))}});return p.toTex="\\hypot\\left(${args}\\right)",p}var n=r(40).flatten;e.name="hypot",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){function o(r){return r>=0||e.predictable?Math.sqrt(r):new t.Complex(r,0).sqrt()}var a=i("sqrt",{number:o,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():o(t.toNumber())},"Array | Matrix":function(t){return n(t,a,!0)},Unit:function(t){return t.pow(.5)}});return a.toTex={1:"\\sqrt{${args[0]}}"},a}var n=r(19);e.name="sqrt",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isPositive",{number:function(t){return t>0},BigNumber:function(t){return!t.isNeg()&&!t.isZero()&&!t.isNaN()},Fraction:function(t){return t.s>0&&t.n>0},Unit:function(t){return o(t.value)},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);r(6);e.name="isPositive",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(e,r){if(!e.isInt()||!r.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(e.isZero()||r.isZero())return new t.BigNumber(0);for(var i=e.times(r);!r.isZero();){var n=r;r=e.mod(n),e=n}return i.div(e).abs()}var s=i(r(52)),l=i(r(370)),u=i(r(381)),c=i(r(85)),h=i(r(57)),f=i(r(58)),d=o("lcm",{"number, number":n,"BigNumber, BigNumber":a,"Fraction, Fraction":function(t,e){return t.lcm(e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,d);break;default:r=l(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,d,!1);break;default:r=h(t,e,d)}}return r},"Array, Array":function(t,e){return d(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return d(s(t),e)},"Matrix, Array":function(t,e){return d(t,s(e))},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,d,!1);break;default:r=f(t,e,d,!1)}return r},"number | BigNumber, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,d,!0);break;default:r=f(e,t,d,!0)}return r},"Array, number | BigNumber":function(t,e){return f(s(t),e,d,!1).valueOf()},"number | BigNumber, Array":function(t,e){return f(s(e),t,d,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(t,e,r){for(var i=d(t,e),n=0;n<r.length;n++)i=d(i,r[n]);return i}});return d.toTex=void 0,d}function n(t,e){if(!o(t)||!o(e))throw new Error("Parameters in function lcm must be integer numbers");if(0==t||0==e)return 0;for(var r,i=t*e;0!=e;)r=e,e=t%r,t=r;return Math.abs(i/t)}var o=r(6).isInteger;e.name="lcm",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(48)),l=t.SparseMatrix,u=function(t,e,r){var i=t._values,u=t._size,c=t._datatype,h=e._values,f=e._size,d=e._datatype;if(u.length!==f.length)throw new o(u.length,f.length);if(u[0]!==f[0]||u[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+f+")");var p,g=u[0],m=u[1],y=s,v=0,b=r;"string"==typeof c&&c===d&&(p=c,y=a.find(s,[p,p]),v=a.convert(0,p),b=a.find(r,[p,p]));for(var E=i&&h?[]:void 0,w=[],_=[],x=new l({values:E,index:w,ptr:_,size:[g,m],datatype:p}),S=E?[]:void 0,T=[],M=[],L=0;L<m;L++){_[L]=w.length;var A=L+1;if(n(t,L,T,S,M,A,x,b),n(e,L,T,S,M,A,x,b),S)for(var N=_[L];N<w.length;){var C=w[N];if(M[C]===A){var R=S[C];y(R,v)?w.splice(N,1):(E.push(R),N++)}else w.splice(N,1)}else for(var P=_[L];P<w.length;){var O=w[P];M[O]!==A?w.splice(P,1):P++}}return _[m]=w.length,x};return u}var n=r(382),o=r(42);e.name="algorithm06",e.factory=i},function(t,e){"use strict";t.exports=function(t,e,r,i,n,o,a,s,l,u,c){var h,f,d,p,g=t._values,m=t._index,y=t._ptr,v=a._index;if(i)for(f=y[e],d=y[e+1],h=f;h<d;h++)p=m[h],r[p]!==o?(r[p]=o,v.push(p),u?(i[p]=l?s(g[h],c):s(c,g[h]),n[p]=o):i[p]=g[h]):(i[p]=l?s(g[h],i[p]):s(i[p],g[h]),n[p]=o);else for(f=y[e],d=y[e+1],h=f;h<d;h++)p=m[h],r[p]!==o?(r[p]=o,v.push(p)):n[p]=o}},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(81)),s=o("log",{number:function(r){return r>=0||e.predictable?Math.log(r):new t.Complex(r,0).log()},Complex:function(t){return t.log()},BigNumber:function(r){return!r.isNegative()||e.predictable?r.ln():new t.Complex(r.toNumber(),0).log()},"Array | Matrix":function(t){return n(t,s)},"any, any":function(t,e){return a(s(t),s(e))}});return s.toTex={1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},s}var n=r(19);e.name="log",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("log10",{number:function(r){return r>=0||e.predictable?o(r):new t.Complex(r,0).log().div(Math.LN10)},Complex:function(e){return new t.Complex(e).log().div(Math.LN10)},BigNumber:function(r){return!r.isNegative()||e.predictable?r.log():new t.Complex(r.toNumber(),0).log().div(Math.LN10)},"Array | Matrix":function(t){return n(t,a)}});return a.toTex={1:"\\log_{10}\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.log10||function(t){return Math.log(t)/Math.LN10};e.name="log10",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(e>0)return t-e*Math.floor(t/e);if(0===e)return t;throw new Error("Cannot calculate mod for a negative divisor")}var a=i(r(52)),s=r(32),l=i(r(370)),u=i(r(61)),c=i(r(79)),h=i(r(85)),f=i(r(63)),d=i(r(57)),p=i(r(58)),g=n("mod",{"number, number":o,"BigNumber, BigNumber":function(t,e){return e.isZero()?t:t.mod(e)},"Fraction, Fraction":function(t,e){return t.mod(e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,g,!1);break;default:r=l(e,t,g,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,g,!1);break;default:r=d(t,e,g)}}return r},"Array, Array":function(t,e){return g(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return g(a(t),e)},"Matrix, Array":function(t,e){return g(t,a(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,g,!1);break;default:r=p(t,e,g,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=f(e,t,g,!0);break;default:r=p(e,t,g,!0)}return r},"Array, any":function(t,e){return p(a(t),e,g,!1).valueOf()},"any, Array":function(t,e){return p(a(e),t,g,!0).valueOf()}});return g.toTex={2:"\\left(${args[0]}"+s.operators.mod+"${args[1]}\\right)"},g}e.name="mod",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){var r=t.size();if(1==r.length){if(e===Number.POSITIVE_INFINITY||"inf"===e){var i=0;return t.forEach(function(t){var e=a(t);f(e,i)&&(i=e)},!0),i}if(e===Number.NEGATIVE_INFINITY||"-inf"===e){var n;return t.forEach(function(t){var e=a(t);n&&!d(e,n)||(n=e)},!0),n||0}if("fro"===e)return o(t,2);if("number"==typeof e&&!isNaN(e)){if(!h(e,0)){var p=0;return t.forEach(function(t){p=s(l(a(t),e),p)},!0),l(p,1/e)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}if(2==r.length){if(1===e){var y=[],v=0;return t.forEach(function(t,e){var r=e[1],i=s(y[r]||0,a(t));f(i,v)&&(v=i),y[r]=i},!0),v}if(e===Number.POSITIVE_INFINITY||"inf"===e){var b=[],E=0;return t.forEach(function(t,e){var r=e[0],i=s(b[r]||0,a(t));f(i,E)&&(E=i),b[r]=i},!0),E}if("fro"===e)return u(g(c(m(t),t)));if(2===e)throw new Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw new Error("Unsupported parameter value")}}var a=i(r(86)),s=i(r(51)),l=i(r(82)),u=i(r(378)),c=i(r(84)),h=i(r(48)),f=i(r(64)),d=i(r(60)),p=i(r(52)),g=i(r(387)),m=i(r(345)),y=n("norm",{number:Math.abs,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},"boolean | null":function(t){return Math.abs(t)},Array:function(t){return o(p(t),2)},Matrix:function(t){return o(t,2)},"number | Complex | BigNumber | boolean | null, number | BigNumber | string":function(t){return y(t)},"Array, number | BigNumber | string":function(t,e){return o(p(t),e)},"Matrix, number | BigNumber | string":function(t,e){return o(t,e)}});return y.toTex={1:"\\left\\|${args[0]}\\right\\|",2:void 0},y}e.name="norm",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(51)),u=a("trace",{Array:function(t){return u(s(t))},Matrix:function(t){var e;switch(t.storage()){case"dense":e=c(t);break;case"sparse":e=h(t)}return e},any:n}),c=function(t){var e=t._size,r=t._data;switch(e.length){case 1:if(1==e[0])return n(r[0]);throw new RangeError("Matrix must be square (size: "+o(e)+")");case 2:var i=e[0],a=e[1];if(i===a){for(var s=0,u=0;u<i;u++)s=l(s,r[u][u]);return s}throw new RangeError("Matrix must be square (size: "+o(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+o(e)+")")}},h=function(t){var e=t._values,r=t._index,i=t._ptr,n=t._size,a=n[0],s=n[1];if(a===s){var u=0;if(e.length>0)for(var c=0;c<s;c++)for(var h=i[c],f=i[c+1],d=h;d<f;d++){var p=r[d];if(p===c){u=l(u,e[d]);break}if(p>c)break}return u}throw new RangeError("Matrix must be square (size: "+o(n)+")")};return u.toTex={1:"\\mathrm{tr}\\left(${args[0]}\\right)"},u}var n=r(3).clone,o=r(23).format;e.name="trace",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){var i=t.BigNumber.precision,n=t.BigNumber.clone({precision:i+2}),o=new t.BigNumber(0),a=new n(1),s=r.isNegative();if(s&&(r=r.neg()),r.isZero())throw new Error("Root must be non-zero");if(e.isNegative()&&!r.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(e.isZero())return s?new n(1/0):0;if(!e.isFinite())return s?o:e;var l=e.abs().pow(a.div(r));return l=e.isNeg()?l.neg():l,new t.BigNumber((s?a.div(l):l).toPrecision(i))}var l=i(r(52)),u=i(r(54)),c=i(r(370)),h=i(r(381)),f=i(r(85)),d=i(r(57)),p=i(r(58)),g=a("nthRoot",{number:function(t){return n(t,2)},"number, number":n,BigNumber:function(e){return s(e,new t.BigNumber(2))},Complex:function(t){return o(t,2)},"Complex, number":o,"BigNumber, BigNumber":s,"Array | Matrix":function(t){return g(t,2)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":if(1!==e.density())throw new Error("Root must be non-zero");r=h(t,e,g);break;default:r=c(e,t,g,!0)}break;default:switch(e.storage()){case"sparse":if(1!==e.density())throw new Error("Root must be non-zero");r=u(t,e,g,!1);break;default:r=d(t,e,g)}}return r},"Array, Array":function(t,e){return g(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return g(l(t),e)},"Matrix, Array":function(t,e){return g(t,l(e))},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=f(t,e,g,!1);break;default:r=p(t,e,g,!1)}return r},"number | BigNumber, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":if(1!==e.density())throw new Error("Root must be non-zero");r=f(e,t,g,!0);break;default:r=p(e,t,g,!0)}return r},"Array, number | BigNumber":function(t,e){return g(l(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return g(t,l(e)).valueOf()}});return g.toTex={2:"\\sqrt[${args[1]}]{${args[0]}}"},g}function n(t,e){var r=e<0;if(r&&(e=-e),0===e)throw new Error("Root must be non-zero");if(t<0&&Math.abs(e)%2!=1)throw new Error("Root must be odd when a is negative.");if(0==t)return r?1/0:0;if(!isFinite(t))return r?0:t;var i=Math.pow(Math.abs(t),1/e);return i=t<0?-i:i,r?1/i:i}function o(t,e){if(e<0)throw new Error("Root must be greater than zero");if(0===e)throw new Error("Root must be non-zero");if(e%1!==0)throw new Error("Root must be an integer");for(var r=t.arg(),i=t.abs(),n=[],o=Math.pow(i,1/e),a=0;a<e;a++)n.push({r:o,phi:(r+2*Math.PI*a)/e});return n}e.name="nthRoot",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var u=i(r(52)),c=i(r(48)),h=i(r(390)),f=i(r(85)),d=i(r(63)),p=i(r(58)),g=a("round",{number:Math.round,"number, number":function(t,e){if(!o(e))throw new TypeError(l);if(e<0||e>15)throw new Error("Number of decimals in function round must be in te range of 0-15");return n(t,e)},Complex:function(t){return t.round()},"Complex, number":function(t,e){if(e%1)throw new TypeError(l);return t.round(e)},"Complex, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(l);var r=e.toNumber();return t.round(r)},"number, BigNumber":function(e,r){if(!r.isInteger())throw new TypeError(l);return new t.BigNumber(e).toDecimalPlaces(r.toNumber())},BigNumber:function(t){return t.toDecimalPlaces(0)},"BigNumber, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(l);return t.toDecimalPlaces(e.toNumber())},Fraction:function(t){return t.round()},"Fraction, number":function(t,e){if(e%1)throw new TypeError(l);return t.round(e)},"Array | Matrix":function(t){return s(t,g,!0)},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=f(t,e,g,!1);break;default:r=p(t,e,g,!1)}return r},"number | Complex | BigNumber, Matrix":function(t,e){if(!c(t,0)){var r;switch(e.storage()){case"sparse":r=d(e,t,g,!0);break;default:r=p(e,t,g,!0)}return r}return h(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return p(u(t),e,g,!1).valueOf()},"number | Complex | BigNumber, Array":function(t,e){return p(u(e),t,g,!0).valueOf()}});return g.toTex={1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},g}function n(t,e){return parseFloat(a(t,e))}var o=r(6).isInteger,a=r(6).toFixed,s=r(19),l="Number of decimals in function round must be an integer";e.name="round",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){var i=l(e),n=i?new t.BigNumber(0):0;if(u(e),r){var a=c(r);return e.length>0?a.resize(e,n):a}var s=[];return e.length>0?o(s,e,n):s}function l(t){var e=!1;return t.forEach(function(t,r,i){t&&t.isBigNumber===!0&&(e=!0,i[r]=t.toNumber())}),e}function u(t){t.forEach(function(t){if("number"!=typeof t||!n(t)||t<0)throw new Error("Parameters in function zeros must be positive integers")})}var c=i(r(52)),h=a("zeros",{"":function(){return"Array"===e.matrix?s([]):s([],"default")},"...number | BigNumber | string":function(t){var r=t[t.length-1];if("string"==typeof r){var i=t.pop();return s(t,i)}return"Array"===e.matrix?s(t):s(t,"default")},Array:s,Matrix:function(t){var e=t.storage();return s(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return s(t.valueOf(),e)}});return h.toTex=void 0,h}var n=r(6).isInteger,o=r(40).resize;e.name="zeros",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("sign",{number:n.sign,Complex:function(t){return t.sign()},BigNumber:function(e){return new t.BigNumber(e.cmp(0))},Fraction:function(e){return new t.Fraction(e.s,1)},"Array | Matrix":function(t){return o(t,a,!0)},Unit:function(t){return a(t.value)}});return a.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},a}var n=r(6),o=r(19);e.name="sign",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("square",{number:function(t){return t*t},Complex:function(t){return t.mul(t)},BigNumber:function(t){return t.times(t)},Fraction:function(t){return t.mul(t)},"Array | Matrix":function(t){return n(t,o,!0)},Unit:function(t){return t.pow(2)}});return o.toTex={1:"\\left(${args[0]}\\right)^2"},o}var n=r(19);e.name="square",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=o("unaryPlus",{number:function(t){return t},Complex:function(t){return t},BigNumber:function(t){return t},Fraction:function(t){return t},Unit:function(t){return t.clone()},"Array | Matrix":function(t){return n(t,s,!0)},"boolean | string | null":function(r){return"BigNumber"==e.number?new t.BigNumber(+r):+r}});return s.toTex={1:a.operators.unaryPlus+"\\left(${args[0]}\\right)"},s}var n=r(19);e.name="unaryPlus",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,r){var i,o,a,s=0,u=1,c=1,h=0;if(!n(t)||!n(r))throw new Error("Parameters in function xgcd must be integer numbers");for(;r;)o=Math.floor(t/r),a=t%r,i=s,s=u-o*s,u=i,i=c,c=h-o*c,h=i,t=r,r=a;var f;return f=t<0?[-t,-u,-h]:[t,t?u:0,h],"Array"===e.matrix?f:l(f)}function s(r,i){var n,o,a,s=new t.BigNumber(0),u=new t.BigNumber(1),c=s,h=u,f=u,d=s;if(!r.isInt()||!i.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!i.isZero();)o=r.div(i).floor(),a=r.mod(i),n=c,c=h.minus(o.times(c)),h=n,n=f,f=d.minus(o.times(f)),d=n,r=i,i=a;var p;return p=r.lt(s)?[r.neg(),h.neg(),d.neg()]:[r,r.isZero()?0:h,d],"Array"===e.matrix?p:l(p)}var l=i(r(52)),u=o("xgcd",{"number, number":a,"BigNumber, BigNumber":s});return u.toTex=void 0,u}var n=r(6).isInteger;e.name="xgcd",e.factory=i},function(t,e,r){t.exports=[r(396),r(400),r(401),r(403),r(405),r(408),r(410)]},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(370)),c=i(r(381)),h=i(r(85)),f=i(r(57)),d=i(r(58)),p=a("bitAnd",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function bitAnd");return t&e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=u(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,p,!1);break;default:r=f(t,e,p)}}return r},"Array, Array":function(t,e){return p(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return p(l(t),e)},"Matrix, Array":function(t,e){return p(t,l(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return d(l(t),e,p,!1).valueOf()},"any, Array":function(t,e){return d(l(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+s.operators.bitAnd+"${args[1]}\\right)"},p}var n=r(6).isInteger,o=r(397);e.name="bitAnd",e.factory=i},function(t,e,r){var i=r(398);t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitAnd");var r=t.constructor;if(t.isNaN()||e.isNaN())return new r(NaN);if(t.isZero()||e.eq(-1)||t.eq(e))return t;if(e.isZero()||t.eq(-1))return e;if(!t.isFinite()||!e.isFinite()){if(!t.isFinite()&&!e.isFinite())return t.isNegative()==e.isNegative()?t:new r(0);if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new r(0):e;if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new r(0):t}return i(t,e,function(t,e){return t&e})}},function(t,e,r){function i(t){for(var e=t.d,r=e[0]+"",i=1;i<e.length;++i){
for(var n=e[i]+"",o=7-n.length;o--;)n="0"+n;r+=n}var a;for(a=r.length-1;"0"==r.charAt(a);--a);var s=t.e,l=r.slice(0,a+1||1),u=l.length;if(s>0)if(++s>u)for(s-=u;s--;l+="0");else s<u&&(l=l.slice(0,s)+"."+l.slice(s));for(var c=[0],i=0;i<l.length;){for(var h=c.length;h--;c[h]*=10);c[0]+=l.charAt(i++)<<0;for(var a=0;a<c.length;++a)c[a]>1&&(null==c[a+1]&&(c[a+1]=0),c[a+1]+=c[a]>>1,c[a]&=1)}return c.reverse()}var n=r(399);t.exports=function(t,e,r){var o,a,s=t.constructor,l=+(t.s<0),u=+(e.s<0);if(l){o=i(n(t));for(var c=0;c<o.length;++c)o[c]^=1}else o=i(t);if(u){a=i(n(e));for(var c=0;c<a.length;++c)a[c]^=1}else a=i(e);var h,f,d;o.length<=a.length?(h=o,f=a,d=l):(h=a,f=o,d=u);var p=h.length,g=f.length,m=1^r(l,u),y=new s(1^m),v=new s(1),b=new s(2),E=s.precision;for(s.config({precision:1e9});p>0;)r(h[--p],f[--g])==m&&(y=y.plus(v)),v=v.times(b);for(;g>0;)r(d,f[--g])==m&&(y=y.plus(v)),v=v.times(b);return s.config({precision:E}),0==m&&(y.s=-y.s),y}},function(t,e){t.exports=function(t){if(t.isFinite()&&!t.isInteger())throw new Error("Integer expected in function bitNot");var e=t.constructor,r=e.precision;e.config({precision:1e9});var t=t.plus(new e(1));return t.s=-t.s||null,e.config({precision:r}),t}},function(t,e,r){"use strict";function i(t,e,i,s){var l=r(32),u=s("bitNot",{number:function(t){if(!a(t))throw new Error("Integer expected in function bitNot");return~t},BigNumber:o,"Array | Matrix":function(t){return n(t,u)}});return u.toTex={1:l.operators.bitNot+"\\left(${args[0]}\\right)"},u}var n=r(19),o=r(399),a=r(6).isInteger;e.name="bitNot",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(54)),c=i(r(55)),h=i(r(56)),f=i(r(57)),d=i(r(58)),p=a("bitOr",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function bitOr");return t|e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,p);break;default:r=u(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,p,!1);break;default:r=f(t,e,p)}}return r},"Array, Array":function(t,e){return p(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return p(l(t),e)},"Matrix, Array":function(t,e){return p(t,l(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return d(l(t),e,p,!1).valueOf()},"any, Array":function(t,e){return d(l(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+s.operators.bitOr+"${args[1]}\\right)"},p}var n=r(6).isInteger,o=r(402);e.name="bitOr",e.factory=i},function(t,e,r){var i=r(398);t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitOr");var r=t.constructor;if(t.isNaN()||e.isNaN())return new r(NaN);var n=new r(-1);return t.isZero()||e.eq(n)||t.eq(e)?e:e.isZero()||t.eq(n)?t:t.isFinite()&&e.isFinite()?i(t,e,function(t,e){return t|e}):!t.isFinite()&&!t.isNegative()&&e.isNegative()||t.isNegative()&&!e.isNegative()&&!e.isFinite()?n:t.isNegative()&&e.isNegative()?t.isFinite()?t:e:t.isFinite()?e:t}},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(61)),c=i(r(62)),h=i(r(63)),f=i(r(57)),d=i(r(58)),p=a("bitXor",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function bitXor");return t^e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,p);break;default:r=u(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,p,!1);break;default:r=f(t,e,p)}}return r},"Array, Array":function(t,e){return p(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return p(l(t),e)},"Matrix, Array":function(t,e){return p(t,l(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=h(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return d(l(t),e,p,!1).valueOf()},"any, Array":function(t,e){return d(l(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+s.operators.bitXor+"${args[1]}\\right)"},p}var n=r(6).isInteger,o=r(404);e.name="bitXor",e.factory=i},function(t,e,r){var i=r(398),n=r(399);t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitXor");var r=t.constructor;if(t.isNaN()||e.isNaN())return new r(NaN);if(t.isZero())return e;if(e.isZero())return t;if(t.eq(e))return new r(0);var o=new r(-1);return t.eq(o)?n(e):e.eq(o)?n(t):t.isFinite()&&e.isFinite()?i(t,e,function(t,e){return t^e}):t.isFinite()||e.isFinite()?new r(t.isNegative()==e.isNegative()?1/0:-(1/0)):o}},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(48)),c=i(r(390)),h=i(r(54)),f=i(r(370)),d=i(r(407)),p=i(r(56)),g=i(r(85)),m=i(r(57)),y=i(r(58)),v=a("leftShift",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function leftShift");return t<<e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=d(t,e,v,!1);break;default:r=f(e,t,v,!0)}break;default:switch(e.storage()){case"sparse":r=h(t,e,v,!1);break;default:r=m(t,e,v)}}return r},"Array, Array":function(t,e){return v(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return v(l(t),e)},"Matrix, Array":function(t,e){return v(t,l(e))},"Matrix, number | BigNumber":function(t,e){if(!u(e,0)){var r;switch(t.storage()){case"sparse":r=g(t,e,v,!1);break;default:r=y(t,e,v,!1)}return r}return t.clone()},"number | BigNumber, Matrix":function(t,e){if(!u(t,0)){var r;switch(e.storage()){case"sparse":r=p(e,t,v,!0);break;default:r=y(e,t,v,!0)}return r}return c(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return v(l(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return v(t,l(e)).valueOf()}});return v.toTex={2:"\\left(${args[0]}"+s.operators.leftShift+"${args[1]}\\right)"},v}var n=r(6).isInteger,o=r(406);e.name="leftShift",e.factory=i},function(t,e){t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function leftShift");var r=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new r(NaN):t.isZero()||e.isZero()?t:t.isFinite()||e.isFinite()?e.lt(55)?t.times(Math.pow(2,e.toNumber())+""):t.times(new r(2).pow(e)):new r(NaN)}},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(48)),s=t.SparseMatrix,l=function(t,e,r){var i=t._values,l=t._index,u=t._ptr,c=t._size,h=t._datatype,f=e._values,d=e._index,p=e._ptr,g=e._size,m=e._datatype;if(c.length!==g.length)throw new n(c.length,g.length);if(c[0]!==g[0]||c[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+g+")");if(!i||!f)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var y,v=c[0],b=c[1],E=a,w=0,_=r;"string"==typeof h&&h===m&&(y=h,E=o.find(a,[y,y]),w=o.convert(0,y),_=o.find(r,[y,y]));for(var x,S,T,M,L=[],A=[],N=[],C=new s({values:L,index:A,ptr:N,size:[v,b],datatype:y}),R=[],P=[],O=0;O<b;O++){N[O]=A.length;var I=O+1;for(S=u[O],T=u[O+1],x=S;x<T;x++)M=l[x],P[M]=I,R[M]=i[x],A.push(M);for(S=p[O],T=p[O+1],x=S;x<T;x++)M=d[x],P[M]===I&&(R[M]=_(R[M],f[x]));for(x=N[O];x<A.length;){M=A[x];var k=R[M];E(k,w)?A.splice(x,1):(L.push(k),x++)}}return N[b]=A.length,C};return l}var n=r(42);e.name="algorithm08",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=r(32),l=i(r(52)),u=i(r(48)),c=i(r(390)),h=i(r(54)),f=i(r(370)),d=i(r(407)),p=i(r(56)),g=i(r(85)),m=i(r(57)),y=i(r(58)),v=a("rightArithShift",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function rightArithShift");return t>>e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=d(t,e,v,!1);break;default:r=f(e,t,v,!0)}break;default:switch(e.storage()){case"sparse":r=h(t,e,v,!1);break;default:r=m(t,e,v)}}return r},"Array, Array":function(t,e){return v(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return v(l(t),e)},"Matrix, Array":function(t,e){return v(t,l(e))},"Matrix, number | BigNumber":function(t,e){if(!u(e,0)){var r;switch(t.storage()){case"sparse":r=g(t,e,v,!1);break;default:r=y(t,e,v,!1)}return r}return t.clone()},"number | BigNumber, Matrix":function(t,e){if(!u(t,0)){var r;switch(e.storage()){case"sparse":r=p(e,t,v,!0);break;default:r=y(e,t,v,!0)}return r}return c(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return v(l(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return v(t,l(e)).valueOf()}});return v.toTex={2:"\\left(${args[0]}"+s.operators.rightArithShift+"${args[1]}\\right)"},v}var n=r(6).isInteger,o=r(409);e.name="rightArithShift",e.factory=i},function(t,e){t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function rightArithShift");var r=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new r(NaN):t.isZero()||e.isZero()?t:e.isFinite()?e.lt(55)?t.div(Math.pow(2,e.toNumber())+"").floor():t.div(new r(2).pow(e)).floor():new r(t.isNegative()?-1:t.isFinite()?0:NaN)}},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=i(r(52)),l=i(r(48)),u=i(r(390)),c=i(r(54)),h=i(r(370)),f=i(r(407)),d=i(r(56)),p=i(r(85)),g=i(r(57)),m=i(r(58)),y=o("rightLogShift",{"number, number":function(t,e){if(!n(t)||!n(e))throw new Error("Integers expected in function rightLogShift");return t>>>e},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=f(t,e,y,!1);break;default:r=h(e,t,y,!0)}break;default:switch(e.storage()){case"sparse":r=c(t,e,y,!1);break;default:r=g(t,e,y)}}return r},"Array, Array":function(t,e){return y(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return y(s(t),e)},"Matrix, Array":function(t,e){return y(t,s(e))},"Matrix, number | BigNumber":function(t,e){if(!l(e,0)){var r;switch(t.storage()){case"sparse":r=p(t,e,y,!1);break;default:r=m(t,e,y,!1)}return r}return t.clone()},"number | BigNumber, Matrix":function(t,e){if(!l(t,0)){var r;switch(e.storage()){case"sparse":r=d(e,t,y,!0);break;default:r=m(e,t,y,!0)}return r}return u(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return y(s(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return y(t,s(e)).valueOf()}});return y.toTex={2:"\\left(${args[0]}"+a.operators.rightLogShift+"${args[1]}\\right)"},y}var n=r(6).isInteger;e.name="rightLogShift",e.factory=i},function(t,e,r){t.exports=[r(412),r(418),r(413),r(419)]},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(51)),a=i(r(413)),s=i(r(366)),l=i(r(417)),u=n("bellNumbers",{"number | BigNumber":function(t){if(!l(t)||s(t))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var e=0,r=0;r<=t;r++)e=o(e,a(t,r));return e}});return u.toTex={1:"\\mathrm{B}_{${args[0]}}"},u}e.name="bellNumbers",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(51)),a=i(r(77)),s=i(r(84)),l=i(r(327)),u=i(r(82)),c=i(r(414)),h=i(r(416)),f=i(r(366)),d=i(r(417)),p=i(r(64)),g=n("stirlingS2",{"number | BigNumber, number | BigNumber":function(t,e){if(!d(t)||f(t)||!d(e)||f(e))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(p(e,t))throw new TypeError("k must be less than or equal to n in function stirlingS2");for(var r=c(e),i=0,n=0;n<=e;n++){var g=u(-1,a(e,n)),m=h(e,n),y=u(n,t);i=o(i,s(s(m,y),g))}return l(i,r)}});return g.toTex={2:"\\mathrm{S}\\left(${args}\\right)"},g}e.name="stirlingS2",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(415)),s=r(32),l=o("factorial",{number:function(t){if(t<0)throw new Error("Value must be non-negative");return a(t+1)},BigNumber:function(t){if(t.isNegative())throw new Error("Value must be non-negative");return a(t.plus(1))},"Array | Matrix":function(t){return n(t,l)}});return l.toTex={1:"\\left(${args[0]}\\right)"+s.operators.factorial},l}var n=r(19);e.name="factorial",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,l){function u(r){if(r.isZero())return new t.BigNumber(1);for(var i=e.precision+(0|Math.log(r.toNumber())),n=t.BigNumber.clone({precision:i}),o=new n(r),a=r.toNumber()-1;a>1;)o=o.times(a),a--;return new t.BigNumber(o.toPrecision(t.BigNumber.precision))}var c=i(r(84)),h=i(r(82)),f=l("gamma",{number:function(t){var e,r;if(o(t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var i=t-2,n=t-1;i>1;)n*=i,i--;return 0==n&&(n=1),n}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*f(1-t));if(t>=171.35)return 1/0;if(t>85){var l=t*t,u=l*t,c=u*t,h=c*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*l)-139/(51840*u)-571/(2488320*c)+163879/(209018880*h)+5246819/(75246796800*h*t))}--t,r=s[0];for(var d=1;d<s.length;++d)r+=s[d]/(t+d);return e=t+a+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*r},Complex:function(e){var r,i;if(0==e.im)return f(e.re);e=new t.Complex(e.re-1,e.im),i=new t.Complex(s[0],0);for(var n=1;n<s.length;++n){var o=e.re+n,l=o*o+e.im*e.im;0!=l?(i.re+=s[n]*o/l,i.im+=-(s[n]*e.im)/l):i.re=s[n]<0?-(1/0):1/0}r=new t.Complex(e.re+a+.5,e.im);var u=Math.sqrt(2*Math.PI);e.re+=.5;var d=h(r,e);0==d.im?d.re*=u:0==d.re?d.im*=u:(d.re*=u,d.im*=u);var p=Math.exp(-r.re);return r.re=p*Math.cos(-r.im),r.im=p*Math.sin(-r.im),c(c(d,r),i)},BigNumber:function(e){if(e.isInteger())return e.isNegative()||e.isZero()?new t.BigNumber(1/0):u(e.minus(1));if(!e.isFinite())return new t.BigNumber(e.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")},"Array | Matrix":function(t){return n(t,f)}});return f.toTex={1:"\\Gamma\\left(${args[0]}\\right)"},f}var n=r(19),o=r(6).isInteger,a=4.7421875,s=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];e.name="gamma",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("combinations",{"number, number":function(t,e){var r,i,n;if(!o(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(!o(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(e>t)throw new TypeError("k must be less than or equal to n");for(r=Math.max(e,t-e),i=1,n=1;n<=t-r;n++)i=i*(r+n)/n;return i},"BigNumber, BigNumber":function(e,r){var i,o,a,s,l=new t.BigNumber(1);if(!n(e)||!n(r))throw new TypeError("Positive integer value expected in function combinations");if(r.gt(e))throw new TypeError("k must be less than n in function combinations");for(i=e.minus(r),r.lt(i)&&(i=r),o=l,a=l,s=e.minus(i);a.lte(s);a=a.plus(1))o=o.times(i.plus(a)).dividedBy(a);return o}});return a.toTex={2:"\\binom{${args[0]}}{${args[1]}}"},a}function n(t){return t.isInteger()&&t.gte(0)}var o=r(6).isInteger;e.name="combinations",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("isInteger",{number:o.isInteger,BigNumber:function(t){return t.isInt()},Fraction:function(t){return 1===t.d&&isFinite(t.n)},"Array | Matrix":function(t){return n(t,a)}});return a}var n=r(19),o=r(6);e.name="isInteger",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(416)),a=i(r(53)),s=i(r(379)),l=i(r(417)),u=i(r(64)),c=n("composition",{"number | BigNumber, number | BigNumber":function(t,e){if(!(l(t)&&s(t)&&l(e)&&s(e)))throw new TypeError("Positive integer value expected in function composition");if(u(e,t))throw new TypeError("k must be less than or equal to n in function composition");return o(a(t,-1),a(e,-1))}});return c.toTex=void 0,c}e.name="composition",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(51)),a=i(r(327)),s=i(r(84)),l=i(r(416)),u=i(r(366)),c=i(r(417)),h=n("catalan",{"number | BigNumber":function(t){if(!c(t)||u(t))throw new TypeError("Non-negative integer value expected in function catalan");return a(l(s(t,2),t),o(t,1))}});return h.toTex={1:"\\mathrm{C}_{${args[0]}}"},h}e.name="catalan",e.factory=i},function(t,e,r){t.exports=[r(421),r(422),r(423),r(424)]},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("arg",{number:function(t){return Math.atan2(0,t)},BigNumber:function(e){return t.BigNumber.atan2(0,e)},Complex:function(t){return t.arg()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\arg\\left(${args[0]}\\right)"},o}var n=r(19);e.name="arg",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("conj",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.conjugate()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\left(${args[0]}\\right)^*"},o}var n=r(19);e.name="conj",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("im",{number:function(t){return 0},BigNumber:function(e){return new t.BigNumber(0)},Complex:function(t){return t.im},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},o}var n=r(19);e.name="im",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("re",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.re},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},o}var n=r(19);e.name="re",e.factory=i},function(t,e,r){t.exports=[r(426),r(427)]},function(t,e,r){"use strict";function i(t,e,i,n){function o(t){return 2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function a(t){return 3===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]}function s(t){return 4===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}function l(t,r,i,n){var o=t,a=i,s=g(o,r),l=g(a,n),u=s[0]*l[1]-l[0]*s[1];if(h(u)<e.epsilon)return null;var c=(l[0]*o[1]-l[1]*o[0]-l[0]*a[1]+l[1]*a[0])/u;return f(p(s,c),o)}function u(t,e,r,i,n,o,a,s,l,u,c,h){var f=(t-a)*(u-a)+(e-s)*(c-s)+(r-l)*(h-l),d=(u-a)*(i-t)+(c-s)*(n-e)+(h-l)*(o-r),p=(t-a)*(i-t)+(e-s)*(n-e)+(r-l)*(o-r),g=(u-a)*(u-a)+(c-s)*(c-s)+(h-l)*(h-l),m=(i-t)*(i-t)+(n-e)*(n-e)+(o-r)*(o-r),y=(f*d-p*g)/(m*g-d*d),v=(f+y*d)/g,b=t+y*(i-t),E=e+y*(n-e),w=r+y*(o-r),_=a+v*(u-a),x=s+v*(c-s),S=l+v*(h-l);return b===_&&E===x&&w===S?[b,E,w]:null}function c(t,e,r,i,n,o,a,s,l,u){var c=(u-t*a-e*s-r*l)/(i*a+n*s+o*l-t-e-r),h=t+c*(i-t),f=e+c*(n-e),d=r+c*(o-r);return[h,f,d]}var h=i(r(86)),f=i(r(51)),d=i(r(52)),p=i(r(84)),g=i(r(77)),m=n("intersect",{"Array, Array, Array":function(t,e,r){if(!a(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!a(e))throw new TypeError("Array with 3 numbers expected for second argument");if(!s(r))throw new TypeError("Array with 4 numbers expected as third argument");return c(t[0],t[1],t[2],e[0],e[1],e[2],r[0],r[1],r[2],r[3])},"Array, Array, Array, Array":function(t,e,r,i){if(2===t.length){if(!o(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!o(e))throw new TypeError("Array with 2 numbers expected for second argument");if(!o(r))throw new TypeError("Array with 2 numbers expected for third argument");if(!o(i))throw new TypeError("Array with 2 numbers expected for fourth argument");return l(t,e,r,i)}if(3===t.length){if(!a(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!a(e))throw new TypeError("Array with 3 numbers expected for second argument");if(!a(r))throw new TypeError("Array with 3 numbers expected for third argument");if(!a(i))throw new TypeError("Array with 3 numbers expected for fourth argument");return u(t[0],t[1],t[2],e[0],e[1],e[2],r[0],r[1],r[2],i[0],i[1],i[2])}throw new TypeError("Arrays with two or thee dimensional points expected")},"Matrix, Matrix, Matrix":function(t,e,r){return d(m(t.valueOf(),e.valueOf(),r.valueOf()))},"Matrix, Matrix, Matrix, Matrix":function(t,e,r,i){return d(m(t.valueOf(),e.valueOf(),r.valueOf(),i.valueOf()))}});return m}e.name="intersect",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,s){var p=(i(r(52)),s("distance",{"Array, Array, Array":function(t,e,r){if(2==t.length&&2==e.length&&2==r.length){if(!n(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!n(e))throw new TypeError("Array with 2 numbers expected for second argument");if(!n(r))throw new TypeError("Array with 2 numbers expected for third argument");var i=(r[1]-r[0])/(e[1]-e[0]),o=i*i*e[0],a=-1*(i*e[0]),s=t[1];return u(t[0],t[1],o,a,s)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(t,e,r){if(2==Object.keys(t).length&&2==Object.keys(e).length&&2==Object.keys(r).length){if(!n(t))throw new TypeError("Values of pointX and pointY should be numbers");if(!n(e))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers");if(!n(r))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers");if(t.hasOwnProperty("pointX")&&t.hasOwnProperty("pointY")&&e.hasOwnProperty("lineOnePtX")&&e.hasOwnProperty("lineOnePtY")&&r.hasOwnProperty("lineTwoPtX")&&r.hasOwnProperty("lineTwoPtY")){var i=(r.lineTwoPtY-r.lineTwoPtX)/(e.lineOnePtY-e.lineOnePtX),o=i*i*e.lineOnePtX,a=-1*(i*e.lineOnePtX),s=t.pointX;return u(t.pointX,t.pointY,o,a,s)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(t,e){if(2==t.length&&3==e.length){if(!n(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!o(e))throw new TypeError("Array with 3 numbers expected for second argument");return u(t[0],t[1],e[0],e[1],e[2])}if(3==t.length&&6==e.length){if(!o(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!a(e))throw new TypeError("Array with 6 numbers expected for second argument");return c(t[0],t[1],t[2],e[0],e[1],e[2],e[3],e[4],e[5])}if(2==t.length&&2==e.length){if(!n(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!n(e))throw new TypeError("Array with 2 numbers expected for second argument");return h(t[0],t[1],e[0],e[1])}if(3==t.length&&3==e.length){if(!o(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!o(e))throw new TypeError("Array with 3 numbers expected for second argument");return f(t[0],t[1],t[2],e[0],e[1],e[2])}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(t,e){if(2==Object.keys(t).length&&3==Object.keys(e).length){if(!n(t))throw new TypeError("Values of pointX and pointY should be numbers");if(!o(e))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers");if(t.hasOwnProperty("pointX")&&t.hasOwnProperty("pointY")&&e.hasOwnProperty("xCoeffLine")&&e.hasOwnProperty("yCoeffLine")&&e.hasOwnProperty("yCoeffLine"))return u(t.pointX,t.pointY,e.xCoeffLine,e.yCoeffLine,e.constant);throw new TypeError("Key names do not match")}if(3==Object.keys(t).length&&6==Object.keys(e).length){if(!o(t))throw new TypeError("Values of pointX, pointY and pointZ should be numbers");if(!a(e))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers");if(t.hasOwnProperty("pointX")&&t.hasOwnProperty("pointY")&&e.hasOwnProperty("x0")&&e.hasOwnProperty("y0")&&e.hasOwnProperty("z0")&&e.hasOwnProperty("a")&&e.hasOwnProperty("b")&&e.hasOwnProperty("c"))return c(t.pointX,t.pointY,t.pointZ,e.x0,e.y0,e.z0,e.a,e.b,e.c);throw new TypeError("Key names do not match")}if(2==Object.keys(t).length&&2==Object.keys(e).length){if(!n(t))throw new TypeError("Values of pointOneX and pointOneY should be numbers");if(!n(e))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers");if(t.hasOwnProperty("pointOneX")&&t.hasOwnProperty("pointOneY")&&e.hasOwnProperty("pointTwoX")&&e.hasOwnProperty("pointTwoY"))return h(t.pointOneX,t.pointOneY,e.pointTwoX,e.pointTwoY);throw new TypeError("Key names do not match")}if(3==Object.keys(t).length&&3==Object.keys(e).length){if(!o(t))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers");if(!o(e))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers");if(t.hasOwnProperty("pointOneX")&&t.hasOwnProperty("pointOneY")&&t.hasOwnProperty("pointOneZ")&&e.hasOwnProperty("pointTwoX")&&e.hasOwnProperty("pointTwoY")&&e.hasOwnProperty("pointTwoZ"))return f(t.pointOneX,t.pointOneY,t.pointOneZ,e.pointTwoX,e.pointTwoY,e.pointTwoZ);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(t){if(!l(t))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return d(t)}}));return p}function n(t){return t.constructor!==Array&&(t=s(t)),"number"==typeof t[0]&&"number"==typeof t[1]}function o(t){return t.constructor!==Array&&(t=s(t)),"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]}function a(t){return t.constructor!==Array&&(t=s(t)),"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]&&"number"==typeof t[4]&&"number"==typeof t[5]}function s(t){for(var e=Object.keys(t),r=[],i=0;i<e.length;i++)r.push(t[e[i]]);return r}function l(t){if(2==t[0].length&&"number"==typeof t[0][0]&&"number"==typeof t[0][1]){for(var e in t)if(2!=t[e].length||"number"!=typeof t[e][0]||"number"!=typeof t[e][1])return!1}else{if(3!=t[0].length||"number"!=typeof t[0][0]||"number"!=typeof t[0][1]||"number"!=typeof t[0][2])return!1;for(var e in t)if(3!=t[e].length||"number"!=typeof t[e][0]||"number"!=typeof t[e][1]||"number"!=typeof t[e][2])return!1}return!0}function u(t,e,r,i,n){var o=Math.abs(r*t+i*e+n),a=Math.pow(r*r+i*i,.5),s=o/a;return s}function c(t,e,r,i,n,o,a,s,l){var u=[(n-e)*l-(o-r)*s,(o-r)*a-(i-t)*l,(i-t)*s-(n-e)*a];u=Math.pow(u[0]*u[0]+u[1]*u[1]+u[2]*u[2],.5);var c=Math.pow(a*a+s*s+l*l,.5),h=u/c;return h}function h(t,e,r,i){var n=i-e,o=r-t,a=n*n+o*o,s=Math.pow(a,.5);return s}function f(t,e,r,i,n,o){var a=o-r,s=n-e,l=i-t,u=a*a+s*s+l*l,c=Math.pow(u,.5);return c}function d(t){for(var e=[],r=0;r<t.length-1;r++)for(var i=r+1;i<t.length;i++)2==t[0].length?e.push(h(t[r][0],t[r][1],t[i][0],t[i][1])):3==t[0].length&&e.push(f(t[r][0],t[r][1],t[r][2],t[i][0],t[i][1],t[i][2]));return e}e.name="distance",e.factory=i},function(t,e,r){t.exports=[r(429),r(430),r(432),r(433)]},function(t,e,r){"use strict";function i(t,e,i,n){var o=r(32),a=i(r(52)),s=i(r(390)),l=i(r(430)),u=(i(r(431)),i(r(370))),c=i(r(381)),h=i(r(85)),f=i(r(57)),d=i(r(58)),p=n("and",{"number, number":function(t,e){return!(!t||!e)},"Complex, Complex":function(t,e){return!(0===t.re&&0===t.im||0===e.re&&0===e.im)},"BigNumber, BigNumber":function(t,e){return!(t.isZero()||e.isZero()||t.isNaN()||e.isNaN())},"Unit, Unit":function(t,e){return p(t.value,e.value)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=u(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=u(t,e,p,!1);break;default:r=f(t,e,p)}}return r},"Array, Array":function(t,e){return p(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return p(a(t),e)},"Matrix, Array":function(t,e){return p(t,a(e))},"Matrix, any":function(t,e){if(l(e))return s(t.size(),t.storage());var r;switch(t.storage()){case"sparse":r=h(t,e,p,!1);break;default:r=d(t,e,p,!1)}return r},"any, Matrix":function(t,e){if(l(t))return s(t.size(),t.storage());var r;switch(e.storage()){case"sparse":r=h(e,t,p,!0);break;default:r=d(e,t,p,!0)}return r},"Array, any":function(t,e){return p(a(t),e).valueOf()},"any, Array":function(t,e){return p(t,a(e)).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+o.operators.and+"${args[1]}\\right)"},p}e.name="and",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=r(32),s=o("not",{number:function(t){return!t},Complex:function(t){return 0===t.re&&0===t.im},BigNumber:function(t){return t.isZero()||t.isNaN()},Unit:function(t){return s(t.value)},"Array | Matrix":function(t){return n(t,s)}});return s.toTex={1:a.operators.not+"\\left(${args[0]}\\right)"},s}var n=r(19);e.name="not",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isZero",{number:function(t){return 0===t},BigNumber:function(t){return t.isZero()},Complex:function(t){return 0===t.re&&0===t.im},Fraction:function(t){return 1===t.d&&0===t.n},Unit:function(t){return o(t.value)},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);r(6);e.name="isZero",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=r(32),a=i(r(52)),s=i(r(61)),l=i(r(79)),u=i(r(63)),c=i(r(57)),h=i(r(58)),f=n("or",{"number, number":function(t,e){return!(!t&&!e)},"Complex, Complex":function(t,e){return 0!==t.re||0!==t.im||0!==e.re||0!==e.im},"BigNumber, BigNumber":function(t,e){return!t.isZero()&&!t.isNaN()||!e.isZero()&&!e.isNaN()},"Unit, Unit":function(t,e){return f(t.value,e.value)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=l(t,e,f);break;default:r=s(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":r=s(t,e,f,!1);break;default:r=c(t,e,f)}}return r},"Array, Array":function(t,e){return f(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return f(a(t),e)},"Matrix, Array":function(t,e){return f(t,a(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=u(t,e,f,!1);break;default:r=h(t,e,f,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=u(e,t,f,!0);break;default:r=h(e,t,f,!0)}return r},"Array, any":function(t,e){return h(a(t),e,f,!1).valueOf()},"any, Array":function(t,e){return h(a(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+o.operators.or+"${args[1]}\\right)"},f}e.name="or",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=r(32),a=i(r(52)),s=i(r(61)),l=i(r(62)),u=i(r(63)),c=i(r(57)),h=i(r(58)),f=n("xor",{"number, number":function(t,e){return!!(!!t^!!e)},"Complex, Complex":function(t,e){return(0!==t.re||0!==t.im)!=(0!==e.re||0!==e.im)},"BigNumber, BigNumber":function(t,e){return(!t.isZero()&&!t.isNaN())!=(!e.isZero()&&!e.isNaN())},"Unit, Unit":function(t,e){return f(t.value,e.value)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=l(t,e,f);break;default:r=s(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":r=s(t,e,f,!1);break;default:r=c(t,e,f)}}return r},"Array, Array":function(t,e){return f(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return f(a(t),e)},"Matrix, Array":function(t,e){return f(t,a(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=u(t,e,f,!1);break;default:r=h(t,e,f,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=u(e,t,f,!0);break;default:r=h(e,t,f,!0)}return r},"Array, any":function(t,e){return h(a(t),e,f,!1).valueOf()},"any, Array":function(t,e){return h(a(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+o.operators.xor+"${args[1]}\\right)"},f}e.name="xor",e.factory=i},function(t,e,r){t.exports=[r(311),r(435),r(329),r(436),r(437),r(83),r(313),r(438),r(315),r(328),r(318),r(439),r(440),r(333),r(442),r(443),r(444),r(445),r(286),r(387),r(345),r(390)]},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e){var r=Math.max(n.size(t).length,n.size(e).length);t=n.squeeze(t),e=n.squeeze(e);var i=n.size(t),o=n.size(e);if(1!=i.length||1!=o.length||3!=i[0]||3!=o[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+i.join(", ")+"], B = ["+o.join(", ")+"])");var a=[l(u(t[1],e[2]),u(t[2],e[1])),l(u(t[2],e[0]),u(t[0],e[2])),l(u(t[0],e[1]),u(t[1],e[0]))];
return r>1?[a]:a}var s=i(r(52)),l=i(r(77)),u=i(r(84)),c=o("cross",{"Matrix, Matrix":function(t,e){return s(a(t.toArray(),e.toArray()))},"Matrix, Array":function(t,e){return s(a(t.toArray(),e))},"Array, Matrix":function(t,e){return s(a(t,e.toArray()))},"Array, Array":a});return c.toTex={2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},c}var n=r(40);e.name="cross",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(t,e,r,i){if(!o(e))throw new TypeError("Second parameter in function diag must be an integer");var n=e>0?e:0,a=e<0?-e:0;switch(r.length){case 1:return l(t,e,i,r[0],a,n);case 2:return u(t,e,i,r,a,n)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function l(e,r,i,n,o,a){var s=[n+o,n+a],l=t.Matrix.storage(i||"dense"),u=l.diagonal(s,e,r);return null!==i?u:u.valueOf()}function u(t,e,r,i,n,o){if(t&&t.isMatrix===!0){var a=t.diagonal(e);return null!==r?r!==a.storage()?c(a,r):a:a.valueOf()}for(var s=Math.min(i[0]-n,i[1]-o),l=[],u=0;u<s;u++)l[u]=t[u+n][u+o];return null!==r?c(l):l}var c=i(r(52)),h=a("diag",{Array:function(t){return s(t,0,n.size(t),null)},"Array, number":function(t,e){return s(t,e,n.size(t),null)},"Array, BigNumber":function(t,e){return s(t,e.toNumber(),n.size(t),null)},"Array, string":function(t,e){return s(t,0,n.size(t),e)},"Array, number, string":function(t,e,r){return s(t,e,n.size(t),r)},"Array, BigNumber, string":function(t,e,r){return s(t,e.toNumber(),n.size(t),r)},Matrix:function(t){return s(t,0,t.size(),t.storage())},"Matrix, number":function(t,e){return s(t,e,t.size(),t.storage())},"Matrix, BigNumber":function(t,e){return s(t,e.toNumber(),t.size(),t.storage())},"Matrix, string":function(t,e){return s(t,0,t.size(),e)},"Matrix, number, string":function(t,e,r){return s(t,e,t.size(),r)},"Matrix, BigNumber, string":function(t,e,r){return s(t,e.toNumber(),t.size(),r)}});return h.toTex=void 0,h}var n=r(40),o=(r(3).clone,r(6).isInteger);e.name="diag",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e){var r=n(t),i=n(e),o=r[0];if(1!==r.length||1!==i.length)throw new RangeError("Vector expected");if(r[0]!=i[0])throw new RangeError("Vectors must have equal length ("+r[0]+" != "+i[0]+")");if(0==o)throw new RangeError("Cannot calculate the dot product of empty vectors");for(var a=0,u=0;u<o;u++)a=s(a,l(t[u],e[u]));return a}var s=i(r(51)),l=i(r(84)),u=o("dot",{"Matrix, Matrix":function(t,e){return a(t.toArray(),e.toArray())},"Matrix, Array":function(t,e){return a(t.toArray(),e)},"Array, Matrix":function(t,e){return a(t,e.toArray())},"Array, Array":a});return u.toTex={2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},u}var n=r(40).size;e.name="dot",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=a("flatten",{Array:function(t){return o(n(t))},Matrix:function(t){var e=o(n(t.toArray()));return s(e)}});return l.toTex=void 0,l}var n=r(3).clone,o=r(40).flatten;e.name="flatten",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){var i=l(e),n=i?new t.BigNumber(1):1;if(u(e),r){var a=c(r);return e.length>0?a.resize(e,n):a}var s=[];return e.length>0?o(s,e,n):s}function l(t){var e=!1;return t.forEach(function(t,r,i){t&&t.isBigNumber===!0&&(e=!0,i[r]=t.toNumber())}),e}function u(t){t.forEach(function(t){if("number"!=typeof t||!n(t)||t<0)throw new Error("Parameters in function ones must be positive integers")})}var c=i(r(52)),h=a("ones",{"":function(){return"Array"===e.matrix?s([]):s([],"default")},"...number | BigNumber | string":function(t){var r=t[t.length-1];if("string"==typeof r){var i=t.pop();return s(t,i)}return"Array"===e.matrix?s(t):s(t,"default")},Array:s,Matrix:function(t){var e=t.storage();return s(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return s(t.valueOf(),e)}});return h.toTex=void 0,h}var n=r(6).isInteger,o=r(40).resize;e.name="ones",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t,e){return-u(t,e)}function s(t,e,r){if(!n(e)||e<0)throw new Error("k must be a non-negative integer");if(t&&t.isMatrix){var i=t.size();if(i.length>1)throw new Error("Only one dimensional matrices supported");return l(t.valueOf(),e,r)}if(Array.isArray(t))return l(t,e,r)}function l(t,e,r){if(e>=t.length)throw new Error("k out of bounds");for(var i=0,n=t.length-1;i<n;){for(var o=i,a=n,s=t[Math.floor(Math.random()*(n-i+1))+i];o<a;)if(r(t[o],s)>=0){var l=t[a];t[a]=t[o],t[o]=l,--a}else++o;r(t[o],s)>0&&--o,e<=o?n=o:i=o+1}return t[e]}var u=i(r(441));return o("partitionSelect",{"Array | Matrix, number":function(t,e){return s(t,e,u)},"Array | Matrix, number, string":function(t,e,r){if("asc"===r)return s(t,e,u);if("desc"===r)return s(t,e,a);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":s})}var n=r(6).isInteger;e.name="partitionSelect",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(79)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=a("compare",{"boolean, boolean":function(t,e){return t===e?0:t>e?1:-1},"number, number":function(t,r){return t===r||n(t,r,e.epsilon)?0:t>r?1:-1},"BigNumber, BigNumber":function(r,i){return r.eq(i)||o(r,i,e.epsilon)?new t.BigNumber(0):new t.BigNumber(r.cmp(i))},"Fraction, Fraction":function(e,r){return new t.Fraction(e.compare(r))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return d(t.value,e.value)},"string, string":function(t,e){return t===e?0:t>e?1:-1},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,d);break;default:r=l(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,d,!1);break;default:r=h(t,e,d)}}return r},"Array, Array":function(t,e){return d(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return d(s(t),e)},"Matrix, Array":function(t,e){return d(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,d,!1);break;default:r=f(t,e,d,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,d,!0);break;default:r=f(e,t,d,!0)}return r},"Array, any":function(t,e){return f(s(t),e,d,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,d,!0).valueOf()}});return d.toTex=void 0,d}var n=r(6).nearlyEqual,o=r(49);e.name="compare",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,c){function h(t,e,r){if(void 0!==r){if("string"!=typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";if(1!==e.length)throw new n(e.length,1);var i=e[0];if("number"!=typeof i||!a(i))throw new TypeError("Invalid size, must contain positive integers (size: "+s(e)+")");if(t.length>i)return t.substring(0,i);if(t.length<i){for(var o=t,l=0,u=i-t.length;l<u;l++)o+=r;return o}return t}var f=i(r(52)),d=function(t,r,i){if(2!=arguments.length&&3!=arguments.length)throw new o("resize",arguments.length,2,3);if(r&&r.isMatrix===!0&&(r=r.valueOf()),r.length&&r[0]&&r[0].isBigNumber===!0&&(r=r.map(function(t){return t&&t.isBigNumber===!0?t.toNumber():t})),t&&t.isMatrix===!0)return t.resize(r,i,!0);if("string"==typeof t)return h(t,r,i);var n=!Array.isArray(t)&&"Array"!==e.matrix;if(0==r.length){for(;Array.isArray(t);)t=t[0];return l(t)}Array.isArray(t)||(t=[t]),t=l(t);var a=u.resize(t,r,i);return n?f(a):a};return d.toTex=void 0,d}var n=r(42),o=r(11),a=r(6).isInteger,s=r(23).format,l=r(3).clone,u=r(40);e.name="resize",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(52)),s=o("size",{Matrix:function(t){return a(t.size())},Array:n.size,string:function(t){return"Array"===e.matrix?[t.length]:a([t.length])},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===e.matrix?[]:a([])}});return s.toTex=void 0,s}var n=r(40);e.name="size",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t){if("asc"===t)return c;if("desc"===t)return h;throw new Error('String "asc" or "desc" expected')}function s(t){if(1!==n(t).length)throw new Error("One dimensional array expected")}function l(t){if(1!==t.size().length)throw new Error("One dimensional matrix expected")}var u=i(r(52)),c=i(r(441)),h=function(t,e){return-c(t,e)},f=o("sort",{Array:function(t){return s(t),t.sort(c)},Matrix:function(t){return l(t),u(t.toArray().sort(c),t.storage())},"Array, function":function(t,e){return s(t),t.sort(e)},"Matrix, function":function(t,e){return l(t),u(t.toArray().sort(e),t.storage())},"Array, string":function(t,e){return s(t),t.sort(a(e))},"Matrix, string":function(t,e){return l(t),u(t.toArray().sort(a(e)),t.storage())}});return f.toTex=void 0,f}var n=r(40).size;e.name="sort",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=a("squeeze",{Array:function(t){return o.squeeze(n.clone(t))},Matrix:function(t){var e=o.squeeze(t.toArray());return Array.isArray(e)?s(e):e},any:function(t){return n.clone(t)}});return l.toTex=void 0,l}var n=r(3),o=r(40);e.name="squeeze",e.factory=i},function(t,e,r){t.exports=[r(416),r(414),r(415),r(447),r(449),r(450),r(451),r(453),r(454)]},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){var r=e.size().length,i=t.size().length;if(r>1)throw new Error("first object must be one dimensional");if(i>1)throw new Error("second object must be one dimensional");if(r!==i)throw new Error("Length of two vectors must be equal");var n=l(t);if(0===n)throw new Error("Sum of elements in first object must be non zero");var o=l(e);if(0===o)throw new Error("Sum of elements in second object must be non zero");var a=s(t,l(t)),d=s(e,l(e)),p=l(u(a,h(c(a,d))));return f(p)?p:Number.NaN}var a=i(r(52)),s=i(r(327)),l=i(r(448)),u=i(r(84)),c=i(r(369)),h=i(r(383)),f=i(r(89)),d=n("kldivergence",{"Array, Array":function(t,e){return o(a(t),a(e))},"Matrix, Array":function(t,e){return o(t,a(e))},"Array, Matrix":function(t,e){return o(a(t),e)},"Matrix, Matrix":function(t,e){return o(t,e)}});return d}e.name="kldivergence",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(r){var i=void 0;if(n(r,function(t){i=void 0===i?t:s(i,t)}),void 0===i)switch(e.number){case"number":return 0;case"BigNumber":return new t.BigNumber(0);case"Fraction":return new t.Fraction(0);default:return 0}return i}var s=i(r(53)),l=o("sum",{"Array | Matrix":function(t){return a(t)},"Array | Matrix, number | BigNumber":function(){throw new Error("sum(A, dim) is not yet supported")},"...":function(t){return a(t)}});return l.toTex=void 0,l}var n=r(322);e.name="sum",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=i(r(51)),s=i(r(84)),l=i(r(327)),u=i(r(414)),c=i(r(417)),h=i(r(379));return o("multinomial",{"Array | Matrix":function(t){var e=0,r=1;return n(t,function(t){if(!c(t)||!h(t))throw new TypeError("Positive integer value expected in function multinomial");e=a(e,t),r=s(r,u(t))}),l(u(e),r)}})}var n=r(322);e.name="multinomial",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(414)),l=a("permutations",{"number | BigNumber":s,"number, number":function(t,e){var r,i;if(!o(t)||t<0)throw new TypeError("Positive integer value expected in function permutations");if(!o(e)||e<0)throw new TypeError("Positive integer value expected in function permutations");if(e>t)throw new TypeError("second argument k must be less than or equal to first argument n");for(r=1,i=t-e+1;i<=t;i++)r*=i;return r},"BigNumber, BigNumber":function(e,r){var i,o;if(!n(e)||!n(r))throw new TypeError("Positive integer value expected in function permutations");if(r.gt(e))throw new TypeError("second argument k must be less than or equal to first argument n");for(i=new t.BigNumber(1),o=e.minus(r).plus(1);o.lte(e);o=o.plus(1))i=i.times(o);return i}});return l.toTex=void 0,l}function n(t){return t.isInteger()&&t.gte(0)}var o=r(6).isInteger;e.name="permutations",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(452)),a=o("uniform").pickRandom;return a.toTex=void 0,a}e.name="pickRandom",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,s){function l(t){if(!h.hasOwnProperty(t))throw new Error("Unknown distribution "+t);var e=Array.prototype.slice.call(arguments,1),r=h[t].apply(this,e);return function(t){var e={random:function(t,e,r){var s,l,c;if(arguments.length>3)throw new n("random",arguments.length,0,3);if(1===arguments.length?o(t)?s=t:c=t:2===arguments.length?o(t)?(s=t,c=e):(l=t,c=e):(s=t,l=e,c=r),void 0!==l&&!a(l)||void 0!==c&&!a(c))throw new TypeError("Invalid argument in function random");if(void 0===c&&(c=1),void 0===l&&(l=0),void 0!==s){var f=h(s.valueOf(),l,c,i);return s&&s.isMatrix===!0?u(f):f}return i(l,c)},randomInt:s({"number | Array":function(t){var e=0;if(o(t)){var r=t,i=1,n=h(r.valueOf(),e,i,l);return r&&r.isMatrix===!0?u(n):n}var i=t;return l(e,i)},"number | Array, number":function(t,e){if(o(t)){var r=t,i=e,n=0,a=h(r.valueOf(),n,i,l);return r&&r.isMatrix===!0?u(a):a}var n=t,i=e;return l(n,i)},"Array, number, number":function(t,e,r){var i=h(t.valueOf(),e,r,l);return t&&t.isMatrix===!0?u(i):i}}),pickRandom:s({Array:function(t){return r(t)},"Array, number | Array":function(t,e){var i,n;if(Array.isArray(e))n=e;else{if(!a(e))throw new TypeError("Invalid argument in function pickRandom");i=e}return r(t,i,n)},"Array, number | Array, Array | number":function(t,e,i){var n,o;if(Array.isArray(e)?(o=e,n=i):(o=i,n=e),!Array.isArray(o)||!a(n))throw new TypeError("Invalid argument in function pickRandom");return r(t,n,o)}})},r=function(t,e,r){var i="undefined"==typeof e;if(i&&(e=1),t&&t.isMatrix===!0)t=t.valueOf();else if(!Array.isArray(t))throw new TypeError("Unsupported type of value in function pickRandom");if(c.size(t).length>1)throw new Error("Only one dimensional vectors supported");if("undefined"!=typeof r){if(r.length!=t.length)throw new Error("Weights must have the same length as possibles");for(var n=0,o=0,s=r.length;o<s;o++){if(!a(r[o])||r[o]<0)throw new Error("Weights must be an array of positive numbers");n+=r[o]}}var l=t.length;if(0==l)return[];if(e>=l)return t;for(var u,h=[];h.length<e;){if("undefined"==typeof r)u=t[Math.floor(Math.random()*l)];else for(var f=Math.random()*n,o=0,s=t.length;o<s;o++)if(f-=r[o],f<0){u=t[o];break}h.indexOf(u)==-1&&h.push(u)}return i?h[0]:h},i=function(e,r){return e+t()*(r-e)},l=function(e,r){return Math.floor(e+t()*(r-e))},h=function(t,e,r,i){var n,o,a=[];if(t=t.slice(0),t.length>1)for(var o=0,n=t.shift();o<n;o++)a.push(h(t,e,r,i));else for(var o=0,n=t.shift();o<n;o++)a.push(i(e,r));return a};return e}(r)}var u=i(r(52)),c=r(40),h={uniform:function(){return Math.random},normal:function(){return function(){for(var t,e,r=-1;r<0||r>1;)t=Math.random(),e=Math.random(),r=1/6*Math.pow(-2*Math.log(t),.5)*Math.cos(2*Math.PI*e)+.5;return r}}};return l.toTex=void 0,l}var n=r(11),o=r(320),a=r(6).isNumber;e.name="distribution",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(452)),a=o("uniform").random;return a.toTex=void 0,a}e.name="random",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(452)),a=o("uniform").randomInt;return a.toTex=void 0,a}e.name="randomInt",e.factory=i},function(t,e,r){t.exports=[r(441),r(456),r(88),r(64),r(352),r(60),r(457),r(458)]},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(Array.isArray(t)){if(Array.isArray(e)){var r=t.length;if(r!==e.length)return!1;for(var i=0;i<r;i++)if(!o(t[i],e[i]))return!1;return!0}return!1}return!Array.isArray(e)&&a(t,e)}var a=i(r(88)),s=n("deepEqual",{"any, any":function(t,e){return o(t.valueOf(),e.valueOf())}});return s.toTex=void 0,s}e.name="deepEqual",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("smallerEq",{"boolean, boolean":function(t,e){return t<=e},"number, number":function(t,r){return t<=r||n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return t.lte(r)||o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return 1!==t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return t<=e},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,p);break;default:r=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,p,!1);break;default:r=h(t,e,p)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,p,!1);break;default:r=f(t,e,p,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,p,!0);break;default:r=f(e,t,p,!0)}return r},"Array, any":function(t,e){return f(s(t),e,p,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,p,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+d.operators.smallerEq+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="smallerEq",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){var s=i(r(52)),l=i(r(61)),u=i(r(62)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=r(32),p=a("unequal",{"any, any":function(t,e){return null===t?null!==e:null===e?null!==t:void 0===t?void 0!==e:void 0===e?void 0!==t:g(t,e)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=u(t,e,g);break;default:r=l(e,t,g,!0)}break;default:switch(e.storage()){case"sparse":r=l(t,e,g,!1);break;default:r=h(t,e,g)}}return r},"Array, Array":function(t,e){return p(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return p(s(t),e)},"Matrix, Array":function(t,e){return p(t,s(e))},"Matrix, any":function(t,e){var r;switch(t.storage()){case"sparse":r=c(t,e,g,!1);break;default:r=f(t,e,g,!1)}return r},"any, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,g,!0);break;default:r=f(e,t,g,!0)}return r},"Array, any":function(t,e){return f(s(t),e,g,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,g,!0).valueOf()}}),g=a("_unequal",{"boolean, boolean":function(t,e){return t!==e},"number, number":function(t,r){return!n(t,r,e.epsilon)},"BigNumber, BigNumber":function(t,r){return!o(t,r,e.epsilon)},"Fraction, Fraction":function(t,e){return!t.equals(e)},"Complex, Complex":function(t,e){return!t.equals(e)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return t!==e}});return p.toTex={2:"\\left(${args[0]}"+d.operators.unequal+"${args[1]}\\right)"},p}var n=r(6).nearlyEqual,o=r(49);e.name="unequal",e.factory=i},function(t,e,r){t.exports=[r(460)]},function(t,e,r){"use strict";function i(t,e,r,i){function h(t){var e,r=t*t,i=l[0][4]*r,n=r;for(e=0;e<3;e+=1)i=(i+l[0][e])*r,n=(n+u[0][e])*r;return t*(i+l[0][3])/(n+u[0][3])}function f(t){var e,r=l[1][8]*t,i=t;for(e=0;e<7;e+=1)r=(r+l[1][e])*t,i=(i+u[1][e])*t;var n=(r+l[1][7])/(i+u[1][7]),o=parseInt(16*t)/16,a=(t-o)*(t+o);return Math.exp(-o*o)*Math.exp(-a)*n}function d(t){var e,r=1/(t*t),i=l[2][5]*r,n=r;for(e=0;e<4;e+=1)i=(i+l[2][e])*r,n=(n+u[2][e])*r;var o=r*(i+l[2][4])/(n+u[2][4]);o=(s-o)/t,r=parseInt(16*t)/16;var a=(t-r)*(t+r);return Math.exp(-r*r)*Math.exp(-a)*o}var p=i("erf",{number:function(t){var e=Math.abs(t);return e>=c?o(t):e<=a?o(t)*h(e):e<=4?o(t)*(1-f(e)):o(t)*(1-d(e))},BigNumber:function(e){return new t.BigNumber(p(e.toNumber()))},"Array | Matrix":function(t){return n(t,p)}});return p.toTex={1:"erf\\left(${args[0]}\\right)"},p}var n=r(19),o=r(6).sign,a=.46875,s=.5641895835477563,l=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],u=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],c=Math.pow(2,53);e.name="erf",e.factory=i},function(t,e,r){t.exports=[r(321),r(326),r(462),r(331),r(463),r(464),r(465),r(466),r(448),r(467)]},function(t,e,r){"use strict";function i(t,e,i,a){function s(t){t=n(t.valueOf());var e=t.length;if(0==e)throw new Error("Cannot calculate median of an empty array");if(e%2==0){for(var r=e/2-1,i=h(t,r+1),o=t[r],a=0;a<r;++a)c(t[a],o)>0&&(o=t[a]);return p(o,i)}var s=h(t,(e-1)/2);return d(s)}var l=i(r(53)),u=i(r(81)),c=i(r(441)),h=i(r(440)),f=a("median",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("median(A, dim) is not yet supported")},"...":function(t){if(o(t))throw new TypeError("Scalar values expected in function median");return s(t)}}),d=a({"number | BigNumber | Unit":function(t){return t}}),p=a({"number | BigNumber | Unit, number | BigNumber | Unit":function(t,e){return u(l(t,e),2)}});return f.toTex=void 0,f}var n=r(40).flatten,o=(r(323),r(324));e.name="median",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){function o(t){t=n(t.valueOf());var e=t.length;if(0==e)throw new Error("Cannot calculate mode of an empty array");var r={},i=[],o=0;for(var a in t)t[a]in r||(r[t[a]]=0),r[t[a]]++,r[t[a]]==o?i.push(t[a]):r[t[a]]>o&&(o=r[t[a]],i=[t[a]]);return i}var a=i("mode",{"Array | Matrix":o,"...":function(t){return o(t)}});return a}var n=r(40).flatten;e.name="mode",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){function a(t){var e=void 0;if(n(t,function(t){e=void 0===e?t:s(e,t)}),void 0===e)throw new Error("Cannot calculate prod of an empty array");return e}var s=i(r(80)),l=o("prod",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("prod(A, dim) is not yet supported")},"...":function(t){return a(t)}});return l.toTex=void 0,l}var n=r(322);e.name="prod",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,l){function u(e,r,i){var a,l,u;if(arguments.length<2||arguments.length>3)throw new SyntaxError("Function quantileSeq requires two or three parameters");if(s(e)){if(i=i||!1,"boolean"==typeof i){if(l=e.valueOf(),o(r)){if(r<0)throw new Error("N/prob must be non-negative");if(r<=1)return c(l,r,i);if(r>1){if(!n(r))throw new Error("N must be a positive integer");var h=r+1;a=new Array(r);for(var f=0;f<r;)a[f]=c(l,++f/h,i);return a}}if(r&&r.isBigNumber){if(r.isNegative())throw new Error("N/prob must be non-negative");if(u=new r.constructor(1),r.lte(u))return c(l,r,i);if(r.gt(u)){if(!r.isInteger())throw new Error("N must be a positive integer");var d=r.toNumber();if(d>4294967295)throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var h=new t.BigNumber(d+1);a=new Array(d);for(var f=0;f<d;)a[f]=c(l,new t.BigNumber(++f).div(h),i);return a}}if(Array.isArray(r)){a=new Array(r.length);for(var f=0;f<a.length;++f){var p=r[f];if(o(p)){if(p<0||p>1)throw new Error("Probability must be between 0 and 1, inclusive")}else{if(!p||!p.isBigNumber)throw new TypeError("Unexpected type of argument in function quantileSeq");if(u=new p.constructor(1),p.isNegative()||p.gt(u))throw new Error("Probability must be between 0 and 1, inclusive")}a[f]=c(l,p,i)}return a}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}function c(t,e,r){var i=a(t),n=i.length;if(0===n)throw new Error("Cannot calculate quantile of an empty sequence");if(o(e)){var s=e*(n-1),l=s%1;if(0===l){var u=r?i[s]:d(i,s);return g(u),u}var c,m,y=Math.floor(s);if(r)c=i[y],m=i[y+1];else{m=d(i,y+1),c=i[y];for(var v=0;v<y;++v)p(i[v],c)>0&&(c=i[v])}return g(c),g(m),h(f(c,1-l),f(m,l))}var s=e.times(n-1);if(s.isInteger()){s=s.toNumber();var u=r?i[s]:d(i,s);return g(u),u}var c,m,y=s.floor(),l=s.minus(y),b=y.toNumber();if(r)c=i[b],m=i[b+1];else{m=d(i,b+1),c=i[b];for(var v=0;v<b;++v)p(i[v],c)>0&&(c=i[v])}g(c),g(m);var E=new l.constructor(1);return h(f(c,E.minus(l)),f(m,l))}var h=i(r(51)),f=i(r(84)),d=i(r(440)),p=i(r(441)),g=l({"number | BigNumber | Unit":function(t){return t}});return u}var n=r(6).isInteger,o=r(6).isNumber,a=r(40).flatten,s=r(320);e.name="quantileSeq",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){function o(t,e){if(0==t.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");return a(s.apply(null,arguments))}var a=i(r(378)),s=i(r(467)),l=n("std",{"Array | Matrix":o,"Array | Matrix, string":o,"...":function(t){return o(t)}});return l.toTex=void 0,l}e.name="std",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,a){function s(e,r){var i=0,n=0;if(0==e.length)throw new SyntaxError("Function var requires one or more parameters (0 provided)");if(o(e,function(t){i=l(i,t),n++}),0===n)throw new Error("Cannot calculate var of an empty array");var a=h(i,n);switch(i=0,o(e,function(t){var e=u(t,a);i=l(i,c(e,e))}),r){case"uncorrected":return h(i,n);case"biased":return h(i,n+1);case"unbiased":var s=i&&i.isBigNumber===!0?new t.BigNumber(0):0;return 1==n?s:h(i,n-1);default:throw new Error('Unknown normalization "'+r+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}var l=i(r(53)),u=i(r(77)),c=i(r(80)),h=i(r(81)),f=a("variance",{"Array | Matrix":function(t){return s(t,n)},"Array | Matrix, string":s,"...":function(t){return s(t,n)}});return f.toTex="\\mathrm{Var}\\left(${args}\\right)",f}var n="unbiased",o=r(322);e.name="var",e.factory=i},function(t,e,r){t.exports=[r(90),r(469)]},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("print",{"string, Object":n,"string, Object, number | Object":n});return o.toTex=void 0,o}function n(t,e,r){return t.replace(/\$([\w\.]+)/g,function(t,i){for(var n=i.split("."),s=e[n.shift()];n.length&&void 0!==s;){var l=n.shift();s=l?s[l]:s+"."}return void 0!==s?o(s)?s:a(s,r):t})}var o=r(23).isString,a=r(23).format;e.name="print",e.factory=i},function(t,e,r){t.exports=[r(471),r(472),r(473),r(474),r(475),r(476),r(477),r(478),r(479),r(480),r(481),r(482),r(483),r(484),r(485),r(486),r(487),r(488),r(489),r(490),r(491),r(492),r(493),r(494),r(495)]},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acos",{number:function(r){return r>=-1&&r<=1||e.predictable?Math.acos(r):new t.Complex(r,0).acos()},Complex:function(t){return t.acos()},BigNumber:function(t){return t.acos()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\cos^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acos",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("acosh",{number:function(r){return r>=1||e.predictable?o(r):r<=-1?new t.Complex(Math.log(Math.sqrt(r*r-1)-r),Math.PI):new t.Complex(r,0).acosh()},Complex:function(t){return t.acosh()},BigNumber:function(t){return t.acosh()},"Array | Matrix":function(t){return n(t,a)}});return a.toTex={1:"\\cosh^{-1}\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.acosh||function(t){return Math.log(Math.sqrt(t*t-1)+t)};e.name="acosh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acot",{number:function(t){return Math.atan(1/t)},Complex:function(t){return t.acot()},BigNumber:function(e){return new t.BigNumber(1).div(e).atan()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\cot^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acot",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acoth",{number:function(r){return r>=1||r<=-1||e.predictable?isFinite(r)?(Math.log((r+1)/r)+Math.log(r/(r-1)))/2:0:new t.Complex(r,0).acoth()},Complex:function(t){return t.acoth()},BigNumber:function(e){return new t.BigNumber(1).div(e).atanh()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\coth^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acoth",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acsc",{number:function(r){return r<=-1||r>=1||e.predictable?Math.asin(1/r):new t.Complex(r,0).acsc()},Complex:function(t){return t.acsc()},BigNumber:function(e){return new t.BigNumber(1).div(e).asin()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\csc^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acsc",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("acsch",{number:function(t){return t=1/t,Math.log(t+Math.sqrt(t*t+1))},Complex:function(t){return t.acsch()},BigNumber:function(e){return new t.BigNumber(1).div(e).asinh()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="acsch",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("asec",{number:function(r){return r<=-1||r>=1||e.predictable?Math.acos(1/r):new t.Complex(r,0).asec()},Complex:function(t){return t.asec()},BigNumber:function(e){return new t.BigNumber(1).div(e).acos()},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\sec^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="asec",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,o){var a=(o.find(i(r(472)),["Complex"]),o("asech",{number:function(r){if(r<=1&&r>=-1||e.predictable){r=1/r;var i=Math.sqrt(r*r-1);return r>0||e.predictable?Math.log(i+r):new t.Complex(Math.log(i-r),Math.PI)}return new t.Complex(r,0).asech()},Complex:function(t){return t.asech()},BigNumber:function(e){return new t.BigNumber(1).div(e).acosh()},"Array | Matrix":function(t){return n(t,a)}}));return a.toTex={1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},a}var n=r(19);e.name="asech",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("asin",{number:function(r){return r>=-1&&r<=1||e.predictable?Math.asin(r):new t.Complex(r,0).asin()},Complex:function(t){return t.asin()},BigNumber:function(t){return t.asin()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\sin^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="asin",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("asinh",{number:Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},Complex:function(t){return t.asinh()},BigNumber:function(t){return t.asinh()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\sinh^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="asinh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("atan",{number:function(t){return Math.atan(t)},Complex:function(t){return t.atan()},BigNumber:function(t){return t.atan()},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\tan^{-1}\\left(${args[0]}\\right)"},o}var n=r(19);e.name="atan",e.factory=i},function(t,e,r){"use strict";function i(t,e,i,n){var o=i(r(52)),a=i(r(370)),s=i(r(61)),l=i(r(372)),u=i(r(85)),c=i(r(63)),h=i(r(57)),f=i(r(58)),d=n("atan2",{"number, number":Math.atan2,"BigNumber, BigNumber":function(e,r){return t.BigNumber.atan2(e,r)},"Matrix, Matrix":function(t,e){var r;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":r=l(t,e,d,!1);break;default:r=a(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":r=s(t,e,d,!1);break;default:r=h(t,e,d)}}return r},"Array, Array":function(t,e){return d(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return d(o(t),e)},"Matrix, Array":function(t,e){return d(t,o(e))},"Matrix, number | BigNumber":function(t,e){var r;switch(t.storage()){case"sparse":r=u(t,e,d,!1);break;default:r=f(t,e,d,!1)}return r},"number | BigNumber, Matrix":function(t,e){var r;switch(e.storage()){case"sparse":r=c(e,t,d,!0);
break;default:r=f(e,t,d,!0)}return r},"Array, number | BigNumber":function(t,e){return f(o(t),e,d,!1).valueOf()},"number | BigNumber, Array":function(t,e){return f(o(e),t,d,!0).valueOf()}});return d.toTex={2:"\\mathrm{atan2}\\left(${args}\\right)"},d}e.name="atan2",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("atanh",{number:function(r){return r<=1&&r>=-1||e.predictable?o(r):new t.Complex(r,0).atanh()},Complex:function(t){return t.atanh()},BigNumber:function(t){return t.atanh()},"Array | Matrix":function(t){return n(t,a,!0)}});return a.toTex={1:"\\tanh^{-1}\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2};e.name="atanh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("cos",{number:Math.cos,Complex:function(t){return t.cos()},BigNumber:function(t){return t.cos()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\cos\\left(${args[0]}\\right)"},o}var n=r(19);e.name="cos",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("cosh",{number:o,Complex:function(t){return t.cosh()},BigNumber:function(t){return t.cosh()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return a(e.value)},"Array | Matrix":function(t){return n(t,a)}});return a.toTex={1:"\\cosh\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.cosh||function(t){return(Math.exp(t)+Math.exp(-t))/2};e.name="cosh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("cot",{number:function(t){return 1/Math.tan(t)},Complex:function(t){return t.cot()},BigNumber:function(e){return new t.BigNumber(1).div(e.tan())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\cot\\left(${args[0]}\\right)"},o}var n=r(19);e.name="cot",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("coth",{number:n,Complex:function(t){return t.coth()},BigNumber:function(e){return new t.BigNumber(1).div(e.tanh())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function coth is no angle");return a(e.value)},"Array | Matrix":function(t){return o(t,a)}});return a.toTex={1:"\\coth\\left(${args[0]}\\right)"},a}function n(t){var e=Math.exp(2*t);return(e+1)/(e-1)}var o=r(19);e.name="coth",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("csc",{number:function(t){return 1/Math.sin(t)},Complex:function(t){return t.csc()},BigNumber:function(e){return new t.BigNumber(1).div(e.sin())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csc is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\csc\\left(${args[0]}\\right)"},o}var n=r(19);e.name="csc",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("csch",{number:n,Complex:function(t){return t.csch()},BigNumber:function(e){return new t.BigNumber(1).div(e.sinh())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csch is no angle");return a(e.value)},"Array | Matrix":function(t){return o(t,a)}});return a.toTex={1:"\\mathrm{csch}\\left(${args[0]}\\right)"},a}function n(t){return 0==t?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(t)-Math.exp(-t)))*a(t)}var o=r(19),a=r(6).sign;e.name="csch",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("sec",{number:function(t){return 1/Math.cos(t)},Complex:function(t){return t.sec()},BigNumber:function(e){return new t.BigNumber(1).div(e.cos())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sec is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o)}});return o.toTex={1:"\\sec\\left(${args[0]}\\right)"},o}var n=r(19);e.name="sec",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("sech",{number:n,Complex:function(t){return t.sech()},BigNumber:function(e){return new t.BigNumber(1).div(e.cosh())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sech is no angle");return a(e.value)},"Array | Matrix":function(t){return o(t,a)}});return a.toTex={1:"\\mathrm{sech}\\left(${args[0]}\\right)"},a}function n(t){return 2/(Math.exp(t)+Math.exp(-t))}var o=r(19);e.name="sech",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("sin",{number:Math.sin,Complex:function(t){return t.sin()},BigNumber:function(t){return t.sin()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\sin\\left(${args[0]}\\right)"},o}var n=r(19);e.name="sin",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("sinh",{number:o,Complex:function(t){return t.sinh()},BigNumber:function(t){return t.sinh()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return a(e.value)},"Array | Matrix":function(t){return n(t,a,!0)}});return a.toTex={1:"\\sinh\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2};e.name="sinh",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("tan",{number:Math.tan,Complex:function(t){return t.tan()},BigNumber:function(t){return t.tan()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tan is no angle");return o(e.value)},"Array | Matrix":function(t){return n(t,o,!0)}});return o.toTex={1:"\\tan\\left(${args[0]}\\right)"},o}var n=r(19);e.name="tan",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var a=i("tanh",{number:o,Complex:function(t){return t.tanh()},BigNumber:function(t){return t.tanh()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tanh is no angle");return a(e.value)},"Array | Matrix":function(t){return n(t,a,!0)}});return a.toTex={1:"\\tanh\\left(${args[0]}\\right)"},a}var n=r(19),o=Math.tanh||function(t){var e=Math.exp(2*t);return(e-1)/(e+1)};e.name="tanh",e.factory=i},function(t,e,r){t.exports=[r(497)]},function(t,e,r){"use strict";function i(t,e,i,n){var o=r(32),a=i(r(52)),s=i(r(57)),l=i(r(58)),u=n("to",{"Unit, Unit | string":function(t,e){return t.to(e)},"Matrix, Matrix":function(t,e){return s(t,e,u)},"Array, Array":function(t,e){return u(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return u(a(t),e)},"Matrix, Array":function(t,e){return u(t,a(e))},"Matrix, any":function(t,e){return l(t,e,u,!1)},"any, Matrix":function(t,e){return l(e,t,u,!0)},"Array, any":function(t,e){return l(a(t),e,u,!1).valueOf()},"any, Array":function(t,e){return l(a(e),t,u,!0).valueOf()}});return u.toTex={2:"\\left(${args[0]}"+o.operators.to+"${args[1]}\\right)"},u}e.name="to",e.factory=i},function(t,e,r){t.exports=[r(499),r(417),r(366),r(89),r(379),r(500),r(431),r(501),r(91)]},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("clone",{any:n.clone});return o.toTex=void 0,o}var n=r(3);e.name="clone",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isPrime",{number:function(t){if(t<2)return!1;if(2==t)return!0;if(t%2==0)return!1;for(var e=3;e*e<=t;e+=2)if(t%e==0)return!1;return!0},BigNumber:function(e){if(e.lt(2))return!1;if(e.equals(2))return!0;if(e.mod(2).isZero())return!1;for(var r=t.BigNumber(3);r.times(r).lte(e);r=r.plus(1))if(e.mod(r).isZero())return!1;return!0},"Array | Matrix":function(t){return n(t,o)}});return o}var n=r(19);e.name="isPrime",e.factory=i},function(t,e,r){"use strict";function i(t,e,r,i){var o=i("isNaN",{number:function(t){return Number.isNaN(t)},BigNumber:function(t){return t.isNaN()},Fraction:function(t){return!1},Complex:function(t){return Number.isNaN(t.re)&&Number.isNaN(t.im)},Unit:function(t){return Number.isNaN(t.value)},"Array | Matrix":function(t){return n(t,Number.isNaN)}});return o}var n=r(19);r(6);e.name="isNaN",e.factory=i},function(t,e,r){t.exports=[r(503)]},function(t,e){"use strict";function r(t,e,r,i){return function(e,r){var i=t[r&&r.mathjs];return i&&"function"==typeof i.fromJSON?i.fromJSON(r):r}}e.name="reviver",e.path="json",e.factory=r},function(t,e,r){"use strict";var i=r(11),n=r(42),o=r(43);t.exports=[{name:"ArgumentsError",path:"error",factory:function(){return i}},{name:"DimensionError",path:"error",factory:function(){return n}},{name:"IndexError",path:"error",factory:function(){return o}}]}])}),define("scripts/util/Transformation",["./math"],function(t){var e=function(){};return e.prototype.setPoints=function(e,r){y0=[],e.forEach(function(t){y0.push(t[0],t[1])});for(var i=[[],[],[],[],[],[]],n=0;n<r.length;n++)i[0].push(r[n][0]),i[0].push(0),i[1].push(r[n][1]),i[1].push(0),i[2].push(1),i[2].push(0),i[3].push(0),i[3].push(r[n][0]),i[4].push(0),i[4].push(r[n][1]),i[5].push(0),i[5].push(1);var o=i;o=t.transpose(o);var a=t.transpose(o),s=t.multiply(a,o),l=t.inv(s),u=t.multiply(l,a),c=t.multiply(u,y0);this.a=c[0],this.b=c[1],this.c=c[2],this.d=c[3],this.e=c[4],this.f=c[5]},e.prototype.transform=function(t){var e=this.a*t[0]+this.b*t[1]+this.c,r=this.d*t[0]+this.e*t[1]+this.f;return[e,r]},e}),"undefined"!=typeof module&&(module.exports=simpleheat),simpleheat.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(t){return this._data=t,this},max:function(t){return this._max=t,this},fixedOpacity:function(t){return this._fixedOpacity=t,this},add:function(t){return this._data.push(t),this},clear:function(){return this._data=[],this},radius:function(t,e){e=void 0===e?15:e;var r=this._circle=this._createCanvas(),i=r.getContext("2d"),n=this._r=t+e;return r.width=r.height=2*n,i.shadowOffsetX=i.shadowOffsetY=2*n,i.shadowBlur=e,i.shadowColor="black",i.beginPath(),i.arc(-n,-n,t,0,2*Math.PI,!0),i.closePath(),i.fill(),this},resize:function(){this._width=this._canvas.width,this._height=this._canvas.height},gradient:function(t){var e=this._createCanvas(),r=e.getContext("2d"),i=r.createLinearGradient(0,0,0,256);e.width=1,e.height=256;for(var n in t)i.addColorStop(+n,t[n]);return r.fillStyle=i,r.fillRect(0,0,1,256),this._grad=r.getImageData(0,0,1,256).data,this},draw:function(t){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var e=this._ctx;e.clearRect(0,0,this._width,this._height);for(var r,i=0,n=this._data.length;i<n;i++)r=this._data[i],e.globalAlpha=Math.max(r[2]/this._max,void 0===t?.05:t),e.drawImage(this._circle,r[0]-this._r,r[1]-this._r);var o=e.getImageData(0,0,this._width,this._height);return this._colorize(o.data,this._grad),e.putImageData(o,0,0),this},_colorize:function(t,e){for(var r,i=0,n=t.length;i<n;i+=4)r=4*t[i+3],r&&(t[i]=e[r],t[i+1]=e[r+1],t[i+2]=e[r+2],null!=this._fixedOpacity&&(t[i+3]=this._fixedOpacity))},_createCanvas:function(){return"undefined"!=typeof document?document.createElement("canvas"):new this._canvas.constructor}},define("thirdparty/simpleheat",function(){}),define("scripts/util/HeatmapPanel",["./Transformation","../csvToGrid/Converter","../../thirdparty/simpleheat"],function(t,e){var r=function(t,e,r){this.wwd=t,this.navigator=e,this.controls=r,this.myHeatmap={},this.heats={};var i=this;this.index=0,this.fileTypeHeatmap=1,$("#fileTypeHeatmap").change(function(){var t=$("#fileTypeHeatmap").val();"0"==t?($("#csv-heatmap").show(),$("#HeatmapTxtArea").hide(),i.fileTypeHeatmap=0):"1"==t&&($("#csv-heatmap").hide(),$("#HeatmapTxtArea").show(),i.fileTypeHeatmap=1)}),$("#loadHeatmapBtn").on("click",function(){i.requestData()})};return r.prototype.requestData=function(){$("#loading").show();var t=this;if(0==this.fileTypeHeatmap)var r=$("#csv-heatmap").get(0).files[0];else var r=document.getElementById("HeatmapTxtArea").value;var i=document.getElementById("HeatmapTxtDelimiter").value,n=Number(document.getElementById("latCSV").value),o=Number(document.getElementById("lonCSV").value);if(!n||!o)return alert("Please select the latitude and longitude columns"),void $("#loading").hide();var a=Number(document.getElementById("intensityCSV").value);try{var s=new Promise(function(t){e.loadData(r,t,i)})}catch(t){$("#loading").hide(),alert("Error occurred:"+t)}var l=[],u=[],c=1/0,h=-(1/0);s.then(function(e){$("#loading").hide(),e.forEach(function(t){var e=Number(t[n]),r=Number(t[o]);if(a){var i=Number(t[a]);isNaN(i)||(u.push(i),h=Math.max(i,h),c=Math.min(i,c))}isNaN(e)||isNaN(r)||l.push([e,r])}),a&&(u=u.map(function(t){return(t-c)/(h-c)*100})),t.addHeatmap(l,u)}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})},r.prototype.addHeatmap=function(t,e){var r=this,i=this.wwd,n=document.createElement("canvas"),o=i.canvas;n.width=o.width,n.height=o.height;var a=simpleheat(n);a.points=t,a.intensities=e,a.canvas=n;var s=new WorldWind.SurfaceImage(new WorldWind.Sector(-90,90,-180,180),new WorldWind.ImageSource(n)),l=new WorldWind.RenderableLayer;this.heats[this.index]=a,l.index=this.index++,a.index=this.index,this.myHeatmap[this.index]=l,l.displayName="Heatmap",l.addRenderable(s),i.addLayer(l);var u=this.navigator;i.redraw(),r.createInterface(i),u.handleWheelEvent=function(t){this.worldWindow.navigator.getAsLookAt(this.worldWindow.globe,this.lookAt);var e;t.deltaMode==WheelEvent.DOM_DELTA_PIXEL?e=t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_LINE?e=40*t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_PAGE&&(e=400*t.deltaY);var i=1+2*e/1e3;this.lookAt.range*=i,this.applyLimits(),this.worldWindow.navigator.setAsLookAt(this.worldWindow.globe,this.lookAt),this.worldWindow.redraw(),r.drawHeatmap(this.lookAt.range)},this.controls.heatmap=this.drawHeatmap.bind(this),i.goTo(new WorldWind.Position(t[0][1],t[0][0]),function(){r.drawHeatmap(u.lookAt.range)})},r.prototype.drawHeatmap=function(e){var r=this.wwd,i=this.heats,n=r.canvas;for(var o in i)i[o].canvas.height==n.height&&i[o].canvas.width==n.width||(i[o].canvas.height=n.height,i[o].canvas.width=n.width);var a=r.pickTerrain(new WorldWind.Vec2(n.width/2,n.height/2));if(a.objects&&a.objects[0]){a=a.objects[0].position,e>1e7&&(e=1e7);var s=e/Math.cos(Math.PI/8),l=Math.sqrt(Math.pow(s,2)-Math.pow(e,2));l/=1e5;for(var u=a.latitude-l,c=a.latitude+l,h=a.longitude-l,f=a.longitude+l,d=n.width/n.height;d>(f-h)/(c-u);)f+=.1,h-=.1;for(;d<(f-h)/(c-u);)c+=.1,u-=.1;var p=(f-h)/5,g=(c-u)/5,u=u-g,h=h-p,c=c+g,f=f+p,m={minLat:u,minLng:h,maxLat:c,maxLng:f};for(var o in this.myHeatmap){var y=this.myHeatmap[o];y.renderables[0].sector.minLatitude=u,y.renderables[0].sector.minLongitude=h,y.renderables[0].sector.maxLatitude=c,y.renderables[0].sector.maxLongitude=f}for(o in i){var v=i[o],b=new t;b.setPoints([[0,n.height],[0,0],[n.width,0],[n.width,n.height]],[[m.minLng,m.minLat],[m.minLng,m.maxLat],[m.maxLng,m.maxLat],[m.maxLng,m.minLat]]),v.clear(),v.points.forEach(function(t,e){if(m.minLat<=t[1]&&t[1]<=m.maxLat&&m.minLng<=t[0]&&t[0]<=m.maxLng){var r=b.transform(t),i=r[0],n=r[1];if(v.intensities[e])var o=v.intensities[e];else o=80;v.add([i,n,o])}}),v.draw(0)}for(o in this.myHeatmap)y=this.myHeatmap[o],y.renderables[0].imageSourceWasUpdated=!0}},r.prototype.createInterface=function(t){$("#HeatmapList").html("");var e=this;for(var r in e.myHeatmap){var i=e.myHeatmap[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#HeatmapList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myHeatmap[r]),t.redraw(),$(this).remove(),delete e.myHeatmap[r],delete e.heats[r]})}},r}),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("scripts/util/supercluster.min",[],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.supercluster=t()}}(function(){return function t(e,r,i){function n(a,s){if(!r[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return n(r?r:t)},c,c.exports,t,e,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e){"use strict";function r(t){return new i(t)}function i(t){this.options=f(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function n(t,e,r,i,n){return{x:t,y:e,zoom:1/0,id:i,properties:n,parentId:-1,numPoints:r}}function o(t,e){var r=t.geometry.coordinates;return{x:l(r[0]),y:u(r[1]),zoom:1/0,id:e,parentId:-1}}function a(t){return{type:"Feature",properties:s(t),geometry:{type:"Point",coordinates:[c(t.x),h(t.y)]}}}function s(t){var e=t.numPoints,r=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return f(f({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:r})}function l(t){return t/360+.5}function u(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return 0>r?0:r>1?1:r}function c(t){return 360*(t-.5)}function h(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function f(t,e){for(var r in e)t[r]=e[r];return t}function d(t){return t.x}function p(t){return t.y}var g=t("kdbush");e.exports=r,i.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var r="prepare "+t.length+" points";e&&console.time(r),this.points=t;for(var i=t.map(o),n=this.options.maxZoom;n>=this.options.minZoom;n--){+Date.now();this.trees[n+1]=g(i,d,p,this.options.nodeSize,Float32Array),i=this._cluster(i,n)}return this.trees[this.options.minZoom]=g(i,d,p,this.options.nodeSize,Float32Array),this},getClusters:function(t,e){for(var r=this.trees[this._limitZoom(e)],i=r.range(l(t[0]),u(t[3]),l(t[2]),u(t[1])),n=[],o=0;o<i.length;o++){var s=r.points[i[o]];n.push(s.numPoints?a(s):this.points[s.id])}return n},getChildren:function(t,e){for(var r=this.trees[e+1].points[t],i=this.options.radius/(this.options.extent*Math.pow(2,e)),n=this.trees[e+1].within(r.x,r.y,i),o=[],s=0;s<n.length;s++){var l=this.trees[e+1].points[n[s]];l.parentId===t&&o.push(l.numPoints?a(l):this.points[l.id])}return o},getLeaves:function(t,e,r,i){r=r||10,i=i||0;var n=[];return this._appendLeaves(n,t,e,r,i,0),n},getTile:function(t,e,r){var i=this.trees[this._limitZoom(t)],n=Math.pow(2,t),o=this.options.extent,a=this.options.radius,s=a/o,l=(r-s)/n,u=(r+1+s)/n,c={features:[]};return this._addTileFeatures(i.range((e-s)/n,l,(e+1+s)/n,u),i.points,e,r,n,c),0===e&&this._addTileFeatures(i.range(1-s/n,l,1,u),i.points,n,r,n,c),e===n-1&&this._addTileFeatures(i.range(0,l,s/n,u),i.points,-1,r,n,c),c.features.length?c:null},getClusterExpansionZoom:function(t,e){for(;e<this.options.maxZoom;){var r=this.getChildren(t,e);if(e++,1!==r.length)break;t=r[0].properties.cluster_id}return e},_appendLeaves:function(t,e,r,i,n,o){for(var a=this.getChildren(e,r),s=0;s<a.length;s++){var l=a[s].properties;if(l.cluster?o+l.point_count<=n?o+=l.point_count:o=this._appendLeaves(t,l.cluster_id,r+1,i,n,o):n>o?o++:t.push(a[s]),t.length===i)break}return o},_addTileFeatures:function(t,e,r,i,n,o){for(var a=0;a<t.length;a++){var l=e[t[a]];o.features.push({type:1,geometry:[[Math.round(this.options.extent*(l.x*n-r)),Math.round(this.options.extent*(l.y*n-i))]],tags:l.numPoints?s(l):this.points[l.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var r=[],i=this.options.radius/(this.options.extent*Math.pow(2,e)),o=0;o<t.length;o++){var a=t[o];if(!(a.zoom<=e)){a.zoom=e;var s=this.trees[e+1],l=s.within(a.x,a.y,i),u=a.numPoints||1,c=a.x*u,h=a.y*u,f=null;this.options.reduce&&(f=this.options.initial(),this._accumulate(f,a));for(var d=0;d<l.length;d++){var p=s.points[l[d]];if(e<p.zoom){var g=p.numPoints||1;p.zoom=e,c+=p.x*g,h+=p.y*g,u+=g,p.parentId=o,this.options.reduce&&this._accumulate(f,p)}}1===u?r.push(a):(a.parentId=o,r.push(n(c/u,h/u,u,o,f)))}}return r},_accumulate:function(t,e){var r=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(t,r)}}},{kdbush:2}],2:[function(t,e){"use strict";function r(t,e,r,n,o){return new i(t,e,r,n,o)}function i(t,e,r,i,s){e=e||n,r=r||o,s=s||Array,this.nodeSize=i||64,this.points=t,this.ids=new s(t.length),this.coords=new s(2*t.length);for(var l=0;l<t.length;l++)this.ids[l]=l,this.coords[2*l]=e(t[l]),this.coords[2*l+1]=r(t[l]);a(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function n(t){return t[0]}function o(t){return t[1]}var a=t("./sort"),s=t("./range"),l=t("./within");e.exports=r,i.prototype={range:function(t,e,r,i){return s(this.ids,this.coords,t,e,r,i,this.nodeSize)},within:function(t,e,r){return l(this.ids,this.coords,t,e,r,this.nodeSize)}}},{"./range":3,"./sort":4,"./within":5}],3:[function(t,e){"use strict";function r(t,e,r,i,n,o,a){for(var s,l,u=[0,t.length-1,0],c=[];u.length;){var h=u.pop(),f=u.pop(),d=u.pop();if(a>=f-d)for(var p=d;f>=p;p++)s=e[2*p],l=e[2*p+1],s>=r&&n>=s&&l>=i&&o>=l&&c.push(t[p]);else{var g=Math.floor((d+f)/2);s=e[2*g],l=e[2*g+1],s>=r&&n>=s&&l>=i&&o>=l&&c.push(t[g]);var m=(h+1)%2;(0===h?s>=r:l>=i)&&(u.push(d),u.push(g-1),u.push(m)),(0===h?n>=s:o>=l)&&(u.push(g+1),u.push(f),u.push(m))}}return c}e.exports=r},{}],4:[function(t,e){"use strict";function r(t,e,n,o,a,s){if(!(n>=a-o)){var l=Math.floor((o+a)/2);i(t,e,l,o,a,s%2),r(t,e,n,o,l-1,s+1),r(t,e,n,l+1,a,s+1)}}function i(t,e,r,o,a,s){for(;a>o;){if(a-o>600){var l=a-o+1,u=r-o+1,c=Math.log(l),h=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*h*(l-h)/l)*(0>u-l/2?-1:1),d=Math.max(o,Math.floor(r-u*h/l+f)),p=Math.min(a,Math.floor(r+(l-u)*h/l+f));i(t,e,r,d,p,s)}var g=e[2*r+s],m=o,y=a;for(n(t,e,o,r),e[2*a+s]>g&&n(t,e,o,a);y>m;){for(n(t,e,m,y),m++,y--;e[2*m+s]<g;)m++;for(;e[2*y+s]>g;)y--}e[2*o+s]===g?n(t,e,o,y):(y++,n(t,e,y,a)),r>=y&&(o=y+1),y>=r&&(a=y-1)}}function n(t,e,r,i){o(t,r,i),o(e,2*r,2*i),o(e,2*r+1,2*i+1)}function o(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}e.exports=r},{}],5:[function(t,e){"use strict";function r(t,e,r,n,o,a){for(var s=[0,t.length-1,0],l=[],u=o*o;s.length;){var c=s.pop(),h=s.pop(),f=s.pop();if(a>=h-f)for(var d=f;h>=d;d++)i(e[2*d],e[2*d+1],r,n)<=u&&l.push(t[d]);else{var p=Math.floor((f+h)/2),g=e[2*p],m=e[2*p+1];i(g,m,r,n)<=u&&l.push(t[p]);var y=(c+1)%2;(0===c?g>=r-o:m>=n-o)&&(s.push(f),s.push(p-1),s.push(y)),(0===c?r+o>=g:n+o>=m)&&(s.push(p+1),s.push(h),s.push(y))}}return l}function i(t,e,r,i){var n=t-r,o=e-i;return n*n+o*o}e.exports=r},{}]},{},[1])(1)}),define("scripts/util/MarkerCluster",["./supercluster.min","../../worldwind/WorldWind"],function(t,e){var r=function(t,e){e||(e={maxLevel:9,smooth:!1,name:"MarkerCluster",maxCount:3e3,clusterSources:null,attributeColor:null}),this.options=e,this.placemarks=[];var r=e.name||"MarkerCluster";this.layer=new WorldWind.RenderableLayer(r),this.displayName=r,this.globe=t,this.controlLayer=e.controls,this.navigator=e.navigator,this.zoomLevel=0,this.maxCount=e.maxCount||1e3,this.smooth=e.smooth||!1,this.zoomLevels=e.maxLevel||9,this.levels=[],this.maxReached=this.zoomLevels,this.minReached=0,this.createZoomClusters(this.zoomLevels),t&&(t.addLayer(this.layer),(t.controller||t.navigator)&&this.bindNavigator(t.controller))};return r.prototype.off=function(){this.layer.enabled=!1},r.prototype.on=function(){this.layer.enabled=!0},r.prototype.bindNavigator=function(t){var e=t||this.globe.navigator,r=t||WorldWind.LookAtNavigator,i=this;e.clusters||(e.clusters={}),e.clusters[i.options.name]=i,e.handleWheelEvent=function(t){r.prototype?r.prototype.handleWheelEvent.apply(this,arguments):r.__proto__.handleWheelEvent.apply(this,arguments);var n;if(n=this.lookAt&&this.lookAt.range?this.lookAt.range:this.range,i.options.smooth&&(i.globe.goToAnimator.travelTime=600,!this.busy)){var o;t.deltaMode==WheelEvent.DOM_DELTA_PIXEL?o=t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_LINE?o=40*t.deltaY:t.deltaMode==WheelEvent.DOM_DELTA_PAGE&&(o=400*t.deltaY),o*=5;var a=1+o/1e3,s=this,l=this.lookAtLocation.latitude,u=this.lookAtLocation.longitude,c=n*a,h=new WorldWind.Position(l,u,c);s.busy=!0,this.worldWindow.goTo(h,function(){setTimeout(function(){s.busy=!1},300)}),this.applyLimits(),this.worldWindow.redraw()}for(var f in e.clusters)e.clusters[f].handleClusterZoom(n)},e.handlePanOrDrag=function(t){if(r.prototype?r.prototype.handlePanOrDrag.apply(this,arguments):r.__proto__.handlePanOrDrag.apply(this,arguments),"ended"==t.state){var i;i=this.lookAt&&this.lookAt.range?this.lookAt.range:this.range;for(var n in e.clusters)e.clusters[n].handleClusterZoom(i,!0)}},this.controlLayer&&(this.controlLayer.clusters||(this.controlLayer.clusters={}),this.controlLayer.clusters[i.options.name]=i,this.controlLayer.handleZoomIn=function(t,e){if(i.controlLayer.__proto__.handleZoomIn.apply(this,arguments),"mousedown"==t.type){var r;r=this.wwd.navigator.lookAt&&this.wwd.navigator.lookAt.range?this.wwd.navigator.lookAt.range:this.wwd.navigator.range;for(var n in this.clusters)this.clusters[n].handleClusterZoom(r)}},this.controlLayer.handleZoomOut=function(t,e){if(i.controlLayer.__proto__.handleZoomOut.apply(this,arguments),"mousedown"==t.type){var r;r=this.wwd.navigator.lookAt&&this.wwd.navigator.lookAt.range?this.wwd.navigator.lookAt.range:this.wwd.navigator.range;for(var n in this.clusters)this.clusters[n].handleClusterZoom(r)}},this.controlLayer.handlePan=function(t,e){if(i.controlLayer.__proto__.handlePan.apply(this,arguments),"mousedown"==t.type){var r;r=this.wwd.navigator.lookAt&&this.wwd.navigator.lookAt.range?this.wwd.navigator.lookAt.range:this.wwd.navigator.range;for(var n in this.clusters)this.clusters[n].handleClusterZoom(r,!0)}})},r.prototype.handleClusterZoom=function(t,e){var r,i=this,n=[1e8,5294648,4099739,2032591,1650505,800762,5e5,1e5,7e3];if(t>=n[0])r=1;else if(t<=n[n.length-1])r=n.length;else for(var o=0;o<n.length;o++)if(t<=n[o]&&t>=n[o+1]){r=o+1;break}i.oldZoom=i.zoomLevel||0,i.zoomLevel=r,r<i.minReached?(i.hideAllLevels(),i.showZoomLevel(i.minReached)):r>i.maxReached?(i.hideAllLevels(),i.showInRange(i.maxReached,t)):(i.levels[i.oldZoom]&&i.levels[r].length!=i.levels[i.oldZoom].length||e)&&(i.hideAllLevels(),i.showInRange(r,t),i.globe.redraw())},r.prototype.picking=function(){var t=this,e=[],r=function(r){for(var i=t.globe,n=r.clientX,o=r.clientY,a=e.length>0,s=0;s<e.length;s++)e[s].attributes.imageScale-=.2,e[s].attributes.labelAttributes.font.size-=10;e=[];var l=i.pick(i.canvasCoordinates(n,o));if(l.objects.length>0&&(a=!0),l.objects.length>0)for(var u=0;u<l.objects.length;u++)l.objects[u].isTerrain||l.objects[u].userObject.attributes&&l.objects[u].userObject.attributes.imageScale&&(l.objects[u].userObject.attributes.imageScale+=.2,l.objects[u].userObject.attributes.labelAttributes.font.size+=10,e.push(l.objects[u].userObject));a&&i.redraw()},i=function(e){var r=t.globe,i=e.clientX,n=e.clientY,o=t.globe.navigator,a=r.pick(r.canvasCoordinates(i,n));if(a.objects.length>0)for(var s=0;s<a.objects.length;s++)if(!a.objects[s].isTerrain&&a.objects[s].userObject.options.zoomLevel){o.lookAtLocation?(o.lookAtLocation.latitude=a.objects[s].userObject.position.latitude,o.lookAtLocation.longitude=a.objects[s].userObject.position.longitude,o.range/=2):(o.latitude=a.objects[s].userObject.position.latitude,o.longitude=a.objects[s].userObject.position.longitude,o.altitude/=2);var l=o.clusters||t.globe.controller.clusters;for(var u in l)l[u].handleClusterZoom(o.range||o.altitude);break}};t.globe.eventListeners.addedListeners||(t.globe.eventListeners.addedListeners=!0,t.globe.addEventListener("mousemove",r),t.globe.addEventListener("click",i))},r.prototype.showInRange=function(t,e){var r=document.getElementById("canvasOne").height,i=document.getElementById("canvasOne").width,n=this.globe;if(n.pickTerrain(new WorldWind.Vec2(i/2,r/2)).objects){var o=n.pickTerrain(new WorldWind.Vec2(i/2,r/2));o=o.objects[0].position;var a=e/Math.cos(Math.PI/8),s=Math.sqrt(Math.pow(a,2)-Math.pow(e,2));s/=1e5;for(var l=o.latitude-s,u=o.latitude+s,c=o.longitude-s,h=o.longitude+s,f=(u-l)/10,d={ix:l-f,iy:c-f,ax:u+f,ay:h+f},p=0,g=0;g<this.levels[t].length;g++){var m=this.placemarks[this.levels[t][g]],y=m.position;if(d.ix<=y.latitude&&y.latitude<=d.ax&&d.iy<=y.longitude&&y.longitude<=d.ay){if(p>=this.maxCount)return;this.show(m),p++}}}else this.showZoomLevel(t)},r.prototype.generateCluster=function(){this.hideAllSingle();var t='{"type": "FeatureCollection","features":[';newFeature=function(t,e){return'{"type": "Feature","properties": {"name":"'+e+'"},"geometry": {"type": "Point","coordinates": ['+ +t.longitude+","+ +t.latitude+"]}}"},this.placemarks.forEach(function(e,r){t+=newFeature(e.position,e.label)+","}),t=t.slice(0,-1),t+="]}",this.generateJSONCluster(JSON.parse(t)),this.showZoomLevel(this.zoomLevel)},r.prototype.generateJSONCluster=function(e){var r=this;cluster=t({log:!0,radius:70,extent:128,maxZoom:r.zoomLevels}).load(e.features),this.cluster=cluster;for(var i=this.zoomLevels,n=0;n<=i;n++){var o=cluster.getClusters([-180,-90,180,90],n+1),r=this;if(0==this.minReached&&o.length>0&&(this.minReached=n),o.length==e.features.length&&n>0&&o.length>0&&o.length==this.levels[n-1].length){this.maxReached=n-1;break}var a,s,l=0,u=1/0;o.forEach(function(t){l=Math.max(l,t.properties.point_count||0),u=Math.min(l,t.properties.point_count||1/0)}),o.forEach(function(t){if(t.properties.cluster){var e;e=r.options.attributeColor?r.options.attributeColor:(t.properties.point_count-u)/(l-u);var i;switch(i=r.options.clusterSources?r.options.clusterSources:["src/images/low.png","src/images/medium.png","src/images/high.png","src/images/vhigh.png"],!0){case e<.25:s=i[0];break;case e<.55:s=i[1];break;case e<.75:s=i[2];break;default:s=i[3]}a=""+t.properties.point_count_abbreviated;var o=new WorldWind.Offset(WorldWind.OFFSET_PIXELS,5,WorldWind.OFFSET_PIXELS,-40),c=.5,h=n+1}else{a=t.properties.name,s=WorldWind.configuration.baseUrl+"images/pushpins/push-pin-red.png";var h=!1}var f={imageSource:s,enabled:!1,label:a,offsetText:o,imageScale:c,zoomLevel:h},d=[t.geometry.coordinates[1],t.geometry.coordinates[0]],p=r.newPlacemark(d,null,f);r.add(p),r.addToZoom(n,p.index)})}this.maxReached||(this.maxReached=i),this.picking()},r.prototype.createZoomClusters=function(t){for(var e=0;e<=t;e++)this.levels[e]=[];return this.levels},r.prototype.addToZoom=function(t,e){this.levels[t].push(e)},r.prototype.setLayer=function(t){this.layer=t},r.prototype.add=function(t){if("[object Array]"===Object.prototype.toString.call(t)){var e=this;t.forEach(function(r){t.index=e.placemarks.length,e.layer.addRenderable(r),e.placemarks.push(r)})}else t.index=this.placemarks.length,this.layer.addRenderable(t),this.placemarks.push(t)},r.prototype.generatePlacemarks=function(t,e,r){var i,n,o;if("undefined"!=typeof t[0]&&"undefined"!=typeof t[1])i=Number(t[0]),n=Number(t[1]);else{if("undefined"==typeof t.lat||"undefined"==typeof t.lng)throw"Error in coordinates";i=Number(t.lat),n=Number(t.lng)}r||(r={}),o=t[2]?t[2]:0,o=t.alt?t.alt:o;var a=new WorldWind.Position(i,n,o);e||(e=new WorldWind.PlacemarkAttributes(null),e.imageScale=r.imageScale?r.imageScale:1,e.imageOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.3,WorldWind.OFFSET_FRACTION,0),r.offsetText?e.labelAttributes.offset=r.offsetText:e.labelAttributes.offset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,1),e.labelAttributes.color=WorldWind.Color.WHITE,e.labelAttributes.font.size=30);var s=new WorldWind.Placemark(a,!0,null);return s.label=r.label?r.label:"MyMarker "+i+" - "+n,s.altitudeMode=r.altitudeMode?r.altitudeMode:WorldWind.RELATIVE_TO_GROUND,e=new WorldWind.PlacemarkAttributes(e),
e.imageSource=r.imageSource?r.imageSource:WorldWind.configuration.baseUrl+"images/pushpins/push-pin-red.png",s.attributes=e,s.imageTilt=5,s.eyeDistanceScaling=!0,s.eyeDistanceScalingThreshold=3e6,s.eyeDistanceScalingLabelThreshold=1e20,s.options=r,s.enabled=!1,s},r.prototype.newPlacemark=function(t,e,r){if(!t)throw"No coordinates provided";var i;if("object"==typeof t[0]){i=[];for(var n in t)i.push(this.generatePlacemarks(t[n],e,r))}else i=this.generatePlacemarks(t,e,r);return i},r.prototype.hide=function(t){var e=t.index;return this.placemarks[e].enabled=!1,t},r.prototype.show=function(t){var e=t.index;return this.placemarks[e].enabled=!0,t},r.prototype.hideAllSingle=function(){for(var t=0;t<=this.placemarks;t++)this.placemarks[t].enabled=!1},r.prototype.hideAllLevels=function(){for(var t=0;t<=this.zoomLevels&&t<=this.maxReached;t++)this.hideZoomLevel(t)},r.prototype.hideZoomLevel=function(t){if(this.levels[t])for(var e=0;e<this.levels[t].length;e++)this.hide(this.placemarks[this.levels[t][e]])},r.prototype.showZoomLevel=function(t){if(this.levels[t])for(var e=0;e<this.levels[t].length;e++)this.show(this.placemarks[this.levels[t][e]])},r.prototype.removePlacemark=function(t){this.layer.removeRenderable(t),this.placemarks.splice(this.placemarks.indexOf(t))},r}),define("scripts/util/MarkerClusterPanel",["./MarkerCluster"],function(t){var e=function(t,e,r){this.wwd=t,this.myMarkers={};var i=this;this.index=0,this.controls=r,this.fileTypeMarkers=0,$("#fileTypeMarkers").change(function(){var t=$("#fileTypeMarkers").val();"0"==t?($("#csv-Markers").hide(),$("#markersUrl").show(),i.fileTypeMarkers=0):($("#csv-Markers").show(),$("#markersUrl").hide(),i.fileTypeMarkers=1)}),$("#loadMarkersBtn").on("click",function(){i.addMarkers(i.wwd)})};return e.prototype.addMarkers=function(e){function r(t,e){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="json",r.setRequestHeader("Accept","application/json"),r.onload=function(){4===r.readyState&&r.status>=200&&r.status<300&&r.response&&e(r.response)},r.send()}var i=this;if(1==this.fileTypeMarkers)var n=$("#csv-Markers").get(0).files[0];else var n=document.getElementById("markersUrl").value;n=n.replace(/ /g,"");var o=new t(e,{name:"Cluster",controls:i.controls,navigator:e.controller,maxLevel:7,clusterSources:["images/marker/low.png","images/marker/medium.png","images/marker/high.png","images/marker/vhigh.png"]});this.myMarkers[this.index]=o.layer,r(n,function(t){o.generateJSONCluster(t)}),e.redraw(),this.createInterface(e)},e.prototype.createInterface=function(t){$("#MarkersList").html("");var e=this;for(var r in e.myMarkers){var i=e.myMarkers[r].displayName+" "+r,n=$("<div key="+r+" class='listJson'>&#10060;"+i+"</div>");$("#MarkersList").append(n),n.on("click",function(){var r=$(this).attr("key");t.removeLayer(e.myMarkers[r]),$(this).remove(),delete e.myMarkers[r],t.redraw()})}},e}),define("scripts/LayerManager",[],function(){"use strict";var t=function(t){var e=this;this.wwd=t,this.roundGlobe=this.wwd.globe,this.createProjectionList(),$("#projectionDropdown").find(" li").on("click",function(t){e.onProjectionClick(t)}),this.synchronizeLayerList(),$("#searchBox").find("button").on("click",function(t){e.onSearchButton(t)}),this.geocoder=new WorldWind.NominatimGeocoder,this.goToAnimator=new WorldWind.GoToAnimator(this.wwd),$("#searchText").on("keypress",function(t){e.onSearchTextKeyPress($(this),t)})};return t.prototype.onProjectionClick=function(t){var e=t.target.innerText||t.target.innerHTML;$("#projectionDropdown").find("button").html(e+' <span class="caret"></span>'),"3D"===e?(this.roundGlobe||(this.roundGlobe=new WorldWind.Globe(new WorldWind.EarthElevationModel)),this.wwd.globe!==this.roundGlobe&&(this.wwd.globe=this.roundGlobe)):(this.flatGlobe||(this.flatGlobe=new WorldWind.Globe2D),"Equirectangular"===e?this.flatGlobe.projection=new WorldWind.ProjectionEquirectangular:"Mercator"===e?this.flatGlobe.projection=new WorldWind.ProjectionMercator:"North Polar"===e?this.flatGlobe.projection=new WorldWind.ProjectionPolarEquidistant("North"):"South Polar"===e?this.flatGlobe.projection=new WorldWind.ProjectionPolarEquidistant("South"):"North UPS"===e?this.flatGlobe.projection=new WorldWind.ProjectionUPS("North"):"South UPS"===e?this.flatGlobe.projection=new WorldWind.ProjectionUPS("South"):"North Gnomonic"===e?this.flatGlobe.projection=new WorldWind.ProjectionUPS("North"):"South Gnomonic"===e&&(this.flatGlobe.projection=new WorldWind.ProjectionUPS("South")),this.wwd.globe!==this.flatGlobe&&(this.wwd.globe=this.flatGlobe)),this.wwd.redraw()},t.prototype.onLayerClick=function(t){for(var e=t.text(),r=0,i=this.wwd.layers.length;r<i;r++){var n=this.wwd.layers[r];if(!n.hide&&n.displayName===e){n.enabled=!n.enabled,n.enabled?t.addClass("active"):t.removeClass("active"),this.wwd.redraw();break}}},t.prototype.synchronizeLayerList=function(){var t=$("#layerList");t.find("button").off("click"),t.find("button").remove();for(var e=0,r=this.wwd.layers.length;e<r;e++){var i=this.wwd.layers[e];if(!i.hide){var n=$('<button class="list-group-item btn btn-block">'+i.displayName+"</button>");if(t.append(n),i.showSpinner&&Spinner){var o={scale:.9},a=new Spinner(o).spin();n.append(a.el)}i.enabled?n.addClass("active"):n.removeClass("active")}}var s=this;t.find("button").on("click",function(t){s.onLayerClick($(this))})},t.prototype.createProjectionList=function(){var t=["3D","Equirectangular","Mercator","North Polar","South Polar","North UPS","South UPS","North Gnomonic","South Gnomonic"],e=$("#projectionDropdown"),r=$('<button class="btn btn-info btn-block dropdown-toggle" type="button" data-toggle="dropdown">3D<span class="caret"></span></button>');e.append(r);var i=$('<ul class="dropdown-menu">');e.append(i);for(var n=0;n<t.length;n++){var o=$("<li><a >"+t[n]+"</a></li>");i.append(o)}i=$("</ul>"),e.append(i)},t.prototype.onSearchButton=function(t){this.performSearch($("#searchText")[0].value)},t.prototype.onSearchTextKeyPress=function(t,e){13===e.keyCode&&(t.blur(),this.performSearch($("#searchText")[0].value))},t.prototype.performSearch=function(t){if(t){var e,r,i=this;if(t.match(WorldWind.WWUtil.latLonRegex)){var n=t.split(",");e=parseFloat(n[0]),r=parseFloat(n[1]),i.goToAnimator.goTo(new WorldWind.Location(e,r))}else this.geocoder.lookup(t,function(n,o){o.length>0&&(e=parseFloat(o[0].lat),r=parseFloat(o[0].lon),WorldWind.Logger.log(WorldWind.Logger.LEVEL_INFO,t+": "+e+", "+r),i.goToAnimator.goTo(new WorldWind.Location(e,r)))})}},t});var gInterface,appConstructor,tourStarted=0;define("scripts/ESTWA",["./AppConstructor","./GlobeInterface","./Globe","./Configurator","./HandlePicks","./UserInterface","./GlobeHelper","./navigator/MoveNavigator","./Controls","./util/ServersPanel","./util/FeaturesPanel","./util/GeoJSONPanel","./util/GeoTIFFPanel","../worldwind/formats/kml/KmlFile","./util/KMLPanel","./util/SurfaceImagePanel","./util/NDVIPanel","./util/HeatmapPanel","./util/MarkerClusterPanel","./LayerManager"],function(t,e,r,i,n,o,a,s,l,u,c,h,f,d,p,g,m,y,v,b){var E;return E=function(E){function w(t){var e=new i;if(0===A)var r=$("#csv-file").get(0).files[0];else var r=$("input[option='re1']").val();var n=new Promise(function(t){e.getConfig(r,t)});$(".timeConfig, .gridConfig, .dataConfig, .latitudeConfig, .longitudeConfig").html(""),n.then(function(e){for(var r=0;r<e.length;r++)$(".timeConfig, .gridConfig, .dataConfig, .latitudeConfig, .longitudeConfig").append($("<option></option>").attr("value",r).text(e[r]));loadConfig=!0,t&&t()}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)}),$("#configType").show(),$("#advanced").show(),$("#start").show()}var _=new r({id:E.globe}),x=new l(_);gInterface=new e(_),appConstructor=new t,this.GeoJSONPanel=new h(_),this.GeoTIFFPanel=new f(_),this.KMLPanel=new p(_,d),this.SurfaceImagePanel=new g(_),this.NDVIPanel=new m(_,S),this.HeatmapPanel=new y(_,gInterface.globe.controller,x),this.MarkerClusterPanel=new v(_,gInterface.globe.controller,x),this.serversPanel=new u(_),this.serversPanel.attachServer("http://ows.terrestris.de/osm/service?"),this.featuresPanel=new c(_),this.featuresPanel.attachServer("http://131.175.59.195/geoserver/");var S=new b(_);gInterface._navigator=new s({wwd:gInterface.globe,zoomLevelListeners:[gInterface.globe.redraw.bind(this)],viewPortChangedListeners:[gInterface.globe.redraw.bind(this),appConstructor.addCsv.bind(appConstructor,gInterface)]}),gInterface.globe.controller.handlePanOrDrag=function(t){this.worldWindow.globe.is2D()?this.handlePanOrDrag2D(t):this.handlePanOrDrag3D(t),"ended"==t.state&&setTimeout(function(){appConstructor.addCsv(gInterface)},100)},gInterface.setUI(new o(gInterface));var T=new n;gInterface.UI.handlePick=T;var M=0,L=0;$("#cleanAll").click(function(){appConstructor.cleanAll(gInterface),gInterface.globe.layers.splice(3),$("#controls").show(),$(".afterControls").hide()}),$("#changeValues").click(function(){var t=Number($("#changeHeight").val()),e=Number($("#changeBig").val()),r=Number($("#changeStat").val());gInterface.updateOpt([t,e,r])});var A=1;$("#fileType").change(function(){var t=$("#fileType").val();"1"==t?($("#csv-file").show(),$("#hostedFileSelector").hide(),$("#loadConfig").show(),A=0):"2"==t?($("#csv-file").hide(),$("#hostedFileSelector").show(),$("#loadConfig").show(),A=1):($("#csv-file").hide(),$("#hostedFileSelector").hide(),$("#sample").show(),A=1)});var N=1;$("#gridType").change(function(){var t=$("#gridType").val();"1"==t?($("#grid-file").show(),$("#hostedGridSelector").hide(),N=0):($("#grid-file").hide(),$("#hostedGridSelector").show(),N=1)}),$("#checkCompare").change(function(){M=$("#checkCompare").is(":checked")?1:0,gInterface.compare=M,gInterface.UI.resetValueFilter()}),$("input[name=optradio]").change(function(){var t=Number($("input[name=optradio]:checked","#radioButtons").val());_.eventListeners.dblclick&&_.removeEventListener("dblclick",self.handlePick);var e;if(t){gInterface.UI.resetValueFilter(),gInterface.makeBigDoxels(),L=1;var r=gInterface.rect,i=gInterface.bigVoxels.layers;e=T.getBigDoxels(r,i,_),_.addEventListener("dblclick",e),self.handlePick=e}else e=T.getDoxel(gInterface),self.handlePick=e,_.addEventListener("dblclick",e)}),$("#autoTile").change(function(){var t=$("#autoTile").is(":checked")?1:0;gInterface.autoTile=t}),$("#atmosphere-icon").click(function(){_.atmosphereLayer.enabled?(_.atmosphereLayer.enabled=!1,$("#atmosphere-icon").attr("style","color: #444 !important")):(_.atmosphereLayer.enabled=!0,$("#atmosphere-icon").css("color","#2f6eff")),_.redraw()}),$("#loadConfig").click(function(){w()}),$("#loadConfigCompare").click(function(){$("#configSelectorCompare").show(),configurator=new i;var t=$("input[option='co1']").val(),e=new Promise(function(e){configurator.getConfig(t,e)});e.then(function(t){for(var e=0;e<t.length;e++)$("#timeConfigCompare, #gridConfigCompare, #dataConfigCompare").append($("<option></option>").attr("value",e).text(t[e]))}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})}),$("#addData").click(function(){try{var t=1,e=$("input[option='co1']").val(),r=$("input[option='co6']").val(),i=Number($("select[option='co3']").val()),n=Number($("select[option='co4']").val()),o=$("input[option='co2']").val(),a=$("select[option='co5']").val();$(".checkCompare").show();var s={time:i,id:n,data:a,half:t,separator:o,idSeparator:r,url:e,reference:0};appConstructor.newData(s,gInterface),$("#afterType option[value=2]").attr("disabled","disabled")}catch(t){gInterface.UI.alert(t)}}),$("#start").click(function(){$("#loading").show();var t=$("#my-tour-id").tourbus({});t.trigger("stop"),$("#CSVButton").click();var e=0;if(0===N){var r=$("#grid-file").get(0).files[0];e=1}else var r=$("input[option='gr1']").val();if(0===A)var i=$("#csv-file").get(0).files[0];else var i=$("input[option='re1']").val();var n=Number($("select[option='re3']").val()),o=Number($("select[option='re4']").val()),s=$("input[option='re2']").val(),l=$("input[option='re6']").val(),u=$("select[option='re5']").val(),c=Number($(".latitudeConfig").val()),h=Number($(".longitudeConfig").val()),f=0,d=Number($("select[option='re8']").val()),p=Number($("input[option='re10']").val()),g=$("select[option='re9']").val(),m=$("input[option='heightExtrusion']").is(":checked")?1:0,y=$("input[option='isUrl']").is(":checked")?1:0,v=$("input[option='csvImporting']").is(":checked")?1:0,b=Number($("input[option='heightCube']").val()),E=Number($("input[option='shown']").val()),w=Number($("input[option='maxApp']").val()),_=Number($("input[option='subxy']").val()),x=Number($("input[option='subz']").val()),S=Number($("input[option='initH']").val()),T=Number($("select[option='statIndex']").val()),M=Number($("input[option='monthRange1']").val()),L=Number($("input[option='monthRange2']").val()),C=$("input[option='coverage']").val();$("#alert").css("visibility","hidden"),$("#alert").css("visibility","hidden"),$("#controls").hide(),$(".afterControls").show();var R=$("input[name='maxcolor']").val(),P=$("input[name='mincolor']").val(),O=$("input[name='midcolor']").val(),I=[a.getRGB(P),a.getRGB(O),a.getRGB(R)];$("#legendScale").css("background","linear-gradient(to bottom,"+P+" 0%,"+O+" 50%,"+R+" 100%)"),$("#legendScale").css("background","-moz-linear-gradient(to bottom,"+P+" 0%,"+O+" 50%,"+R+" 100%)"),$("#legendScale").css("background","-webkit-linear-gradient(to bottom,"+P+" 0%,"+O+" 50%,"+R+" 100%)");var k=$("input[option='refSystem']").val(),D=Number($("input[option='csvZone']").val());(v||y)&&$(".autoTile").show();var V=0;try{appConstructor.init({globe:"canvasOne",gridUrl:r,isCSV:v,csv:{csvUrl:i,zone:D,source:k,time:d,data:g,quadSub:p,delimiter:";"},config_0:{time:n,id:o,data:u,half:V,separator:s,idSeparator:l,url:i,reference:f,heightExtrusion:m,lat:c,lng:h,monthRange1:M,monthRange2:L,coverage:C},isLocal:e,isUrl:y,heightCube:b,maxShown:E,maxInApp:w,startHeight:S,sub:_,heightDim:x,autoTime:0,statIndex:T,maxDownload:2e3,colors:I},gInterface)}catch(t){gInterface.UI.alert(t)}}),$("#teleSample").click(function(){$("input[option='re1']").val("data/blocks.csv"),$("#loading").show();var t=new Promise(function(t){w(t)});t.then(function(){$("input[option='gr1']").val("data/grid.txt"),$("select[option='re4']").val(1),$("select[option='re3']").val(0),$("select[option='re5']").val([2,4]),$("input[option='re2']").val("."),$("input[option='re6']").val("_"),$("input[option='shown']").val(3),$("#configType").val(4),$("#configType").change(),$("#loading").hide()}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})}),$("#turinSample").click(function(){$("#loading").show(),$("input[option='re1']").val("data/torino.csv"),$("#loadConfig").click();var t=new Promise(function(t){w(t)});t.then(function(){$("input[option='csvImporting']").prop("checked",!0),$("select[option='re8']").val(0),$("select[option='re9']").val([1,2]),$(".latitudeConfig").val(3),$(".longitudeConfig").val(4),$("input[option='heightExtrusion']").prop("checked",!0),$("#configType").val(4),$("#configType").change(),$("#loading").hide()}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})}),$("#fullSample").click(function(){$("#loading").show(),$("input[option='re1']").val("data/full.csv"),$("#loadConfig").click();var t=new Promise(function(t){w(t)});t.then(function(){gInterface.globe.navigator.longitude=14.209447413225549,gInterface.globe.navigator.latitude=37.70978565490195,gInterface.globe.navigator.range=312535.24849800026,$("input[option='csvImporting']").prop("checked",!0),$("input[option='heightExtrusion']").prop("checked",!1),$("select[option='re8']").val(3),$("select[option='re9']").val([2]),$(".latitudeConfig").val(0),$(".longitudeConfig").val(1),$("#configType").val(4),$("#configType").change(),$("#loading").hide()}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})}),$("#litoSample").click(function(){$("#loading").show(),$("input[option='re1']").val("data/chalk_small.csv"),$("#loadConfig").click();var t=new Promise(function(t){w(t)});t.then(function(){$("input[option='csvImporting']").prop("checked",!0),$("select[option='re8']").val(4),$("input[option='re10']").val(4),$("select[option='re9']").val([2,3]),$(".latitudeConfig").val(1),$(".longitudeConfig").val(0),$("input[option='initH']").val(0),$("input[option='heightCube']").val(200),$("input[option='heightExtrusion']").prop("checked",!0),$("#configType").val(4),$("#configType").change(),$("#loading").hide()}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})}),$("#rasdaSample").click(function(){$("#loadConfig").click();var t=new Promise(function(t){$("#loading").show(),w(t)});t.then(function(){$("input[option='re1']").val("http://ows.rasdaman.org/rasdaman/ows"),$("input[option='isUrl']").prop("checked",!0),$("input[option='monthRange2']").val(1),gInterface.globe.controller.lookAt.longitude=14.209447413225549,gInterface.globe.controller.lookAt.latitude=37.70978565490195,gInterface.globe.controller.lookAt.range=312535.24849800026,$("input[option='initH']").val(1e4),$("input[option='heightCube']").val(1e4),$("input[option='shown']").val(1),$(".data").val(2),$("#configType").val(4),$("#configType").change(),$("#loading").hide()}).catch(function(t){$("#loading").hide(),alert("Error occurred:"+t)})})}}),function t(e,r,i){function n(a,s){if(!r[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw Error("Cannot find module '"+a+"'")}var u=r[a]={exports:{}};e[a][0].call(u.exports,function(t){var r=e[a][1][t];return n(r?r:t)},u,u.exports,t,e,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;i.length>a;a++)n(i[a]);return n}({1:[function(t){(function(){var e,r,i,n,o,a=[].slice;e=jQuery,r=t("./modules/bus"),i=t("./modules/leg"),o=e.tourbus=function(){var t,r;return t=arguments.length>=1?a.call(arguments,0):[],r=t[0],n.hasOwnProperty(r)?t=t.slice(1):r instanceof e?r="build":"string"==typeof r?(r="build",t[0]=e(t[0])):e.error("Unknown method of $.tourbus --",t),n[r].apply(this,t)},e.fn.tourbus=function(){var t;return t=arguments.length>=1?a.call(arguments,0):[],this.each(function(){return t.unshift(e(this)),o.apply(null,["build"].concat(a.call(t))),this})},n={build:function(t,i){var n;return null==i&&(i={}),i=e.extend(!0,{},o.defaults,i),n=[],t instanceof e||(t=e(t)),t.each(function(){return n.push(new r(this,i))}),0===n.length&&e.error(""+t.selector+" was not found!"),1===n.length?n[0]:n},destroyAll:function(){var t,e,i,n;i=r._busses,n=[];for(e in i)t=i[e],n.push(t.destroy());return n},expose:function(t){return t.tourbus={Bus:r,Leg:i}}},o.defaults={debug:!1,autoDepart:!1,container:"body",class:null,startAt:0,onDepart:function(){return null},onStop:function(){return null},onLegStart:function(){return null},onLegEnd:function(){return null},leg:{class:null,scrollTo:null,scrollSpeed:150,scrollContext:100,orientation:"bottom",align:"left",width:"auto",margin:10,top:null,left:null,zindex:9999,arrow:"50%"}}}).call(this)},{"./modules/bus":2,"./modules/leg":3}],2:[function(t,e){(function(){var r,i,n,o,a=[].slice;r=jQuery,n=t("./leg"),o=t("./utils"),e.exports=i=function(){function t(t,e){this.options=e,this.id=this.constructor.uniqueId(),this.elId="tourbus-"+this.id,this.constructor._busses[this.id]=this,this.$original=r(t),this.rawData=this.$original.data(),this.$container=r(o.dataProp(this.rawData.container,this.options.container)),this.$original.data({tourbus:this}),this.currentLegIndex=null,this.legs=[],this.legEls=this.$original.children("li"),this.totalLegs=this.legEls.length,this._configureElement(),this._setupEvents(),o.dataProp(this.rawData.autoDepart,this.options.autoDepart)&&this.$original.trigger("depart.tourbus"),this._log("built tourbus with el",""+t,"and options",this.options)}return t._busses={},t._tours=0,t.uniqueId=function(){return this._tours++},t.prototype.depart=function(){return this.running=!0,this.options.onDepart(this),this._log("departing",this),this.currentLegIndex=o.dataProp(this.rawData.startAt,this.options.startAt),this.showLeg()},t.prototype.stop=function(){return this.running?(r.each(this.legs,r.proxy(this.hideLeg,this)),this.currentLegIndex=null,this.options.onStop(this),this.running=!1):void 0},t.prototype.on=function(t,e,r){return this.$container.on(t,e,r)},t.prototype.currentLeg=function(){return null===this.currentLegIndex?null:this.legs[this.currentLegIndex]},t.prototype.buildLeg=function(t){var e,i,o;return e=r(this.legEls[t]),i=e.data(),this.legs[t]=o=new n({bus:this,original:e,target:i.el||"body",index:t,rawData:i}),o.render(),this.$el.append(o.$el),o._position(),o.hide(),o},t.prototype.showLeg=function(t){var e,r;return null==t&&(t=this.currentLegIndex),e=this.legs[t]||this.buildLeg(t),this._log("showLeg:",e),r=this.options.onLegStart(e,this),r!==!1&&e.show(),++t<this.totalLegs&&!this.legs[t]?this.buildLeg(t):void 0},t.prototype.hideLeg=function(t){var e,r;return null==t&&(t=this.currentLegIndex),e=this.legs[t],e&&e.visible&&(this._log("hideLeg:",e),r=this.options.onLegEnd(e,this),r!==!1&&e.hide()),--t>0&&!this.legs[t]?this.buildLeg(t):void 0},t.prototype.repositionLegs=function(){return r.each(this.legs,function(){return this.reposition()})},t.prototype.next=function(){return this.hideLeg(),this.currentLegIndex++,this.currentLegIndex>this.totalLegs-1?this.$original.trigger("stop.tourbus"):this.showLeg()},t.prototype.prev=function(){return this.hideLeg(),this.currentLegIndex--,0>this.currentLegIndex?this.$original.trigger("stop.tourbus"):this.showLeg()},t.prototype.destroy=function(){return r.each(this.legs,function(){return this.destroy()}),this.legs=[],delete this.constructor._busses[this.id],this._teardownEvents(),this.$original.removeData("tourbus"),this.$el.remove()},t.prototype._configureElement=function(){return this.$el=r("<div class='tourbus-container'></div>"),this.el=this.$el[0],this.$el.attr({id:this.elId}),this.$el.addClass(o.dataProp(this.rawData.class,this.options.class)),this.$container.append(this.$el)},t.prototype._log=function(){return o.dataProp(this.rawData.debug,this.options.debug)?console.log.apply(console,["TOURBUS "+this.id+":"].concat(a.call(arguments))):void 0},t.prototype._setupEvents=function(){return this.$original.on("depart.tourbus",r.proxy(this.depart,this)),this.$original.on("stop.tourbus",r.proxy(this.stop,this)),this.$original.on("next.tourbus",r.proxy(this.next,this)),this.$original.on("prev.tourbus",r.proxy(this.prev,this))},t.prototype._teardownEvents=function(){return this.$original.off(".tourbus")},t}()}).call(this)},{"./leg":3,"./utils":4}],3:[function(t,e){(function(){var r,i,n,o;r=jQuery,n=t("./utils"),e.exports=i=function(){function t(t){if(this.options=t,this.$original=this.options.original,this.bus=this.options.bus,this.rawData=this.options.rawData,this.index=this.options.index,this.$target=r(this.options.target),this.id=""+this.bus.id+"-"+this.options.index,this.elId="tourbus-leg-"+this.id,this.visible=!1,0===this.$target.length)throw""+this.$target.selector+" is not an element!";this.content=this.$original.html(),this._setupOptions(),this._configureElement(),this._configureTarget(),this._configureScroll(),this._setupEvents(),this.bus._log("leg "+this.index+" made with options",this.options)}return t.prototype.render=function(){var t,e;return t="centered"===this.options.orientation?"":"tourbus-arrow",this.$el.addClass(" "+t+" tourbus-arrow-"+this.options.orientation+" "),e="<div class='tourbus-leg-inner'>\n  "+this.content+"\n</div>",this.$el.css({width:this.options.width,zIndex:this.options.zindex}).html(e),this},t.prototype.destroy=function(){return this.$el.remove(),this._teardownEvents()},t.prototype.reposition=function(){return this._configureTarget(),this._position()},t.prototype._position=function(){var t,e,r,i;return"centered"!==this.options.orientation&&(r={},e={top:"left",bottom:"left",left:"top",right:"top"},"number"==typeof this.options.arrow&&(this.options.arrow+="px"),r[e[this.options.orientation]]=this.options.arrow,i="#"+this.elId+".tourbus-arrow",this.bus._log("adding rule for "+this.elId,r),o(""+i+":before, "+i+":after",r)),t=this._offsets(),this.bus._log("setting offsets on leg",t),this.$el.css(t)},t.prototype.show=function(){return this.visible=!0,this.$el.css({visibility:"visible",opacity:1,zIndex:this.options.zindex}),this.scrollIntoView()},t.prototype.hide=function(){return this.visible=!1,this.bus.options.debug?this.$el.css({visibility:"visible",opacity:.4,zIndex:0}):this.$el.css({visibility:"hidden"})},t.prototype.scrollIntoView=function(){var t;if(this.willScroll)return t=n.dataProp(this.options.scrollTo,this.$el),this.bus._log("scrolling to",t,this.scrollSettings),r.scrollTo(t,this.scrollSettings)},t.prototype._setupOptions=function(){var t,e,r,i,o,a;for(e=this.bus.options.leg,t=["class","top","left","scrollTo","scrollSpeed","scrollContext","margin","arrow","align","width","zindex","orientation"],a=[],i=0,o=t.length;o>i;i++)r=t[i],a.push(this.options[r]=n.dataProp(this.rawData[r],e[r]));return a},t.prototype._configureElement=function(){return this.$el=r("<div class='tourbus-leg'></div>"),this.el=this.$el[0],this.$el.attr({id:this.elId}),this.$el.addClass(this.options.class),this.$el.css({zIndex:this.options.zindex})},t.prototype._setupEvents=function(){return this.$el.on("click",".tourbus-next",r.proxy(this.bus.next,this.bus)),this.$el.on("click",".tourbus-prev",r.proxy(this.bus.prev,this.bus)),this.$el.on("click",".tourbus-stop",r.proxy(this.bus.stop,this.bus))},t.prototype._teardownEvents=function(){return this.$el.off("click")},t.prototype._configureTarget=function(){return this.targetOffset=this.$target.offset(),n.dataProp(this.options.top,!1)&&(this.targetOffset.top=this.options.top),n.dataProp(this.options.left,!1)&&(this.targetOffset.left=this.options.left),this.targetWidth=this.$target.outerWidth(),this.targetHeight=this.$target.outerHeight()},t.prototype._configureScroll=function(){return this.willScroll=r.fn.scrollTo&&this.options.scrollTo!==!1,this.scrollSettings={offset:-this.options.scrollContext,easing:"linear",axis:"y",duration:this.options.scrollSpeed}},t.prototype._offsets=function(){var t,e,i,o,a,s,l,u;switch(i=this.$el.height(),o=this.$el.width(),a={},this.options.orientation){case"centered":l=r(window).height(),a.top=this.options.top,n.dataProp(a.top,!1)||(a.top=l/2-i/2),a.left=this.targetWidth/2-o/2;break;case"left":a.top=this.targetOffset.top,a.left=this.targetOffset.left-o-this.options.margin;break;case"right":a.top=this.targetOffset.top,a.left=this.targetOffset.left+this.targetWidth+this.options.margin;break;case"top":a.top=this.targetOffset.top-i-this.options.margin,a.left=this.targetOffset.left;break;case"bottom":a.top=this.targetOffset.top+this.targetHeight+this.options.margin,a.left=this.targetOffset.left}if(u={top:["left","right"],bottom:["left","right"],left:["top","bottom"],right:["top","bottom"]},n.include(this.options.orientation,u[this.options.align]))switch(this.options.align){case"right":a.left+=this.targetWidth-o;break;case"bottom":a.top+=this.targetHeight-i}else"center"===this.options.align&&(n.include(this.options.orientation,u.left)?(s=this.targetWidth/2,e=o/2,t="left"):(s=this.targetHeight/2,e=i/2,t="top"),s>e?a[t]+=s-e:a[t]-=e-s);return a},t}(),o=function(t){var e;return t.type="text/css",document.getElementsByTagName("head")[0].appendChild(t),e=document.styleSheets[document.styleSheets.length-1],function(t,i){var n,o;o=r.map(function(){var t;t=[];for(n in i)t.push(n);return t}(),function(t){return""+t+":"+i[t]}).join(";");try{e.insertRule?e.insertRule(""+t+" { "+o+" }",(e.cssRules||e.rules).length):e.addRule(t,o)}catch(t){}}}(document.createElement("style"))}).call(this)},{"./utils":4}],4:[function(t,e){(function(){e.exports={dataProp:function(t,e){return null===t||void 0===t?e:t},include:function(t,e){return-1!==$.inArray(t,e||[])}}}).call(this)},{}]},{},[1,2,3,4]),define("tourbus",function(){}),!function(){function t(t){return t&&(t.ownerDocument||t.document||t).documentElement}function e(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function r(t,e){return e>t?-1:t>e?1:t>=e?0:NaN}function i(t){return null===t?NaN:+t}function n(t){return!isNaN(t)}function o(t){return{left:function(e,r,i,n){for(arguments.length<3&&(i=0),arguments.length<4&&(n=e.length);n>i;){var o=i+n>>>1;t(e[o],r)<0?i=o+1:n=o}return i},right:function(e,r,i,n){for(arguments.length<3&&(i=0),arguments.length<4&&(n=e.length);n>i;){var o=i+n>>>1;t(e[o],r)>0?n=o:i=o+1}return i}}}function a(t){return t.length}function s(t){for(var e=1;t*e%1;)e*=10;return e}function l(t,e){for(var r in e)Object.defineProperty(t.prototype,r,{value:e[r],enumerable:!1})}function u(){this._=Object.create(null)}function c(t){return(t+="")===da||t[0]===pa?pa+t:t}function h(t){return(t+="")[0]===pa?t.slice(1):t}function f(t){return c(t)in this._}function d(t){return(t=c(t))in this._&&delete this._[t]}function p(){var t=[];for(var e in this._)t.push(h(e));return t}function g(){var t=0;for(var e in this._)++t;return t}function m(){for(var t in this._)return!1;return!0}function y(){this._=Object.create(null)}function v(t){return t}function b(t,e,r){return function(){var i=r.apply(e,arguments);return i===e?t:i}}function E(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var r=0,i=ga.length;i>r;++r){var n=ga[r]+e;if(n in t)return n}}function w(){}function _(){}function x(t){function e(){for(var e,i=r,n=-1,o=i.length;++n<o;)(e=i[n].on)&&e.apply(this,arguments);return t}var r=[],i=new u;return e.on=function(e,n){var o,a=i.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,r=r.slice(0,o=r.indexOf(a)).concat(r.slice(o+1)),i.remove(e)),n&&r.push(i.set(e,{on:n})),t)},e}function S(){ra.event.preventDefault()}function T(){for(var t,e=ra.event;t=e.sourceEvent;)e=t;return e}function M(t){for(var e=new _,r=0,i=arguments.length;++r<i;)e[arguments[r]]=x(e);return e.of=function(r,i){return function(n){try{var o=n.sourceEvent=ra.event;n.target=t,ra.event=n,e[n.type].apply(r,i)}finally{ra.event=o}}},e}function L(t){return ya(t,wa),t}function A(t){return"function"==typeof t?t:function(){return va(t,this)}}function N(t){return"function"==typeof t?t:function(){return ba(t,this)}}function C(t,e){function r(){this.removeAttribute(t)}function i(){this.removeAttributeNS(t.space,t.local)}function n(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function a(){var r=e.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}function s(){var r=e.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}return t=ra.ns.qualify(t),null==e?t.local?i:r:"function"==typeof e?t.local?s:a:t.local?o:n}function R(t){return t.trim().replace(/\s+/g," ")}function P(t){return new RegExp("(?:^|\\s+)"+ra.requote(t)+"(?:\\s+|$)","g")}function O(t){return(t+"").trim().split(/^|\s+/)}function I(t,e){function r(){for(var r=-1;++r<n;)t[r](this,e)}function i(){for(var r=-1,i=e.apply(this,arguments);++r<n;)t[r](this,i)}t=O(t).map(k);var n=t.length;return"function"==typeof e?i:r}function k(t){var e=P(t);return function(r,i){if(n=r.classList)return i?n.add(t):n.remove(t);var n=r.getAttribute("class")||"";i?(e.lastIndex=0,e.test(n)||r.setAttribute("class",R(n+" "+t))):r.setAttribute("class",R(n.replace(e," ")))}}function D(t,e,r){function i(){this.style.removeProperty(t)}function n(){this.style.setProperty(t,e,r)}function o(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,r)}return null==e?i:"function"==typeof e?o:n}function V(t,e){function r(){delete this[t]}function i(){this[t]=e}function n(){var r=e.apply(this,arguments);null==r?delete this[t]:this[t]=r}return null==e?r:"function"==typeof e?n:i}function F(t){function e(){var e=this.ownerDocument,r=this.namespaceURI;return r?e.createElementNS(r,t):e.createElement(t)}function r(){return this.ownerDocument.createElementNS(t.space,t.local)}return"function"==typeof t?t:(t=ra.ns.qualify(t)).local?r:e}function G(){var t=this.parentNode;t&&t.removeChild(this)}function B(t){
return{__data__:t}}function W(t){return function(){return Ea(this,t)}}function U(t){return arguments.length||(t=r),function(e,r){return e&&r?t(e.__data__,r.__data__):!e-!r}}function z(t,e){for(var r=0,i=t.length;i>r;r++)for(var n,o=t[r],a=0,s=o.length;s>a;a++)(n=o[a])&&e(n,a,r);return t}function j(t){return ya(t,xa),t}function K(t){var e,r;return function(i,n,o){var a,s=t[o].update,l=s.length;for(o!=r&&(r=o,e=0),n>=e&&(e=n+1);!(a=s[e])&&++e<l;);return a}}function q(t,e,r){function i(){var e=this[a];e&&(this.removeEventListener(t,e,e.$),delete this[a])}function n(){var n=l(e,na(arguments));i.call(this),this.addEventListener(t,this[a]=n,n.$=r),n._=e}function o(){var e,r=new RegExp("^__on([^.]+)"+ra.requote(t)+"$");for(var i in this)if(e=i.match(r)){var n=this[i];this.removeEventListener(e[1],n,n.$),delete this[i]}}var a="__on"+t,s=t.indexOf("."),l=Z;s>0&&(t=t.slice(0,s));var u=Sa.get(t);return u&&(t=u,l=H),s?e?n:i:e?w:o}function Z(t,e){return function(r){var i=ra.event;ra.event=r,e[0]=this.__data__;try{t.apply(this,e)}finally{ra.event=i}}}function H(t,e){var r=Z(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||r.call(e,t)}}function $(r){var i=".dragsuppress-"+ ++Ma,n="click"+i,o=ra.select(e(r)).on("touchmove"+i,S).on("dragstart"+i,S).on("selectstart"+i,S);if(null==Ta&&(Ta=!("onselectstart"in r)&&E(r.style,"userSelect")),Ta){var a=t(r).style,s=a[Ta];a[Ta]="none"}return function(t){if(o.on(i,null),Ta&&(a[Ta]=s),t){var e=function(){o.on(n,null)};o.on(n,function(){S(),e()},!0),setTimeout(e,0)}}}function Y(t,r){r.changedTouches&&(r=r.changedTouches[0]);var i=t.ownerSVGElement||t;if(i.createSVGPoint){var n=i.createSVGPoint();if(0>La){var o=e(t);if(o.scrollX||o.scrollY){i=ra.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var a=i[0][0].getScreenCTM();La=!(a.f||a.e),i.remove()}}return La?(n.x=r.pageX,n.y=r.pageY):(n.x=r.clientX,n.y=r.clientY),n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}var s=t.getBoundingClientRect();return[r.clientX-s.left-t.clientLeft,r.clientY-s.top-t.clientTop]}function X(){return ra.event.changedTouches[0].identifier}function J(t){return t>0?1:0>t?-1:0}function Q(t,e,r){return(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0])}function tt(t){return t>1?0:-1>t?Ca:Math.acos(t)}function et(t){return t>1?Oa:-1>t?-Oa:Math.asin(t)}function rt(t){return((t=Math.exp(t))-1/t)/2}function it(t){return((t=Math.exp(t))+1/t)/2}function nt(t){return((t=Math.exp(2*t))-1)/(t+1)}function ot(t){return(t=Math.sin(t/2))*t}function at(){}function st(t,e,r){return this instanceof st?(this.h=+t,this.s=+e,void(this.l=+r)):arguments.length<2?t instanceof st?new st(t.h,t.s,t.l):wt(""+t,_t,st):new st(t,e,r)}function lt(t,e,r){function i(t){return t>360?t-=360:0>t&&(t+=360),60>t?o+(a-o)*t/60:180>t?a:240>t?o+(a-o)*(240-t)/60:o}function n(t){return Math.round(255*i(t))}var o,a;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,r=0>r?0:r>1?1:r,a=.5>=r?r*(1+e):r+e-r*e,o=2*r-a,new yt(n(t+120),n(t),n(t-120))}function ut(t,e,r){return this instanceof ut?(this.h=+t,this.c=+e,void(this.l=+r)):arguments.length<2?t instanceof ut?new ut(t.h,t.c,t.l):t instanceof ht?dt(t.l,t.a,t.b):dt((t=xt((t=ra.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new ut(t,e,r)}function ct(t,e,r){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ht(r,Math.cos(t*=Ia)*e,Math.sin(t)*e)}function ht(t,e,r){return this instanceof ht?(this.l=+t,this.a=+e,void(this.b=+r)):arguments.length<2?t instanceof ht?new ht(t.l,t.a,t.b):t instanceof ut?ct(t.h,t.c,t.l):xt((t=yt(t)).r,t.g,t.b):new ht(t,e,r)}function ft(t,e,r){var i=(t+16)/116,n=i+e/500,o=i-r/200;return n=pt(n)*Ka,i=pt(i)*qa,o=pt(o)*Za,new yt(mt(3.2404542*n-1.5371385*i-.4985314*o),mt(-.969266*n+1.8760108*i+.041556*o),mt(.0556434*n-.2040259*i+1.0572252*o))}function dt(t,e,r){return t>0?new ut(Math.atan2(r,e)*ka,Math.sqrt(e*e+r*r),t):new ut(NaN,NaN,t)}function pt(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function gt(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function mt(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function yt(t,e,r){return this instanceof yt?(this.r=~~t,this.g=~~e,void(this.b=~~r)):arguments.length<2?t instanceof yt?new yt(t.r,t.g,t.b):wt(""+t,yt,lt):new yt(t,e,r)}function vt(t){return new yt(t>>16,t>>8&255,255&t)}function bt(t){return vt(t)+""}function Et(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function wt(t,e,r){t=t.toLowerCase();var i,n,o,a=0,s=0,l=0;if(i=/([a-z]+)\((.*)\)/.exec(t))switch(n=i[2].split(","),i[1]){case"hsl":return r(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100);case"rgb":return e(Tt(n[0]),Tt(n[1]),Tt(n[2]))}return(o=Ya.get(t))?e(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&o)>>4,a|=a>>4,s=240&o,s|=s>>4,l=15&o,l|=l<<4):7===t.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,l=255&o)),e(a,s,l))}function _t(t,e,r){var i,n,o=Math.min(t/=255,e/=255,r/=255),a=Math.max(t,e,r),s=a-o,l=(a+o)/2;return s?(n=.5>l?s/(a+o):s/(2-a-o),i=t==a?(e-r)/s+(r>e?6:0):e==a?(r-t)/s+2:(t-e)/s+4,i*=60):(i=NaN,n=l>0&&1>l?0:i),new st(i,n,l)}function xt(t,e,r){t=St(t),e=St(e),r=St(r);var i=gt((.4124564*t+.3575761*e+.1804375*r)/Ka),n=gt((.2126729*t+.7151522*e+.072175*r)/qa),o=gt((.0193339*t+.119192*e+.9503041*r)/Za);return ht(116*n-16,500*(i-n),200*(n-o))}function St(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Tt(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Mt(t){return"function"==typeof t?t:function(){return t}}function Lt(t){return function(e,r,i){return 2===arguments.length&&"function"==typeof r&&(i=r,r=null),At(e,r,t,i)}}function At(t,e,r,i){function n(){var t,e=l.status;if(!e&&Ct(l)||e>=200&&300>e||304===e){try{t=r.call(o,l)}catch(t){return void a.error.call(o,t)}a.load.call(o,t)}else a.error.call(o,l)}var o={},a=ra.dispatch("beforesend","progress","load","error"),s={},l=new XMLHttpRequest,u=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=n:l.onreadystatechange=function(){l.readyState>3&&n()},l.onprogress=function(t){var e=ra.event;ra.event=t;try{a.progress.call(o,l)}finally{ra.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?s[t]:(null==e?delete s[t]:s[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(u=t,o):u},o.response=function(t){return r=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(na(arguments)))}}),o.send=function(r,i,n){if(2===arguments.length&&"function"==typeof i&&(n=i,i=null),l.open(r,t,!0),null==e||"accept"in s||(s.accept=e+",*/*"),l.setRequestHeader)for(var c in s)l.setRequestHeader(c,s[c]);return null!=e&&l.overrideMimeType&&l.overrideMimeType(e),null!=u&&(l.responseType=u),null!=n&&o.on("error",n).on("load",function(t){n(null,t)}),a.beforesend.call(o,l),l.send(null==i?null:i),o},o.abort=function(){return l.abort(),o},ra.rebind(o,a,"on"),null==i?o:o.get(Nt(i))}function Nt(t){return 1===t.length?function(e,r){t(null==e?r:null)}:t}function Ct(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Rt(){var t=Pt(),e=Ot()-t;e>24?(isFinite(e)&&(clearTimeout(ts),ts=setTimeout(Rt,e)),Qa=0):(Qa=1,rs(Rt))}function Pt(){var t=Date.now();for(es=Xa;es;)t>=es.t&&(es.f=es.c(t-es.t)),es=es.n;return t}function Ot(){for(var t,e=Xa,r=1/0;e;)e.f?e=t?t.n=e.n:Xa=e.n:(e.t<r&&(r=e.t),e=(t=e).n);return Ja=t,r}function It(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function kt(t,e){var r=Math.pow(10,3*fa(8-e));return{scale:e>8?function(t){return t/r}:function(t){return t*r},symbol:t}}function Dt(t){var e=t.decimal,r=t.thousands,i=t.grouping,n=t.currency,o=i&&r?function(t,e){for(var n=t.length,o=[],a=0,s=i[0],l=0;n>0&&s>0&&(l+s+1>e&&(s=Math.max(1,e-l)),o.push(t.substring(n-=s,n+s)),!((l+=s+1)>e));)s=i[a=(a+1)%i.length];return o.reverse().join(r)}:v;return function(t){var r=ns.exec(t),i=r[1]||" ",a=r[2]||">",s=r[3]||"-",l=r[4]||"",u=r[5],c=+r[6],h=r[7],f=r[8],d=r[9],p=1,g="",m="",y=!1,v=!0;switch(f&&(f=+f.substring(1)),(u||"0"===i&&"="===a)&&(u=i="0",a="="),d){case"n":h=!0,d="g";break;case"%":p=100,m="%",d="f";break;case"p":p=100,m="%",d="r";break;case"b":case"o":case"x":case"X":"#"===l&&(g="0"+d.toLowerCase());case"c":v=!1;case"d":y=!0,f=0;break;case"s":p=-1,d="r"}"$"===l&&(g=n[0],m=n[1]),"r"!=d||f||(d="g"),null!=f&&("g"==d?f=Math.max(1,Math.min(21,f)):("e"==d||"f"==d)&&(f=Math.max(0,Math.min(20,f)))),d=os.get(d)||Vt;var b=u&&h;return function(t){var r=m;if(y&&t%1)return"";var n=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===s?"":s;if(0>p){var l=ra.formatPrefix(t,f);t=l.scale(t),r=l.symbol+m}else t*=p;t=d(t,f);var E,w,_=t.lastIndexOf(".");if(0>_){var x=v?t.lastIndexOf("e"):-1;0>x?(E=t,w=""):(E=t.substring(0,x),w=t.substring(x))}else E=t.substring(0,_),w=e+t.substring(_+1);!u&&h&&(E=o(E,1/0));var S=g.length+E.length+w.length+(b?0:n.length),T=c>S?new Array(S=c-S+1).join(i):"";return b&&(E=o(T+E,T.length?c-w.length:1/0)),n+=g,t=E+w,("<"===a?n+t+T:">"===a?T+n+t:"^"===a?T.substring(0,S>>=1)+n+t+T.substring(S):n+(b?t:T+t))+r}}}function Vt(t){return t+""}function Ft(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Gt(t,e,r){function i(e){var r=t(e),i=o(r,1);return i-e>e-r?r:i}function n(r){return e(r=t(new ss(r-1)),1),r}function o(t,r){return e(t=new ss(+t),r),t}function a(t,i,o){var a=n(t),s=[];if(o>1)for(;i>a;)r(a)%o||s.push(new Date(+a)),e(a,1);else for(;i>a;)s.push(new Date(+a)),e(a,1);return s}function s(t,e,r){try{ss=Ft;var i=new Ft;return i._=t,a(i,e,r)}finally{ss=Date}}t.floor=t,t.round=i,t.ceil=n,t.offset=o,t.range=a;var l=t.utc=Bt(t);return l.floor=l,l.round=Bt(i),l.ceil=Bt(n),l.offset=Bt(o),l.range=s,t}function Bt(t){return function(e,r){try{ss=Ft;var i=new Ft;return i._=e,t(i,r)._}finally{ss=Date}}}function Wt(t){function e(t){function e(e){for(var r,n,o,a=[],s=-1,l=0;++s<i;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(n=us[r=t.charAt(++s)])&&(r=t.charAt(++s)),(o=A[r])&&(r=o(e,null==n?"e"===r?" ":"0":n)),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}var i=t.length;return e.parse=function(e){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},n=r(i,t,e,0);if(n!=e.length)return null;"p"in i&&(i.H=i.H%12+12*i.p);var o=null!=i.Z&&ss!==Ft,a=new(o?Ft:ss);return"j"in i?a.setFullYear(i.y,0,i.j):"w"in i&&("W"in i||"U"in i)?(a.setFullYear(i.y,0,1),a.setFullYear(i.y,0,"W"in i?(i.w+6)%7+7*i.W-(a.getDay()+5)%7:i.w+7*i.U-(a.getDay()+6)%7)):a.setFullYear(i.y,i.m,i.d),a.setHours(i.H+(i.Z/100|0),i.M+i.Z%100,i.S,i.L),o?a._:a},e.toString=function(){return t},e}function r(t,e,r,i){for(var n,o,a,s=0,l=e.length,u=r.length;l>s;){if(i>=u)return-1;if(n=e.charCodeAt(s++),37===n){if(a=e.charAt(s++),o=N[a in us?e.charAt(s++):a],!o||(i=o(t,r,i))<0)return-1}else if(n!=r.charCodeAt(i++))return-1}return i}function i(t,e,r){_.lastIndex=0;var i=_.exec(e.slice(r));return i?(t.w=x.get(i[0].toLowerCase()),r+i[0].length):-1}function n(t,e,r){E.lastIndex=0;var i=E.exec(e.slice(r));return i?(t.w=w.get(i[0].toLowerCase()),r+i[0].length):-1}function o(t,e,r){M.lastIndex=0;var i=M.exec(e.slice(r));return i?(t.m=L.get(i[0].toLowerCase()),r+i[0].length):-1}function a(t,e,r){S.lastIndex=0;var i=S.exec(e.slice(r));return i?(t.m=T.get(i[0].toLowerCase()),r+i[0].length):-1}function s(t,e,i){return r(t,A.c.toString(),e,i)}function l(t,e,i){return r(t,A.x.toString(),e,i)}function u(t,e,i){return r(t,A.X.toString(),e,i)}function c(t,e,r){var i=b.get(e.slice(r,r+=2).toLowerCase());return null==i?-1:(t.p=i,r)}var h=t.dateTime,f=t.date,d=t.time,p=t.periods,g=t.days,m=t.shortDays,y=t.months,v=t.shortMonths;e.utc=function(t){function r(t){try{ss=Ft;var e=new ss;return e._=t,i(e)}finally{ss=Date}}var i=e(t);return r.parse=function(t){try{ss=Ft;var e=i.parse(t);return e&&e._}finally{ss=Date}},r.toString=i.toString,r},e.multi=e.utc.multi=se;var b=ra.map(),E=zt(g),w=jt(g),_=zt(m),x=jt(m),S=zt(y),T=jt(y),M=zt(v),L=jt(v);p.forEach(function(t,e){b.set(t.toLowerCase(),e)});var A={a:function(t){return m[t.getDay()]},A:function(t){return g[t.getDay()]},b:function(t){return v[t.getMonth()]},B:function(t){return y[t.getMonth()]},c:e(h),d:function(t,e){return Ut(t.getDate(),e,2)},e:function(t,e){return Ut(t.getDate(),e,2)},H:function(t,e){return Ut(t.getHours(),e,2)},I:function(t,e){return Ut(t.getHours()%12||12,e,2)},j:function(t,e){return Ut(1+as.dayOfYear(t),e,3)},L:function(t,e){return Ut(t.getMilliseconds(),e,3)},m:function(t,e){return Ut(t.getMonth()+1,e,2)},M:function(t,e){return Ut(t.getMinutes(),e,2)},p:function(t){return p[+(t.getHours()>=12)]},S:function(t,e){return Ut(t.getSeconds(),e,2)},U:function(t,e){return Ut(as.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Ut(as.mondayOfYear(t),e,2)},x:e(f),X:e(d),y:function(t,e){return Ut(t.getFullYear()%100,e,2)},Y:function(t,e){return Ut(t.getFullYear()%1e4,e,4)},Z:oe,"%":function(){return"%"}},N={a:i,A:n,b:o,B:a,c:s,d:Qt,e:Qt,H:ee,I:ee,j:te,L:ne,m:Jt,M:re,p:c,S:ie,U:qt,w:Kt,W:Zt,x:l,X:u,y:$t,Y:Ht,Z:Yt,"%":ae};return e}function Ut(t,e,r){var i=0>t?"-":"",n=(i?-t:t)+"",o=n.length;return i+(r>o?new Array(r-o+1).join(e)+n:n)}function zt(t){return new RegExp("^(?:"+t.map(ra.requote).join("|")+")","i")}function jt(t){for(var e=new u,r=-1,i=t.length;++r<i;)e.set(t[r].toLowerCase(),r);return e}function Kt(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+1));return i?(t.w=+i[0],r+i[0].length):-1}function qt(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r));return i?(t.U=+i[0],r+i[0].length):-1}function Zt(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r));return i?(t.W=+i[0],r+i[0].length):-1}function Ht(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+4));return i?(t.y=+i[0],r+i[0].length):-1}function $t(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+2));return i?(t.y=Xt(+i[0]),r+i[0].length):-1}function Yt(t,e,r){return/^[+-]\d{4}$/.test(e=e.slice(r,r+5))?(t.Z=-e,r+5):-1}function Xt(t){return t+(t>68?1900:2e3)}function Jt(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+2));return i?(t.m=i[0]-1,r+i[0].length):-1}function Qt(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+2));return i?(t.d=+i[0],r+i[0].length):-1}function te(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+3));return i?(t.j=+i[0],r+i[0].length):-1}function ee(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+2));return i?(t.H=+i[0],r+i[0].length):-1}function re(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+2));return i?(t.M=+i[0],r+i[0].length):-1}function ie(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+2));return i?(t.S=+i[0],r+i[0].length):-1}function ne(t,e,r){cs.lastIndex=0;var i=cs.exec(e.slice(r,r+3));return i?(t.L=+i[0],r+i[0].length):-1}function oe(t){var e=t.getTimezoneOffset(),r=e>0?"-":"+",i=fa(e)/60|0,n=fa(e)%60;return r+Ut(i,"0",2)+Ut(n,"0",2)}function ae(t,e,r){hs.lastIndex=0;var i=hs.exec(e.slice(r,r+1));return i?r+i[0].length:-1}function se(t){for(var e=t.length,r=-1;++r<e;)t[r][0]=this(t[r][0]);return function(e){for(var r=0,i=t[r];!i[1](e);)i=t[++r];return i[0](e)}}function le(){}function ue(t,e,r){var i=r.s=t+e,n=i-t,o=i-n;r.t=t-o+(e-n)}function ce(t,e){t&&gs.hasOwnProperty(t.type)&&gs[t.type](t,e)}function he(t,e,r){var i,n=-1,o=t.length-r;for(e.lineStart();++n<o;)i=t[n],e.point(i[0],i[1],i[2]);e.lineEnd()}function fe(t,e){var r=-1,i=t.length;for(e.polygonStart();++r<i;)he(t[r],e,1);e.polygonEnd()}function de(){function t(t,e){t*=Ia,e=e*Ia/2+Ca/4;var r=t-i,a=r>=0?1:-1,s=a*r,l=Math.cos(e),u=Math.sin(e),c=o*u,h=n*l+c*Math.cos(s),f=c*a*Math.sin(s);ys.add(Math.atan2(f,h)),i=t,n=l,o=u}var e,r,i,n,o;vs.point=function(a,s){vs.point=t,i=(e=a)*Ia,n=Math.cos(s=(r=s)*Ia/2+Ca/4),o=Math.sin(s)},vs.lineEnd=function(){t(e,r)}}function pe(t){var e=t[0],r=t[1],i=Math.cos(r);return[i*Math.cos(e),i*Math.sin(e),Math.sin(r)]}function ge(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function me(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ye(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function ve(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function be(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Ee(t){return[Math.atan2(t[1],t[0]),et(t[2])]}function we(t,e){return fa(t[0]-e[0])<Aa&&fa(t[1]-e[1])<Aa}function _e(t,e){t*=Ia;var r=Math.cos(e*=Ia);xe(r*Math.cos(t),r*Math.sin(t),Math.sin(e))}function xe(t,e,r){++bs,ws+=(t-ws)/bs,_s+=(e-_s)/bs,xs+=(r-xs)/bs}function Se(){function t(t,n){t*=Ia;var o=Math.cos(n*=Ia),a=o*Math.cos(t),s=o*Math.sin(t),l=Math.sin(n),u=Math.atan2(Math.sqrt((u=r*l-i*s)*u+(u=i*a-e*l)*u+(u=e*s-r*a)*u),e*a+r*s+i*l);Es+=u,Ss+=u*(e+(e=a)),Ts+=u*(r+(r=s)),Ms+=u*(i+(i=l)),xe(e,r,i)}var e,r,i;Cs.point=function(n,o){n*=Ia;var a=Math.cos(o*=Ia);e=a*Math.cos(n),r=a*Math.sin(n),i=Math.sin(o),Cs.point=t,xe(e,r,i)}}function Te(){Cs.point=_e}function Me(){function t(t,e){t*=Ia;var r=Math.cos(e*=Ia),a=r*Math.cos(t),s=r*Math.sin(t),l=Math.sin(e),u=n*l-o*s,c=o*a-i*l,h=i*s-n*a,f=Math.sqrt(u*u+c*c+h*h),d=i*a+n*s+o*l,p=f&&-tt(d)/f,g=Math.atan2(f,d);Ls+=p*u,As+=p*c,Ns+=p*h,Es+=g,Ss+=g*(i+(i=a)),Ts+=g*(n+(n=s)),Ms+=g*(o+(o=l)),xe(i,n,o)}var e,r,i,n,o;Cs.point=function(a,s){e=a,r=s,Cs.point=t,a*=Ia;var l=Math.cos(s*=Ia);i=l*Math.cos(a),n=l*Math.sin(a),o=Math.sin(s),xe(i,n,o)},Cs.lineEnd=function(){t(e,r),Cs.lineEnd=Te,Cs.point=_e}}function Le(t,e){function r(r,i){return r=t(r,i),e(r[0],r[1])}return t.invert&&e.invert&&(r.invert=function(r,i){return r=e.invert(r,i),r&&t.invert(r[0],r[1])}),r}function Ae(){return!0}function Ne(t,e,r,i,n){var o=[],a=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,r=t[0],i=t[e];if(we(r,i)){n.lineStart();for(var s=0;e>s;++s)n.point((r=t[s])[0],r[1]);return void n.lineEnd()}var l=new Re(r,t,null,!0),u=new Re(r,null,l,!1);l.o=u,o.push(l),a.push(u),l=new Re(i,t,null,!1),u=new Re(i,null,l,!0),l.o=u,o.push(l),a.push(u)}}),a.sort(e),Ce(o),Ce(a),o.length){for(var s=0,l=r,u=a.length;u>s;++s)a[s].e=l=!l;for(var c,h,f=o[0];;){for(var d=f,p=!0;d.v;)if((d=d.n)===f)return;c=d.z,n.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(var s=0,u=c.length;u>s;++s)n.point((h=c[s])[0],h[1]);else i(d.x,d.n.x,1,n);d=d.n}else{if(p){c=d.p.z;for(var s=c.length-1;s>=0;--s)n.point((h=c[s])[0],h[1])}else i(d.x,d.p.x,-1,n);d=d.p}d=d.o,c=d.z,p=!p}while(!d.v);n.lineEnd()}}}function Ce(t){if(e=t.length){for(var e,r,i=0,n=t[0];++i<e;)n.n=r=t[i],r.p=n,n=r;n.n=r=t[0],r.p=n}}function Re(t,e,r,i){this.x=t,this.z=e,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}function Pe(t,e,r,i){return function(n,o){function a(e,r){var i=n(e,r);t(e=i[0],r=i[1])&&o.point(e,r)}function s(t,e){var r=n(t,e);m.point(r[0],r[1])}function l(){v.point=s,m.lineStart()}function u(){v.point=a,m.lineEnd()}function c(t,e){g.push([t,e]);var r=n(t,e);E.point(r[0],r[1])}function h(){E.lineStart(),g=[]}function f(){c(g[0][0],g[0][1]),E.lineEnd();var t,e=E.clean(),r=b.buffer(),i=r.length;if(g.pop(),p.push(g),g=null,i)if(1&e){t=r[0];var n,i=t.length-1,a=-1;if(i>0){for(w||(o.polygonStart(),w=!0),o.lineStart();++a<i;)o.point((n=t[a])[0],n[1]);o.lineEnd()}}else i>1&&2&e&&r.push(r.pop().concat(r.shift())),d.push(r.filter(Oe))}var d,p,g,m=e(o),y=n.invert(i[0],i[1]),v={point:a,lineStart:l,lineEnd:u,polygonStart:function(){v.point=c,v.lineStart=h,v.lineEnd=f,d=[],p=[]},polygonEnd:function(){v.point=a,v.lineStart=l,v.lineEnd=u,d=ra.merge(d);var t=Ge(y,p);d.length?(w||(o.polygonStart(),w=!0),Ne(d,ke,t,r,o)):t&&(w||(o.polygonStart(),w=!0),o.lineStart(),r(null,null,1,o),o.lineEnd()),w&&(o.polygonEnd(),w=!1),d=p=null},sphere:function(){o.polygonStart(),o.lineStart(),r(null,null,1,o),o.lineEnd(),o.polygonEnd()}},b=Ie(),E=e(b),w=!1;return v}}function Oe(t){return t.length>1}function Ie(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,r){t.push([e,r])},lineEnd:w,buffer:function(){var r=e;return e=[],t=null,r},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function ke(t,e){return((t=t.x)[0]<0?t[1]-Oa-Aa:Oa-t[1])-((e=e.x)[0]<0?e[1]-Oa-Aa:Oa-e[1])}function De(t){var e,r=NaN,i=NaN,n=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?Ca:-Ca,l=fa(o-r);fa(l-Ca)<Aa?(t.point(r,i=(i+a)/2>0?Oa:-Oa),t.point(n,i),t.lineEnd(),t.lineStart(),t.point(s,i),t.point(o,i),e=0):n!==s&&l>=Ca&&(fa(r-n)<Aa&&(r-=n*Aa),fa(o-s)<Aa&&(o-=s*Aa),i=Ve(r,i,o,a),t.point(n,i),t.lineEnd(),t.lineStart(),t.point(s,i),e=0),t.point(r=o,i=a),n=s},lineEnd:function(){t.lineEnd(),r=i=NaN},clean:function(){return 2-e}}}function Ve(t,e,r,i){var n,o,a=Math.sin(t-r);return fa(a)>Aa?Math.atan((Math.sin(e)*(o=Math.cos(i))*Math.sin(r)-Math.sin(i)*(n=Math.cos(e))*Math.sin(t))/(n*o*a)):(e+i)/2}function Fe(t,e,r,i){var n;if(null==t)n=r*Oa,i.point(-Ca,n),i.point(0,n),i.point(Ca,n),i.point(Ca,0),i.point(Ca,-n),i.point(0,-n),i.point(-Ca,-n),i.point(-Ca,0),i.point(-Ca,n);else if(fa(t[0]-e[0])>Aa){var o=t[0]<e[0]?Ca:-Ca;n=r*o/2,i.point(-o,n),i.point(0,n),i.point(o,n)}else i.point(e[0],e[1])}function Ge(t,e){var r=t[0],i=t[1],n=[Math.sin(r),-Math.cos(r),0],o=0,a=0;ys.reset();for(var s=0,l=e.length;l>s;++s){var u=e[s],c=u.length;if(c)for(var h=u[0],f=h[0],d=h[1]/2+Ca/4,p=Math.sin(d),g=Math.cos(d),m=1;;){m===c&&(m=0),t=u[m];var y=t[0],v=t[1]/2+Ca/4,b=Math.sin(v),E=Math.cos(v),w=y-f,_=w>=0?1:-1,x=_*w,S=x>Ca,T=p*b;if(ys.add(Math.atan2(T*_*Math.sin(x),g*E+T*Math.cos(x))),o+=S?w+_*Ra:w,S^f>=r^y>=r){var M=me(pe(h),pe(t));be(M);var L=me(n,M);be(L);var A=(S^w>=0?-1:1)*et(L[2]);(i>A||i===A&&(M[0]||M[1]))&&(a+=S^w>=0?1:-1)}if(!m++)break;f=y,p=b,g=E,h=t}}return(-Aa>o||Aa>o&&0>ys)^1&a}function Be(t){function e(t,e){return Math.cos(t)*Math.cos(e)>o}function r(t){var r,o,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,f){var d,p=[h,f],g=e(h,f),m=a?g?0:n(h,f):g?n(h+(0>h?Ca:-Ca),f):0;if(!r&&(u=l=g)&&t.lineStart(),g!==l&&(d=i(r,p),(we(r,d)||we(p,d))&&(p[0]+=Aa,p[1]+=Aa,g=e(p[0],p[1]))),g!==l)c=0,g?(t.lineStart(),d=i(p,r),t.point(d[0],d[1])):(d=i(r,p),t.point(d[0],d[1]),t.lineEnd()),r=d;else if(s&&r&&a^g){var y;m&o||!(y=i(p,r,!0))||(c=0,a?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!g||r&&we(r,p)||t.point(p[0],p[1]),r=p,l=g,o=m},lineEnd:function(){l&&t.lineEnd(),r=null},clean:function(){return c|(u&&l)<<1}}}function i(t,e,r){var i=pe(t),n=pe(e),a=[1,0,0],s=me(i,n),l=ge(s,s),u=s[0],c=l-u*u;if(!c)return!r&&t;var h=o*l/c,f=-o*u/c,d=me(a,s),p=ve(a,h),g=ve(s,f);ye(p,g);var m=d,y=ge(p,m),v=ge(m,m),b=y*y-v*(ge(p,p)-1);if(!(0>b)){var E=Math.sqrt(b),w=ve(m,(-y-E)/v);if(ye(w,p),w=Ee(w),!r)return w;var _,x=t[0],S=e[0],T=t[1],M=e[1];x>S&&(_=x,x=S,S=_);var L=S-x,A=fa(L-Ca)<Aa,N=A||Aa>L;if(!A&&T>M&&(_=T,T=M,M=_),N?A?T+M>0^w[1]<(fa(w[0]-x)<Aa?T:M):T<=w[1]&&w[1]<=M:L>Ca^(x<=w[0]&&w[0]<=S)){var C=ve(m,(-y+E)/v);return ye(C,p),[w,Ee(C)]}}}function n(e,r){var i=a?t:Ca-t,n=0;return-i>e?n|=1:e>i&&(n|=2),-i>r?n|=4:r>i&&(n|=8),n}var o=Math.cos(t),a=o>0,s=fa(o)>Aa,l=dr(t,6*Ia);return Pe(e,r,l,a?[0,-t]:[-Ca,t-Ca])}function We(t,e,r,i){return function(n){var o,a=n.a,s=n.b,l=a.x,u=a.y,c=s.x,h=s.y,f=0,d=1,p=c-l,g=h-u;if(o=t-l,p||!(o>0)){if(o/=p,0>p){if(f>o)return;d>o&&(d=o)}else if(p>0){if(o>d)return;o>f&&(f=o)}if(o=r-l,p||!(0>o)){if(o/=p,0>p){if(o>d)return;o>f&&(f=o)}else if(p>0){if(f>o)return;d>o&&(d=o)}if(o=e-u,g||!(o>0)){if(o/=g,0>g){if(f>o)return;d>o&&(d=o)}else if(g>0){if(o>d)return;o>f&&(f=o)}if(o=i-u,g||!(0>o)){if(o/=g,0>g){if(o>d)return;o>f&&(f=o)}else if(g>0){if(f>o)return;d>o&&(d=o)}return f>0&&(n.a={x:l+f*p,y:u+f*g}),1>d&&(n.b={x:l+d*p,y:u+d*g}),n}}}}}}function Ue(t,e,r,i){function n(i,n){return fa(i[0]-t)<Aa?n>0?0:3:fa(i[0]-r)<Aa?n>0?2:1:fa(i[1]-e)<Aa?n>0?1:0:n>0?3:2}function o(t,e){return a(t.x,e.x)}function a(t,e){var r=n(t,1),i=n(e,1);return r!==i?r-i:0===r?e[1]-t[1]:1===r?t[0]-e[0]:2===r?t[1]-e[1]:e[0]-t[0]}return function(s){function l(t){for(var e=0,r=m.length,i=t[1],n=0;r>n;++n)for(var o,a=1,s=m[n],l=s.length,u=s[0];l>a;++a)o=s[a],u[1]<=i?o[1]>i&&Q(u,o,t)>0&&++e:o[1]<=i&&Q(u,o,t)<0&&--e,u=o;return 0!==e}function u(o,s,l,u){var c=0,h=0;if(null==o||(c=n(o,l))!==(h=n(s,l))||a(o,s)<0^l>0){do u.point(0===c||3===c?t:r,c>1?i:e);while((c=(c+l+4)%4)!==h)}else u.point(s[0],s[1])}function c(n,o){return n>=t&&r>=n&&o>=e&&i>=o}function h(t,e){c(t,e)&&s.point(t,e)}function f(){N.point=p,m&&m.push(y=[]),S=!0,x=!1,w=_=NaN}function d(){g&&(p(v,b),E&&x&&L.rejoin(),g.push(L.buffer())),N.point=h,x&&s.lineEnd()}function p(t,e){t=Math.max(-Ps,Math.min(Ps,t)),e=Math.max(-Ps,Math.min(Ps,e));var r=c(t,e);if(m&&y.push([t,e]),S)v=t,b=e,E=r,S=!1,r&&(s.lineStart(),s.point(t,e));else if(r&&x)s.point(t,e);else{var i={a:{x:w,y:_},b:{x:t,y:e}};A(i)?(x||(s.lineStart(),s.point(i.a.x,i.a.y)),s.point(i.b.x,i.b.y),r||s.lineEnd(),T=!1):r&&(s.lineStart(),s.point(t,e),T=!1)}w=t,_=e,x=r}var g,m,y,v,b,E,w,_,x,S,T,M=s,L=Ie(),A=We(t,e,r,i),N={point:h,lineStart:f,lineEnd:d,polygonStart:function(){s=L,g=[],m=[],T=!0},polygonEnd:function(){s=M,g=ra.merge(g);var e=l([t,i]),r=T&&e,n=g.length;(r||n)&&(s.polygonStart(),r&&(s.lineStart(),u(null,null,1,s),s.lineEnd()),n&&Ne(g,o,e,u,s),s.polygonEnd()),g=m=y=null}};return N}}function ze(t){var e=0,r=Ca/3,i=or(t),n=i(e,r);return n.parallels=function(t){return arguments.length?i(e=t[0]*Ca/180,r=t[1]*Ca/180):[e/Ca*180,r/Ca*180]},n}function je(t,e){function r(t,e){var r=Math.sqrt(o-2*n*Math.sin(e))/n;return[r*Math.sin(t*=n),a-r*Math.cos(t)]}var i=Math.sin(t),n=(i+Math.sin(e))/2,o=1+i*(2*n-i),a=Math.sqrt(o)/n;return r.invert=function(t,e){var r=a-e;return[Math.atan2(t,r)/n,et((o-(t*t+r*r)*n*n)/(2*n))]},r}function Ke(){function t(t,e){Is+=n*t-i*e,i=t,n=e}var e,r,i,n;Gs.point=function(o,a){Gs.point=t,e=i=o,r=n=a},Gs.lineEnd=function(){t(e,r)}}function qe(t,e){ks>t&&(ks=t),t>Vs&&(Vs=t),Ds>e&&(Ds=e),e>Fs&&(Fs=e)}function Ze(){function t(t,e){a.push("M",t,",",e,o)}function e(t,e){a.push("M",t,",",e),s.point=r}function r(t,e){a.push("L",t,",",e)}function i(){s.point=t}function n(){a.push("Z")}var o=He(4.5),a=[],s={point:t,lineStart:function(){s.point=e},lineEnd:i,polygonStart:function(){s.lineEnd=n},polygonEnd:function(){s.lineEnd=i,s.point=t},pointRadius:function(t){return o=He(t),s},result:function(){if(a.length){var t=a.join("");return a=[],t}}};return s}function He(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function $e(t,e){ws+=t,_s+=e,++xs}function Ye(){function t(t,i){var n=t-e,o=i-r,a=Math.sqrt(n*n+o*o);Ss+=a*(e+t)/2,Ts+=a*(r+i)/2,Ms+=a,$e(e=t,r=i)}var e,r;Ws.point=function(i,n){Ws.point=t,$e(e=i,r=n)}}function Xe(){Ws.point=$e}function Je(){function t(t,e){var r=t-i,o=e-n,a=Math.sqrt(r*r+o*o);Ss+=a*(i+t)/2,Ts+=a*(n+e)/2,Ms+=a,a=n*t-i*e,Ls+=a*(i+t),As+=a*(n+e),Ns+=3*a,$e(i=t,n=e)}var e,r,i,n;Ws.point=function(o,a){Ws.point=t,$e(e=i=o,r=n=a)},Ws.lineEnd=function(){t(e,r)}}function Qe(t){function e(e,r){t.moveTo(e+a,r),t.arc(e,r,a,0,Ra)}function r(e,r){t.moveTo(e,r),s.point=i}function i(e,r){t.lineTo(e,r)}function n(){s.point=e}function o(){t.closePath()}var a=4.5,s={point:e,lineStart:function(){s.point=r},lineEnd:n,polygonStart:function(){s.lineEnd=o},polygonEnd:function(){s.lineEnd=n,s.point=e},pointRadius:function(t){return a=t,s},result:w};return s}function tr(t){function e(t){return(s?i:r)(t)}function r(e){return ir(e,function(r,i){r=t(r,i),e.point(r[0],r[1])})}function i(e){function r(r,i){r=t(r,i),e.point(r[0],r[1])}function i(){b=NaN,S.point=o,e.lineStart()}function o(r,i){var o=pe([r,i]),a=t(r,i);n(b,E,v,w,_,x,b=a[0],E=a[1],v=r,w=o[0],_=o[1],x=o[2],s,e),e.point(b,E)}function a(){S.point=r,e.lineEnd()}function l(){i(),S.point=u,S.lineEnd=c}function u(t,e){o(h=t,f=e),d=b,p=E,g=w,m=_,y=x,S.point=o}function c(){n(b,E,v,w,_,x,d,p,h,g,m,y,s,e),S.lineEnd=a,a()}var h,f,d,p,g,m,y,v,b,E,w,_,x,S={point:r,lineStart:i,lineEnd:a,polygonStart:function(){e.polygonStart(),S.lineStart=l},polygonEnd:function(){e.polygonEnd(),S.lineStart=i}};return S}function n(e,r,i,s,l,u,c,h,f,d,p,g,m,y){var v=c-e,b=h-r,E=v*v+b*b;if(E>4*o&&m--){var w=s+d,_=l+p,x=u+g,S=Math.sqrt(w*w+_*_+x*x),T=Math.asin(x/=S),M=fa(fa(x)-1)<Aa||fa(i-f)<Aa?(i+f)/2:Math.atan2(_,w),L=t(M,T),A=L[0],N=L[1],C=A-e,R=N-r,P=b*C-v*R;(P*P/E>o||fa((v*C+b*R)/E-.5)>.3||a>s*d+l*p+u*g)&&(n(e,r,i,s,l,u,A,N,M,w/=S,_/=S,x,m,y),y.point(A,N),n(A,N,M,w,_,x,c,h,f,d,p,g,m,y))}}var o=.5,a=Math.cos(30*Ia),s=16;return e.precision=function(t){return arguments.length?(s=(o=t*t)>0&&16,e):Math.sqrt(o)},e}function er(t){var e=tr(function(e,r){return t([e*ka,r*ka])});return function(t){return ar(e(t))}}function rr(t){this.stream=t}function ir(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function nr(t){return or(function(){return t})()}function or(t){function e(t){return t=s(t[0]*Ia,t[1]*Ia),[t[0]*f+l,u-t[1]*f]}function r(t){return t=s.invert((t[0]-l)/f,(u-t[1])/f),t&&[t[0]*ka,t[1]*ka]}function i(){s=Le(a=ur(y,b,E),o);var t=o(g,m);return l=d-t[0]*f,u=p+t[1]*f,n()}function n(){return c&&(c.valid=!1,c=null),e}var o,a,s,l,u,c,h=tr(function(t,e){return t=o(t,e),[t[0]*f+l,u-t[1]*f]}),f=150,d=480,p=250,g=0,m=0,y=0,b=0,E=0,w=Rs,_=v,x=null,S=null;return e.stream=function(t){return c&&(c.valid=!1),c=ar(w(a,h(_(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(w=null==t?(x=t,Rs):Be((x=+t)*Ia),n()):x},e.clipExtent=function(t){return arguments.length?(S=t,_=t?Ue(t[0][0],t[0][1],t[1][0],t[1][1]):v,n()):S},e.scale=function(t){return arguments.length?(f=+t,i()):f},e.translate=function(t){return arguments.length?(d=+t[0],p=+t[1],i()):[d,p]},e.center=function(t){return arguments.length?(g=t[0]%360*Ia,m=t[1]%360*Ia,i()):[g*ka,m*ka]},e.rotate=function(t){return arguments.length?(y=t[0]%360*Ia,b=t[1]%360*Ia,E=t.length>2?t[2]%360*Ia:0,i()):[y*ka,b*ka,E*ka]},ra.rebind(e,h,"precision"),function(){return o=t.apply(this,arguments),e.invert=o.invert&&r,i()}}function ar(t){return ir(t,function(e,r){t.point(e*Ia,r*Ia)})}function sr(t,e){return[t,e]}function lr(t,e){return[t>Ca?t-Ra:-Ca>t?t+Ra:t,e]}function ur(t,e,r){return t?e||r?Le(hr(t),fr(e,r)):hr(t):e||r?fr(e,r):lr}function cr(t){return function(e,r){return e+=t,[e>Ca?e-Ra:-Ca>e?e+Ra:e,r]}}function hr(t){var e=cr(t);return e.invert=cr(-t),e}function fr(t,e){function r(t,e){var r=Math.cos(e),s=Math.cos(t)*r,l=Math.sin(t)*r,u=Math.sin(e),c=u*i+s*n;return[Math.atan2(l*o-c*a,s*i-u*n),et(c*o+l*a)]}var i=Math.cos(t),n=Math.sin(t),o=Math.cos(e),a=Math.sin(e);return r.invert=function(t,e){var r=Math.cos(e),s=Math.cos(t)*r,l=Math.sin(t)*r,u=Math.sin(e),c=u*o-l*a;return[Math.atan2(l*o+u*a,s*i+c*n),et(c*i-s*n)]},r}function dr(t,e){var r=Math.cos(t),i=Math.sin(t);return function(n,o,a,s){var l=a*e;null!=n?(n=pr(r,n),o=pr(r,o),(a>0?o>n:n>o)&&(n+=a*Ra)):(n=t+a*Ra,o=t-.5*l);for(var u,c=n;a>0?c>o:o>c;c-=l)s.point((u=Ee([r,-i*Math.cos(c),-i*Math.sin(c)]))[0],u[1])}}function pr(t,e){var r=pe(e);r[0]-=t,be(r);var i=tt(-r[1]);return((-r[2]<0?-i:i)+2*Math.PI-Aa)%(2*Math.PI)}function gr(t,e,r){var i=ra.range(t,e-Aa,r).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function mr(t,e,r){var i=ra.range(t,e-Aa,r).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function yr(t){return t.source}function vr(t){return t.target}function br(t,e,r,i){var n=Math.cos(e),o=Math.sin(e),a=Math.cos(i),s=Math.sin(i),l=n*Math.cos(t),u=n*Math.sin(t),c=a*Math.cos(r),h=a*Math.sin(r),f=2*Math.asin(Math.sqrt(ot(i-e)+n*a*ot(r-t))),d=1/Math.sin(f),p=f?function(t){var e=Math.sin(t*=f)*d,r=Math.sin(f-t)*d,i=r*l+e*c,n=r*u+e*h,a=r*o+e*s;return[Math.atan2(n,i)*ka,Math.atan2(a,Math.sqrt(i*i+n*n))*ka]}:function(){return[t*ka,e*ka]};return p.distance=f,p}function Er(){function t(t,n){var o=Math.sin(n*=Ia),a=Math.cos(n),s=fa((t*=Ia)-e),l=Math.cos(s);Us+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=i*o-r*a*l)*s),r*o+i*a*l),e=t,r=o,i=a}var e,r,i;zs.point=function(n,o){e=n*Ia,r=Math.sin(o*=Ia),i=Math.cos(o),zs.point=t},zs.lineEnd=function(){zs.point=zs.lineEnd=w;
}}function wr(t,e){function r(e,r){var i=Math.cos(e),n=Math.cos(r),o=t(i*n);return[o*n*Math.sin(e),o*Math.sin(r)]}return r.invert=function(t,r){var i=Math.sqrt(t*t+r*r),n=e(i),o=Math.sin(n),a=Math.cos(n);return[Math.atan2(t*o,i*a),Math.asin(i&&r*o/i)]},r}function _r(t,e){function r(t,e){a>0?-Oa+Aa>e&&(e=-Oa+Aa):e>Oa-Aa&&(e=Oa-Aa);var r=a/Math.pow(n(e),o);return[r*Math.sin(o*t),a-r*Math.cos(o*t)]}var i=Math.cos(t),n=function(t){return Math.tan(Ca/4+t/2)},o=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(n(e)/n(t)),a=i*Math.pow(n(t),o)/o;return o?(r.invert=function(t,e){var r=a-e,i=J(o)*Math.sqrt(t*t+r*r);return[Math.atan2(t,r)/o,2*Math.atan(Math.pow(a/i,1/o))-Oa]},r):Sr}function xr(t,e){function r(t,e){var r=o-e;return[r*Math.sin(n*t),o-r*Math.cos(n*t)]}var i=Math.cos(t),n=t===e?Math.sin(t):(i-Math.cos(e))/(e-t),o=i/n+t;return fa(n)<Aa?sr:(r.invert=function(t,e){var r=o-e;return[Math.atan2(t,r)/n,o-J(n)*Math.sqrt(t*t+r*r)]},r)}function Sr(t,e){return[t,Math.log(Math.tan(Ca/4+e/2))]}function Tr(t){var e,r=nr(t),i=r.scale,n=r.translate,o=r.clipExtent;return r.scale=function(){var t=i.apply(r,arguments);return t===r?e?r.clipExtent(null):r:t},r.translate=function(){var t=n.apply(r,arguments);return t===r?e?r.clipExtent(null):r:t},r.clipExtent=function(t){var a=o.apply(r,arguments);if(a===r){if(e=null==t){var s=Ca*i(),l=n();o([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else e&&(a=null);return a},r.clipExtent(null)}function Mr(t,e){return[Math.log(Math.tan(Ca/4+e/2)),-t]}function Lr(t){return t[0]}function Ar(t){return t[1]}function Nr(t){for(var e=t.length,r=[0,1],i=2,n=2;e>n;n++){for(;i>1&&Q(t[r[i-2]],t[r[i-1]],t[n])<=0;)--i;r[i++]=n}return r.slice(0,i)}function Cr(t,e){return t[0]-e[0]||t[1]-e[1]}function Rr(t,e,r){return(r[0]-e[0])*(t[1]-e[1])<(r[1]-e[1])*(t[0]-e[0])}function Pr(t,e,r,i){var n=t[0],o=r[0],a=e[0]-n,s=i[0]-o,l=t[1],u=r[1],c=e[1]-l,h=i[1]-u,f=(s*(l-u)-h*(n-o))/(h*a-s*c);return[n+f*a,l+f*c]}function Or(t){var e=t[0],r=t[t.length-1];return!(e[0]-r[0]||e[1]-r[1])}function Ir(){ei(this),this.edge=this.site=this.circle=null}function kr(t){var e=el.pop()||new Ir;return e.site=t,e}function Dr(t){qr(t),Js.remove(t),el.push(t),ei(t)}function Vr(t){var e=t.circle,r=e.x,i=e.cy,n={x:r,y:i},o=t.P,a=t.N,s=[t];Dr(t);for(var l=o;l.circle&&fa(r-l.circle.x)<Aa&&fa(i-l.circle.cy)<Aa;)o=l.P,s.unshift(l),Dr(l),l=o;s.unshift(l),qr(l);for(var u=a;u.circle&&fa(r-u.circle.x)<Aa&&fa(i-u.circle.cy)<Aa;)a=u.N,s.push(u),Dr(u),u=a;s.push(u),qr(u);var c,h=s.length;for(c=1;h>c;++c)u=s[c],l=s[c-1],Jr(u.edge,l.site,u.site,n);l=s[0],u=s[h-1],u.edge=Yr(l.site,u.site,null,n),Kr(l),Kr(u)}function Fr(t){for(var e,r,i,n,o=t.x,a=t.y,s=Js._;s;)if(i=Gr(s,a)-o,i>Aa)s=s.L;else{if(n=o-Br(s,a),!(n>Aa)){i>-Aa?(e=s.P,r=s):n>-Aa?(e=s,r=s.N):e=r=s;break}if(!s.R){e=s;break}s=s.R}var l=kr(t);if(Js.insert(e,l),e||r){if(e===r)return qr(e),r=kr(e.site),Js.insert(l,r),l.edge=r.edge=Yr(e.site,l.site),Kr(e),void Kr(r);if(!r)return void(l.edge=Yr(e.site,l.site));qr(e),qr(r);var u=e.site,c=u.x,h=u.y,f=t.x-c,d=t.y-h,p=r.site,g=p.x-c,m=p.y-h,y=2*(f*m-d*g),v=f*f+d*d,b=g*g+m*m,E={x:(m*v-d*b)/y+c,y:(f*b-g*v)/y+h};Jr(r.edge,u,p,E),l.edge=Yr(u,t,null,E),r.edge=Yr(t,p,null,E),Kr(e),Kr(r)}}function Gr(t,e){var r=t.site,i=r.x,n=r.y,o=n-e;if(!o)return i;var a=t.P;if(!a)return-1/0;r=a.site;var s=r.x,l=r.y,u=l-e;if(!u)return s;var c=s-i,h=1/o-1/u,f=c/u;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*u)-l+u/2+n-o/2)))/h+i:(i+s)/2}function Br(t,e){var r=t.N;if(r)return Gr(r,e);var i=t.site;return i.y===e?i.x:1/0}function Wr(t){this.site=t,this.edges=[]}function Ur(t){for(var e,r,i,n,o,a,s,l,u,c,h=t[0][0],f=t[1][0],d=t[0][1],p=t[1][1],g=Xs,m=g.length;m--;)if(o=g[m],o&&o.prepare())for(s=o.edges,l=s.length,a=0;l>a;)c=s[a].end(),i=c.x,n=c.y,u=s[++a%l].start(),e=u.x,r=u.y,(fa(i-e)>Aa||fa(n-r)>Aa)&&(s.splice(a,0,new Qr(Xr(o.site,c,fa(i-h)<Aa&&p-n>Aa?{x:h,y:fa(e-h)<Aa?r:p}:fa(n-p)<Aa&&f-i>Aa?{x:fa(r-p)<Aa?e:f,y:p}:fa(i-f)<Aa&&n-d>Aa?{x:f,y:fa(e-f)<Aa?r:d}:fa(n-d)<Aa&&i-h>Aa?{x:fa(r-d)<Aa?e:h,y:d}:null),o.site,null)),++l)}function zr(t,e){return e.angle-t.angle}function jr(){ei(this),this.x=this.y=this.arc=this.site=this.cy=null}function Kr(t){var e=t.P,r=t.N;if(e&&r){var i=e.site,n=t.site,o=r.site;if(i!==o){var a=n.x,s=n.y,l=i.x-a,u=i.y-s,c=o.x-a,h=o.y-s,f=2*(l*h-u*c);if(!(f>=-Na)){var d=l*l+u*u,p=c*c+h*h,g=(h*d-u*p)/f,m=(l*p-c*d)/f,h=m+s,y=rl.pop()||new jr;y.arc=t,y.site=n,y.x=g+a,y.y=h+Math.sqrt(g*g+m*m),y.cy=h,t.circle=y;for(var v=null,b=tl._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(!b.L){v=b.P;break}b=b.L}else{if(!b.R){v=b;break}b=b.R}tl.insert(v,y),v||(Qs=y)}}}}function qr(t){var e=t.circle;e&&(e.P||(Qs=e.N),tl.remove(e),rl.push(e),ei(e),t.circle=null)}function Zr(t){for(var e,r=Ys,i=We(t[0][0],t[0][1],t[1][0],t[1][1]),n=r.length;n--;)e=r[n],(!Hr(e,t)||!i(e)||fa(e.a.x-e.b.x)<Aa&&fa(e.a.y-e.b.y)<Aa)&&(e.a=e.b=null,r.splice(n,1))}function Hr(t,e){var r=t.b;if(r)return!0;var i,n,o=t.a,a=e[0][0],s=e[1][0],l=e[0][1],u=e[1][1],c=t.l,h=t.r,f=c.x,d=c.y,p=h.x,g=h.y,m=(f+p)/2,y=(d+g)/2;if(g===d){if(a>m||m>=s)return;if(f>p){if(o){if(o.y>=u)return}else o={x:m,y:l};r={x:m,y:u}}else{if(o){if(o.y<l)return}else o={x:m,y:u};r={x:m,y:l}}}else if(i=(f-p)/(g-d),n=y-i*m,-1>i||i>1)if(f>p){if(o){if(o.y>=u)return}else o={x:(l-n)/i,y:l};r={x:(u-n)/i,y:u}}else{if(o){if(o.y<l)return}else o={x:(u-n)/i,y:u};r={x:(l-n)/i,y:l}}else if(g>d){if(o){if(o.x>=s)return}else o={x:a,y:i*a+n};r={x:s,y:i*s+n}}else{if(o){if(o.x<a)return}else o={x:s,y:i*s+n};r={x:a,y:i*a+n}}return t.a=o,t.b=r,!0}function $r(t,e){this.l=t,this.r=e,this.a=this.b=null}function Yr(t,e,r,i){var n=new $r(t,e);return Ys.push(n),r&&Jr(n,t,e,r),i&&Jr(n,e,t,i),Xs[t.i].edges.push(new Qr(n,t,e)),Xs[e.i].edges.push(new Qr(n,e,t)),n}function Xr(t,e,r){var i=new $r(t,null);return i.a=e,i.b=r,Ys.push(i),i}function Jr(t,e,r,i){t.a||t.b?t.l===r?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=r)}function Qr(t,e,r){var i=t.a,n=t.b;this.edge=t,this.site=e,this.angle=r?Math.atan2(r.y-e.y,r.x-e.x):t.l===e?Math.atan2(n.x-i.x,i.y-n.y):Math.atan2(i.x-n.x,n.y-i.y)}function ti(){this._=null}function ei(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ri(t,e){var r=e,i=e.R,n=r.U;n?n.L===r?n.L=i:n.R=i:t._=i,i.U=n,r.U=i,r.R=i.L,r.R&&(r.R.U=r),i.L=r}function ii(t,e){var r=e,i=e.L,n=r.U;n?n.L===r?n.L=i:n.R=i:t._=i,i.U=n,r.U=i,r.L=i.R,r.L&&(r.L.U=r),i.R=r}function ni(t){for(;t.L;)t=t.L;return t}function oi(t,e){var r,i,n,o=t.sort(ai).pop();for(Ys=[],Xs=new Array(t.length),Js=new ti,tl=new ti;;)if(n=Qs,o&&(!n||o.y<n.y||o.y===n.y&&o.x<n.x))(o.x!==r||o.y!==i)&&(Xs[o.i]=new Wr(o),Fr(o),r=o.x,i=o.y),o=t.pop();else{if(!n)break;Vr(n.arc)}e&&(Zr(e),Ur(e));var a={cells:Xs,edges:Ys};return Js=tl=Ys=Xs=null,a}function ai(t,e){return e.y-t.y||e.x-t.x}function si(t,e,r){return(t.x-r.x)*(e.y-t.y)-(t.x-e.x)*(r.y-t.y)}function li(t){return t.x}function ui(t){return t.y}function ci(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function hi(t,e,r,i,n,o){if(!t(e,r,i,n,o)){var a=.5*(r+n),s=.5*(i+o),l=e.nodes;l[0]&&hi(t,l[0],r,i,a,s),l[1]&&hi(t,l[1],a,i,n,s),l[2]&&hi(t,l[2],r,s,a,o),l[3]&&hi(t,l[3],a,s,n,o)}}function fi(t,e,r,i,n,o,a){var s,l=1/0;return function t(u,c,h,f,d){if(!(c>o||h>a||i>f||n>d)){if(p=u.point){var p,g=e-u.x,m=r-u.y,y=g*g+m*m;if(l>y){var v=Math.sqrt(l=y);i=e-v,n=r-v,o=e+v,a=r+v,s=p}}for(var b=u.nodes,E=.5*(c+f),w=.5*(h+d),_=e>=E,x=r>=w,S=x<<1|_,T=S+4;T>S;++S)if(u=b[3&S])switch(3&S){case 0:t(u,c,h,E,w);break;case 1:t(u,E,h,f,w);break;case 2:t(u,c,w,E,d);break;case 3:t(u,E,w,f,d)}}}(t,i,n,o,a),s}function di(t,e){t=ra.rgb(t),e=ra.rgb(e);var r=t.r,i=t.g,n=t.b,o=e.r-r,a=e.g-i,s=e.b-n;return function(t){return"#"+Et(Math.round(r+o*t))+Et(Math.round(i+a*t))+Et(Math.round(n+s*t))}}function pi(t,e){var r,i={},n={};for(r in t)r in e?i[r]=yi(t[r],e[r]):n[r]=t[r];for(r in e)r in t||(n[r]=e[r]);return function(t){for(r in i)n[r]=i[r](t);return n}}function gi(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function mi(t,e){var r,i,n,o=nl.lastIndex=ol.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(r=nl.exec(t))&&(i=ol.exec(e));)(n=i.index)>o&&(n=e.slice(o,n),s[a]?s[a]+=n:s[++a]=n),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:gi(r,i)})),o=ol.lastIndex;return o<e.length&&(n=e.slice(o),s[a]?s[a]+=n:s[++a]=n),s.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var r,i=0;e>i;++i)s[(r=l[i]).i]=r.x(t);return s.join("")})}function yi(t,e){for(var r,i=ra.interpolators.length;--i>=0&&!(r=ra.interpolators[i](t,e)););return r}function vi(t,e){var r,i=[],n=[],o=t.length,a=e.length,s=Math.min(t.length,e.length);for(r=0;s>r;++r)i.push(yi(t[r],e[r]));for(;o>r;++r)n[r]=t[r];for(;a>r;++r)n[r]=e[r];return function(t){for(r=0;s>r;++r)n[r]=i[r](t);return n}}function bi(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function Ei(t){return function(e){return 1-t(1-e)}}function wi(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function _i(t){return t*t}function xi(t){return t*t*t}function Si(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(.5>t?r:3*(t-e)+r-.75)}function Ti(t){return function(e){return Math.pow(e,t)}}function Mi(t){return 1-Math.cos(t*Oa)}function Li(t){return Math.pow(2,10*(t-1))}function Ai(t){return 1-Math.sqrt(1-t*t)}function Ni(t,e){var r;return arguments.length<2&&(e=.45),arguments.length?r=e/Ra*Math.asin(1/t):(t=1,r=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-r)*Ra/e)}}function Ci(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Ri(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Pi(t,e){t=ra.hcl(t),e=ra.hcl(e);var r=t.h,i=t.c,n=t.l,o=e.h-r,a=e.c-i,s=e.l-n;return isNaN(a)&&(a=0,i=isNaN(i)?e.c:i),isNaN(o)?(o=0,r=isNaN(r)?e.h:r):o>180?o-=360:-180>o&&(o+=360),function(t){return ct(r+o*t,i+a*t,n+s*t)+""}}function Oi(t,e){t=ra.hsl(t),e=ra.hsl(e);var r=t.h,i=t.s,n=t.l,o=e.h-r,a=e.s-i,s=e.l-n;return isNaN(a)&&(a=0,i=isNaN(i)?e.s:i),isNaN(o)?(o=0,r=isNaN(r)?e.h:r):o>180?o-=360:-180>o&&(o+=360),function(t){return lt(r+o*t,i+a*t,n+s*t)+""}}function Ii(t,e){t=ra.lab(t),e=ra.lab(e);var r=t.l,i=t.a,n=t.b,o=e.l-r,a=e.a-i,s=e.b-n;return function(t){return ft(r+o*t,i+a*t,n+s*t)+""}}function ki(t,e){return e-=t,function(r){return Math.round(t+e*r)}}function Di(t){var e=[t.a,t.b],r=[t.c,t.d],i=Fi(e),n=Vi(e,r),o=Fi(Gi(r,e,-n))||0;e[0]*r[1]<r[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,n*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-r[0],r[1]))*ka,this.translate=[t.e,t.f],this.scale=[i,o],this.skew=o?Math.atan2(n,o)*ka:0}function Vi(t,e){return t[0]*e[0]+t[1]*e[1]}function Fi(t){var e=Math.sqrt(Vi(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Gi(t,e,r){return t[0]+=r*e[0],t[1]+=r*e[1],t}function Bi(t,e){var r,i=[],n=[],o=ra.transform(t),a=ra.transform(e),s=o.translate,l=a.translate,u=o.rotate,c=a.rotate,h=o.skew,f=a.skew,d=o.scale,p=a.scale;return s[0]!=l[0]||s[1]!=l[1]?(i.push("translate(",null,",",null,")"),n.push({i:1,x:gi(s[0],l[0])},{i:3,x:gi(s[1],l[1])})):i.push(l[0]||l[1]?"translate("+l+")":""),u!=c?(u-c>180?c+=360:c-u>180&&(u+=360),n.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:gi(u,c)})):c&&i.push(i.pop()+"rotate("+c+")"),h!=f?n.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:gi(h,f)}):f&&i.push(i.pop()+"skewX("+f+")"),d[0]!=p[0]||d[1]!=p[1]?(r=i.push(i.pop()+"scale(",null,",",null,")"),n.push({i:r-4,x:gi(d[0],p[0])},{i:r-2,x:gi(d[1],p[1])})):(1!=p[0]||1!=p[1])&&i.push(i.pop()+"scale("+p+")"),r=n.length,function(t){for(var e,o=-1;++o<r;)i[(e=n[o]).i]=e.x(t);return i.join("")}}function Wi(t,e){return e=(e-=t=+t)||1/e,function(r){return(r-t)/e}}function Ui(t,e){return e=(e-=t=+t)||1/e,function(r){return Math.max(0,Math.min(1,(r-t)/e))}}function zi(t){for(var e=t.source,r=t.target,i=Ki(e,r),n=[e];e!==i;)e=e.parent,n.push(e);for(var o=n.length;r!==i;)n.splice(o,0,r),r=r.parent;return n}function ji(t){for(var e=[],r=t.parent;null!=r;)e.push(t),t=r,r=r.parent;return e.push(t),e}function Ki(t,e){if(t===e)return t;for(var r=ji(t),i=ji(e),n=r.pop(),o=i.pop(),a=null;n===o;)a=n,n=r.pop(),o=i.pop();return a}function qi(t){t.fixed|=2}function Zi(t){t.fixed&=-7}function Hi(t){t.fixed|=4,t.px=t.x,t.py=t.y}function $i(t){t.fixed&=-5}function Yi(t,e,r){var i=0,n=0;if(t.charge=0,!t.leaf)for(var o,a=t.nodes,s=a.length,l=-1;++l<s;)o=a[l],null!=o&&(Yi(o,e,r),t.charge+=o.charge,i+=o.charge*o.cx,n+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=e*r[t.point.index];t.charge+=t.pointCharge=u,i+=u*t.point.x,n+=u*t.point.y}t.cx=i/t.charge,t.cy=n/t.charge}function Xi(t,e){return ra.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=nn,t}function Ji(t,e){for(var r=[t];null!=(t=r.pop());)if(e(t),(n=t.children)&&(i=n.length))for(var i,n;--i>=0;)r.push(n[i])}function Qi(t,e){for(var r=[t],i=[];null!=(t=r.pop());)if(i.push(t),(o=t.children)&&(n=o.length))for(var n,o,a=-1;++a<n;)r.push(o[a]);for(;null!=(t=i.pop());)e(t)}function tn(t){return t.children}function en(t){return t.value}function rn(t,e){return e.value-t.value}function nn(t){return ra.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function on(t){return t.x}function an(t){return t.y}function sn(t,e,r){t.y0=e,t.y=r}function ln(t){return ra.range(t.length)}function un(t){for(var e=-1,r=t[0].length,i=[];++e<r;)i[e]=0;return i}function cn(t){for(var e,r=1,i=0,n=t[0][1],o=t.length;o>r;++r)(e=t[r][1])>n&&(i=r,n=e);return i}function hn(t){return t.reduce(fn,0)}function fn(t,e){return t+e[1]}function dn(t,e){return pn(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function pn(t,e){for(var r=-1,i=+t[0],n=(t[1]-i)/e,o=[];++r<=e;)o[r]=n*r+i;return o}function gn(t){return[ra.min(t),ra.max(t)]}function mn(t,e){return t.value-e.value}function yn(t,e){var r=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=r,r._pack_prev=e}function vn(t,e){t._pack_next=e,e._pack_prev=t}function bn(t,e){var r=e.x-t.x,i=e.y-t.y,n=t.r+e.r;return.999*n*n>r*r+i*i}function En(t){function e(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),f=Math.min(t.y-t.r,f),d=Math.max(t.y+t.r,d)}if((r=t.children)&&(u=r.length)){var r,i,n,o,a,s,l,u,c=1/0,h=-1/0,f=1/0,d=-1/0;if(r.forEach(wn),i=r[0],i.x=-i.r,i.y=0,e(i),u>1&&(n=r[1],n.x=n.r,n.y=0,e(n),u>2))for(o=r[2],Sn(i,n,o),e(o),yn(i,o),i._pack_prev=o,yn(o,n),n=i._pack_next,a=3;u>a;a++){Sn(i,n,o=r[a]);var p=0,g=1,m=1;for(s=n._pack_next;s!==n;s=s._pack_next,g++)if(bn(s,o)){p=1;break}if(1==p)for(l=i._pack_prev;l!==s._pack_prev&&!bn(l,o);l=l._pack_prev,m++);p?(m>g||g==m&&n.r<i.r?vn(i,n=s):vn(i=l,n),a--):(yn(i,o),n=o,e(o))}var y=(c+h)/2,v=(f+d)/2,b=0;for(a=0;u>a;a++)o=r[a],o.x-=y,o.y-=v,b=Math.max(b,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=b,r.forEach(_n)}}function wn(t){t._pack_next=t._pack_prev=t}function _n(t){delete t._pack_next,delete t._pack_prev}function xn(t,e,r,i){var n=t.children;if(t.x=e+=i*t.x,t.y=r+=i*t.y,t.r*=i,n)for(var o=-1,a=n.length;++o<a;)xn(n[o],e,r,i)}function Sn(t,e,r){var i=t.r+r.r,n=e.x-t.x,o=e.y-t.y;if(i&&(n||o)){var a=e.r+r.r,s=n*n+o*o;a*=a,i*=i;var l=.5+(i-a)/(2*s),u=Math.sqrt(Math.max(0,2*a*(i+s)-(i-=s)*i-a*a))/(2*s);r.x=t.x+l*n+u*o,r.y=t.y+l*o-u*n}else r.x=t.x+i,r.y=t.y}function Tn(t,e){return t.parent==e.parent?1:2}function Mn(t){var e=t.children;return e.length?e[0]:t.t}function Ln(t){var e,r=t.children;return(e=r.length)?r[e-1]:t.t}function An(t,e,r){var i=r/(e.i-t.i);e.c-=i,e.s+=r,t.c+=i,e.z+=r,e.m+=r}function Nn(t){for(var e,r=0,i=0,n=t.children,o=n.length;--o>=0;)e=n[o],e.z+=r,e.m+=r,r+=e.s+(i+=e.c)}function Cn(t,e,r){return t.a.parent===e.parent?t.a:r}function Rn(t){return 1+ra.max(t,function(t){return t.y})}function Pn(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function On(t){var e=t.children;return e&&e.length?On(e[0]):t}function In(t){var e,r=t.children;return r&&(e=r.length)?In(r[e-1]):t}function kn(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Dn(t,e){var r=t.x+e[3],i=t.y+e[0],n=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return 0>n&&(r+=n/2,n=0),0>o&&(i+=o/2,o=0),{x:r,y:i,dx:n,dy:o}}function Vn(t){var e=t[0],r=t[t.length-1];return r>e?[e,r]:[r,e]}function Fn(t){return t.rangeExtent?t.rangeExtent():Vn(t.range())}function Gn(t,e,r,i){var n=r(t[0],t[1]),o=i(e[0],e[1]);return function(t){return o(n(t))}}function Bn(t,e){var r,i=0,n=t.length-1,o=t[i],a=t[n];return o>a&&(r=i,i=n,n=r,r=o,o=a,a=r),t[i]=e.floor(o),t[n]=e.ceil(a),t}function Wn(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:ml}function Un(t,e,r,i){var n=[],o=[],a=0,s=Math.min(t.length,e.length)-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<=s;)n.push(r(t[a-1],t[a])),o.push(i(e[a-1],e[a]));return function(e){var r=ra.bisect(t,e,1,s)-1;return o[r](n[r](e))}}function zn(t,e,r,i){function n(){var n=Math.min(t.length,e.length)>2?Un:Gn,l=i?Ui:Wi;return a=n(t,e,l,r),s=n(e,t,l,yi),o}function o(t){return a(t)}var a,s;return o.invert=function(t){return s(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),n()):t},o.range=function(t){return arguments.length?(e=t,n()):e},o.rangeRound=function(t){return o.range(t).interpolate(ki)},o.clamp=function(t){return arguments.length?(i=t,n()):i},o.interpolate=function(t){return arguments.length?(r=t,n()):r},o.ticks=function(e){return Zn(t,e)},o.tickFormat=function(e,r){return Hn(t,e,r)},o.nice=function(e){return Kn(t,e),n()},o.copy=function(){return zn(t,e,r,i)},n()}function jn(t,e){return ra.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Kn(t,e){return Bn(t,Wn(qn(t,e)[2]))}function qn(t,e){null==e&&(e=10);var r=Vn(t),i=r[1]-r[0],n=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),o=e/i*n;return.15>=o?n*=10:.35>=o?n*=5:.75>=o&&(n*=2),r[0]=Math.ceil(r[0]/n)*n,r[1]=Math.floor(r[1]/n)*n+.5*n,r[2]=n,r}function Zn(t,e){return ra.range.apply(ra,qn(t,e))}function Hn(t,e,r){var i=qn(t,e);if(r){var n=ns.exec(r);if(n.shift(),"s"===n[8]){var o=ra.formatPrefix(Math.max(fa(i[0]),fa(i[1])));return n[7]||(n[7]="."+$n(o.scale(i[2]))),n[8]="f",r=ra.format(n.join("")),function(t){return r(o.scale(t))+o.symbol}}n[7]||(n[7]="."+Yn(n[8],i)),r=n.join("")}else r=",."+$n(i[2])+"f";return ra.format(r)}function $n(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Yn(t,e){var r=$n(e[2]);return t in yl?Math.abs(r-$n(Math.max(fa(e[0]),fa(e[1]))))+ +("e"!==t):r-2*("%"===t)}function Xn(t,e,r,i){function n(t){return(r?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function o(t){return r?Math.pow(e,t):-Math.pow(e,-t)}function a(e){return t(n(e))}return a.invert=function(e){return o(t.invert(e))},a.domain=function(e){return arguments.length?(r=e[0]>=0,t.domain((i=e.map(Number)).map(n)),a):i},a.base=function(r){return arguments.length?(e=+r,t.domain(i.map(n)),a):e},a.nice=function(){var e=Bn(i.map(n),r?Math:bl);return t.domain(e),i=e.map(o),a},a.ticks=function(){var t=Vn(i),a=[],s=t[0],l=t[1],u=Math.floor(n(s)),c=Math.ceil(n(l)),h=e%1?2:e;if(isFinite(c-u)){if(r){for(;c>u;u++)for(var f=1;h>f;f++)a.push(o(u)*f);a.push(o(u))}else for(a.push(o(u));u++<c;)for(var f=h-1;f>0;f--)a.push(o(u)*f);for(u=0;a[u]<s;u++);for(c=a.length;a[c-1]>l;c--);a=a.slice(u,c)}return a},a.tickFormat=function(t,e){if(!arguments.length)return vl;arguments.length<2?e=vl:"function"!=typeof e&&(e=ra.format(e));var i,s=Math.max(.1,t/a.ticks().length),l=r?(i=1e-12,Math.ceil):(i=-1e-12,Math.floor);return function(t){return t/o(l(n(t)+i))<=s?e(t):""}},a.copy=function(){return Xn(t.copy(),e,r,i)},jn(a,t)}function Jn(t,e,r){function i(e){return t(n(e))}var n=Qn(e),o=Qn(1/e);return i.invert=function(e){return o(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain((r=e.map(Number)).map(n)),i):r},i.ticks=function(t){return Zn(r,t)},i.tickFormat=function(t,e){return Hn(r,t,e)},i.nice=function(t){return i.domain(Kn(r,t))},i.exponent=function(a){return arguments.length?(n=Qn(e=a),o=Qn(1/e),t.domain(r.map(n)),i):e},i.copy=function(){return Jn(t.copy(),e,r)},jn(i,t)}function Qn(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function to(t,e){function r(r){return o[((n.get(r)||("range"===e.t?n.set(r,t.push(r)):NaN))-1)%o.length]}function i(e,r){return ra.range(t.length).map(function(t){return e+r*t})}var n,o,a;return r.domain=function(i){if(!arguments.length)return t;t=[],n=new u;for(var o,a=-1,s=i.length;++a<s;)n.has(o=i[a])||n.set(o,t.push(o));return r[e.t].apply(r,e.a)},r.range=function(t){return arguments.length?(o=t,a=0,e={t:"range",a:arguments},r):o},r.rangePoints=function(n,s){arguments.length<2&&(s=0);var l=n[0],u=n[1],c=t.length<2?(l=(l+u)/2,0):(u-l)/(t.length-1+s);return o=i(l+c*s/2,c),a=0,e={t:"rangePoints",a:arguments},r},r.rangeRoundPoints=function(n,s){arguments.length<2&&(s=0);var l=n[0],u=n[1],c=t.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(t.length-1+s)|0;return o=i(l+Math.round(c*s/2+(u-l-(t.length-1+s)*c)/2),c),a=0,e={t:"rangeRoundPoints",a:arguments},r},r.rangeBands=function(n,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=n[1]<n[0],c=n[u-0],h=n[1-u],f=(h-c)/(t.length-s+2*l);return o=i(c+f*l,f),u&&o.reverse(),a=f*(1-s),e={t:"rangeBands",a:arguments},r},r.rangeRoundBands=function(n,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=n[1]<n[0],c=n[u-0],h=n[1-u],f=Math.floor((h-c)/(t.length-s+2*l));return o=i(c+Math.round((h-c-(t.length-s)*f)/2),f),u&&o.reverse(),a=Math.round(f*(1-s)),e={t:"rangeRoundBands",a:arguments},r},r.rangeBand=function(){return a},r.rangeExtent=function(){return Vn(e.a[0])},r.copy=function(){return to(t,e)},r.domain(t)}function eo(t,e){function o(){var r=0,i=e.length;for(s=[];++r<i;)s[r-1]=ra.quantile(t,r/i);return a}function a(t){return isNaN(t=+t)?void 0:e[ra.bisect(s,t)]}var s;return a.domain=function(e){return arguments.length?(t=e.map(i).filter(n).sort(r),o()):t},a.range=function(t){return arguments.length?(e=t,o()):e},a.quantiles=function(){return s},a.invertExtent=function(r){return r=e.indexOf(r),0>r?[NaN,NaN]:[r>0?s[r-1]:t[0],r<s.length?s[r]:t[t.length-1]]},a.copy=function(){return eo(t,e)},o()}function ro(t,e,r){function i(e){return r[Math.max(0,Math.min(a,Math.floor(o*(e-t))))]}function n(){return o=r.length/(e-t),a=r.length-1,i}var o,a;return i.domain=function(r){return arguments.length?(t=+r[0],e=+r[r.length-1],n()):[t,e]},i.range=function(t){return arguments.length?(r=t,n()):r},i.invertExtent=function(e){return e=r.indexOf(e),e=0>e?NaN:e/o+t,[e,e+1/o]},i.copy=function(){return ro(t,e,r)},n()}function io(t,e){function r(r){return r>=r?e[ra.bisect(t,r)]:void 0}return r.domain=function(e){return arguments.length?(t=e,r):t},r.range=function(t){return arguments.length?(e=t,r):e},r.invertExtent=function(r){return r=e.indexOf(r),[t[r-1],t[r]]},r.copy=function(){return io(t,e)},r}function no(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(r){return arguments.length?(t=r.map(e),e):t},e.ticks=function(e){return Zn(t,e)},e.tickFormat=function(e,r){return Hn(t,e,r)},e.copy=function(){return no(t)},e}function oo(){return 0}function ao(t){return t.innerRadius}function so(t){return t.outerRadius}function lo(t){return t.startAngle}function uo(t){return t.endAngle}function co(t){return t&&t.padAngle}function ho(t,e,r,i){return(t-r)*e-(e-i)*t>0?0:1}function fo(t,e,r,i,n){var o=t[0]-e[0],a=t[1]-e[1],s=(n?i:-i)/Math.sqrt(o*o+a*a),l=s*a,u=-s*o,c=t[0]+l,h=t[1]+u,f=e[0]+l,d=e[1]+u,p=(c+f)/2,g=(h+d)/2,m=f-c,y=d-h,v=m*m+y*y,b=r-i,E=c*d-f*h,w=(0>y?-1:1)*Math.sqrt(b*b*v-E*E),_=(E*y-m*w)/v,x=(-E*m-y*w)/v,S=(E*y+m*w)/v,T=(-E*m+y*w)/v,M=_-p,L=x-g,A=S-p,N=T-g;return M*M+L*L>A*A+N*N&&(_=S,x=T),[[_-l,x-u],[_*r/b,x*r/b]]}function po(t){function e(e){function a(){u.push("M",o(t(c),s))}for(var l,u=[],c=[],h=-1,f=e.length,d=Mt(r),p=Mt(i);++h<f;)n.call(this,l=e[h],h)?c.push([+d.call(this,l,h),+p.call(this,l,h)]):c.length&&(a(),c=[]);return c.length&&a(),u.length?u.join(""):null}var r=Lr,i=Ar,n=Ae,o=go,a=o.key,s=.7;return e.x=function(t){return arguments.length?(r=t,e):r},e.y=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(n=t,e):n},e.interpolate=function(t){return arguments.length?(a="function"==typeof t?o=t:(o=Tl.get(t)||go).key,e):a},e.tension=function(t){return arguments.length?(s=t,e):s},e}function go(t){return t.join("L")}function mo(t){return go(t)+"Z"}function yo(t){for(var e=0,r=t.length,i=t[0],n=[i[0],",",i[1]];++e<r;)n.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return r>1&&n.push("H",i[0]),n.join("")}function vo(t){for(var e=0,r=t.length,i=t[0],n=[i[0],",",i[1]];++e<r;)n.push("V",(i=t[e])[1],"H",i[0]);return n.join("")}function bo(t){for(var e=0,r=t.length,i=t[0],n=[i[0],",",i[1]];++e<r;)n.push("H",(i=t[e])[0],"V",i[1]);return n.join("")}function Eo(t,e){return t.length<4?go(t):t[1]+xo(t.slice(1,-1),So(t,e))}function wo(t,e){return t.length<3?go(t):t[0]+xo((t.push(t[0]),t),So([t[t.length-2]].concat(t,[t[1]]),e))}function _o(t,e){return t.length<3?go(t):t[0]+xo(t,So(t,e))}function xo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return go(t);var r=t.length!=e.length,i="",n=t[0],o=t[1],a=e[0],s=a,l=1;if(r&&(i+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],n=t[1],l=2),e.length>1){s=e[1],o=t[l],l++,i+="C"+(n[0]+a[0])+","+(n[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var u=2;u<e.length;u++,l++)o=t[l],s=e[u],i+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(r){var c=t[l];i+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return i}function So(t,e){for(var r,i=[],n=(1-e)/2,o=t[0],a=t[1],s=1,l=t.length;++s<l;)r=o,o=a,a=t[s],i.push([n*(a[0]-r[0]),n*(a[1]-r[1])]);return i}function To(t){if(t.length<3)return go(t);var e=1,r=t.length,i=t[0],n=i[0],o=i[1],a=[n,n,n,(i=t[1])[0]],s=[o,o,o,i[1]],l=[n,",",o,"L",No(Al,a),",",No(Al,s)];for(t.push(t[r-1]);++e<=r;)i=t[e],a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),Co(l,a,s);return t.pop(),l.push("L",i),l.join("")}function Mo(t){if(t.length<4)return go(t);for(var e,r=[],i=-1,n=t.length,o=[0],a=[0];++i<3;)e=t[i],o.push(e[0]),a.push(e[1]);for(r.push(No(Al,o)+","+No(Al,a)),--i;++i<n;)e=t[i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Co(r,o,a);return r.join("")}function Lo(t){for(var e,r,i=-1,n=t.length,o=n+4,a=[],s=[];++i<4;)r=t[i%n],a.push(r[0]),s.push(r[1]);for(e=[No(Al,a),",",No(Al,s)],--i;++i<o;)r=t[i%n],a.shift(),a.push(r[0]),s.shift(),s.push(r[1]),Co(e,a,s);return e.join("")}function Ao(t,e){var r=t.length-1;if(r)for(var i,n,o=t[0][0],a=t[0][1],s=t[r][0]-o,l=t[r][1]-a,u=-1;++u<=r;)i=t[u],n=u/r,i[0]=e*i[0]+(1-e)*(o+n*s),i[1]=e*i[1]+(1-e)*(a+n*l);return To(t)}function No(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Co(t,e,r){t.push("C",No(Ml,e),",",No(Ml,r),",",No(Ll,e),",",No(Ll,r),",",No(Al,e),",",No(Al,r))}function Ro(t,e){return(e[1]-t[1])/(e[0]-t[0])}function Po(t){for(var e=0,r=t.length-1,i=[],n=t[0],o=t[1],a=i[0]=Ro(n,o);++e<r;)i[e]=(a+(a=Ro(n=o,o=t[e+1])))/2;return i[e]=a,i}function Oo(t){for(var e,r,i,n,o=[],a=Po(t),s=-1,l=t.length-1;++s<l;)e=Ro(t[s],t[s+1]),fa(e)<Aa?a[s]=a[s+1]=0:(r=a[s]/e,i=a[s+1]/e,n=r*r+i*i,n>9&&(n=3*e/Math.sqrt(n),a[s]=n*r,a[s+1]=n*i));for(s=-1;++s<=l;)n=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([n||0,a[s]*n||0]);return o}function Io(t){return t.length<3?go(t):t[0]+xo(t,Oo(t))}function ko(t){for(var e,r,i,n=-1,o=t.length;++n<o;)e=t[n],r=e[0],i=e[1]-Oa,e[0]=r*Math.cos(i),e[1]=r*Math.sin(i);return t}function Do(t){function e(e){function l(){g.push("M",s(t(y),h),c,u(t(m.reverse()),h),"Z")}for(var f,d,p,g=[],m=[],y=[],v=-1,b=e.length,E=Mt(r),w=Mt(n),_=r===i?function(){return d}:Mt(i),x=n===o?function(){return p}:Mt(o);++v<b;)a.call(this,f=e[v],v)?(m.push([d=+E.call(this,f,v),p=+w.call(this,f,v)]),y.push([+_.call(this,f,v),+x.call(this,f,v)])):m.length&&(l(),m=[],y=[]);return m.length&&l(),g.length?g.join(""):null}var r=Lr,i=Lr,n=0,o=Ar,a=Ae,s=go,l=s.key,u=s,c="L",h=.7;return e.x=function(t){return arguments.length?(r=i=t,e):i},e.x0=function(t){return arguments.length?(r=t,e):r},e.x1=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(n=o=t,e):o},e.y0=function(t){return arguments.length?(n=t,e):n},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(a=t,e):a},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?s=t:(s=Tl.get(t)||go).key,u=s.reverse||s,c=s.closed?"M":"L",e):l},e.tension=function(t){return arguments.length?(h=t,e):h},e}function Vo(t){return t.radius}function Fo(t){return[t.x,t.y]}function Go(t){return function(){var e=t.apply(this,arguments),r=e[0],i=e[1]-Oa;return[r*Math.cos(i),r*Math.sin(i)]}}function Bo(){return 64}function Wo(){return"circle"}function Uo(t){var e=Math.sqrt(t/Ca);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function zo(t){return function(){var e,r;(e=this[t])&&(r=e[e.active])&&(--e.count?delete e[e.active]:delete this[t],e.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function jo(t,e,r){return ya(t,kl),t.namespace=e,t.id=r,t}function Ko(t,e,r,i){var n=t.id,o=t.namespace;return z(t,"function"==typeof r?function(t,a,s){t[o][n].tween.set(e,i(r.call(t,t.__data__,a,s)))}:(r=i(r),function(t){t[o][n].tween.set(e,r)}))}function qo(t){return null==t&&(t=""),function(){this.textContent=t}}function Zo(t){return null==t?"__transition__":"__transition_"+t+"__"}function Ho(t,e,r,i,n){var o=t[r]||(t[r]={active:0,count:0}),a=o[i];if(!a){var s=n.time;a=o[i]={tween:new u,time:s,delay:n.delay,duration:n.duration,ease:n.ease,index:e},n=null,++o.count,ra.timer(function(n){function l(r){if(o.active>i)return c();var n=o[o.active];n&&(--o.count,delete o[o.active],n.event&&n.event.interrupt.call(t,t.__data__,n.index)),o.active=i,a.event&&a.event.start.call(t,t.__data__,e),a.tween.forEach(function(r,i){(i=i.call(t,t.__data__,e))&&g.push(i)}),f=a.ease,h=a.duration,ra.timer(function(){return p.c=u(r||1)?Ae:u,1},0,s)}function u(r){if(o.active!==i)return 1;for(var n=r/h,s=f(n),l=g.length;l>0;)g[--l].call(t,s);return n>=1?(a.event&&a.event.end.call(t,t.__data__,e),c()):void 0}function c(){return--o.count?delete o[i]:delete t[r],1}var h,f,d=a.delay,p=es,g=[];return p.t=d+s,n>=d?l(n-d):void(p.c=l)},0,s)}}function $o(t,e,r){t.attr("transform",function(t){var i=e(t);return"translate("+(isFinite(i)?i:r(t))+",0)"})}function Yo(t,e,r){t.attr("transform",function(t){var i=e(t);return"translate(0,"+(isFinite(i)?i:r(t))+")"})}function Xo(t){return t.toISOString()}function Jo(t,e,r){function i(e){return t(e)}function n(t,r){var i=t[1]-t[0],n=i/r,o=ra.bisect(jl,n);return o==jl.length?[e.year,qn(t.map(function(t){return t/31536e6}),r)[2]]:o?e[n/jl[o-1]<jl[o]/n?o-1:o]:[Zl,qn(t,r)[2]]}return i.invert=function(e){return Qo(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(Qo)},i.nice=function(t,e){function r(r){return!isNaN(r)&&!t.range(r,Qo(+r+1),e).length}var o=i.domain(),a=Vn(o),s=null==t?n(a,10):"number"==typeof t&&n(a,t);return s&&(t=s[0],e=s[1]),i.domain(Bn(o,e>1?{floor:function(e){for(;r(e=t.floor(e));)e=Qo(e-1);return e},ceil:function(e){for(;r(e=t.ceil(e));)e=Qo(+e+1);return e}}:t))},i.ticks=function(t,e){var r=Vn(i.domain()),o=null==t?n(r,10):"number"==typeof t?n(r,t):!t.range&&[{range:t},e];return o&&(t=o[0],e=o[1]),t.range(r[0],Qo(+r[1]+1),1>e?1:e)},i.tickFormat=function(){return r},i.copy=function(){return Jo(t.copy(),e,r)},jn(i,t)}function Qo(t){return new Date(t)}function ta(t){return JSON.parse(t.responseText)}function ea(t){var e=oa.createRange();return e.selectNode(oa.body),e.createContextualFragment(t.responseText)}var ra={version:"3.5.6"},ia=[].slice,na=function(t){return ia.call(t)},oa=this.document;if(oa)try{na(oa.documentElement.childNodes)[0].nodeType}catch(t){na=function(t){for(var e=t.length,r=new Array(e);e--;)r[e]=t[e];return r}}if(Date.now||(Date.now=function(){return+new Date}),oa)try{oa.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var aa=this.Element.prototype,sa=aa.setAttribute,la=aa.setAttributeNS,ua=this.CSSStyleDeclaration.prototype,ca=ua.setProperty;aa.setAttribute=function(t,e){sa.call(this,t,e+"")},aa.setAttributeNS=function(t,e,r){la.call(this,t,e,r+"");
},ua.setProperty=function(t,e,r){ca.call(this,t,e+"",r)}}ra.ascending=r,ra.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:NaN},ra.min=function(t,e){var r,i,n=-1,o=t.length;if(1===arguments.length){for(;++n<o;)if(null!=(i=t[n])&&i>=i){r=i;break}for(;++n<o;)null!=(i=t[n])&&r>i&&(r=i)}else{for(;++n<o;)if(null!=(i=e.call(t,t[n],n))&&i>=i){r=i;break}for(;++n<o;)null!=(i=e.call(t,t[n],n))&&r>i&&(r=i)}return r},ra.max=function(t,e){var r,i,n=-1,o=t.length;if(1===arguments.length){for(;++n<o;)if(null!=(i=t[n])&&i>=i){r=i;break}for(;++n<o;)null!=(i=t[n])&&i>r&&(r=i)}else{for(;++n<o;)if(null!=(i=e.call(t,t[n],n))&&i>=i){r=i;break}for(;++n<o;)null!=(i=e.call(t,t[n],n))&&i>r&&(r=i)}return r},ra.extent=function(t,e){var r,i,n,o=-1,a=t.length;if(1===arguments.length){for(;++o<a;)if(null!=(i=t[o])&&i>=i){r=n=i;break}for(;++o<a;)null!=(i=t[o])&&(r>i&&(r=i),i>n&&(n=i))}else{for(;++o<a;)if(null!=(i=e.call(t,t[o],o))&&i>=i){r=n=i;break}for(;++o<a;)null!=(i=e.call(t,t[o],o))&&(r>i&&(r=i),i>n&&(n=i))}return[r,n]},ra.sum=function(t,e){var r,i=0,o=t.length,a=-1;if(1===arguments.length)for(;++a<o;)n(r=+t[a])&&(i+=r);else for(;++a<o;)n(r=+e.call(t,t[a],a))&&(i+=r);return i},ra.mean=function(t,e){var r,o=0,a=t.length,s=-1,l=a;if(1===arguments.length)for(;++s<a;)n(r=i(t[s]))?o+=r:--l;else for(;++s<a;)n(r=i(e.call(t,t[s],s)))?o+=r:--l;return l?o/l:void 0},ra.quantile=function(t,e){var r=(t.length-1)*e+1,i=Math.floor(r),n=+t[i-1],o=r-i;return o?n+o*(t[i]-n):n},ra.median=function(t,e){var o,a=[],s=t.length,l=-1;if(1===arguments.length)for(;++l<s;)n(o=i(t[l]))&&a.push(o);else for(;++l<s;)n(o=i(e.call(t,t[l],l)))&&a.push(o);return a.length?ra.quantile(a.sort(r),.5):void 0},ra.variance=function(t,e){var r,o,a=t.length,s=0,l=0,u=-1,c=0;if(1===arguments.length)for(;++u<a;)n(r=i(t[u]))&&(o=r-s,s+=o/++c,l+=o*(r-s));else for(;++u<a;)n(r=i(e.call(t,t[u],u)))&&(o=r-s,s+=o/++c,l+=o*(r-s));return c>1?l/(c-1):void 0},ra.deviation=function(){var t=ra.variance.apply(this,arguments);return t?Math.sqrt(t):t};var ha=o(r);ra.bisectLeft=ha.left,ra.bisect=ra.bisectRight=ha.right,ra.bisector=function(t){return o(1===t.length?function(e,i){return r(t(e),i)}:t)},ra.shuffle=function(t,e,r){(o=arguments.length)<3&&(r=t.length,2>o&&(e=0));for(var i,n,o=r-e;o;)n=Math.random()*o--|0,i=t[o+e],t[o+e]=t[n+e],t[n+e]=i;return t},ra.permute=function(t,e){for(var r=e.length,i=new Array(r);r--;)i[r]=t[e[r]];return i},ra.pairs=function(t){for(var e,r=0,i=t.length-1,n=t[0],o=new Array(0>i?0:i);i>r;)o[r]=[e=n,n=t[++r]];return o},ra.zip=function(){if(!(i=arguments.length))return[];for(var t=-1,e=ra.min(arguments,a),r=new Array(e);++t<e;)for(var i,n=-1,o=r[t]=new Array(i);++n<i;)o[n]=arguments[n][t];return r},ra.transpose=function(t){return ra.zip.apply(ra,t)},ra.keys=function(t){var e=[];for(var r in t)e.push(r);return e},ra.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},ra.entries=function(t){var e=[];for(var r in t)e.push({key:r,value:t[r]});return e},ra.merge=function(t){for(var e,r,i,n=t.length,o=-1,a=0;++o<n;)a+=t[o].length;for(r=new Array(a);--n>=0;)for(i=t[n],e=i.length;--e>=0;)r[--a]=i[e];return r};var fa=Math.abs;ra.range=function(t,e,r){if(arguments.length<3&&(r=1,arguments.length<2&&(e=t,t=0)),(e-t)/r===1/0)throw new Error("infinite range");var i,n=[],o=s(fa(r)),a=-1;if(t*=o,e*=o,r*=o,0>r)for(;(i=t+r*++a)>e;)n.push(i/o);else for(;(i=t+r*++a)<e;)n.push(i/o);return n},ra.map=function(t,e){var r=new u;if(t instanceof u)t.forEach(function(t,e){r.set(t,e)});else if(Array.isArray(t)){var i,n=-1,o=t.length;if(1===arguments.length)for(;++n<o;)r.set(n,t[n]);else for(;++n<o;)r.set(e.call(t,i=t[n],n),i)}else for(var a in t)r.set(a,t[a]);return r};var da="__proto__",pa="\0";l(u,{has:f,get:function(t){return this._[c(t)]},set:function(t,e){return this._[c(t)]=e},remove:d,keys:p,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:h(e),value:this._[e]});return t},size:g,empty:m,forEach:function(t){for(var e in this._)t.call(this,h(e),this._[e])}}),ra.nest=function(){function t(e,a,s){if(s>=o.length)return i?i.call(n,a):r?a.sort(r):a;for(var l,c,h,f,d=-1,p=a.length,g=o[s++],m=new u;++d<p;)(f=m.get(l=g(c=a[d])))?f.push(c):m.set(l,[c]);return e?(c=e(),h=function(r,i){c.set(r,t(e,i,s))}):(c={},h=function(r,i){c[r]=t(e,i,s)}),m.forEach(h),c}function e(t,r){if(r>=o.length)return t;var i=[],n=a[r++];return t.forEach(function(t,n){i.push({key:t,values:e(n,r)})}),n?i.sort(function(t,e){return n(t.key,e.key)}):i}var r,i,n={},o=[],a=[];return n.map=function(e,r){return t(r,e,0)},n.entries=function(r){return e(t(ra.map,r,0),0)},n.key=function(t){return o.push(t),n},n.sortKeys=function(t){return a[o.length-1]=t,n},n.sortValues=function(t){return r=t,n},n.rollup=function(t){return i=t,n},n},ra.set=function(t){var e=new y;if(t)for(var r=0,i=t.length;i>r;++r)e.add(t[r]);return e},l(y,{has:f,add:function(t){return this._[c(t+="")]=!0,t},remove:d,values:p,size:g,empty:m,forEach:function(t){for(var e in this._)t.call(this,h(e))}}),ra.behavior={},ra.rebind=function(t,e){for(var r,i=1,n=arguments.length;++i<n;)t[r=arguments[i]]=b(t,e,e[r]);return t};var ga=["webkit","ms","moz","Moz","o","O"];ra.dispatch=function(){for(var t=new _,e=-1,r=arguments.length;++e<r;)t[arguments[e]]=x(t);return t},_.prototype.on=function(t,e){var r=t.indexOf("."),i="";if(r>=0&&(i=t.slice(r+1),t=t.slice(0,r)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},ra.event=null,ra.requote=function(t){return t.replace(ma,"\\$&")};var ma=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ya={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var r in e)t[r]=e[r]},va=function(t,e){return e.querySelector(t)},ba=function(t,e){return e.querySelectorAll(t)},Ea=function(t,e){var r=t.matches||t[E(t,"matchesSelector")];return(Ea=function(t,e){return r.call(t,e)})(t,e)};"function"==typeof Sizzle&&(va=function(t,e){return Sizzle(t,e)[0]||null},ba=Sizzle,Ea=Sizzle.matchesSelector),ra.selection=function(){return ra.select(oa.documentElement)};var wa=ra.selection.prototype=[];wa.select=function(t){var e,r,i,n,o=[];t=A(t);for(var a=-1,s=this.length;++a<s;){o.push(e=[]),e.parentNode=(i=this[a]).parentNode;for(var l=-1,u=i.length;++l<u;)(n=i[l])?(e.push(r=t.call(n,n.__data__,l,a)),r&&"__data__"in n&&(r.__data__=n.__data__)):e.push(null)}return L(o)},wa.selectAll=function(t){var e,r,i=[];t=N(t);for(var n=-1,o=this.length;++n<o;)for(var a=this[n],s=-1,l=a.length;++s<l;)(r=a[s])&&(i.push(e=na(t.call(r,r.__data__,s,n))),e.parentNode=r);return L(i)};var _a={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};ra.ns={prefix:_a,qualify:function(t){var e=t.indexOf(":"),r=t;return e>=0&&(r=t.slice(0,e),t=t.slice(e+1)),_a.hasOwnProperty(r)?{space:_a[r],local:t}:t}},wa.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var r=this.node();return t=ra.ns.qualify(t),t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}for(e in t)this.each(C(e,t[e]));return this}return this.each(C(t,e))},wa.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var r=this.node(),i=(t=O(t)).length,n=-1;if(e=r.classList){for(;++n<i;)if(!e.contains(t[n]))return!1}else for(e=r.getAttribute("class");++n<i;)if(!P(t[n]).test(e))return!1;return!0}for(e in t)this.each(I(e,t[e]));return this}return this.each(I(t,e))},wa.style=function(t,r,i){var n=arguments.length;if(3>n){if("string"!=typeof t){2>n&&(r="");for(i in t)this.each(D(i,t[i],r));return this}if(2>n){var o=this.node();return e(o).getComputedStyle(o,null).getPropertyValue(t)}i=""}return this.each(D(t,r,i))},wa.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(V(e,t[e]));return this}return this.each(V(t,e))},wa.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},wa.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},wa.append=function(t){return t=F(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},wa.insert=function(t,e){return t=F(t),e=A(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},wa.remove=function(){return this.each(G)},wa.data=function(t,e){function r(t,r){var i,n,o,a=t.length,h=r.length,f=Math.min(a,h),d=new Array(h),p=new Array(h),g=new Array(a);if(e){var m,y=new u,v=new Array(a);for(i=-1;++i<a;)y.has(m=e.call(n=t[i],n.__data__,i))?g[i]=n:y.set(m,n),v[i]=m;for(i=-1;++i<h;)(n=y.get(m=e.call(r,o=r[i],i)))?n!==!0&&(d[i]=n,n.__data__=o):p[i]=B(o),y.set(m,!0);for(i=-1;++i<a;)y.get(v[i])!==!0&&(g[i]=t[i])}else{for(i=-1;++i<f;)n=t[i],o=r[i],n?(n.__data__=o,d[i]=n):p[i]=B(o);for(;h>i;++i)p[i]=B(r[i]);for(;a>i;++i)g[i]=t[i]}p.update=d,p.parentNode=d.parentNode=g.parentNode=t.parentNode,s.push(p),l.push(d),c.push(g)}var i,n,o=-1,a=this.length;if(!arguments.length){for(t=new Array(a=(i=this[0]).length);++o<a;)(n=i[o])&&(t[o]=n.__data__);return t}var s=j([]),l=L([]),c=L([]);if("function"==typeof t)for(;++o<a;)r(i=this[o],t.call(i,i.parentNode.__data__,o));else for(;++o<a;)r(i=this[o],t);return l.enter=function(){return s},l.exit=function(){return c},l},wa.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},wa.filter=function(t){var e,r,i,n=[];"function"!=typeof t&&(t=W(t));for(var o=0,a=this.length;a>o;o++){n.push(e=[]),e.parentNode=(r=this[o]).parentNode;for(var s=0,l=r.length;l>s;s++)(i=r[s])&&t.call(i,i.__data__,s,o)&&e.push(i)}return L(n)},wa.order=function(){for(var t=-1,e=this.length;++t<e;)for(var r,i=this[t],n=i.length-1,o=i[n];--n>=0;)(r=i[n])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},wa.sort=function(t){t=U.apply(this,arguments);for(var e=-1,r=this.length;++e<r;)this[e].sort(t);return this.order()},wa.each=function(t){return z(this,function(e,r,i){t.call(e,e.__data__,r,i)})},wa.call=function(t){var e=na(arguments);return t.apply(e[0]=this,e),this},wa.empty=function(){return!this.node()},wa.node=function(){for(var t=0,e=this.length;e>t;t++)for(var r=this[t],i=0,n=r.length;n>i;i++){var o=r[i];if(o)return o}return null},wa.size=function(){var t=0;return z(this,function(){++t}),t};var xa=[];ra.selection.enter=j,ra.selection.enter.prototype=xa,xa.append=wa.append,xa.empty=wa.empty,xa.node=wa.node,xa.call=wa.call,xa.size=wa.size,xa.select=function(t){for(var e,r,i,n,o,a=[],s=-1,l=this.length;++s<l;){i=(n=this[s]).update,a.push(e=[]),e.parentNode=n.parentNode;for(var u=-1,c=n.length;++u<c;)(o=n[u])?(e.push(i[u]=r=t.call(n.parentNode,o.__data__,u,s)),r.__data__=o.__data__):e.push(null)}return L(a)},xa.insert=function(t,e){return arguments.length<2&&(e=K(this)),wa.insert.call(this,t,e)},ra.select=function(e){var r;return"string"==typeof e?(r=[va(e,oa)],r.parentNode=oa.documentElement):(r=[e],r.parentNode=t(e)),L([r])},ra.selectAll=function(t){var e;return"string"==typeof t?(e=na(ba(t,oa)),e.parentNode=oa.documentElement):(e=t,e.parentNode=null),L([e])},wa.on=function(t,e,r){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e=!1);for(r in t)this.each(q(r,t[r],e));return this}if(2>i)return(i=this.node()["__on"+t])&&i._;r=!1}return this.each(q(t,e,r))};var Sa=ra.map({mouseenter:"mouseover",mouseleave:"mouseout"});oa&&Sa.forEach(function(t){"on"+t in oa&&Sa.remove(t)});var Ta,Ma=0;ra.mouse=function(t){return Y(t,T())};var La=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;ra.touch=function(t,e,r){if(arguments.length<3&&(r=e,e=T().changedTouches),e)for(var i,n=0,o=e.length;o>n;++n)if((i=e[n]).identifier===r)return Y(t,i)},ra.behavior.drag=function(){function t(){this.on("mousedown.drag",o).on("touchstart.drag",a)}function r(t,e,r,o,a){return function(){function s(){var t,r,i=e(f,g);i&&(t=i[0]-b[0],r=i[1]-b[1],p|=t|r,b=i,d({type:"drag",x:i[0]+u[0],y:i[1]+u[1],dx:t,dy:r}))}function l(){e(f,g)&&(y.on(o+m,null).on(a+m,null),v(p&&ra.event.target===h),d({type:"dragend"}))}var u,c=this,h=ra.event.target,f=c.parentNode,d=i.of(c,arguments),p=0,g=t(),m=".drag"+(null==g?"":"-"+g),y=ra.select(r(h)).on(o+m,s).on(a+m,l),v=$(h),b=e(f,g);n?(u=n.apply(c,arguments),u=[u.x-b[0],u.y-b[1]]):u=[0,0],d({type:"dragstart"})}}var i=M(t,"drag","dragstart","dragend"),n=null,o=r(w,ra.mouse,e,"mousemove","mouseup"),a=r(X,ra.touch,v,"touchmove","touchend");return t.origin=function(e){return arguments.length?(n=e,t):n},ra.rebind(t,i,"on")},ra.touches=function(t,e){return arguments.length<2&&(e=T().touches),e?na(e).map(function(e){var r=Y(t,e);return r.identifier=e.identifier,r}):[]};var Aa=1e-6,Na=Aa*Aa,Ca=Math.PI,Ra=2*Ca,Pa=Ra-Aa,Oa=Ca/2,Ia=Ca/180,ka=180/Ca,Da=Math.SQRT2,Va=2,Fa=4;ra.interpolateZoom=function(t,e){function r(t){var e=t*v;if(y){var r=it(g),a=o/(Va*f)*(r*nt(Da*e+g)-rt(g));return[i+a*u,n+a*c,o*r/it(Da*e+g)]}return[i+t*u,n+t*c,o*Math.exp(Da*e)]}var i=t[0],n=t[1],o=t[2],a=e[0],s=e[1],l=e[2],u=a-i,c=s-n,h=u*u+c*c,f=Math.sqrt(h),d=(l*l-o*o+Fa*h)/(2*o*Va*f),p=(l*l-o*o-Fa*h)/(2*l*Va*f),g=Math.log(Math.sqrt(d*d+1)-d),m=Math.log(Math.sqrt(p*p+1)-p),y=m-g,v=(y||Math.log(l/o))/Da;return r.duration=1e3*v,r},ra.behavior.zoom=function(){function t(t){t.on(R,h).on(Ba+".zoom",d).on("dblclick.zoom",p).on(I,f)}function r(t){return[(t[0]-T.x)/T.k,(t[1]-T.y)/T.k]}function i(t){return[t[0]*T.k+T.x,t[1]*T.k+T.y]}function n(t){T.k=Math.max(A[0],Math.min(A[1],t))}function o(t,e){e=i(e),T.x+=t[0]-e[0],T.y+=t[1]-e[1]}function a(e,r,i,a){e.__chart__={x:T.x,y:T.y,k:T.k},n(Math.pow(2,a)),o(m=r,i),e=ra.select(e),N>0&&(e=e.transition().duration(N)),e.call(t.event)}function s(){w&&w.domain(E.range().map(function(t){return(t-T.x)/T.k}).map(E.invert)),x&&x.domain(_.range().map(function(t){return(t-T.y)/T.k}).map(_.invert))}function l(t){C++||t({type:"zoomstart"})}function u(t){s(),t({type:"zoom",scale:T.k,translate:[T.x,T.y]})}function c(t){--C||(t({type:"zoomend"}),m=null)}function h(){function t(){h=1,o(ra.mouse(n),d),u(s)}function i(){f.on(P,null).on(O,null),p(h&&ra.event.target===a),c(s)}var n=this,a=ra.event.target,s=k.of(n,arguments),h=0,f=ra.select(e(n)).on(P,t).on(O,i),d=r(ra.mouse(n)),p=$(n);Il.call(n),l(s)}function f(){function t(){var t=ra.touches(p);return d=T.k,t.forEach(function(t){t.identifier in m&&(m[t.identifier]=r(t))}),t}function e(){var e=ra.event.target;ra.select(e).on(E,i).on(w,s),_.push(e);for(var r=ra.event.changedTouches,n=0,o=r.length;o>n;++n)m[r[n].identifier]=null;var l=t(),u=Date.now();if(1===l.length){if(500>u-b){var c=l[0];a(p,c,m[c.identifier],Math.floor(Math.log(T.k)/Math.LN2)+1),S()}b=u}else if(l.length>1){var c=l[0],h=l[1],f=c[0]-h[0],d=c[1]-h[1];y=f*f+d*d}}function i(){var t,e,r,i,a=ra.touches(p);Il.call(p);for(var s=0,l=a.length;l>s;++s,i=null)if(r=a[s],i=m[r.identifier]){if(e)break;t=r,e=i}if(i){var c=(c=r[0]-t[0])*c+(c=r[1]-t[1])*c,h=y&&Math.sqrt(c/y);t=[(t[0]+r[0])/2,(t[1]+r[1])/2],e=[(e[0]+i[0])/2,(e[1]+i[1])/2],n(h*d)}b=null,o(t,e),u(g)}function s(){if(ra.event.touches.length){for(var e=ra.event.changedTouches,r=0,i=e.length;i>r;++r)delete m[e[r].identifier];for(var n in m)return void t()}ra.selectAll(_).on(v,null),x.on(R,h).on(I,f),M(),c(g)}var d,p=this,g=k.of(p,arguments),m={},y=0,v=".zoom-"+ra.event.changedTouches[0].identifier,E="touchmove"+v,w="touchend"+v,_=[],x=ra.select(p),M=$(p);e(),l(g),x.on(R,null).on(I,e)}function d(){var t=k.of(this,arguments);v?clearTimeout(v):(Il.call(this),g=r(m=y||ra.mouse(this)),l(t)),v=setTimeout(function(){v=null,c(t)},50),S(),n(Math.pow(2,.002*Ga())*T.k),o(m,g),u(t)}function p(){var t=ra.mouse(this),e=Math.log(T.k)/Math.LN2;a(this,t,r(t),ra.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}var g,m,y,v,b,E,w,_,x,T={x:0,y:0,k:1},L=[960,500],A=Wa,N=250,C=0,R="mousedown.zoom",P="mousemove.zoom",O="mouseup.zoom",I="touchstart.zoom",k=M(t,"zoomstart","zoom","zoomend");return Ba||(Ba="onwheel"in oa?(Ga=function(){return-ra.event.deltaY*(ra.event.deltaMode?120:1)},"wheel"):"onmousewheel"in oa?(Ga=function(){return ra.event.wheelDelta},"mousewheel"):(Ga=function(){return-ra.event.detail},"MozMousePixelScroll")),t.event=function(t){t.each(function(){var t=k.of(this,arguments),e=T;Pl?ra.select(this).transition().each("start.zoom",function(){T=this.__chart__||{x:0,y:0,k:1},l(t)}).tween("zoom:zoom",function(){var r=L[0],i=L[1],n=m?m[0]:r/2,o=m?m[1]:i/2,a=ra.interpolateZoom([(n-T.x)/T.k,(o-T.y)/T.k,r/T.k],[(n-e.x)/e.k,(o-e.y)/e.k,r/e.k]);return function(e){var i=a(e),s=r/i[2];this.__chart__=T={x:n-i[0]*s,y:o-i[1]*s,k:s},u(t)}}).each("interrupt.zoom",function(){c(t)}).each("end.zoom",function(){c(t)}):(this.__chart__=T,l(t),u(t),c(t))})},t.translate=function(e){return arguments.length?(T={x:+e[0],y:+e[1],k:T.k},s(),t):[T.x,T.y]},t.scale=function(e){return arguments.length?(T={x:T.x,y:T.y,k:+e},s(),t):T.k},t.scaleExtent=function(e){return arguments.length?(A=null==e?Wa:[+e[0],+e[1]],t):A},t.center=function(e){return arguments.length?(y=e&&[+e[0],+e[1]],t):y},t.size=function(e){return arguments.length?(L=e&&[+e[0],+e[1]],t):L},t.duration=function(e){return arguments.length?(N=+e,t):N},t.x=function(e){return arguments.length?(w=e,E=e.copy(),T={x:0,y:0,k:1},t):w},t.y=function(e){return arguments.length?(x=e,_=e.copy(),T={x:0,y:0,k:1},t):x},ra.rebind(t,k,"on")};var Ga,Ba,Wa=[0,1/0];ra.color=at,at.prototype.toString=function(){return this.rgb()+""},ra.hsl=st;var Ua=st.prototype=new at;Ua.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,this.l/t)},Ua.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,t*this.l)},Ua.rgb=function(){return lt(this.h,this.s,this.l)},ra.hcl=ut;var za=ut.prototype=new at;za.brighter=function(t){return new ut(this.h,this.c,Math.min(100,this.l+ja*(arguments.length?t:1)))},za.darker=function(t){return new ut(this.h,this.c,Math.max(0,this.l-ja*(arguments.length?t:1)))},za.rgb=function(){return ct(this.h,this.c,this.l).rgb()},ra.lab=ht;var ja=18,Ka=.95047,qa=1,Za=1.08883,Ha=ht.prototype=new at;Ha.brighter=function(t){return new ht(Math.min(100,this.l+ja*(arguments.length?t:1)),this.a,this.b)},Ha.darker=function(t){return new ht(Math.max(0,this.l-ja*(arguments.length?t:1)),this.a,this.b)},Ha.rgb=function(){return ft(this.l,this.a,this.b)},ra.rgb=yt;var $a=yt.prototype=new at;$a.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,r=this.g,i=this.b,n=30;return e||r||i?(e&&n>e&&(e=n),r&&n>r&&(r=n),i&&n>i&&(i=n),new yt(Math.min(255,e/t),Math.min(255,r/t),Math.min(255,i/t))):new yt(n,n,n)},$a.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new yt(t*this.r,t*this.g,t*this.b)},$a.hsl=function(){return _t(this.r,this.g,this.b)},$a.toString=function(){return"#"+Et(this.r)+Et(this.g)+Et(this.b)};var Ya=ra.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ya.forEach(function(t,e){Ya.set(t,vt(e))}),ra.functor=Mt,ra.xhr=Lt(v),ra.dsv=function(t,e){function r(t,r,o){arguments.length<3&&(o=r,r=null);var a=At(t,e,null==r?i:n(r),o);return a.row=function(t){return arguments.length?a.response(null==(r=t)?i:n(t)):r},a}function i(t){return r.parse(t.responseText)}function n(t){return function(e){return r.parse(e.responseText,t)}}function o(e){return e.map(a).join(t)}function a(t){return s.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var s=new RegExp('["'+t+"\n]"),l=t.charCodeAt(0);return r.parse=function(t,e){var i;return r.parseRows(t,function(t,r){if(i)return i(t,r-1);var n=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");i=e?function(t,r){return e(n(t),r)}:n})},r.parseRows=function(t,e){function r(){if(c>=u)return a;if(n)return n=!1,o;var e=c;if(34===t.charCodeAt(e)){for(var r=e;r++<u;)if(34===t.charCodeAt(r)){if(34!==t.charCodeAt(r+1))break;++r}c=r+2;var i=t.charCodeAt(r+1);return 13===i?(n=!0,10===t.charCodeAt(r+2)&&++c):10===i&&(n=!0),t.slice(e+1,r).replace(/""/g,'"')}for(;u>c;){var i=t.charCodeAt(c++),s=1;if(10===i)n=!0;else if(13===i)n=!0,10===t.charCodeAt(c)&&(++c,++s);else if(i!==l)continue;return t.slice(e,c-s)}return t.slice(e)}for(var i,n,o={},a={},s=[],u=t.length,c=0,h=0;(i=r())!==a;){for(var f=[];i!==o&&i!==a;)f.push(i),i=r();e&&null==(f=e(f,h++))||s.push(f)}return s},r.format=function(e){if(Array.isArray(e[0]))return r.formatRows(e);var i=new y,n=[];return e.forEach(function(t){for(var e in t)i.has(e)||n.push(i.add(e))}),[n.map(a).join(t)].concat(e.map(function(e){return n.map(function(t){return a(e[t])}).join(t)})).join("\n")},r.formatRows=function(t){return t.map(o).join("\n")},r},ra.csv=ra.dsv(",","text/csv"),ra.tsv=ra.dsv("\t","text/tab-separated-values");var Xa,Ja,Qa,ts,es,rs=this[E(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};ra.timer=function(t,e,r){var i=arguments.length;2>i&&(e=0),3>i&&(r=Date.now());var n=r+e,o={c:t,t:n,f:!1,n:null};Ja?Ja.n=o:Xa=o,Ja=o,Qa||(ts=clearTimeout(ts),Qa=1,rs(Rt))},ra.timer.flush=function(){Pt(),Ot()},ra.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var is=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(kt);ra.formatPrefix=function(t,e){var r=0;return t&&(0>t&&(t*=-1),e&&(t=ra.round(t,It(t,e))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((r-1)/3)))),is[8+r/3]};var ns=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,os=ra.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=ra.round(t,It(t,e))).toFixed(Math.max(0,Math.min(20,It(t*(1+1e-15),e))))}}),as=ra.time={},ss=Date;Ft.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ls.setUTCDate.apply(this._,arguments)},setDay:function(){ls.setUTCDay.apply(this._,arguments)},setFullYear:function(){ls.setUTCFullYear.apply(this._,arguments)},setHours:function(){ls.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ls.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ls.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ls.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ls.setUTCSeconds.apply(this._,arguments)},setTime:function(){ls.setTime.apply(this._,arguments)}};var ls=Date.prototype;as.year=Gt(function(t){return t=as.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),as.years=as.year.range,as.years.utc=as.year.utc.range,as.day=Gt(function(t){var e=new ss(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),as.days=as.day.range,as.days.utc=as.day.utc.range,as.dayOfYear=function(t){var e=as.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var r=as[t]=Gt(function(t){return(t=as.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var r=as.year(t).getDay();return Math.floor((as.dayOfYear(t)+(r+e)%7)/7)-(r!==e)});as[t+"s"]=r.range,as[t+"s"].utc=r.utc.range,as[t+"OfYear"]=function(t){var r=as.year(t).getDay();return Math.floor((as.dayOfYear(t)+(r+e)%7)/7)}}),as.week=as.sunday,as.weeks=as.sunday.range,as.weeks.utc=as.sunday.utc.range,as.weekOfYear=as.sundayOfYear;var us={"-":"",_:" ",0:"0"},cs=/^\s*\d+/,hs=/^%/;ra.locale=function(t){return{numberFormat:Dt(t),timeFormat:Wt(t)}};var fs=ra.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});ra.format=fs.numberFormat,ra.geo={},le.prototype={s:0,t:0,add:function(t){ue(t,this.t,ds),ue(ds.s,this.s,this),this.s?this.t+=ds.t:this.s=ds.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ds=new le;ra.geo.stream=function(t,e){t&&ps.hasOwnProperty(t.type)?ps[t.type](t,e):ce(t,e)};var ps={Feature:function(t,e){ce(t.geometry,e)},FeatureCollection:function(t,e){for(var r=t.features,i=-1,n=r.length;++i<n;)ce(r[i].geometry,e)}},gs={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var r=t.coordinates,i=-1,n=r.length;++i<n;)t=r[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){he(t.coordinates,e,0)},MultiLineString:function(t,e){for(var r=t.coordinates,i=-1,n=r.length;++i<n;)he(r[i],e,0)},Polygon:function(t,e){fe(t.coordinates,e)},MultiPolygon:function(t,e){for(var r=t.coordinates,i=-1,n=r.length;++i<n;)fe(r[i],e)},GeometryCollection:function(t,e){for(var r=t.geometries,i=-1,n=r.length;++i<n;)ce(r[i],e)}};ra.geo.area=function(t){return ms=0,ra.geo.stream(t,vs),ms};var ms,ys=new le,vs={sphere:function(){ms+=4*Ca},point:w,lineStart:w,lineEnd:w,polygonStart:function(){ys.reset(),vs.lineStart=de},polygonEnd:function(){var t=2*ys;ms+=0>t?4*Ca+t:t,vs.lineStart=vs.lineEnd=vs.point=w}};ra.geo.bounds=function(){function t(t,e){b.push(E=[c=t,f=t]),h>e&&(h=e),e>d&&(d=e)}function e(e,r){var i=pe([e*Ia,r*Ia]);if(y){var n=me(y,i),o=[n[1],-n[0],0],a=me(o,n);be(a),a=Ee(a);var l=e-p,u=l>0?1:-1,g=a[0]*ka*u,m=fa(l)>180;if(m^(g>u*p&&u*e>g)){var v=a[1]*ka;v>d&&(d=v)}else if(g=(g+360)%360-180,m^(g>u*p&&u*e>g)){var v=-a[1]*ka;h>v&&(h=v)}else h>r&&(h=r),r>d&&(d=r);m?p>e?s(c,e)>s(c,f)&&(f=e):s(e,f)>s(c,f)&&(c=e):f>=c?(c>e&&(c=e),e>f&&(f=e)):e>p?s(c,e)>s(c,f)&&(f=e):s(e,f)>s(c,f)&&(c=e)}else t(e,r);y=i,p=e}function r(){w.point=e}function i(){E[0]=c,E[1]=f,w.point=t,y=null}function n(t,r){if(y){var i=t-p;v+=fa(i)>180?i+(i>0?360:-360):i}else g=t,m=r;vs.point(t,r),e(t,r)}function o(){vs.lineStart()}function a(){n(g,m),vs.lineEnd(),fa(v)>Aa&&(c=-(f=180)),E[0]=c,E[1]=f,y=null}function s(t,e){return(e-=t)<0?e+360:e}function l(t,e){return t[0]-e[0]}function u(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,h,f,d,p,g,m,y,v,b,E,w={point:t,lineStart:r,lineEnd:i,polygonStart:function(){w.point=n,w.lineStart=o,w.lineEnd=a,v=0,vs.polygonStart()},polygonEnd:function(){vs.polygonEnd(),w.point=t,w.lineStart=r,w.lineEnd=i,0>ys?(c=-(f=180),h=-(d=90)):v>Aa?d=90:-Aa>v&&(h=-90),E[0]=c,E[1]=f}};return function(t){d=f=-(c=h=1/0),b=[],ra.geo.stream(t,w);var e=b.length;if(e){b.sort(l);for(var r,i=1,n=b[0],o=[n];e>i;++i)r=b[i],u(r[0],n)||u(r[1],n)?(s(n[0],r[1])>s(n[0],n[1])&&(n[1]=r[1]),s(r[0],n[1])>s(n[0],n[1])&&(n[0]=r[0])):o.push(n=r);for(var a,r,p=-1/0,e=o.length-1,i=0,n=o[e];e>=i;n=r,++i)r=o[i],(a=s(n[1],r[0]))>p&&(p=a,c=r[0],f=n[1])}return b=E=null,1/0===c||1/0===h?[[NaN,NaN],[NaN,NaN]]:[[c,h],[f,d]]}}(),ra.geo.centroid=function(t){bs=Es=ws=_s=xs=Ss=Ts=Ms=Ls=As=Ns=0,ra.geo.stream(t,Cs);var e=Ls,r=As,i=Ns,n=e*e+r*r+i*i;return Na>n&&(e=Ss,r=Ts,i=Ms,Aa>Es&&(e=ws,r=_s,i=xs),n=e*e+r*r+i*i,Na>n)?[NaN,NaN]:[Math.atan2(r,e)*ka,et(i/Math.sqrt(n))*ka]};var bs,Es,ws,_s,xs,Ss,Ts,Ms,Ls,As,Ns,Cs={sphere:w,point:_e,lineStart:Se,lineEnd:Te,polygonStart:function(){Cs.lineStart=Me},polygonEnd:function(){Cs.lineStart=Se}},Rs=Pe(Ae,De,Fe,[-Ca,-Ca/2]),Ps=1e9;ra.geo.clipExtent=function(){var t,e,r,i,n,o,a={stream:function(t){return n&&(n.valid=!1),n=o(t),n.valid=!0,n},extent:function(s){return arguments.length?(o=Ue(t=+s[0][0],e=+s[0][1],r=+s[1][0],i=+s[1][1]),n&&(n.valid=!1,n=null),a):[[t,e],[r,i]]}};return a.extent([[0,0],[960,500]])},(ra.geo.conicEqualArea=function(){return ze(je)}).raw=je,ra.geo.albers=function(){return ra.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},ra.geo.albersUsa=function(){function t(t){var o=t[0],a=t[1];return e=null,r(o,a),e||(i(o,a),e)||n(o,a),e}var e,r,i,n,o=ra.geo.albers(),a=ra.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=ra.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,r){e=[t,r]}};return t.invert=function(t){var e=o.scale(),r=o.translate(),i=(t[0]-r[0])/e,n=(t[1]-r[1])/e;return(n>=.12&&.234>n&&i>=-.425&&-.214>i?a:n>=.166&&.234>n&&i>=-.214&&-.115>i?s:o).invert(t);
},t.stream=function(t){var e=o.stream(t),r=a.stream(t),i=s.stream(t);return{point:function(t,n){e.point(t,n),r.point(t,n),i.point(t,n)},sphere:function(){e.sphere(),r.sphere(),i.sphere()},lineStart:function(){e.lineStart(),r.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),r.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),r.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),r.polygonEnd(),i.polygonEnd()}}},t.precision=function(e){return arguments.length?(o.precision(e),a.precision(e),s.precision(e),t):o.precision()},t.scale=function(e){return arguments.length?(o.scale(e),a.scale(.35*e),s.scale(e),t.translate(o.translate())):o.scale()},t.translate=function(e){if(!arguments.length)return o.translate();var u=o.scale(),c=+e[0],h=+e[1];return r=o.translate(e).clipExtent([[c-.455*u,h-.238*u],[c+.455*u,h+.238*u]]).stream(l).point,i=a.translate([c-.307*u,h+.201*u]).clipExtent([[c-.425*u+Aa,h+.12*u+Aa],[c-.214*u-Aa,h+.234*u-Aa]]).stream(l).point,n=s.translate([c-.205*u,h+.212*u]).clipExtent([[c-.214*u+Aa,h+.166*u+Aa],[c-.115*u-Aa,h+.234*u-Aa]]).stream(l).point,t},t.scale(1070)};var Os,Is,ks,Ds,Vs,Fs,Gs={point:w,lineStart:w,lineEnd:w,polygonStart:function(){Is=0,Gs.lineStart=Ke},polygonEnd:function(){Gs.lineStart=Gs.lineEnd=Gs.point=w,Os+=fa(Is/2)}},Bs={point:qe,lineStart:w,lineEnd:w,polygonStart:w,polygonEnd:w},Ws={point:$e,lineStart:Ye,lineEnd:Xe,polygonStart:function(){Ws.lineStart=Je},polygonEnd:function(){Ws.point=$e,Ws.lineStart=Ye,Ws.lineEnd=Xe}};ra.geo.path=function(){function t(t){return t&&("function"==typeof s&&o.pointRadius(+s.apply(this,arguments)),a&&a.valid||(a=n(o)),ra.geo.stream(t,a)),o.result()}function e(){return a=null,t}var r,i,n,o,a,s=4.5;return t.area=function(t){return Os=0,ra.geo.stream(t,n(Gs)),Os},t.centroid=function(t){return ws=_s=xs=Ss=Ts=Ms=Ls=As=Ns=0,ra.geo.stream(t,n(Ws)),Ns?[Ls/Ns,As/Ns]:Ms?[Ss/Ms,Ts/Ms]:xs?[ws/xs,_s/xs]:[NaN,NaN]},t.bounds=function(t){return Vs=Fs=-(ks=Ds=1/0),ra.geo.stream(t,n(Bs)),[[ks,Ds],[Vs,Fs]]},t.projection=function(t){return arguments.length?(n=(r=t)?t.stream||er(t):v,e()):r},t.context=function(t){return arguments.length?(o=null==(i=t)?new Ze:new Qe(t),"function"!=typeof s&&o.pointRadius(s),e()):i},t.pointRadius=function(e){return arguments.length?(s="function"==typeof e?e:(o.pointRadius(+e),+e),t):s},t.projection(ra.geo.albersUsa()).context(null)},ra.geo.transform=function(t){return{stream:function(e){var r=new rr(e);for(var i in t)r[i]=t[i];return r}}},rr.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},ra.geo.projection=nr,ra.geo.projectionMutator=or,(ra.geo.equirectangular=function(){return nr(sr)}).raw=sr.invert=sr,ra.geo.rotation=function(t){function e(e){return e=t(e[0]*Ia,e[1]*Ia),e[0]*=ka,e[1]*=ka,e}return t=ur(t[0]%360*Ia,t[1]*Ia,t.length>2?t[2]*Ia:0),e.invert=function(e){return e=t.invert(e[0]*Ia,e[1]*Ia),e[0]*=ka,e[1]*=ka,e},e},lr.invert=sr,ra.geo.circle=function(){function t(){var t="function"==typeof i?i.apply(this,arguments):i,e=ur(-t[0]*Ia,-t[1]*Ia,0).invert,n=[];return r(null,null,1,{point:function(t,r){n.push(t=e(t,r)),t[0]*=ka,t[1]*=ka}}),{type:"Polygon",coordinates:[n]}}var e,r,i=[0,0],n=6;return t.origin=function(e){return arguments.length?(i=e,t):i},t.angle=function(i){return arguments.length?(r=dr((e=+i)*Ia,n*Ia),t):e},t.precision=function(i){return arguments.length?(r=dr(e*Ia,(n=+i)*Ia),t):n},t.angle(90)},ra.geo.distance=function(t,e){var r,i=(e[0]-t[0])*Ia,n=t[1]*Ia,o=e[1]*Ia,a=Math.sin(i),s=Math.cos(i),l=Math.sin(n),u=Math.cos(n),c=Math.sin(o),h=Math.cos(o);return Math.atan2(Math.sqrt((r=h*a)*r+(r=u*c-l*h*s)*r),l*c+u*h*s)},ra.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return ra.range(Math.ceil(o/m)*m,n,m).map(f).concat(ra.range(Math.ceil(u/y)*y,l,y).map(d)).concat(ra.range(Math.ceil(i/p)*p,r,p).filter(function(t){return fa(t%m)>Aa}).map(c)).concat(ra.range(Math.ceil(s/g)*g,a,g).filter(function(t){return fa(t%y)>Aa}).map(h))}var r,i,n,o,a,s,l,u,c,h,f,d,p=10,g=p,m=90,y=360,v=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[f(o).concat(d(l).slice(1),f(n).reverse().slice(1),d(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(o=+e[0][0],n=+e[1][0],u=+e[0][1],l=+e[1][1],o>n&&(e=o,o=n,n=e),u>l&&(e=u,u=l,l=e),t.precision(v)):[[o,u],[n,l]]},t.minorExtent=function(e){return arguments.length?(i=+e[0][0],r=+e[1][0],s=+e[0][1],a=+e[1][1],i>r&&(e=i,i=r,r=e),s>a&&(e=s,s=a,a=e),t.precision(v)):[[i,s],[r,a]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(m=+e[0],y=+e[1],t):[m,y]},t.minorStep=function(e){return arguments.length?(p=+e[0],g=+e[1],t):[p,g]},t.precision=function(e){return arguments.length?(v=+e,c=gr(s,a,90),h=mr(i,r,v),f=gr(u,l,90),d=mr(o,n,v),t):v},t.majorExtent([[-180,-90+Aa],[180,90-Aa]]).minorExtent([[-180,-80-Aa],[180,80+Aa]])},ra.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),r||n.apply(this,arguments)]}}var e,r,i=yr,n=vr;return t.distance=function(){return ra.geo.distance(e||i.apply(this,arguments),r||n.apply(this,arguments))},t.source=function(r){return arguments.length?(i=r,e="function"==typeof r?null:r,t):i},t.target=function(e){return arguments.length?(n=e,r="function"==typeof e?null:e,t):n},t.precision=function(){return arguments.length?t:0},t},ra.geo.interpolate=function(t,e){return br(t[0]*Ia,t[1]*Ia,e[0]*Ia,e[1]*Ia)},ra.geo.length=function(t){return Us=0,ra.geo.stream(t,zs),Us};var Us,zs={sphere:w,point:w,lineStart:Er,lineEnd:w,polygonStart:w,polygonEnd:w},js=wr(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(ra.geo.azimuthalEqualArea=function(){return nr(js)}).raw=js;var Ks=wr(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},v);(ra.geo.azimuthalEquidistant=function(){return nr(Ks)}).raw=Ks,(ra.geo.conicConformal=function(){return ze(_r)}).raw=_r,(ra.geo.conicEquidistant=function(){return ze(xr)}).raw=xr;var qs=wr(function(t){return 1/t},Math.atan);(ra.geo.gnomonic=function(){return nr(qs)}).raw=qs,Sr.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Oa]},(ra.geo.mercator=function(){return Tr(Sr)}).raw=Sr;var Zs=wr(function(){return 1},Math.asin);(ra.geo.orthographic=function(){return nr(Zs)}).raw=Zs;var Hs=wr(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(ra.geo.stereographic=function(){return nr(Hs)}).raw=Hs,Mr.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Oa]},(ra.geo.transverseMercator=function(){var t=Tr(Mr),e=t.center,r=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?r([t[0],t[1],t.length>2?t[2]+90:90]):(t=r(),[t[0],t[1],t[2]-90])},r([0,0,90])}).raw=Mr,ra.geom={},ra.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,n=Mt(r),o=Mt(i),a=t.length,s=[],l=[];for(e=0;a>e;e++)s.push([+n.call(this,t[e],e),+o.call(this,t[e],e),e]);for(s.sort(Cr),e=0;a>e;e++)l.push([s[e][0],-s[e][1]]);var u=Nr(s),c=Nr(l),h=c[0]===u[0],f=c[c.length-1]===u[u.length-1],d=[];for(e=u.length-1;e>=0;--e)d.push(t[s[u[e]][2]]);for(e=+h;e<c.length-f;++e)d.push(t[s[c[e]][2]]);return d}var r=Lr,i=Ar;return arguments.length?e(t):(e.x=function(t){return arguments.length?(r=t,e):r},e.y=function(t){return arguments.length?(i=t,e):i},e)},ra.geom.polygon=function(t){return ya(t,$s),t};var $s=ra.geom.polygon.prototype=[];$s.area=function(){for(var t,e=-1,r=this.length,i=this[r-1],n=0;++e<r;)t=i,i=this[e],n+=t[1]*i[0]-t[0]*i[1];return.5*n},$s.centroid=function(t){var e,r,i=-1,n=this.length,o=0,a=0,s=this[n-1];for(arguments.length||(t=-1/(6*this.area()));++i<n;)e=s,s=this[i],r=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*r,a+=(e[1]+s[1])*r;return[o*t,a*t]},$s.clip=function(t){for(var e,r,i,n,o,a,s=Or(t),l=-1,u=this.length-Or(this),c=this[u-1];++l<u;){for(e=t.slice(),t.length=0,n=this[l],o=e[(i=e.length-s)-1],r=-1;++r<i;)a=e[r],Rr(a,c,n)?(Rr(o,c,n)||t.push(Pr(o,a,c,n)),t.push(a)):Rr(o,c,n)&&t.push(Pr(o,a,c,n)),o=a;s&&t.push(t[0]),c=n}return t};var Ys,Xs,Js,Qs,tl,el=[],rl=[];Wr.prototype.prepare=function(){for(var t,e=this.edges,r=e.length;r--;)t=e[r].edge,t.b&&t.a||e.splice(r,1);return e.sort(zr),e.length},Qr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},ti.prototype={insert:function(t,e){var r,i,n;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;r=t}else this._?(t=ni(this._),e.P=null,e.N=t,t.P=t.L=e,r=t):(e.P=e.N=null,this._=e,r=null);for(e.L=e.R=null,e.U=r,e.C=!0,t=e;r&&r.C;)i=r.U,r===i.L?(n=i.R,n&&n.C?(r.C=n.C=!1,i.C=!0,t=i):(t===r.R&&(ri(this,r),t=r,r=t.U),r.C=!1,i.C=!0,ii(this,i))):(n=i.L,n&&n.C?(r.C=n.C=!1,i.C=!0,t=i):(t===r.L&&(ii(this,r),t=r,r=t.U),r.C=!1,i.C=!0,ri(this,i))),r=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,r,i,n=t.U,o=t.L,a=t.R;if(r=o?a?ni(a):o:a,n?n.L===t?n.L=r:n.R=r:this._=r,o&&a?(i=r.C,r.C=t.C,r.L=o,o.U=r,r!==a?(n=r.U,r.U=t.U,t=r.R,n.L=t,r.R=a,a.U=r):(r.U=n,n=r,t=r.R)):(i=t.C,t=r),t&&(t.U=n),!i){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===n.L){if(e=n.R,e.C&&(e.C=!1,n.C=!0,ri(this,n),e=n.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,ii(this,e),e=n.R),e.C=n.C,n.C=e.R.C=!1,ri(this,n),t=this._;break}}else if(e=n.L,e.C&&(e.C=!1,n.C=!0,ii(this,n),e=n.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,ri(this,e),e=n.L),e.C=n.C,n.C=e.L.C=!1,ii(this,n),t=this._;break}e.C=!0,t=n,n=n.U}while(!t.C);t&&(t.C=!1)}}},ra.geom.voronoi=function(t){function e(t){var e=new Array(t.length),i=s[0][0],n=s[0][1],o=s[1][0],a=s[1][1];return oi(r(t),s).cells.forEach(function(r,s){var l=r.edges,u=r.site,c=e[s]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=i&&u.x<=o&&u.y>=n&&u.y<=a?[[i,a],[o,a],[o,n],[i,n]]:[];c.point=t[s]}),e}function r(t){return t.map(function(t,e){return{x:Math.round(o(t,e)/Aa)*Aa,y:Math.round(a(t,e)/Aa)*Aa,i:e}})}var i=Lr,n=Ar,o=i,a=n,s=il;return t?e(t):(e.links=function(t){return oi(r(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return oi(r(t)).cells.forEach(function(r,i){for(var n,o,a=r.site,s=r.edges.sort(zr),l=-1,u=s.length,c=s[u-1].edge,h=c.l===a?c.r:c.l;++l<u;)n=c,o=h,c=s[l].edge,h=c.l===a?c.r:c.l,i<o.i&&i<h.i&&si(a,o,h)<0&&e.push([t[i],t[o.i],t[h.i]])}),e},e.x=function(t){return arguments.length?(o=Mt(i=t),e):i},e.y=function(t){return arguments.length?(a=Mt(n=t),e):n},e.clipExtent=function(t){return arguments.length?(s=null==t?il:t,e):s===il?null:s},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):s===il?null:s&&s[1]},e)};var il=[[-1e6,-1e6],[1e6,1e6]];ra.geom.delaunay=function(t){return ra.geom.voronoi().triangles(t)},ra.geom.quadtree=function(t,e,r,i,n){function o(t){function o(t,e,r,i,n,o,a,s){if(!isNaN(r)&&!isNaN(i))if(t.leaf){var l=t.x,c=t.y;if(null!=l)if(fa(l-r)+fa(c-i)<.01)u(t,e,r,i,n,o,a,s);else{var h=t.point;t.x=t.y=t.point=null,u(t,h,l,c,n,o,a,s),u(t,e,r,i,n,o,a,s)}else t.x=r,t.y=i,t.point=e}else u(t,e,r,i,n,o,a,s)}function u(t,e,r,i,n,a,s,l){var u=.5*(n+s),c=.5*(a+l),h=r>=u,f=i>=c,d=f<<1|h;t.leaf=!1,t=t.nodes[d]||(t.nodes[d]=ci()),h?n=u:s=u,f?a=c:l=c,o(t,e,r,i,n,a,s,l)}var c,h,f,d,p,g,m,y,v,b=Mt(s),E=Mt(l);if(null!=e)g=e,m=r,y=i,v=n;else if(y=v=-(g=m=1/0),h=[],f=[],p=t.length,a)for(d=0;p>d;++d)c=t[d],c.x<g&&(g=c.x),c.y<m&&(m=c.y),c.x>y&&(y=c.x),c.y>v&&(v=c.y),h.push(c.x),f.push(c.y);else for(d=0;p>d;++d){var w=+b(c=t[d],d),_=+E(c,d);g>w&&(g=w),m>_&&(m=_),w>y&&(y=w),_>v&&(v=_),h.push(w),f.push(_)}var x=y-g,S=v-m;x>S?v=m+x:y=g+S;var T=ci();if(T.add=function(t){o(T,t,+b(t,++d),+E(t,d),g,m,y,v)},T.visit=function(t){hi(t,T,g,m,y,v)},T.find=function(t){return fi(T,t[0],t[1],g,m,y,v)},d=-1,null==e){for(;++d<p;)o(T,t[d],h[d],f[d],g,m,y,v);--d}else t.forEach(T.add);return h=f=t=c=null,T}var a,s=Lr,l=Ar;return(a=arguments.length)?(s=li,l=ui,3===a&&(n=r,i=e,r=e=0),o(t)):(o.x=function(t){return arguments.length?(s=t,o):s},o.y=function(t){return arguments.length?(l=t,o):l},o.extent=function(t){return arguments.length?(null==t?e=r=i=n=null:(e=+t[0][0],r=+t[0][1],i=+t[1][0],n=+t[1][1]),o):null==e?null:[[e,r],[i,n]]},o.size=function(t){return arguments.length?(null==t?e=r=i=n=null:(e=r=0,i=+t[0],n=+t[1]),o):null==e?null:[i-e,n-r]},o)},ra.interpolateRgb=di,ra.interpolateObject=pi,ra.interpolateNumber=gi,ra.interpolateString=mi;var nl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ol=new RegExp(nl.source,"g");ra.interpolate=yi,ra.interpolators=[function(t,e){var r=typeof e;return("string"===r?Ya.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?di:mi:e instanceof at?di:Array.isArray(e)?vi:"object"===r&&isNaN(e)?pi:gi)(t,e)}],ra.interpolateArray=vi;var al=function(){return v},sl=ra.map({linear:al,poly:Ti,quad:function(){return _i},cubic:function(){return xi},sin:function(){return Mi},exp:function(){return Li},circle:function(){return Ai},elastic:Ni,back:Ci,bounce:function(){return Ri}}),ll=ra.map({in:v,out:Ei,"in-out":wi,"out-in":function(t){return wi(Ei(t))}});ra.ease=function(t){var e=t.indexOf("-"),r=e>=0?t.slice(0,e):t,i=e>=0?t.slice(e+1):"in";return r=sl.get(r)||al,i=ll.get(i)||v,bi(i(r.apply(null,ia.call(arguments,1))))},ra.interpolateHcl=Pi,ra.interpolateHsl=Oi,ra.interpolateLab=Ii,ra.interpolateRound=ki,ra.transform=function(t){var e=oa.createElementNS(ra.ns.prefix.svg,"g");return(ra.transform=function(t){if(null!=t){e.setAttribute("transform",t);var r=e.transform.baseVal.consolidate()}return new Di(r?r.matrix:ul)})(t)},Di.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ul={a:1,b:0,c:0,d:1,e:0,f:0};ra.interpolateTransform=Bi,ra.layout={},ra.layout.bundle=function(){return function(t){for(var e=[],r=-1,i=t.length;++r<i;)e.push(zi(t[r]));return e}},ra.layout.chord=function(){function t(){var t,u,h,f,d,p={},g=[],m=ra.range(o),y=[];for(r=[],i=[],t=0,f=-1;++f<o;){for(u=0,d=-1;++d<o;)u+=n[f][d];g.push(u),y.push(ra.range(o)),t+=u}for(a&&m.sort(function(t,e){return a(g[t],g[e])}),s&&y.forEach(function(t,e){t.sort(function(t,r){return s(n[e][t],n[e][r])})}),t=(Ra-c*o)/t,u=0,f=-1;++f<o;){for(h=u,d=-1;++d<o;){var v=m[f],b=y[v][d],E=n[v][b],w=u,_=u+=E*t;p[v+"-"+b]={index:v,subindex:b,startAngle:w,endAngle:_,value:E}}i[v]={index:v,startAngle:h,endAngle:u,value:(u-h)/t},u+=c}for(f=-1;++f<o;)for(d=f-1;++d<o;){var x=p[f+"-"+d],S=p[d+"-"+f];(x.value||S.value)&&r.push(x.value<S.value?{source:S,target:x}:{source:x,target:S})}l&&e()}function e(){r.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var r,i,n,o,a,s,l,u={},c=0;return u.matrix=function(t){return arguments.length?(o=(n=t)&&n.length,r=i=null,u):n},u.padding=function(t){return arguments.length?(c=t,r=i=null,u):c},u.sortGroups=function(t){return arguments.length?(a=t,r=i=null,u):a},u.sortSubgroups=function(t){return arguments.length?(s=t,r=null,u):s},u.sortChords=function(t){return arguments.length?(l=t,r&&e(),u):l},u.chords=function(){return r||t(),r},u.groups=function(){return i||t(),i},u},ra.layout.force=function(){function t(t){return function(e,r,i,n){if(e.point!==t){var o=e.cx-t.x,a=e.cy-t.y,s=n-r,l=o*o+a*a;if(l>s*s/m){if(p>l){var u=e.charge/l;t.px-=o*u,t.py-=a*u}return!0}if(e.point&&l&&p>l){var u=e.pointCharge/l;t.px-=o*u,t.py-=a*u}}return!e.charge}}function e(t){t.px=ra.event.x,t.py=ra.event.y,s.resume()}var r,i,n,o,a,s={},l=ra.dispatch("start","tick","end"),u=[1,1],c=.9,h=cl,f=hl,d=-30,p=fl,g=.1,m=.64,y=[],b=[];return s.tick=function(){if((i*=.99)<.005)return l.end({type:"end",alpha:i=0}),!0;var e,r,s,h,f,p,m,v,E,w=y.length,_=b.length;for(r=0;_>r;++r)s=b[r],h=s.source,f=s.target,v=f.x-h.x,E=f.y-h.y,(p=v*v+E*E)&&(p=i*o[r]*((p=Math.sqrt(p))-n[r])/p,v*=p,E*=p,f.x-=v*(m=h.weight/(f.weight+h.weight)),f.y-=E*m,h.x+=v*(m=1-m),h.y+=E*m);if((m=i*g)&&(v=u[0]/2,E=u[1]/2,r=-1,m))for(;++r<w;)s=y[r],s.x+=(v-s.x)*m,s.y+=(E-s.y)*m;if(d)for(Yi(e=ra.geom.quadtree(y),i,a),r=-1;++r<w;)(s=y[r]).fixed||e.visit(t(s));for(r=-1;++r<w;)s=y[r],s.fixed?(s.x=s.px,s.y=s.py):(s.x-=(s.px-(s.px=s.x))*c,s.y-=(s.py-(s.py=s.y))*c);l.tick({type:"tick",alpha:i})},s.nodes=function(t){return arguments.length?(y=t,s):y},s.links=function(t){return arguments.length?(b=t,s):b},s.size=function(t){return arguments.length?(u=t,s):u},s.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,s):h},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,s):f},s.friction=function(t){return arguments.length?(c=+t,s):c},s.charge=function(t){return arguments.length?(d="function"==typeof t?t:+t,s):d},s.chargeDistance=function(t){return arguments.length?(p=t*t,s):Math.sqrt(p)},s.gravity=function(t){return arguments.length?(g=+t,s):g},s.theta=function(t){return arguments.length?(m=t*t,s):Math.sqrt(m)},s.alpha=function(t){return arguments.length?(t=+t,i?i=t>0?t:0:t>0&&(l.start({type:"start",alpha:i=t}),ra.timer(s.tick)),s):i},s.start=function(){function t(t,i){if(!r){for(r=new Array(l),s=0;l>s;++s)r[s]=[];for(s=0;c>s;++s){var n=b[s];r[n.source.index].push(n.target),r[n.target.index].push(n.source)}}for(var o,a=r[e],s=-1,u=a.length;++s<u;)if(!isNaN(o=a[s][t]))return o;return Math.random()*i}var e,r,i,l=y.length,c=b.length,p=u[0],g=u[1];for(e=0;l>e;++e)(i=y[e]).index=e,i.weight=0;for(e=0;c>e;++e)i=b[e],"number"==typeof i.source&&(i.source=y[i.source]),"number"==typeof i.target&&(i.target=y[i.target]),++i.source.weight,++i.target.weight;for(e=0;l>e;++e)i=y[e],isNaN(i.x)&&(i.x=t("x",p)),isNaN(i.y)&&(i.y=t("y",g)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(n=[],"function"==typeof h)for(e=0;c>e;++e)n[e]=+h.call(this,b[e],e);else for(e=0;c>e;++e)n[e]=h;if(o=[],"function"==typeof f)for(e=0;c>e;++e)o[e]=+f.call(this,b[e],e);else for(e=0;c>e;++e)o[e]=f;if(a=[],"function"==typeof d)for(e=0;l>e;++e)a[e]=+d.call(this,y[e],e);else for(e=0;l>e;++e)a[e]=d;return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){return r||(r=ra.behavior.drag().origin(v).on("dragstart.force",qi).on("drag.force",e).on("dragend.force",Zi)),arguments.length?void this.on("mouseover.force",Hi).on("mouseout.force",$i).call(r):r},ra.rebind(s,l,"on")};var cl=20,hl=1,fl=1/0;ra.layout.hierarchy=function(){function t(n){var o,a=[n],s=[];for(n.depth=0;null!=(o=a.pop());)if(s.push(o),(u=r.call(t,o,o.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)a.push(c=u[l]),c.parent=o,c.depth=o.depth+1;i&&(o.value=0),o.children=u}else i&&(o.value=+i.call(t,o,o.depth)||0),delete o.children;return Qi(n,function(t){var r,n;e&&(r=t.children)&&r.sort(e),i&&(n=t.parent)&&(n.value+=t.value)}),s}var e=rn,r=tn,i=en;return t.sort=function(r){return arguments.length?(e=r,t):e},t.children=function(e){return arguments.length?(r=e,t):r},t.value=function(e){return arguments.length?(i=e,t):i},t.revalue=function(e){return i&&(Ji(e,function(t){t.children&&(t.value=0)}),Qi(e,function(e){var r;e.children||(e.value=+i.call(t,e,e.depth)||0),(r=e.parent)&&(r.value+=e.value)})),e},t},ra.layout.partition=function(){function t(e,r,i,n){var o=e.children;if(e.x=r,e.y=e.depth*n,e.dx=i,e.dy=n,o&&(a=o.length)){var a,s,l,u=-1;for(i=e.value?i/e.value:0;++u<a;)t(s=o[u],r,l=s.value*i,n),r+=l}}function e(t){var r=t.children,i=0;if(r&&(n=r.length))for(var n,o=-1;++o<n;)i=Math.max(i,e(r[o]));return 1+i}function r(r,o){var a=i.call(this,r,o);return t(a[0],0,n[0],n[1]/e(a[0])),a}var i=ra.layout.hierarchy(),n=[1,1];return r.size=function(t){return arguments.length?(n=t,r):n},Xi(r,i)},ra.layout.pie=function(){function t(a){var s,l=a.length,u=a.map(function(r,i){return+e.call(t,r,i)}),c=+("function"==typeof i?i.apply(this,arguments):i),h=("function"==typeof n?n.apply(this,arguments):n)-c,f=Math.min(Math.abs(h)/l,+("function"==typeof o?o.apply(this,arguments):o)),d=f*(0>h?-1:1),p=(h-l*d)/ra.sum(u),g=ra.range(l),m=[];return null!=r&&g.sort(r===dl?function(t,e){return u[e]-u[t]}:function(t,e){return r(a[t],a[e])}),g.forEach(function(t){m[t]={data:a[t],value:s=u[t],startAngle:c,endAngle:c+=s*p+d,padAngle:f}}),m}var e=Number,r=dl,i=0,n=Ra,o=0;return t.value=function(r){return arguments.length?(e=r,t):e},t.sort=function(e){return arguments.length?(r=e,t):r},t.startAngle=function(e){return arguments.length?(i=e,t):i},t.endAngle=function(e){return arguments.length?(n=e,t):n},t.padAngle=function(e){return arguments.length?(o=e,t):o},t};var dl={};ra.layout.stack=function(){function t(s,l){if(!(f=s.length))return s;var u=s.map(function(r,i){return e.call(t,r,i)}),c=u.map(function(e){return e.map(function(e,r){return[o.call(t,e,r),a.call(t,e,r)]})}),h=r.call(t,c,l);u=ra.permute(u,h),c=ra.permute(c,h);var f,d,p,g,m=i.call(t,c,l),y=u[0].length;for(p=0;y>p;++p)for(n.call(t,u[0][p],g=m[p],c[0][p][1]),d=1;f>d;++d)n.call(t,u[d][p],g+=c[d-1][p][1],c[d][p][1]);return s}var e=v,r=ln,i=un,n=sn,o=on,a=an;return t.values=function(r){return arguments.length?(e=r,t):e},t.order=function(e){return arguments.length?(r="function"==typeof e?e:pl.get(e)||ln,t):r},t.offset=function(e){return arguments.length?(i="function"==typeof e?e:gl.get(e)||un,t):i},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(a=e,t):a},t.out=function(e){return arguments.length?(n=e,t):n},t};var pl=ra.map({"inside-out":function(t){var e,r,i=t.length,n=t.map(cn),o=t.map(hn),a=ra.range(i).sort(function(t,e){return n[t]-n[e]}),s=0,l=0,u=[],c=[];for(e=0;i>e;++e)r=a[e],l>s?(s+=o[r],u.push(r)):(l+=o[r],c.push(r));return c.reverse().concat(u)},reverse:function(t){return ra.range(t.length).reverse()},default:ln}),gl=ra.map({silhouette:function(t){var e,r,i,n=t.length,o=t[0].length,a=[],s=0,l=[];for(r=0;o>r;++r){for(e=0,i=0;n>e;e++)i+=t[e][r][1];i>s&&(s=i),a.push(i)}for(r=0;o>r;++r)l[r]=(s-a[r])/2;return l},wiggle:function(t){var e,r,i,n,o,a,s,l,u,c=t.length,h=t[0],f=h.length,d=[];for(d[0]=l=u=0,r=1;f>r;++r){for(e=0,n=0;c>e;++e)n+=t[e][r][1];for(e=0,o=0,s=h[r][0]-h[r-1][0];c>e;++e){for(i=0,a=(t[e][r][1]-t[e][r-1][1])/(2*s);e>i;++i)a+=(t[i][r][1]-t[i][r-1][1])/s;o+=a*t[e][r][1]}d[r]=l-=n?o/n*s:0,u>l&&(u=l)}for(r=0;f>r;++r)d[r]-=u;return d},expand:function(t){var e,r,i,n=t.length,o=t[0].length,a=1/n,s=[];for(r=0;o>r;++r){for(e=0,i=0;n>e;e++)i+=t[e][r][1];if(i)for(e=0;n>e;e++)t[e][r][1]/=i;else for(e=0;n>e;e++)t[e][r][1]=a}for(r=0;o>r;++r)s[r]=0;return s},zero:un});ra.layout.histogram=function(){function t(t,o){for(var a,s,l=[],u=t.map(r,this),c=i.call(this,u,o),h=n.call(this,c,u,o),o=-1,f=u.length,d=h.length-1,p=e?1:1/f;++o<d;)a=l[o]=[],a.dx=h[o+1]-(a.x=h[o]),a.y=0;if(d>0)for(o=-1;++o<f;)s=u[o],s>=c[0]&&s<=c[1]&&(a=l[ra.bisect(h,s,1,d)-1],a.y+=p,a.push(t[o]));return l}var e=!0,r=Number,i=gn,n=dn;return t.value=function(e){return arguments.length?(r=e,t):r},t.range=function(e){return arguments.length?(i=Mt(e),t):i},t.bins=function(e){return arguments.length?(n="number"==typeof e?function(t){return pn(t,e)}:Mt(e),t):n},t.frequency=function(r){return arguments.length?(e=!!r,t):e},t},ra.layout.pack=function(){function t(t,o){var a=r.call(this,t,o),s=a[0],l=n[0],u=n[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(s.x=s.y=0,Qi(s,function(t){t.r=+c(t.value)}),Qi(s,En),i){var h=i*(e?1:Math.max(2*s.r/l,2*s.r/u))/2;Qi(s,function(t){t.r+=h}),Qi(s,En),Qi(s,function(t){t.r-=h})}return xn(s,l/2,u/2,e?1:1/Math.max(2*s.r/l,2*s.r/u)),a}var e,r=ra.layout.hierarchy().sort(mn),i=0,n=[1,1];return t.size=function(e){return arguments.length?(n=e,t):n},t.radius=function(r){return arguments.length?(e=null==r||"function"==typeof r?r:+r,t):e},t.padding=function(e){return arguments.length?(i=+e,t):i},Xi(t,r)},ra.layout.tree=function(){function t(t,n){var c=a.call(this,t,n),h=c[0],f=e(h);if(Qi(f,r),f.parent.m=-f.z,Ji(f,i),u)Ji(h,o);else{var d=h,p=h,g=h;Ji(h,function(t){t.x<d.x&&(d=t),t.x>p.x&&(p=t),t.depth>g.depth&&(g=t)});var m=s(d,p)/2-d.x,y=l[0]/(p.x+s(p,d)/2+m),v=l[1]/(g.depth||1);Ji(h,function(t){t.x=(t.x+m)*y,t.y=t.depth*v})}return c}function e(t){for(var e,r={A:null,children:[t]},i=[r];null!=(e=i.pop());)for(var n,o=e.children,a=0,s=o.length;s>a;++a)i.push((o[a]=n={_:o[a],parent:e,children:(n=o[a].children)&&n.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=n);return r.children[0]}function r(t){var e=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(e.length){Nn(t);var o=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+s(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+s(t._,i._));t.parent.A=n(t,i,t.parent.A||r[0])}function i(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function n(t,e,r){if(e){for(var i,n=t,o=t,a=e,l=n.parent.children[0],u=n.m,c=o.m,h=a.m,f=l.m;a=Ln(a),n=Mn(n),a&&n;)l=Mn(l),o=Ln(o),o.a=t,i=a.z+h-n.z-u+s(a._,n._),i>0&&(An(Cn(a,t,r),t,i),u+=i,c+=i),h+=a.m,u+=n.m,f+=l.m,c+=o.m;a&&!Ln(o)&&(o.t=a,o.m+=h-c),n&&!Mn(l)&&(l.t=n,l.m+=u-f,r=t)}return r}function o(t){t.x*=l[0],t.y=t.depth*l[1]}var a=ra.layout.hierarchy().sort(null).value(null),s=Tn,l=[1,1],u=null;return t.separation=function(e){return arguments.length?(s=e,t):s},t.size=function(e){return arguments.length?(u=null==(l=e)?o:null,t):u?null:l},t.nodeSize=function(e){return arguments.length?(u=null==(l=e)?null:o,t):u?l:null},Xi(t,a)},ra.layout.cluster=function(){function t(t,o){var a,s=e.call(this,t,o),l=s[0],u=0;Qi(l,function(t){var e=t.children;e&&e.length?(t.x=Pn(e),t.y=Rn(e)):(t.x=a?u+=r(t,a):0,t.y=0,a=t)});var c=On(l),h=In(l),f=c.x-r(c,h)/2,d=h.x+r(h,c)/2;return Qi(l,n?function(t){t.x=(t.x-l.x)*i[0],t.y=(l.y-t.y)*i[1]}:function(t){t.x=(t.x-f)/(d-f)*i[0],t.y=(1-(l.y?t.y/l.y:1))*i[1]}),s}var e=ra.layout.hierarchy().sort(null).value(null),r=Tn,i=[1,1],n=!1;return t.separation=function(e){return arguments.length?(r=e,t):r},t.size=function(e){return arguments.length?(n=null==(i=e),t):n?null:i},t.nodeSize=function(e){return arguments.length?(n=null!=(i=e),t):n?i:null},Xi(t,e)},ra.layout.treemap=function(){function t(t,e){for(var r,i,n=-1,o=t.length;++n<o;)i=(r=t[n]).value*(0>e?0:e),r.area=isNaN(i)||0>=i?0:i}function e(r){var o=r.children;if(o&&o.length){var a,s,l,u=h(r),c=[],f=o.slice(),p=1/0,g="slice"===d?u.dx:"dice"===d?u.dy:"slice-dice"===d?1&r.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(t(f,u.dx*u.dy/r.value),c.area=0;(l=f.length)>0;)c.push(a=f[l-1]),c.area+=a.area,"squarify"!==d||(s=i(c,g))<=p?(f.pop(),p=s):(c.area-=c.pop().area,n(c,g,u,!1),g=Math.min(u.dx,u.dy),c.length=c.area=0,p=1/0);c.length&&(n(c,g,u,!0),c.length=c.area=0),o.forEach(e)}}function r(e){var i=e.children;if(i&&i.length){var o,a=h(e),s=i.slice(),l=[];for(t(s,a.dx*a.dy/e.value),l.area=0;o=s.pop();)l.push(o),l.area+=o.area,null!=o.z&&(n(l,o.z?a.dx:a.dy,a,!s.length),l.length=l.area=0);i.forEach(r)}}function i(t,e){for(var r,i=t.area,n=0,o=1/0,a=-1,s=t.length;++a<s;)(r=t[a].area)&&(o>r&&(o=r),r>n&&(n=r));return i*=i,e*=e,i?Math.max(e*n*p/i,i/(e*o*p)):1/0}function n(t,e,r,i){var n,o=-1,a=t.length,s=r.x,u=r.y,c=e?l(t.area/e):0;if(e==r.dx){for((i||c>r.dy)&&(c=r.dy);++o<a;)n=t[o],n.x=s,n.y=u,n.dy=c,s+=n.dx=Math.min(r.x+r.dx-s,c?l(n.area/c):0);n.z=!0,n.dx+=r.x+r.dx-s,r.y+=c,r.dy-=c}else{for((i||c>r.dx)&&(c=r.dx);++o<a;)n=t[o],n.x=s,n.y=u,n.dx=c,u+=n.dy=Math.min(r.y+r.dy-u,c?l(n.area/c):0);n.z=!1,n.dy+=r.y+r.dy-u,r.x+=c,r.dx-=c}}function o(i){var n=a||s(i),o=n[0];return o.x=0,o.y=0,o.dx=u[0],o.dy=u[1],a&&s.revalue(o),t([o],o.dx*o.dy/o.value),(a?r:e)(o),f&&(a=n),n}var a,s=ra.layout.hierarchy(),l=Math.round,u=[1,1],c=null,h=kn,f=!1,d="squarify",p=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(u=t,o):u},o.padding=function(t){function e(e){var r=t.call(o,e,e.depth);return null==r?kn(e):Dn(e,"number"==typeof r?[r,r,r,r]:r)}function r(e){return Dn(e,t)}if(!arguments.length)return c;var i;return h=null==(c=t)?kn:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],r):r,o},o.round=function(t){return arguments.length?(l=t?Math.round:Number,o):l!=Number},o.sticky=function(t){return arguments.length?(f=t,a=null,o):f},o.ratio=function(t){return arguments.length?(p=t,o):p},o.mode=function(t){return arguments.length?(d=t+"",o):d},Xi(o,s)},ra.random={normal:function(t,e){var r=arguments.length;return 2>r&&(e=1),1>r&&(t=0),function(){var r,i,n;do r=2*Math.random()-1,i=2*Math.random()-1,n=r*r+i*i;while(!n||n>1);return t+e*r*Math.sqrt(-2*Math.log(n)/n)}},logNormal:function(){var t=ra.random.normal.apply(ra,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=ra.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,r=0;t>r;r++)e+=Math.random();return e}}},ra.scale={};var ml={floor:v,ceil:v};ra.scale.linear=function(){return zn([0,1],[0,1],yi,!1)};var yl={s:1,g:1,p:1,r:1,e:1};ra.scale.log=function(){return Xn(ra.scale.linear().domain([0,1]),10,!0,[1,10])};var vl=ra.format(".0e"),bl={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};ra.scale.pow=function(){return Jn(ra.scale.linear(),1,[0,1])},ra.scale.sqrt=function(){return ra.scale.pow().exponent(.5)},ra.scale.ordinal=function(){return to([],{t:"range",a:[[]]})},ra.scale.category10=function(){return ra.scale.ordinal().range(El)},ra.scale.category20=function(){return ra.scale.ordinal().range(wl)},ra.scale.category20b=function(){return ra.scale.ordinal().range(_l)},ra.scale.category20c=function(){return ra.scale.ordinal().range(xl)};var El=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(bt),wl=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(bt),_l=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(bt),xl=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(bt);ra.scale.quantile=function(){return eo([],[])},ra.scale.quantize=function(){return ro(0,1,[0,1])},ra.scale.threshold=function(){return io([.5],[0,1])},ra.scale.identity=function(){return no([0,1])},ra.svg={},ra.svg.arc=function(){function t(){var t=Math.max(0,+r.apply(this,arguments)),u=Math.max(0,+i.apply(this,arguments)),c=a.apply(this,arguments)-Oa,h=s.apply(this,arguments)-Oa,f=Math.abs(h-c),d=c>h?0:1;if(t>u&&(p=u,u=t,t=p),f>=Pa)return e(u,d)+(t?e(t,1-d):"")+"Z";var p,g,m,y,v,b,E,w,_,x,S,T,M=0,L=0,A=[];if((y=(+l.apply(this,arguments)||0)/2)&&(m=o===Sl?Math.sqrt(t*t+u*u):+o.apply(this,arguments),d||(L*=-1),u&&(L=et(m/u*Math.sin(y))),t&&(M=et(m/t*Math.sin(y)))),u){v=u*Math.cos(c+L),b=u*Math.sin(c+L),E=u*Math.cos(h-L),w=u*Math.sin(h-L);var N=Math.abs(h-c-2*L)<=Ca?0:1;if(L&&ho(v,b,E,w)===d^N){var C=(c+h)/2;v=u*Math.cos(C),b=u*Math.sin(C),E=w=null}}else v=b=0;if(t){_=t*Math.cos(h-M),x=t*Math.sin(h-M),S=t*Math.cos(c+M),T=t*Math.sin(c+M);var R=Math.abs(c-h+2*M)<=Ca?0:1;if(M&&ho(_,x,S,T)===1-d^R){var P=(c+h)/2;_=t*Math.cos(P),x=t*Math.sin(P),S=T=null}}else _=x=0;if((p=Math.min(Math.abs(u-t)/2,+n.apply(this,arguments)))>.001){g=u>t^d?0:1;var O=null==S?[_,x]:null==E?[v,b]:Pr([v,b],[S,T],[E,w],[_,x]),I=v-O[0],k=b-O[1],D=E-O[0],V=w-O[1],F=1/Math.sin(Math.acos((I*D+k*V)/(Math.sqrt(I*I+k*k)*Math.sqrt(D*D+V*V)))/2),G=Math.sqrt(O[0]*O[0]+O[1]*O[1]);if(null!=E){var B=Math.min(p,(u-G)/(F+1)),W=fo(null==S?[_,x]:[S,T],[v,b],u,B,d),U=fo([E,w],[_,x],u,B,d);p===B?A.push("M",W[0],"A",B,",",B," 0 0,",g," ",W[1],"A",u,",",u," 0 ",1-d^ho(W[1][0],W[1][1],U[1][0],U[1][1]),",",d," ",U[1],"A",B,",",B," 0 0,",g," ",U[0]):A.push("M",W[0],"A",B,",",B," 0 1,",g," ",U[0]);
}else A.push("M",v,",",b);if(null!=S){var z=Math.min(p,(t-G)/(F-1)),j=fo([v,b],[S,T],t,-z,d),K=fo([_,x],null==E?[v,b]:[E,w],t,-z,d);p===z?A.push("L",K[0],"A",z,",",z," 0 0,",g," ",K[1],"A",t,",",t," 0 ",d^ho(K[1][0],K[1][1],j[1][0],j[1][1]),",",1-d," ",j[1],"A",z,",",z," 0 0,",g," ",j[0]):A.push("L",K[0],"A",z,",",z," 0 0,",g," ",j[0])}else A.push("L",_,",",x)}else A.push("M",v,",",b),null!=E&&A.push("A",u,",",u," 0 ",N,",",d," ",E,",",w),A.push("L",_,",",x),null!=S&&A.push("A",t,",",t," 0 ",R,",",1-d," ",S,",",T);return A.push("Z"),A.join("")}function e(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}var r=ao,i=so,n=oo,o=Sl,a=lo,s=uo,l=co;return t.innerRadius=function(e){return arguments.length?(r=Mt(e),t):r},t.outerRadius=function(e){return arguments.length?(i=Mt(e),t):i},t.cornerRadius=function(e){return arguments.length?(n=Mt(e),t):n},t.padRadius=function(e){return arguments.length?(o=e==Sl?Sl:Mt(e),t):o},t.startAngle=function(e){return arguments.length?(a=Mt(e),t):a},t.endAngle=function(e){return arguments.length?(s=Mt(e),t):s},t.padAngle=function(e){return arguments.length?(l=Mt(e),t):l},t.centroid=function(){var t=(+r.apply(this,arguments)+ +i.apply(this,arguments))/2,e=(+a.apply(this,arguments)+ +s.apply(this,arguments))/2-Oa;return[Math.cos(e)*t,Math.sin(e)*t]},t};var Sl="auto";ra.svg.line=function(){return po(v)};var Tl=ra.map({linear:go,"linear-closed":mo,step:yo,"step-before":vo,"step-after":bo,basis:To,"basis-open":Mo,"basis-closed":Lo,bundle:Ao,cardinal:_o,"cardinal-open":Eo,"cardinal-closed":wo,monotone:Io});Tl.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Ml=[0,2/3,1/3,0],Ll=[0,1/3,2/3,0],Al=[0,1/6,2/3,1/6];ra.svg.line.radial=function(){var t=po(ko);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},vo.reverse=bo,bo.reverse=vo,ra.svg.area=function(){return Do(v)},ra.svg.area.radial=function(){var t=Do(ko);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},ra.svg.chord=function(){function t(t,s){var l=e(this,o,t,s),u=e(this,a,t,s);return"M"+l.p0+i(l.r,l.p1,l.a1-l.a0)+(r(l,u)?n(l.r,l.p1,l.r,l.p0):n(l.r,l.p1,u.r,u.p0)+i(u.r,u.p1,u.a1-u.a0)+n(u.r,u.p1,l.r,l.p0))+"Z"}function e(t,e,r,i){var n=e.call(t,r,i),o=s.call(t,n,i),a=l.call(t,n,i)-Oa,c=u.call(t,n,i)-Oa;return{r:o,a0:a,a1:c,p0:[o*Math.cos(a),o*Math.sin(a)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function r(t,e){return t.a0==e.a0&&t.a1==e.a1}function i(t,e,r){return"A"+t+","+t+" 0 "+ +(r>Ca)+",1 "+e}function n(t,e,r,i){return"Q 0,0 "+i}var o=yr,a=vr,s=Vo,l=lo,u=uo;return t.radius=function(e){return arguments.length?(s=Mt(e),t):s},t.source=function(e){return arguments.length?(o=Mt(e),t):o},t.target=function(e){return arguments.length?(a=Mt(e),t):a},t.startAngle=function(e){return arguments.length?(l=Mt(e),t):l},t.endAngle=function(e){return arguments.length?(u=Mt(e),t):u},t},ra.svg.diagonal=function(){function t(t,n){var o=e.call(this,t,n),a=r.call(this,t,n),s=(o.y+a.y)/2,l=[o,{x:o.x,y:s},{x:a.x,y:s},a];return l=l.map(i),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=yr,r=vr,i=Fo;return t.source=function(r){return arguments.length?(e=Mt(r),t):e},t.target=function(e){return arguments.length?(r=Mt(e),t):r},t.projection=function(e){return arguments.length?(i=e,t):i},t},ra.svg.diagonal.radial=function(){var t=ra.svg.diagonal(),e=Fo,r=t.projection;return t.projection=function(t){return arguments.length?r(Go(e=t)):e},t},ra.svg.symbol=function(){function t(t,i){return(Nl.get(e.call(this,t,i))||Uo)(r.call(this,t,i))}var e=Wo,r=Bo;return t.type=function(r){return arguments.length?(e=Mt(r),t):e},t.size=function(e){return arguments.length?(r=Mt(e),t):r},t};var Nl=ra.map({circle:Uo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Rl)),r=e*Rl;return"M0,"+-e+"L"+r+",0 0,"+e+" "+-r+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Cl),r=e*Cl/2;return"M0,"+r+"L"+e+","+-r+" "+-e+","+-r+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Cl),r=e*Cl/2;return"M0,"+-r+"L"+e+","+r+" "+-e+","+r+"Z"}});ra.svg.symbolTypes=Nl.keys();var Cl=Math.sqrt(3),Rl=Math.tan(30*Ia);wa.transition=function(t){for(var e,r,i=Pl||++Dl,n=Zo(t),o=[],a=Ol||{time:Date.now(),ease:Si,delay:0,duration:250},s=-1,l=this.length;++s<l;){o.push(e=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(r=u[c])&&Ho(r,c,n,i,a),e.push(r)}return jo(o,n,i)},wa.interrupt=function(t){return this.each(null==t?Il:zo(Zo(t)))};var Pl,Ol,Il=zo(Zo()),kl=[],Dl=0;kl.call=wa.call,kl.empty=wa.empty,kl.node=wa.node,kl.size=wa.size,ra.transition=function(t,e){return t&&t.transition?Pl?t.transition(e):t:ra.selection().transition(t)},ra.transition.prototype=kl,kl.select=function(t){var e,r,i,n=this.id,o=this.namespace,a=[];t=A(t);for(var s=-1,l=this.length;++s<l;){a.push(e=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(i=u[c])&&(r=t.call(i,i.__data__,c,s))?("__data__"in i&&(r.__data__=i.__data__),Ho(r,c,o,n,i[o][n]),e.push(r)):e.push(null)}return jo(a,o,n)},kl.selectAll=function(t){var e,r,i,n,o,a=this.id,s=this.namespace,l=[];t=N(t);for(var u=-1,c=this.length;++u<c;)for(var h=this[u],f=-1,d=h.length;++f<d;)if(i=h[f]){o=i[s][a],r=t.call(i,i.__data__,f,u),l.push(e=[]);for(var p=-1,g=r.length;++p<g;)(n=r[p])&&Ho(n,p,s,a,o),e.push(n)}return jo(l,s,a)},kl.filter=function(t){var e,r,i,n=[];"function"!=typeof t&&(t=W(t));for(var o=0,a=this.length;a>o;o++){n.push(e=[]);for(var r=this[o],s=0,l=r.length;l>s;s++)(i=r[s])&&t.call(i,i.__data__,s,o)&&e.push(i)}return jo(n,this.namespace,this.id)},kl.tween=function(t,e){var r=this.id,i=this.namespace;return arguments.length<2?this.node()[i][r].tween.get(t):z(this,null==e?function(e){e[i][r].tween.remove(t)}:function(n){n[i][r].tween.set(t,e)})},kl.attr=function(t,e){function r(){this.removeAttribute(s)}function i(){this.removeAttributeNS(s.space,s.local)}function n(t){return null==t?r:(t+="",function(){var e,r=this.getAttribute(s);return r!==t&&(e=a(r,t),function(t){this.setAttribute(s,e(t))})})}function o(t){return null==t?i:(t+="",function(){var e,r=this.getAttributeNS(s.space,s.local);return r!==t&&(e=a(r,t),function(t){this.setAttributeNS(s.space,s.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var a="transform"==t?Bi:yi,s=ra.ns.qualify(t);return Ko(this,"attr."+t,e,s.local?o:n)},kl.attrTween=function(t,e){function r(t,r){var i=e.call(this,t,r,this.getAttribute(n));return i&&function(t){this.setAttribute(n,i(t))}}function i(t,r){var i=e.call(this,t,r,this.getAttributeNS(n.space,n.local));return i&&function(t){this.setAttributeNS(n.space,n.local,i(t))}}var n=ra.ns.qualify(t);return this.tween("attr."+t,n.local?i:r)},kl.style=function(t,r,i){function n(){this.style.removeProperty(t)}function o(r){return null==r?n:(r+="",function(){var n,o=e(this).getComputedStyle(this,null).getPropertyValue(t);return o!==r&&(n=yi(o,r),function(e){this.style.setProperty(t,n(e),i)})})}var a=arguments.length;if(3>a){if("string"!=typeof t){2>a&&(r="");for(i in t)this.style(i,t[i],r);return this}i=""}return Ko(this,"style."+t,r,o)},kl.styleTween=function(t,r,i){function n(n,o){var a=r.call(this,n,o,e(this).getComputedStyle(this,null).getPropertyValue(t));return a&&function(e){this.style.setProperty(t,a(e),i)}}return arguments.length<3&&(i=""),this.tween("style."+t,n)},kl.text=function(t){return Ko(this,"text",t,qo)},kl.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},kl.ease=function(t){var e=this.id,r=this.namespace;return arguments.length<1?this.node()[r][e].ease:("function"!=typeof t&&(t=ra.ease.apply(ra,arguments)),z(this,function(i){i[r][e].ease=t}))},kl.delay=function(t){var e=this.id,r=this.namespace;return arguments.length<1?this.node()[r][e].delay:z(this,"function"==typeof t?function(i,n,o){i[r][e].delay=+t.call(i,i.__data__,n,o)}:(t=+t,function(i){i[r][e].delay=t}))},kl.duration=function(t){var e=this.id,r=this.namespace;return arguments.length<1?this.node()[r][e].duration:z(this,"function"==typeof t?function(i,n,o){i[r][e].duration=Math.max(1,t.call(i,i.__data__,n,o))}:(t=Math.max(1,t),function(i){i[r][e].duration=t}))},kl.each=function(t,e){var r=this.id,i=this.namespace;if(arguments.length<2){var n=Ol,o=Pl;try{Pl=r,z(this,function(e,n,o){Ol=e[i][r],t.call(e,e.__data__,n,o)})}finally{Ol=n,Pl=o}}else z(this,function(n){var o=n[i][r];(o.event||(o.event=ra.dispatch("start","end","interrupt"))).on(t,e)});return this},kl.transition=function(){for(var t,e,r,i,n=this.id,o=++Dl,a=this.namespace,s=[],l=0,u=this.length;u>l;l++){s.push(t=[]);for(var e=this[l],c=0,h=e.length;h>c;c++)(r=e[c])&&(i=r[a][n],Ho(r,c,a,o,{time:i.time,ease:i.ease,delay:i.delay+i.duration,duration:i.duration})),t.push(r)}return jo(s,a,o)},ra.svg.axis=function(){function t(t){t.each(function(){var t,u=ra.select(this),c=this.__chart__||r,h=this.__chart__=r.copy(),f=null==l?h.ticks?h.ticks.apply(h,s):h.domain():l,d=null==e?h.tickFormat?h.tickFormat.apply(h,s):v:e,p=u.selectAll(".tick").data(f,h),g=p.enter().insert("g",".domain").attr("class","tick").style("opacity",Aa),m=ra.transition(p.exit()).style("opacity",Aa).remove(),y=ra.transition(p.order()).style("opacity",1),b=Math.max(n,0)+a,E=Fn(h),w=u.selectAll(".domain").data([0]),_=(w.enter().append("path").attr("class","domain"),ra.transition(w));g.append("line"),g.append("text");var x,S,T,M,L=g.select("line"),A=y.select("line"),N=p.select("text").text(d),C=g.select("text"),R=y.select("text"),P="top"===i||"left"===i?-1:1;if("bottom"===i||"top"===i?(t=$o,x="x",T="y",S="x2",M="y2",N.attr("dy",0>P?"0em":".71em").style("text-anchor","middle"),_.attr("d","M"+E[0]+","+P*o+"V0H"+E[1]+"V"+P*o)):(t=Yo,x="y",T="x",S="y2",M="x2",N.attr("dy",".32em").style("text-anchor",0>P?"end":"start"),_.attr("d","M"+P*o+","+E[0]+"H0V"+E[1]+"H"+P*o)),L.attr(M,P*n),C.attr(T,P*b),A.attr(S,0).attr(M,P*n),R.attr(x,0).attr(T,P*b),h.rangeBand){var O=h,I=O.rangeBand()/2;c=h=function(t){return O(t)+I}}else c.rangeBand?c=h:m.call(t,h,c);g.call(t,c,h),y.call(t,h,h)})}var e,r=ra.scale.linear(),i=Vl,n=6,o=6,a=3,s=[10],l=null;return t.scale=function(e){return arguments.length?(r=e,t):r},t.orient=function(e){return arguments.length?(i=e in Fl?e+"":Vl,t):i},t.ticks=function(){return arguments.length?(s=arguments,t):s},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(r){return arguments.length?(e=r,t):e},t.tickSize=function(e){var r=arguments.length;return r?(n=+e,o=+arguments[r-1],t):n},t.innerTickSize=function(e){return arguments.length?(n=+e,t):n},t.outerTickSize=function(e){return arguments.length?(o=+e,t):o},t.tickPadding=function(e){return arguments.length?(a=+e,t):a},t.tickSubdivide=function(){return arguments.length&&t},t};var Vl="bottom",Fl={top:1,right:1,bottom:1,left:1};ra.svg.brush=function(){function t(e){e.each(function(){var e=ra.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",o).on("touchstart.brush",o),a=e.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=e.selectAll(".resize").data(g,v);s.exit().remove(),s.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Gl[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",t.empty()?"none":null);var l,h=ra.transition(e),f=ra.transition(a);u&&(l=Fn(u),f.attr("x",l[0]).attr("width",l[1]-l[0]),i(h)),c&&(l=Fn(c),f.attr("y",l[0]).attr("height",l[1]-l[0]),n(h)),r(h)})}function r(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+h[+/e$/.test(t)]+","+f[+/^s/.test(t)]+")"})}function i(t){t.select(".extent").attr("x",h[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1]-h[0])}function n(t){t.select(".extent").attr("y",f[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1]-f[0])}function o(){function o(){32==ra.event.keyCode&&(N||(b=null,R[0]-=h[1],R[1]-=f[1],N=2),S())}function g(){32==ra.event.keyCode&&2==N&&(R[0]+=h[1],R[1]+=f[1],N=0,S())}function m(){var t=ra.mouse(w),e=!1;E&&(t[0]+=E[0],t[1]+=E[1]),N||(ra.event.altKey?(b||(b=[(h[0]+h[1])/2,(f[0]+f[1])/2]),R[0]=h[+(t[0]<b[0])],R[1]=f[+(t[1]<b[1])]):b=null),L&&y(t,u,0)&&(i(T),e=!0),A&&y(t,c,1)&&(n(T),e=!0),e&&(r(T),x({type:"brush",mode:N?"move":"resize"}))}function y(t,e,r){var i,n,o=Fn(e),l=o[0],u=o[1],c=R[r],g=r?f:h,m=g[1]-g[0];return N&&(l-=c,u-=m+c),i=(r?p:d)?Math.max(l,Math.min(u,t[r])):t[r],N?n=(i+=c)+m:(b&&(c=Math.max(l,Math.min(u,2*b[r]-i))),i>c?(n=i,i=c):n=c),g[0]!=i||g[1]!=n?(r?s=null:a=null,g[0]=i,g[1]=n,!0):void 0}function v(){m(),T.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),ra.select("body").style("cursor",null),P.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),C(),x({type:"brushend"})}var b,E,w=this,_=ra.select(ra.event.target),x=l.of(w,arguments),T=ra.select(w),M=_.datum(),L=!/^(n|s)$/.test(M)&&u,A=!/^(e|w)$/.test(M)&&c,N=_.classed("extent"),C=$(w),R=ra.mouse(w),P=ra.select(e(w)).on("keydown.brush",o).on("keyup.brush",g);if(ra.event.changedTouches?P.on("touchmove.brush",m).on("touchend.brush",v):P.on("mousemove.brush",m).on("mouseup.brush",v),T.interrupt().selectAll("*").interrupt(),N)R[0]=h[0]-R[0],R[1]=f[0]-R[1];else if(M){var O=+/w$/.test(M),I=+/^n/.test(M);E=[h[1-O]-R[0],f[1-I]-R[1]],R[0]=h[O],R[1]=f[I]}else ra.event.altKey&&(b=R.slice());T.style("pointer-events","none").selectAll(".resize").style("display",null),ra.select("body").style("cursor",_.style("cursor")),x({type:"brushstart"}),m()}var a,s,l=M(t,"brushstart","brush","brushend"),u=null,c=null,h=[0,0],f=[0,0],d=!0,p=!0,g=Bl[0];return t.event=function(t){t.each(function(){var t=l.of(this,arguments),e={x:h,y:f,i:a,j:s},r=this.__chart__||e;this.__chart__=e,Pl?ra.select(this).transition().each("start.brush",function(){a=r.i,s=r.j,h=r.x,f=r.y,t({type:"brushstart"})}).tween("brush:brush",function(){var r=vi(h,e.x),i=vi(f,e.y);return a=s=null,function(n){h=e.x=r(n),f=e.y=i(n),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){a=e.i,s=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(u=e,g=Bl[!u<<1|!c],t):u},t.y=function(e){return arguments.length?(c=e,g=Bl[!u<<1|!c],t):c},t.clamp=function(e){return arguments.length?(u&&c?(d=!!e[0],p=!!e[1]):u?d=!!e:c&&(p=!!e),t):u&&c?[d,p]:u?d:c?p:null},t.extent=function(e){var r,i,n,o,l;return arguments.length?(u&&(r=e[0],i=e[1],c&&(r=r[0],i=i[0]),a=[r,i],u.invert&&(r=u(r),i=u(i)),r>i&&(l=r,r=i,i=l),(r!=h[0]||i!=h[1])&&(h=[r,i])),c&&(n=e[0],o=e[1],u&&(n=n[1],o=o[1]),s=[n,o],c.invert&&(n=c(n),o=c(o)),n>o&&(l=n,n=o,o=l),(n!=f[0]||o!=f[1])&&(f=[n,o])),t):(u&&(a?(r=a[0],i=a[1]):(r=h[0],i=h[1],u.invert&&(r=u.invert(r),i=u.invert(i)),r>i&&(l=r,r=i,i=l))),c&&(s?(n=s[0],o=s[1]):(n=f[0],o=f[1],c.invert&&(n=c.invert(n),o=c.invert(o)),n>o&&(l=n,n=o,o=l))),u&&c?[[r,n],[i,o]]:u?[r,i]:c&&[n,o])},t.clear=function(){return t.empty()||(h=[0,0],f=[0,0],a=s=null),t},t.empty=function(){return!!u&&h[0]==h[1]||!!c&&f[0]==f[1]},ra.rebind(t,l,"on")};var Gl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Bl=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Wl=as.format=fs.timeFormat,Ul=Wl.utc,zl=Ul("%Y-%m-%dT%H:%M:%S.%LZ");Wl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Xo:zl,Xo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Xo.toString=zl.toString,as.second=Gt(function(t){return new ss(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),as.seconds=as.second.range,as.seconds.utc=as.second.utc.range,as.minute=Gt(function(t){return new ss(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),as.minutes=as.minute.range,as.minutes.utc=as.minute.utc.range,as.hour=Gt(function(t){var e=t.getTimezoneOffset()/60;return new ss(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),as.hours=as.hour.range,as.hours.utc=as.hour.utc.range,as.month=Gt(function(t){return t=as.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),as.months=as.month.range,as.months.utc=as.month.utc.range;var jl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Kl=[[as.second,1],[as.second,5],[as.second,15],[as.second,30],[as.minute,1],[as.minute,5],[as.minute,15],[as.minute,30],[as.hour,1],[as.hour,3],[as.hour,6],[as.hour,12],[as.day,1],[as.day,2],[as.week,1],[as.month,1],[as.month,3],[as.year,1]],ql=Wl.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Ae]]),Zl={range:function(t,e,r){return ra.range(Math.ceil(t/r)*r,+e,r).map(Qo)},floor:v,ceil:v};Kl.year=as.year,as.scale=function(){return Jo(ra.scale.linear(),Kl,ql)};var Hl=Kl.map(function(t){return[t[0].utc,t[1]]}),$l=Ul.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Ae]]);Hl.year=as.year.utc,as.scale.utc=function(){return Jo(ra.scale.linear(),Hl,$l)},ra.text=Lt(function(t){return t.responseText}),ra.json=function(t,e){return At(t,"application/json",ta,e)},ra.html=function(t,e){return At(t,"text/html",ea,e)},ra.xml=Lt(function(t){return t.responseXML}),"function"==typeof define&&define.amd?define("d3",ra):"object"==typeof module&&module.exports&&(module.exports=ra),this.d3=ra}(),function(t){"use strict";function e(t,e,n,o){var a;a=e?new r(t,0,n,o):new i(t,0,n,o),this.root=a}function r(t,e,r,i){this._bounds=t,this.children=[],this.nodes=[],i&&(this._maxChildren=i),r&&(this._maxDepth=r),e&&(this._depth=e)}function i(t,e,i,n){r.call(this,t,e,i,n),this._stuckChildren=[]}e.prototype.root=null,e.prototype.insert=function(t){if(t instanceof Array){var e,r=t.length;for(e=0;e<r;e++)this.root.insert(t[e])}else this.root.insert(t)},e.prototype.clear=function(){this.root.clear()},e.prototype.retrieve=function(t){var e=this.root.retrieve(t).slice(0);return e},r.prototype.nodes=null,r.prototype._classConstructor=r,r.prototype.children=null,r.prototype._bounds=null,r.prototype._depth=0,r.prototype._maxChildren=4,r.prototype._maxDepth=4,r.TOP_LEFT=0,r.TOP_RIGHT=1,r.BOTTOM_LEFT=2,r.BOTTOM_RIGHT=3,r.prototype.insert=function(t){if(this.nodes.length){var e=this._findIndex(t);return void this.nodes[e].insert(t)}this.children.push(t);var r=this.children.length;if(!(this._depth>=this._maxDepth)&&r>this._maxChildren){this.subdivide();var i;for(i=0;i<r;i++)this.insert(this.children[i]);this.children.length=0}},r.prototype.retrieve=function(t){if(this.nodes.length){var e=this._findIndex(t);return this.nodes[e].retrieve(t)}return this.children},r.prototype._findIndex=function(t){var e=this._bounds,i=t.x<=e.x+e.width/2,n=t.y<=e.y+e.height/2,o=r.TOP_LEFT;return i?n||(o=r.BOTTOM_LEFT):o=n?r.TOP_RIGHT:r.BOTTOM_RIGHT,o},r.prototype.subdivide=function(){var t=this._depth+1,e=this._bounds.x,i=this._bounds.y,n=this._bounds.width/2,o=this._bounds.height/2,a=e+n,s=i+o;this.nodes[r.TOP_LEFT]=new this._classConstructor({x:e,y:i,width:n,height:o},t,this._maxDepth,this._maxChildren),this.nodes[r.TOP_RIGHT]=new this._classConstructor({x:a,y:i,width:n,height:o},t,this._maxDepth,this._maxChildren),this.nodes[r.BOTTOM_LEFT]=new this._classConstructor({x:e,y:s,width:n,height:o},t,this._maxDepth,this._maxChildren),this.nodes[r.BOTTOM_RIGHT]=new this._classConstructor({x:a,y:s,width:n,height:o},t,this._maxDepth,this._maxChildren)},r.prototype.clear=function(){this.children.length=0;var t,e=this.nodes.length;for(t=0;t<e;t++)this.nodes[t].clear();this.nodes.length=0},i.prototype=new r,i.prototype._classConstructor=i,i.prototype._stuckChildren=null,i.prototype._out=[],i.prototype.insert=function(t){if(this.nodes.length){var e=this._findIndex(t),r=this.nodes[e];return void(t.x>=r._bounds.x&&t.x+t.width<=r._bounds.x+r._bounds.width&&t.y>=r._bounds.y&&t.y+t.height<=r._bounds.y+r._bounds.height?this.nodes[e].insert(t):this._stuckChildren.push(t))}this.children.push(t);var i=this.children.length;if(!(this._depth>=this._maxDepth)&&i>this._maxChildren){this.subdivide();var n;for(n=0;n<i;n++)this.insert(this.children[n]);this.children.length=0}},i.prototype.getChildren=function(){return this.children.concat(this._stuckChildren)},i.prototype.retrieve=function(t){var e=this._out;if(e.length=0,this.nodes.length){var i=this._findIndex(t),n=this.nodes[i];t.x>=n._bounds.x&&t.x+t.width<=n._bounds.x+n._bounds.width&&t.y>=n._bounds.y&&t.y+t.height<=n._bounds.y+n._bounds.height?e.push.apply(e,this.nodes[i].retrieve(t)):(t.x<=this.nodes[r.TOP_RIGHT]._bounds.x&&(t.y<=this.nodes[r.BOTTOM_LEFT]._bounds.y&&e.push.apply(e,this.nodes[r.TOP_LEFT].getAllContent()),t.y+t.height>this.nodes[r.BOTTOM_LEFT]._bounds.y&&e.push.apply(e,this.nodes[r.BOTTOM_LEFT].getAllContent())),t.x+t.width>this.nodes[r.TOP_RIGHT]._bounds.x&&(t.y<=this.nodes[r.BOTTOM_RIGHT]._bounds.y&&e.push.apply(e,this.nodes[r.TOP_RIGHT].getAllContent()),t.y+t.height>this.nodes[r.BOTTOM_RIGHT]._bounds.y&&e.push.apply(e,this.nodes[r.BOTTOM_RIGHT].getAllContent())))}return e.push.apply(e,this._stuckChildren),e.push.apply(e,this.children),e},i.prototype.getAllContent=function(){var t=this._out;if(this.nodes.length){var e;for(e=0;e<this.nodes.length;e++)this.nodes[e].getAllContent()}return t.push.apply(t,this._stuckChildren),t.push.apply(t,this.children),t},i.prototype.clear=function(){this._stuckChildren.length=0,this.children.length=0;var t=this.nodes.length;if(t){var e;for(e=0;e<t;e++)this.nodes[e].clear();this.nodes.length=0}},t.QuadTree=e}(window),define("QuadTree",function(){}),function(){function Y(){return function(){}}var aa="\n//# sourceURL=",ba='<script type="text/javascript" src="',b="American Samoa",ca="Antigua and Barbuda",k="Bolivia",p="Bosna i Hercegovina",q="Botswana",da="British Virgin Islands",ea="Cayman Islands",fa="Christmas Island",ga="Falkland Islands",r="Ghana",ha="Guinée équatoriale",ia="Guyane française",t="Honduras",u="Indonesia",v="Itoophiyaa",ja="Kalaallit Nunaat",w="Kiribati",ka="LocaleNameConstants",la="Luxembourg",ma="Madagascar",na="Marshall Islands",x="Micronesia",oa="Moldova, Republica",pa="Nederlandse Antillen",qa="New Zealand",y="Nigeria",ra="Norfolk Island",sa="Northern Mariana Islands",ta="Nouvelle-Calédonie",z="Papua New Guinea",ua="Paraguay",va="Philippines",wa="Polynésie française",xa="Puerto Rico",za="República Dominicana",A="Rwanda",Aa="Rywvaneth Unys",Ba="République centrafricaine",Ca="République démocratique du Congo",Da="Saint Kitts and Nevis",Ea="Saint Vincent and the Grenadines",Fa="Saint-Pierre-et-Miquelon",Ga="Serbia and Montenegro",Ha="Seychelles",Ia="Slovenská republika",Ja="Solomon Islands",B="South Africa",Ka="Svalbard og Jan Mayen",La="Swaziland",Ma="São Tomé e Príncipe",C="Sénégal",Na="Tanzania",Oa="Timor Leste",E="Tokelau",Pa="Turks and Caicos Islands",F="Tuvalu",G="Türkiye",Qa="U.S. Virgin Islands",Ra="United Kingdom",Sa="United States",Ta="United States Minor Outlying Islands",Ua="Unknown or Invalid Region",H="Vanuatu",Va="Wallis-et-Futuna",Wa="annotatedtimeline",I="array",J="browserchart",K="complete",L="corechart",M="dygraph",N="function",Xa="google.charts.load",O="imagechart",P="object",Ya="text/javascript",Q="ui",R="ui_base",S="webfontloader",Za="{css_prefix}/{cssFile}",$a="{prefix}",ab="{prefix}/{version}/third_party/{package}",bb="{version}",cb="Česká republika",db="Беларусь",eb="Кыргызстан",fb="монгольский",gb="Հայաստանի Հանրապետութիւն",U="افغانستان",hb="الامارات العربية المتحدة",ib="الصحراء الغربية",jb="المملكة العربية السعودية",kb="الولايات المتحدة الأمريكية",lb="جزر القمر",V="پاکستان",W="भारत",X="ኢትዮጵያ",mb="조선 민주주의 인민 공화국",Z=Z||{};Z.global=this,Z.O=function(t){return void 0!==t},Z.xa=function(t,e,r){t=t.split("."),r=r||Z.global,t[0]in r||!r.execScript||r.execScript("var "+t[0]);for(var i;t.length&&(i=t.shift());)!t.length&&Z.O(e)?r[i]=e:r=r[i]?r[i]:r[i]={}},Z.De=function(t,e){Z.xa(t,e)},Z.G=!0,Z.Jd="en",Z.oa=!0,Z.gc=!1,Z.Qb=!Z.G,Z.Ya=!1,Z.Lf=function(t){if(Z.Ka())throw Error("goog.provide can not be used within a goog.module.");Z.gb(t)},Z.gb=function(t,e){Z.xa(t,e)},Z.qc=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,Z.Oa=function(t){if(!Z.h(t)||!t||-1==t.search(Z.qc))throw Error("Invalid module identifier");if(!Z.Ka())throw Error("Module "+t+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(Z.l.Pa)throw Error("goog.module may only be called once per module.");Z.l.Pa=t},Z.Oa.get=Y(),Z.Oa.Ne=Y(),Z.l=null,Z.Ka=function(){return null!=Z.l},Z.Oa.ua=function(){Z.l.ua=!0},Z.eg=function(t){if(Z.Qb)throw t=t||"",Error("Importing test-only code into non-debug environment"+(t?": "+t:"."))},Z.Je=Y(),Z.Ea=function(t){t=t.split(".");for(var e,r=Z.global;e=t.shift();){if(!Z.Nc(r[e]))return null;r=r[e]}return r},Z.Ye=function(t,e){e=e||Z.global;for(var r in t)e[r]=t[r]},Z.Pd=function(t,e,r,i){if(Z.Wa){var n;t=t.replace(/\\/g,"/");var o=Z.j;i&&"boolean"!=typeof i||(i=i?{module:"goog"}:{});for(var a=0;n=e[a];a++)o.T[n]=t,o.La[t]=i;for(i=0;e=r[i];i++)t in o.F||(o.F[t]={}),o.F[t][e]=!0}},Z.Eg=!1,Z.Gd=!0,Z.$c=function(t){Z.global.console&&Z.global.console.error(t)},Z.Zf=Y(),Z.B="",Z.Gf=Y(),Z.Od=function(){throw Error("unimplemented abstract method")},Z.Qd=function(t){t.Me=function(){return t.ub?t.ub:(Z.G&&(Z.vb[Z.vb.length]=t),t.ub=new t)}},Z.vb=[],Z.Xb=!0,Z.ec=Z.G,Z.Zc={},Z.Wa=!1,Z.$a="detect",Z.mc="transpile.js",Z.Wa&&(Z.j={La:{},T:{},F:{},Ib:{},Va:{},X:{}},Z.sb=function(){var t=Z.global.document;return null!=t&&"write"in t},Z.Fc=function(){if(Z.O(Z.global.Mb))Z.B=Z.global.Mb;else if(Z.sb())for(var t=Z.global.document.getElementsByTagName("SCRIPT"),e=t.length-1;0<=e;--e){var r=t[e].src,i=r.lastIndexOf("?"),i=-1==i?r.length:i;if("base.js"==r.substr(i-7,7)){Z.B=r.substr(0,i-7);break}}},Z.Ga=function(t,e){(Z.global.Ad||Z.xd)(t,e)&&(Z.j.Va[t]=!0)},Z.Wb=!(Z.global.atob||!Z.global.document||!Z.global.document.all),Z.Lc=function(t,e,r){Z.Ga("",'goog.retrieveAndExec_("'+t+'", '+e+", "+r+");")},Z.Ra=[],Z.Gg=function(t,e){return Z.Xb&&Z.O(Z.global.JSON)?"goog.loadModule("+Z.global.JSON.stringify(e+aa+t+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+e+"\n;return exports});\n//# sourceURL="+t+"\n"},Z.Yc=function(){var t=Z.Ra.length;if(0<t){var e=Z.Ra;Z.Ra=[];for(var r=0;r<t;r++)Z.Ab(e[r])}},Z.Af=function(t){Z.wb(t)&&Z.rc(t)&&Z.Ab(Z.B+Z.Fa(t))},Z.wb=function(t){var e=(t=Z.Fa(t))&&Z.j.La[t]||{};return!(!t||"goog"!=e.module&&!Z.Bb(e.lang))&&Z.B+t in Z.j.X},Z.rc=function(t){if((t=Z.Fa(t))&&t in Z.j.F)for(var e in Z.j.F[t])if(!Z.Rc(e)&&!Z.wb(e))return!1;return!0},Z.Ab=function(t){if(t in Z.j.X){var e=Z.j.X[t];delete Z.j.X[t],Z.Kc(e)}},Z.zf=Y(),Z.wd=function(t){Z.global.document.write(ba+t+'"></script>')},Z.tc=function(t){var e=Z.global.document,r=e.createElement("script");r.type=Ya,r.src=t,r.defer=!1,r.async=!1,e.head.appendChild(r)},Z.xd=function(t,e){if(Z.sb()){var r=Z.global.document;if(!Z.Ya&&r.readyState==K){if(/\bdeps.js$/.test(t))return!1;throw Error('Cannot write "'+t+'" after document load')}return void 0===e?Z.Wb?(e=" onreadystatechange='goog.onScriptLoad_(this, "+ ++Z.yb+")' ",r.write(ba+t+'"'+e+"></script>")):Z.Ya?Z.tc(t):Z.wd(t):r.write('<script type="text/javascript">'+e+"</script>"),!0}return!1},Z.Bb=function(a){if("always"==Z.$a)return!0;if("never"==Z.$a)return!1;if(!Z.M){Z.M={es5:!0,es6:!0,"es6-impl":!0};try{Z.M.es5=eval("[1,].length!=1"),eval('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')&&(Z.M.es6=!1,Z.M["es6-impl"]=!1)}catch(t){}}return!!Z.M[a]},Z.M=null,Z.yb=0,Z.If=function(t,e){return t.readyState==K&&Z.yb==e&&Z.Yc(),!0},Z.Hg=function(t){function e(t){if(!(t in n.Va||t in n.Ib)){if(n.Ib[t]=!0,t in n.F)for(var o in n.F[t])if(!Z.Rc(o)){if(!(o in n.T))throw Error("Undefined nameToPath for "+o);e(n.T[o])}t in i||(i[t]=!0,r.push(t))}}var r=[],i={},n=Z.j;for(e(t),t=0;t<r.length;t++){var o=r[t];Z.j.Va[o]=!0}var a=Z.l;for(Z.l=null,t=0;t<r.length;t++){if(!(o=r[t]))throw Z.l=a,Error("Undefined script input");var s=n.La[o]||{},l=Z.Bb(s.lang);"goog"==s.module||l?Z.Lc(Z.B+o,"goog"==s.module,l):Z.Ga(Z.B+o)}Z.l=a},Z.Fa=function(t){return t in Z.j.T?Z.j.T[t]:null},Z.Fc(),Z.global.Bd||Z.Ga(Z.B+"deps.js")),Z.yf=function(t){var e=Z.l;try{Z.l={Pa:void 0,ua:!1};var r;if(Z.xb(t))r=t.call(void 0,{});else{if(!Z.h(t))throw Error("Invalid module definition");r=Z.Wc.call(void 0,t)}var i=Z.l.Pa;if(!Z.h(i)||!i)throw Error('Invalid module name "'+i+'"');Z.l.ua?Z.gb(i,r):Z.ec&&Object.seal&&Z.P(r)&&Object.seal(r),Z.Zc[i]=r}finally{Z.l=e}},Z.Wc=function(a){return eval(a),{}},Z.Df=function(t){t=t.split("/");for(var e=0;e<t.length;)"."==t[e]?t.splice(e,1):e&&".."==t[e]&&t[e-1]&&".."!=t[e-1]?t.splice(--e,2):e++;return t.join("/")},Z.Vc=function(t){if(Z.global.Ob)return Z.global.Ob(t);try{var e=new Z.global.XMLHttpRequest;return e.open("get",t,!1),e.send(),0==e.status||200==e.status?e.responseText:null}catch(t){return null}},Z.$f=Y(),Z.zg=function(a,c){var d=Z.global.$jscomp;d||(Z.global.$jscomp=d={});var e=d.Fb;if(!e){var f=Z.B+Z.mc,g=Z.Vc(f);g&&(eval(g+aa+f),d=Z.global.$jscomp,e=d.Fb)}if(!e)var h=" requires transpilation but no transpiler was found.",h=h+' Please add "//javascript/closure:transpiler" as a data dependency to ensure it is included.',e=d.Fb=function(t,e){return Z.$c(e+h),t};return e(a,c)},Z.u=function(t){var e=typeof t;if(e==P){if(!t)return"null";if(t instanceof Array)return I;if(t instanceof Object)return e;var r=Object.prototype.toString.call(t);if("[object Window]"==r)return P;if("[object Array]"==r||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return I;if("[object Function]"==r||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return N}else if(e==N&&"undefined"==typeof t.call)return P;return e},Z.pf=function(t){return null===t},Z.Nc=function(t){return null!=t},Z.isArray=function(t){return Z.u(t)==I},Z.Ia=function(t){var e=Z.u(t);return e==I||e==P&&"number"==typeof t.length},Z.kf=function(t){return Z.P(t)&&typeof t.getFullYear==N},Z.h=function(t){return"string"==typeof t},Z.Mc=function(t){return"boolean"==typeof t},Z.Qc=function(t){return"number"==typeof t;
},Z.xb=function(t){return Z.u(t)==N},Z.P=function(t){var e=typeof t;return e==P&&null!=t||e==N},Z.qb=function(t){return t[Z.D]||(t[Z.D]=++Z.rd)},Z.Ze=function(t){return!!t[Z.D]},Z.hd=function(t){null!==t&&"removeAttribute"in t&&t.removeAttribute(Z.D);try{delete t[Z.D]}catch(t){}},Z.D="closure_uid_"+(1e9*Math.random()>>>0),Z.rd=0,Z.Le=Z.qb,Z.Wf=Z.hd,Z.yc=function(t){var e=Z.u(t);if(e==P||e==I){if(t.clone)return t.clone();var r,e=e==I?[]:{};for(r in t)e[r]=Z.yc(t[r]);return e}return t},Z.wc=function(t,e,r){return t.call.apply(t.bind,arguments)},Z.vc=function(t,e,r){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),t.apply(e,r)}}return function(){return t.apply(e,arguments)}},Z.bind=function(t,e,r){return Z.bind=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Z.wc:Z.vc,Z.bind.apply(null,arguments)},Z.dd=function(t,e){var r=Array.prototype.slice.call(arguments,1);return function(){var e=r.slice();return e.push.apply(e,arguments),t.apply(this,e)}},Z.Bf=function(t,e){for(var r in e)t[r]=e[r]},Z.now=Z.oa&&Date.now||function(){return+new Date},Z.Kc=function(t){if(Z.global.execScript)Z.global.execScript(t,"JavaScript");else{if(!Z.global.eval)throw Error("goog.globalEval not available");if(null==Z.Y)if(Z.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof Z.global._evalTest_){try{delete Z.global._evalTest_}catch(t){}Z.Y=!0}else Z.Y=!1;if(Z.Y)Z.global.eval(t);else{var e=Z.global.document,r=e.createElement("SCRIPT");r.type=Ya,r.defer=!1,r.appendChild(e.createTextNode(t)),e.body.appendChild(r),e.body.removeChild(r)}}},Z.Y=null,Z.Ke=function(t,e){function r(t){t=t.split("-");for(var e=[],r=0;r<t.length;r++)e.push(i(t[r]));return e.join("-")}function i(t){return Z.hb[t]||t}if("."==String(t).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+t);var n;return n=Z.hb?"BY_WHOLE"==Z.Bc?i:r:function(t){return t},t=e?t+"-"+n(e):n(t),Z.global.Nb?Z.global.Nb(t):t},Z.ag=function(t,e){Z.hb=t,Z.Bc=e},Z.Qe=function(t,e){return e&&(t=t.replace(/\{\$([^}]+)}/g,function(t,r){return null!=e&&r in e?e[r]:t})),t},Z.Re=function(t){return t},Z.ya=function(t,e){Z.xa(t,e,void 0)},Z.He=function(t,e,r){t[e]=r},Z.Ha=function(t,e){function r(){}r.prototype=e.prototype,t.ma=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.uc=function(t,r,i){for(var n=Array(arguments.length-2),o=2;o<arguments.length;o++)n[o-2]=arguments[o];return e.prototype[r].apply(t,n)}},Z.uc=function(t,e,r){var i=arguments.callee.caller;if(Z.gc||Z.G&&!i)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(i.ma){for(var n=Array(arguments.length-1),o=1;o<arguments.length;o++)n[o-1]=arguments[o];return i.ma.constructor.apply(t,n)}for(n=Array(arguments.length-2),o=2;o<arguments.length;o++)n[o-2]=arguments[o];for(var o=!1,a=t.constructor;a;a=a.ma&&a.ma.constructor)if(a.prototype[e]===i)o=!0;else if(o)return a.prototype[e].apply(t,n);if(t[e]===i)return t.constructor.prototype[e].apply(t,n);throw Error("goog.base called from a method of one name to a method of a different name")},Z.scope=function(t){if(Z.Ka())throw Error("goog.scope is not supported within a goog.module.");t.call(Z.global)},Z.o=function(t,e){var r=e.constructor,i=e.md;return r&&r!=Object.prototype.constructor||(r=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),r=Z.o.zc(r,t),t&&Z.Ha(r,t),delete e.constructor,delete e.md,Z.o.bb(r.prototype,e),null!=i&&(i instanceof Function?i(r):Z.o.bb(r,i)),r},Z.o.dc=Z.G,Z.o.zc=function(t,e){function r(){var e=t.apply(this,arguments)||this;return e[Z.D]=e[Z.D],this.constructor===r&&i&&Object.seal instanceof Function&&Object.seal(e),e}if(!Z.o.dc)return t;var i=!Z.o.Sc(e);return r},Z.o.Sc=function(t){return t&&t.prototype&&t.prototype[Z.nc]},Z.o.Za="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Z.o.bb=function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);for(var i=0;i<Z.o.Za.length;i++)r=Z.o.Za[i],Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},Z.qg=Y(),Z.nc="goog_defineClass_legacy_unsealable",Z.debug={},Z.debug.Error=function(t){if(Error.captureStackTrace)Error.captureStackTrace(this,Z.debug.Error);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))},Z.Ha(Z.debug.Error,Error),Z.debug.Error.prototype.name="CustomError",Z.ib={},Z.ib.bc={Rb:1,yd:2,Nd:3,zd:4,Id:5,Hd:6,Md:7,Cd:8,DOCUMENT:9,Fd:10,Ed:11,Kd:12},Z.b={},Z.b.Xa=!1,Z.b.Tb=!1,Z.b.pc={$b:" "},Z.b.startsWith=function(t,e){return 0==t.lastIndexOf(e,0)},Z.b.endsWith=function(t,e){var r=t.length-e.length;return 0<=r&&t.indexOf(e,r)==r},Z.b.re=function(t,e){return 0==Z.b.fb(e,t.substr(0,e.length))},Z.b.pe=function(t,e){return 0==Z.b.fb(e,t.substr(t.length-e.length,e.length))},Z.b.qe=function(t,e){return t.toLowerCase()==e.toLowerCase()},Z.b.od=function(t,e){for(var r=t.split("%s"),i="",n=Array.prototype.slice.call(arguments,1);n.length&&1<r.length;)i+=r.shift()+n.shift();return i+r.join("%s")},Z.b.we=function(t){return t.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},Z.b.Ja=function(t){return/^[\s\xa0]*$/.test(t)},Z.b.mf=function(t){return 0==t.length},Z.b.Oc=Z.b.Ja,Z.b.Pc=function(t){return Z.b.Ja(Z.b.ad(t))},Z.b.lf=Z.b.Pc,Z.b.jf=function(t){return!/[^\t\n\r ]/.test(t)},Z.b.gf=function(t){return!/[^a-zA-Z]/.test(t)},Z.b.qf=function(t){return!/[^0-9]/.test(t)},Z.b.hf=function(t){return!/[^a-zA-Z0-9]/.test(t)},Z.b.tf=function(t){return" "==t},Z.b.uf=function(t){return 1==t.length&&" "<=t&&"~">=t||""<=t&&"�">=t},Z.b.og=function(t){return t.replace(/(\r\n|\r|\n)+/g," ")},Z.b.le=function(t){return t.replace(/(\r\n|\r|\n)/g,"\n")},Z.b.Ff=function(t){return t.replace(/\xa0|\s/g," ")},Z.b.Ef=function(t){return t.replace(/\xa0|[ \t]+/g," ")},Z.b.ue=function(t){return t.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")},Z.b.trim=Z.oa&&String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Z.b.trimLeft=function(t){return t.replace(/^[\s\xa0]+/,"")},Z.b.trimRight=function(t){return t.replace(/[\s\xa0]+$/,"")},Z.b.fb=function(t,e){return t=String(t).toLowerCase(),e=String(e).toLowerCase(),t<e?-1:t==e?0:1},Z.b.Db=function(t,e,r){if(t==e)return 0;if(!t)return-1;if(!e)return 1;for(var i=t.toLowerCase().match(r),n=e.toLowerCase().match(r),o=Math.min(i.length,n.length),a=0;a<o;a++){r=i[a];var s=n[a];if(r!=s)return t=parseInt(r,10),!isNaN(t)&&(e=parseInt(s,10),!isNaN(e)&&t-e)?t-e:r<s?-1:1}return i.length!=n.length?i.length-n.length:t<e?-1:1},Z.b.df=function(t,e){return Z.b.Db(t,e,/\d+|\D+/g)},Z.b.Ic=function(t,e){return Z.b.Db(t,e,/\d+|\.\d+|\D+/g)},Z.b.Hf=Z.b.Ic,Z.b.Dg=function(t){return encodeURIComponent(String(t))},Z.b.Cg=function(t){return decodeURIComponent(t.replace(/\+/g," "))},Z.b.bd=function(t,e){return t.replace(/(\r\n|\r|\n)/g,e?"<br />":"<br>")},Z.b.rb=function(t){return Z.b.Kb.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(Z.b.Lb,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Z.b.Zb,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(Z.b.Ub,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(Z.b.cc,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(Z.b.fc,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(Z.b.ac,"&#0;")),Z.b.Xa&&-1!=t.indexOf("e")&&(t=t.replace(Z.b.Sb,"&#101;")),t):t},Z.b.Lb=/&/g,Z.b.Zb=/</g,Z.b.Ub=/>/g,Z.b.cc=/"/g,Z.b.fc=/'/g,Z.b.ac=/\x00/g,Z.b.Sb=/e/g,Z.b.Kb=Z.b.Xa?/[\x00&<>"'e]/:/[\x00&<>"']/,Z.b.Gb=function(t){return Z.b.contains(t,"&")?!Z.b.Tb&&"document"in Z.global?Z.b.Hb(t):Z.b.td(t):t},Z.b.Bg=function(t,e){return Z.b.contains(t,"&")?Z.b.Hb(t,e):t},Z.b.Hb=function(t,e){var r,i={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'};return r=e?e.createElement("div"):Z.global.document.createElement("div"),t.replace(Z.b.Vb,function(t,e){var n=i[t];return n?n:("#"==e.charAt(0)&&(e=Number("0"+e.substr(1)),isNaN(e)||(n=String.fromCharCode(e))),n||(r.innerHTML=t+" ",n=r.firstChild.nodeValue.slice(0,-1)),i[t]=n)})},Z.b.td=function(t){return t.replace(/&([^;]+);/g,function(t,e){switch(e){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:return"#"!=e.charAt(0)||(e=Number("0"+e.substr(1)),isNaN(e))?t:String.fromCharCode(e)}})},Z.b.Vb=/&([^;\s<&]+);?/g,Z.b.Fg=function(t,e){return Z.b.bd(t.replace(/  /g," &#160;"),e)},Z.b.Kf=function(t){return t.replace(/(^|[\n ]) /g,"$1"+Z.b.pc.$b)},Z.b.pg=function(t,e){for(var r=e.length,i=0;i<r;i++){var n=1==r?e:e.charAt(i);if(t.charAt(0)==n&&t.charAt(t.length-1)==n)return t.substring(1,t.length-1)}return t},Z.b.truncate=function(t,e,r){return r&&(t=Z.b.Gb(t)),t.length>e&&(t=t.substring(0,e-3)+"..."),r&&(t=Z.b.rb(t)),t},Z.b.Ag=function(t,e,r,i){return r&&(t=Z.b.Gb(t)),i&&t.length>e?(i>e&&(i=e),t=t.substring(0,e-i)+"..."+t.substring(t.length-i)):t.length>e&&(i=Math.floor(e/2),t=t.substring(0,i+e%2)+"..."+t.substring(t.length-i)),r&&(t=Z.b.rb(t)),t},Z.b.Ua={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"<"},Z.b.$={"'":"\\'"},Z.b.quote=function(t){t=String(t);for(var e=['"'],r=0;r<t.length;r++){var i=t.charAt(r),n=i.charCodeAt(0);e[r+1]=Z.b.Ua[i]||(31<n&&127>n?i:Z.b.jb(i))}return e.push('"'),e.join("")},Z.b.Ge=function(t){for(var e=[],r=0;r<t.length;r++)e[r]=Z.b.jb(t.charAt(r));return e.join("")},Z.b.jb=function(t){if(t in Z.b.$)return Z.b.$[t];if(t in Z.b.Ua)return Z.b.$[t]=Z.b.Ua[t];var e,r=t.charCodeAt(0);return 31<r&&127>r?e=t:(256>r?(e="\\x",(16>r||256<r)&&(e+="0")):(e="\\u",4096>r&&(e+="0")),e+=r.toString(16).toUpperCase()),Z.b.$[t]=e},Z.b.contains=function(t,e){return-1!=t.indexOf(e)},Z.b.oe=function(t,e){return Z.b.contains(t.toLowerCase(),e.toLowerCase())},Z.b.Be=function(t,e){return t&&e?t.split(e).length-1:0},Z.b.L=function(t,e,r){var i=t;return 0<=e&&e<t.length&&0<r&&(i=t.substr(0,e)+t.substr(e+r,t.length-e-r)),i},Z.b.remove=function(t,e){return e=new RegExp(Z.b.Sa(e),""),t.replace(e,"")},Z.b.Tf=function(t,e){return e=new RegExp(Z.b.Sa(e),"g"),t.replace(e,"")},Z.b.Sa=function(t){return String(t).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},Z.b.repeat=String.prototype.repeat?function(t,e){return t.repeat(e)}:function(t,e){return Array(e+1).join(t)},Z.b.Jf=function(t,e,r){return t=Z.O(r)?t.toFixed(r):String(t),r=t.indexOf("."),-1==r&&(r=t.length),Z.b.repeat("0",Math.max(0,e-r))+t},Z.b.ad=function(t){return null==t?"":String(t)},Z.b.ke=function(t){return Array.prototype.join.call(arguments,"")},Z.b.Ue=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Z.now()).toString(36)},Z.b.ye=function(t,e){var r=0;t=Z.b.trim(String(t)).split("."),e=Z.b.trim(String(e)).split(".");for(var i=Math.max(t.length,e.length),n=0;0==r&&n<i;n++){var o=t[n]||"",a=e[n]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;r=Z.b.qa(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||Z.b.qa(0==o[2].length,0==a[2].length)||Z.b.qa(o[2],a[2]),o=o[3],a=a[3]}while(0==r)}return r},Z.b.qa=function(t,e){return t<e?-1:t>e?1:0},Z.b.$e=function(t){for(var e=0,r=0;r<t.length;++r)e=31*e+t.charCodeAt(r)>>>0;return e},Z.b.ud=2147483648*Math.random()|0,Z.b.Ce=function(){return"goog_"+Z.b.ud++},Z.b.vg=function(t){var e=Number(t);return 0==e&&Z.b.Ja(t)?NaN:e},Z.b.nf=function(t){return/^[a-z]+([A-Z][a-z]*)*$/.test(t)},Z.b.vf=function(t){return/^([A-Z][a-z]*)+$/.test(t)},Z.b.rg=function(t){return String(t).replace(/\-([a-z])/g,function(t,e){return e.toUpperCase()})},Z.b.xg=function(t){return String(t).replace(/([A-Z])/g,"-$1").toLowerCase()},Z.b.yg=function(t,e){return e=Z.h(e)?Z.b.Sa(e):"\\s",t.replace(new RegExp("(^"+(e?"|["+e+"]+":"")+")([a-z])","g"),function(t,e,r){return e+r.toUpperCase()})},Z.b.me=function(t){return String(t.charAt(0)).toUpperCase()+String(t.substr(1)).toLowerCase()},Z.b.parseInt=function(t){return isFinite(t)&&(t=String(t)),Z.h(t)?/^\s*-?0x/i.test(t)?parseInt(t,16):parseInt(t,10):NaN},Z.b.hg=function(t,e,r){t=t.split(e);for(var i=[];0<r&&t.length;)i.push(t.shift()),r--;return t.length&&i.push(t.join(e)),i},Z.b.xf=function(t,e){if(!e)return t;"string"==typeof e&&(e=[e]);for(var r=-1,i=0;i<e.length;i++)if(""!=e[i]){var n=t.lastIndexOf(e[i]);n>r&&(r=n)}return-1==r?t:t.slice(r+1)},Z.b.Ee=function(t,e){var r=[],i=[];if(t==e)return 0;if(!t.length||!e.length)return Math.max(t.length,e.length);for(var n=0;n<e.length+1;n++)r[n]=n;for(n=0;n<t.length;n++){i[0]=n+1;for(var o=0;o<e.length;o++)i[o+1]=Math.min(i[o]+1,r[o+1]+1,r[o]+Number(t[n]!=e[o]));for(o=0;o<r.length;o++)r[o]=i[o]}return i[e.length]},Z.g={},Z.g.s=Z.G,Z.g.V=function(t,e){e.unshift(t),Z.debug.Error.call(this,Z.b.od.apply(null,e)),e.shift()},Z.Ha(Z.g.V,Z.debug.Error),Z.g.V.prototype.name="AssertionError",Z.g.Pb=function(t){throw t},Z.g.va=Z.g.Pb,Z.g.A=function(t,e,r,i){var n="Assertion failed";if(r)var n=n+(": "+r),o=i;else t&&(n+=": "+t,o=e);t=new Z.g.V(""+n,o||[]),Z.g.va(t)},Z.g.cg=function(t){Z.g.s&&(Z.g.va=t)},Z.g.assert=function(t,e,r){return Z.g.s&&!t&&Z.g.A("",null,e,Array.prototype.slice.call(arguments,2)),t},Z.g.Aa=function(t,e){Z.g.s&&Z.g.va(new Z.g.V("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1)))},Z.g.Wd=function(t,e,r){return Z.g.s&&!Z.Qc(t)&&Z.g.A("Expected number but got %s: %s.",[Z.u(t),t],e,Array.prototype.slice.call(arguments,2)),t},Z.g.Zd=function(t,e,r){return Z.g.s&&!Z.h(t)&&Z.g.A("Expected string but got %s: %s.",[Z.u(t),t],e,Array.prototype.slice.call(arguments,2)),t},Z.g.Ud=function(t,e,r){return Z.g.s&&!Z.xb(t)&&Z.g.A("Expected function but got %s: %s.",[Z.u(t),t],e,Array.prototype.slice.call(arguments,2)),t};Z.g.Xd=function(t,e,r){return Z.g.s&&!Z.P(t)&&Z.g.A("Expected object but got %s: %s.",[Z.u(t),t],e,Array.prototype.slice.call(arguments,2)),t};Z.g.Rd=function(t,e,r){return Z.g.s&&!Z.isArray(t)&&Z.g.A("Expected array but got %s: %s.",[Z.u(t),t],e,Array.prototype.slice.call(arguments,2)),t},Z.g.Sd=function(t,e,r){return Z.g.s&&!Z.Mc(t)&&Z.g.A("Expected boolean but got %s: %s.",[Z.u(t),t],e,Array.prototype.slice.call(arguments,2)),t},Z.g.Td=function(t,e,r){return!Z.g.s||Z.P(t)&&t.nodeType==Z.ib.bc.Rb||Z.g.A("Expected Element but got %s: %s.",[Z.u(t),t],e,Array.prototype.slice.call(arguments,2)),t},Z.g.Vd=function(t,e,r,i){return!Z.g.s||t instanceof e||Z.g.A("Expected instanceof %s but got %s.",[Z.g.pb(e),Z.g.pb(t)],r,Array.prototype.slice.call(arguments,3)),t},Z.g.Yd=function(){for(var t in Object.prototype)Z.g.Aa(t+" should not be enumerable in Object.prototype.")},Z.g.pb=function(t){return t instanceof Function?t.displayName||t.name||"unknown type name":t instanceof Object?t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t):null===t?"null":typeof t},Z.f={},Z.w=Z.oa,Z.f.v=!1,Z.f.ed=function(t){return t[t.length-1]},Z.f.wf=Z.f.ed,Z.f.indexOf=Z.w&&(Z.f.v||Array.prototype.indexOf)?function(t,e,r){return Array.prototype.indexOf.call(t,e,r)}:function(t,e,r){if(r=null==r?0:0>r?Math.max(0,t.length+r):r,Z.h(t))return Z.h(e)&&1==e.length?t.indexOf(e,r):-1;for(;r<t.length;r++)if(r in t&&t[r]===e)return r;return-1},Z.f.lastIndexOf=Z.w&&(Z.f.v||Array.prototype.lastIndexOf)?function(t,e,r){return Array.prototype.lastIndexOf.call(t,e,null==r?t.length-1:r)}:function(t,e,r){if(r=null==r?t.length-1:r,0>r&&(r=Math.max(0,t.length+r)),Z.h(t))return Z.h(e)&&1==e.length?t.lastIndexOf(e,r):-1;for(;0<=r;r--)if(r in t&&t[r]===e)return r;return-1},Z.f.forEach=Z.w&&(Z.f.v||Array.prototype.forEach)?function(t,e,r){Array.prototype.forEach.call(t,e,r)}:function(t,e,r){for(var i=t.length,n=Z.h(t)?t.split(""):t,o=0;o<i;o++)o in n&&e.call(r,n[o],o,t)},Z.f.kb=function(t,e){for(var r=Z.h(t)?t.split(""):t,i=t.length-1;0<=i;--i)i in r&&e.call(void 0,r[i],i,t)},Z.f.filter=Z.w&&(Z.f.v||Array.prototype.filter)?function(t,e,r){return Array.prototype.filter.call(t,e,r)}:function(t,e,r){for(var i=t.length,n=[],o=0,a=Z.h(t)?t.split(""):t,s=0;s<i;s++)if(s in a){var l=a[s];e.call(r,l,s,t)&&(n[o++]=l)}return n},Z.f.map=Z.w&&(Z.f.v||Array.prototype.map)?function(t,e,r){return Array.prototype.map.call(t,e,r)}:function(t,e,r){for(var i=t.length,n=Array(i),o=Z.h(t)?t.split(""):t,a=0;a<i;a++)a in o&&(n[a]=e.call(r,o[a],a,t));return n},Z.f.reduce=Z.w&&(Z.f.v||Array.prototype.reduce)?function(t,e,r,i){return i&&(e=Z.bind(e,i)),Array.prototype.reduce.call(t,e,r)}:function(t,e,r,i){var n=r;return Z.f.forEach(t,function(r,o){n=e.call(i,n,r,o,t)}),n},Z.f.reduceRight=Z.w&&(Z.f.v||Array.prototype.reduceRight)?function(t,e,r,i){return i&&(e=Z.bind(e,i)),Array.prototype.reduceRight.call(t,e,r)}:function(t,e,r,i){var n=r;return Z.f.kb(t,function(r,o){n=e.call(i,n,r,o,t)}),n},Z.f.some=Z.w&&(Z.f.v||Array.prototype.some)?function(t,e,r){return Array.prototype.some.call(t,e,r)}:function(t,e,r){for(var i=t.length,n=Z.h(t)?t.split(""):t,o=0;o<i;o++)if(o in n&&e.call(r,n[o],o,t))return!0;return!1},Z.f.every=Z.w&&(Z.f.v||Array.prototype.every)?function(t,e,r){return Array.prototype.every.call(t,e,r)}:function(t,e,r){for(var i=t.length,n=Z.h(t)?t.split(""):t,o=0;o<i;o++)if(o in n&&!e.call(r,n[o],o,t))return!1;return!0},Z.f.count=function(t,e,r){var i=0;return Z.f.forEach(t,function(t,n,o){e.call(r,t,n,o)&&++i},r),i},Z.f.find=function(t,e,r){return e=Z.f.findIndex(t,e,r),0>e?null:Z.h(t)?t.charAt(e):t[e]},Z.f.findIndex=function(t,e,r){for(var i=t.length,n=Z.h(t)?t.split(""):t,o=0;o<i;o++)if(o in n&&e.call(r,n[o],o,t))return o;return-1},Z.f.Ie=function(t,e,r){return e=Z.f.Gc(t,e,r),0>e?null:Z.h(t)?t.charAt(e):t[e]},Z.f.Gc=function(t,e,r){for(var i=Z.h(t)?t.split(""):t,n=t.length-1;0<=n;n--)if(n in i&&e.call(r,i[n],n,t))return n;return-1},Z.f.contains=function(t,e){return 0<=Z.f.indexOf(t,e)},Z.f.Oc=function(t){return 0==t.length},Z.f.clear=function(t){if(!Z.isArray(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0},Z.f.bf=function(t,e){Z.f.contains(t,e)||t.push(e)},Z.f.tb=function(t,e,r){Z.f.splice(t,r,0,e)},Z.f.cf=function(t,e,r){Z.dd(Z.f.splice,t,r,0).apply(null,e)},Z.f.insertBefore=function(t,e,r){var i;2==arguments.length||0>(i=Z.f.indexOf(t,r))?t.push(e):Z.f.tb(t,e,i)},Z.f.remove=function(t,e){e=Z.f.indexOf(t,e);var r;return(r=0<=e)&&Z.f.L(t,e),r},Z.f.Yf=function(t,e){return e=Z.f.lastIndexOf(t,e),0<=e&&(Z.f.L(t,e),!0)},Z.f.L=function(t,e){return 1==Array.prototype.splice.call(t,e,1).length},Z.f.Xf=function(t,e,r){return e=Z.f.findIndex(t,e,r),0<=e&&(Z.f.L(t,e),!0)},Z.f.Uf=function(t,e,r){var i=0;return Z.f.kb(t,function(n,o){e.call(r,n,o,t)&&Z.f.L(t,o)&&i++}),i},Z.f.concat=function(t){return Array.prototype.concat.apply(Array.prototype,arguments)},Z.f.join=function(t){return Array.prototype.concat.apply(Array.prototype,arguments)},Z.f.qd=function(t){var e=t.length;if(0<e){for(var r=Array(e),i=0;i<e;i++)r[i]=t[i];return r}return[]},Z.f.clone=Z.f.qd,Z.f.extend=function(t,e){for(var r=1;r<arguments.length;r++){var i=arguments[r];if(Z.Ia(i)){var n=t.length||0,o=i.length||0;t.length=n+o;for(var a=0;a<o;a++)t[n+a]=i[a]}else t.push(i)}},Z.f.splice=function(t,e,r,i){return Array.prototype.splice.apply(t,Z.f.slice(arguments,1))},Z.f.slice=function(t,e,r){return 2>=arguments.length?Array.prototype.slice.call(t,e):Array.prototype.slice.call(t,e,r)},Z.f.Vf=function(t,e,r){function i(t){return Z.P(t)?"o"+Z.qb(t):(typeof t).charAt(0)+t}e=e||t,r=r||i;for(var n={},o=0,a=0;a<t.length;){var s=t[a++],l=r(s);Object.prototype.hasOwnProperty.call(n,l)||(n[l]=!0,e[o++]=s)}e.length=o},Z.f.cb=function(t,e,r){return Z.f.eb(t,r||Z.f.C,!1,e)},Z.f.ge=function(t,e,r){return Z.f.eb(t,e,!0,void 0,r)},Z.f.eb=function(t,e,r,i,n){for(var o,a=0,s=t.length;a<s;){var l,u=a+s>>1;l=r?e.call(n,t[u],u,t):e(i,t[u]),0<l?a=u+1:(s=u,o=!l)}return o?a:~a},Z.f.sort=function(t,e){t.sort(e||Z.f.C)},Z.f.jg=function(t,e){for(var r=Array(t.length),i=0;i<t.length;i++)r[i]={index:i,value:t[i]};var n=e||Z.f.C;for(Z.f.sort(r,function(t,e){return n(t.value,e.value)||t.index-e.index}),i=0;i<t.length;i++)t[i]=r[i].value},Z.f.ld=function(t,e,r){var i=r||Z.f.C;Z.f.sort(t,function(t,r){return i(e(t),e(r))})},Z.f.gg=function(t,e,r){Z.f.ld(t,function(t){return t[e]},r)},Z.f.sf=function(t,e,r){e=e||Z.f.C;for(var i=1;i<t.length;i++){var n=e(t[i-1],t[i]);if(0<n||0==n&&r)return!1}return!0},Z.f.Fe=function(t,e,r){if(!Z.Ia(t)||!Z.Ia(e)||t.length!=e.length)return!1;var i=t.length;r=r||Z.f.Cc;for(var n=0;n<i;n++)if(!r(t[n],e[n]))return!1;return!0},Z.f.xe=function(t,e,r){r=r||Z.f.C;for(var i=Math.min(t.length,e.length),n=0;n<i;n++){var o=r(t[n],e[n]);if(0!=o)return o}return Z.f.C(t.length,e.length)},Z.f.C=function(t,e){return t>e?1:t<e?-1:0},Z.f.ef=function(t,e){return-Z.f.C(t,e)},Z.f.Cc=function(t,e){return t===e},Z.f.$d=function(t,e,r){return r=Z.f.cb(t,e,r),0>r&&(Z.f.tb(t,e,-(r+1)),!0)},Z.f.fe=function(t,e,r){return e=Z.f.cb(t,e,r),0<=e&&Z.f.L(t,e)},Z.f.je=function(t,e,r){for(var i={},n=0;n<t.length;n++){var o=t[n],a=e.call(r,o,n,t);Z.O(a)&&(i[a]||(i[a]=[])).push(o)}return i},Z.f.wg=function(t,e,r){var i={};return Z.f.forEach(t,function(n,o){i[e.call(r,n,o,t)]=n}),i},Z.f.Mf=function(t,e,r){var i=[],n=0,o=t;if(r=r||1,void 0!==e&&(n=t,o=e),0>r*(o-n))return[];if(0<r)for(t=n;t<o;t+=r)i.push(t);else for(t=n;t>o;t+=r)i.push(t);return i},Z.f.repeat=function(t,e){for(var r=[],i=0;i<e;i++)r[i]=t;return r},Z.f.Hc=function(t){for(var e=[],r=0;r<arguments.length;r++){var i=arguments[r];if(Z.isArray(i))for(var n=0;n<i.length;n+=8192)for(var o=Z.f.Hc.apply(null,Z.f.slice(i,n,n+8192)),a=0;a<o.length;a++)e.push(o[a]);else e.push(i)}return e},Z.f.rotate=function(t,e){return t.length&&(e%=t.length,0<e?Array.prototype.unshift.apply(t,t.splice(-e,e)):0>e&&Array.prototype.push.apply(t,t.splice(0,-e))),t},Z.f.Cf=function(t,e,r){e=Array.prototype.splice.call(t,e,1),Array.prototype.splice.call(t,r,0,e[0])},Z.f.Ig=function(t){if(!arguments.length)return[];for(var e=[],r=arguments[0].length,i=1;i<arguments.length;i++)arguments[i].length<r&&(r=arguments[i].length);for(i=0;i<r;i++){for(var n=[],o=0;o<arguments.length;o++)n.push(arguments[o][i]);e.push(n)}return e},Z.f.fg=function(t,e){e=e||Math.random;for(var r=t.length-1;0<r;r--){var i=Math.floor(e()*(r+1)),n=t[r];t[r]=t[i],t[i]=n}},Z.f.Ae=function(t,e){var r=[];return Z.f.forEach(e,function(e){r.push(t[e])}),r},Z.f.ze=function(t,e,r){return Z.f.concat.apply([],Z.f.map(t,e,r))},Z.locale={},Z.locale.J={COUNTRY:{AD:"Andorra",AE:hb,AF:U,AG:ca,AI:"Anguilla",AL:"Shqipëria",AM:gb,AN:pa,AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:b,AT:"Österreich",AU:"Australia",AW:"Aruba",AX:"Åland",AZ:"Azərbaycan",BA:p,BB:"Barbados",BD:"বাংলাদেশ",BE:"België",BF:"Burkina Faso",BG:"България",BH:"البحرين",BI:"Burundi",BJ:"Bénin",BM:"Bermuda",BN:"Brunei",BO:k,BR:"Brasil",BS:"Bahamas",BT:"भूटान",BV:"Bouvet Island",BW:q,BY:db,BZ:"Belize",CA:"Canada",CC:"Cocos (Keeling) Islands",CD:Ca,CF:Ba,CG:"Congo",CH:"Schweiz",CI:"Côte d’Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroun",CN:"中国",CO:"Colombia",CR:"Costa Rica",CS:Ga,CU:"Cuba",CV:"Cabo Verde",CX:fa,CY:"Κύπρος",CZ:cb,DD:"East Germany",DE:"Deutschland",DJ:"Jabuuti",DK:"Danmark",DM:"Dominica",DO:za,DZ:"الجزائر",EC:"Ecuador",EE:"Eesti",EG:"مصر",EH:ib,ER:"اريتريا",ES:"España",ET:X,FI:"Suomi",FJ:"फिजी",FK:ga,FM:x,FO:"Føroyar",FR:"France",FX:"Metropolitan France",GA:"Gabon",GB:Ra,GD:"Grenada",GE:"საქართველო",GF:ia,GG:"Guernsey",GH:r,GI:"Gibraltar",GL:ja,GM:"Gambia",GN:"Guinée",GP:"Guadeloupe",GQ:ha,GR:"Ελλάδα",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guiné Bissau",GY:"Guyana",HK:"香港",HM:"Heard Island and McDonald Islands",HN:t,HR:"Hrvatska",HT:"Haïti",HU:"Magyarország",ID:u,IE:"Ireland",IL:"ישראל",IM:"Isle of Man",IN:W,IO:"British Indian Ocean Territory",IQ:"العراق",IR:"ایران",IS:"Ísland",IT:"Italia",JE:"Jersey",JM:"Jamaica",JO:"الأردن",JP:"日本",KE:"Kenya",KG:eb,KH:"កម្ពុជា",KI:w,KM:lb,KN:Da,KP:mb,KR:"대한민국",KW:"الكويت",KY:ea,KZ:"Казахстан",LA:"ลาว",LB:"لبنان",LC:"Saint Lucia",LI:"Liechtenstein",LK:"இலங்கை",LR:"Liberia",LS:"Lesotho",LT:"Lietuva",LU:la,LV:"Latvija",LY:"ليبيا",MA:"المغرب",MC:"Monaco",MD:oa,ME:"Црна Гора",MG:ma,MH:na,MK:"Македонија",ML:"مالي",MM:"Myanmar",MN:"蒙古",MO:"澳门",MP:sa,MQ:"Martinique",MR:"موريتانيا",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"México",MY:"Malaysia",MZ:"Moçambique",NA:"Namibia",NC:ta,NE:"Niger",NF:ra,NG:y,NI:"Nicaragua",NL:"Nederland",NO:"Norge",NP:"नेपाल",NR:"Nauru",NT:"Neutral Zone",NU:"Niue",NZ:qa,OM:"عمان",PA:"Panamá",PE:"Perú",PF:wa,PG:z,PH:va,PK:V,PL:"Polska",PM:Fa,PN:"Pitcairn",PR:xa,PS:"فلسطين",PT:"Portugal",PW:"Palau",PY:ua,QA:"قطر",QO:"Outlying Oceania",QU:"European Union",RE:"Réunion",RO:"România",RS:"Србија",RU:"Россия",RW:A,SA:jb,SB:Ja,SC:Ha,SD:"السودان",SE:"Sverige",SG:"新加坡",SH:"Saint Helena",SI:"Slovenija",SJ:Ka,SK:Ia,SL:"Sierra Leone",SM:"San Marino",SN:C,SO:"Somali",SR:"Suriname",ST:Ma,SU:"Union of Soviet Socialist Republics",SV:"El Salvador",SY:"سوريا",SZ:La,TC:Pa,TD:"تشاد",TF:"French Southern Territories",TG:"Togo",TH:"ประเทศไทย",TJ:"تاجیکستان",TK:E,TL:Oa,TM:"Туркменистан",TN:"تونس",TO:"Tonga",TR:G,TT:"Trinidad y Tobago",TV:F,TW:"台湾",TZ:Na,UA:"Україна",UG:"Uganda",UM:Ta,US:Sa,UY:"Uruguay",UZ:"Ўзбекистон",VA:"Vaticano",VC:Ea,VE:"Venezuela",VG:da,VI:Qa,VN:"Việt Nam",VU:H,WF:Va,WS:"Samoa",YD:"People's Democratic Republic of Yemen",YE:"اليمن",YT:"Mayotte",ZA:B,ZM:"Zambia",ZW:"Zimbabwe",ZZ:Ua,aa_DJ:"Jabuuti",aa_ER:"Érythrée",aa_ER_SAAHO:"Érythrée",aa_ET:v,af_NA:"Namibië",af_ZA:"Suid-Afrika",ak_GH:r,am_ET:X,ar_AE:hb,ar_BH:"البحرين",ar_DJ:"جيبوتي",ar_DZ:"الجزائر",ar_EG:"مصر",ar_EH:ib,ar_ER:"اريتريا",ar_IL:"اسرائيل",ar_IQ:"العراق",ar_JO:"الأردن",ar_KM:lb,ar_KW:"الكويت",ar_LB:"لبنان",ar_LY:"ليبيا",ar_MA:"المغرب",ar_MR:"موريتانيا",ar_OM:"عمان",ar_PS:"فلسطين",ar_QA:"قطر",ar_SA:jb,ar_SD:"السودان",ar_SY:"سوريا",ar_TD:"تشاد",ar_TN:"تونس",ar_YE:"اليمن",as_IN:"ভাৰত",ay_BO:k,az_AZ:"Azərbaycan",az_Cyrl_AZ:"Азәрбајҹан",az_Latn_AZ:"Azerbaycan",be_BY:db,bg_BG:"България",bi_VU:H,bn_BD:"বাংলাদেশ",bn_IN:"ভারত",bo_CN:"རྒྱ་ནག",bo_IN:"རྒྱ་གར་",bs_BA:p,byn_ER:"ኤርትራ",ca_AD:"Andorra",ca_ES:"Espanya",cch_NG:y,ch_GU:"Guam",chk_FM:x,cop_Arab_EG:"مصر",cop_Arab_US:kb,cop_EG:"مصر",cop_US:kb,cs_CZ:cb,cy_GB:"Prydain Fawr",da_DK:"Danmark",da_GL:"Grønland",de_AT:"Österreich",de_BE:"Belgien",de_CH:"Schweiz",de_DE:"Deutschland",de_LI:"Liechtenstein",de_LU:"Luxemburg",dv_MV:"Maldives",dz_BT:"Bhutan",ee_GH:r,ee_TG:"Togo",efi_NG:y,el_CY:"Κύπρος",el_GR:"Ελλάδα",en_AG:ca,en_AI:"Anguilla",en_AS:b,en_AU:"Australia",en_BB:"Barbados",en_BE:"Belgium",en_BM:"Bermuda",en_BS:"Bahamas",en_BW:q,en_BZ:"Belize",en_CA:"Canada",en_CC:"Cocos Islands",en_CK:"Cook Islands",en_CM:"Cameroon",en_CX:fa,en_DM:"Dominica",en_FJ:"Fiji",en_FK:ga,en_FM:x,en_GB:Ra,en_GD:"Grenada",en_GG:"Guernsey",en_GH:r,en_GI:"Gibraltar",en_GM:"Gambia",en_GU:"Guam",en_GY:"Guyana",en_HK:"Hong Kong",en_HN:t,en_IE:"Ireland",en_IM:"Isle of Man",en_IN:"India",en_JE:"Jersey",en_JM:"Jamaica",en_KE:"Kenya",en_KI:w,en_KN:Da,en_KY:ea,en_LC:"Saint Lucia",en_LR:"Liberia",en_LS:"Lesotho",en_MH:na,en_MP:sa,en_MS:"Montserrat",en_MT:"Malta",en_MU:"Mauritius",en_MW:"Malawi",en_NA:"Namibia",en_NF:ra,en_NG:y,en_NR:"Nauru",en_NU:"Niue",en_NZ:qa,en_PG:z,en_PH:va,en_PK:"Pakistan",en_PN:"Pitcairn",en_PR:xa,en_RW:A,en_SB:Ja,en_SC:Ha,en_SG:"Singapore",en_SH:"Saint Helena",en_SL:"Sierra Leone",en_SZ:La,en_TC:Pa,en_TK:E,en_TO:"Tonga",en_TT:"Trinidad and Tobago",en_TV:F,en_TZ:Na,en_UG:"Uganda",en_UM:Ta,en_US:Sa,en_US_POSIX:Sa,en_VC:Ea,en_VG:da,en_VI:Qa,en_VU:H,en_WS:"Samoa",en_ZA:B,en_ZM:"Zambia",en_ZW:"Zimbabwe",es_AR:"Argentina",es_BO:k,es_CL:"Chile",es_CO:"Colombia",es_CR:"Costa Rica",es_CU:"Cuba",es_DO:za,es_EC:"Ecuador",es_ES:"España",es_GQ:"Guinea Ecuatorial",es_GT:"Guatemala",es_HN:t,es_MX:"México",es_NI:"Nicaragua",es_PA:"Panamá",es_PE:"Perú",es_PH:"Filipinas",es_PR:xa,es_PY:ua,es_SV:"El Salvador",es_US:"Estados Unidos",es_UY:"Uruguay",es_VE:"Venezuela",et_EE:"Eesti",eu_ES:"Espainia",fa_AF:U,fa_IR:"ایران",fi_FI:"Suomi",fil_PH:va,fj_FJ:"Fiji",fo_FO:"Føroyar",fr_BE:"Belgique",fr_BF:"Burkina Faso",fr_BI:"Burundi",fr_BJ:"Bénin",fr_CA:"Canada",fr_CD:Ca,fr_CF:Ba,fr_CG:"Congo",fr_CH:"Suisse",fr_CI:"Côte d’Ivoire",fr_CM:"Cameroun",fr_DJ:"Djibouti",fr_DZ:"Algérie",fr_FR:"France",fr_GA:"Gabon",fr_GF:ia,fr_GN:"Guinée",fr_GP:"Guadeloupe",fr_GQ:ha,fr_HT:"Haïti",fr_KM:"Comores",fr_LU:la,fr_MA:"Maroc",fr_MC:"Monaco",fr_MG:ma,fr_ML:"Mali",fr_MQ:"Martinique",fr_MU:"Maurice",fr_NC:ta,fr_NE:"Niger",fr_PF:wa,fr_PM:Fa,fr_RE:"Réunion",fr_RW:A,fr_SC:Ha,fr_SN:C,fr_SY:"Syrie",fr_TD:"Tchad",fr_TG:"Togo",fr_TN:"Tunisie",fr_VU:H,fr_WF:Va,fr_YT:"Mayotte",fur_IT:"Italia",ga_IE:"Éire",gaa_GH:r,gez_ER:"ኤርትራ",gez_ET:X,gil_KI:w,gl_ES:"España",gn_PY:ua,gu_IN:"ભારત",gv_GB:Aa,ha_Arab_NG:"نيجيريا",ha_GH:"غانا",ha_Latn_GH:r,ha_Latn_NE:"Niger",ha_Latn_NG:"Nigéria",ha_NE:"النيجر",ha_NG:"نيجيريا",haw_US:"ʻAmelika Hui Pū ʻIa",he_IL:"ישראל",hi_IN:W,ho_PG:z,hr_BA:p,hr_HR:"Hrvatska",ht_HT:"Haïti",hu_HU:"Magyarország",hy_AM:gb,hy_AM_REVISED:gb,id_ID:u,ig_NG:y,ii_CN:"ꍏꇩ",is_IS:"Ísland",it_CH:"Svizzera",it_IT:"Italia",it_SM:"San Marino",ja_JP:"日本",ka_GE:"საქართველო",kaj_NG:y,kam_KE:"Kenya",kcg_NG:y,kfo_NG:"Nigéria",kk_KZ:"Қазақстан",kl_GL:ja,km_KH:"កម្ពុជា",kn_IN:"ಭಾರತ",ko_KP:mb,ko_KR:"대한민국",kok_IN:W,kos_FM:x,kpe_GN:"Guinée",kpe_LR:"Libéria",ks_IN:W,ku_IQ:"Irak",ku_IR:"İran",ku_Latn_IQ:"Irak",ku_Latn_IR:"İran",ku_Latn_SY:"Suriye",ku_Latn_TR:G,ku_SY:"Suriye",ku_TR:G,kw_GB:Aa,ky_Cyrl_KG:eb,ky_KG:"Kırgızistan",la_VA:"Vaticano",lb_LU:la,ln_CD:Ca,ln_CG:"Kongo",lo_LA:"Laos",lt_LT:"Lietuva",lv_LV:"Latvija",mg_MG:ma,mh_MH:na,mi_NZ:qa,mk_MK:"Македонија",ml_IN:"ഇന്ത്യ",mn_Cyrl_MN:"Монголия",mn_MN:"Монголия",mr_IN:W,ms_BN:"Brunei",ms_MY:"Malaysia",ms_SG:"Singapura",mt_MT:"Malta",my_MM:"Myanmar",na_NR:"Nauru",nb_NO:"Norge",nb_SJ:Ka,ne_NP:"नेपाल",niu_NU:"Niue",nl_AN:pa,nl_AW:"Aruba",nl_BE:"België",nl_NL:"Nederland",nl_SR:"Suriname",nn_NO:"Noreg",nr_ZA:B,nso_ZA:B,ny_MW:"Malawi",om_ET:v,om_KE:"Keeniyaa",or_IN:"ଭାରତ",pa_Arab_PK:V,pa_Guru_IN:"ਭਾਰਤ",pa_IN:"ਭਾਰਤ",pa_PK:V,pap_AN:pa,pau_PW:"Palau",pl_PL:"Polska",pon_FM:x,ps_AF:U,pt_AO:"Angola",pt_BR:"Brasil",pt_CV:"Cabo Verde",pt_GW:"Guiné Bissau",pt_MZ:"Moçambique",pt_PT:"Portugal",pt_ST:Ma,pt_TL:Oa,qu_BO:k,qu_PE:"Perú",rm_CH:"Schweiz",rn_BI:"Burundi",ro_MD:oa,ro_RO:"România",ru_BY:db,ru_KG:eb,ru_KZ:"Казахстан",ru_RU:"Россия",ru_UA:"Украина",rw_RW:A,sa_IN:W,sd_Deva_IN:W,sd_IN:W,se_FI:"Finland",se_NO:"Norge",sg_CF:Ba,sh_BA:"Bosnia and Herzegovina",sh_CS:Ga,si_LK:"Sri Lanka",sid_ET:v,sk_SK:Ia,sl_SI:"Slovenija",sm_AS:b,sm_WS:"Samoa",so_DJ:"Jabuuti",so_ET:"Itoobiya",so_KE:"Kiiniya",so_SO:"Soomaaliya",sq_AL:"Shqipëria",sr_BA:"Босна и Херцеговина",sr_CS:"Србија и Црна Гора",sr_Cyrl_BA:"Босния",sr_Cyrl_CS:"Сербия и Черногория",sr_Cyrl_ME:"Черногория",sr_Cyrl_RS:"Сербия",sr_Latn_BA:p,sr_Latn_CS:"Srbija i Crna Gora",sr_Latn_ME:"Crna Gora",sr_Latn_RS:"Srbija",sr_ME:"Црна Гора",sr_RS:"Србија",ss_SZ:La,ss_ZA:B,st_LS:"Lesotho",st_ZA:B,su_ID:u,sv_AX:"Åland",sv_FI:"Finland",sv_SE:"Sverige",sw_KE:"Kenya",sw_TZ:Na,sw_UG:"Uganda",swb_KM:lb,syr_SY:"Syria",ta_IN:"இந்தியா",ta_LK:"இலங்கை",ta_SG:"சிங்கப்பூர்",te_IN:"భారత దేళం",tet_TL:Oa,tg_Cyrl_TJ:"Таджикистан",tg_TJ:"تاجکستان",th_TH:"ประเทศไทย",ti_ER:"ኤርትራ",ti_ET:X,tig_ER:"ኤርትራ",tk_TM:"ترکمنستان",tkl_TK:E,tn_BW:q,tn_ZA:B,to_TO:"Tonga",tpi_PG:z,tr_CY:"Güney Kıbrıs Rum Kesimi",tr_TR:G,ts_ZA:B,tt_RU:"Россия",tvl_TV:F,ty_PF:wa,uk_UA:"Україна",uli_FM:x,und_ZZ:Ua,ur_IN:"بھارت",ur_PK:V,uz_AF:"Afganistan",uz_Arab_AF:U,uz_Cyrl_UZ:"Узбекистан",uz_Latn_UZ:"Oʿzbekiston",uz_UZ:"Ўзбекистон",ve_ZA:B,vi_VN:"Việt Nam",wal_ET:X,wo_Arab_SN:"السنغال",wo_Latn_SN:C,wo_SN:C,xh_ZA:B,yap_FM:x,yo_NG:y,zh_CN:"中国",zh_HK:"香港",zh_Hans_CN:"中国",zh_Hans_SG:"新加坡",zh_Hant_HK:"中華人民共和國香港特別行政區",zh_Hant_MO:"澳門",zh_Hant_TW:"臺灣",zh_MO:"澳门",zh_SG:"新加坡",zh_TW:"台湾",zu_ZA:B},LANGUAGE:{aa:"afar",ab:"абхазский",ace:"Aceh",ach:"Acoli",ada:"Adangme",ady:"адыгейский",ae:"Avestan",af:"Afrikaans",afa:"Afro-Asiatic Language",afh:"Afrihili",ain:"Ainu",ak:"Akan",akk:"Akkadian",ale:"Aleut",
alg:"Algonquian Language",alt:"Southern Altai",am:"አማርኛ",an:"Aragonese",ang:"Old English",anp:"Angika",apa:"Apache Language",ar:"العربية",arc:"Aramaic",arn:"Araucanian",arp:"Arapaho",art:"Artificial Language",arw:"Arawak",as:"অসমীয়া",ast:"asturiano",ath:"Athapascan Language",aus:"Australian Language",av:"аварский",awa:"Awadhi",ay:"aimara",az:"azərbaycanca",az_Arab:"ترکی آذربایجانی",az_Cyrl:"Азәрбајҹан",az_Latn:"Azerice",ba:"башкирский",bad:"Banda",bai:"Bamileke Language",bal:"بلوچی",ban:"Balin",bas:"Basa",bat:"Baltic Language",be:"беларуская",bej:"Beja",bem:"Bemba",ber:"Berber",bg:"български",bh:"बिहारी",bho:"Bhojpuri",bi:"bichelamar ; bislama",bik:"Bikol",bin:"Bini",bla:"Siksika",bm:"bambara",bn:"বাংলা",bnt:"Bantu",bo:"པོད་སྐད་",br:"breton",bra:"Braj",bs:"Bosanski",btk:"Batak",bua:"Buriat",bug:"Bugis",byn:"ብሊን",ca:"català",cad:"Caddo",cai:"Central American Indian Language",car:"Carib",cau:"Caucasian Language",cch:"Atsam",ce:"чеченский",ceb:"Cebuano",cel:"Celtic Language",ch:"Chamorro",chb:"Chibcha",chg:"Chagatai",chk:"Chuukese",chm:"марийский (черемисский)",chn:"Chinook Jargon",cho:"Choctaw",chp:"Chipewyan",chr:"Cherokee",chy:"Cheyenne",cmc:"Chamic Language",co:"corse",cop:"قبطية",cop_Arab:"قبطية",cpe:"English-based Creole or Pidgin",cpf:"French-based Creole or Pidgin",cpp:"Portuguese-based Creole or Pidgin",cr:"Cree",crh:"Crimean Turkish",crp:"Creole or Pidgin",cs:"čeština",csb:"Kashubian",cu:"Church Slavic",cus:"Cushitic Language",cv:"чувашский",cy:"Cymraeg",da:"dansk",dak:"Dakota",dar:"даргва",day:"Dayak",de:"Deutsch",del:"Delaware",den:"Slave",dgr:"Dogrib",din:"Dinka",doi:"الدوجرى",dra:"Dravidian Language",dsb:"Lower Sorbian",dua:"Duala",dum:"Middle Dutch",dv:"Divehi",dyu:"dioula",dz:"རྫོང་ཁ",ee:"Ewe",efi:"Efik",egy:"Ancient Egyptian",eka:"Ekajuk",el:"Ελληνικά",elx:"Elamite",en:"English",enm:"Middle English",eo:"esperanto",es:"español",et:"eesti",eu:"euskara",ewo:"Ewondo",fa:"فارسی",fan:"fang",fat:"Fanti",ff:"Fulah",fi:"suomi",fil:"Filipino",fiu:"Finno-Ugrian Language",fj:"Fijian",fo:"føroyskt",fon:"Fon",fr:"français",frm:"Middle French",fro:"Old French",frr:"Northern Frisian",frs:"Eastern Frisian",fur:"friulano",fy:"Fries",ga:"Gaeilge",gaa:"Ga",gay:"Gayo",gba:"Gbaya",gd:"Scottish Gaelic",gem:"Germanic Language",gez:"ግዕዝኛ",gil:"Gilbertese",gl:"galego",gmh:"Middle High German",gn:"guaraní",goh:"Old High German",gon:"Gondi",gor:"Gorontalo",got:"Gothic",grb:"Grebo",grc:"Αρχαία Ελληνικά",gsw:"Schweizerdeutsch",gu:"ગુજરાતી",gv:"Gaelg",gwi:"Gwichʼin",ha:"الهوسا",ha_Arab:"الهوسا",ha_Latn:"haoussa",hai:"Haida",haw:"ʻōlelo Hawaiʻi",he:"עברית",hi:"हिंदी",hil:"Hiligaynon",him:"Himachali",hit:"Hittite",hmn:"Hmong",ho:"Hiri Motu",hr:"hrvatski",hsb:"Upper Sorbian",ht:"haïtien",hu:"magyar",hup:"Hupa",hy:"Հայերէն",hz:"Herero",ia:"interlingvao",iba:"Iban",id:"Bahasa Indonesia",ie:"Interlingue",ig:"Igbo",ii:"ꆈꌠꉙ",ijo:"Ijo",ik:"Inupiaq",ilo:"Iloko",inc:"Indic Language",ine:"Indo-European Language",inh:"ингушский",io:"Ido",ira:"Iranian Language",iro:"Iroquoian Language",is:"íslenska",it:"italiano",iu:"Inuktitut",ja:"日本語",jbo:"Lojban",jpr:"Judeo-Persian",jrb:"Judeo-Arabic",jv:"Jawa",ka:"ქართული",kaa:"каракалпакский",kab:"kabyle",kac:"Kachin",kaj:"Jju",kam:"Kamba",kar:"Karen",kaw:"Kawi",kbd:"кабардинский",kcg:"Tyap",kfo:"koro",kg:"Kongo",kha:"Khasi",khi:"Khoisan Language",kho:"Khotanese",ki:"Kikuyu",kj:"Kuanyama",kk:"Қазақ",kl:"kalaallisut",km:"ភាសាខ្មែរ",kmb:"quimbundo",kn:"ಕನ್ನಡ",ko:"한국어",kok:"कोंकणी",kos:"Kosraean",kpe:"kpellé",kr:"Kanuri",krc:"карачаево-балкарский",krl:"карельский",kro:"Kru",kru:"Kurukh",ks:"काश्मिरी",ku:"Kürtçe",ku_Arab:"الكردية",ku_Latn:"Kürtçe",kum:"кумыкский",kut:"Kutenai",kv:"Komi",kw:"kernewek",ky:"Kırgızca",ky_Arab:"القيرغستانية",ky_Cyrl:"киргизский",la:"latino",lad:"לדינו",lah:"لاهندا",lam:"Lamba",lb:"luxembourgeois",lez:"лезгинский",lg:"Ganda",li:"Limburgs",ln:"lingala",lo:"Lao",lol:"mongo",loz:"Lozi",lt:"lietuvių",lu:"luba-katanga",lua:"luba-lulua",lui:"Luiseno",lun:"Lunda",luo:"Luo",lus:"Lushai",lv:"latviešu",mad:"Madura",mag:"Magahi",mai:"Maithili",mak:"Makassar",man:"Mandingo",map:"Austronesian",mas:"Masai",mdf:"мокша",mdr:"Mandar",men:"Mende",mg:"malgache",mga:"Middle Irish",mh:"Marshallese",mi:"Maori",mic:"Micmac",min:"Minangkabau",mis:"Miscellaneous Language",mk:"македонски",mkh:"Mon-Khmer Language",ml:"മലയാളം",mn:fb,mn_Cyrl:fb,mn_Mong:fb,mnc:"Manchu",mni:"Manipuri",mno:"Manobo Language",mo:"Moldavian",moh:"Mohawk",mos:"moré ; mossi",mr:"मराठी",ms:"Bahasa Melayu",mt:"Malti",mul:"Multiple Languages",mun:"Munda Language",mus:"Creek",mwl:"Mirandese",mwr:"Marwari",my:"Burmese",myn:"Mayan Language",myv:"эрзя",na:"Nauru",nah:"Nahuatl",nai:"North American Indian Language",nap:"napoletano",nb:"norsk bokmål",nd:"North Ndebele",nds:"Low German",ne:"नेपाली",new:"Newari",ng:"Ndonga",nia:"Nias",nic:"Niger-Kordofanian Language",niu:"Niuean",nl:"Nederlands",nn:"nynorsk",no:"Norwegian",nog:"ногайский",non:"Old Norse",nqo:"N’Ko",nr:"South Ndebele",nso:"Northern Sotho",nub:"Nubian Language",nv:"Navajo",nwc:"Classical Newari",ny:"nianja; chicheua; cheua",nym:"Nyamwezi",nyn:"Nyankole",nyo:"Nyoro",nzi:"Nzima",oc:"occitan",oj:"Ojibwa",om:"Oromoo",or:"ଓଡ଼ିଆ",os:"осетинский",osa:"Osage",ota:"Ottoman Turkish",oto:"Otomian Language",pa:"ਪੰਜਾਬੀ",pa_Arab:"پنجاب",pa_Guru:"ਪੰਜਾਬੀ",paa:"Papuan Language",pag:"Pangasinan",pal:"Pahlavi",pam:"Pampanga",pap:"Papiamento",pau:"Palauan",peo:"Old Persian",phi:"Philippine Language",phn:"Phoenician",pi:"บาลี",pl:"polski",pon:"Pohnpeian",pra:"Prakrit Language",pro:"Old Provençal",ps:"پښتو",pt:"português",qu:"quechua",raj:"Rajasthani",rap:"Rapanui",rar:"Rarotongan",rm:"Rätoromanisch",rn:"roundi",ro:"română",roa:"Romance Language",rom:"Romany",ru:"русский",rup:"Aromanian",rw:"rwanda",sa:"संस्कृत भाषा",sad:"Sandawe",sah:"якутский",sai:"South American Indian Language",sal:"Salishan Language",sam:"ארמית שומרונית",sas:"Sasak",sat:"Santali",sc:"Sardinian",scn:"siciliano",sco:"Scots",sd:"सिन्धी",sd_Arab:"سندی",sd_Deva:"सिन्धी",se:"nordsamiska",sel:"селькупский",sem:"Semitic Language",sg:"sangho",sga:"Old Irish",sgn:"Sign Language",sh:"Serbo-Croatian",shn:"Shan",si:"Sinhalese",sid:"Sidamo",sio:"Siouan Language",sit:"Sino-Tibetan Language",sk:"slovenský",sl:"slovenščina",sla:"Slavic Language",sm:"Samoan",sma:"sydsamiska",smi:"Sami Language",smj:"lulesamiska",smn:"Inari Sami",sms:"Skolt Sami",sn:"Shona",snk:"soninké",so:"Soomaali",sog:"Sogdien",son:"Songhai",sq:"shqipe",sr:"Српски",sr_Cyrl:"сербский",sr_Latn:"Srpski",srn:"Sranantongo",srr:"sérère",ss:"Swati",ssa:"Nilo-Saharan Language",st:"Sesotho",su:"Sundan",suk:"Sukuma",sus:"soussou",sux:"Sumerian",sv:"svenska",sw:"Kiswahili",syc:"Classical Syriac",syr:"Syriac",ta:"தமிழ்",tai:"Tai Language",te:"తెలుగు",tem:"Timne",ter:"Tereno",tet:"tétum",tg:"تاجک",tg_Arab:"تاجک",tg_Cyrl:"таджикский",th:"ไทย",ti:"ትግርኛ",tig:"ትግረ",tiv:"Tiv",tk:"ترکمنی",tkl:E,tl:"Tagalog",tlh:"Klingon",tli:"Tlingit",tmh:"tamacheq",tn:"Tswana",to:"Tonga",tog:"Nyasa Tonga",tpi:"Tok Pisin",tr:"Türkçe",ts:"Tsonga",tsi:"Tsimshian",tt:"татарский",tum:"Tumbuka",tup:"Tupi Language",tut:"алтайские (другие)",tvl:F,tw:"Twi",ty:"tahitien",tyv:"тувинский",udm:"удмуртский",ug:"уйгурский",uga:"Ugaritic",uk:"українська",umb:"umbundu",und:"English",ur:"اردو",uz:"Ўзбек",uz_Arab:"اۉزبېک",uz_Cyrl:"узбекский",uz_Latn:"o'zbekcha",vai:"Vai",ve:"Venda",vi:"Tiếng Việt",vo:"volapuko",vot:"Votic",wa:"Wallonisch",wak:"Wakashan Language",wal:"Walamo",war:"Waray",was:"Washo",wen:"Sorbian Language",wo:"wolof",wo_Arab:"الولوف",wo_Latn:"wolof",xal:"калмыцкий",xh:"Xhosa",yao:"iao",yap:"Yapese",yi:"יידיש",yo:"Yoruba",ypk:"Yupik Language",za:"Zhuang",zap:"Zapotec",zen:"Zenaga",zh:"中文",zh_Hans:"中文",zh_Hant:"中文",znd:"Zande",zu:"Zulu",zun:"Zuni",zxx:"No linguistic content",zza:"Zaza"}},Z.locale.dg=function(t){t=t.replace(/-/g,"_"),Z.locale.N=t},Z.locale.Da=function(){return Z.locale.N||(Z.locale.N="en"),Z.locale.N},Z.locale.H={Dd:"DateTimeConstants",Ld:"NumberFormatConstants",ic:"TimeZoneConstants",Yb:ka,jc:"TimeZoneSelectedIds",lc:"TimeZoneSelectedShortNames",kc:"TimeZoneSelectedLongNames",hc:"TimeZoneAllLongNames"},Z.locale.Ca=function(t){return(t=t.match(/^\w{2,3}([-_]|$)/))?t[0].replace(/[_-]/g,""):""},Z.locale.mb=function(t){return(t=t.match(/[-_]([a-zA-Z]{2}|\d{3})([-_]|$)/))?t[0].replace(/[_-]/g,""):""},Z.locale.We=function(t){return t=t.split(/[-_]/g),1<t.length&&t[1].match(/^[a-zA-Z]{4}$/)?t[1]:""},Z.locale.Xe=function(t){return(t=t.match(/[-_]([a-z]{2,})/))?t[1]:""},Z.locale.Se=function(t){var e=Z.locale.Ca(t)+"_"+Z.locale.mb(t);return e in Z.locale.J.COUNTRY?Z.locale.J.COUNTRY[e]:t},Z.locale.Oe=function(t,e){e||(e=Z.locale.ob());var r=Z.locale.mb(t);return r in e.COUNTRY?e.COUNTRY[r]:t},Z.locale.Te=function(t){if(t in Z.locale.J.LANGUAGE)return Z.locale.J.LANGUAGE[t];var e=Z.locale.Ca(t);return e in Z.locale.J.LANGUAGE?Z.locale.J.LANGUAGE[e]:t},Z.locale.Pe=function(t,e){if(e||(e=Z.locale.ob()),t in e.LANGUAGE)return e.LANGUAGE[t];var r=Z.locale.Ca(t);return r in e.LANGUAGE?e.LANGUAGE[r]:t},Z.locale.K=function(t,e,r){Z.locale.m[e]||(Z.locale.m[e]={}),Z.locale.m[e][r]=t,Z.locale.N||(Z.locale.N=r)},Z.locale.rf=function(t,e){return t in Z.locale.m&&e in Z.locale.m[t]},Z.locale.m={},Z.locale.Pf=function(t,e){Z.locale.K(t,Z.locale.H.ic,e)},Z.locale.Nf=function(t,e){Z.locale.K(t,Z.locale.H.Yb,e)},Z.locale.Qf=function(t,e){Z.locale.K(t,Z.locale.H.jc,e)},Z.locale.Sf=function(t,e){Z.locale.K(t,Z.locale.H.lc,e)},Z.locale.Rf=function(t,e){Z.locale.K(t,Z.locale.H.kc,e)},Z.locale.Of=function(t,e){Z.locale.K(t,Z.locale.H.hc,e)},Z.locale.ob=function(){var t=Z.locale.Da(),t=t?t:Z.locale.Da();if(ka in Z.locale.m)return Z.locale.m.LocaleNameConstants[t]},Z.locale.Ve=function(t,e){if(e=e?e:Z.locale.Da(),t in Z.locale.m)return e in Z.locale.m[t]?Z.locale.m[t][e]:(e=e.split("_"),1<e.length&&e[0]in Z.locale.m[t]?Z.locale.m[t][e[0]]:Z.locale.m[t].en)};var google={a:{}};if(google.a.c={},google.a.c.languages={af:!0,am:!0,az:!0,ar:!0,arb:"ar",bg:!0,bn:!0,ca:!0,cs:!0,cmn:"zh",da:!0,de:!0,el:!0,en:!0,en_gb:!0,es:!0,es_419:!0,et:!0,eu:!0,fa:!0,fi:!0,fil:!0,fr:!0,fr_ca:!0,gl:!0,ka:!0,gu:!0,he:"iw",hi:!0,hr:!0,hu:!0,hy:!0,id:!0,in:"id",is:!0,it:!0,iw:!0,ja:!0,ji:"yi",jv:!1,jw:"jv",km:!0,kn:!0,ko:!0,lo:!0,lt:!0,lv:!0,ml:!0,mn:!0,mo:"ro",mr:!0,ms:!0,nb:"no",ne:!0,nl:!0,no:!0,pl:!0,pt:"pt_br",pt_br:!0,pt_pt:!0,ro:!0,ru:!0,si:!0,sk:!0,sl:!0,sr:!0,sv:!0,sw:!0,swh:"sw",ta:!0,te:!0,th:!0,tl:"fil",tr:!0,uk:!0,ur:!0,vi:!0,yi:!1,zh:"zh_cn",zh_cn:!0,zh_hk:!0,zh_tw:!0,zsm:"ms",zu:!0},google.a.c.R={},google.a.c.I="unknown",google.a.c.log=Y(),google.a.c.error=Y(),google.a.c.Z=!1,google.a.c.window=window,google.a.c.vd={1:"1.0","1.0":"current",1.1:"upcoming",current:"45",upcoming:"45",41:"top",42:"top",43:"top",44:"top"},google.a.c.Ta={gstatic:{prefix:"https://www.gstatic.com/charts",debug:"{prefix}/debug/{version}/jsapi_debug_{package}_module.js",compiled:"{prefix}/{version}/js/jsapi_compiled_{package}_module.js",i18n:"{prefix}/{version}/i18n/jsapi_compiled_i18n_{package}_module__{language}.js",css_prefix:"{prefix}/{version}/css",css:Za,css_debug:Za,third_party:ab,third_party_gen:ab}},google.a.c.i=google.a.c.Ta.gstatic,google.a.c.Dc={format:[],default:["format"],ui:["default"],ui_base:["default"],annotatedtimeline:[Q],annotationchart:[Q,"controls",L,"table"],areachart:[Q,J],bar:[Q,M,S],barchart:[Q,J],browserchart:[Q],calendar:[Q],charteditor:[Q,L,O,Wa,"gauge","motionchart","orgchart","table"],charteditor_base:[R,L,O,Wa,"gauge","motionchart","orgchart","table_base"],columnchart:[Q,J],controls:[Q],controls_base:[R],corechart:[Q],gantt:[Q,M],gauge:[Q],geochart:[Q],geomap:[Q],geomap_base:[R],helloworld:[Q],imageareachart:[Q,O],imagebarchart:[Q,O],imagelinechart:[Q,O],imagechart:[Q],imagepiechart:[Q,O],imagesparkline:[Q,O],intensitymap:[Q],line:[Q,M,S],linechart:[Q,J],map:[Q],motionchart:[Q],orgchart:[Q],overtimecharts:[Q,L],piechart:[Q,J],sankey:["d3","d3.sankey",Q],scatter:[Q,M,S],scatterchart:[Q,J],table:[Q],table_base:[R],timeline:[Q,M],treemap:[Q],wordtree:[Q]},google.a.c.pd={d3:"d3/d3.js","d3.sankey":"d3/d3.sankey.js",webfontloader:"webfontloader/webfont.js"},google.a.c.Eb={dygraph:"dygraphs/dygraph-tickers-combined.js"},google.a.c.Ac={annotatedtimeline:"/annotatedtimeline/annotatedtimeline.css",annotationchart:"annotationchart/annotationchart.css",charteditor:"charteditor/charteditor.css",charteditor_base:"charteditor/charteditor_base.css",controls:"controls/controls.css",imagesparkline:"imagesparkline/imagesparkline.css",intensitymap:"intensitymap/intensitymap.css",orgchart:"orgchart/orgchart.css",table:"table/table.css",table_base:"table/table_base.css",ui:["util/util.css","core/tooltip.css"],ui_base:"util/util_base.css"},google.a.c.ra=function(t,e){e=e||{};for(var r=[],i=0;i<t.length;i++){var n=t[i];if(!e[n]){e[n]=!0;var o=google.a.c.Dc[n]||[];0<o.length&&(r=r.concat(google.a.c.ra(o,e))),r.push(n)}}return r},google.a.c.Jc=function(t){for(var e={},r=[],i=0;i<t.length;i++){var n=google.a.c.Ac[t[i]];Z.isArray(n)||(n=[n]);for(var o=0;o<n.length;o++){var a=n[o];a&&!e[a]&&(e[a]=!0,r.push(a))}}return r},google.a.c.jd=function(t,e){if(e)if("undefined"==typeof t.onload){var r=!1;t.onreadystatechange=function(){r||(t.readyState&&t.readyState!==K?google.a.c.window.setTimeout(t.onreadystatechange,0):(r=!0,delete t.onreadystatechange,google.a.c.window.setTimeout(e,0)))}}else t.onload=e},google.a.c.zb=function(t,e,r){google.a.c.log("loadScript: "+t);var i=e.createElement("script");i.type=Ya,i.language="javascript",i.async=!1,i.defer=!1,e=e.body||e.head||e.getElementsByTagName("HEAD").item(0)||e.documentElement,e.insertBefore(i,e.lastChild),r&&google.a.c.jd(i,r),i.src=t,google.a.c.log("end loadScript: "+t)},google.a.c.Xc=function(a,c){a=google.a.c.ra(a);for(var d=[],e=0;e<a.length;e++){var f=a[e];google.a.c.R[f]||d.push(f)}if(a=d,0===a.length)c();else{google.a.c.log("Load packages + dependencies - previous: "+a);var g=google.a.c.i.prefix,h=google.a.c.i.debug,l=google.a.c.i.compiled,m=google.a.c.i.i18n,n=google.a.c.I,T=google.a.c.Ma;"en"===T&&(T=null);var D={},ya=a.length,ob=function(){for(var d=[],e=0;e<a.length;e++)d.push(D[a[e]]);eval("0,(function(){"+d.join("")+"})")(),google.a.c.window.setTimeout(c,0)};google.a.c.cd=function(t,e){google.a.c.log("callback after loading "+t),D[t]=e,google.a.c.R[t]=!0,ya--,0===ya&&ob()};var nb=function(t){var e=google.a.c.Ec,r=a[t++];if(r){var i=r,o=google.a.c.pd[r];o?(i=o,r===S&&(e=window.document),r=google.a.c.i.third_party):google.a.c.Eb[r]?(i=google.a.c.Eb[r],r=google.a.c.i.third_party_gen):r=google.a.c.Z?h:T?m:l,i=r.replace($a,g).replace(bb,n).replace("{language}",T).replace("{package}",i),google.a.c.zb(i,e),nb(t)}};nb(0)}},google.a.c.W=function(t){function e(){o=!0;for(var t=i.length,e=0;e<t;e++)i[e]()}function r(){a=!0;for(var t=n.length,e=0;e<t;e++)n[e]()}var i=[],n=[],o=!1,a=!1;google.a.c.W.count||(google.a.c.W.count=0);var s="load-css-"+google.a.c.W.count++,l={done:function(t){return i.push(t),o&&t(),l},Aa:function(t){return n.push(t),a&&t(),l}},u=document.createElement("link");return u.setAttribute("id",s),u.setAttribute("rel","stylesheet"),u.setAttribute("type","text/css"),"undefined"!=typeof u.addEventListener?(u.addEventListener("load",e,!1),u.addEventListener("error",r,!1)):"undefined"!=typeof u.attachEvent&&u.attachEvent("onload",function(){var t,i=document.styleSheets.length;try{for(;i--;)if(t=document.styleSheets[i],t.id===s)return void e()}catch(t){}o||r()}),document.getElementsByTagName("head")[0].appendChild(u),u.setAttribute("href",t),l},google.a.c.Tc=function(t,e){google.a.c.log("loadCSSFile: "+t),google.a.c.W(t).done(e).Aa(function(){google.a.c.error("loading css failed: "+t)})},google.a.c.Uc=function(t,e){t=google.a.c.ra(t);var r=google.a.c.Jc(t);if(null===r||0===r.length)e();else{google.a.c.log("Loading css files: "+r.join(", "));var i=google.a.c.i.prefix,n=google.a.c.i.css;google.a.c.Z&&(n=google.a.c.i.css_debug||n);var o=google.a.c.I,a=function(t){var s,l=r[t];s=t<r.length-1?function(){a(t+1)}:e,google.a.c.R[l]?(google.a.c.log("Already loaded "+l),google.a.c.window.setTimeout(s,0)):(google.a.c.R[l]=!0,l=n.replace("{css_prefix}",google.a.c.i.css_prefix).replace($a,i).replace(bb,o).replace("{cssFile}",l),google.a.c.Tc(l,s))};a(0)}},google.a.c.Cb=function(t){for(var e=t.replace(/-/g,"_").toLowerCase();Z.h(e);)t=e,e=google.a.c.languages[e],e===t&&(e=!1);return e||(t.match(/_[^_]+$/)?(t=t.replace(/_[^_]+$/,""),t=google.a.c.Cb(t)):t="en"),t},google.a.c.fd=function(t,e){e.log&&(google.a.c.log=e.log),e.error&&(google.a.c.error=e.error);var r=e.debug,i=e.language||"",i=google.a.c.Cb(i);t||(t=e.version||"unknown"),(google.a.c.I&&google.a.c.I!==t||google.a.c.Ma&&google.a.c.Ma!==i||google.a.c.Z!==r)&&(google.a.c.R={}),google.a.c.I=t,google.a.c.Ma=i,google.a.c.Z=r},google.a.c.ea=!0,google.a.c.S=!1,google.a.c.load=function(t,e,r){if(google.a.c.S)google.a.c.U(function(){google.a.c.load(t,e,r)});else{var i;i=t.match(/^(testing\/)?(.*)/);var n=i[1]||"";for(t=i[2];i=google.a.c.vd[t],null!=i&&"top"!==i;)t=i;google.a.c.i=r||google.a.c.Ta[t]||google.a.c.Ta.gstatic,t=n+t,google.a.c.S=!0;var o=function(){google.a.c.S=!1,google.a.c.Na()};if(null==i)n=function(){var i=Z.Ea("google.charts.versionSpecific.load"),n=Z.Ea("google.charts.versionSpecific.setOnLoadCallback");i(t,e,r),n(o)},google.a.c.ea?(google.a.c.ea=!1,google.a.c.zb(google.a.c.i.prefix+"/"+t+"/loader.js",window.document,n)):n();else{if(!google.a.c.ea)throw Error("google.charts.load() cannot be called more than once with version 44 or earlier.");google.a.c.ea=!1,google.a.c.fd(t,e),google.a.c.log("google.charts.load version "+t),window.google=window.google||{},google.visualization=google.visualization||{},google.visualization.ModulePath=google.a.c.i.prefix,google.visualization.CssPath=google.a.c.i.css_prefix.replace($a,google.a.c.i.prefix).replace(bb,google.a.c.I),google.a.c.window=window,google.a.c.Ec=document;var a=e.packages;a&&0!==a.length||(a=["default"]),google.a.c.U(e.callback),google.a.c.Uc(a,function(){google.a.c.Xc(a,o)})}}},google.a.c.kd=function(t){if(window.addEventListener)window.addEventListener("load",t,!1);else if(window.attachEvent)window.attachEvent("onload",t);else{var e=window.onload;window.onload=function(r){e&&e(r),t()}}},google.a.c.Jb=document&&document.readyState===K,google.a.c.kd(function(){google.a.c.Jb=!0,google.a.c.Na()}),google.a.c.Na=function(){!google.a.c.S&&google.a.c.Jb&&google.a.c.xc()},google.a.c.Ba=[],google.a.c.U=function(t){t&&google.a.c.Ba.push(t),google.a.c.S||google.a.c.Na()},google.a.c.xc=function(){var t=google.a.c.Ba;for(google.a.c.Ba=[];0<t.length;)t.shift()()},google.a.c.Qa=function(t,e){google.a.c.cd(t,e)},Z.Ea(Xa))throw Error("Google Charts loader.js can only be loaded once.");google.a.load=function(){var t=0;"visualization"===arguments[t]&&t++;var e="current";Z.h(arguments[t])&&(e=arguments[t],t++);var r={};arguments.length>t&&(r=arguments[t],t++);var i=void 0;arguments.length>t&&(i=arguments[t]),google.a.c.load(e,r,i)},google.a.U=function(t){google.a.c.U(t)},google.a.Qa=function(t,e){google.a.c.Qa(t,e)},Z.ya(Xa,google.a.load),Z.ya("google.charts.setOnLoadCallback",google.a.U),Z.ya("google.charts.packageLoadedCallback",google.a.Qa)}(),define("googleChart",function(){}),requirejs.config({baseUrl:"src",paths:{tourbus:"thirdparty/jquery-tourbus.min",bootstrap:"thirdparty/bootstrap.min",d3:"thirdparty/d3.min",QuadTree:"thirdparty/QuadTree",googleChart:"thirdparty/loader"}}),define("../main",["scripts/ESTWA","tourbus","d3","QuadTree","googleChart"],function(t){function e(){$("#CSVMenu").hide(),$("#CSVMenu").data("open",0),$("#wfsMenu").hide(),$("#wfsMenu").data("open",0),$("#wmsMenu").hide(),$("#wmsMenu").data("open",0),$("#HeatmapMenu").hide(),$("#HeatmapMenu").data("open",0),$("#SurfaceImageMenu").hide(),$("#SurfaceImageMenu").data("open",0),$("#geoJSONMenu").hide(),$("#geoJSONMenu").data("open",0),$("#markerMenu").hide(),$("#markerMenu").data("open",0),$("#geoTIFFMenu").hide(),$("#geoTIFFMenu").data("open",0),$("#geoTIFFMenu").hide(),$("#geoTIFFMenu").data("open",0),$("#KMLMenu").hide(),$("#KMLMenu").data("open",0),$("#NDVIMenu").hide(),$("#NDVIMenu").data("open",0),$("#searchMenu").hide()}new t({globe:"canvasOne"}),$("#loading").hide();var r=$("#my-tour-id").tourbus({});r.trigger("depart.tourbus"),$(".topMenu").resizable(),$("#CSVButton").click(function(){var t=$("#CSVMenu").data("open");e(),t?($("#CSVMenu").hide(),$("#CSVMenu").data("open",0)):($("#CSVMenu").show(),$("#CSVMenu").data("open",1))}),$("#wmsButton").click(function(){var t=$("#wmsMenu").data("open");e(),t?($("#wmsMenu").hide(),$("#wmsMenu").data("open",0)):($("#wmsMenu").show(),$("#wmsMenu").data("open",1))}),$("#wfsButton").click(function(){var t=$("#wfsMenu").data("open");e(),t?($("#wfsMenu").hide(),$("#wfsMenu").data("open",0)):($("#wfsMenu").show(),$("#wfsMenu").data("open",1))}),$("#geoJSONButton").click(function(){var t=$("#geoJSONMenu").data("open");e(),t?($("#geoJSONMenu").hide(),$("#geoJSONMenu").data("open",0)):($("#geoJSONMenu").show(),$("#geoJSONMenu").data("open",1))}),$("#markerButton").click(function(){var t=$("#markerMenu").data("open");e(),t?($("#markerMenu").hide(),$("#markerMenu").data("open",0)):($("#markerMenu").show(),$("#markerMenu").data("open",1))}),$("#geoTIFFButton").click(function(){var t=$("#geoTIFFMenu").data("open");e(),t?($("#geoTIFFMenu").hide(),$("#geoTIFFMenu").data("open",0)):($("#geoTIFFMenu").show(),$("#geoTIFFMenu").data("open",1))}),$("#KMLButton").click(function(){var t=$("#KMLMenu").data("open");e(),t?($("#KMLMenu").hide(),$("#KMLMenu").data("open",0)):($("#KMLMenu").show(),$("#KMLMenu").data("open",1))}),$("#SurfaceImageButton").click(function(){var t=$("#SurfaceImageMenu").data("open");e(),t?($("#SurfaceImageMenu").hide(),$("#SurfaceImageMenu").data("open",0)):($("#SurfaceImageMenu").show(),$("#SurfaceImageMenu").data("open",1))}),$("#HeatmapButton").click(function(){var t=$("#HeatmapMenu").data("open");e(),t?($("#HeatmapMenu").hide(),$("#HeatmapMenu").data("open",0)):($("#HeatmapMenu").show(),$("#HeatmapMenu").data("open",1))}),$("#searchBoxButton").click(function(){var t=$("#searchMenu").data("open");e(),t?($("#searchMenu").hide(),$("#searchMenu").data("open",0)):($("#searchMenu").show(),$("#searchMenu").data("open",1))}),$("#NDVIButton").click(function(){var t=$("#NDVIMenu").data("open");e(),t?($("#NDVIMenu").hide(),$("#NDVIMenu").data("open",0)):($("#NDVIMenu").show(),$("#NDVIMenu").data("open",1))}),$("#hideStatistics").click(function(){$("#bottomMenu").hide()}),$("input[option='heightExtrusion']").change(function(){var t=$("input[option='heightExtrusion']").is(":checked")?1:0,e=$("select[option='re5']").val();return e.length<2?(gInterface.UI.alert("Error: At least two Data values must be selected to apply the extrusion"),void $("input[option='heightExtrusion']").prop("checked",!1)):void(t?($("input[option='shown']").val(1),$("input[option='shown']").attr("disabled",!0)):$("input[option='shown']").attr("disabled",!1))}),$("#configType").change(function(){var t=$("#configType option:selected").val();1==t&&($("#configSelector").show(),$("#CSVOptions").hide(),$("#dbOptions").hide(),$("#advancedOptions").hide()),2==t&&($("#configSelector").hide(),$("#CSVOptions").show(),$("#dbOptions").hide(),$("#advancedOptions").hide()),3==t&&($("#configSelector").hide(),$("#CSVOptions").hide(),$("#dbOptions").show(),$("#advancedOptions").hide()),4==t&&($("#configSelector").hide(),$("#CSVOptions").hide(),$("#dbOptions").hide(),$("#advancedOptions").show())}),$("#afterType").change(function(){var t=$("#afterType option:selected").val();0==t&&($("#sliders").show(),$("#updateSettings").hide(),$("#compareOptions").hide()),1==t&&($("#sliders").hide(),$("#updateSettings").show(),$("#compareOptions").hide()),2==t&&($("#sliders").hide(),$("#updateSettings").hide(),$("#compareOptions").show())})}),require(["../main"])});